(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1209:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.BDc="b-ring_Apc_Trans";a.jig="cdn_static_resource_ewa_image";Object(y.a)(a,"ResourceHosts",null,[])},1255:function(y,F,b){function a(){}function c(v,w,t,A,x){this.url="";this.t5a=!1;this.L7=-1;this.testIteration=0;this.baseUrl=t;this.owf=A;this.mkd=w;this.result=new d(w,x)}function d(v,w){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=
this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=v;this.caller=w;this.reset()}y=b(0);var l=b(54),n=b(13),m=b(277);d.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(y.a)(d,"NetworkTestResult",null,[]);var f=b(598);c.prototype.dMd=function(){try{if(this.t5a)n.ULS.sendTraceTag(537155206,0,
50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.mkd);else{this.reset();this.t5a=!0;this.result.startTimeMs=Date.now();var v=new m.QueryStringBuilder(this.baseUrl);v.C9("tid",this.result.startTimeMs.toString());this.url=v.toString();this.Ynj();this.testIteration++;this.result.testIteration=this.testIteration}}catch(w){this.rtb("Exeption: "+w.message)}};c.prototype.reset=function(){this.url="";this.result.reset();this.t5a=!1;this.L7=-1};c.prototype.clearTimeout=
function(){-1!==this.L7&&(window.clearTimeout(this.L7),this.L7=-1)};c.prototype.Ynj=function(){var v=this;try{var w=new XMLHttpRequest;w.onreadystatechange=function(){4===w.readyState&&(200===w.status?v.pDh():v.rtb(String.format("Error when downloading resource. status code: {0}, status text: {1}",w.status,w.statusText),w.status.toString()))};w.onerror=function(){v.rtb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",w.status,w.statusText))};this.L7=
window.setTimeout(function(){v.L7=-1;v.rtb("Request timeout")},1E4);w.open("GET",this.url,!0);w.send(null)}catch(t){this.rtb("Exeption: "+t.message)}};c.prototype.pDh=function(){this.t5a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=f.a(this.url),this.result.isSuccess=!0,this.I2b())};c.prototype.rtb=function(v,w){w=void 0===w?null:w;this.t5a&&(this.clearTimeout(),this.result.errorMessage=v,this.result.isSuccess=!1,this.result.errorStatusCode=
w,this.I2b())};c.prototype.I2b=function(){this.t5a=!1;this.owf&&this.owf(this.result,this.mkd)};Object(y.a)(c,"NetworkTestReq",null,[]);b.d(F,"a",function(){return a});a.Lcd=function(v,w,t,A){A=void 0===A?null:A;a.ylc||(a.ylc=Array.isArray(l.a.oi(t.ya.NetworkMeasurementUrlList))?l.a.oi(t.ya.NetworkMeasurementUrlList):null);for(var x=[],u=0;u<a.ylc.length;u++){var B=a.ylc[u],r=B.key;r||(r=B.Key);if(!A||Array.contains(A,r)){var I=B.value;I||(I=B.Value);r&&I&&x.push(new c(t,r,I,v,w))}}return x};a.ylc=
null;Object(y.a)(a,"NetworkConnectionHelpers",null,[])},1374:function(y,F,b){function a(Y){var Ra=xi.call(this)||this;Ra.$=Y;Ra.fc();return Ra}function c(){}function d(Y,Ra,zb,gc,bd,Id,Vd){Y=n.call(this,Y,Ra,zb,gc,bd,!1)||this;Y.QYd=!1;Y.Q0=Vd;Y.dec=d.AHh(Id);Id=Y.pZd(Y.dec.name,Y.dec.size);if(0!==Id)return Y.HRd(Id),Y.Q0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),Y.dispose(),Y;Y.Gj=new t(Y.$.domElement,Object(Xe.a)(Y,Y.nEb,"onUploadFrameInitialized"),Object(Xe.a)(Y,Y.Foa,
"uploadResponseReceived"),gc,!1,Y.$);return Y}function l(Y,Ra){this.filename=Y;this.blob=Ra}function n(Y,Ra,zb,gc,bd,Id){Id=void 0===Id?!0:Id;Y=v.call(this,Y,zb,gc,bd,!1)||this;Y.de=Ra;Id&&Y.showDialog();return Y}function m(Y,Ra){this.dataUri=this.sheetName=null;this.sheetName=Y;this.dataUri=Ra}function f(Y,Ra,zb,gc,bd,Id){Id=void 0===Id?!0:Id;Ra=v.call(this,Y,Ra,zb,gc,!1)||this;Ra.uBh=bd;Ra.j9b=Y.Wb.Vh("LoadResource","FileReaderUploaderLoadResource");Id&&Ra.showDialog();return Ra}function v(Y,Ra,
zb,gc,bd){bd=void 0===bd?!0:bd;var Id=Za.call(this,null,Ra,zb)||this;Id.Br=null;Id.naa=null;Id.Gzb=!1;Id.sDd=null;Id.Foa=function(Vd){Id.g_d.stop();Id.C_b.cancel();if(t.xii(Vd))Id.Pzc?Id.u6e(4):(Vd=new Oh.a(0,2,null,null,!1,null,null,null),Vd.status=8,Id.wWd(new Qg.a(Vd),null,"InsertPictureWebMethod")),pc.ULS.sendTraceTag(526399121,0,50,"Http Error occurred, isTimeoutError: {0}",Id.Pzc);else{var ve=v.EWj(Vd);0!==ve?(pc.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: {0}",Vd),Id.u6e(ve)):
Id.E5h(Vd)}Id.soc();Id.dispose()};Id.iLi=function(Vd){Id.IBa(Vd,Id.Gj)&&Id.finalizeUpload(Id.Gj,null)};Id.nEb=function(Vd){pc.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");Id.Gj=Vd;if(!Id.l1a){if(Id.QYd){if(v.twe()||Id.G8a&&Qc.a.qF){Vd.z6b(Id.iLi);return}var ve=Vd.z6b(null);if(!Id.IBa(ve,Vd))return}Id.finalizeUpload(Vd,null)}};Id.yUi=function(){Id.Pzc=!0};Id.vb=Y;Id.g_d=Y.Wb.Vh("WebServiceCall","InsertPictureOperation");Id.C_b=eh.a.instance.create(Id.yUi,1E5,Uh.a.SNg,!1);Id.Pzc=!1;Id.xkc=
Id.$.ya.InsertPictureMaxFileSizeBytes;gc&&(Id.Gzb="TestOnly"in gc);bd&&Id.showDialog();return Id}function w(Y,Ra,zb){var gc=u.call(this,Y,!1)||this;gc.XU=null;gc.TAa=!1;gc.Hmc=function(){gc.TXd("");gc.LAc();return!1};gc.$=Ra;gc.RBc=Y;gc.aR=zg.a.instance;gc.ga=zb;gc.O0f();gc.Nld();gc.$.Ab.QC=!0;return gc}function t(Y,Ra,zb,gc,bd,Id,Vd){Y=A.call(this,Y,Ra,zb,gc,bd,"UploadFrame",Id.ea.sessionId,"image/*",!1,null,void 0===Vd?!1:Vd)||this;Y.$=Id;Y.kfg=!0;Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?
Y.abf():Y.Pqe();return Y}function A(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe,We,Vf){Pe=void 0===Pe?!0:Pe;Vf=void 0===Vf?!1:Vf;this.yTe="FileUpload.ashx";this.Tn=null;this._initialized=!1;this.Kg=this.eib=this.$Hc=this.Cga=this.MRb=this.Vq=this.Es=null;this.sm=!1;this.FD=this.NRb=this.uSc=null;this._parent=Y;this.Dqg=Ra;this.evg=zb;this.a7d=bd;this.rQc=Vd;this.V0d=ve;this.T2d=void 0===We?null:We;this.tSc=!1;this.Wqg=gc.ra("CanaryRenewalForFileUploadIsEnabled");this.kfg=!1;(this.Iqa=Vf)||this.B4g(Id);Pe&&this.abf()}
function x(Y,Ra,zb){if(Y){var gc=0;do{try{Y();break}catch(bd){if(pc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",gc,zb,bd.message,bd.stack),gc>=Ra)break}gc++}while(1)}}function u(Y,Ra){return r.call(this,Y,void 0===Ra?!0:Ra)||this}function B(){}function r(Y,Ra){Ra=void 0===Ra?!0:Ra;var zb=lh.call(this,!1,!1,r.vy)||this;zb.YWa=null;zb.u6d=!1;zb.Rm=[];zb.Gj=null;zb.UWb=Y;zb.Uvg=Ra;zb.gie=!1;zb.Cv=!1;zb.Cga=null;zb.aIc=!1;zb.eg=
zb.Teh;zb.Ve="InsertFileDialog";zb.Gc(1,zb.tXb);if(r.vy){Y={};Ra={};var gc={};zb.YWa=(gc.id=zb.Ve,gc.bodyControls=(Ra.uploadButtonProps=(Y.label=CommonUIStrings.l_DialogChooseFile,Y.onExecute=Object(Xe.a)(zb,zb.cVi,"onUploadButtonClick"),Y),Ra),gc.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,gc.onFrameReady=Object(Xe.a)(zb,zb.KLi,"onFrameReady"),gc);zb.initializeAndShow(zb.titleText,Object(Xe.a)(zb,zb.Jec,"insertDialogHandler"),zb.YWa);zb.nRb=!0}else zb.showDialog(zb.titleText,Object(Xe.a)(zb,
zb.Jec,"insertDialogHandler")),Ra&&zb.O0f(),(Y=zb.gV(1))&&zb.Rm.push(Y),(Y=zb.gV(0))&&zb.Rm.push(Y),zb.Xdg(),zb.nRb=!1;return zb}function I(Y){var Ra=fh.call(this)||this;Ra.$=Y;Ra.fc();return Ra}function z(Y,Ra,zb,gc){var bd=this;this.hL=null;this.meg=function(){bd.hL&&(bd.VZd=aa.a.Ra.ie.m,bd.hide(),eh.a.instance.create(function(){bd.VTj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.IIe=function(Id){10===Id&&bd.nIa()};this.Sfh=function(){if(bd.hL){var Id=document.getElementById("PasteRecoveryUI");
Id&&Me.a.uj===Id.getAttribute(Me.a.wY)&&Id.click();bd.nIa()}};this.JIe=function(){bd.nIa()};this.KIe=function(){bd.nIa()};this.onKeyUp=function(Id){if(bd.hL){if(bd.j_)return!1;if(17===Id.Ea.keyCode&&bd.H8b){Id=document.getElementById("PasteRecoveryUI");if(!Id)return pc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var Vd=Id.getAttribute(Me.a.wY)||"";if(Me.a.Oo===Vd)return Id.click(),!0}}return!1};this.onKeyDown=function(Id){if(bd.hL){bd.H8b=!1;bd.j_=
Id.ctrlKey;Id=Id.Ea.keyCode;if(27===Id)return bd.nIa(),!0;if(17===Id)return bd.H8b=!0}return!1};this.F_=function(Id,Vd){Id=Vd.de;bd.gAb=Id;-1027730316!==Id.command&&-1059615499!==Id.command?bd.nIa():(Vd=Vd.properties)&&Vd.launcherId!==bd.dTh()&&bd.nIa()};this.$=Y;this.Sqc=Ra;this.pr=zb;this.nk=gc;this.vsd=this.gAb=this.gsd=null;this.j_=this.H8b=this.f6b=this.tdc=!1;this.VZd=0;this.$.da.Ha(406,this)}function D(Y){var Ra=kf.call(this)||this;Ra.$=Y;Ra.fc();return Ra}function V(Y,Ra,zb){zb=void 0===zb?
!0:zb;var gc=nf.call(this)||this;gc.hSa=null;gc.Ona=null;gc.kOa=null;gc.V2b=null;gc.J0=null;gc.hsf=0;gc.Gab=!1;gc.Fab=!1;gc.Erc=!1;gc.documentVisibilityObserver=null;gc.isf=null;gc.xDj=null;gc.Hfa=!1;gc.J7=0;gc.fld=0;gc.nzb=!1;gc.s5f=0;gc.DQd=!1;gc.U0=null;gc.IDb=function(){pc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");gc.Zkc(1,!1)};gc.qya=function(){gc.Cka||gc.kBb?window.setTimeout(function(){gc.NVd()},gc.hsf):gc.NVd();gc.documentVisibilityObserver.ZGb(gc.qya);
gc.nzb=!1};gc.Jg=function(){pc.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",gc.kBb&&gc.Nwc,gc.Wjc&&!gc.Hfa&&gc.qKb);gc.kBb&&gc.Nwc&&gc.zke();gc.Wjc&&!gc.Hfa&&gc.qKb&&gc.vke();df.g(gc.$).qc.Mn(gc.Jg);gc.Fab=!1;gc.Gab=!1};gc.VAf=function(){pc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");gc.Zkc(1,!0);gc.Fab&&!gc.Gab&&df.g(gc.$).qc.Mn(gc.Jg);
gc.Fab=!1};gc.tca=function(bd,Id){gc.fld=gc.J7;gc.J7=Id.Kzc};gc.YDf=function(){gc.$&&(gc.Erc||(ch.a(gc.$).QQ(Rf.a.VOa).TEg(gc.fBf),gc.$.Pk(gc.ud),gc.Erc=!0),gc.Hfa=gc.Xfi(),gc.Zkc(2,!1))};gc.fBf=function(){var bd=ch.a(gc.$).xi,Id=bd.cLg();bd=ki.f(bd.Cs.rd.errors,function(Vd){return Vd.MessageIdName});pc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",Id,gc.Hfa,kh.a.Lc(bd));Id&&(gc.hSa?(gc.Hfa=
!1,gc.zGe(),gc.IAc()):gc.Ona&&(gc.AGe(),gc.IAc()))};gc.ud=function(){gc.$?(pc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),gc.Hfa=!1,Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&gc.J0&&gc.J0.ep&&(gh.a.Fa(gc.J0),gc.J0=null),Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&gc.U0&&gc.U0.ep&&(gh.a.Fa(gc.U0),gc.U0=null),gc.Zkc(2,!0),
gc.IAc()):pc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};gc.wwf=function(){gc.brf(!0)};gc.xwf=function(){gc.brf(!1)};gc.EVb=ca.jti;gc.j2c=ca.connected;gc.$=Y;gc.sf=Y.na.sf;gc.w2f=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");gc.qKb=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");gc.Nwc=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");
zb&&(gc.isf=new la(Y,Ra));Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&gc.$.da.Za(291,function(bd){gc.documentVisibilityObserver=bd});gc.Nwc&&(Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||gc.$.da.Za(291,function(bd){gc.documentVisibilityObserver=bd}),gc.hsf=gc.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,gc.sf.ZFg(gc.IDb),gc.sf.pnb(gc.VAf),gc.sf.pne(gc.wwf),gc.sf.yEg(gc.xwf));if(gc.w2f||gc.qKb)gc.xDj=
new U(gc.$,gc);gc.Knf=gc.$.ya.LongInactivityTimePeriodSeconds;gc.$.ea.xVc(gc.YDf);gc.$.ea.wf.Lra(gc.tca);gc.qKb&&(gc.s5f=gc.$.ya.SilentReopenDuringWorkDelayMs);return gc}function U(Y){var Ra=this;this.y7=null;this.ZDf=function(zb,gc){Ra.WDf(gc,3)};this.qAf=function(zb,gc){Ra.WDf(gc,2)};this.$=Y;this.sg=Pb.a(this.$).sg;this.sg.Wne(this.qAf);this.sg.nHg(this.ZDf)}function Q(Y,Ra,zb,gc){Y=W.call(this,Y,Ra,zb)||this;Y.wasInteruptedByOfflineMode=!1;Y.type=gc;Y.wasInteruptedByOfflineMode=!1;return Y}function la(Y,
Ra){this.Gla=this.vxd=this.guf=null;this.$=Y;!Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Qc.a.Df||(this.guf=new ba(Y,Ra));Nc.EwaSettings.la(213)&&(this.vxd=new T(this.$),this.vxd.K$h());!Nc.EwaSettings.la(586)||Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Qc.a.Df||(this.Gla=new hd.NetworkConnectionHealthChecker(this.$));this.I1g=new K(this.$)}
function ba(Y,Ra){var zb=this;this.jOa=this.zU=null;this.PEd=-1;this.Ftb=null;this.Akf=bg.Task.delay(0);this.F9a=function(gc,bd){bd.KP?zb.yQi(bd.boa):zb.zQi()};this.uca=function(gc,bd){5===bd.YGf&&zb.H2a()};this.XVf=function(gc,bd){zb.zU.qrj(bd.WU)};this.H2a=function(){zb.jOa.bSj();zb.rlj(ba.UCd,Sys.Serialization.JavaScriptSerializer.serialize(zb.jOa))};this.ogj=function(gc){if(gc=gc.result)zb.Fgg=!0,pc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",
gc)};this.vaj=function(){zb.Fgg&&(zb.$?Da.TaskExtensions.Ba(zb.indexedDB.k6c(ba.UCd),function(){pc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},zb.$.ma):pc.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.qOa=function(){if(zb.jOa&&0<zb.jOa.count){var gc=Sys.Serialization.JavaScriptSerializer.serialize(zb.jOa);
pc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",gc)}};this.$=Y;this.indexedDB=Ra;this.Fgg=!1;this.indexedDB.rg()&&(this.indexedDB.initialize(ba.mld,ba.nld),this.Jfj(),this.jOa=new H(this.$.ya.UserSessionId),Pb.a(this.$).sg.dVc(this.F9a));this.nk=Dh.a.instance.pE();this.nk.ka("beforeunload",this.qOa)}function S(Y,Ra,zb){Y=W.call(this,Y,Ra,zb)||this;Y.timeFromLastOffline=0;Y._errorDataDuringOfflineMode=null;Y.timeFromLastOffline=
-1;Y.type=5;return Y}function H(Y){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Y}function T(Y){var Ra=this;this.$Uf=null;this.qsd=this.uwd=this.ECb=this.FCb=0;this.KQd=!1;this.$1c=this.mSa=this.Xxc=this.L8a=null;this.o2c=0;this.boj=function(){if(12E4>Ra.$.ea.wf.aeb)for(var zb=yl(Ra.Xxc),gc=zb.next();!gc.done;gc=zb.next())gc.value.dMd();else Ra.CTd("UserInactive")};this.ygj=function(zb){zb=
Sys.Serialization.JavaScriptSerializer.serialize(zb);pc.ULS.sendTraceTag(388821830,0,50,zb)};this.Ofj=function(zb){if(zb){var gc=Ra.$1c[zb.testIteration.toString()];gc?gc.push(zb):(gc=[zb],Ra.$1c[zb.testIteration.toString()]=gc);if(gc.length===Ra.$Uf.length){gc=Sys.Serialization.JavaScriptSerializer.serialize(gc);if(Ra.$&&Ra.$.sf){if(zb.EstimatedLatency=Ra.$.sf.wte,Ra.$.sf.wte>Ra.$.zu.ExcelRountripThresholdMs){pc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",
gc,Ra.o2c++);return}}else pc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");pc.ULS.sendTraceTag(570712142,0,50,"Periodic ping tests results: {0}",gc);Ra.o2c=1}}};this.Mh=function(zb,gc){zb=gc.context.methodName;if(zb===Xd.a.Avb||zb===Xd.a.oKa)Ra.ECb++,zb=Date.now(),Ra.Ayj(zb)&&(Ra.ECb=0,Ra.qsd=zb,Ra.zGj())};this.tca=function(){Ra.jTd("OnThrottledUserActivity")};this.iW=function(){Ra.CTd("OnDocumentHidden")};this.qya=function(){Ra.jTd("OnDocumentUnhidden")};
this.$=Y;if(this.LQd=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.jXg())this.$Uf=[qe.a.BDc],this.o2c=1,this.$1c={},this.$.ea.wf.Lra(this.tca),this.$.da.Za(291,function(zb){zb.yFa(Ra.iW);zb.inb(Ra.qya)})}function K(Y){var Ra=this;this.Kic=this.data=null;this.X$c=0;this.QBe=null;this.ywf=function(zb,gc){gc.KP?(Ra.data=new fa(aa.a.Ra.Lb,Ra.$,5===gc.boa,0!==gc.boa,Ra.$.sf.disconnectionSource,Ra.QBe),Ra.Kic=Ra.$.sf.Gkf,Ra.X$c=1,Ra.$.na.sf.OHg(Ra.Kn),gd.a(Ra.$).PUc(Ra.WVf)):
(Ra.data.rJi(Ra.$,5===gc.boa),Ra.$.na.sf.ERf(Ra.Kn),Ra.data.lastFailedRequestToOnlineTimeGapSec=ha.getElapsedSeconds(Ra.Kic,aa.a.Ra.Lb),Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?bf.b().aJb(557682689,0,50,da.connectivityIssues,Ra.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",kh.a.Lc(Ra.data)):pc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",
kh.a.Lc(Ra.data)),Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&Ra.data&&Ra.data.isToastShown&&Cc.Health.instance.recordQosError(Ka.a.XYg,[bb.a.jjc],!0,!1,!1,!1,null),gd.a(Ra.$).ZId(Ra.WVf),Ra.data=null)};this.WVf=function(zb,gc){Ra.data.prj(gc.WU)};this.Kn=function(zb,gc){Ra.data.T7i(gc.context.methodName);zb=aa.a.Ra.Lb;gc=ha.getElapsedSeconds(Ra.Kic,zb);Ra.Kic=zb;gc>Ra.data.longestDurationBetweenFailedRequestsSec&&(Ra.data.longestDurationBetweenFailedRequestsSec=
gc);Ra.X$c++;Ra.data.averageDurationBetweenFailedRequestsSec=Ra.ETg(gc)};this.vwf=function(zb,gc){Ra.QBe=gc.QNj};this.$=Y;Pb.a(this.$).sg.qne(this.ywf);this.$.sf.pne(this.vwf)}function da(){}function fa(Y,Ra,zb,gc,bd,Id){Y=W.call(this,Y,Ra,gc)||this;Y.swappedByOffline=!1;Y.swappedOffline=!1;Y.averageDurationBetweenFailedRequestsSec=0;Y.longestDurationBetweenFailedRequestsSec=0;Y.lastFailedRequestToOnlineTimeGapSec=0;Y.disconnectionSource=null;Y.errorDataDuringConnectivityIssuesMode=null;Y.failedRequests=
[];Y.triggeringRequest=null;Y.type=4;Y.swappedOffline=zb;Y.disconnectionSource=Enum.toString(rc.a,bd);Y.triggeringRequest=Id;return Y}function W(Y,Ra,zb){var gc=this,bd;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=
this.isTaskPaneShown=this.isDialogShown=!1;this.lvf=function(Id,Vd){gc.blockedOperationsCount++;Id=String.format("{0}_{1}_{2})",Vd.componentName,Vd.actionName,Vd.details);gc.blockedActions[Id]=gc.blockedActions[Id]?gc.blockedActions[Id]+1:1;gc.isToastShown&&gc.blockedUserOperationsWhileToastShown++};this.TBd=function(Id){gc.durationUntilUserInactive=ha.getElapsedSeconds(gc.startTime,aa.a.Ra.Lb);Id.HJd(gc.TBd)};this.iW=function(){gc.hasTabbedOut=!0};this.uca=function(Id,Vd){Vd.YGf!==gc.type||gc.isToastShown||
(gc.durationUntilToastShownMs=Qa.a(aa.a.Ra,gc.startTime),gc.toastRaiser=Vd.toastRaiser,gc.isToastShown=!0)};this.startTime=Y;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=zb;if(null===(bd=Ra.ea)||void 0===bd?0:bd.wf)this.wasUserActiveOnPIStart=Ra.ea.wf.nr;this.al(Ra);Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Ra.Ab.WN,Y=Ra.da.Aa(183),this.isTaskPaneShown=!!Y&&Y.isVisible&&!Y.isCollapsed,this.isTaskPaneCollapsed=!!Y&&Y.isVisible&&
Y.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function ca(){}function ia(Y){var Ra=ad.call(this)||this;Ra.Pc=Y;Ra.fc();return Ra}function ea(Y,Ra,zb){zb=void 0===zb?null:zb;var gc=Kc.call(this)||this;gc.v_a=null;gc.k5a=null;gc.pec=null;gc.DCa=null;pc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");gc.$=Y;gc.zkb=new hc(Y);gc.fai(Y,zb);gc.Sfa=new ma(gc.DCa,gc.zkb);gc.vKd=new qa(Y,gc.Sfa,Ra);Nc.EwaSettings.la(256)&&(gc.pec=new Db(Y,gc));pc.ULS.sendTraceTag(588276810,
0,50,"MergeSuspensionManager created");return gc}function qa(Y,Ra,zb,gc){gc=void 0===gc?null:gc;var bd=Lb.call(this)||this;bd.lJe=null;bd.Fda=null;bd.Zzb=0;bd.u7a=null;bd.$zb=null;bd.iCf=function(Id,Vd){bd.lJe.dZi(Vd.Ala)};bd.kEb=function(Id,Vd){Vd.Uwa?bd.gGj():bd.yyc()};bd.vAf=function(){bd.Zzb=0};bd.ZXf=function(){var Id=bd.V5.Dfd();Na(bd.ta,null!=Id.SuspensionStartTimestamp?Id.SuspensionStartTimestamp:0,null,function(){bd.LOi(Id)},null,null,bd.ta.$b())};bd.d8=function(Id,Vd){if(Vd){Vd.SFa.MergeCount=
bd.V5.Dfd();var ve=df.g(bd.$).mBi();Id=ve.min;ve=ve.max;Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Vd.SFa.ClientRevisions=Object.assign(new lb,{Min:Id,Max:ve,MaxFromBlockCache:df.g(bd.$).Ca.bqf}):Vd.SFa.ClientRevisions=Object.assign(new lb,{Min:Id,Max:ve})}};bd.$=Y;bd.asa=zb;bd.ynj=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1);bd.ynj&&(bd.Fda=new pa(bd.$));bd.V5=Ra;bd.V5.LGg(bd.iCf);bd.V5.bZb(bd.kEb);bd.V5.TFg(bd.vAf);bd.$.na.L9(bd.d8);
bd.ta=bd.$.na.ta;bd.AKd=bd.$.ya.MergeSuspensionRequestThrottlingTimeInMs;bd.Pqi=bd.$.ya.KeepBlockingPendingMergesRequestIntervalMs;bd.lJe=gc||new Ya(bd.ta,bd.$,null,null,bd.Fda);pc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");return bd}function pa(Y){var Ra=this;this.tyc=0;this.bE=this.KC=null;this.tY=new Ha;this.VH=0;this.Ig=function(){Ra.Yse(!0)};this.h9a=function(){Ra.Yse(!1)};this.$=Y;this.gridView=df.g(this.$);this.gridView.Ca.Ep(this.Ig);this.gridView.Ca.rq(this.h9a);this.gridView.Ca.gne(this.h9a);
this.gridView.Ca.Tga(this.h9a);this.zgj=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.IXf=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6065693_SelectionAdjustManagerRefactor");Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6005376_SelectionAdjustTelemetryUpdates")&&this.$.da.Za(276,function(){na.a(Ra.$).D9(Ra.tY)})}function Pa(Y,Ra,zb,gc,bd){this.qG=Ra;this.r9=zb;this.OVb=gc;this.Akg=bd;this.dgb&&(this.f2d=df.g(Y).Ca.k3a(this.selectedRanges[0],bd))}function Ha(){this.totalRequests=
this.parallel=this.errors=this.nonContinuous=this.divergence=this.adjusted=this.adjustedDidntChange=0}function Ya(Y,Ra,zb,gc,bd){var Id=this;this.Oic=null;this.YBd=0;this.documentVisibilityObserver=null;this.ta=Y;this.AKd=Ra.ya.MergeSuspensionRequestThrottlingTimeInMs;var Vd=Ra.ya.GetRangeContentPrefetchDelayForMergeInMs;this.ny=function(){Ra.JWf(Vd)};this.mh=(void 0===zb?null:zb)||aa.a.Ra;this.gZd=0;this.MO=void 0===gc?null:gc;this.Fda=void 0===bd?null:bd;this.n5c=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DPMHiddenTabRequestThrottling",
!1);this.G5f=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6101783_SkipVirtualGetRangeForDPMWhenTabHidden2");this.n5c&&(this.w7h=Ra.ya.MergeSuspensionHiddenTabRequestThrottlingTimeInMs);(this.G5f||this.n5c)&&Ra.da.Za(291,function(ve){Id.documentVisibilityObserver=ve})}function Na(Y,Ra,zb,gc,bd,Id,Vd){Vd=Y.Na(1,void 0===Vd?null:Vd);Vd.suspensionStartTimestamp=Ra;return ge.i(Y,"KeepBlockingPendingMerges",Vd,zb,gc,bd,Id,0)}function eb(Y,Ra,zb,gc,bd,Id,Vd){Vd=Y.Na(1,void 0===Vd?null:Vd);Vd.viewportState=
Ra;return ge.i(Y,"DoPendingMergeWithSelectionAdjust",Vd,zb,gc,bd,Id,0)}function Ia(Y,Ra,zb,gc,bd,Id){Id=Y.Na(1,void 0===Id?null:Id);return ge.i(Y,"DoPendingMerge",Id,Ra,zb,gc,bd,0)}function lb(){}function hc(Y){var Ra=E.call(this)||this;Ra.S1=null;Ra.Pic=0;Ra.c8=function(zb,gc){var bd;if(null===(bd=null===gc||void 0===gc?void 0:gc.vd)||void 0===bd?0:bd.MergeCount)Ge.a.equals(gc.vd.SessionId,Ra.$.ea.sessionId,!1)?Ra.GOa(gc.vd.MergeCount,hc.w7c):pc.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",
gc.vd.MergeCount.Current,gc.vd.MergeCount.Pending)};Ra.NBb=function(zb,gc){(null===gc||void 0===gc?0:gc.Ala)&&Ra.GOa(gc.Ala,hc.h_d)};Ra.nvc=function(){Ra.LTf();Ra.QLf(Ra.S1)};Ra.n9a=function(zb,gc){gc.cBe&&Ra.S1.SuspensionStartTimestamp&&pc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",pb(Ra.S1))};Ra.LTf();Ra.$=Y;Ra.$.na.tq(Ra.c8);Ra.$.ea.Tj(Ra.nvc);Ra.$.ea.MP(Ra.nvc);df.g(Ra.$).zc.Lo(Ra.n9a);Ra.$.da.Za(292,function(zb){zb.onb(Ra.NBb);pc.ULS.sendTraceTag(588276809,
0,50,"PendingMergeMonitor initialized")});return Ra}function ma(Y,Ra){var zb=k.call(this)||this;zb.BDb=function(gc,bd){gc=zb.getState();var Id=zb.Bla;zb.Bla=bd.Ala;bd=zb.getState();zb.iwi(gc,bd,Id);zb.raiseEvent(ma.iwd);zb.qUe(gc,bd)};zb.JOa=function(gc,bd){gc=zb.getState();zb.GK=bd.GK;bd=zb.getState();zb.qUe(gc,bd)};zb.Oha=Y;zb.Oha.ZYb(zb.JOa);zb.t$a=Ra;zb.t$a.onb(zb.BDb);zb.Bla=Object.assign(new X.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});zb.GK=zb.L$h();return zb}function Ja(Y){var Ra=
va.call(this)||this;Ra.Uwa=Y;return Ra}function Ta(Y){return(null===Y||void 0===Y?void 0:Y.SuspensionStartTimestamp)&&Y.Pending>Y.Current}function pb(Y){return Y?String.format("{0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp):null}function Db(Y,Ra){var zb=tc.call(this)||this;zb.statusBarManager=null;zb.Ixd=!1;zb.BDb=function(gc,bd){gc=String.format("{0}{1}",bd.Ala.Current===bd.Ala.Pending?"\u26ad":"\u26ae",bd.Ala.Current);Ge.a.equals(zb.Blc,gc,!1)||(zb.Blc=gc,zb.uz())};zb.JOa=function(gc,
bd){gc=0==bd.GK;zb.Ixd!==gc&&(zb.Ixd=gc,zb.uz())};zb.mergeSuspensionManager=Ra;zb.mergeSuspensionManager.t$a.onb(zb.BDb);zb.Blc="";oh.a.u2(1905775613,h.a.Jc,0,1);zb.Ka=Y.Ka;zb.AMb=new fb;Y.da.Za(29,function(gc){zb.mergeSuspensionManager&&(zb.statusBarManager=gc,gc.vJ(zb),zb.mergeSuspensionManager.Oha.ZYb(zb.JOa))});zb.Ka.v2(zb.AMb);return zb}function fb(){return Bb.call(this)||this}function xa(Y,Ra){Ra=void 0===Ra?null:Ra;var zb=vg.call(this,1)||this;zb.Kfa=!1;zb.ON=function(){zb.refresh()};zb.Iwf=
function(){zb.refresh()};zb.$=Y;zb.Z7d=Ra||ch.a(Y).QQ(Rf.a.idle);ch.a(Y).OUc(zb.Iwf);zb.j5a.sq(zb.ON);zb.refresh();return zb}function ya(){var Y=rf.call(this)||this;Y.ykf=null;Y.SQa=new vf.a;return Y}function Ga(Y,Ra){this.handler=null;this.publisher=Y;this.GK=Ra}function db(Y){var Ra=ai.call(this,1)||this;Ra.Kfa=!1;Ra.Dvf=function(){Ra.refresh()};Ra.Evf=function(){Ra.refresh()};Ra.gridView=df.g(Y);Ra.gridView.zc.Xl(Ra.Evf);Ra.gridView.zc.Lo(Ra.Dvf);Ra.refresh();return Ra}function Ob(Y){return Ng.call(this,
Y)||this}function Ec(Y,Ra){this.$=Y;this.uploaderCreator=Ra}function wb(Y,Ra,zb,gc,bd,Id){var Vd=Za.call(this,null,zb,gc)||this;Vd.Snf=0;Vd.SQi=function(ve){og.a(ve)?pc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",kd.a.Uc(ve.Errors)):(pc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),ve.Result?$h.a(Vd.$).jna(1,ve.Result):pc.ULS.sendTraceTag(537155800,
0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};Vd.RQi=function(){pc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};Vd.$=Y;Vd.de=Ra;Vd.Q0=Id;Vd.tqe=ie.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Vd.showDialog();return Vd}function kb(Y,Ra,zb,gc,bd,Id){var Vd=yg.call(this)||this;Vd.sgc=!1;Vd.nwa=null;Vd.$R=null;Vd.mNa=null;Vd.fIi=function(){Vd.rua(Vd.Rob)};Vd.asd=function(ve){ve.keyCode===
Sys.UI.Key.tab&&("KeepFocusDiv"!==ve.target.id||ve.shiftKey?"KeepFocusStartDiv"===ve.target.id&&ve.shiftKey&&(ve.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(ve.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};Vd.bPi=function(){Vd.Lnb&&(Vd.Lnb.launchUpsellExperience("stockimages"),pc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};Vd.fo=Id;Vd.$=Y;Vd.mbf=Ra;Vd.Lnb=zb;Vd.fAa=[];Vd.tqf=gc;Vd.Ueh=bd;Vd.Ope=Vd.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;
Vd.eg=Vd.r7g();return Vd}function vb(){}function Gb(Y,Ra){return Ff.call(this,Y,sg.a.Oaa(Ra))||this}function Za(Y,Ra,zb){Y=ub.call(this,Y,Ra,zb)||this;Y.vra=null;Y.wUb=null;return Y}function ub(Y,Ra,zb){this.Gj=this.QBd=null;this.EEa=this.$qa=0;this.ORb=null;this.YS=Y;this.oe=Ra;this.wb=zb;this.l1a=!1;this.QYd=!0;this.Ehj();this.G8a=this.ga.ra("NativeFileOpenDialogIsEnabled")}function fc(Y){var Ra=bh.call(this)||this;Ra.dld=null;Ra.$=Y;Ra.fc();return Ra}function $a(Y){var Ra=wg.call(this)||this;Ra.$=
Y;Ra.fc();return Ra}function nb(Y,Ra){this.FUe=Y;this.KDh=Ra}function sc(Y){this.$=Y}function rd(Y){var Ra=Sg.call(this)||this;Ra.$=Y;Ra.fc();return Ra}function $b(Y,Ra,zb){var gc=ei.call(this)||this;gc.statusBarManager=null;gc.sIe=function(){gc.b6b()};gc.Afh=function(){gc.b6b()};gc.rIe=function(bd){10===bd&&gc.b6b()};gc.onKeyDown=function(bd){if(13===bd.Ea.keyCode){bd=new Zg.a(237279923,1,2,6,null);var Id={};gc.$.Ka.Yb(bd,(Id[Me.a.skipClipboardAccess]=!0,Id[Me.a.rMe]=!0,Id));return!0}return!1};gc.$=
Y;gc.pr=Ra;gc.nk=zb;gc.H8c=!1;gc.k3f=Nc.EwaSettings.getBooleanFeatureGate(Je.a.BPa,!1);gc.Zhf=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");gc.k3f&&gc.$.da.Za(29,function(bd){gc.statusBarManager=bd;bd.vJ(gc)});return gc}function Wb(Y){var Ra=Og.call(this)||this;Ra.$=Y;Ra.Km=le.a.instance;Ra.fc();return Ra}function lc(Y){var Ra=this;this.S4b="";this.p2=this.Ns=null;this.aqc=!1;this.a9e=function(zb,gc){Ra.hide(void 0===zb?null:zb,void 0===gc?null:gc)};this.gridView=
df.g(Y);this.gridView.ha.MG(this.a9e)}function Oa(){}function qb(Y,Ra){var zb=Nh.call(this,Y)||this;zb.Vo=null;zb.cdi=function(gc,bd){1===gc?(gc=qb.rfh[bd[qb.qfh]],pc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",0===gc?"Horizontal":"Vertical"),zb.Vo.setResult(gc)):(pc.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),zb.Vo.fu())};
zb.Bh(Ra);return zb}function Ub(Y){this.REc=this.$Oc=null;this.$=Y}function jc(){}function Kb(){}function dc(){}function Qb(){}function O(Y){this.T2c=this.$sa=null;this.q$a=15;this.$=Y}function Ba(Y,Ra){this.$=Y;this.eob=Ra}function ra(Y,Ra,zb,gc){Y=Xb.call(this,Y)||this;Y.isFromCurrentSession=!1;Y.top=0;Y.left=0;Y.isFromCurrentSession=Ra;Y.top=zb;Y.left=gc;return Y}function ta(Y,Ra,zb,gc,bd){bd=void 0===bd?null:bd;var Id=Sa.call(this,Y,"ArtCopyPasteHandler")||this;Id.qZg="XLO";Id.rZg="3";Id.IU=new Ab(Y);
Id.s$=Ra;Id.nZa=zb;Id.ha=df.g(Y).ha;Id.V2c=bd||new ib(Id.s$);Id.IYi=new Fa(zb,Y);Id.eob=gc;return Id}function Fa(Y,Ra){this.DHb=new Bc.a;this.nZa=Y;this.$=Ra;this.m3i=function(zb){return Promise.resolve(zb)};this.ODb=function(zb){return Promise.reject(zb)}}function cb(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){this.promise=null;this.ribbonCommandInfo=Y;this.destination=Ra;this.DHe=zb;this.$Yd=bd;this.E0=Id;this.item=Vd;this.pasteContext=ve;this.FNa=zb||Ra.FirstRow+"_"+Ra.FirstColumn;this.lff=!0;this.yze=Pe}function Wa(Y,
Ra,zb,gc,bd,Id,Vd){this.floatingObjectId=Y;this.commandParameters=Ra;this.Br=zb;this.abh=gc;this.j4=void 0===Id?null:Id;this.$Yd=void 0===Vd?null:Vd;this.F3g=bd}function mb(Y,Ra,zb,gc){Ra=Tb.call(this,Y,Ra,zb,"AcrossSessionRangeCopyPasteHandler",void 0===gc?null:gc)||this;Ra.IU=new Ab(Y);return Ra}function kc(Y,Ra){Ra=void 0===Ra?null:Ra;var zb=Ag.call(this,ci[Y])||this;zb.copyErrorName=0;zb.ewaErrors=null;zb.copyErrorName=Y;zb.ewaErrors=Ra;if(null===Ra||void 0===Ra?0:Ra.length)zb.innerError=new xe.a(Ra,
null);return zb}function Ab(Y){this.IU=new jh.a(!0);this.$=Y}function Tb(Y,Ra,zb,gc,bd){bd=void 0===bd?null:bd;gc=Sa.call(this,Y,gc)||this;gc.P3g=Ra;gc.s$=zb;gc.W2c=bd||new ib(gc.s$);gc.gridView=df.g(Y);gc.ha=gc.gridView.ha;gc.clipboardRangeFactory=Y.da.Aa(169);return gc}function ib(Y){this.clipboardItems=this.key=null;this.s$=Y}function Sa(Y,Ra){this._name=Ra;this.$=Y;this.Km=le.a.instance;this.Ur=new sa(Y,df.g(Y))}function Mb(Y){return Y.shadowWorkbookSizeExceedsLimit?!0:Jc(Y)>Xd.a.Akc}function Jc(Y){return Y?
Y.shadowWorkbookSizeExceedsLimit&&void 0!==Y.shadowWorkbookBlockedSize&&null!==Y.shadowWorkbookBlockedSize?Y.shadowWorkbookBlockedSize:Y.shadowWorkbookBase64?Y.shadowWorkbookBase64.length:0:0}function Ib(){}function Nb(Y){var Ra={};this.C7f=(Ra["SourceItemType.Range"]=0,Ra["SourceItemType.Art"]=1,Ra);this.qLb={};Ra={};this.y7f=(Ra["FloatingObjectType.Unknown"]=99,Ra["FloatingObjectType.CardView"]=6,Ra["FloatingObjectType.Chart"]=0,Ra["FloatingObjectType.Group"]=7,Ra["FloatingObjectType.Image"]=1,
Ra["FloatingObjectType.Ink"]=8,Ra["FloatingObjectType.InteractiveReport"]=4,Ra["FloatingObjectType.ModernOfficeExtension"]=3,Ra["FloatingObjectType.Shape"]=5,Ra["FloatingObjectType.Slicer"]=2,Ra["FloatingObjectType.Unsupported"]=100,Ra);Ra={};this.aXc=(Ra["99"]="FloatingObjectType.Unknown",Ra["6"]="FloatingObjectType.CardView",Ra["0"]="FloatingObjectType.Chart",Ra["7"]="FloatingObjectType.Group",Ra["1"]="FloatingObjectType.Image",Ra["8"]="FloatingObjectType.Ink",Ra["4"]="FloatingObjectType.InteractiveReport",
Ra["3"]="FloatingObjectType.ModernOfficeExtension",Ra["5"]="FloatingObjectType.Shape",Ra["2"]="FloatingObjectType.Slicer",Ra["100"]="FloatingObjectType.Unsupported",Ra);Ra={};this.B7f=(Ra["RibbonCommand.Copy"]=-911352779,Ra["RibbonCommand.Cut"]=-1985798686,Ra);Ra={};this.DLd=(Ra["-911352779"]="RibbonCommand.Copy",Ra["-1985798686"]="RibbonCommand.Cut",Ra);Ra={};this.A7f=(Ra["InputManager.InputMethod.NotDefined"]=-1,Ra["InputManager.InputMethod.Unknown"]=0,Ra["InputManager.InputMethod.Keyboard"]=1,
Ra["InputManager.InputMethod.Mouse"]=2,Ra["InputManager.InputMethod.Touch"]=3,Ra["InputManager.InputMethod.CrossSlide"]=9,Ra);this.qka={};Ra={};this.z7f=(Ra["FrameMode.None"]=0,Ra["FrameMode.Reading"]=1,Ra["FrameMode.Edit"]=2,Ra);this.T2a={};Ra={};this.D7f=(Ra["UILocation.Unknown"]=0,Ra["UILocation.UpperRibbon"]=1,Ra["UILocation.Ribbon"]=2,Ra["UILocation.QAT"]=3,Ra["UILocation.Jewel"]=4,Ra["UILocation.NavigationPane"]=5,Ra["UILocation.KeyboardShortcut"]=6,Ra["UILocation.StatusBar"]=7,Ra["UILocation.Dialog"]=
8,Ra["UILocation.Floatie"]=9,Ra["UILocation.NotificationBar"]=10,Ra["UILocation.StandaloneCuiRoot"]=11,Ra["UILocation.TaskPane"]=12,Ra["UILocation.HeroDock"]=13,Ra["UILocation.SingleLineRibbon"]=14,Ra["UILocation.MultilineRibbon"]=15,Ra["UILocation.Overflow"]=16,Ra["UILocation.TellMe"]=17,Ra["UILocation.FarPeripheralControls"]=18,Ra["UILocation.ContextMenu"]=19,Ra["UILocation.DialogMenu"]=20,Ra["UILocation.Header"]=21,Ra["UILocation.FileMenu"]=22,Ra["UILocation.Toolbar"]=26,Ra["UILocation.Canvas"]=
30,Ra);this.Gr={};this.$=Y;this.qka.notDefined="InputManager.InputMethod.NotDefined";this.qka.unknown="InputManager.InputMethod.Unknown";this.qka.keyboard="InputManager.InputMethod.Keyboard";this.qka.mouse="InputManager.InputMethod.Mouse";this.qka.touch="InputManager.InputMethod.Touch";this.qka.crossSlide="InputManager.InputMethod.CrossSlide";this.T2a.none="FrameMode.None";this.T2a.reading="FrameMode.Reading";this.T2a.edit="FrameMode.Edit";this.Gr.unknown="UILocation.Unknown";this.Gr.upperRibbon=
"UILocation.UpperRibbon";this.Gr.ribbon="UILocation.Ribbon";this.Gr.QAT="UILocation.QAT";this.Gr.jewel="UILocation.Jewel";this.Gr.navigationPane="UILocation.NavigationPane";this.Gr.keyboardShortcut="UILocation.KeyboardShortcut";this.Gr.statusBar="UILocation.StatusBar";this.Gr.dialog="UILocation.Dialog";this.Gr.floatie="UILocation.Floatie";this.Gr.notificationBar="UILocation.NotificationBar";this.Gr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Gr.taskPane="UILocation.TaskPane";this.Gr.heroDock=
"UILocation.HeroDock";this.Gr.singleLineRibbon="UILocation.SingleLineRibbon";this.Gr.multilineRibbon="UILocation.MultilineRibbon";this.Gr.overflow="UILocation.Overflow";this.Gr.tellMe="UILocation.TellMe";this.Gr.farPeripheralControls="UILocation.FarPeripheralControls";this.Gr.header="UILocation.Header";this.Gr.fileMenu="UILocation.FileMenu";this.Gr.contextMenu="UILocation.ContextMenu";this.Gr.dialogMenu="UILocation.DialogMenu";this.Gr.toolbar="UILocation.Toolbar";this.Gr.canvas="UILocation.Canvas";
this.qLb.range="SourceItemType.Range";this.qLb.art="SourceItemType.Art"}function sa(Y,Ra){this.Gic=this.XMa=null;this.Dfc=Nc.EwaSettings.getBooleanFeatureGate(Je.a.y4b,!1);this.Cmd=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6024798_AbortOutstandingCopyOperation");this.nMa=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=Y;this.gridView=Ra;this.Tgc=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeHideCutCopyHighlight",!1);this.Cmd&&
(this.$.userOperationManager.kx(Object(Xe.a)(this,this.EF,"onQueueChanged")),this.ev=new vf.a)}function Va(Y){this.parameters=null;this.parameters=Y}function Xb(Y){this.pasteParameters=null;this.pasteParameters=Y}function mc(Y,Ra){this.content=this.destinationRange=null;this.destinationRange=Y;this.content=Ra}function od(Y,Ra,zb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=Y;this.destinationRange=Ra;this.pasteFlags=zb}function ld(Y,Ra,zb,gc,bd,Id,Vd,ve){ve=void 0===
ve?null:ve;Vd=Y.Na(1,void 0===Vd?null:Vd);Vd.pasteParameters=Ra;return ge.i(Y,"Paste",Vd,zb,gc,bd,Id,64,ve)}function Zc(Y,Ra,zb,gc,bd,Id,Vd,ve){ve=void 0===ve?null:ve;Vd=Y.Na(1,void 0===Vd?null:Vd);Vd.copyParameters=Ra;return ge.i(Y,"Copy",Vd,zb,gc,bd,Id,0,ve)}function Rb(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){Pe=void 0===Pe?null:Pe;ve=Y.Na(9,ve);ve.destinationRange=Ra;ve.source=zb;return ge.i(Y,"PasteString",ve,gc,bd,Id,Vd,64,Pe)}function fd(Y,Ra,zb,gc,bd,Id,Vd,ve){ve=void 0===ve?null:ve;Vd=Y.Na(1,Vd);Vd.pasteHtmlParameters=
Ra;return ge.i(Y,"PasteHtmlContent",Vd,zb,gc,bd,Id,64,ve)}function wd(){this.M_a=this.Cze=null}function Ad(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){Pe=void 0===Pe?null:Pe;var We=Cb.call(this)||this;We.pasteShortcutManager=null;We.Zcf=Nc.EwaSettings.Eb();We.nMa=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);We.J9f=null;We.U6a=!1;We.Jff=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");We.OAd=function(Vf){We.Bxj(Vf)&&(We.Ur.Rwb(),pc.ULS.sendTraceTag(537167777,
0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};We.Pwi=function(Vf,$f){pc.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",Vf,$f);We.gridView.focus()};We.ud=function(Vf,$f){$f.uK||$f.Mg||We.Tr("OnWorkbookOpened",!1).catch(function(){})};We.hi=function(Vf,$f){Vf=cc(We.HK);
var Hg=We.Ur.Evb(Vf);Hg&&($f.pa&&$f.pa.sheetName===Hg.sheetName&&Hg.isFromCurrentSession(We.$)?We.Ur.z9e(Hg.ranges,Vf.commandParameters.commandType):We.Ur.Rwb())};We.inc=function(Vf,$f){Vf=cc(We.HK);(Vf=We.Ur.Evb(Vf))&&$f.item&&$f.item.sheetName===Vf.sheetName&&Vf.isFromCurrentSession(We.$)&&We.Tr("OnItemDeleting",!1).catch(function(){})};We.eEb=function(Vf,$f){We.Zcf?We.J9f(Vf,$f):We.mEf()};We.QR=function(Vf,$f){1===$f.Aw&&$f.Og.operation.flags&2&&We.Tr("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};
We.$=Y;We.Fh=zb;We.gridView=df.g(Y);We.Ur=bd;We.bdi=Id;We.HK=Ra;We.w3b=gc;We.getStringifiedError=Pe||copyPasteInfra.getStringifiedError;We.i3f=1===ve;We.al();We.copyPasteShortcutDialogFactory=We.$.da.Aa(85);pc.ULS.shipAssertTag(537167825,0,!!We.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");Vd||(pc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Vd=Ad.Sch);We.userHash=Xf.a.Qv(Vd);
We.YAi="CultureTag: "+le.a.instance.Frb+" HASH: ";We.HK.addMetadataChangeListener(Ad.Lqf,We.OAd);We.Jvd=We.$.ya.MaxCopyPasteLength;We.ONa=We.nMa?Nc.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",We.$.ya.CopyPasteMaxPayloadLength):Xd.a.ONa;We.ro=Nc.EwaSettings.getBooleanFeatureGate(Je.a.BPa,!1);We.ro&&Y.da.Za(478,function(Vf){We.pasteShortcutManager=Vf});We.Zcf&&(We.J9f=Ld.a(function(){We.mEf()},1,We.$.ma,"CopyPasteInfrastructure.OnStartEditInternal",!0));return We}
function Ne(Y){if(!Y)return"null";var Ra=[];Y=yl(Y.get());for(var zb=Y.next();!zb.done;zb=Y.next())zb=zb.value,zb=String.format("{0}({1})",zb.clipboardDataFormat,zb.data.length),Array.add(Ra,zb);Ra.sort();return Ra.join(",")}function Ve(Y){switch(Y){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function Kd(Y,Ra){return Y?Ra&&Ra.ya?Y.sessionId!==Ra.ya.UserSessionId:(pc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(pc.ULS.shipAssertTag(537166210,
0,!1,"copyContext shouldn't be null"),!1)}function Ud(){}function te(){}function oe(){}function Ke(Y,Ra,zb,gc){this.$=Y;this.originalDestinations=Ra;this.G8b=zb;this.Kkg=gc;this.Iug=this.originalDestinations;this.Bog=this.G8b;this.Yrg="PasteRecoveryUI"}function cc(Y){return Y&&(Y=Y.getCachedMetadata(),null===Y||void 0===Y?0:Y.lastCopy)?Y.lastCopy:null}function sd(Y){return Y.clipboardItems&&(Y=Y.clipboardItems.getItem(rb.Tgi))&&"1"===Y?!0:!1}function zc(Y){return nd(Y)&&!(void 0===Y.clipboardItems||
null===Y.clipboardItems)&&!!Y.clipboardItems.getItem(rb.png)&&!Y.clipboardItems.getItem(rb.vW)}function nd(Y){return Y.clipboardItems&&(Y=Y.clipboardItems.getItem(rb.oki))&&"1"===Y?!0:!1}function rb(){}function Zd(){}function qc(Y){return!!Y&&Object.getType(Y)===pd}function pd(Y,Ra,zb,gc,bd){gc=be.call(this,gc,bd)||this;pc.ULS.shipAssertTag(537167645,0,!!Ra&&0<Ra.length,"RangeSourceItem.ctor: ranges should not be null or empty");gc.$=Y;gc.ranges=Ra;gc.sheetName=zb;return gc}function ne(Y,Ra,zb,gc,
bd){zb=be.call(this,zb,gc)||this;zb.activeFloatingObjectControlId=Y;zb.sheetName=Ra;zb.type=bd;return zb}function be(Y,Ra){var zb=this;this.oHh=function(){var gc={};gc.SourceItem=zb.toString();return gc};this.sessionStateId=Y;this.sessionId=Ra;this.toJSON=this.oHh}function td(Y,Ra,zb,gc,bd){var Id=Y.Stopwatch,Vd={};Vd.a=bd;Vd.e=Id.id;Vd.c="RearrangeRowColumn";Vd.b="mouse";Vd.d=Y.OperationId.toString();Vd.f=zb.toString();Vd.g=gc.toString();Vd.h=Ra.toString();Vd.i=Y.DragDropIsShiftKeyDown;Vd.j=!0;Vd.o=
Id.Ec;Vd.q=!1;Vd.r=Y.CopyPasteTargetType.toString();Vd.s=Y.EncounteredDeploymentErrors;return Vd}function Qe(Y){Y=zf.call(this,Y)||this;Y.pZg=function(){pc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};pc.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");Y.kc=0;Y.Gc(1,le.a.instance.fa(2191));var Ra=le.a.instance.fa(2189),zb=Y.pV();Y.initializeAndShow(Ra,Y.pZg,zb);return Y}function Qf(){this.tb=null}function pf(){this.kib=
this.TRb=this.Gv=null}function $d(Y,Ra,zb,gc,bd){this.Gv=Y;this.xib=Ra;this.tib=zb;this.Ude=void 0===gc?null:gc;this.Hkb=void 0===bd?null:bd}function je(){this.tb=null}function md(Y){this.nc=Y}function ee(){this.Qie=0;this.xWa=Array(5);this.xWa[0]=10;this.xWa[1]=15;this.xWa[2]=50;this.xWa[3]=100;this.xWa[4]=200}function qf(Y,Ra,zb,gc,bd){this.j$b=!1;this.Orb=null;this.La=Y;this.NXa=Ra;this.dVb=zb;this.q1=gc;this.JEc=bd}function Fc(){this.gPf=this.YTf=this.Y8f=this.bjc=this.instance=null}function Ed(Y,
Ra,zb){this.La=Y;this.gf=Ra;this.vSb=zb}function Sd(){this.completed=this.$$i=!1}function qd(){this.lhe=this.ybe=this.T1d=!0;this.Dfj=this.YZi=null;this.KCi=!1;this.locale=null;this.Dbg={}}function ke(){}function Se(){this.CUb=this.SRb=null}function of(Y){return Ze.call(this,Y)||this}function vc(){this.tb=null}function id(Y,Ra){if(void 0===Y||null===Y||void 0===Ra||null===Ra)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.wb=Y;this.Sg=Ra;this.uQc=this.Be=null}function Ac(){this.FJe=
this.tfg=this.Ht=0;this.GJe=this.ufg=this.pHa="";this.fRc=this.Fea=2}function Yd(Y,Ra){this.RFc=0;this.l2b=null;this.Jib=new Qd(Y,Ra);this.wb=Y;Ra=Y.Ua("HostAuthType");this.jEa=Y.ra("OcpsIsEnabled")&&Y.ra("IsO365CommercialHost")&&!(void 0===Ra||null===Ra)&&"aad"===Ra.toLowerCase();this.vce=Kf.b(Y.Ua("OcpsDefaultSettings")||"{}");this.zjb=this.dbc();Ra=this.wb.Sy("ServicesControlsMicrosoftControllerServicesList")?this.wb.fw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.MQb=new yf.a;
for(var zb=0;zb<Ra.length;zb++)this.MQb.add(Ra[zb]);this.jEa&&!Y.ra("IsAnonymousUser")&&Y.ra("SideCarIsEnabled")?this.l2b=this.GOj():this.l2b=this.roa(this.jEa,this.hva("/afhs/CloudPolicySettings.ashx"),Object(Xe.a)(this,this.bYi,"parseCloudPolicySettingsResponse"));this.l2b.then(function(){return null}).catch(function(gc){pc.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(gc))})}function Cd(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function wf(){}function Vb(Y,Ra){this.PolicySettings=
null;this.ExpirationTime=0;this.PolicySettings=Y.PolicySettings;Y=new Date;Y.setMinutes(Y.getMinutes()+Ra);this.ExpirationTime=Y.getTime()}function wc(Y,Ra,zb,gc,bd){var Id=this;zb=void 0===zb?null:zb;gc=void 0===gc?null:gc;bd=void 0===bd?null:bd;this.uua=this.gVb=this.dfe=this.rqa=this.mWb=null;this.Jib=new Qd(Y,Ra);this.wb=Y;this.csg=Y.Bd("LicensingMaxRetryAttempts",0);this.XKc=Y.ra("IsO365ConsumerHost");this.WKc=Y.ra("IsO365CommercialHost");this.MSb=Y.ra("PremiumUpsellIsEnabled");this.r3d=zb;this.uje=
gc;this.La=bd;this.qqa=Y.ra("LicensingIsEnabled");this.jEa=Y.ra("OcpsIsEnabled")&&this.WKc;this.ySc=Y.ra("ShowPrivacyDialog")&&!!gc;this.J8d=Y.ra("IsAnonymousUser");this.$$c=new Promise(function(Vd){Vd(!1)});this.qBa=new Promise(function(Vd){Vd(!0)});this.tua=new Be.a(Ce.a.Gk());this.aXb=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.lae=this.nTh();this.ppd()&&!this.J8d?(void 0!==Tc.AFrameworkApplication.sa&&null!==Tc.AFrameworkApplication.sa&&
(this.mWb=Tc.AFrameworkApplication.sa.vD,void 0!==this.mWb&&null!==this.mWb&&(this.rqa=this.mWb.Vh("WebServiceCall","ApplicationFeatureHelperService"))),this.uua=this.QWd()):this.uua=new Promise(function(Vd){Vd({})});this.uua.catch(function(Vd){pc.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Vd))});this.aXb&&(this.MSb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Vd){Id.MSb=Id.wb.ra("PremiumUpsellIsEnabled")&&Vd;return null}))}function yb(Y,Ra,zb){this.featureName=null;this.isEnabled=
!1;this.tierName=0;this.featureName=Y;this.isEnabled=Ra;this.tierName=zb}function oc(Y,Ra){this.dMj=3E5;if(void 0===Y||null===Y||void 0===Ra||null===Ra)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.wb=Y;this.LPb=new Be.a(Ce.a.Gk());this.Jib=new Qd(Y,Ra);void 0!==ye.a.Dud&&null!==ye.a.Dud&&void 0!==ye.a.Vjc&&null!==ye.a.Vjc&&0<ye.a.Vjc&&(Y=new Wc,Y.Token=ye.a.Dud,Y.ExpirationTime=ye.a.Vjc,this.LPb.ia("loki",Y))}function Wc(){this.Token=null;this.ExpirationTime=0}function Qd(Y,
Ra){this.wb=Y;this.Sg=Ra}function Sc(){this.message=null;this.Sdc=0}b.r(F);var Yc=b(0),pc=b(13),Be=b(805),Ce=b(574),Xe=b(80),ob=b(84),Ic;(function(Y){Y[Y.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";Y[Y.cloudPolicySettings=1]="cloudPolicySettings";Y[Y.alternateAuthToken=2]="alternateAuthToken"})(Ic||(Ic={}));Object(Yc.b)("ApplicationFeatureHelperRequestType",Ic);Object(Yc.a)(Sc,"HttpRequstToPromiseRejectData",null,[]);var Cc=b(95),Uc=b(231);Qd.prototype.P3c=function(Y,Ra,zb,
gc,bd,Id,Vd,ve){var Pe=this;gc=void 0===gc?null:gc;bd=void 0===bd?null:bd;Id=void 0===Id?null:Id;Vd=void 0===Vd?null:Vd;ve=void 0===ve?null:ve;var We=Ic[zb],Vf=We+"RequestFailure";Cc.Health.instance.recordKpiUsage(Vf,0,"jpittsdirects",null);return new Promise(function($f,Hg){pc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",We);var Tg=null!=Vd?Vd:Pe.wb.Bd("ApplicationFeatureHelperRequestQueueTimeout",15E3),Bi=null!=ve?ve:Pe.wb.Bd("ApplicationFeatureHelperRequestSentTimeout",
3E4);Pe.Sg.E9(Y,1,null,Pe.RRh(zb,gc),Id,!1,1,function(Cf){pc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",We);try{if(void 0===Cf||null===Cf||void 0===Cf.data||null===Cf.data||void 0===Cf.data.je||null===Cf.data.je){Cc.Health.instance.recordKpiFailure(Vf,"Invalid RequestSucceededEventArgs",!1,!0,null);var Ih=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
We);Hg(Pe.Fvb(Ih,Cf))}else if(Cf.data.httpStatus!==Uc.a.fP){Cc.Health.instance.recordKpiFailure(Vf,"HttpStatusCode_"+Cf.data.httpStatus.toString(),!1,!0,null);var Eh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Cf.data.httpStatus,We);Hg(Pe.Fvb(Eh,Cf))}else{void 0!==bd&&null!==bd&&void 0!==Cf.data.responseHeaders&&null!==Cf.data.responseHeaders&&bd(Cf.data.responseHeaders);
var Gg=Ra(Cf.data.je);if(Gg)pc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",We),$f(Gg);else{Cc.Health.instance.recordKpiFailure(Vf,"Parse Failure",!1,!0,null);var ti=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",We);Hg(Pe.Fvb(ti,Cf))}}}catch(R){Cc.Health.instance.recordKpiFailure(Vf,"Unexpected Failure",!1,!0,null),Ih=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
R,We),Hg(Pe.Fvb(Ih,Cf))}},function(Cf){pc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",We);if(Cf.data){Cc.Health.instance.recordKpiFailure(Vf,"HttpStatusCode_"+Cf.data.httpStatus.toString(),!1,!0,null);var Ih=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Cf.data.httpStatus,Cf.data.je||"No Data",We)}else Cc.Health.instance.recordKpiFailure(Vf,
"Invalid RequestFailedEventArgs",!1,!0,null),Ih=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",We);Hg(Pe.Fvb(Ih,Cf))},null,void 0,void 0,Tg,Bi)})};Qd.prototype.Fvb=function(Y,Ra){var zb=new Sc;zb.message=Y;zb.Sdc=Ra&&Ra.data?Ra.data.httpStatus:-1;return zb};Qd.prototype.RRh=function(Y,Ra){var zb={};zb["x-UserDataSignature"]=this.wb.Ua("UserDataSignature");zb["x-LicensingIsEnabled"]=this.wb.ra("LicensingIsEnabled").toString();
zb["x-CacheIsEnabled"]=this.wb.ra("LicensingRedisIsEnabled").toString();zb["x-OcpsIsEnabled"]=this.wb.ra("OcpsIsEnabled").toString();zb["x-LicensingAADIdIsEnabled"]=this.wb.ra("LicensingAadIdIsEnabled").toString();0===Y&&(zb["x-LicenseCheckOnTenantEnabled"]=this.wb.ra("LicensingForSafeLinksIsEnabled").toString(),zb["x-SupportUserConsentDependentFeatures"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),zb["x-AFHUserConsentGroupValue"]=
this.wb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),zb["x-UseShellServiceForUserConsentGroup"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),zb["x-UseSALForLicensing"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),zb["x-SMBUserLicensingEnabled"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());
if(Ra){Y=yl(Ra.keys);for(var gc=Y.next();!gc.done;gc=Y.next())gc=gc.value,zb[gc]=Ra.oa(gc)}return zb};Object(Yc.a)(Qd,"HttpRequestToPromiseUtility",null,[]);var Tc=b(5),ce;(function(Y){Y[Y.loki=0]="loki";Y[Y.augloopACLP=1]="augloopACLP"})(ce||(ce={}));Object(Yc.b)("AlternateAuthSupportApp",ce);var ye=b(857),Kf=b(40);Object(Yc.a)(Wc,"WacAlternateAuthToken",null,[]);oc.prototype.gKh=function(){var Y=null;this.LPb.xb(ce[0])&&(Y=this.LPb.oa(ce[0]));return void 0===Y||null===Y||this.drd(Y)?this.UAh():
Promise.resolve(Y.Token)};oc.prototype.drd=function(Y){return Y.ExpirationTime-Date.now()<this.dMj};oc.prototype.UAh=function(){var Y=this,Ra=new Be.a(Ce.a.Gk());Ra.ia("X-AlternateAuthApp",ce[0]);return this.Jib.P3c(this.hva("/afhs/AlternateAuthHelperHandler.ashx"),Object(Xe.a)(this,this.YXi,"parseAlternateAuthTokenResponse"),2,Ra).then(function(zb){pc.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ce[0]);Y.LPb.ia(ce[0],
zb);return zb.Token},function(zb){zb=Object(ob.a)(Sc,zb);pc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",zb.message,zb.Sdc);return null})};oc.prototype.YXi=function(Y){var Ra=Kf.d(Y).Iu;pc.ULS.sendTraceTag(545821457,3004,Ra?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",Y);return Ra};oc.prototype.hva=function(Y){return String.format("{0}{1}?{2}",this.wb.Ua("WebServiceBase"),Y,Tc.AFrameworkApplication.lj)};
Object(Yc.a)(oc,"AlternateAuthHelper",null,[237]);var yf=b(460);Object(Yc.a)(yb,"FeatureStateChangeArgs",null,[]);var Pf=b(129),ec=b(277),Qc=b(23),Dd=b(109),Jd=b(177),ze;(function(Y){Y[Y.Enabled=0]="Enabled";Y[Y.Disabled=1]="Disabled"})(ze||(ze={}));Object(Yc.b)("FeatureState",ze);var ie=b(87),jf=b(30),mf=b(338);wc.prototype.nTh=function(){for(var Y=this.wb.Sy("AllLicensedFeatures")?this.wb.fw("AllLicensedFeatures"):[],Ra=new yf.a,zb=0;zb<Y.length;zb++)Ra.add(Y[zb]);return Ra};wc.prototype.ppd=function(){return this.WKc||
this.XKc};wc.prototype.QWd=function(Y,Ra){var zb=this;Y=void 0===Y?0:Y;Ra=void 0===Ra?!1:Ra;pc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Ra);var gc=Pf.a.Vr();gc&&(gc.set("retryAttempt",Y.toString()),gc.set("forceRefresh",Ra.toString()),gc.set("isO365ConsumerHost",this.XKc.toString()),gc.set("isO365CommercialHost",this.WKc.toString()),gc.set("isFreemiumUpsellEnabled",this.MSb.toString()));Cc.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",gc);Cc.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",gc);void 0!==this.rqa&&null!==this.rqa&&this.rqa.start();var bd=null;Ra&&(bd=new Be.a(Ce.a.Gk()),bd.ia("x-LicensingForceRefresh","true"));this.dfe=new Date;return(this.qqa?this.Jib.P3c(this.hva("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(Xe.a)(this,this.aYi,"parseApplicationFeatureHelperResponse"),0,bd,Object(Xe.a)(this,this.o2i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):
Promise.resolve({})).then(function(Id){var Vd=Object.assign(new mf.a,{durationMs:zb.X6f()});Vd.extendedProperties=gc;Vd.extendedProperties&&Id&&(Vd.extendedProperties.set("featureCount",Dd.a.count(Id).toString()),Vd.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Id).toString()),Vd.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Id).toString()),zb.gVb&&Vd.extendedProperties.set("fromCache",(zb.gVb<zb.dfe).toString()));Cc.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
Vd);return Id},function(Id){var Vd=Object.assign(new mf.a,{durationMs:zb.X6f()}),ve=Object(ob.a)(Sc,Id);if(!ve)return pc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Cc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Vd),new Promise(function(Pe,We){We(Id)});Vd.extendedProperties=gc;Vd.extendedProperties&&Vd.extendedProperties.set("status",ve.Sdc.toString());
Cc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Vd);return 408===ve.Sdc&&++Y<=zb.csg?zb.QWd(Y):new Promise(function(Pe,We){We(ve)})})};wc.prototype.aYi=function(Y){(Y=Kf.b(Y))?(pc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),pc.ULS.sendTraceTag(50938594,3004,50,"{0}",Y)):pc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return Y.Features};wc.prototype.hva=function(Y){var Ra=String.format("{0}{1}",this.wb.Ua("WebServiceBase"),Y);this.wb.Sy("ApplicationFeatureHelperHttpCachingEnabled")&&this.wb.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(Y=wc.dbc(this.wb))&&0<Y.length&&(this.aXb&&(Y+="ucbf"),Ra=new ec.QueryStringBuilder(Ra),Ra.Gi("afhskey",Y),Ra=Ra.toString());return Ra};wc.prototype.isFeatureEnabled=function(Y,Ra){var zb=this;if(!this.jEa&&!this.ySc&&!this.qqa)return this.qBa;pc.ULS.sendTraceTag(42513091,3004,
50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",Y);if("ConnectedServices"===Y){var gc=this.jEa?this.r3d.XJ("ControllerConnectedServicesEnabled"):this.qBa,bd=this.ySc?this.uje.getSettings().then(function(ve){return 2!==ve.Ht},function(){return Ra}):this.qBa;return gc.then(function(ve){return ve?bd:zb.$$c})}gc=null;gc=this.jEa?this.r3d.isFeatureEnabled(Y):this.qBa;var Id=null;Id=this.qqa?this.zii(Y,Ra):this.qBa;var Vd=null;Vd=this.ySc?this.uje.isFeatureEnabled(Y):
this.qBa;return gc.then(function(ve){return ve?Vd.then(function(Pe){return Pe?Id:zb.$$c}):zb.$$c}).then(function(ve){zb.Imf(Y,ve,!0);return ve},function(){zb.Imf(Y,Ra,!1);return Ra})};wc.prototype.Imf=function(Y,Ra,zb){pc.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",Y,Ra,zb)};wc.prototype.getFeatureTier=function(Y,Ra){var zb=this;if(!this.qqa)return new Promise(function(gc){gc(2)});pc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
Y);return this.uua.then(function(gc){return zb.Zbc(Y,gc,Ra)},function(){return Ra})};wc.prototype.isFreemiumUpsellEnabled=function(){return this.MSb&&this.XKc&&!this.J8d};wc.prototype.launchUpsellExperience=function(Y,Ra){Ra=void 0===Ra?null:Ra;pc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",Y));var zb=Pf.a.Vr();zb&&(zb.set("experienceId",Y),Ra&&zb.set("campaignId",Ra));Cc.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",zb);if(zb=ie.a.instance.Nh("Common.IInProductMessagingUIManager")){var gc=Object(Xe.a)(this,this.E3h,"handleDimeTaskComplete");zb.Skf(Y,gc,Ra)}else pc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Ra={},this.La.De(jf.a.k$b,2,(Ra.experience=Y,Ra))};wc.prototype.Aza=function(Y,Ra){if(!this.qqa)return null;if(!Y||!Ra)return pc.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var zb=Jd.a.create().toString();this.tua.xb(Y)||this.tua.ia(Y,new Be.a(Ce.a.Gk()));this.tua.oa(Y).add(zb,Ra);pc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",zb,Y));return zb};wc.prototype.pId=function(Y,Ra){this.qqa&&(Y&&this.tua.xb(Y)?Ra&&Jd.a.isValid(Ra)?this.tua.oa(Y).xb(Ra)?(pc.ULS.sendTraceTag(594564808,
3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",Ra,Y)),this.tua.oa(Y).remove(Ra)):pc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Ra,Y)):pc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Ra,Y)):pc.ULS.sendTraceTag(594564811,
3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",Y)))};wc.prototype.Zbc=function(Y,Ra,zb){return this.aXb?Y in Ra?Ra[Y].LicenseTier:zb:Y in Ra?this.yYi(Ra[Y],zb):zb};wc.prototype.yYi=function(Y,Ra){switch(Y.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Ra}};wc.prototype.E3h=function(){var Y=this;pc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.uua.then(function(Ra){Y.lOf(Ra)}).catch(function(){Y.lOf({})})};wc.prototype.lOf=function(Y){var Ra=this;pc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var zb=this.QWd(0,!0);zb.then(function(gc){Ra.uua=zb;Dd.a.count(gc)>Dd.a.count(Y)?Cc.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var bd=yl(Ra.tua.keys),Id=bd.next();!Id.done;Id=
bd.next())if(Id=Id.value,Id in gc){var Vd=Ra.Zbc(Id,gc,0);Id in Y?Ra.Zbc(Id,Y,0)!==Vd&&Ra.hyd(Id,!0,Vd):Ra.hyd(Id,!0,Vd)}else Id in Y&&Ra.hyd(Id,!1,Ra.Zbc(Id,Y,0))}).catch(function(gc){Cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);pc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(gc))})};wc.prototype.hyd=function(Y,Ra,zb){pc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
Y,Ra,zb);Ra=new yb(Y,Ra,zb);zb=this.tua.oa(Y);zb=yl(zb);for(var gc=zb.next();!gc.done;gc=zb.next()){gc=gc.value;try{gc.value(Ra)}catch(bd){pc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",Y,gc.key,bd.message))}}};wc.prototype.ue=function(Y,Ra){var zb=this;if(this.qqa){var gc=this.lae.contains(Y),bd=!0,Id="",Vd=!1;return this.uua.then(function(ve){Y in ve?
(ve=ve[Y],Id=ze[ve.FeatureState],bd=1!==ve.FeatureState):bd=!gc;zb.Qmf(Y,gc,Id,Vd,Ra,bd);return bd},function(){Vd=!0;gc&&(bd=Ra);zb.Qmf(Y,gc,Id,Vd,Ra,bd);return bd})}return this.qBa};wc.prototype.Qmf=function(Y,Ra,zb,gc,bd,Id){pc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",Y,Ra,gc,zb,bd,Id)};wc.prototype.zii=function(Y,Ra){if(this.aXb)return this.ue(Y,Ra);if(this.qqa){if(this.lae.contains(Y))return this.uua.then(function(zb){return Y in
zb},function(){return Ra});pc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",Y)}return this.qBa};wc.prototype.o2i=function(Y){try{Y&&"Date"in Y&&(this.gVb=new Date(Y.Date),pc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.gVb.toString()))}catch(Ra){pc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
Ra)}};wc.prototype.X6f=function(){if(void 0!==this.rqa&&null!==this.rqa){var Y=this.rqa.Ec;this.rqa.stop();return Y}return null};wc.dbc=function(Y){try{if(Qc.a.uIj){var Ra=Y.Ua("UserDataSignature").split(".");if(1<Ra.length){var zb=window.self.atob(Ra[1]),gc=JSON.parse(zb).LocalStorageKey;if(void 0!==gc&&null!==gc&&0<gc.length)return gc}}}catch(bd){pc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",bd.toString())}return null};Object(Yc.a)(wc,"ApplicationFeatureHelper",null,
[238]);var vf=b(185);Object(Yc.a)(Vb,"CloudPolicySettingsCacheData",null,[]);var rg=b(951),he=b(375),eg=b(219);wf.j5f=function(){return Tc.AFrameworkApplication.ga.ra("SideCarIsEnabled")?wf.ruc&&wf.Lnd?new Promise(function(Y){Y(!0)}):new Promise(function(Y,Ra){wf.ruc=eg.a.create(Tc.AFrameworkApplication.ga.Ua("SideCarUrl"));he.a.Fia(wf.ruc);wf.ruc.J9(function(zb,gc){(wf.Lnd=gc.succeeded)?Y(gc.succeeded):Ra(gc.succeeded)})}):new Promise(function(Y){Y(!1)})};wf.Lnd=!1;wf.ruc=null;Object(Yc.a)(wf,"SideCarLoader",
null,[]);Object(Yc.a)(Cd,"CloudPolicySettingsData",null,[]);Yd.prototype.XJ=function(Y,Ra){Ra=void 0===Ra?!0:Ra;if(!this.jEa){var zb=this;return new Promise(function(Vd){Vd(zb.rvb(Y))})}var gc=this,bd=this,Id=this.l2b.then(function(Vd){try{var ve=null;Vd.PolicySettings&&"unknown"in Vd.PolicySettings&&(ve=Vd.PolicySettings.unknown);if(ve){if(Y in ve&&void 0!==ve[Y]&&null!==ve[Y])return new Promise(function(We){We("0"!==ve[Y])});var Pe=Y.toLowerCase();if(Pe in ve&&void 0!==ve[Pe]&&null!==ve[Pe])return new Promise(function(We){We("0"!==
ve[Pe])});pc.ULS.sendTraceTag(51512667,3004,50,"Policy"+Y+" not found, using default");return new Promise(function(We){We(gc.rvb(Y))})}return new Promise(function(We){We(gc.rvb(Y))})}catch(We){return pc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+Y+" policy value. Error Message: {0}",We.message),gc.handleError(We.toString(),Ra,gc.rvb(Y))}},function(Vd){return bd.handleError(Vd,Ra,bd.rvb(Y))});Id.then(function(Vd){pc.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
Y,Vd);return null});return Id};Yd.prototype.isFeatureEnabled=function(Y,Ra){Ra=void 0===Ra?!0:Ra;if(this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.Bii(Y,Ra);var zb=new Promise(function(bd){bd(!0)}),gc="";this.MQb.contains(Y)&&(gc="ControllerConnectedServicesEnabled",zb=this.XJ(gc,Ra));zb.then(function(bd){pc.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
Y,bd,gc);return null});return zb};Yd.prototype.Bii=function(Y,Ra){Ra=void 0===Ra?!0:Ra;var zb=new Promise(function(bd){bd(!0)}),gc="";"mso_sendASmile"===Y?gc="Enabled":"Survey"===Y||"FloodgateSurvey"===Y?gc="SurveyEnabled":this.MQb.contains(Y)&&(gc="ControllerConnectedServicesEnabled");""!==gc&&(zb=this.XJ(gc,Ra));zb.then(function(bd){pc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",Y,bd,gc);return null});return zb};
Yd.prototype.handleError=function(Y,Ra,zb){return Ra?new Promise(function(gc){gc(zb)}):new Promise(function(gc,bd){bd(Y)})};Yd.prototype.roa=function(Y,Ra,zb){var gc=this;if(!Y)return Promise.resolve(new Cd);var bd=!1,Id=null;Cc.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Vd=this.l3c("GetCloudPolicySettings");return(new Promise(function(ve,Pe){if(void 0!==gc.zjb&&null!==gc.zjb&&0<gc.zjb.length){var We=gc.qOj();if(void 0!==We&&null!==We){bd=!0;ve(We);return}}gc.Jib.P3c(Ra,
zb,1,null,Object(Xe.a)(gc,gc.s2i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],gc.wb.Bd("CloudPolicySettingsRequestQueueTimeout",15E3),gc.wb.Bd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(Vf){pc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");gc.ePj(Vf);ve(Vf);return Vf},function(Vf){Pe(Vf);return null})})).then(function(ve){var Pe=gc.vyc(Vd);Vd=Pe.stopwatch;Id=Pe.returnValue;(Pe=Pf.a.Vr())&&Pe.set("FromCache",bd.toString());Pe=
Object.assign(new mf.a,{durationMs:Id,extendedProperties:Pe});Cc.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Pe);return ve})};Yd.prototype.GOj=function(){return wf.j5f().then(function(){pc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};Yd.prototype.hva=function(Y){return String.format("{0}{1}",this.wb.Ua("WebServiceBase"),Y)};Yd.prototype.bYi=function(Y){var Ra=
Kf.d(Y).Iu;pc.ULS.sendTraceTag(50622687,3004,Ra?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",Y);return Ra};Yd.prototype.s2i=function(Y){try{if(void 0!==Y&&null!==Y&&"CheckIn-Interval"in Y){var Ra=parseInt(Y["CheckIn-Interval"]);void 0!==Ra&&null!==Ra&&0<Ra&&(this.RFc=Ra)}}catch(zb){pc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",zb)}};Yd.prototype.rvb=function(Y){return Y in this.vce?"0"!==this.vce[Y]:!0};Yd.prototype.qOj=
function(){try{var Y=rg.a.instance.getItem(this.zjb);if(void 0===Y||null===Y)return pc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;pc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",Y);var Ra=JSON.parse(Y);if(void 0===Ra||null===Ra)return pc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===
Ra.ExpirationTime||null===Ra.ExpirationTime)return pc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Ra.ExpirationTime)).getTime()<Date.now())return pc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var zb=new Cd;zb.PolicySettings=Ra.PolicySettings;zb.ControllerConnectedServicesFeatureNames=new vf.a;this.wb.Sy("ServicesControlsMicrosoftControllerServicesList")&&
this.wb.fw("ServicesControlsMicrosoftControllerServicesList");for(var gc=yl(this.MQb),bd=gc.next();!bd.done;bd=gc.next())zb.ControllerConnectedServicesFeatureNames.add(bd.value);pc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return zb}catch(Id){return pc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Id.toString()),null}};Yd.prototype.ePj=function(Y){try{if(void 0===Y||null===Y||void 0===Y.PolicySettings||
null===Y.PolicySettings)pc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.RFc)pc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Ra=new Vb(Y,this.RFc),zb=JSON.stringify(Ra);pc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",zb);rg.a.instance.setItem(this.zjb,zb);pc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(gc){pc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",gc.toString())}};Yd.prototype.dbc=function(){var Y=wc.dbc(this.wb);return Y&&0<Y.length?"OCPS"+Y:null};Yd.prototype.l3c=function(Y){var Ra=ie.a.instance.Nh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Ra&&null!==Ra?Ra.Ic("WebServiceCall",Y):null};Yd.prototype.vyc=function(Y){if(void 0!==Y&&null!==Y){var Ra=Y.Ec;Y.stop();return{returnValue:Ra,stopwatch:null}}return{returnValue:null,stopwatch:Y}};Object(Yc.a)(Yd,
"CloudPolicySettingsHelper",null,[235]);Ac.prototype.clone=function(){var Y=new Ac;Y.Ht=this.Ht;Y.tfg=this.tfg;Y.FJe=this.FJe;Y.pHa=this.pHa;Y.ufg=this.ufg;Y.GJe=this.GJe;Y.Fea=this.Fea;Y.fRc=this.src;return Y};Ac.prototype.serialize=function(Y){Y=void 0===Y?null:Y;var Ra={};if(!Y||Y.contains(Ac.iOa))Ra[Ac.iOa]=this.Ht;if(!Y||Y.contains(Ac.JCb))Ra[Ac.JCb]=this.pHa;if(!Y||Y.contains(Ac.KCb))Ra[Ac.KCb]=this.Fea;return JSON.stringify(Ra)};Ac.create=function(Y,Ra){Ra=void 0===Ra?null:Ra;var zb=new Ac;
zb.fRc=Y;void 0!==Ra&&null!==Ra&&(Ac.iOa in Ra&&(zb.Ht=Ra[Ac.iOa]),Ac.JCb in Ra&&(zb.pHa=Ra[Ac.JCb]),Ac.KCb in Ra&&(zb.Fea=Ra[Ac.KCb]));return zb};Ac.deserialize=function(Y,Ra){try{var zb=JSON.parse(Y);if(void 0!==zb&&null!==zb)return Ac.create(Ra,zb);pc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",Y);throw Error.argument("settingsData");}catch(gc){throw pc.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",gc.toString()),
gc;}};Qk.Object.defineProperties(Ac.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.fRc}}});Ac.iOa="CCS";Ac.JCb="CCSTime";Ac.KCb="OfficePrivacyRoamedNoticeShown";Object(Yc.a)(Ac,"UserPrivacySettings",null,[]);var tg=b(120);id.prototype.hva=function(Y){var Ra=String.format("{0}RoamingServiceHandler.ashx?action=",this.wb.appSettings.RoamingServiceHandlerWebServiceBase||"");Ra=new Sys.StringBuilder(Ra);Ra.append(Y);Ra.append("&");Ra.append(Tc.AFrameworkApplication.lj);return Ra.toString()};
id.prototype.executeRequest=function(Y,Ra,zb,gc){return this.Sg.wYb(Y,Ra,void 0===gc?null:gc,null,zb,"33",!1,null,6E4)};id.prototype.saveSettings=function(Y){var Ra=this;return new Promise(function(zb,gc){try{if(void 0===Ra.Be||null===Ra.Be||void 0===Y||null===Y)pc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),gc("Can't determine setting changes to save");else{var bd=Ra.Be.Ht!==Y.Ht;if(2===Ra.Be.src&&bd)Ra.llj(Y),zb(!0);else{var Id=Ra.mpj(Y);
if(void 0===Id||null===Id||!Id.length)pc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),gc("No changes to save");else if(1===Ra.Be.src)zb(Ra.nbg(Id));else if(0===Ra.Be.src){pc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Id);var Vd=Ra.executeRequest(Ra.hva("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Id);Vd.continueWith(function(){if(Vd.Hh||Vd.kg)pc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
zb(!1);else{var ve=Vd.result;void 0!==ve.Zg&&null!==ve.Zg&&void 0!==ve.Zg.data&&null!==ve.Zg.data&&ve.Zg.data.httpStatus===Uc.a.fP?(pc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),zb(!0)):(pc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),zb(!1))}})}}}}catch(ve){pc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ve.toString()),zb(!1)}})};id.prototype.mpj=function(Y){if(void 0===this.Be||null===
this.Be||void 0===Y||null===Y)throw Error.invalidOperation("User Privacy settings have not been initialized");var Ra=new vf.a;0===Y.src?(this.Be.Ht!==Y.Ht&&(Ra.add(Ac.iOa),Ra.add(Ac.JCb)),this.Be.Fea!==Y.Fea&&Ra.add(Ac.KCb)):1===Y.src&&this.Be.Ht!==Y.Ht&&Ra.add(Ac.iOa);return Ra.count?Y.serialize(Ra):(pc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};id.prototype.getSettings=function(){if(!this.uQc){var Y=this;this.uQc=new Promise(function(Ra){try{Y.Be?
Ra(Y.Be.clone()):Y.yOj().then(function(zb){Y.Be=zb;Ra(Y.Be.clone());return null},function(){Y.wOj().then(function(zb){Y.Be=zb;Ra(Y.Be.clone());return null},function(){Y.xOj().then(function(zb){Y.Be=zb;Ra(Y.Be.clone());return null},function(){pc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");Y.Be=new Ac;Ra(Y.Be.clone());return null});return null});return null})}catch(zb){pc.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
zb.toString()),Y.Be=new Ac,Ra(Y.Be.clone())}})}return this.uQc};id.prototype.yOj=function(){var Y=this;return new Promise(function(Ra,zb){try{var gc=-1!==window.location.href.indexOf("&wd_pn=2");if(Y.wb.ra("PrivacyDialogShouldCheckRoaming")||gc){var bd=Y.executeRequest(Y.hva("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");bd.continueWith(function(){try{if(bd.Hh||bd.kg)pc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var Id=bd.result;
if(Id&&Id.Zg&&Id.Zg.data)if(Id.Zg.data.httpStatus!==Uc.a.fP)pc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Id.Zg.data.httpStatus);else{if(Id.Zg.data.je){Ra(id.parse(Id.Zg.data.je,0));pc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Id.Zg.data.je);return}pc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else pc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");zb("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Vd){pc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Vd.toString()),zb("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else pc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),zb("Roaming should not be used")}catch(Id){pc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Id.toString()),zb("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};id.prototype.wOj=function(){var Y=this;return new Promise(function(Ra,zb){try{var gc=tg.a.get("WacUPToggleState"),bd=null;void 0!==gc&&null!==gc&&0<gc.length&&(bd=decodeURIComponent(gc));if(void 0!==bd&&null!==bd&&0<bd.length){var Id=id.parse(bd,1);pc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Id.toString());
Ra(Id)}else{var Vd=Ac.create(1),ve=new vf.a;ve.add(Ac.iOa);var Pe=Vd.serialize(ve);Y.nbg(Pe)?(pc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Pe),Ra(Vd)):(pc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Pe),zb("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(We){pc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
We.toString()),zb("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};id.prototype.xOj=function(){return new Promise(function(Y){try{var Ra=-1!==window.location.href.indexOf("&wdccsoff=1"),zb=Ac.create(2);Ra?(zb.Ht=2,Tc.AFrameworkApplication.lIe(),pc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",zb.toString())):(zb.Ht=1,pc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
zb.toString()));Y(zb)}catch(gc){pc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",gc.toString()),Ra=Ac.create(2),Ra.Ht=1,Y(Ra)}})};id.prototype.llj=function(Y){pc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===Y.Ht?Tc.AFrameworkApplication.lIe():Tc.AFrameworkApplication.Skh();pc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",Y)};id.prototype.nbg=function(Y){try{pc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",Y);var Ra=this.wb.Ua("PrivacyCookieDomain")||"";if(!Ra||!Ra.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");pc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",Y);return tg.a.oPd("WacUPToggleState",Y,tg.a.eW,"/",Ra)}catch(zb){return pc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",zb.toString()),!1}};id.prototype.isFeatureEnabled=
function(Y){var Ra=this;return this.getSettings().then(function(zb){for(var gc=Ra.wb.Sy("ServicesControlsMicrosoftControllerServicesList")?Ra.wb.fw("ServicesControlsMicrosoftControllerServicesList"):[],bd=new yf.a,Id=0;Id<gc.length;Id++)bd.add(gc[Id]);return bd.contains(Y)?2!==zb.Ht:!0},function(){pc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",Y);return!0})};id.parse=function(Y,Ra){try{return pc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
Y,Ra),Ac.deserialize(Y,Ra)}catch(zb){throw pc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",zb.toString()),zb;}};Object(Yc.a)(id,"UserPrivacySettingsHelper",null,[236]);var Wd=b(273);vc.prototype.ii=function(Y){var Ra=this;this.tb=Y;this.tb.register(235,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Cc().Mc(function(){return new Yd(Tc.AFrameworkApplication.ga,Tc.AFrameworkApplication.Kd)});this.tb.register(236,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Cc().Mc(function(){return new id(Tc.AFrameworkApplication.ga,
Tc.AFrameworkApplication.Kd)});this.tb.register(237,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Cc().Mc(function(){return new oc(Tc.AFrameworkApplication.ga,Tc.AFrameworkApplication.Kd)});this.tb.register(238,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Cc().Mc(function(){return new wc(Tc.AFrameworkApplication.ga,Tc.AFrameworkApplication.Kd,Ra.tb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Ra.tb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
Tc.AFrameworkApplication.Hb)})};vc.prototype.init=function(){var Y=this;Tc.AFrameworkApplication.ga.Tu(function(){var Ra=Y.tb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Tc.AFrameworkApplication.ga.ra("LicensingIsEnabled")&&(Ra.isFeatureEnabled("LicensingTestFeature",!1).then(function(zb){pc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",zb,Tc.AFrameworkApplication.ga.Ua("IsAnonymousUser"));
return null}),Ra.getFeatureTier("LicensingTestFeature",0).then(function(zb){pc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",zb,Tc.AFrameworkApplication.ga.Ua("IsAnonymousUser"));return null}));Y.tb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");Y.SJj()})};vc.prototype.dispose=function(){};vc.prototype.SJj=function(){try{Tc.AFrameworkApplication.ga.ra("SideCarIsEnabled")&&wf.j5f().then(function(Y){pc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",Y);return Y})}catch(Y){}};vc.main=function(){Wd.a.instance.rj(new vc)};Qk.Object.defineProperties(vc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(Yc.a)(vc,"ApplicationFeatureHelperPackage",null,[4,5]);var Mf=b(142),Rd=b(397),Ze=Rd.a;vm(of,Ze);of.prototype.createElement=function(){var Y=document.createElement("link");Y.setAttribute("rel",
"stylesheet");Y.setAttribute("type","text/css");Y.setAttribute("href",this.au);return Y};of.prototype.N3c=function(){return null};of.prototype.Jrc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.pI.au)};Qk.Object.defineProperties(of.prototype,{B3b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Yc.a)(of,"CssResource",Rd.a,[]);var Xf=b(29),bg=b(52);Se.prototype.wti=function(){this.SRb||(pc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.SRb=bg.Task.WAA(Se.Cti(),Se.tti()),this.SRb.continueWith(function(Y){pc.ULS.sendTraceTag(21030599,324,10,"{0}",Xf.a.ped(Y.exception))},5));return this.SRb};Se.prototype.yti=function(){if(!this.CUb)try{pc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.CUb=bg.Task.WAA(Se.p8c(eg.a.create(Tc.AFrameworkApplication.ga.Ua("DimeUrl"),null,null))),this.CUb.continueWith(function(Y){pc.ULS.sendTraceTag(39978391,324,10,"{0}",Xf.a.ped(Y.exception))},5)}catch(Y){pc.ULS.sendTraceTag(594874951,
324,10,"{0}",Xf.a.ped(Y))}return this.CUb};Se.Cti=function(){var Y=Se.acc("inproductmessaging.js");Y=eg.a.create(Y,null,null);return Se.p8c(Y)};Se.tti=function(){var Y=Se.acc("inproductmessaging.css");Y=new of(Y);return Se.p8c(Y)};Se.acc=function(Y){return Mf.a.F2b(String.format("ipm/{0}",Y))};Se.p8c=function(Y){he.a.Fia(Y);return Y.V7a};Object(Yc.a)(Se,"DependencyDownloader",null,[571]);ke.lXi="inProductMessagingOverlayDiv";ke.XZi="PlayButtonImage";ke.Cfj="ReplayButtonImage";Object(Yc.a)(ke,"Constants",
null,[]);qd.prototype.ptj=function(){this.Xme(ke.XZi,this.YZi);this.Xme(ke.Cfj,this.Dfj)};qd.prototype.Xme=function(Y,Ra){Ra&&(this.Dbg[Y]=Ra)};Qk.Object.defineProperties(qd.prototype,{mNg:{configurable:!0,enumerable:!0,get:function(){return this.T1d},set:function(Y){this.T1d=Y}},OBi:{configurable:!0,enumerable:!0,get:function(){return this.ybe},set:function(Y){this.ybe=Y}},PBj:{configurable:!0,enumerable:!0,get:function(){return this.lhe},set:function(Y){(this.lhe=Y)&&this.ptj()}}});Object(Yc.a)(qd,
"FirstRunExperienceUISettings",null,[570]);Object(Yc.a)(Sd,"FirstRunExperienceViewData",null,[569]);var mg=b(171),xf=b(104);Ed.prototype.Pg=function(){this.La.ff(jf.a.LDh,xf.a.frame,Object(Xe.a)(this,this.JDh,"firstRunExperienceHandler"),64);this.La.hc(jf.a.EUe,xf.a.frame,Object(Xe.a)(this,this.N9h,"inProductMessagingTabHandler"));this.La.hc(jf.a.DUe,xf.a.frame,Object(Xe.a)(this,this.M9h,"inProductMessagingShiftTabHandler"));this.La.hc(jf.a.lfh,xf.a.frame,Object(Xe.a)(this,this.mfh,"dimeLaunchHandler"));
this.La.hc(jf.a.zSf,xf.a.frame,mg.ActionManager.ng);this.La.hc(jf.a.agj,xf.a.frame,mg.ActionManager.ng);this.La.hc(jf.a.bgj,xf.a.frame,mg.ActionManager.ng);this.gf&&this.gf.updateCommandUI()};Ed.prototype.JDh=function(Y,Ra,zb,gc,bd){2===zb&&this.vSb.Xri(bd);return 32};Ed.prototype.mfh=function(Y,Ra,zb,gc,bd){2===zb&&this.vSb.Vri(bd);return 32};Ed.prototype.N9h=function(Y,Ra,zb){return 2===zb?this.vSb.Iwd():32};Ed.prototype.M9h=function(Y,Ra,zb){return 2===zb?this.vSb.Gwd():32};Object(Yc.a)(Ed,"InProductMessagingActor",
null,[]);Object(Yc.a)(Fc,"DimeExperienceUISettings",null,[]);var ig=b(168),wh=b(588);qf.prototype.vbi=function(Y){ig.b("getHeaderApi")?Y.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ra){var zb=Y.isFreemiumUpsellEnabled();zb&&(appChrome.getHeaderApi().then(function(gc){gc.updatePremiumStatus(Ra,zb);return null}),Y.Aza("MsoPremiumBadge",function(gc){appChrome.getHeaderApi().then(function(bd){bd.updatePremiumStatus(gc.isEnabled,zb);return null})}));return null}):pc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};qf.prototype.Xri=function(Y){var Ra=this;this.dVb.wti().continueWith(function(){Ra.NXa.lDj(Y)})};qf.prototype.Vri=function(Y){function Ra(){}var zb="gopremium",gc=null;Y?(Y.experience&&""!==Object(ob.a)(String,Y.experience)&&(zb=Object(ob.a)(String,Y.experience)),Y.onTaskComplete&&(Ra=Y.onTaskComplete),Y.campaignId&&""!==Object(ob.a)(String,Y.campaignId)&&(gc=Object(ob.a)(String,Y.campaignId))):pc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.Skf(zb,Ra,gc)};qf.prototype.Skf=function(Y,Ra,zb){var gc=this;zb=void 0===zb?null:zb;if(this.j$b&&this.Orb){var bd={};bd.experience=Y||"gopremium";bd.campaignId=zb||wh.b(this.q1,this.JEc,Object(ob.a)(String,bd.experience),!0);this.La.processAction(jf.a.zSf,2);pc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+bd.experience);try{var Id=Object.assign(new Fc,{instance:this.Orb,bjc:bd,Y8f:Ra||function(){},YTf:function(Vd){pc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
Vd.status)},gPf:function(){pc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");gc.j$b=!1;gc.Orb=null}});this.NXa.tBj(Id)}catch(Vd){pc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Vd.message),this.j$b=!1,this.Orb=null,Y={},this.La.De(jf.a.k$b,2,(Y.experience=bd.experience,Y))}}else pc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),bd={},this.La.De(jf.a.k$b,2,(bd.experience=Y,bd))};qf.prototype.Ilf=function(){var Y=this;this.dVb.yti().continueWith(function(){try{var Ra=
Xf.a.Nl(Tc.AFrameworkApplication.uiCulture),zb=wh.c(Y.q1);if(zb){Ra={partnerId:zb,language:Ra};Ra.sessionId=Tc.AFrameworkApplication.userSessionId;Ra.authHint=Tc.AFrameworkApplication.ga.Ua("UserPrincipalName");var gc=Tc.AFrameworkApplication.ga.Ua("Puid")||"";""!==gc&&(Ra.userInfo={puid:gc});Y.Orb=new Dime(Ra);Y.j$b=!0;pc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else pc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(bd){pc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
bd.message)}},3)};qf.prototype.Iwd=function(){return this.NXa.Iwd()};qf.prototype.Gwd=function(){return this.NXa.Gwd()};Object(Yc.a)(qf,"InProductMessagingUIManager",null,[568]);ee.prototype.Init=function(Y){this.Qie=Y};ee.prototype.SendTrace=function(Y,Ra){pc.ULS.sendTraceTag(34182235,this.Qie,this.xWa[Y],"{0}",Ra)};Object(Yc.a)(ee,"DefaultNetworkingManager",null,[596]);var La=b(274),Eb=b(374),uc=b(99);md.prototype.lDj=function(Y){Y&&(InProductMessaging.Networking.NetworkingMgr=new ee,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(Y.PBj,Y.OBi,Y.mNg,Y.KCi,Y.locale,Object(Xe.a)(this,this.rKi,"onDismissFirstRunExperience"),Y.Dbg),this.xRa(ke.lXi,!0))};md.prototype.tBj=function(Y){var Ra=this;if(Y&&Y.instance&&Y.bjc){var zb=document.getElementById("wacDimeContainer");zb||(zb=document.createElement("div"),zb.id="wacDimeContainer",document.body.appendChild(zb));Tc.AFrameworkApplication.ga.ra("DimeFocusManagerIsEnabled")&&this.xRa("wacDimeContainer",!1);Y.bjc.parentElementId="wacDimeContainer";Y.instance.launch(Y.bjc,
Y.Y8f).then(function(gc){Ra.LGb();document.body.removeChild(zb);Y.YTf(gc)}).catch(function(gc){Ra.LGb();document.body.removeChild(zb);Y.gPf(gc)})}else throw Error.argument("DimeExperienceUISettings");};md.prototype.xRa=function(Y,Ra){if(this.nc&&Y&&(Y=document.getElementById(Y),this.lbi(Y),Y=this.nc.$M("InProductMessagingFocusId"))){var zb=this.nc.Ki;zb&&"InProductMessagingFocusId"===zb.name||this.nc.aS("InProductMessagingFocusId",!1);Ra&&this.nNf(Y.scope)}};md.prototype.lbi=function(Y){var Ra=!1;
Ra=void 0===Ra?!0:Ra;var zb=this.nc.Ai("InProductMessagingFocusId");zb.parent=La.AFrame.ZT;var gc=new Eb.DOMFocusListing(function(){return Y});gc.Jab=Ra;gc.Zn(3);gc.Zn(2);gc.Zn(4);Ra=this.nc.qsa(function(){return Y},zb,gc);Ra.GGb();Ra.s_=!0;Ra.iHa=!0};md.prototype.nNf=function(Y){Y.Ok(uc.FocusManager.instance().f2);Y.Ok(uc.FocusManager.instance().g2);Y.bindAction(uc.FocusManager.instance().f2,jf.a.EUe);Y.bindAction(uc.FocusManager.instance().g2,jf.a.DUe)};md.prototype.LGb=function(){this.nc&&(this.nc.Ica("InProductMessagingFocusId"),
this.nc.kQa("InProductMessagingFocusId"))};md.prototype.rKi=function(Y,Ra){this.LGb();Y=Object.assign(new Sd,{completed:Y,$$i:Ra});Tc.AFrameworkApplication.Hb.De(jf.a.IDh,2,Y)};md.prototype.Iwd=function(){var Y=document.activeElement,Ra=this.nc.RQ();return Y&&Ra&&Ra.jf&&Y===Ra.jf.so?(Ra.jf.ql(Y),Ra.Yxa()?32:8):4};md.prototype.Gwd=function(){var Y=document.activeElement,Ra=this.nc.RQ();return Y&&Ra&&Ra.jf&&Y===Ra.jf.firstElement?(Ra.jf.ql(Y),Ra.YNa()?32:8):4};Object(Yc.a)(md,"InProductMessagingUIWrapper",
null,[567]);var Vc=b(144);je.prototype.ii=function(Y){Y.register(Se,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Cc().Mc(function(){return new Se});Y.register(md,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Cc().Mc(function(){return new md(uc.FocusManager.instance())});Y.register(qf,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Cc().Mc(function(){return new qf(Tc.AFrameworkApplication.Hb,
Y.resolve("Common.IInProductMessagingUIWrapper"),Y.resolve("Common.App.InProductMessaging.IDependencyDownloader"),Tc.AFrameworkApplication.sa.Qa.Oj,Tc.AFrameworkApplication.sa.Qa.ica)});Y.register(Ed,"Common.App.InProductMessaging.InProductMessagingActor").Cc().Mc(function(){return new Ed(Tc.AFrameworkApplication.Hb,Tc.AFrameworkApplication.sa,Y.resolve("Common.IInProductMessagingUIManager"))});Y.register(qd,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Cc().Mc(function(){return new qd});
Y.register(Sd,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Cc().Mc(function(){return new Sd});this.tb=Y};je.prototype.init=function(){var Y=this;this.tb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Pg();Tc.AFrameworkApplication.ga.Tu(function(){Tc.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled&&Vc.a.get_instance().jl(15,function(){Y.tb.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Y.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").vbi(Ra)})});
Tc.AFrameworkApplication.ga.ra("FreemiumUpsellShowDialogIsEnabled")&&wh.a()&&!Qc.a.bB&&1!==Tc.AFrameworkApplication.sa.Qa.Oj&&Y.tb.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Ra.isFeatureEnabled("MsoPremiumBadge",!0).then(function(zb){!zb&&Ra.isFreemiumUpsellEnabled()&&Y.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Ilf();return null})})})};je.prototype.dispose=function(){};je.main=function(){Wd.a.instance.rj(new je)};Qk.Object.defineProperties(je.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(Yc.a)(je,"InProductMessagingPackage",null,[4,5]);$d.prototype.z$c=function(Y){var Ra=new Sys.StringBuilder(this.Gv.ZHb);Ra.append("RoamingServiceHandler.ashx?action=");Ra.append("getFirstRunExperienceSettings");Ra.append("&");Ra.append(this.qgd(Y));Ra.append("&");Ra.append(Tc.AFrameworkApplication.lj);Tc.AFrameworkApplication.Kd.Wl(Ra.toString(),1,null,null,!0,2,Object(Xe.a)(this,this.sKa,"getRequestSuccessCallback"),
Object(Xe.a)(this,this.Lja,"getRequestFailureCallback"),null)};$d.prototype.A$c=function(Y){var Ra=new Sys.StringBuilder(this.Gv.ZHb);Ra.append("RoamingServiceHandler.ashx?action=");Ra.append("saveFirstRunExperienceSettings");Ra.append("&");Ra.append(Tc.AFrameworkApplication.lj);Ra=Ra.toString();Y=Kf.c(Y);Tc.AFrameworkApplication.Kd.Wl(Ra,2,Y,null,!0,4,Object(Xe.a)(this,this.q0i,"postRequestSuccessCallback"),Object(Xe.a)(this,this.uPa,"postRequestFailureCallback"),null)};$d.prototype.sKa=function(Y){var Ra=
!1,zb=null;try{if(0<Y.data.je.length){var gc=Object(ob.a)(Object,Kf.a(Y.data.je)),bd=gc?gc[this.Gv.oWc]:null;bd&&(zb=Object(ob.a)(Object,Kf.a(bd.toString())))}Ra=!0}catch(Id){this.Lja(null)}Ra&&this.xib&&this.xib(Y.data,zb)};$d.prototype.Lja=function(Y){this.tib&&this.tib(Y?Y.data:null)};$d.prototype.q0i=function(Y){this.Ude&&this.Ude(Y?Y.data:null)};$d.prototype.uPa=function(Y){this.Hkb&&this.Hkb(Y?Y.data:null)};$d.prototype.qgd=function(Y){for(var Ra=new Sys.StringBuilder("requestedsettings="),
zb=0;zb<Y.count;zb++)Ra.append(Y.oa(zb)),zb<Y.count-1&&Ra.append(";");return Ra.toString()};Object(Yc.a)($d,"FirstRunExperienceRequestHandler",null,[]);pf.prototype.BRd=function(Y){Y?(this.Gv=Y,this.Gki()&&(pc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Y=new vf.a,Y.add(this.Gv.oWc),this.TRb=new $d(this.Gv,Object(Xe.a)(this,this.sKa,"getRequestSuccessCallback"),Object(Xe.a)(this,this.Lja,"getRequestFailureCallback"),null,Object(Xe.a)(this,
this.uPa,"postRequestFailureCallback")),this.TRb.z$c(Y)),(this.Gv.Gzb||Tc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.CRd()):pc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};pf.prototype.Gki=function(){try{if(this.Gv.Gzb)return!0;if(!Tc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Tc.AFrameworkApplication.ga.ra("IsAnonymousUser"))return!1;if(this.Gv.Chi||
this.Gv.g7a||Tc.AFrameworkApplication.ga.ra("IsO365ConsumerHost"))return!0;var Y=Tc.AFrameworkApplication.ga.Ua("FlightId");return-1!==(Y?Y.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ra){pc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Ra?Ra.toString():null)}return!1};pf.prototype.YVf=function(Y){var Ra={},zb={};zb.FREDisplayedDate=(new Date).toUTCString();zb.VersionDisplayed=Y;zb.RemindMeLater=!1;Ra[this.Gv.oWc]=Kf.c(zb);pc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.TRb&&this.TRb.A$c(Ra)};pf.prototype.sKa=function(Y,Ra){Y=Y?+Y.n3-+Y.gF:-1;Y>this.Gv.PUf?pc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Y,this.Gv.PUf):Ra?this.hAj(Ra)?(pc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.Gv.Tqf),this.CRd()):pc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(pc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.CRd())};pf.prototype.Lja=function(Y){pc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Y?Y.httpStatus:-1)};pf.prototype.uPa=function(Y){pc.ULS.sendTraceTag(51675542,306,
10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Y?Y.httpStatus:-1)};pf.prototype.CRd=function(){var Y=this,Ra=ie.a.instance.Nh("Common.ISystemInitiatedFeedback");Ra?this.Y3f(Ra):(pc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Tc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Ra=ie.a.instance.pc("Common.ISystemInitiatedFeedback"))?Ra.execute(function(zb){Y.Y3f(zb)}):
pc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};pf.prototype.Y3f=function(Y){if(Y){var Ra=this.Gv.YDh;Ra&&(Tc.AFrameworkApplication.nla(Ra),Tc.AFrameworkApplication.Kjc(Ra));pc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ra);Y.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.kib=Object(Xe.a)(this,this.pLi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.kib,!0),window.addEventListener("FRELaunchedEvent",this.kib,!0)):(pc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.YVf(this.Gv.currentVersion))}else pc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};pf.prototype.pLi=function(Y){if(Y){var Ra=Y.detail;Y=Y.type;var zb=this.Gv&&this.Gv.campaignId?this.Gv.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===Y||zb&&Ra&&Ra.id&&-1!==Ra.id.indexOf(zb))Ra.success&&(pc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.YVf(this.Gv.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.kib,!0),window.removeEventListener("FRELaunchedEvent",this.kib,!0))}};pf.prototype.hAj=function(Y){if("RemindMeLater"in Y&&"FREDisplayedDate"in Y){if("true"===Y.RemindMeLater.toString()&&(+new Date-+new Date(Y.FREDisplayedDate.toString()))/36E5>this.Gv.Tqf)return!0}else if(Tc.AFrameworkApplication.ga.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in Y&&Y.VersionDisplayed<this.Gv.currentVersion)return pc.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(Yc.a)(pf,"FirstRunExperienceLauncher",null,[550]);Qf.prototype.ii=function(Y){this.tb=Y;this.tb.register(550,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Cc().Mc(function(){return new pf})};Qf.prototype.init=function(){};Qf.prototype.dispose=function(){};Qf.main=function(){Wd.a.instance.rj(new Qf)};
Qk.Object.defineProperties(Qf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(Yc.a)(Qf,"FirstRunExperienceLauncherPackage",null,[4,5]);var xd=b(214),Od=b(351),re=b(309),Zb=b(354),Nc=b(1),cd=b(36),Xd=b(9),Le=b(371),le=b(14),zf=Le.a;vm(Qe,zf);Qe.prototype.pV=function(){var Y={};Y.id=this.Bc;var Ra=le.a.instance.fa(2190);Y.DialogMessage=Ra;return Y};Qk.Object.defineProperties(Qe.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});
Object(Yc.a)(Qe,"ClipboardReadPermissionAskDialog",Le.a,[]);var bf=b(48);be.prototype.Udf=function(Y){return Y?this.sessionStateId===Y.sessionStateId&&this.sessionId===Y.sessionId:!1};be.prototype.isFromCurrentSession=function(Y){return this.sessionId===Y.ya.UserSessionId};Object(Yc.a)(be,"SourceItem",null,[]);vm(ne,be);ne.prototype.isEqual=function(Y){return Y&&Object.getType(Y)===ne?this.Udf(Y)&&this.activeFloatingObjectControlId===Y.activeFloatingObjectControlId&&this.sheetName===Y.sheetName:!1};
ne.prototype.toString=function(){return this.type.toString()};Object(Yc.a)(ne,"ArtSourceItem",be,[]);var Lf;(function(Y){Y[Y.valid=0]="valid";Y[Y.notPairwiseDisjoint=1]="notPairwiseDisjoint";Y[Y.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";Y[Y.notValidForm=3]="notValidForm";Y[Y.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Lf||(Lf={}));Object(Yc.b)("CopySourceValidationOptions",Lf);var hf=b(43);vm(pd,be);pd.prototype.isEqual=function(Y){return Y&&Object.getType(Y)===
pd?this.Udf(Y)&&hf.Q(this.ranges,Y.ranges)&&this.sheetName===Y.sheetName:!1};pd.prototype.toString=function(){return hf.i(this.ranges,",",this.$,!1)};Object(Yc.a)(pd,"RangeSourceItem",be,[]);Zd.LVj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(Yc.a)(Zd,"ExpectedErrorNames",null,[]);rb.vW="text/plain";rb.html="text/html";rb.png="image/png";rb.zO="data/shadow-workbook";rb.oki="metadata/is-last-copy-was-external";rb.Tgi="metadata/is-last-copy-was-external-XLO-source";rb.MXg="metadata/chrome-extension-id";
rb.X2c="copyId";rb.fIg="metadata/additional-signature-data-attributes";Object(Yc.a)(rb,"ClipboardDataFormat",null,[]);var pg=b(45),df=b(19),Uf=b(34);Ke.prototype.XJa=function(){return Ke.PYi};Ke.prototype.UOh=function(){return this.G8b&&1===this.G8b.length?this.VOh(this.G8b[0]):null};Ke.prototype.VOh=function(Y){var Ra=df.g(this.$),zb=Ra.$a.nj(Y),gc=Ra.pg(Y,zb);Ra=Ra.rtl;if(!gc)return null;Y=df.g(this.$).Sf(zb);var bd=Y.nn;if(!bd.Rd(gc))return null;gc=bd.zf(gc);var Id=gc.topLeft.y,Vd=gc.bottomRight.y,
ve=Ra?gc.bottomRight.x:gc.topLeft.x;gc=Ra?gc.topLeft.x:gc.bottomRight.x;var Pe=new pg.a(gc+(Ra?-81:81),Vd+38+6);if(bd.lHa(Pe))return this.Y3a(Y,bd,zb,gc,Vd,Ra?12:-3,66);Pe=new pg.a(gc+(Ra?-81:81),Vd);if(bd.lHa(Pe))return this.Y3a(Y,bd,zb,gc,Vd,Ra?20:3,22);Pe=new pg.a(gc,Vd+38+6);if(bd.lHa(Pe))return this.Y3a(Y,bd,zb,gc,Vd,-81+(Ra?18:0),66);gc=new pg.a(ve+(Ra?81:-81),Vd);if(bd.lHa(gc))return this.Y3a(Y,bd,zb,ve,Vd,-81+(Ra?12:-6),22);Vd=new pg.a(ve,Id-38-6);return bd.lHa(Vd)?this.Y3a(Y,bd,zb,ve,Id,
Ra?15:0,16):this.Y3a(Y,bd,zb,Ra?bd.topLeft.x:bd.bottomRight.x,bd.bottomRight.y,-81+(Ra?15:-6),22)};Ke.prototype.Y3a=function(Y,Ra,zb,gc,bd,Id,Vd){var ve=df.g(this.$),Pe=ve.rtl;Y=Sys.UI.DomElement.getLocation(Y.domElement);gc=new Sys.UI.Point(gc+(Pe?0:Y.x)-Ra.topLeft.x,bd+Y.y-Ra.topLeft.y);Pe&&(ve=ve.view.visibleArea,gc.x=ve.bottomRight.x-ve.topLeft.x-gc.x,2===zb||4===zb)&&(gc.x+=Ra.bottomRight.x);gc=Uf.a(this.$).Jja(gc);return new Sys.UI.Point(gc.x+Id,gc.y+Vd)};Qk.Object.defineProperties(Ke.prototype,
{eIg:{configurable:!0,enumerable:!0,get:function(){return this.Kkg}},psi:{configurable:!0,enumerable:!0,get:function(){return this.Yrg}},m8i:{configurable:!0,enumerable:!0,get:function(){return this.Iug}},Jzh:{configurable:!0,enumerable:!0,get:function(){return this.Bog}}});Ke.PYi=["PasteRecoveryUI"];Object(Yc.a)(Ke,"PasteRecoveryUI",null,[643]);var Re=b(77),Je=b(307);oe.Wzg="ActiveSelection";oe.zO="ShadowWorkbook";oe.hjg="GVML";oe.vW="PlainText";oe.html="Html";oe.vOg="Bitmap";Object(Yc.a)(oe,"PayloadType",
null,[]);te.TDj="Slice4";te.UDj="Slice5";te.VDj="Slice6";Object(Yc.a)(te,"SliceName",null,[]);Ud.xEi="NotCalled";Ud.success="Success";Ud.failed="Failed";Object(Yc.a)(Ud,"SucceededPopulatingSystemClipboardOptions",null,[]);var qg=b(356),Xg;(function(Y){Y[Y.valid=0]="valid";Y[Y.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";Y[Y.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";Y[Y.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
Y[Y.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";Y[Y.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";Y[Y.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";Y[Y.copySourceNotValid=7]="copySourceNotValid";Y[Y.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";Y[Y.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
Y[Y.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";Y[Y.unknown=100]="unknown"})(Xg||(Xg={}));Object(Yc.b)("PasteValidationOptions",Xg);var Lh=b(56),cg=b(39),Lg=b(141),Da=b(35),Fb=b(148),Oc=b(339),kd=b(27),Ld=b(378),De=b(8),Ge=b(20),lf=b(105),Ka=b(155),bb=b(135),ac=b(584),Bc=b(100),Lc=b(335),Cb=cd.a;vm(Ad,Cb);Ad.prototype.tGg=function(Y){this.addHandler(Ad.IBd,Y)};Ad.prototype.xdj=function(Y){this.removeHandler(Ad.IBd,Y)};Ad.prototype.copy=function(Y){var Ra=this;Y.stopwatch=this.$.Wb.Ic("UserAction",
bf.b().ti(Y.ribbonCommandInfo.command)+"ClientSide");if(this.ro){var zb=Lh.GetServiceTaskFactory.Wa(this.$.da,478,479,0);Da.TaskExtensions.Ba(zb,function(){Ra.pasteShortcutManager=zb.result},this.ma,3)}var gc=!!cc(this.HK);Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Qc.a.LC&&(this.U6a=!1);this.Tr("Copy/before/"+Od.a[Y.ribbonCommandInfo.method],!1,void 0,!0,Y.copyPasteTargetType).catch(function(){});var bd=-1985798686===Y.ribbonCommandInfo.command;
if(1===this.gridView.We&&(bd=this.Ur.ldf(this.gridView.ha.va.selectedRanges,bd),0!==bd)){var Id=Ad.W2g(bd);this.cza(Id,Lf[bd],!1);return Promise.reject(!1)}Y.userHash=this.userHash;Y.id=Jd.a.create().toString();var Vd=this,ve=this;return this.w3b.onCopy(Y).then(function(Pe){Pe.isAsyncCopy||Y.stopwatch.stop();Vd.pasteIndicationManager.LJe();pc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",qg.d(Y));Vd.Uui(Pe,gc);!Y.isFormatPainter&&Vd.ro&&
(Vd.pasteShortcutManager?Vd.pasteShortcutManager.Xkh():pc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(Pe){var We=!1,Vf="none",$f=Ad.Crb,Hg=!0,Tg=-1,Bi=Ad.copyErrorName+Ad.NIa,Cf=!1,Ih=null;if(Pe){Ih=Pe.copyContext;Tg=Pe.reason;Bi+=Ad.dKa(Pe);Pe.message&&($f=Pe.message);var Eh=Ad.V2g(Pe);if(Eh)if(3===Eh.copyErrorName)We=!0,$f=Vf="Async Copy canceled by the user.",Hg=!1;else if(kd.a.dr(Eh.ewaErrors))if($f=ve.Jac(Eh.ewaErrors),kd.a.kh(Eh.ewaErrors,
Ad.operationSucceededWithAlert))Cf=We=!0;else if(kd.a.kh(Eh.ewaErrors,Ad.pasteDataLimitHit)||kd.a.kh(Eh.ewaErrors,Ad.copyThrottlingError))We=!0;13===Pe.reason?(We=!0,Hg=!1):11===Pe.reason&&(Hg=!1)}We?pc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",Hg,Vf,Pe?ve.getStringifiedError(Pe):"null",qg.d(Y)):pc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
Hg,Pe?ve.getStringifiedError(Pe):"null",qg.d(Y));Hg&&ve.Tr("Copy/fail/"+Od.a[Y.ribbonCommandInfo.method],!0,void 0,void 0,Y.copyPasteTargetType).catch(function(){});ve.Tui(Y,We,$f,Bi,Tg,Cf,Ih);return Promise.reject(Pe)})};Ad.prototype.paste=function(Y){var Ra=this;Y.stopwatch=this.$.Wb.Ic("UserAction",bf.b().ti(Y.ribbonCommandInfo.command)+"ClientSide");Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Qc.a.LC&&(pc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.U6a=!1,Y.clipboardPicklingApiDataFormatsToRead=[rb.zO]);df.g(this.$).Li&&df.g(this.$).Li.z7(this.Vfd(Y.ribbonCommandInfo.command),Y.stopwatch.id);if(Y.isPasteCommandFromRecoveryUI){var zb=this.$.da.Aa(406);var gc=re.a.clone(zb.vsd);zb=zb.gsd;Y.pasteRecoveryCachedClipboardItems=zb?zb[Ad.jHf]:null}else gc=re.a.clone(this.gridView.ha.va.selectedRanges);Y.originalDestinations=gc;Y.expandDestinations=this.tZc(Y.originalDestinations,Y.commandType);if(this.HZc(Y.commandType,Y.expandDestinations)||this.LUg())return Y.userHash=
this.userHash,Y.id=Jd.a.create().toString(),Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Qc.a.LC&&(Y.clipboardReadPermissionPromptShown=!1,Y.clipboardAsyncApiDataFormatsToRead=[rb.vW+"Async"],this.w3b.shouldShowClipboardReadPermissionDialog().then(function(bd){bd&&(Y.clipboardReadPermissionPromptShown=!0,new Qe(Ra.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.w3b.onPaste(Y).then(function(bd){return Ra.Hnc(bd,Y)},
function(bd){return Ra.ODb(Y,bd)});this.$.ye(927125067,Re.a.dc,30,null);pc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',hf.i(Y.expandDestinations,",",this.$,!1),Y.commandType,Y.copyPasteTargetType);return Promise.resolve(!0)};Ad.prototype.Vfd=function(Y){if(Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(Y){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};Ad.prototype.LUg=function(){return!!df.g(this.$).ha.Pa.activeFloatingObjectControlId&&this.$.Ms(null,!1,470)};Ad.prototype.vAb=function(){var Y=cc(this.HK);return Y&&Y.commandParameters?Y.commandParameters.copyPasteTargetType:0};Ad.prototype.nki=function(){return!!cc(this.HK)&&Kd(cc(this.HK),this.$)};Ad.prototype.Tr=function(Y,Ra,zb,gc,bd){var Id=this;zb=void 0===zb?!1:zb;gc=void 0===gc?!1:gc;bd=void 0===bd?0:bd;try{this.ro&&this.pasteShortcutManager&&
this.pasteShortcutManager.b6b();var Vd=bd,ve=this.mri();if(!gc&&2===ve)return pc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ra,zb,gc,bd,ve),Promise.reject(null);0===Vd&&(Vd=ve);var Pe=this.$.Wb.Ic("UserAction","ClearCopyState"),We=Pe.id;pc.ULS.sendTraceTag(537167820,
0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ra,zb,gc,bd,ve);this.Ur.Rwb();this.q5i();return this.w3b.onCancelCopy(Ra).then(function(){Ra&&Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Qc.a.LC&&(Id.U6a=!1);Pe.stop();Id.xmf(Y,We,!0,zb,Ra,"","",Pe.Ec,Vd);return Promise.resolve(!0)},
function(Vf){pc.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",Vf?Id.getStringifiedError(Vf):"null");Pe.stop();var $f=Ad.$Ug+Ad.NIa,Hg=Ad.Crb;Vf&&($f+=Ad.dKa(Vf),Vf.message&&(Hg=Vf.message));Id.xmf(Y,We,!1,zb,Ra,Hg,$f,Pe.Ec,Vd);return Promise.reject(Vf)})}catch(Vf){return Promise.reject(null)}};Ad.prototype.W1b=function(Y,Ra,zb,gc,bd){zb=void 0===zb?!1:zb;gc=void 0===gc?!1:gc;bd=void 0===bd?0:bd;return gc||!Nc.EwaSettings.la(684)||
this.Ehh()?this.Tr(Y,Ra,zb,gc,bd):(pc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};Ad.prototype.cza=function(Y,Ra,zb){pc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Ra);var gc=new Bc.a;gc.ia("reason",Ra);ac.a(Ka.a.discontinuousSelectionBlocking,
[zb?bb.a.KYi:bb.a.L3g],!0,!0,!1,!1,gc);Y=kd.a.jd(1,1,738,Y,0,371863010,"DiscontinuousSelectionBlocking");Nc.EwaSettings.nz()?new Oc.a(this.$,Y):(Y=new Fb.ErrorDialog(this.$,Y),Y.initialize(),Y.mf())};Ad.prototype.mri=function(){var Y=cc(this.HK);return Y&&Y.sourceItem?Object.getType(Y.sourceItem)===ne?2:1:0};Ad.prototype.dragDropCells=function(Y,Ra,zb,gc,bd){var Id=this;bd=void 0===bd?!1:bd;Y.stopwatch=this.$.Wb.Ic("UserAction","DragDropClientSide");this.Tr("DragDrop/before/"+Od.a[Y.ribbonCommandInfo.method],
!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});var Vd=bd?2:1,ve=0;ve=bd?4:gc?256:128;var Pe={encounteredDeploymentErrors:!1};Pe.commandParameters=Y;Y.userHash=this.userHash;Y.id=Jd.a.create().toString();return this.Ur.pasteRange(Y.ribbonCommandInfo,hf.q(Ra,this.$),hf.q(zb,this.$),Vd,ve,[Y.stopwatch],Pe,!1).then(function(){pc.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',Y.copyPasteTargetType);Id.gridView.ha.selectionType=-1;
Id.Std(Y,Vd,Ra,zb,Pe);return Promise.resolve(!0)},function(We){pc.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',We?Id.getStringifiedError(We):"null",Y.copyPasteTargetType);return Id.Tzd(We,Y,Vd,Ra,zb,Pe)})};Ad.prototype.Zhh=function(Y,Ra,zb,gc,bd){var Id=this;bd=void 0===bd?!1:bd;Y.stopwatch=this.$.Wb.Ic("UserAction","DragDropReplaceClientSide");this.W1b("DragDropReplace/before/"+Od.a[Y.ribbonCommandInfo.method],!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
var Vd=bd?2:1,ve=0;ve=bd?4:gc?256:128;var Pe={encounteredDeploymentErrors:!1};Pe.commandParameters=Y;Nc.EwaSettings.getBooleanFeatureGate(Je.a.N6b,!1)&&(Y.isDragInsert=!1);Y.userHash=this.userHash;Y.id=Jd.a.create().toString();return this.Ur.pasteRange(Y.ribbonCommandInfo,hf.q(Ra,this.$),hf.q(zb,this.$),Vd,ve,[Y.stopwatch],Pe,!1).then(function(){pc.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',Y.copyPasteTargetType);Id.gridView.ha.selectionType=
-1;Id.Std(Y,Vd,Ra,zb,Pe);return Promise.resolve(!0)},function(We){pc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',We?Id.getStringifiedError(We):"null",Y.copyPasteTargetType);return Id.Tzd(We,Y,Vd,Ra,zb,Pe)})};Ad.prototype.Yhh=function(Y,Ra,zb,gc,bd){var Id=this;bd=void 0===bd?!1:bd;Y.stopwatch=this.$.Wb.Ic("UserAction","DragDropInsertClientSide");this.W1b("DragDropInsert/before/"+Od.a[Y.ribbonCommandInfo.method],!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
var Vd=bd?2:1,ve=hf.K(this.tZc([zb],Vd)),Pe=this.$.ea.pa.sheetName,We=this.$.ea.pa.sheetName,Vf=hf.v(Ra,this.$);Vf.SheetName=Pe;Pe=hf.v(ve,this.$);Pe.SheetName=We;gc=ve.isRow||Ra.isRow||gc?1:0;var $f={encounteredDeploymentErrors:!1};Y.isDragInsert=!0;$f.commandParameters=Y;Y.userHash=this.userHash;Y.id=Jd.a.create().toString();bd=this.Ur.bih($f,Vf,Pe,bd,gc,Y.ribbonCommandInfo);var Hg=this;return Lc.c(bd.then(function(){pc.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',
Y.copyPasteTargetType);Id.gridView.ha.selectionType=-1;Id.Std(Y,Vd,Ra,zb,$f);return Promise.resolve(!0)},function(Tg){pc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',Tg?Hg.getStringifiedError(Tg):"null",Y.copyPasteTargetType);return Hg.Tzd(Tg,Y,Vd,Ra,zb,$f)})).CWR(function(){return!0})};Ad.prototype.adi=function(Y,Ra){var zb=this,gc=cc(this.HK);if(!gc)return pc.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
bg.Task.Ta(!1);if(!qc(gc.sourceItem))return pc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),bg.Task.Ta(!1);var bd=gc.sourceItem;if(!bd)return pc.ULS.shipAssertTag(537167810,0,!!bd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),bg.Task.Ta(!1);if(!bd.isFromCurrentSession(this.$))return pc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),bg.Task.Ta(!1);if(1<bd.ranges.length)return pc.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.cza(2128,"InsertCopiedCutCells",!0),bg.Task.Ta(!1);gc=hf.K(bd.ranges);var Id=this.gridView.ha.va.Td.clone();Y=hf.K(this.tZc([Id],Y));var Vd=this.pkf();bd=bd.sheetName;Id=this.$.ea.pa.sheetName;var ve=hf.v(gc,this.$);ve.SheetName=bd;var Pe=hf.v(Y,this.$);Pe.SheetName=Id;return(Y.Rh||gc.Rh?bg.Task.Ta(0):Y.isRow||gc.isRow?bg.Task.Ta(1):this.bdi.N3b(this.$,df.g(this.$).rtl)).CWR(function(We){return zb.Ur.executeInsertCopiedCutCellsOperation(ve,
Pe,Vd,We.result,Ra)}).continueWith(function(){Vd?zb.Ur.Rwb():zb.Tr("InsertCopiedCutCells/success/"+Od.a[Ra.method],!0)})};Ad.prototype.Lod=function(){var Y=cc(this.HK),Ra=this.gridView.ha.va.qh;return!!Y&&qc(Y.sourceItem)&&Ra&&1===Y.sourceItem.ranges.length};Ad.prototype.pkf=function(){return this.qkf(-911352779)};Ad.prototype.Ric=function(){return this.qkf(-1985798686)};Ad.prototype.HZc=function(Y,Ra){var zb=new Lg.a(this.$.xa),gc=36===Y,bd=zb.ue(4);Y=2===this.vAb()&&zb.ue(1);gc=gc&&bd;zb=!zb.Nj||
!this.Ric()||!Lg.a.B6b(Ra,df.g(this.$));return gc||Y||this.$.Ms(Ra,!0)&&zb};Ad.prototype.hgc=function(Y,Ra){return this.Ur.hgc(Y,Ra)};Ad.prototype.dispose=function(){Cb.prototype.dispose.call(this);this.tn();this.HK.removeMetadataChangeListener(Ad.Lqf)};Ad.prototype.a7c=function(Y,Ra,zb,gc,bd,Id){if(!this.ZYg(Y.commandParameters.ribbonCommandInfo.command))return Y.cseStatus=2,!1;if(Id&&Ra.Rd(gc))return Y.cseStatus=4,!1;if(zb!==bd)return Y.cseStatus=6,!1;if(Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(gc.width%Ra.width||gc.height%Ra.height))return Y.cseStatus=16,!1;if(Nc.EwaSettings.getBooleanFeatureGate(Je.a.EFe,!1)){if(zb=Ra,Ra=null===Ra.zf(this.gridView.Jh),bd=Y.commandParameters.ribbonCommandInfo.command,Ra&&1804571062!==bd&&-185374993!==bd)return Y.cseStatus=7,!1}else if(zb=Ra.zf(this.gridView.Jh),gc=gc.zf(this.gridView.Jh),!zb||!gc)return Y.cseStatus=7,!1;Ra=hf.v(zb,this.$);Ra=this.Fh.NYi(this.gridView,Ra,hf.v(gc,this.$),Y.commandParameters.ribbonCommandInfo.command,Y.commandParameters.stopwatch);
1===Ra&&(Id&&(this.Fh.x0c(zb,!1),this.Fh.x0c(zb,!0)),-185374993===Y.commandParameters.ribbonCommandInfo.command&&df.g(this.$).c5i(),this.pasteIndicationManager.Ljd(Y.commandParameters.id),this.Juc(Y.commandParameters.expandDestinations,Y.commandParameters.isPasteCommandFromRecoveryUI),this.oze("DoPasteClientEstimation/"+Od.a[Y.commandParameters.ribbonCommandInfo.method],Y));Y.cseStatus=Ra;return 1===Ra};Ad.prototype.vIf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,
!1,this.Pwi)};Ad.prototype.wwi=function(Y,Ra,zb,gc){Y=td(Y,Ra,zb,gc,this.$.ya.UserSessionId);Y.k=!0;bf.b().Qe(45,Y,!0)};Ad.prototype.wRi=function(Y,Ra,zb,gc,bd){var Id=!1,Vd=!1,ve=Ad.Crb,Pe=Ad.QJe+Ad.NIa;Y&&(Pe+=Ad.dKa(Y),kd.a.dr(Y.ewaErrors)?(ve=this.Jac(Y.ewaErrors),kd.a.kh(Y.ewaErrors,[-103190598])&&(Id=!0)):Y.message&&(ve=Y.message));Vd||(Vd=this.dod(Y));Ra=td(Ra,zb,gc,bd,this.$.ya.UserSessionId);Ra.k=!1;Ra.l=Vd;Ra.n=ve;Ra.p=Pe;Ra.q=Id;bf.b().Qe(45,Ra,!0);return Promise.reject(Y)};Ad.prototype.ZYg=
function(Y){switch(Y){case 237279923:case 808159687:return Je.a.uli;case -185374993:return!0;case 1804571062:return!0;default:return!1}};Ad.prototype.qkf=function(Y){var Ra=cc(this.HK);if(!Ra)return!1;var zb=Ra.sourceItem;return zb&&!zb.isFromCurrentSession(this.$)?(pc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Ra.commandParameters.ribbonCommandInfo.command===Y};Ad.prototype.Ehh=function(){var Y=cc(this.HK);
return Y?(Y=Y.sourceItem)&&!Y.isFromCurrentSession(this.$)?(pc.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};Ad.prototype.Bxj=function(Y){return Y&&Y.lastCopy?Kd(Y.lastCopy,this.$):!0};Ad.prototype.BZe=function(Y,Ra,zb,gc,bd){var Id={};Id.a=this.$.ya.UserSessionId;Id.e=Y.stopwatch.id;Id.c=bf.b().ti(Y.ribbonCommandInfo.command);Id.b=Od.a[Y.ribbonCommandInfo.method];Id.d=Y.id;Id.f=zb.toString();
Id.g=gc.toString();Id.h=Ra.toString();Id.o=Y.stopwatch.Ec;Id.q=!1;Id.r=Y.copyPasteTargetType.toString();Id.s=bd.encounteredDeploymentErrors;Nc.EwaSettings.getBooleanFeatureGate(Je.a.N6b,!1)&&(Id.i=bd.commandParameters.dragDropIsShiftKeyDown,Id.j=bd.commandParameters.isDragInsert);return Id};Ad.prototype.Std=function(Y,Ra,zb,gc,bd){Y=this.BZe(Y,Ra,zb,gc,bd);Y.k=!0;bf.b().Qe(45,Y,!0)};Ad.prototype.$ui=function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){Y=this.BZe(Y,Ra,zb,gc,Pe);Y.k=!1;Y.l=bd;Y.n=Id;Y.p=Vd;Y.q=ve;bf.b().Qe(45,
Y,!0)};Ad.prototype.xmf=function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){var We={};We.a=this.$.ya.UserSessionId;We.b=Ra;We.c=Y;We.f=zb;We.e=gc;We.d=bd;We.g=Id;We.h=Vd;We.i=ve;We.j=Pe.toString();bf.b().Qe(46,We,!0)};Ad.prototype.Uui=function(Y,Ra){Y=this.ZYe(Y.commandParameters,Y);Y.l=!0;Y.j=Ra;bf.b().Qe(43,Y,!0)};Ad.prototype.Tui=function(Y,Ra,zb,gc,bd,Id,Vd){Y=this.ZYe(Y,Vd);Y.l=!1;Y.m=Ra;Y.o=zb;Y.y=gc;Y.x=bd;Y.z=Id;bf.b().Qe(43,Y,!0);pc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",
Y.y,Y.x,Y.m,Y.z,Y.o)};Ad.prototype.ZYe=function(Y,Ra){var zb={};zb.a=this.$.ya.UserSessionId;zb.f=Y.stopwatch.id;zb.g=Y.id;zb.c=bf.b().ti(Y.ribbonCommandInfo.command);zb.b=Od.a[Y.ribbonCommandInfo.method];zb.q=Y.stopwatch.Ec;zb.bd=Ad.R$b();zb.bg=Y.copyPasteHandlerName;zb.bj=void 0===Y.ribbonCommandInfo.df||null===Y.ribbonCommandInfo.df?null:Zb.a[Y.ribbonCommandInfo.df];zb.bq=Y.uploadToClipService;zb.br=Y.floatingObjectType;zb.s=Y.copyPasteTargetType.toString();zb.bc=Ve(Y.copyPasteTargetType);zb.z=
!1;if(Ra){zb.bk=Ra.id;zb.bl=Ra.serverRequestTimeInMs;Ra.requestTelemetryData&&(zb.bm=Ra.requestTelemetryData.EcsOperationDuration,zb.bn=Ra.requestTelemetryData.EcsRequestDuration,zb.bo=Ra.requestTelemetryData.WfeRequestDuration);zb.d=Ra.sourceItem?Ra.sourceItem.toString():null;zb.e=-1;if(qc(Ra.sourceItem)){zb.e=0;Y=yl(Ra.sourceItem.ranges);for(var gc=Y.next();!gc.done;gc=Y.next())zb.e+=gc.value.kU}zb.h=Ra.isAsyncCopy;zb.i=Ra.isFromCache;zb.k=Ra.isSelectionAllowed;zb.r=Ra.plainTextPayloadSize;zb.u=
Ra.htmlPayloadSize;zb.v=Ra.htmlSizeExceedsLimit;zb.w=Ra.copyTotalSizeExceedsLimit;zb.t=Ra.shadowWorkbookPayloadSize;zb.p=Ra.clientSideCopyTime;zb.ba=Ra.encounteredDeploymentErrors;zb.bb=Ra.shadowWorkbookSizeExceedsLimit;zb.be=Ra.syncClipboardItemsKeys;zb.bf=Ra.asyncClipboardItemsKeys;zb.bh=this.GCe(Ra.succeededPopulatingSystemClipboardSync);zb.bi=this.GCe(Ra.succeededPopulatingSystemClipboardAsync)}return zb};Ad.prototype.Juc=function(Y,Ra){Ra=void 0===Ra?!1:Ra;if(!this.gridView.isEditing&&!this.gridView.Bi){var zb=
this.gridView.ha.va,gc=!Ra&&1===Y.length&&hf.Q(Y,zb.selectedRanges),bd=gc?zb.activeCell:Y[0].topLeft;Y[0].contains(bd)||(pc.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",zb.selectedRanges,zb.$A,zb.activeCell,Y,gc,bd,Ra),bd=Y[0].topLeft);this.gridView.ha.sD(Y,0,bd,0,void 0,lf.a.Q3g)}};Ad.prototype.T1e=
function(Y,Ra){var zb={};zb.a=this.$.ya.UserSessionId;zb.g=Y.stopwatch.id;zb.t=Y.stopwatch.Ec;zb.bz=!1;Ra&&(zb.bv=Ra.id,zb.bw=Ra.serverRequestTimeInMs,zb.n=Ra.commandParameters.clipboardFormatReadTimes,zb.o=Ra.commandParameters.clipboardFormatReadStatus,zb.p=Ra.commandParameters.clipboardReadPermissionPromptShown,zb.q=Ra.commandParameters.asyncApiReadTimedOut,Ra.requestTelemetryData&&(zb.cb=Ra.requestTelemetryData.EcsOperationDuration,zb.cc=Ra.requestTelemetryData.EcsRequestDuration,zb.cd=Ra.requestTelemetryData.WfeRequestDuration));
zb.x=Y.copyPasteTargetType.toString();zb.bl=Ve(Y.copyPasteTargetType);zb.br=Y.copyPasteHandlerName;zb.i=hf.i(Y.expandDestinations,",",this.$,!1);zb.h=hf.i(Y.originalDestinations,",",this.$,!1);zb.e=Y.id;zb.d=Y.commandType;zb.c=bf.b().ti(Y.ribbonCommandInfo.command);zb.b=Od.a[Y.ribbonCommandInfo.method];zb.bf=!1;zb.bg=!1;zb.bp=Ad.R$b();zb.bt=void 0===Y.ribbonCommandInfo.df||null===Y.ribbonCommandInfo.df?null:Zb.a[Y.ribbonCommandInfo.df];zb.cj=Y.isPasteCommandFromEnterShortcut;if(zb.ca=Y.isPasteCommandFromRecoveryUI)zb.cf=
Y.pasteRecoveryUndoStopwatch.id,zb.cg=Y.pasteRecoveryUndoStopwatch.Ec;if(Ra){if((Y=Ra.copyContextSnapshot)&&!Ra.wasLastCopyExternal){zb.f=Y.commandParameters.id;zb.j=Y.sourceItem.toString();zb.k=-1;if(qc(Y.sourceItem)){zb.k=0;for(var gc=yl(Y.sourceItem.ranges),bd=gc.next();!bd.done;bd=gc.next())zb.k+=bd.value.kU}zb.bg=1===Y.commandParameters.commandType}else Ra.clipboardItems?zb.f=Ra.clipboardItems.getItem(rb.X2c):pc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
zb.bz=Ra.pasteRecoveryUIDisplayed;zb.ci=Ra.cseStatus}else pc.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return zb};Ad.prototype.gwi=function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){Y=this.T1e(Y,ve);Y.l=!1;Y.m=Ra;Y.s=zb;Y.bc=gc;Y.be=bd;Y.bd=Id;Y.bf=Vd;ve?(Y.y=nd(ve)||!ve.copyContextSnapshot,Y.bi=!Y.y&&Kd(ve.copyContextSnapshot,this.$),Y.bj=ve.shadowWorkbookSizeExceedsLimit,Y.v=ve.shadowWorkbookPayloadSize,Y.w=ve.htmlPayloadSize,Y.bq=Ne(ve.clipboardItems),
Y.bb=ve.activeSelectionType,Y.bs=ve.isSameSession,Y.bn=ve.payloadOrigin,Y.bo=ve.payloadType,Y.bu=ve.externalAppSource,Y.bx=ve.indicationDisplayScheduled,Y.by=ve.pasteIndicationDisplayStatus,Y.ck=ve.pasteDestinationHasMergedCells):Y.bi=Kd(Pe,this.$);bf.b().Qe(44,Y,!0);pc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",Y.be,Y.bd,Y.m,Y.bf,Y.s)};Ad.prototype.hwi=function(Y){var Ra=
this.T1e(Y.commandParameters,Y);Ra.y=Y.wasLastCopyExternal;Ra.l=!0;Ra.u=Y.plainTextPayloadSize;Ra.v=Y.shadowWorkbookPayloadSize;Ra.w=Y.htmlPayloadSize;Ra.z=Y.isClipboardDataContainShadowWorkbook;Ra.ba=Y.isShadowWorkbookParsedSuccessfully;Ra.bb=Y.activeSelectionType;Ra.bc=Y.pasteResult;Ra.bh=Y.encounteredDeploymentErrors;Ra.bj=Y.shadowWorkbookSizeExceedsLimit;Ra.bk=sd(Y);Ra.bq=Ne(Y.clipboardItems);Ra.bs=Y.isSameSession;Ra.bn=Y.payloadOrigin;Ra.bo=Y.payloadType;Ra.bu=Y.externalAppSource;Ra.bx=Y.indicationDisplayScheduled;
Ra.by=Y.pasteIndicationDisplayStatus;Ra.ck=Y.pasteDestinationHasMergedCells;Ra.bm=Y.clipboardItems?Y.clipboardItems.getItem(rb.MXg):null;Ra.bi=!Y.isSameSession&&!Y.wasLastCopyExternal;bf.b().Qe(44,Ra,!0)};Ad.prototype.al=function(){this.$.xa.Qf(this.hi);this.$.xa.Mne(this.inc);this.$.userOperationManager.kx(this.QR);this.$.Pk(this.ud);df.g(this.$).zc.Xl(this.eEb)};Ad.prototype.tn=function(){this.$&&this.$.xa&&(this.$.xa.ug(this.hi),this.$.xa.VQf(this.inc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.jv(this.QR);
this.gridView&&this.gridView.zc&&this.gridView.zc.nl(this.eEb)};Ad.prototype.ODb=function(Y,Ra){var zb=null,gc=!1,bd=null,Id="UnknownFailure",Vd=-1,ve=Ad.Crb,Pe=Ad.pasteErrorName+Ad.NIa,We=!1;this.pasteIndicationManager.Ljd(Y.id);this.Jff&&this.pasteDestinationHasMergedCells(Y.expandDestinations)&&(Ra.pasteContext.pasteDestinationHasMergedCells=!0);var Vf=cc(this.HK);(Y.clearStateOnFinish||Y.clearSystemClipboard)&&this.Tr("Paste/fail/"+Od.a[Y.ribbonCommandInfo.method],!0,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
if(Ra){Vd=Ra.reason;Pe+=Ad.dKa(Ra);Ra.message&&(ve=Ra.message);if(zb=Ad.h3g(Ra))if(1===zb.pasteErrorName)gc=!0,Id="CopyPasteLengthTooLongPopup",ve=bd="The pasted content is too long. Popup a dialog to the user.",pc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType),zb=kd.a.jd(1,0,26,677,0,1306609195,"CopyPasteOversizeError"),Nc.EwaSettings.nz()?new Oc.a(this.$,zb):(zb=new Fb.ErrorDialog(this.$,zb),zb.initialize(),zb.mf());
else if(7===zb.pasteErrorName)gc=!0,Id="No-Op",ve=bd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",pc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType);else if(8===zb.pasteErrorName)gc=!0,Id="UseShortcutsPopup",ve=bd="Unable to paste content from the system clipboard. Popup dialog to the user.",pc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
bd,Y.copyPasteTargetType),this.vIf();else if(18===zb.pasteErrorName){gc=!0;Id="PasteExternalNotSupportMultipleSelectionPopup";ve="Paste external not support multiple selection.";bd="Unknown";var $f=2128;100!==zb.validationFailureReason&&(bd=Xg[zb.validationFailureReason],$f=Ad.zCe(zb.validationFailureReason));this.cza($f,bd,!0)}else 20===zb.pasteErrorName||19===zb.pasteErrorName?(gc=!0,20===zb.pasteErrorName?(Id="PasteAcrossSessionNotSupportMultipleSelectionPopup",ve="Paste across session does not support multiple selection."):
(Id="PasteInSameSessionNotSupportMultipleSelectionPopup",ve="This kind of multiple selection is not supported for same session paste."),bd="Unknown",$f=2128,100!==zb.validationFailureReason&&(bd=Xg[zb.validationFailureReason],$f=Ad.zCe(zb.validationFailureReason)),zb=6===zb.validationFailureReason,this.HZc(Y.commandType,Y.expandDestinations)&&zb&&this.Juc(Y.expandDestinations),this.cza($f,bd,!0)):6===zb.pasteErrorName?(gc=!0,Id="No-Op",ve=bd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
pc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType)):17===zb.pasteErrorName?(gc=!0,Id="No-Op",ve=bd="Paste text on Art is not yet a supported operation",pc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType)):16===zb.pasteErrorName?(gc=!0,Id="No-Op",ve=bd="Paste has failed because the previous copy has failed",pc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
bd,Y.copyPasteTargetType,this.getStringifiedError(zb))):kd.a.dr(zb.ewaErrors)?(kd.a.Y9(zb.ewaErrors)||kd.a.kh(zb.ewaErrors,kd.a.ncc())?(gc=!0,Id="CommunicationError",bd=kd.a.Uc(zb.ewaErrors),pc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',ve,Y.copyPasteTargetType)):kd.a.kh(zb.ewaErrors,Ad.ylj)?(gc=!0,Id="SavingWorkbookError",bd=kd.a.Uc(zb.ewaErrors),pc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
ve,Y.copyPasteTargetType)):kd.a.kh(zb.ewaErrors,Ad.operationSucceededWithAlert)&&(We=gc=!0,Id="OperationSucceededWithAlert",bd=kd.a.Uc(zb.ewaErrors),pc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',ve,Y.copyPasteTargetType)),gc||(ve=this.Jac(zb.ewaErrors),gc=this.dod(Ra))):11===zb.pasteErrorName&&(gc=!0,Id="No-Op",ve="Paste has failed because user try copy cross-session oart object");15===Ra.reason&&(gc=!0,Id="No-Op",ve="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Ge.a.equals(Pe,Zd.LVj,!1)&&(gc=!0,Id="No-Op",ve="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}gc||pc.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Ra?this.getStringifiedError(Ra):"null",Y.copyPasteTargetType);this.gwi(Y,gc,ve,Id,Pe,Vd,We,Ra.pasteContext,Vf);return Promise.reject(Ra)};Ad.prototype.Hnc=function(Y,Ra){var zb;pc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Ra.copyPasteTargetType);this.pasteIndicationManager.Ljd(Ra.id);if(this.SYi(Ra.copyPasteTargetType,Y)){Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Qc.a.LC&&Y.wasLastCopyExternal&&Y.payloadType===oe.zO&&(this.U6a=!0);var gc=null;(null===(zb=Y.pastedRange)||void 0===zb?0:zb.Ranges)&&0<Y.pastedRange.Ranges.length?gc=hf.g(Y.pastedRange.Ranges):Y.wasLastCopyExternal||(gc=Ra.expandDestinations);this.nnj(Y,gc);if(this.xzj(Y,gc)){zb=re.a.clone(Ra.originalDestinations);
gc=1028===Ra.commandType?re.a.clone(Ra.expandDestinations):re.a.clone(gc);var bd=null;Y.wasLastCopyExternal&&(Ra.isKeyboardEvent||Ra.isPasteCommandFromRecoveryUI)&&(bd={},bd=(bd[Ad.jHf]=Y.clipboardItems,bd));this.Jff&&this.pasteDestinationHasMergedCells(Ra.expandDestinations)&&(Y.pasteDestinationHasMergedCells=!0);Y.pasteRecoveryUIDisplayed=!0;var Id=new Ke(this.$,zb,gc,bd),Vd=Lh.GetServiceTaskFactory.Wa(this.$.da,406,405,0);Da.TaskExtensions.Ba(Vd,function(){var ve=Vd.result;ve.uOg(Id);ve.JCj(Ra.ribbonCommandInfo.method)},
this.ma,3)}}this.oze("Paste/success/"+Od.a[Ra.ribbonCommandInfo.method],Y);this.hwi(Y);this.i3f&&(!Ra.isKeyboardEvent||sd(Y))&&this.$.ea.oh.get(66)&&(pc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.i3f=!1,this.H4g());return Promise.resolve(!0)};Ad.prototype.xzj=function(Y,Ra){return!Ra||1!==Ra.length||Y.commandParameters.clearSystemClipboard||Y.commandParameters.clearStateOnFinish||Y.commandParameters.skipClipboardAccess?!1:
nd(Y)&&(Ra=Y.clipboardItems.getItem(rb.vW),Y=Y.clipboardItems.getItem(rb.html),void 0===Ra||null===Ra||Ra.length>this.Jvd||void 0===Y||null===Y||Y.length>this.ONa)?(pc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};Ad.prototype.SYi=function(Y,Ra){return 1===Y||Ra.payloadType===oe.vW||Nc.EwaSettings.la(162)&&Ra.payloadType===oe.html||Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Qc.a.LC&&Ra.payloadType===oe.zO};Ad.prototype.pasteDestinationHasMergedCells=function(Y){var Ra=df.g(this.$).Ca.UE();if(!Ra||!Ra.length)return!1;Ra=yl(Ra);for(var zb=Ra.next();!zb.done;zb=Ra.next())if(zb.value.gw(Y[0]))return!0;return!1};Ad.prototype.oze=function(Y,Ra){var zb=this,gc;(function(){var bd=zb.Rgi(Ra);gc=bd.NGa;return bd})().returnValue&&this.Tr(Y,gc,void 0,void 0,Ra.commandParameters.copyPasteTargetType).catch(function(){})};Ad.prototype.Tzd=function(Y,Ra,zb,gc,bd,Id){pc.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",Y?this.getStringifiedError(Y):"null");var Vd=!1,ve=!1,Pe=!1,We=Ad.Crb,Vf=Ad.QJe+Ad.NIa;Y&&(Vf+=Ad.dKa(Y),kd.a.dr(Y.ewaErrors)?(We=this.Jac(Y.ewaErrors),kd.a.kh(Y.ewaErrors,Ad.operationSucceededWithAlert)&&(Vd=!0),kd.a.kh(Y.ewaErrors,Ad.dragDropNonEmptyRange)&&(ve=Pe=!0)):Y.message&&(We=Y.message));Pe||(Pe=this.dod(Y));ve?this.gridView.ha.selectionType=-1:this.Ur.p8i(bd);this.$ui(Ra,zb,gc,bd,Pe,We,Vf,Vd,Id);return Promise.reject(Y)};Ad.prototype.tZc=
function(Y,Ra){var zb=Y,gc=this.$Sh();if(null===gc||void 0===gc?0:gc.ranges)zb=this.Ur.XTg(Ra,gc.ranges,Y);return zb};Ad.prototype.$Sh=function(){var Y=cc(this.HK);return Y&&qc(Y.sourceItem)?Y.sourceItem:null};Ad.prototype.q5i=function(){this.raiseEvent(Ad.IBd,null)};Ad.prototype.nnj=function(Y,Ra){var zb=Y.commandParameters.originalDestinations;Ra&&(hf.Q(this.gridView.ha.va.selectedRanges,zb)?(this.Juc(Ra),pc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
De.HelperMethods.cob(Ra))):Y.commandParameters.isPasteCommandFromRecoveryUI?(this.Juc(Ra,!0),pc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Ra,Ra[0].topLeft)):pc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",De.HelperMethods.cob(zb)))};
Ad.prototype.Rgi=function(Y){if(Y.isPlainTextPaste||Y.isHtmlPaste||zc(Y)||Y.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,NGa:!1};var Ra=Y.copyContextSnapshot;if(Y.commandParameters.clearStateOnFinish)return{returnValue:!0,NGa:!0};if(Ra&&qc(Ra.sourceItem)){var zb=Ra.sourceItem;if(!zb.isFromCurrentSession(this.$))return{returnValue:!1,NGa:!0};Ra=-1985798686===Ra.commandParameters.ribbonCommandInfo.command;if(!(1<zb.ranges.length||1<Y.commandParameters.expandDestinations.length)){var gc=
hf.K(zb.ranges);Y=hf.K(Y.commandParameters.expandDestinations);var bd=this.$.ea.pa.sheetName;zb=zb.sheetName;if(zb===bd&&Y.equals(gc))return{returnValue:!1,NGa:!0};if(zb===bd&&Y.zf(gc))return{returnValue:!0,NGa:!1}}return{returnValue:Ra,NGa:!0}}return{returnValue:!1,NGa:!0}};Ad.prototype.mEf=function(){var Y=cc(this.HK);(Y=this.Ur.Evb(Y))&&Y.isFromCurrentSession(this.$)&&this.Tr("OnStartEdit",!1).catch(function(){})};Ad.prototype.Jac=function(Y){Y=kd.a.JPh(Y,Ad.NIa);return this.YAi+Xf.a.Qv(Y).toString()};
Ad.prototype.dod=function(Y){Y=Ad.dKa(Y);return!!Y&&Ge.a.M1a(Y,Ad.XAi)};Ad.prototype.H4g=function(){var Y=kd.a.jd(1,2,328,329,Qc.a.cp?330:Qc.a.KH?331:332,530046625,"ActivateLocalStorage"),Ra=Lh.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Da.TaskExtensions.Ba(Ra,function(){Ra.result.ig(41,Y)},this.ma,3)};Ad.prototype.GCe=function(Y){return void 0===Y||null===Y?Ud.xEi:Y?Ud.success:Ud.failed};Ad.h3g=function(Y){var Ra=Y.innerError;return Ra&&0!==Ra.pasteErrorName?Y.innerError:null};Ad.V2g=function(Y){var Ra=
Y.innerError;return Ra&&0!==Ra.copyErrorName?Y.innerError:null};Ad.dKa=function(Y){var Ra="";if(!Y)return Ad.QGe;Y.errorName&&(Ra=Y.errorName,Y.innerError&&(Ra+=Ad.NIa+Ad.dKa(Y.innerError)));Ra||(Ra=Y&&Y.name?Y.name:Ad.QGe);return Ra};Ad.R$b=function(){Ad.gLb||(cg.a.Xff()?Ad.gLb=te.VDj:cg.a.kpd()?Ad.gLb=te.UDj:Ad.gLb=te.TDj);return Ad.gLb};Ad.zCe=function(Y){switch(Y){case 7:case 1:return 2135;case 5:return 2132;case 6:return 2131;case 8:case 3:case 2:case 4:case 9:case 10:return 2128;default:return pc.ULS.shipAssertTag(537167764,
0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",Y),2135}};Ad.W2g=function(Y){switch(Y){case 3:return 2129;case 1:return 2130;case 2:case 4:return 2128;default:return pc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",Y),2135}};Qk.Object.defineProperties(Ad.prototype,{pasteIndicationManager:{configurable:!0,enumerable:!0,get:function(){return this.$.da.Aa(373)}}});
Ad.Lqf="EwaJsMetadataChangeListenerId";Ad.IBd="cpiOSC";Ad.Sch="cpiDID";Ad.Crb="Unknown";Ad.QGe="UnknownError";Ad.NIa="_";Ad.QJe="DragAndDropError";Ad.pasteErrorName="PasteError";Ad.$Ug="CancelError";Ad.copyErrorName="CopyError";Ad.XAi="MergedCellOverlap";Ad.jHf="PasteRecoveryCachedClipboardItems";Ad.ylj=[1352631530,1679665408];Ad.operationSucceededWithAlert=[-103190598];Ad.pasteDataLimitHit=[1306609195];Ad.copyThrottlingError=[-386183710];Ad.dragDropNonEmptyRange=[563945982];Ad.gLb=null;Object(Yc.a)(Ad,
"CopyPasteInfrastructure",cd.a,[576,577,2]);Object(Yc.a)(wd,"ClipboardPlatformInitializationResult",null,[]);var nc=b(686),Td=b(121),Me=b(4),ge=b(81);Object(Yc.a)(od,"MacroRecorderPasteRangePayload",null,[106]);mc.prototype.getContent=function(){return this.content};Object(Yc.a)(mc,"MacroRecorderPasteStringPayload",null,[106]);var Ef=b(61);Object(Yc.a)(Xb,"MacroRecorderPastePayload",null,[106]);var He=b(603),Of=b(911),Md=b(521),cf=b(164),Gd=b(200),pe=b(114),jg=b(272),If=b(336);Va.prototype.getParameters=
function(){return this.parameters};Object(Yc.a)(Va,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[106]);var ud=b(369);sa.prototype.copy=function(Y,Ra,zb,gc,bd){function Id(We,Vf,$f){var Hg={CopyPasteTargetType:1};Hg.SourceRanges=Y;Hg.CopyOperationId=Ra.id;pc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",Vd.nMa,Hg.CopyOperationId);Vd.XMa=Vd.nMa?Zc(Vd.$.na.wx,Hg,jg.b(We,zb),gc?jg.a(Vf,gc):Vf,$f,Ra.ribbonCommandInfo,ve,bd):
Zc(Vd.$.na.ta,Hg,jg.b(We,zb),gc?jg.a(Vf,gc):Vf,$f,Ra.ribbonCommandInfo,ve,bd);return Vd.XMa}var Vd=this;gc=void 0===gc?null:gc;bd=void 0===bd?null:bd;var ve=this.$.na.ta.$b();this.Cmd&&this.lY();this.Gic=ve.ClientRequestId;var Pe=Nc.EwaSettings.tc()?new cf.a(505,0,Id,80):new Md.a(505,0,Id,16);Pe=this.$.userOperationManager.ic(Pe,Ra.ribbonCommandInfo);this.Cmd&&this.ev.add(Pe)};sa.prototype.iHf=function(Y,Ra,zb,gc,bd,Id){var Vd=this;return new Promise(function(ve,Pe){var We,Vf=Id.commandParameters.stopwatch.Ec,
$f=2;20===Id.commandParameters.commandType&&($f=16);36===Id.commandParameters.commandType&&($f=32);cg.a.kpd()&&68===Id.commandParameters.commandType&&($f=64);cg.a.zrd(Vd.$)&&1028===Id.commandParameters.commandType&&($f=1024);var Hg=null;if(null===(We=Id.copyContextSnapshot)||void 0===We?0:We.commandParameters)Hg=Id.copyContextSnapshot.commandParameters.id;sa.xNd(Vd.$,Y,gc,Ra,zb,null,function(Tg){sa.Lcc(Tg,Id,ve,Pe,Vf,Vd.$)},function(Tg){Id.serverRequestTimeInMs=Id.commandParameters.stopwatch.Ec-Vf;
Tg=pe.a.og(Tg.data);Pe(new Of.a(5,Tg))},bd,$f,Hg,Id.commandParameters.id)})};sa.prototype.pasteRange=function(Y,Ra,zb,gc,bd,Id,Vd,ve){var Pe=this;return new Promise(function(We,Vf){var $f=Vd.commandParameters.stopwatch.Ec;sa.Coj(Pe.$,Y,Ra,zb,gc|-5&bd,function(Hg){sa.Lcc(Hg,Vd,We,Vf,$f,Pe.$)},function(Hg){Vd.serverRequestTimeInMs=Vd.commandParameters.stopwatch.Ec-$f;Hg=pe.a.og(Hg.data);Vf(new Of.a(5,Hg))},Id,ve)})};sa.prototype.L2i=function(Y,Ra,zb,gc,bd,Id,Vd){var ve=this;return new Promise(function(Pe,
We){if(Ra)if(Ra.length>ve.ONa){var Vf=Vd.clipboardItems.getItem(rb.vW),$f=-1;void 0!==Vf&&null!==Vf&&($f=Vf.length);pc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Ra.length,ve.ONa,$f);We(new Of.a(1))}else Vf=function(Hg,Tg,Bi){ve.$.ny();var Cf=Vd.commandParameters.stopwatch.Ec;Hg=jg.b(Hg,function(ti){sa.Lcc(ti,Vd,Pe,We,Cf,ve.$,Ra)});Tg=jg.a(Tg,function(ti){Vd.serverRequestTimeInMs=
Vd.commandParameters.stopwatch.Ec-Cf;ti=pe.a.og(ti.data);We(new Of.a(3,ti))});var Ih=ve.$.na.ta.$b(),Eh=hf.v(Y,ve.$),Gg={};Gg.SourceHtml=Ra;Gg.DestinationRanges=Eh?hf.s(Eh):null;Gg.CopyOperationId=zb;Gg.PasteId=gc;pc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",ve.nMa,Gg.PasteId);return ve.nMa?fd(ve.$.na.wx,Gg,Hg,Tg,Bi,null,Ih,Id):fd(ve.$.na.ta,Gg,Hg,Tg,Bi,null,Ih,Id)},Vf=Nc.EwaSettings.tc()?new cf.a(204,0,Vf,65):new Md.a(204,
0,Vf,1),ve.$.userOperationManager.ic(Vf,bd);else Pe("")})};sa.prototype.M2i=function(Y,Ra,zb,gc,bd){var Id=this;return new Promise(function(Vd,ve){pc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",bd.id);Ra&&(Ra=Ge.a.trimEnd(Ra,"\n","\r"));pc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",bd.id);if(Ra){var Pe=Id.Jvd;if(Ra.length>
Pe)pc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Ra.length,Pe),ve(new Of.a(1));else{var We=hf.v(Y,Id.$);pc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",bd.id);Pe=!Id.$.ea.isNamedObjectViewMode&&!Ra.includes("\n")&&!Ra.includes("\t");pc.ULS.sendTraceTag(537167751,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",
bd.id,Pe);Pe=Pe&&Ge.a.xff(Ra);pc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",bd.id,Pe);var Vf=Id.$.na.ta.$b();if(Pe){var $f=526;pc.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",bd.id);var Hg=Gd.a.jbd(Ra);pc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",
bd.id);var Tg=hf.s(We);Pe=function(Cf,Ih,Eh){var Gg=bd.commandParameters.stopwatch.Ec;Cf=jg.b(Cf,function(ti){pc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",bd.id);bd.requestTelemetryData=ti.RequestTelemetryData;bd.serverRequestTimeInMs=bd.commandParameters.stopwatch.Ec-Gg;ti.Errors&&0<ti.Errors.length?ve(new Of.a(2,ti.Errors)):Vd(Ra)});Ih=jg.a(Ih,function(ti){bd.serverRequestTimeInMs=bd.commandParameters.stopwatch.Ec-
Gg;ti=pe.a.og(ti.data);ve(new Of.a(2,ti))});Id.$.ny();pc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",bd.id);return ge.c(Id.$.na.ta,Tg,Ra,Hg,!1,!1,63,Cf,Ih,Eh,Y,Vf,gc)};var Bi=function(){return new He.a(Tg,Ra,Hg)}}else $f=180,Pe=function(Cf,Ih,Eh){Id.$.ny();var Gg=bd.commandParameters.stopwatch.Ec;Cf=jg.b(Cf,function(ti){pc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",
bd.id);sa.Lcc(ti,bd,Vd,ve,Gg,Id.$,Ra)});Ih=jg.a(Ih,function(ti){bd.serverRequestTimeInMs=bd.commandParameters.stopwatch.Ec-Gg;ti=pe.a.og(ti.data);ve(new Of.a(4,ti))});pc.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",bd.id);return Rb(Id.$.na.ta,We,Ra,Cf,Ih,Eh,null,Vf,gc)},Bi=function(){return new mc(We,Ra)};pc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",
bd.id);Pe=Nc.EwaSettings.tc()?new cf.a($f,0,Pe,65,Bi):new Md.a($f,0,Pe,1,Bi);pc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",bd.id);Id.$.userOperationManager.ic(Pe,zb)}}else Vd("")})};sa.prototype.z9e=function(Y,Ra){Ra=[1===Ra?4:5];this.gridView.Ob.qy(If.a.W0(Ef.d(this.$.pa),Y),Ra,!0);this.gridView.Ob.xs(Ra);this.gridView.Ob.update(!0)};sa.prototype.Rwb=function(){var Y=[4,5];this.gridView.Ob.kl(Y,!1,!this.Tgc);this.gridView.Ob.Ml(null,
Y,!this.Tgc);1===this.gridView.ha.We&&this.gridView.xs(!1,!this.Tgc);this.Tgc&&this.gridView.Ob.update(!1,!1)};sa.prototype.XTg=function(Y,Ra,zb){var gc=[];zb=yl(zb);for(var bd=zb.next();!bd.done;bd=zb.next())Array.add(gc,this.$Tg(Y,Ra,bd.value));return gc};sa.prototype.lY=function(){if(this.ev)for(var Y=yl(this.ev),Ra=Y.next();!Ra.done;Ra=Y.next())Ra=Ra.value,this.$&&this.$.userOperationManager&&(Ra.operation&&pc.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
Td.a(Ra.operation.operationName)),this.YUg(),this.$.userOperationManager.cIa(Ra))};sa.prototype.YUg=function(){if(this.XMa){var Y=this.XMa.Et;pc.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",Y);pe.a.nu(Y);this.Gic&&ge.j(this.$.na.ta,this.Gic,null,null,null);this.Gic=this.XMa=null}};sa.prototype.EF=function(Y,Ra){2===Ra.Aw?(this.ev.clear(),this.XMa=null):1===Ra.Aw&&this.ev&&this.ev.contains(Ra.Og)&&(pc.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",
Td.a(Ra.Og.operation.operationName),Ra.Og.dequeueUtcTime.getTime()-Ra.Og.enqueueUtcTime.getTime()),this.ev.remove(Ra.Og),this.XMa=null)};sa.prototype.$Tg=function(Y,Ra,zb){pc.ULS.shipAssertTag(537167713,0,!!Ra,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");pc.ULS.shipAssertTag(537167712,0,0<Ra.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var gc=0,bd=0,Id=new Set,Vd=new Set;Ra=yl(Ra);for(var ve=Ra.next();!ve.done;ve=Ra.next()){ve=
ve.value;var Pe=String.format("{0}_{1}",ve.left,ve.right),We=String.format("{0}_{1}",ve.top,ve.bottom);Vd.has(Pe)||(Vd.add(Pe),bd+=ve.width);Id.has(We)||(Id.add(We),gc+=ve.height)}if(36===Y)return zb.isSingle?sa.nSe(bd,gc,zb):zb.clone();516===Y&&(Y=gc,gc=bd,bd=Y);Y=!(zb.width%bd)&&!(zb.height%gc);Id=zb.f_&&!(zb.height%gc);zb.x5&&!(zb.width%bd)||Id?zb=sa.nSe(bd,gc,zb):Y?zb=zb.clone():(zb=zb.clone(),zb.bottom=Math.min(Xd.a.Kh,zb.top+gc-1),zb.right=Math.min(Xd.a.Wh,zb.left+bd-1));return zb};sa.prototype.pLg=
function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe,We,Vf){if(!gc||!gc.length)return 1;if(1<gc.length){if(!this.Dfc&&Id)return 3;if(We)return 0;if(ve)return 9;if(Pe)return 8;if(Vf)return 2;if(1<Ra.length)return 4;var $f=Ra[0];if(!Vd&&!re.a.all(gc,function(Hg){return Hg.isSingle||!(Hg.width%$f.width)&&!(Hg.height%$f.height)}))return 5;if((!this.Dfc||!Id)&&Ge.a.equals(Y,zb,!0))for(bd=yl(bd),Y=bd.next();!Y.done;Y=bd.next())if(Y=Y.value,Y.Rd($f)&&!Y.equals($f))return 6}else if(Ra&&0<Ra.length){if(0!==this.ldf(Ra,Pe))return 7;
if(1<Ra.length){if(!this.Dfc&&Id)return 3;if((!this.Dfc||!Id)&&Ge.a.equals(Y,zb,!0))for(Y=yl(Ra),Ra=Y.next();!Ra.done;Ra=Y.next())if(Ra=Ra.value,zb=bd[0],Ra.Rd(zb)&&!Ra.equals(zb))return 6}}return 0};sa.prototype.ldf=function(Y,Ra){if(!Y||1>=Y.length)return 0;if(Ra)return 2;if(!hf.S(Y))return 1;Ra=new nc.a(Ce.a.Gk());for(var zb=yl(Y),gc=zb.next();!gc.done;gc=zb.next()){gc=gc.value;for(var bd=yl(Y),Id=bd.next();!Id.done;Id=bd.next()){Id=Id.value;var Vd=gc.top===Id.top&&gc.bottom===Id.bottom,ve=gc.left===
Id.left&&gc.right===Id.right,Pe=Math.max(gc.left,Id.left)<Math.min(gc.right,Id.right);if(Math.max(gc.top,Id.top)<Math.min(gc.bottom,Id.bottom)&&!Vd||Pe&&!ve)return 3;Ra.add(String.format("{0}-{1}-{2}-{3}",gc.top,gc.bottom,Id.left,Id.right));Ra.add(String.format("{0}-{1}-{2}-{3}",Id.top,Id.bottom,gc.left,gc.right))}}Y=yl(Y);for(zb=Y.next();!zb.done;zb=Y.next())zb=zb.value,Ra.remove(String.format("{0}-{1}-{2}-{3}",zb.top,zb.bottom,zb.left,zb.right));return 0<Ra.count?3:0};sa.prototype.p8i=function(Y){var Ra=
this.gridView.ha;Ra.updateSelection(Y,Y.topLeft,0);Ra.selectionType=-1};sa.prototype.Evb=function(Y){if(null===Y||void 0===Y?0:Y.sourceItem){if(!qc(Y.sourceItem))return null;if((Y=Y.sourceItem)&&hf.cb(Y.ranges,!0))return Y}return null};sa.prototype.hgc=function(Y,Ra){pc.ULS.shipAssertTag(537167711,0,!!Y,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Ra&&Me.a.AI in Ra||Y.tabName?!1:1===Y.method};sa.Coj=function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){function We(){return new od(zb,
gc,bd)}function Vf(Hg,Tg,Bi){Y.ny();var Cf=Y.na.ta;Hg=jg.b(Hg,Id);Tg=jg.a(Tg,Vd);var Ih=ve;Ih=void 0===Ih?null:Ih;var Eh=Cf.Na(9,$f);Eh.sourceRanges=zb;Eh.destinationRanges=gc;Eh.flags=bd;return ge.i(Cf,"PasteRange",Eh,Hg,Tg,Bi,null,64,Ih)}var $f=Y.na.ta.$b(Pe);Pe=Nc.EwaSettings.tc()?new cf.a(506,0,Vf,65,We):new Md.a(506,0,Vf,1,We);Y.userOperationManager.ic(Pe,Ra)};sa.Lcc=function(Y,Ra,zb,gc,bd,Id,Vd){Vd=void 0===Vd?null:Vd;pc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",
Ra.id);Ra.requestTelemetryData=Y.RequestTelemetryData;Ra.serverRequestTimeInMs=Ra.commandParameters.stopwatch.Ec-bd;kd.a.lh(Y.Errors)?kd.a.dha(Y.Errors)?(Ra&&(Ra.encounteredDeploymentErrors=!0),pc.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",kd.a.Uc(Y.Errors))):gc(new Of.a(5,Y.Errors)):Y.Result?(gc=!!Y&&!!Y.RequestTelemetryData,df.g(Id).Li.wla(Ra.commandParameters.stopwatch.id,
Y.StateId,gc?Y.RequestTelemetryData.EcsOperationDuration:0,gc?Y.RequestTelemetryData.EcsRequestDuration:0,gc?Y.RequestTelemetryData.WfeRequestDuration:0),Ra.pastedRange=Y.Result.SheetMultiRange,pc.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Ra.id),zb(!0)):(pc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",
Ra.id),zb(Vd||!0))};sa.xNd=function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe,We,Vf,$f){function Hg(){return new Xb(Cf)}function Tg(Ih,Eh,Gg){Y.ny();return ld(Y.na.ta,Cf,jg.b(Ih,Vd),jg.a(Eh,ve),Gg,Id,Bi,Pe)}var Bi=Y.na.ta.$b(),Cf=sa.F8g(zb,gc,bd,We,Vf,$f);zb=Nc.EwaSettings.tc()?new cf.a(503,0,Tg,65,Hg):new Md.a(503,0,Tg,1,Hg);Y.userOperationManager.ic(zb,Ra)};sa.F8g=function(Y,Ra,zb,gc,bd,Id){var Vd={};Vd.ShadowWorkbookBase64=Y.shadowWorkbookBase64;Vd.SourceRanges={};Vd.SourceRanges.Ranges=Array(1);Vd.SourceRanges.Ranges[0]=
{};Vd.SourceRanges.Ranges[0].FirstRow=Y.rangeRowStart;Vd.SourceRanges.Ranges[0].LastRow=Y.rangeRowEnd;Vd.SourceRanges.Ranges[0].FirstColumn=Y.rangeColumnStart;Vd.SourceRanges.Ranges[0].LastColumn=Y.rangeColumnEnd;Nc.EwaSettings.getBooleanFeatureGate(Je.a.y4b,!1)?zb?Vd.DestinationRanges=hf.u(zb.SheetName,zb.NamedObjectName,hf.g(zb.Ranges)):(pc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),Vd.DestinationRanges=null):Vd.DestinationRanges=
Ra?hf.s(Ra):null;Vd.CopyPasteTargetType=1;Vd.PasteType=gc;Vd.CopyOperationId=bd;Vd.PasteId=Id;Vd.SourceClientPath=Y.sourceClientPath;Vd.SourceSheetName=Y.sourceSheetName;Vd.SourceWorkbookName=Y.sourceWorkbookName;if(!Y.originalSourceRangesCountExceedsLimit&&Y.originalSourceRanges&&0<Y.originalSourceRanges.length&&1024===gc){Vd.OriginalSourceMultiRange={};Ra=Array(Y.originalSourceRanges.length);for(zb=0;zb<Ra.length;++zb)Ra[zb]={},Ra[zb].FirstRow=Y.originalSourceRanges[zb][0],Ra[zb].FirstColumn=Y.originalSourceRanges[zb][1],
Ra[zb].LastRow=Y.originalSourceRanges[zb][2],Ra[zb].LastColumn=Y.originalSourceRanges[zb][3];Vd.OriginalSourceMultiRange.Ranges=Ra}return Vd};sa.nSe=function(Y,Ra,zb){zb=zb.clone();zb.height<Ra&&(zb.bottom=Math.min(Xd.a.Kh,zb.top+Ra-1));zb.width<Y&&(zb.right=Math.min(Xd.a.Wh,zb.left+Y-1));return zb};sa.prototype.executeInsertCopiedCutCellsOperation=function(Y,Ra,zb,gc,bd,Id,Vd){function ve(){return new Va(Pe)}Id=void 0===Id?null:Id;Vd=void 0===Vd?null:Vd;var Pe={};Pe.InsertDirection=gc;Pe.SourceRange=
Y;Pe.DestRange=Ra;Pe.CopyCutOperation=zb?0:1;var We=this.$.na.ta;return ud.a(this.$.userOperationManager,function(Vf,$f,Hg){Vf=Id?jg.b(Vf,Id):Vf;$f=Vd?jg.a($f,Vd):$f;var Tg=We.Na(41,null);Tg.insertCopiedCutCellsParameters=Pe;return ge.i(We,"InsertCopiedCutCells",Tg,Vf,$f,Hg,null,4)},function(Vf){return new cf.a(104,0,Vf,void 0,ve)},bd)};sa.prototype.bih=function(Y,Ra,zb,gc,bd,Id){var Vd=this;return new Promise(function(ve,Pe){function We($f){$f=pe.a.og($f.data);Pe(new Of.a(21,$f))}function Vf($f){Y.requestTelemetryData=
$f.RequestTelemetryData;$f.Errors&&0<$f.Errors.length?Pe(new Of.a(21,$f.Errors)):ve(!0)}Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?Vd.executeInsertCopiedCutCellsOperation(Ra,zb,gc,bd,Id,Vf,We):Vd.executeInsertCopiedCutCellsOperation(Ra,zb,gc,bd,Id,Vf,We).continueWith(function(){if(gc)Vd.Rwb();else{var $f=Vd.$.da.Aa(254);$f&&$f.W1b("DragDropInsert/success/"+Od.a[Id.method],!0)}})})};Qk.Object.defineProperties(sa.prototype,{Jvd:{configurable:!0,
enumerable:!0,get:function(){pc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},ONa:{configurable:!0,enumerable:!0,get:function(){return this.nMa?Nc.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):Xd.a.ONa}}});Object(Yc.a)(sa,"CopyPasteUtils",null,[575]);var uf=b(498),Hh;
(function(Y){Y[Y.range=0]="range";Y[Y.art=1]="art"})(Hh||(Hh={}));Object(Yc.b)("SourceItemType",Hh);var Sf=b(24),Zg=b(92);Nb.prototype.serializeSourceItem=function(Y){var Ra={};if(Y&&Object.getType(Y)===pd)Ra.sheetName=Y.sheetName,Ra.topArray=re.a.map(Y.ranges,function(zb){return zb.top}),Ra.leftArray=re.a.map(Y.ranges,function(zb){return zb.left}),Ra.bottomArray=re.a.map(Y.ranges,function(zb){return zb.bottom}),Ra.rightArray=re.a.map(Y.ranges,function(zb){return zb.right}),Ra.sessionStateId=Y.sessionStateId,
Ra.sessionId=Y.sessionId,Ra.sourceItemType=this.oYf(0);else if(Y&&Object.getType(Y)===ne)Ra.activeFloatingObjectControlId=Y.activeFloatingObjectControlId,Ra.sheetName=Y.sheetName,Ra.sessionStateId=Y.sessionStateId,Ra.sessionId=Y.sessionId,Ra.floatingObjectType=this.dpj(Y.type),Ra.sourceItemType=this.oYf(1);else return pc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Ra)};Nb.prototype.serializeCommandParameters=
function(Y){if(!Y)return pc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Ra={};Ra.id=Y.id;Ra.commandType=Y.commandType;Ra.copyPasteTargetType=Y.copyPasteTargetType;Y.ribbonCommandInfo&&(Ra.ribbonCommandName=this.lpj(Y.ribbonCommandInfo.command),Ra.inputMethodName=this.fpj(Y.ribbonCommandInfo.method),Ra.frameModeName=this.epj(Y.ribbonCommandInfo.mode),Ra.uiLocationName=this.opj(Y.ribbonCommandInfo.df),Ra.tabName=Y.ribbonCommandInfo.tabName);
return JSON.stringify(Ra)};Nb.prototype.deserializeSourceItem=function(Y){if(!Y)return null;try{var Ra=JSON.parse(Y);if(!Ra)return pc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var zb=null;switch(this.Sdh(Ra.sourceItemType)){case 0:zb=new pd(this.$,this.Pdh(Ra),Ra.sheetName,Ra.sessionStateId,Ra.sessionId);break;case 1:zb=new ne(Ra.activeFloatingObjectControlId,Ra.sheetName,Ra.sessionStateId,Ra.sessionId,this.Mdh(Ra.floatingObjectType))}return zb}catch(gc){return pc.ULS.sendTraceTag(537167702,
0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:0,gc),null}};Nb.prototype.deserializeCommandParameters=function(Y){if(!Y)return null;try{var Ra=JSON.parse(Y);if(!Ra)return pc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;var zb=qg.a();zb.id=Ra.id;zb.ribbonCommandInfo=this.Rdh(Ra);zb.commandType=Ra.commandType;zb.copyPasteTargetType=
Ra.copyPasteTargetType;return zb}catch(gc){return pc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:0,gc),null}};Nb.prototype.Pdh=function(Y){var Ra=[];pc.ULS.shipAssertTag(537167699,0,!!Y.topArray&&0<Y.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",Y.topArray?"empty":"null");pc.ULS.shipAssertTag(537167698,0,!!Y.leftArray&&
0<Y.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",Y.leftArray?"empty":"null");pc.ULS.shipAssertTag(537167697,0,!!Y.bottomArray&&0<Y.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",Y.bottomArray?"empty":"null");pc.ULS.shipAssertTag(537167696,0,!!Y.rightArray&&0<Y.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",Y.rightArray?"empty":"null");if(!(Y.topArray&&
Y.leftArray&&Y.bottomArray&&Y.rightArray))return Ra;pc.ULS.shipAssertTag(537167695,0,Y.topArray.length===Y.bottomArray.length&&Y.topArray.length===Y.leftArray.length&&Y.topArray.length===Y.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",Y.topArray.length,Y.bottomArray.length,Y.leftArray.length,Y.rightArray.length);for(var zb=Math.min(Y.topArray.length,Y.bottomArray.length,Y.leftArray.length,
Y.rightArray.length),gc=0;gc<zb;gc++)Array.add(Ra,new Sf.Range(Y.topArray[gc],Y.leftArray[gc],Y.bottomArray[gc],Y.rightArray[gc],!1,!1));return Ra};Nb.prototype.Rdh=function(Y){return new Zg.a(this.Qdh(Y.ribbonCommandName),this.Odh(Y.inputMethodName),this.Ndh(Y.frameModeName),this.Tdh(Y.uiLocationName),Y.tabName)};Nb.prototype.lpj=function(Y){return void 0!==Y&&null!==Y&&Y.toString()in this.DLd?this.DLd[Y.toString()]:(pc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,Y),this.DLd["-911352779"])};Nb.prototype.Qdh=function(Y){return Y&&Y in this.B7f?this.B7f[Y]:(pc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,Y),-911352779)};Nb.prototype.fpj=function(Y){return void 0!==Y&&null!==Y&&Od.a[Y]in this.qka?this.qka[Od.a[Y]]:(pc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",
Y),this.qka.unknown)};Nb.prototype.Odh=function(Y){return Y&&Y in this.A7f?this.A7f[Y]:(pc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",Y),0)};Nb.prototype.epj=function(Y){return void 0!==Y&&null!==Y&&uf.a[Y]in this.T2a?this.T2a[uf.a[Y]]:(pc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",Y),this.T2a.edit)};Nb.prototype.Ndh=function(Y){return Y&&Y in this.z7f?this.z7f[Y]:
(pc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",Y),2)};Nb.prototype.oYf=function(Y){return void 0!==Y&&null!==Y&&Hh[Y]in this.qLb?this.qLb[Hh[Y]]:(pc.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",Y),this.qLb.range)};Nb.prototype.Sdh=function(Y){return Y&&Y in this.C7f?this.C7f[Y]:(pc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",
Y),0)};Nb.prototype.dpj=function(Y){return void 0!==Y&&null!==Y&&Y.toString()in this.aXc?this.aXc[Y.toString()]:(pc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",Y),this.aXc["99"])};Nb.prototype.Mdh=function(Y){return Y&&Y in this.y7f?this.y7f[Y]:(pc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",Y),99)};Nb.prototype.opj=function(Y){return void 0!==Y&&
null!==Y&&Zb.a[Y]in this.Gr?this.Gr[Zb.a[Y]]:(pc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",Y),this.Gr.ribbon)};Nb.prototype.Tdh=function(Y){return Y&&Y in this.D7f?this.D7f[Y]:(pc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",Y),2)};Object(Yc.a)(Nb,"EnvironmentSerializationHelper",null,[]);Ib.GVf="SameSession";Ib.FFe="CrossSession";Ib.clf="LegacyCrossSession";Ib.external=
"External";Object(Yc.a)(Ib,"PayloadOrigin",null,[]);Sa.prototype.shouldWaitForCopyToComplete=function(){return!1};Sa.prototype.onDeferredPasteStarted=function(){};Sa.prototype.onDeferredPasteCompleted=function(){};Sa.prototype.beforePaste=function(){};Sa.prototype.POj=function(Y){var Ra=null;try{var zb=Y.getItem(rb.zO);if(!zb)return{returnValue:!1,E0:Ra};Ra=JSON.parse(zb);return{returnValue:this.rpi(Ra),E0:Ra}}catch(gc){return pc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+
gc),{returnValue:!1,E0:Ra}}};Sa.prototype.rpi=function(Y){return!!Y&&(!!Y.shadowWorkbookBase64||Y.shadowWorkbookSizeExceedsLimit)&&void 0!==Y.rangeRowStart&&void 0!==Y.rangeRowEnd&&void 0!==Y.rangeColumnStart&&void 0!==Y.rangeColumnEnd};Sa.prototype.kpc=function(Y){Y.wasLastCopyExternal=!0;if(Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Qc.a.LC&&516!==Y.commandParameters.commandType&&1028!==Y.commandParameters.commandType){var Ra=this.POj(Y.clipboardItems);
var zb=Ra.E0;if(Ra.returnValue)return Y.isShadowWorkbookParsedSuccessfully=!0,this.LYi(Y,zb)}return 516!==Y.commandParameters.commandType&&36!==Y.commandParameters.commandType?Nc.EwaSettings.la(162)&&20!==Y.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.Jfc)&&(zb=Y.clipboardItems.getItem(rb.html),void 0!==zb&&null!==zb&&zb&&zb.trim()!==this.eXc&&(zb.startsWith("<")||Qc.a.Df&&zb.startsWith("\n<")))?(Ra=Y.clipboardItems.getItem(rb.X2c),this.JYi(Y,zb,void 0===
Ra?null:Ra)):this.eHf(Y):Promise.reject(new Of.a(6))};Sa.prototype.LYi=function(Y,Ra){pc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");Y.pasteResult="SystemClipboardShadowWorkbookPaste";Y.payloadType=oe.zO;Y.payloadOrigin=Ib.external;Y.shadowWorkbookPayloadSize=Jc(Ra);Y.shadowWorkbookSizeExceedsLimit=Mb(Ra);var zb=null,gc=null,bd=Y.commandParameters.originalDestinations;Nc.EwaSettings.getBooleanFeatureGate(Je.a.y4b,
!1)?zb=hf.r(bd,this.$):gc=hf.v(hf.K(bd),this.$);Ra.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Y.originalSourceRangesCountExceedsLimit=Ra.originalSourceRangesCountExceedsLimit);if(Y.shadowWorkbookSizeExceedsLimit)return pc.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Xd.a.Akc,Ra.shadowWorkbookSizeExceedsLimit),
Promise.reject(new Of.a(1));pc.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",Y.commandParameters.id);return this.Ur.iHf(Y.commandParameters.ribbonCommandInfo,gc,zb,Ra,[Y.commandParameters.stopwatch],Y)};Sa.prototype.eHf=function(Y){var Ra=Y.clipboardItems.getItem(rb.vW);if(void 0!==Ra&&null!==Ra&&Ra.trim()===this.eXc)return Promise.reject(new Of.a(7));void 0!==Ra&&null!==Ra&&(Y.plainTextPayloadSize=Ra.length);
Y.isPlainTextPaste=!0;Y.pasteResult="SystemClipboardPaste";Y.payloadOrigin=sd(Y)?Ib.clf:Ib.external;Y.payloadType=oe.vW;pc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",Y.id,Y.commandParameters.id);Ra=this.Ur.M2i(hf.K(Y.commandParameters.originalDestinations),Ra,Y.commandParameters.ribbonCommandInfo,[Y.commandParameters.stopwatch],Y);pc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",
Y.id);return Ra};Sa.prototype.JYi=function(Y,Ra,zb){Y.htmlPayloadSize=Ra.length;Y.isHtmlPaste=!0;Y.pasteResult="SystemClipboardHtmlPaste";Y.payloadType=oe.html;Y.payloadOrigin=sd(Y)?Ib.clf:Ib.external;pc.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",Y.commandParameters.id);return this.Ur.L2i(hf.K(Y.commandParameters.originalDestinations),Ra,zb,Y.commandParameters.id,Y.commandParameters.ribbonCommandInfo,[Y.commandParameters.stopwatch],
Y)};Sa.prototype.dFe=function(Y){var Ra={};Y&&(Ra.shadowWorkbookBase64=Y.ShadowWorkbookBase64,Ra.shadowWorkbookSizeExceedsLimit=Y.ShadowWorkbookSizeExceedsLimit,Ra.originalSourceRangesCountExceedsLimit=Y.OriginalSourceRangesCountExceedsLimit,Ra.originalSourceRangesCount=Y.OriginalSourceRangesCount,Ra.shadowWorkbookBlockedSize=Y.ShadowWorkbookBlockedSize);return Ra};Sa.prototype.Rfg=function(Y,Ra){var zb=nd(Y),gc=32===(Y.commandParameters.commandType&32),bd=1024===(Y.commandParameters.commandType&
1024),Id=!1,Vd=null,ve=null,Pe=!1;if(!zb){Id=-1985798686===Y.commandParameters.ribbonCommandInfo.command;var We=Y.copyContextSnapshot;if(Ra)Pe=!We.sourceItem.isFromCurrentSession(this.$);else if(We=this.Ur.Evb(We))Vd=We.ranges,ve=We.sheetName,Pe=!Y.isSameSession}return this.Ur.pLg(ve,Vd,this.$.pa.sheetName,Y.commandParameters.originalDestinations,Y.commandParameters.expandDestinations,Pe,gc,bd,Id,Ra,zb)};Qk.Object.defineProperties(Sa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
eXc:{configurable:!0,enumerable:!0,get:function(){return this.Km.Va(5)}}});Object(Yc.a)(Sa,"BaseCopyPasteHandler",null,[671,672,673]);ib.prototype.getValue=function(Y){return this.key&&this.key.isEqual(Y)?this.createClipboardItems(this.clipboardItems):null};ib.prototype.setValue=function(Y,Ra){this.key=Y;this.clipboardItems=this.createClipboardItems(Ra)};ib.prototype.createClipboardItems=function(Y){var Ra=this.s$.create(),zb=Y.getItem(rb.vW);zb&&Ra.setItem(rb.vW,zb);(zb=Y.getItem(rb.zO))&&Ra.setItem(rb.zO,
zb);(Y=Y.getItem(rb.html))&&Ra.setItem(rb.html,Y);return Ra};Object(Yc.a)(ib,"CopyCache",null,[]);var Pd=b(67);vm(Tb,Sa);Tb.prototype.getSourceItem=function(){var Y=re.a.clone(this.gridView.ha.va.selectedRanges);return new pd(this.$,Y,this.$.ea.pa.sheetName,this.$.ea.uf,this.$.ya.UserSessionId)};Tb.prototype.beforeSerialize=function(Y){var Ra=this;Y.isSelectionAllowed=!1;Y.isAsyncCopy=!1;Y.isFromCache=!1;Y.encounteredDeploymentErrors=!1;Y.plainTextPayloadSize=0;Y.shadowWorkbookPayloadSize=0;Y.htmlPayloadSize=
0;Y.clientSideCopyTime=0;var zb=new Lg.a(this.$.xa),gc=Y.sourceItem;Y.isSelectionAllowed=re.a.all(gc.ranges,function(bd){return Ra.isSelectionAllowed(zb,bd)});Y.isSelectionAllowed&&this.Ur.z9e(gc.ranges,Y.commandParameters.commandType)};Tb.prototype.yMa=function(Y){return this.gridView.Ca.GH()&&df.i(this.gridView,Y)};Tb.prototype.gZi=function(Y,Ra,zb,gc){var bd=!1,Id=1===Ra.commandParameters.commandType,Vd=gc[0].kU;1===zb.ranges.length&&1===gc.length?Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&
Id&&1!==Vd&&Vd!==zb.ranges[0].kU?Y.cseStatus=17:bd=this.P3g.a7c(Y,hf.K(zb.ranges),zb.sheetName,hf.K(Y.commandParameters.expandDestinations),this.$.ea.pa.sheetName,Id):Y.cseStatus=5;bd&&df.g(this.$).Li.L0(Y.commandParameters.stopwatch.id,Pd.BasicTelemetryCalculator.cR);return this.QYi(Y,zb,hf.u(this.$.pa.sheetName,null,gc),Ra.commandParameters.commandType,bd)};Tb.prototype.isSelectionAllowed=function(Y,Ra){return Y.zzb(Ra,this.gridView)};Tb.prototype.QYi=function(Y,Ra,zb,gc,bd){Ra=hf.u(Ra.sheetName,
null,Ra.ranges);Y.pasteResult="SameSessionPaste";Y.payloadOrigin=Ib.GVf;Y.payloadType=oe.Wzg;pc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",Y.commandParameters.id);return this.Ur.pasteRange(Y.commandParameters.ribbonCommandInfo,Ra,zb,gc,Y.commandParameters.commandType,[Y.commandParameters.stopwatch],Y,bd)};Object(Yc.a)(Tb,"BaseRangeCopyPasteHandler",Sa,[]);var jh=b(32);Ab.prototype.onDeferredPasteStarted=function(Y){this.IU.xb(Y.id)||
this.IU.add(Y.id,!0);if(0<this.IU.count){var Ra=Lh.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Da.TaskExtensions.Ba(Ra,function(){Ra.result.ig(28,null)},this.$.ma,3)}};Ab.prototype.onDeferredPasteCompleted=function(Y){var Ra=0<this.IU.count;this.IU.xb(Y.id)&&this.IU.remove(Y.id);if(Ra&&!this.IU.count){var zb=Lh.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Da.TaskExtensions.Ba(zb,function(){zb.result.removeEntry(28)},this.$.ma,3)}};Object(Yc.a)(Ab,"DeferredPasteTracker",null,[]);var ci;(function(Y){Y[Y.none=
0]="none";Y[Y.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";Y[Y.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";Y[Y.asyncCopyCanceled=3]="asyncCopyCanceled";Y[Y.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(ci||(ci={}));Object(Yc.b)("CopyErrorType",ci);var dh=b(1053),xe=b(1208),Ag=dh.a;vm(kc,Ag);Object(Yc.a)(kc,"CopyInnerError",dh.a,[]);vm(mb,Tb);mb.prototype.serialize=function(Y){var Ra=Y.sourceItem,zb={},gc=this.W2c.getValue(Ra);
if(gc)zb.synchronousResult=gc,Y.isFromCache=!0,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Ec;else{var bd=null,Id=hf.F(Ra.ranges);if(!cg.a.Wef()&&this.yMa(Id)){pc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Id=this.clipboardRangeFactory.create(Id);try{bd=Id.toString(),gc=this.s$.create(),gc.setItem(rb.vW,bd),this.W2c.setValue(Ra,gc),zb.synchronousResult=gc,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Ec}finally{Id&&
Id.dispose()}}else Y.isAsyncCopy=!0,zb.synchronousResult=this.s$.create(),zb.synchronousResult.setItem(rb.vW,this.eXc);zb.asynchronousResult=this.Wdd(Y,Ra,bd)}Y.syncClipboardItemsKeys=Ne(zb.synchronousResult);return zb};mb.prototype.shouldWaitForCopyToComplete=function(Y){if(!Y||!Y.copyContextSnapshot)return pc.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;pc.ULS.shipAssertTag(537167906,
0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(Y.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return pc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;pc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};mb.prototype.onDeferredPasteStarted=
function(Y){this.IU.onDeferredPasteStarted(Y)};mb.prototype.onDeferredPasteCompleted=function(Y){this.IU.onDeferredPasteCompleted(Y)};mb.prototype.deserialize=function(Y){Y.isClipboardDataContainShadowWorkbook=!(void 0===Y.clipboardItems.getItem(rb.zO)||null===Y.clipboardItems.getItem(rb.zO));if(df.g(this.$).ha.We&326)return nd(Y)&&(Y.wasLastCopyExternal=!0),Promise.reject(new Of.a(17));var Ra=this.Rfg(Y,!1);if(0!==Ra)return Promise.reject(new Of.a(nd(Y)?18:Y.isSameSession?19:20,void 0,void 0,void 0,
Ra));var zb=Y.copyContextSnapshot,gc=this.Ur.Evb(zb);if(nd(Y))return this.kpc(Y);Ra=Y.commandParameters.originalDestinations;if(gc&&Y.isSameSession)return this.gZi(Y,zb,gc,Ra);if(516!==Y.commandParameters.commandType){gc=this.OOj(Y.clipboardItems);zb=gc.E0;if(gc.returnValue){Y.isShadowWorkbookParsedSuccessfully=!0;var bd=gc=null;Nc.EwaSettings.getBooleanFeatureGate(Je.a.y4b,!1)?gc=hf.r(Ra,this.$):bd=hf.v(hf.K(Ra),this.$);return this.HYi(Y,bd,gc,zb)}if(Y.isClipboardInaccessible)return Promise.reject(new Of.a(8));
if(36!==Y.commandParameters.commandType)return this.eHf(Y)}return Promise.reject(new Of.a(6))};mb.prototype.beforePaste=function(Y){this.$.da.Aa(373).Ulj(Y);Y.indicationDisplayScheduled=!0};mb.prototype.jOj=function(Y){if(!(Y&&Y.SourceRanges&&Y.SourceRanges.Ranges&&Y.SourceRanges.Ranges.length&&(Y.OriginalSourceRangesCountExceedsLimit||Y.OriginalSourceMultiRange&&Y.OriginalSourceMultiRange.Ranges&&Y.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,E0:null};var Ra=Y.SourceRanges.Ranges[0];
if(!Y.ShadowWorkbookBase64&&!Y.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,E0:null};var zb=this.dFe(Y);zb.rangeRowStart=Ra.FirstRow;zb.rangeRowEnd=Ra.LastRow;zb.rangeColumnStart=Ra.FirstColumn;zb.rangeColumnEnd=Ra.LastColumn;zb.sourceClientPath=Y.SourceClientPath;zb.sourceSheetName=Y.SourceSheetName;zb.sourceWorkbookName=Y.SourceWorkbookName;if(!Y.OriginalSourceRangesCountExceedsLimit)for(Y=Y.OriginalSourceMultiRange.Ranges,zb.originalSourceRanges=Array(Y.length),Ra=0;Ra<Y.length;++Ra)zb.originalSourceRanges[Ra]=
[Y[Ra].FirstRow,Y[Ra].FirstColumn,Y[Ra].LastRow,Y[Ra].LastColumn];return{returnValue:!0,E0:zb}};mb.prototype.OOj=function(Y){var Ra=null;Y=Y.getItem(rb.zO);if(!Y)return{returnValue:!1,E0:Ra};Ra=JSON.parse(Y);return{returnValue:this.qpi(Ra),E0:Ra}};mb.prototype.qpi=function(Y){return!!Y&&(!!Y.shadowWorkbookBase64||Y.shadowWorkbookSizeExceedsLimit)&&void 0!==Y.rangeRowStart&&void 0!==Y.rangeRowEnd&&void 0!==Y.rangeColumnStart&&void 0!==Y.rangeColumnEnd};mb.prototype.HYi=function(Y,Ra,zb,gc){pc.ULS.shipAssertTag(537167903,
0,!!gc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");Tc.AFrameworkApplication.AK("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");Y.pasteResult="CrossSessionPaste";Y.payloadOrigin=Ib.FFe;Y.payloadType=oe.zO;Y.shadowWorkbookPayloadSize=Jc(gc);Y.shadowWorkbookSizeExceedsLimit=Mb(gc);gc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Y.originalSourceRangesCountExceedsLimit=gc.originalSourceRangesCountExceedsLimit);
if(Y.shadowWorkbookSizeExceedsLimit)return pc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Xd.a.Akc,gc.shadowWorkbookSizeExceedsLimit),Promise.reject(new Of.a(1));if(1028===Y.commandParameters.commandType&&Y.originalSourceRangesCountExceedsLimit)return pc.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",
gc.originalSourceRangesCount,Xd.a.Gzi,gc.originalSourceRangesCountExceedsLimit),Promise.reject(new Of.a(1));pc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",Y.commandParameters.id);return this.Ur.iHf(Y.commandParameters.ribbonCommandInfo,Ra,zb,gc,[Y.commandParameters.stopwatch],Y)};mb.prototype.Wdd=function(Y,Ra,zb){var gc=this;pc.ULS.shipAssertTag(537167901,0,!!Y,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");
var bd=Y.commandParameters.stopwatch.Ec;return new Promise(function(Id,Vd){pc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",Y.id);var ve=hf.u(Ra.sheetName,null,Ra.ranges);gc.Ur.copy(ve,Y.commandParameters,function(Pe){Y.requestTelemetryData=Pe.RequestTelemetryData;Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Ec-bd;if(kd.a.lh(Pe.Errors))kd.a.dha(Pe.Errors)?(Y.encounteredDeploymentErrors=
!0,pc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",kd.a.Uc(Pe.Errors),Y.id)):(pc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",kd.a.Uc(Pe.Errors),Y.id),Vd(new kc(2,Pe.Errors)));else if(pc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",
Y.id),Y.markForCancellation)Vd(new kc(3,Pe.Errors));else{Pe=Pe.Result;var We=Pe.PlainTextResult;void 0!==zb&&null!==zb&&(We=zb);void 0!==We&&null!==We&&(Y.plainTextPayloadSize=We.length);var Vf=gc.s$.create(),$f=gc.jOj(Pe);var Hg=$f.E0;$f.returnValue&&(Y.shadowWorkbookPayloadSize=Jc(Hg),Y.shadowWorkbookSizeExceedsLimit=Mb(Hg),Y.originalSourceRangesCountExceedsLimit=Pe.OriginalSourceRangesCountExceedsLimit,Hg=JSON.stringify(Hg),Vf.setItem(rb.zO,Hg));Vf.setItem(rb.vW,We);cg.a.Wef()&&(We=Pe.HtmlResult,
Y.htmlSizeExceedsLimit=Pe.HtmlSizeExceedsLimit,void 0!==We&&null!==We&&(Y.htmlPayloadSize=We.length),Vf.setItem(rb.html,We));Y.copyTotalSizeExceedsLimit=Pe.CopyTotalSizeExceedsLimit;Vf.setItem(rb.X2c,Y.commandParameters.id);gc.W2c.setValue(Ra,Vf);Y.asyncClipboardItemsKeys=Ne(Vf);Id(Vf)}},function(Pe){Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Ec-bd;Pe=pe.a.og(Pe.data);pc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",
kd.a.Uc(Pe),Y.id);Vd(new kc(2,Pe))},[Y.commandParameters.stopwatch])})};Object(Yc.a)(mb,"AcrossSessionRangeCopyPasteHandler",Tb,[]);Object(Yc.a)(Wa,"CopyArtRequest",null,[]);Object(Yc.a)(cb,"PasteArtRequest",null,[]);Fa.prototype.k5h=function(Y){if(this.vli(Y.FNa)){pc.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",Y.FNa);var Ra=this.DHb.oa(Y.FNa);this.DHb.ia(Y.FNa,Y);var zb=Ra.promise;Ra.lff=!1;return this.vlh(Y,
zb)}this.DHb.ia(Y.FNa,Y);return this.hsi(Y)};Fa.prototype.vli=function(Y){return this.DHb.xb(Y)};Fa.prototype.hsi=function(Y){var Ra=this;return new Promise(function(zb,gc){Y.promise=Ra.nZa.dHf(Y).then(function(bd){zb(null);return Ra.Hnc(Y,bd)},function(bd){gc(null);return Ra.ODb(bd)})})};Fa.prototype.vlh=function(Y,Ra){var zb=this;return new Promise(function(gc,bd){Y.promise=Ra.then(function(Id){zb.OTj(Y,Id);return zb.nZa.dHf(Y).then(function(Vd){gc(null);return zb.Hnc(Y,Vd)},function(Vd){bd(null);
return zb.ODb(Vd)})},function(Id){return zb.ODb(Id)})})};Fa.prototype.Hnc=function(Y,Ra){Y.lff&&(this.wYg(Y.FNa),this.$Md(Y,Ra));return this.m3i(Ra)};Fa.prototype.wYg=function(Y){this.DHb.remove(Y)};Fa.prototype.$Md=function(Y,Ra){var zb=this.AYh();Y.FNa===zb&&this.nZa.$Md(Y.destination,Ra,Y.item.type)};Fa.prototype.AYh=function(){var Y=df.g(this.$).ha.Pa.activeFloatingObjectControlId;Y||(Y=hf.v(df.g(this.$).ha.va.activeCell,this.$),Y=Y.FirstRow+"_"+Y.FirstColumn);return Y};Fa.prototype.OTj=function(Y,
Ra){Y.destination=null;Y.DHe=Ra};Object(Yc.a)(Fa,"PasteArtRequestManager",null,[]);var Jf=b(187),Oe=b(115),$h=b(102);vm(ta,Sa);ta.prototype.getSourceItem=function(){pc.ULS.shipAssertTag(537167896,0,!!this.ha.Pa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");pc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Pa.activeFloatingObjectControlId);return new ne(this.ha.Pa.activeFloatingObjectControlId,
this.$.ea.pa.sheetName,this.$.ea.uf,this.$.ya.UserSessionId,this.ha.Pa.mc.floatingObject.type)};ta.prototype.beforeSerialize=function(Y){Y&&Y.commandParameters?(Y?(Y.isAsyncCopy=!1,Y.isSelectionAllowed=!1,Y.isFromCache=!1,Y.plainTextPayloadSize=0,Y.shadowWorkbookPayloadSize=0,Y.htmlPayloadSize=0,Y.htmlSizeExceedsLimit=!1,Y.clientSideCopyTime=0,Y.encounteredDeploymentErrors=!1,Y.shadowWorkbookSizeExceedsLimit=!1,Y.originalSourceRangesCountExceedsLimit=!1,Y.copyTotalSizeExceedsLimit=!1):pc.ULS.sendTraceTag(537167826,
0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),Y.commandParameters.copyPasteTargetType=2):pc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};ta.prototype.serialize=function(Y){var Ra=Y.sourceItem,zb={};if(!Ra)return pc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),zb;if(!this.ioi())return pc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
zb;pc.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Ra.activeFloatingObjectControlId);this.eEd();var gc=this.V2c.getValue(Ra);if(gc)zb.synchronousResult=gc,Y.isFromCache=!0,Y.isAsyncCopy=!1,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Ec,1===Y.commandParameters.commandType&&this.$.ye(2045211913,Y.commandParameters.ribbonCommandInfo.method,Y.commandParameters.ribbonCommandInfo.df,null);else{Y.isFromCache=!1;Y.isAsyncCopy=
!0;gc=this.s$.create();if(Y.commandParameters.uploadToClipService){var bd={};bd["data-clipservice-ccpid"]=Y.commandParameters.id;bd["data-pkey"]=Y.commandParameters.pKey;bd["data-clipservice-type"]=Y.commandParameters.clipServiceDataType;bd["data-clipservice-count"]=Y.commandParameters.objectCount.toString();bd["data-clipservice-dc"]=Y.commandParameters.clipServiceDataCenter;bd["data-clipservice-client"]=this.qZg;bd["data-TimeStamp"]=(new Date).toUTCString();bd["data-clipservice-version"]=this.rZg;
gc.setItem(rb.fIg,JSON.stringify(bd))}zb.synchronousResult=this.zBg(gc);zb.asynchronousResult=this.Wdd(Y,Ra,gc)}Y.syncClipboardItemsKeys=Ne(zb.synchronousResult);return zb};ta.prototype.zBg=function(Y){pc.ULS.shipAssertTag(537167891,0,!!this.ha.Pa.mc,"Expecting a floating object to be currently selected for copy");Y||(Y=this.s$.create());var Ra=this.ha.Pa.mc.fub();Ra&&(Ra=String.format("<img src='{0}'>",Ra),Y.setItem(rb.html,Ra));return Y};ta.prototype.eEd=function(){var Y=this.ha.Pa.mc;this.eob.eEd(Oe.a.aqb(Y.floatingObject),
Oe.a.tZg(Y.Kt))};ta.prototype.shouldWaitForCopyToComplete=function(){pc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};ta.prototype.onDeferredPasteStarted=function(Y){this.IU.onDeferredPasteStarted(Y)};ta.prototype.onDeferredPasteCompleted=function(Y){this.IU.onDeferredPasteCompleted(Y)};ta.prototype.deserialize=function(Y){var Ra=nd(Y),zb=null,gc=null,bd=!1;if(!Ra){zb=Y.copyContextSnapshot;gc=zb.sourceItem;if(!gc)return Promise.reject(new Of.a(10));
bd=gc.isFromCurrentSession(this.$)}var Id=this.Rfg(Y,!0);if(0!==Id)return Promise.reject(new Of.a(Ra?18:bd?19:20,void 0,void 0,void 0,Id));if(Ra)return this.kpc(Y);if(!bd&&!ta.shi(gc))return Y=String.format("User attempted to paste art of type [{0}] between sessions.",gc.type),pc.ULS.sendTraceTag(537167889,0,50,Y),Promise.reject(new Of.a(11,void 0,void 0,Y));if(zb.isAsyncSerializeFailed)return Promise.reject(new Of.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
try{var Vd=Y.clipboardItems.getItem(rb.zO);var ve=JSON.parse(Vd)}catch(Pe){return pc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(Pe)),Promise.reject(new Of.a(12,void 0,Pe))}ve.floatingObjectId!==gc.activeFloatingObjectControlId?pc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
gc.activeFloatingObjectControlId,ve.floatingObjectId):pc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",gc.activeFloatingObjectControlId,ve.floatingObjectId);if(!ve||!ve.shadowWorkbookBase64)return Promise.reject(new Of.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!ve)));Y.isShadowWorkbookParsedSuccessfully=!0;Y.shadowWorkbookPayloadSize=
Jc(ve);Y.shadowWorkbookSizeExceedsLimit=Mb(ve);Y.payloadOrigin=bd?Ib.GVf:Ib.FFe;Y.payloadType=oe.hjg;if(Mb(ve))return Y=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Xd.a.Akc,ve.shadowWorkbookSizeExceedsLimit),pc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",Y),Promise.reject(new Of.a(1,void 0,void 0,Y));zb=Ra=null;df.g(this.$).ha.We&326?zb=df.g(this.$).ha.Pa.activeFloatingObjectControlId:
Ra=this.$.pa&&this.$.pa.activeCell?hf.v(this.$.pa.activeCell,this.$):hf.v(hf.K(Y.commandParameters.originalDestinations),this.$);bd=null;if(this.eob.M2f(gc))try{bd=this.eob.a7c()}catch(Pe){pc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(Pe))}return this.IYi.k5h(new cb(Y.commandParameters.ribbonCommandInfo,Ra,zb,Y.commandParameters.commandType,[Y.commandParameters.stopwatch],
ve,gc,Y,bd))};ta.prototype.kpc=function(Y){Y.wasLastCopyExternal=!0;if(Y.clipboardItems.getItem("image/png")){var Ra=Y.commandParameters.stopwatch.Ec;Y.payloadType=oe.vOg;var zb={};return Lc.b(this.$.ye(1403967063,Y.commandParameters.ribbonCommandInfo.method,Y.commandParameters.ribbonCommandInfo.df,(zb.dataUrl=Y.clipboardItems.getItem("image/png"),zb))).then(function(gc){Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Ec-Ra;return gc?Promise.resolve(null):Promise.reject(new Of.a(15))},function(){Y.serverRequestTimeInMs=
Y.commandParameters.stopwatch.Ec-Ra;return Promise.reject(new Of.a(15))})}pc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return Sa.prototype.kpc.call(this,Y)};ta.prototype.ioi=function(){var Y=df.g(this.$).ha;return Y.Pa.activeFloatingObjectControlId&&Y.Pa.mc&&Y.Pa.mc.floatingObject?Y.Pa.mc.floatingObject.hUd():!1};ta.prototype.Wdd=function(Y,Ra,zb){var gc=this;return new Promise(function(bd,Id){var Vd=Y.commandParameters.stopwatch.Ec;
pc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");gc.nZa.H3g(new Wa(Ra.activeFloatingObjectControlId,Y.commandParameters,function(ve){Y.requestTelemetryData=ve.RequestTelemetryData;Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Ec-Vd;if(kd.a.lh(ve.Errors))kd.a.dha(ve.Errors)?(Y.encounteredDeploymentErrors=!0,pc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
kd.a.Uc(ve.Errors))):(pc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",kd.a.Uc(ve.Errors)),Id(new kc(4,ve.Errors)));else if(pc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Ra.activeFloatingObjectControlId),Y.markForCancellation)Id(new kc(3,ve.Errors));else{kd.a.dr(ve.Errors)&&pc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
kd.a.Uc(ve.Errors));var Pe=ve.Result;if(Pe){Pe=gc.dFe(Pe);Pe.floatingObjectId=Ra.activeFloatingObjectControlId;Y.shadowWorkbookPayloadSize=Jc(Pe);Y.shadowWorkbookSizeExceedsLimit=Mb(Pe);try{var We=JSON.stringify(Pe)}catch(Vf){Id(new Of.a(14,void 0,Vf,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",Y.shadowWorkbookPayloadSize,Pe.floatingObjectId)));return}pc.ULS.shipAssertTag(537167881,0,!!zb,"Expecting syncClipboardItems to be defined");
zb.setItem(rb.zO,We);1===Y.commandParameters.commandType&&(gc.T0i(Ra.type,Ra.activeFloatingObjectControlId,ve.StateId),gc.deleteFloatingObject(Ra.activeFloatingObjectControlId,Ra.type));gc.V2c.setValue(Ra,zb);Y.asyncClipboardItemsKeys=Ne(zb);bd(zb)}else pc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Ra.activeFloatingObjectControlId),bd(gc.V2c.getValue(Ra))}},Y.commandParameters.commandType,Ra.type,function(ve){Y.serverRequestTimeInMs=
Y.commandParameters.stopwatch.Ec-Vd;ve=pe.a.og(ve.data);1===Y.commandParameters.commandType&&gc.nZa.MPj(Ra.type,Ra.activeFloatingObjectControlId);pc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",kd.a.Uc(ve));Id(new kc(4,ve))},[Y.commandParameters.stopwatch]))})};ta.prototype.deleteFloatingObject=function(Y,Ra){Y=Jf.a.Xy(Ra,Y);if(Y=$h.a(this.$).Tp(Y))$h.a(this.$).deleteFloatingObject(Y,14,!0),df.g(this.$).ha.Pa.oC=null};ta.prototype.T0i=
function(Y,Ra,zb){var gc=this.$.da.Aa(277);if(gc){var bd=null;Y=Jf.a.Xy(Y,Ra);Y=$h.a(this.$).Tp(Y);if(null===Y||void 0===Y?0:Y.Vi)bd=Y.Vi.block;if(bd){var Id=Y.floatingObject.Gg();gc.kYb(function(){return!bd.Xi.xb(Id)},zb,"CutArt")}}};ta.shi=function(Y){return 1===Y.type||5===Y.type};Object(Yc.a)(ta,"ArtCopyPasteHandler",Sa,[]);var kh=b(54);vm(ra,Xb);Object(Yc.a)(ra,"MacroRecorderPasteArtPayload",Xb,[]);Ba.prototype.w$h=function(Y,Ra,zb,gc,bd,Id,Vd){var ve=this;Id=void 0===Id?null:Id;Vd=void 0===
Vd?null:Vd;var Pe=this.$.na.ta.$b(),We=null,Vf={CopyPasteTargetType:2};Vf.FloatingObjectId=Y;Vf.CopyOperationId=zb.id;zb.floatingObjectType=Ra;Vf.UploadToClipService=zb.uploadToClipService;Vf.PKey=zb.pKey;Vf.ClipServiceDataCenter=zb.clipServiceDataCenter;var $f=0;2===bd?(bd=505,$f=16,We=function(Hg,Tg,Bi){return Zc(ve.$.na.ta,Vf,jg.b(Hg,gc),Id?jg.a(Tg,Id):Tg,Bi,zb.ribbonCommandInfo,Pe,Vd)}):(bd=179,We=function(Hg,Tg,Bi){ve.dhh(Ra,Y);ve.$.ny();var Cf=ve.$.na.ta;Hg=jg.b(Hg,gc);Tg=Id?jg.a(Tg,Id):Tg;
var Ih=zb.ribbonCommandInfo,Eh=Vd;Eh=void 0===Eh?null:Eh;var Gg=Cf.Na(1,void 0===Pe?null:Pe);Gg.copyParameters=Vf;return ge.i(Cf,"Cut",Gg,Hg,Tg,Bi,Ih,0,Eh)});Nc.EwaSettings.tc()?this.$.userOperationManager.ic(new cf.a(bd,0,We,$f|64),zb.ribbonCommandInfo):this.$.userOperationManager.ic(new Md.a(bd,0,We,$f),zb.ribbonCommandInfo)};Ba.prototype.dhh=function(Y,Ra){var zb=Jf.a.Xy(Y,Ra);(zb=$h.a(this.$).Tp(zb))?(df.g(this.$).ha.Pa.$G(zb),zb.isVisible=!1):pc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
Y,Ra)};Ba.prototype.MPj=function(Y,Ra){Y=Jf.a.Xy(Y,Ra);if(Y=$h.a(this.$).Tp(Y))Y.isVisible=!0};Ba.prototype.H3g=function(Y){this.w$h(Y.floatingObjectId,Y.F3g,Y.commandParameters,Y.Br,Y.abh,Y.j4,Y.$Yd)};Ba.prototype.W$h=function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){var We=this;ve=void 0===ve?null:ve;Pe=void 0===Pe?!0:Pe;return new Promise(function(Vf,$f){var Hg=Id.commandParameters.stopwatch.Ec;We.xNd(Y,bd,Ra,zb,function(Tg){Id.requestTelemetryData=Tg.RequestTelemetryData;Id.serverRequestTimeInMs=Id.commandParameters.stopwatch.Ec-
Hg;if(kd.a.dha(Tg.Errors))Id&&(Id.encounteredDeploymentErrors=!0),pc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",kd.a.Uc(Tg.Errors));else if(kd.a.lh(Tg.Errors))pc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",kd.a.Uc(Tg.Errors)),$f(new Of.a(9,Tg.Errors));else if(Tg.Result){var Bi=Tg.Result;pc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
We.g1i(Vd,Bi.FloatingObjectId,Tg.StateId);Vf(Ba.Vkd(Bi.FloatingObjectId))}else pc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),$f(new Of.a(9,Tg.Errors))},function(Tg){Id.serverRequestTimeInMs=Id.commandParameters.stopwatch.Ec-Hg;Tg=pe.a.og(Tg.data);pc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",kd.a.Uc(Tg));$f(new Of.a(9,Tg))},gc,ve,Pe)})};Ba.prototype.g1i=function(Y,Ra,zb){var gc=
this,bd=this.$.da.Aa(277);if(bd){var Id=Jf.a.Xy(Y,Ba.Vkd(Ra));bd.kYb(function(){return!!$h.a(gc.$).Tp(Id)},zb,"PasteArt")}};Ba.prototype.hXd=function(Y,Ra){Ra&&this.eob.hXd(Y,Jf.a.Xy(Y.type,Ra))};Ba.prototype.dHf=function(Y){var Ra=this;return this.W$h(Y.ribbonCommandInfo,Y.destination,Y.DHe,Y.$Yd,Y.E0,Y.pasteContext,Y.item.type,Y.yze,Y.item.isFromCurrentSession(this.$)).then(function(zb){return zb},function(zb){Ra.hXd(Y.item,Y.yze);return Promise.reject(zb)})};Ba.prototype.$Md=function(Y,Ra,zb){Y||
(Y=hf.v(df.g(this.$).ha.va.activeCell,this.$));df.g(this.$).phc(hf.D(Y),1)?$h.a(this.$).jna(zb,Ra,!0):df.g(this.$).ha.Pa.Csa(Y,Ra,zb).continueWith(function(gc){gc.result?pc.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Ra):pc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Ra)})};Ba.prototype.xNd=function(Y,Ra,zb,gc,bd,Id,Vd,ve,Pe){function We(){if(Pe){var Bi=
kh.a.oi(kh.a.Lc(Tg));Bi.FloatingObjectId=Ra.floatingObjectId;Tg.DestinationRanges||(Bi.DestinationRanges=hf.p($f.$.xa.pa.sheetName,"",0,0,0,0));return new ra(Bi,Pe,0,0)}return new ra(Tg,Pe,0,0)}function Vf(Bi,Cf,Ih){ve||$f.$.ny();return ld($f.$.na.ta,Tg,jg.b(Bi,bd),jg.a(Cf,Id),Ih,null,Hg,Vd)}var $f=this;Pe=void 0===Pe?!0:Pe;var Hg=this.$.na.ta.$b(),Tg={};Tg.ShadowWorkbookBase64=Ra.shadowWorkbookBase64;Tg.FloatingObjectId=gc;Tg.DestinationRanges=zb?hf.s(zb):null;Tg.CopyPasteTargetType=2;Tg.ClientEstimationFloatingObjectId=
ve;zb=Nc.EwaSettings.tc()?new cf.a(503,0,Vf,void 0,We):new Md.a(503,0,Vf,void 0,We);zb.flags=Nc.EwaSettings.tc()?65:1;this.$.userOperationManager.ic(zb,Y)};Ba.Vkd=function(Y){return String.format("{0}.{{{1}}}",Y.length+2,Y.toUpperCase())};Object(Yc.a)(Ba,"ArtCopyPasteUtils",null,[646]);var Tf=b(237);O.prototype.eEd=function(Y,Ra){this.$sa=Y;this.T2c=Ra};O.prototype.a7c=function(){if(!this.$sa||!this.T2c)return pc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var Y=Oe.a.aqb(new Jf.a(this.$sa));Y.Id=Ba.Vkd(Jd.a.create().toString());Y.Version=-1;Y.Name="";Y.IsClientEstimation=!0;var Ra=this.ibi(Y);if(!Ra)return null;var zb=new Jf.a(Y);Ra.block.Xi.add(zb);zb.IHb();var gc=$h.a(this.$);gc.L3b(zb,Ra);Ra=gc.Tp(Jf.a.HRh(Y));!Ra||Ra.floatingObject.hMa||Ra.floatingObject.EMa||Ra.tRa(this.T2c);gc.jna(Y.Type,Y.Id,!0);return Y.Id};O.prototype.M2f=function(Y){return Nc.EwaSettings.la(223)&&Y.isFromCurrentSession(this.$)&&!df.g(this.$).rtl&&!df.g(this.$).$a.$i};O.prototype.hXd=
function(Y,Ra){this.M2f(Y)&&(Y=$h.a(this.$).Tp(Ra))&&(pc.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Ra,Y.floatingObject.type),$h.a(this.$).deleteFloatingObject(Y,15,!0),Y.Vi&&Y.Kab(Y.Vi,!1))};O.prototype.ibi=function(Y){if(!Y)return pc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;
if(df.g(this.$).ha.Pa.activeFloatingObjectControlId){var Ra=df.g(this.$).ha.Pa.oC.floatingObject;Y.OriginDeltaX=Ra.offsetX+this.q$a;Y.OriginDeltaY=Ra.offsetY+this.q$a;Y.AbsoluteLeft+=this.q$a;Y.AbsoluteTop+=this.q$a;Y.AbsoluteRight+=this.q$a;Y.AbsoluteBottom+=this.q$a;Y.ZOrder=Ra.wy+1;return df.g(this.$).ha.Pa.oC.Vi}if(!this.$.pa||!this.$.pa.activeCell)return pc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var zb=this.$.pa.activeCell;Ra=df.g(this.$).h1(zb);if(!Ra)return pc.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",zb.toString()),null;var gc=De.HelperMethods.lKa(Ra.domElement,Ra.vj.domElement);zb=Ra.gridView.pg(zb,2);if(!gc||!zb)return pc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!gc,!zb),null;Y.OriginDeltaX=zb.topLeft.x-gc.x;Y.OriginDeltaY=zb.topLeft.y-gc.y;Y.AbsoluteLeft=zb.topLeft.x;Y.AbsoluteTop=zb.topLeft.y;Y.AbsoluteRight=Y.AbsoluteLeft+Math.abs(this.$sa.AbsoluteRight-this.$sa.AbsoluteLeft);Y.AbsoluteBottom=Y.AbsoluteTop+Math.abs(this.$sa.AbsoluteBottom-this.$sa.AbsoluteTop);Y.ZOrder=this.$sa.ZOrder+100;return new Tf.a(Ra.gridView.Ca.Uk(Ra.hashCode),Ra.hashCode)};Object(Yc.a)(O,"ArtPasteClientEstimation",null,[645]);Qb.prototype.create=function(){var Y=window.clipboardPlatform;
return Y?Y.createClipboardItems():null};Object(Yc.a)(Qb,"ClipboardItemsFactory",null,[644]);dc.undefined="Undefined";Object(Yc.a)(dc,"CCPTelemetryConsts",null,[]);Kb.cells="Cells";Kb.floatingObject="FloatingObject";Kb.unknown="Unknown";Object(Yc.a)(Kb,"ActiveSelection",null,[]);jc.hgh="DisplayNotInvoked";jc.S6c="Displayed";jc.s1i="PrerequisitesNotReady";Object(Yc.a)(jc,"PasteIndicationDisplayStatus",null,[]);var ki=b(106);Ub.prototype.getCopyFlowHandler=function(Y){var Ra=this.CNh(df.g(this.$).We);
Y.commandParameters.copyPasteHandlerName=Ra.name;return Ra};Ub.prototype.getPasteFlowHandler=function(Y){var Ra=Y.copyContextSnapshot;Ra=zc(Y)?this.$Wc:nd(Y)?this.hGd:(null===Ra||void 0===Ra?0:Ra.sourceItem)&&Object.getType(Ra.sourceItem)===ne?this.$Wc:this.hGd;Y.commandParameters.copyPasteHandlerName=Ra.name;return Ra};Ub.prototype.initializePasteContext=function(Y){if(Y&&(Y.isSameSession=!1,Y.isShadowWorkbookParsedSuccessfully=!1,Y.pasteResult=dc.undefined,Y.payloadOrigin=dc.undefined,Y.payloadType=
dc.undefined,Y.encounteredDeploymentErrors=!1,Y.shadowWorkbookSizeExceedsLimit=!1,Y.originalSourceRangesCountExceedsLimit=!1,Y.activeSelectionType=this.yJh(),Y.indicationDisplayScheduled=!1,Y.pasteDestinationHasMergedCells=!1,Y.pasteIndicationDisplayStatus=jc.hgh,Y.copyContextSnapshot)){var Ra=Y.copyContextSnapshot,zb=qc(Ra.sourceItem),gc=Ra.sourceItem;var bd=!!gc&&Object.getType(gc)===ne;gc=0;var Id=!1;zb?(Id=Ra.sourceItem,Y.isSameSession=Id.isFromCurrentSession(this.$),gc=1,Id=this.wli(Id,Y)):bd&&
(Y.isSameSession=Ra.sourceItem.isFromCurrentSession(this.$),gc=2);if(Y.copyContextSnapshot.commandParameters){bd=-1985798686===Ra.commandParameters.ribbonCommandInfo.command;var Vd=Y.commandParameters;var ve=this.$;Ra?ve&&ve.ya?Ra=Ra.sessionId===ve.ya.UserSessionId:(pc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Ra=!1):(pc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Ra=!1);Vd.clearSystemClipboard=Ra&&bd&&zb&&!Id;Y.commandParameters.copyPasteTargetType=gc}}};
Ub.prototype.getSessionId=function(){return this.$.ya.UserSessionId};Ub.prototype.wli=function(Y,Ra){var zb=ki.b(Y.ranges,function(gc){return gc.Rh})&&ki.b(Ra.commandParameters.originalDestinations,function(gc){return 1!==gc.top});return ki.b(Y.ranges,function(gc){return gc.isRow})&&ki.b(Ra.commandParameters.originalDestinations,function(gc){return 1!==gc.left})||zb};Ub.prototype.CNh=function(Y){switch(Y){case 1:return this.hGd;case 64:case 4:case 2:case 256:return this.$Wc;default:throw Error.invalidOperation("Unsupported selection");
}};Ub.prototype.yJh=function(){return df.g(this.$).ha.We&470?Kb.floatingObject:1===df.g(this.$).ha.We?Kb.cells:Kb.unknown};Qk.Object.defineProperties(Ub.prototype,{hGd:{configurable:!0,enumerable:!0,get:function(){if(!this.$Oc){var Y=this.$.da.Aa(254,!0);Y&&(this.$Oc=new mb(this.$,Y,new Qb))}return this.$Oc}},$Wc:{configurable:!0,enumerable:!0,get:function(){if(!this.REc&&this.$.da.Aa(254,!0)){var Y=new O(this.$);this.REc=new ta(this.$,new Qb,new Ba(this.$,Y),Y)}return this.REc}}});Object(Yc.a)(Ub,
"ExcelCopyPasteApplicationHost",null,[573]);var Mh=b(139),Nh=Le.a;vm(qb,Nh);qb.prototype.Bh=function(Y){this.Vo=new Mh.a;var Ra=le.a.instance.fa(16);Y=this.pV(Y);this.initializeAndShow(Ra,this.cdi,Y)};qb.prototype.pV=function(Y){var Ra={};return Ra[qb.Zy]=this.Bc,Ra[qb.Umi]=Y,Ra};Qk.Object.defineProperties(qb.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});qb.qfh="direction";qb.Umi="isRtl";var ph={};qb.rfh=(ph.Vertical=1,ph.Horizontal=0,ph);Object(Yc.a)(qb,
"InsertCopiedCutCellsDialog",Le.a,[]);Oa.prototype.N3b=function(Y,Ra){return(new qb(Y,Ra)).Vo.task};Object(Yc.a)(Oa,"InsertCopiedCutCellsDialogFactory",null,[572]);var gh=b(88),eh=b(44),Uh=b(42);lc.prototype.LJe=function(){var Y=this;this.aqc||(pc.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.YE(function(Ra){Ra.Vua(0).then(function(){Y.aqc=!0})}))};lc.prototype.Ulj=function(Y){var Ra=this,zb=Y.commandParameters.id;
pc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",zb,!this.Ns,this.aqc);this.LJe();this.S4b=zb;zb=!this.ssf();if(!this.Ns||zb)this.Jwe(),this.Ns=eh.a.instance.create(function(){Ra.ggh(Y)},void 0===Y.timeoutToShowSpinnerInMs||null===Y.timeoutToShowSpinnerInMs?100:Y.timeoutToShowSpinnerInMs,Uh.a.MYi);this.p2=Y.commandParameters.originalDestinations};lc.prototype.ggh=function(Y){this.aqc?(this.display(Y.commandParameters.originalDestinations),
Y.pasteIndicationDisplayStatus=jc.S6c):(pc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),Y.pasteIndicationDisplayStatus=jc.s1i)};lc.prototype.display=function(Y){pc.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Ob.qy(If.a.W0(Ef.d(this.gridView.$.pa),Y),lc.lpc,!0);this.gridView.Ob.xs(lc.lpc)};lc.prototype.Ljd=function(Y){pc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",
Y,this.S4b);Y&&Ge.a.equals(Y,this.S4b,!1)&&this.hide()};lc.prototype.hide=function(Y){this.p2&&(void 0===Y?0:Y)&&this.ssf()&&pc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.S4b="";this.Jwe();this.p2=null;this.gridView.Ob.kl(lc.lpc);this.gridView.Ob.Ml(null,lc.lpc)};lc.prototype.ssf=function(){return hf.Q(this.gridView.ha.va.selectedRanges,this.p2)};lc.prototype.Jwe=
function(){this.Ns&&(gh.a.Fa(this.Ns),this.Ns=null)};lc.prototype.dispose=function(){this.hide();this.gridView.ha.UF(this.a9e)};lc.lpc=[30];Object(Yc.a)(lc,"PasteIndicationManager",null,[574,2]);var xh=b(1127),Wg=b(53),Og=xd.a;vm(Wb,Og);Wb.prototype.create=function(){var Y=this,Ra=Wg.a.p_([51,52],4,this.ub,void 0,void 0,void 0,Wb.iRa),zb=Lh.GetServiceTaskFactory.create(this.$.da,18,this.$.ma,this.ub);Da.TaskExtensions.Ba(Da.TaskExtensions.we([zb,Ra],this.ma),function(){var gc=new xh.a,bd=null;Y.m1g(gc).then(function(Id){bd=
Id.Cze;var Vd=copyPasteInfra.createCopyPasteInfra(bd,new Ub(Y.$),gc,Y.$);pc.ULS.shipAssertTag(537167762,0,!!Y.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");pc.ULS.shipAssertTag(537167761,0,!!Y.$.ya&&!!Y.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var ve=bd.getMetadataManager();Y.Gb(new Ad(Y.$,ve,zb.result,Vd,new sa(Y.$,df.g(Y.$)),new Oa,Y.$.ya.DocumentHostInfo.UserId,
bd.getInitializationError()));Id.M_a?pc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",Ad.R$b(),Id.M_a.dataClipboardStrategyType,JSON.stringify(Id.M_a.dataClipboardCapabilities),Id.M_a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Id.M_a.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):pc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Id){pc.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",Ad.R$b(),Id?copyPasteInfra.getStringifiedError(Id):
"null")})},this.ma,3)};Wb.prototype.dispose=function(){Og.prototype.dispose.call(this)};Wb.prototype.m1g=function(Y){var Ra=null,zb=window.clipboardPlatform;zb&&(Ra=zb.getClipboardPlatformEnvironment());if(!Ra)return pc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);zb=this.$.ya;var gc=[zb.OfficeOnlineChromeExtensionId,zb.ChromeClipboardAccessExtensionId],
bd=this.Km.Va(5),Id=this.$.jg.get(57),Vd=!Id&&this.$.jg.get(5),ve=this.$.ea.oc;ve&&(ve.inWebPart||ve.inViewerFromWebPart||ve.isDivSyndicated)&&(Vd=!1);Id=this.yMh(Vd,!Id);pc.ULS.shipAssertTag(537167758,0,!!zb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Ra.init(this.$,Y,gc,zb.SharedClipboardHostingApp,zb.SharedClipboardHostingApps,zb.SharedClipboardHostingEnvironments,zb.SharedClipboardOverrideOrigin,
zb.SharedClipboardSchemaVersion,zb.SharedClipboardExpirationInMinutes,zb.ClipboardPromiseTimeoutInMinutes,bd,zb.MachineCluster,new Nb(this.$),Id,zb.DocumentHostInfo.UserId,zb.ClipboardTtlInMS,Nc.EwaSettings.la(315),zb.UserSessionId).then(function(Pe){return Object.assign(new wd,{Cze:Ra,M_a:Pe})},function(Pe){return Promise.reject(Pe)})};Wb.prototype.yMh=function(Y,Ra){var zb=[];Y&&Ra&&Array.add(zb,this.B$g());Ra&&(Array.add(zb,this.B4c(7)),Array.add(zb,this.B4c(0)));Y&&Array.add(zb,this.mEe());Array.add(zb,
{clipboardStrategyType:4});pc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",Y,Ra,zb?zb.join(","):"[]");return zb};Wb.prototype.mEe=function(){var Y=this.$.ya,Ra={clipboardStrategyType:5};Ra.sessionId=Y.UserSessionId;Ra.useSharedClipboardIframe=!0;Ra.sharedClipboardHostingApp=Y.SharedClipboardHostingApp;Ra.sharedClipboardHostingApps=
Y.SharedClipboardHostingApps;Ra.sharedClipboardHostingEnvironments=Y.SharedClipboardHostingEnvironments;Ra.sharedClipboardOverrideOrigin=Y.SharedClipboardOverrideOrigin;Ra.sharedClipboardSchemaVersion=Y.SharedClipboardSchemaVersion;Ra.sharedClipboardExpirationInMinutes=Y.SharedClipboardExpirationInMinutes;Ra.wacCluster=Y.MachineCluster;return Ra};Wb.prototype.B$g=function(){var Y={clipboardStrategyType:6};Y.localStorageStrategyParameters=this.mEe();Y.systemClipboardStrategyParameters=this.B4c(0);
return Y};Wb.prototype.B4c=function(Y){var Ra={};Ra.clipboardStrategyType=Y;Ra.skipFilesIfPlainTextExists=!0;return Ra};Wb.ka=function(Y){Y.da.Ha(373,new lc(Y));Y.da.Ha(Wb.iRa,new Wb(Y))};Wb.iRa=255;Object(Yc.a)(Wb,"CopyPasteInfrastructureFactory",xd.a,[]);var di=b(10),Ph=b(117),Fg=b(12),ei=cd.a;vm($b,ei);$b.prototype.dispose=function(){this.tn();this.nk=this.pr=this.$=null;this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null)};$b.prototype.jn=function(){return this.k3f};
$b.prototype.Zr=function(Y,Ra){if("QueryPasteShortcutEnabledLabel"!==Y&&!Array.contains($b.UGj,Y))return!1;var zb=this.ro();"QueryPasteShortcutEnabledLabel"===Y?(Ra.Visible=zb,pc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",zb,Y)):(Ra.Visible=!zb,pc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!zb,Y));return!0};$b.prototype.Xkh=function(){this.al();this.raiseEvent("pasteShortcutStatusChanged")};
$b.prototype.b6b=function(){this.tn();this.raiseEvent("pasteShortcutStatusChanged")};$b.prototype.ro=function(){return this.H8c};$b.prototype.sq=function(Y){this.addHandler("pasteShortcutStatusChanged",Y)};$b.prototype.Lq=function(Y){this.removeHandler("pasteShortcutStatusChanged",Y)};$b.prototype.al=function(){if(!this.ro()){this.H8c=!0;df.g(this.$).xj.Xl(this.sIe);this.nk.ka("blur",this.Afh);var Y=this.$.da.Aa(65);Y&&Y.l3&&Y.l3.registerForCommentEvents(this.rIe);this.pr.nt(Fg.a.Tb,this.Zhf?this.$.Vv:
this.$.domElement,this.onKeyDown,!0)}};$b.prototype.tn=function(){if(this.ro()){this.H8c=!1;df.g(this.$).xj.nl(this.sIe);this.nk.detach("blur");var Y=this.$.da.Aa(65);Y&&Y.l3&&Y.l3.unregisterForCommentEvents(this.rIe);this.pr.tt(Fg.a.Tb,this.Zhf?this.$.Vv:this.$.domElement,this.onKeyDown,!0)}};$b.UGj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(Yc.a)($b,"PasteShortcutManager",cd.a,[563,245,210,2]);var Dh=b(122),Sg=xd.a;vm(rd,Sg);rd.prototype.create=function(){var Y=this.$;this.Gb(Y.da.Aa(478)||
this.$.da.Ha(478,new $b(Y,Ph.KeyInputManager.instance,Dh.a.instance.pE())))};rd.ka=function(Y){Y.da.Ha(479,new rd(Y))};Object(Yc.a)(rd,"PasteShortcutManagerFactory",xd.a,[]);sc.prototype.isEnabled=function(){if(Tc.AFrameworkApplication.ga?Tc.AFrameworkApplication.ga.ra("IsAnonymousUser"):1)return!1;var Y=Tc.AFrameworkApplication.Zb?Object(ob.a)(String,Tc.AFrameworkApplication.Zb.AudienceGroup):"";return"Unknown"!==Y&&"Automation"!==Y};Qk.Object.defineProperties(sc.prototype,{oWc:{configurable:!0,
enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},Chi:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(347)}},g7a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(349)}},Gzb:{configurable:!0,enumerable:!0,
get:function(){return this.$.la(348)}},YDh:{configurable:!0,enumerable:!0,get:function(){return null}},Tqf:{configurable:!0,enumerable:!0,get:function(){return 24}},PUf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},ZHb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(Yc.a)(sc,"FirstRunExperienceLauncherSettings",null,[654]);nb.prototype.BRd=function(){this.FUe&&this.FUe.BRd(this.KDh)};Object(Yc.a)(nb,"FirstRunExperienceManager",null,[562]);
var wg=xd.a;vm($a,wg);$a.prototype.create=function(){this.Gb(this.$.da.Aa(311)||this.E6g())};$a.prototype.E6g=function(){var Y=new sc(this.$);Y=new nb(ie.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Y);Y.BRd();return Y};$a.ka=function(Y){Y.da.Ha(312,new $a(Y))};Object(Yc.a)($a,"FirstRunExperienceManagerFactory",xd.a,[]);var yh=b(57),bh=xd.a;vm(fc,bh);fc.prototype.create=function(){this.Gb(this.$.da.Aa(361)||this.o7g())};fc.prototype.o7g=function(){var Y=
this;this.dld=ie.a.instance.Nh("Common.IInProductMessagingUIManager");yh.a.Rf.isReactSharedHeaderUxEnabled?Vc.a.get_instance().jl(16,function(){Y.dbf()}):this.dbf();return this.dld};fc.prototype.dbf=function(){var Y=this;ie.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Ra.isFeatureEnabled("MsoPremiumBadge",!0).then(function(zb){!zb&&Ra.isFreemiumUpsellEnabled()&&Y.dld.Ilf();return null})})};fc.ka=function(Y){Y.da.Ha(362,new fc(Y))};Object(Yc.a)(fc,
"InProductMessagingManagerFactory",xd.a,[]);var Cg=b(817),uh=b(98),fg=b(175),Qh=b(108);ub.prototype.nEb=function(Y){this.Gj=Y;if(!this.l1a){if(this.QYd){if(this.G8a&&Qc.a.qF){this.ORb=Y.z6b(Object(Xe.a)(this,this.aAd,"onFileChosen"));return}this.ORb=Y.z6b(null);if(!this.IBa(this.ORb,Y))return}this.finalizeUpload(Y,null)}};ub.prototype.aAd=function(Y){if(this.IBa(Y,this.Gj)){if(Qc.a.qF||Qc.a.Df)this.ORb=Y;this.finalizeUpload(this.Gj,null)}};ub.prototype.soc=function(){this.QBd&&this.QBd()};ub.prototype.Ehj=
function(){this.$qa=0;this.EEa=this.ga.Bd("Box4UploadRetryDelayStart",200);this.Gj&&(this.Gj.dispose(),this.Gj=null)};Qk.Object.defineProperties(ub.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.YS}},ga:{configurable:!0,enumerable:!0,get:function(){return this.wb}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.$qa}},xLd:{configurable:!0,enumerable:!0,get:function(){return this.EEa}}});Object(Yc.a)(ub,"FileUploader",null,[]);var ii=b(416),kg=b(909),
mi=b(128);vm(Za,ub);Za.prototype.QZe=function(Y){switch(Y){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};Za.prototype.Pfg=function(Y){return Za.IBa(Y,this.$0h())};Za.prototype.$0h=function(){return Za.yje};Za.prototype.IBa=function(Y,Ra){Y=this.Pfg(Y);return 0!==Y?(Ra&&Ra.Kle(),2===Y&&this.ui(0,this.QZe(Y)),!1):!0};Za.prototype.finalizeUpload=function(Y,Ra){pc.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");
this.QBd=Ra;this.UBj();ii.a.mark(5576);this.wUb=this.IO.Ic("LoadResource","PictureUploadTime")};Za.prototype.ui=function(Y,Ra){var zb=new mi.StandardDialog;zb.kc=0;zb.Iz(Y,CommonUIStrings.l_ImageUploadFailedTitle,Ra,null)};Za.prototype.soc=function(){pc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");ub.prototype.soc.call(this);this.wUb&&(this.wUb.stop(),this.wUb=null);this.FZg()};Za.prototype.UBj=function(){this.vra=(new kg.a).create();this.vra.message=CommonUIStrings.l_ImageUploadWait;
this.vra.kc=5;this.vra.Ru=!1;this.vra.HAa(null,null,null)};Za.prototype.FZg=function(){this.vra&&(this.vra.close(),this.vra=null)};Za.T6h=function(Y,Ra){Y=Xf.a.Nl(Y);for(var zb=0;zb<Ra.length;++zb)if(Y.endsWith(Ra[zb]))return!0;return!1};Za.IBa=function(Y,Ra){Ra=void 0===Ra?null:Ra;Ra||(Ra=Za.yje);return Y?Za.T6h(Y,Ra)?0:2:1};Qk.Object.defineProperties(Za.prototype,{IO:{configurable:!0,enumerable:!0,get:function(){return Tc.AFrameworkApplication.sa.vD}}});Za.yje=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(Yc.a)(Za,"PictureUploader",ub,[]);var Yh=b(579),og=b(303),Ca=b(140),ua=b(89),tb=b(170),Nd=b(172),me=b(82),sf=b(1247),sg=b(78),Ff=sf.a;vm(Gb,Ff);Gb.prototype.wrc=function(Y,Ra){this.isEnabled()&&this.qFa(this.targetOrigin)&&(this.Xn(Y),this.Jl(Y,Ra))};Object(Yc.a)(Gb,"InsertMediaCrossDocumentMessenger",sf.a,[661,203,2]);Object(Yc.a)(vb,"OnlineMediaSearchResult",null,[]);var xg=b(306),yg=Ca.a;vm(kb,yg);kb.prototype.HBj=function(Y){var Ra=this;this.sgc=!1;this.showDialog(this.fo,null);this.nwa=
document.getElementById(this.pi("InsertMediaFrame"));if(!this.nwa)throw this.rua(this.Rob),Error.invalidOperation("Couldn't get InsertMediaIframe.");var zb=document.getElementById(this.pi("WACDialogPanel"));zb&&zb.setAttribute(ua.a.Ud,ua.a.jZa);zb=document.createElement("div");zb.id="KeepFocusStartDiv";zb.tabIndex=0;zb.className="keep-focus-start";this.nwa.parentNode.insertBefore(zb,this.nwa.parentNode.firstChild);zb=document.createElement("div");zb.id="KeepFocusDiv";zb.tabIndex=0;zb.className="keep-focus";
this.nwa.parentNode.appendChild(zb);$addHandler(this.gIa,"keydown",this.asd);this.nwa.src=this.mbf;this.nwa.frameBorder="0";zb=document.getElementById(this.pi("WACDialogButtonPanel"));if(!zb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");zb.className="display-none";zb=document.getElementById(this.pi("WACDialogTitleText"));if(!zb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");zb.className="display-none";2===this.tqf&&(document.getElementById(this.pi("WACDialogTitlePanel")).className=
"display-none",document.getElementById(this.pi("WACDialogBodyPanel")).className="padding-zero");uc.FocusManager.instance().RQ().scope.tR=!0;this.$R=new Gb(this.nwa.contentWindow,this.mbf);this.$R.wrc(tb.a.FBg,function(gc){Ra.ZGi(gc,Object(Xe.a)(Y,Y.Foa,"uploadResponseReceived"))});this.$R.wrc(tb.a.insert,function(){Ra.qOi(Object(Xe.a)(Y,Y.Foa,"uploadResponseReceived"))});this.$R.wrc(tb.a.PZc,this.fIi);2===this.tqf&&0===this.Ueh&&(this.$R.wrc(tb.a.Zri,this.bPi),this.mNa=this.Lnb.Aza("MsoPremiumStockImages",
function(gc){pc.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(gc.isEnabled){var bd={};Ra.$R.Rj(tb.a.jVj,(bd.LicenseTier=gc.toString(),bd))}else pc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};kb.prototype.dispose=function(){this.fAa=null;this.Lnb&&this.mNa&&this.Lnb.pId("MsoPremiumStockImages",this.mNa);this.$R&&(this.$R.dispose(),this.$R=null);yg.prototype.dispose.call(this)};kb.prototype.hide=
function(){yg.prototype.hide.call(this);me.a.Nvc(this.$)};kb.prototype.ZGi=function(Y,Ra){Y=Y&&Y.Values?(Y=Y.Values)?Object.assign(new vb,{Action:Y.action||"",Caption:Y.caption||"",ContentType:Y.contentType||"",FileExtension:Y.extension||"",PageUrl:Y.pageUrl||"",SourceUrl:Y.sourceUrl||"",ThumbnailUrl:Y.thumbnailUrl||"",LicenseUrl:Y.licenseUrl||"",LicenseDisplayName:Y.licenseDisplayName||"",Height:Y.height||0,Width:Y.width||0}):null:null;Y&&(Array.add(this.fAa,Y),this.sgc&&(pc.ULS.sendTraceTag(537155809,
0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Ra(this.fAa),this.sgc=!1,this.rua(this.Rob)))};kb.prototype.qOi=function(Y){this.fAa&&0<this.fAa.length?this.fAa.length<=this.Ope?(Y(this.fAa),this.rua(this.Rob)):(this.Iz(),pc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.fAa)):this.sgc=!0};kb.prototype.r7g=function(){var Y=document.createElement("div");Y.id="InsertMediaDialog";Y.className=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",
!0)?"insert-media-dialog":"insert-media-dialog-old";var Ra=document.createElement("div");Ra.id="InsertMediaPanel";Ra.className=Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var zb=document.createElement("iframe");zb.id="InsertMediaFrame";zb.className="insert-media-frame";Y.appendChild(Ra);Ra.appendChild(zb);return xg.b(Y)};kb.prototype.Iz=function(){var Y=kd.a.jd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");
Y.Description=String.format(le.a.instance.Cb(196),this.Ope.toLocaleString());Nc.EwaSettings.nz()?new Oc.a(this.$,Y):(new Fb.ErrorDialog(this.$,Y)).mf()};Qk.Object.defineProperties(kb.prototype,{q4:{configurable:!0,enumerable:!0,get:function(){return Nd.a.T5b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Yc.a)(kb,"InsertMediaDialog",Ca.a,[]);var hh=b(462),nh=b(377);vm(wb,Za);wb.prototype.Foa=function(Y){var Ra=this;if(Y){for(var zb=Array(Y.length),
gc=0;gc<Y.length;gc++){var bd=Y[gc];zb[gc]={};zb[gc].SourceUrl=bd.SourceUrl;Xf.a.Lwa(bd.LicenseUrl)&&Xf.a.Lwa(bd.PageUrl)&&(zb[gc].LicenseUrl=bd.LicenseUrl,zb[gc].LicenseDisplayName=bd.LicenseDisplayName,zb[gc].PageUrl=bd.PageUrl);zb[gc].AltText=-2053056795===this.de.command?bd.Caption:""}var Id=-2009825598===this.de.command?"bing":"M365";gc=df.g(this.$);var Vd=hf.o(gc.ha.va.activeCell,this.$);ud.a(this.$.userOperationManager,function(ve,Pe,We){return ge.M(Ra.$.na.ta,Vd,zb,Id,jg.b(ve,Ra.SQi),jg.a(Pe,
Ra.RQi),We,null)},function(ve){return new cf.a(595,0,ve)},this.de);De.HelperMethods.$Z?(gc=new Map,gc.set("MediaProvider",Id),gc.set("ImagesCount",Y.length.toString()),gc.set("TimeTakenToOpenDialog",this.Snf.toString()),Cc.Health.instance.recordKpiUsage(nh.a.kdi,1,hh.a.k9f,gc)):pc.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.soc()}else pc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
wb.prototype.dispose=function(){this.$=null};wb.prototype.showDialog=function(){var Y=this,Ra=null;Ra=this.$.Wb.Ic("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.de.command){case -2009825598:this.TAj();break;case -2053056795:this.tqe.execute(function(zb){zb.isFeatureEnabled("MsoPremiumStockImages",!1).catch(function(gc){return pc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",gc)}).then(function(gc){Y.UAj(gc);
return null})})}Ra.stop();this.Snf=Ra.Ec};wb.prototype.TAj=function(){var Y=this.$.ya.BingPictureEndpoint,Ra=Yh.a.$J(Tc.AFrameworkApplication.lcid),zb=Jd.a.create();Y?(Y=0<Y.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(Y,1,1):String.format(Y,1,Tc.AFrameworkApplication.lcid,Ra?Ra.name:"en-us",Tc.AFrameworkApplication.buildVersion,zb.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.N3b(Y,1,-1,le.a.instance.fa(1714))):(pc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),
this.Q0.setException(Error.create("Failed to access the Bing service endpoint")))};wb.prototype.UAj=function(Y){var Ra=this.$.ya.M365PictureEndpoint,zb=Jd.a.create();if(Ra){var gc=this.$.ya.DocumentHostInfo.UserId;gc=gc?Xf.a.Qv(gc).toString():"0";var bd=this.tqe.instance.isFreemiumUpsellEnabled();Y=Y?1:bd?0:-1;zb=zb.toString();bd=Yh.a.$J(Tc.AFrameworkApplication.lcid).name;Ra=String.format(Ra,Tc.AFrameworkApplication.lcid,bd,Tc.AFrameworkApplication.buildVersion,zb,1,gc,Y,1);this.N3b(Ra,2,Y,le.a.instance.fa(1713))}else pc.ULS.sendTraceTag(537155803,
0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.Q0.setException(Error.create("Failed to access the M365 service endpoint"))};wb.prototype.N3b=function(Y,Ra,zb,gc){try{(new kb(this.$,Y,ie.a.instance.Nh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ra,zb,gc)).HBj(this),this.Q0.setResult(!0)}catch(bd){pc.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",
bd,Ra,zb),this.Q0.setException(bd)}};Object(Yc.a)(wb,"OnlinePictureUploaderWrapper",Za,[2]);Ec.prototype.executeCommand=function(Y,Ra,zb){Y=Ra.command;switch(Y){case 1403967063:if(zb&&"dataUrl"in zb)return Ra=new Mh.a,this.uploaderCreator&&this.uploaderCreator.Uai(this.$,uh.a.instance,Tc.AFrameworkApplication.ga,zb,zb.dataUrl,Ra),Ra.task;this.uploaderCreator&&this.uploaderCreator.Wbi(this.$,Ra,uh.a.instance,Tc.AFrameworkApplication.ga,zb);return bg.Task.Ta(!0);case -2053056795:case -2009825598:return Y=
new Mh.a,new wb(this.$,Ra,uh.a.instance,Tc.AFrameworkApplication.ga,zb,Y),Y.task;default:return fg.a(Y)}};Ec.prototype.Kc=function(Y,Ra){if(Y=this.$.isEditMode)switch(Ra.command){case 1403967063:Y=!0;break;case -2053056795:Y=!0;break;case -2009825598:Y=Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;default:Y=!1}return Y};Ec.prototype.gd=function(){return!1};Ec.prototype.Zc=function(){return!1};Object(Yc.a)(Ec,"PictureCommandHandler",null,[239]);var Ng=Cg.a;vm(Ob,
Ng);Ob.prototype.Pd=function(){var Y=this;Da.TaskExtensions.Ba(Lh.GetServiceTaskFactory.Wa(this.$.da,484,485,1),function(Ra){Y.Gd([new Ec(Y.$,Ra.result)])},this.$.ma,3)};Ob.ka=function(Y){Cg.a.he(90,new Ob(Y))};Object(Yc.a)(Ob,"PictureCommandHandlerFactory",Cg.a,[]);var ue=b(516),Bg=b(411),ng=b(74),mh=b(556),gg=b(595),ai=mh.a;vm(db,ai);db.prototype.tPd=function(Y){this.Kfa!==Y&&(this.Kfa=Y,this.VFb())};db.prototype.dispose=function(){this.gridView.zc.nl(this.Evf);this.gridView.zc.Mn(this.Dvf);this.gridView=
null;ai.prototype.dispose.call(this)};db.prototype.VFb=function(){this.cGd(this.Kfa)};db.prototype.refresh=function(){this.tPd(!this.gridView.isEditing)};Qk.Object.defineProperties(db.prototype,{GK:{configurable:!0,enumerable:!0,get:function(){return this.Rkc(this.Kfa)}},name:{configurable:!0,enumerable:!0,get:function(){return gg.a.cellEdit}}});Object(Yc.a)(db,"CellEditSafeStatePublisher",mh.a,[]);Object(Yc.a)(Ga,"SafeStatePublisherState",null,[]);var ih=b(656),rf=cd.a;vm(ya,rf);ya.prototype.ZYb=
function(Y){this.addHandler(ya.RQa,Y)};ya.prototype.Gsc=function(Y){this.removeHandler(ya.RQa,Y)};ya.prototype.Cza=function(Y,Ra){function zb(Id,Vd){bd.GK=Vd.GK;gc.fGd()}var gc=this,bd=new Ga(Y,Ra);this.SQa.add(bd);Y.ZYb(zb);bd.handler=zb;this.fGd()};ya.prototype.uXd=function(Y){for(var Ra=null,zb=yl(this.SQa),gc=zb.next();!gc.done;gc=zb.next())if(gc=gc.value,gc.publisher===Y){this.Ccg(gc);Ra=gc;break}Ra&&(this.SQa.remove(Ra),this.fGd())};ya.prototype.dispose=function(){for(var Y=yl(this.SQa),Ra=
Y.next();!Ra.done;Ra=Y.next())this.Ccg(Ra.value);this.SQa.clear();rf.prototype.dispose.call(this)};ya.prototype.J$b=function(){return ea.J$b(this.SQa.toArray().map(function(Y){return Y.GK}))};ya.prototype.Ccg=function(Y){Y.publisher.Gsc(Y.handler)};ya.prototype.fGd=function(){var Y=this.J$b();Y!==this.ykf&&(this.raiseEvent(ya.RQa,new ih.a(Y)),this.ykf=Y)};Qk.Object.defineProperties(ya.prototype,{OQj:{configurable:!0,enumerable:!0,get:function(){return ki.f(ki.c(this.SQa.toArray(),function(Y){return 0!=
Y.GK}),function(Y){return Y.publisher.name})}}});ya.RQa="SSC";Object(Yc.a)(ya,"ClientStateMonitor",cd.a,[]);var Rf=b(6),ch=b(65),vg=mh.a;vm(xa,vg);xa.prototype.tPd=function(Y){Y!==this.Kfa&&(this.Kfa=Y,this.VFb())};xa.prototype.dispose=function(){ch.a(this.$).rsc(this.Iwf);this.j5a.Lq(this.ON);this.Z7d=null;vg.prototype.dispose.call(this)};xa.prototype.VFb=function(){this.cGd(this.Kfa)};xa.prototype.refresh=function(){this.tPd(1===this.j5a.Nt||ch.a(this.$).xi===this.j5a)};Qk.Object.defineProperties(xa.prototype,
{GK:{configurable:!0,enumerable:!0,get:function(){return this.Rkc(this.Kfa)}},name:{configurable:!0,enumerable:!0,get:function(){return gg.a.j5a}},j5a:{configurable:!0,enumerable:!0,get:function(){return this.Z7d}}});Object(Yc.a)(xa,"IdleActivitySafeStatePublisher",mh.a,[]);var oh=b(308),h=b(3),Bb=ng.a;vm(fb,Bb);fb.prototype.Zc=function(){return!1};fb.prototype.executeCommand=function(){return bg.Task.Ta(!0)};fb.prototype.Kc=function(Y,Ra){return 1905775613===Ra.command};fb.prototype.gd=function(){return!1};
Object(Yc.a)(fb,"ToggleMergeSuspensionSafeState",ng.a,[239]);var tc=cd.a;vm(Db,tc);Db.prototype.sq=function(Y){this.addHandler(Db.nwd,Y)};Db.prototype.Lq=function(Y){this.removeHandler(Db.nwd,Y)};Db.prototype.uz=function(){this.raiseEvent(Db.nwd)};Db.prototype.jn=function(Y){return Y===Db.M3i&&!!this.mergeSuspensionManager};Db.prototype.Zr=function(Y,Ra){if(!this.jn(Y))return!1;this.mergeSuspensionManager&&(Ra.LabelText=this.Blc,Ra.On=this.Ixd);return!0};Db.prototype.dispose=function(){this.AMb&&
(this.Ka.Mab(this.AMb),this.AMb.dispose(),this.AMb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.t$a.hHb(this.BDb),this.mergeSuspensionManager.Oha.Gsc(this.JOa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.Blc=null;tc.prototype.dispose.call(this)};Db.nwd="MSMSC";Db.M3i="QueryMergeSuspensionStatus";Object(Yc.a)(Db,"MergeSuspensionIndicatorManager",cd.a,[245,210,2]);var X=b(1022),va=Sys.EventArgs;vm(Ja,va);
Object(Yc.a)(Ja,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);var P=b(1023),k=cd.a;vm(ma,k);ma.prototype.L$h=function(){return Object(Bg.a)(ya,this.Oha)?Object(ob.a)(ya,this.Oha).J$b():1};ma.prototype.bZb=function(Y){this.addHandler(ma.OVd,Y)};ma.prototype.Hsc=function(Y){this.removeHandler(ma.OVd,Y)};ma.prototype.LGg=function(Y){this.addHandler(ma.MGd,Y)};ma.prototype.Mdj=function(Y){this.removeHandler(ma.MGd,Y)};ma.prototype.TFg=function(Y){this.addHandler(ma.iwd,Y)};ma.prototype.fdj=
function(Y){this.removeHandler(ma.iwd,Y)};ma.prototype.r5i=function(){this.aGd(1===this.getState())};ma.prototype.dispose=function(){this.Oha.Gsc(this.JOa);this.Oha=null;this.t$a.hHb(this.BDb);this.t$a=null;k.prototype.dispose.call(this)};ma.prototype.Dfd=function(){return Object.assign(new X.a,{Current:this.Bla.Current,Pending:this.Bla.Pending,SuspensionStartTimestamp:this.Bla.SuspensionStartTimestamp})};ma.prototype.getState=function(){return Ta(this.Bla)?0==this.GK?2:1:0};ma.prototype.qUe=function(Y,
Ra){Y!==Ra&&(1===Ra?this.aGd(!0):1===Y&&this.aGd(!1));2===Ra&&this.raiseEvent(ma.MGd,new P.a(this.Bla))};ma.prototype.iwi=function(Y,Ra,zb){0===Y&&0!==Ra?(Y=1===Ra,pc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2}",Y,Y?this.Oha.OQj.join(","):"",pb(this.Bla))):0!==Y&&0===Ra&&pc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: No pending changes. counter: {0}",
pb(zb))};ma.prototype.aGd=function(Y){this.raiseEvent(ma.OVd,new Ja(Y))};ma.OVd="TPMBBC";ma.MGd="RFPMU";ma.iwd="MCC";Object(Yc.a)(ma,"MergeSuspensionState",cd.a,[]);var E=cd.a;vm(hc,E);hc.prototype.onb=function(Y){this.addHandler("MCU",Y)};hc.prototype.hHb=function(Y){this.removeHandler("MCU",Y)};hc.prototype.GOa=function(Y,Ra){Ra=void 0===Ra?"":Ra;var zb=this.S1.Current<Y.Current||this.S1.Pending<Y.Pending;if(Y.SuspensionStartTimestamp&&this.Pic!==Y.SuspensionStartTimestamp){if(this.Pic>Y.SuspensionStartTimestamp){zb&&
pc.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Ra,hc.MBb(Y),hc.MBb(this.S1));return}zb||pc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",hc.MBb(Y),hc.MBb(this.S1))}else if(!zb)return;this.S1=Y;this.QLf(Y)};hc.prototype.dispose=function(){this.$.ea.kk(this.nvc);this.$.ea.LW(this.nvc);this.$.na.xr(this.c8);
df.g(this.$).zc.Mn(this.n9a);var Y=this.$.da.Aa(292);Y&&Y.hHb(this.NBb);E.prototype.dispose.call(this)};hc.prototype.QLf=function(Y){Ta(Y)&&Y.SuspensionStartTimestamp>this.Pic&&(pc.ULS.sendTraceTag(537155416,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}",pb(Y)),this.Pic=Y.SuspensionStartTimestamp);this.raiseEvent("MCU",new P.a(Y))};hc.prototype.LTf=function(){pc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",
hc.MBb(this.S1));this.S1=Object.assign(new X.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};hc.MBb=function(Y){return Y?String.format("({0}/{1} @{2})",Y.Current,Y.Pending,Y.SuspensionStartTimestamp):"null"};Qk.Object.defineProperties(hc.prototype,{Bla:{configurable:!0,enumerable:!0,get:function(){return this.S1}}});hc.h_d="PMM.RTC";hc.w7c="PMM.EwaResult";Object(Yc.a)(hc,"PendingMergeMonitor",cd.a,[]);Object(Yc.a)(lb,"ClientRevisions",null,[]);var L=b(199),aa=b(26);Ya.prototype.dZi=function(Y){var Ra=
this;if(this.DKb(Y))(new Mh.a).setResult(!0);else{var zb=this.eZi(Y);this.Oic=Y;this.YBd++;zb.CWCT(function(){Ra.vKi()},L.a.none,0,this.MO)}};Ya.prototype.eZi=function(Y){function Ra(){var Vd;null===(Vd=zb.Fda)||void 0===Vd?void 0:Vd.aHi();pc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottler.performDoPendingMergeInternal: request failed {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp)}var zb=this,gc=this.ta.$b();this.G5f&&this.isDocumentHidden||this.ny();this.gZd=this.mh.Gea;
pc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottler.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp);if(this.Fda){var bd=yl(this.Fda.tVi()),Id=bd.next().value;bd=bd.next().value;return eb(this.ta,bd,Id?null:this.wKi.bind(this),Ra,null,null,gc)}return Ia(this.ta,null,Ra,null,null,gc)};Ya.prototype.DKb=function(Y){if(this.n5c&&this.isDocumentHidden)return this.mh.Gea-this.gZd<this.w7h;if(!this.Oic||Y.SuspensionStartTimestamp>
this.Oic.SuspensionStartTimestamp)return this.ELa&&pc.ULS.sendTraceTag(528561877,0,50,"DoPendingMergeThrottler.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp),!1;if(this.ELa)Y=!0;else{var Ra=this.Oic;Y=(Y||Ra?Y&&Ra?Y.Current===Ra.Current&&Y.Pending===Ra.Pending&&Y.SuspensionStartTimestamp===Ra.SuspensionStartTimestamp:!1:!0)&&this.mh.Gea-this.gZd<this.AKd}return Y};Ya.prototype.vKi=function(){this.YBd--};
Ya.prototype.wKi=function(Y){this.Fda&&this.Fda.bHi(Y.Result,Y.StateId)};Qk.Object.defineProperties(Ya.prototype,{ELa:{configurable:!0,enumerable:!0,get:function(){return 0<this.YBd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Ci}}});Object(Yc.a)(Ya,"DoPendingMergeThrottler",null,[591]);Qk.Object.defineProperties(Ha.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return"SelectionAdjust"}}});
Object(Yc.a)(Ha,"SelectionAdjustSessionEndsReport",null,[302]);Pa.prototype.tgg=function(Y){if(!this.f2d)return pc.ULS.sendTraceTag(525135954,0,10,"Selection.viewportBlocksReadyForAdjust: _blockCacheItems undefined"),!1;for(var Ra=yl(this.f2d),zb=Ra.next();!zb.done;zb=Ra.next())if(zb=zb.value,zb.hk&&zb.me.Revision<Y)return!1;return!0};Pa.prototype.ILj=function(){var Y;if(this.dgb)return{SheetName:this.sheetName,ActiveCell:null===(Y=this.activeCell)||void 0===Y?void 0:Y.toString(),SelectedRange:this.selectedRanges[0].toString(),
TopLeft:void 0}};Pa.prototype.toString=function(){var Y,Ra;return String.format("active cell: {0} selection: {1}",null!==(Ra=null===(Y=this.activeCell)||void 0===Y?void 0:Y.toString())&&void 0!==Ra?Ra:"null",ki.f(this.selectedRanges,function(zb){var gc;return null!==(gc=null===zb||void 0===zb?void 0:zb.toString())&&void 0!==gc?gc:"null"}).join(","))};Pa.prototype.equals=function(Y){return Y?this.activeCell.equals(Y.activeCell)&&hf.Q(this.selectedRanges,Y.selectedRanges)&&this.sheetName===Y.sheetName:
!1};Qk.Object.defineProperties(Pa.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.qG}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.r9}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.OVb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.Akg}},dgb:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(Yc.a)(Pa,"SelectionState",null,[]);var na=b(207),sb;
(function(Y){Y[Y.none=0]="none";Y[Y.waitingForAdjusted=1]="waitingForAdjusted";Y[Y.invalid=2]="invalid";Y[Y.nonContinuous=3]="nonContinuous";Y[Y.noAdjustRequired=4]="noAdjustRequired";Y[Y.waitingForViewport=5]="waitingForViewport";Y[Y.adjusted=6]="adjusted";Y[Y.divergence=7]="divergence";Y[Y.exception=8]="exception"})(sb||(sb={}));Object(Yc.b)("SelectionAdjustState",sb);pa.prototype.tVi=function(){this.tY.totalRequests++;if(this.Bfi())return this.tY.parallel++,pc.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.onWaitingForAdjustedSelection: Skipping parallel request. Current adjustedSelection is defined : {0}",
!!this.bE),[!0,null];pc.ULS.shipAssertTag(525135961,0,0===this.VH,"SelectionAdjustManager.onWaitingForAdjustedSelection: unexpected state");this.bE&&(this.tY.errors++,pc.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.onWaitingForAdjustedSelection: About to ignore a defined Adjusted selection: {0}",this.bE.toString()));this.bE=null;this.KC=this.YJa();var Y=null,Ra=this.KC.ILj();Ra&&(Y={ActiveSheetName:this.KC.sheetName,SheetViewportStateChanges:[Ra]});this.VH=1;return[!1,Y]};pa.prototype.aHi=
function(){pc.ULS.shipAssertTag(525135960,0,1===this.VH,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.tY.errors++;this.VH=2;this.Tr()};pa.prototype.bHi=function(Y,Ra){try{pc.ULS.shipAssertTag(525135959,0,1===this.VH,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.tyc=Ra,Ra=2,this.KC?Y?(this.bE=this.Zwj(Y))?(Ra=5,this.KC.dgb)?this.KC.equals(this.bE)&&(this.tY.adjustedDidntChange++,Ra=4):(this.tY.nonContinuous++,Ra=3):this.tY.errors++:(this.tY.errors++,
pc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",this.KC.toString())):(this.tY.errors++,pc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",null===Y||void 0===Y?void 0:Y.ActiveCell,null===Y||void 0===Y?void 0:Y.SelectedRange)),this.VH=Ra}catch(zb){this.VH=8,pc.ULS.sendTraceTag(525135958,
0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception {0}",zb)}finally{5!=this.VH&&this.Tr()}};pa.prototype.dispose=function(){this.gridView.Ca.Jq(this.Ig);this.gridView.Ca.np(this.h9a);this.gridView.Ca.tQf(this.h9a);this.gridView.Ca.Rab(this.h9a)};pa.prototype.Zwj=function(Y){var Ra=this,zb,gc;return function(){var bd=hf.Z(Y.ActiveCell,Ra.$.xa);zb=bd.range;return bd}().returnValue?function(){var bd=hf.Z(Y.SelectedRange,Ra.$.xa);gc=bd.range;return bd}().returnValue?new this.KXf(this.$,
zb,[gc],Y.SheetName,this.KC.activeItemName):(pc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range {0}",Y.SelectedRange),null):(pc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell {0}",Y.ActiveCell),null)};pa.prototype.YJa=function(){var Y=this.$.pa;if((null===Y||void 0===Y?0:Y.activeCell)&&Y.selectedRanges&&Y.sheetName)return new this.KXf(this.$,Y.activeCell,
Y.selectedRanges,Y.sheetName,this.$.activeItemName);this.IXf&&pc.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: {0}, activeCell null: {1}, selectedRanges null: {2}, sheetName null: {3}",!Y,!(null===Y||void 0===Y?0:Y.activeCell),!(null===Y||void 0===Y?0:Y.selectedRanges),!(null===Y||void 0===Y?0:Y.sheetName));return null};pa.prototype.Yse=function(Y){if(this.mmi(Y))try{pc.ULS.shipAssertTag(525135956,0,5===this.VH,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),
this.KC.equals(this.YJa())?(this.tY.adjusted++,this.gridView.sV(this.bE.selectedRanges,0,this.bE.sheetName,null,this.bE.activeCell,null,null,0,lf.a.xnj),this.VH=6):(this.tY.divergence++,this.Sfj(),this.VH=7)}catch(Ra){this.VH=8,pc.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception {0}",Ra)}finally{this.Tr()}};pa.prototype.mmi=function(Y){if(!this.bE)return!1;if(!this.KC)return pc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",
this.bE.toString()),!1;if(Y){if(df.g(this.$).Ca.bqf<this.tyc)return!1;this.KC.dgb&&pc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.KC.dgb||!this.KC.tgg(this.tyc)||!this.bE.tgg(this.tyc))return!1;return!0};pa.prototype.Tr=function(){var Y,Ra,zb,gc;this.zgj&&2!=this.VH&&pc.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearState: initial: {0}, adjusted: {1}, state: {2}",null!==
(Ra=null===(Y=this.KC)||void 0===Y?void 0:Y.toString())&&void 0!==Ra?Ra:"null",null!==(gc=null===(zb=this.bE)||void 0===zb?void 0:zb.toString())&&void 0!==gc?gc:"null",sb[this.VH]);this.KC=this.bE=null;this.VH=0};pa.prototype.Sfj=function(){var Y=this.YJa();pc.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.KC.toString(),Y?Y.toString():"",this.bE.toString(),
this.KC.sheetName===this.bE.sheetName,this.KC.sheetName===(Y?Y.sheetName:null))};pa.prototype.Bfi=function(){return this.IXf?1===this.VH||5===this.VH:!!this.KC||!!this.bE};Qk.Object.defineProperties(pa.prototype,{KXf:{configurable:!0,enumerable:!0,get:function(){return Pa}}});Object(Yc.a)(pa,"SelectionAdjustManager",null,[590,2]);var Lb=cd.a;vm(qa,Lb);qa.prototype.dispose=function(){this.$.na.oda(this.d8);this.yyc();this.V5.Mdj(this.iCf);this.V5.Hsc(this.kEb);this.V5.fdj(this.vAf);this.V5=null;this.Fda&&
this.Fda.dispose();Lb.prototype.dispose.call(this)};qa.prototype.gGj=function(){this.yyc();if(this.eIe()){var Y=this.V5.Dfd();pc.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",pb(Y),this.Zzb)}else this.$zb=this.asa.create(this.ZXf,this.AKd,Uh.a.$zb),this.u7a=this.asa.mC(this.ZXf,this.Pqi,Uh.a.u7a)};qa.prototype.yyc=function(){this.u7a&&(this.$zb.cancel(),
this.u7a.cancel(),this.u7a=this.$zb=null)};qa.prototype.LOi=function(Y){var Ra=" fail count: "+this.Zzb;this.Zzb++;this.eIe()&&this.yyc();pc.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",pb(Y),Ra)};qa.prototype.eIe=function(){return this.Zzb>qa.Nzi};qa.Nzi=5;Object(Yc.a)(qa,"RequestController",cd.a,[]);var Kc=ng.a;vm(ea,Kc);ea.prototype.bZb=function(Y){this.Sfa.bZb(Y)};ea.prototype.Hsc=function(Y){this.Sfa&&this.Sfa.Hsc(Y)};ea.prototype.Cza=
function(Y,Ra){this.DCa.Cza(Y,Ra)};ea.prototype.uXd=function(Y){this.DCa.uXd(Y)};ea.prototype.GOa=function(Y,Ra){this.zkb.GOa(Y,void 0===Ra?"":Ra)};ea.prototype.dispose=function(){this.pec&&(this.pec.dispose(),this.pec=null);this.vKd&&(this.vKd.dispose(),this.vKd=null);this.Sfa&&(this.Sfa.dispose(),this.Sfa=null);this.zkb.dispose();this.zkb=null;this.DCa.dispose();this.DCa=null;this.v_a&&(this.v_a.dispose(),this.v_a=null);this.k5a&&(this.k5a.dispose(),this.k5a=null);this.$=null;Kc.prototype.dispose.call(this)};
ea.prototype.VFb=function(){this.Sfa.r5i()};ea.J$b=function(Y){var Ra=0;Y=yl(Y);for(var zb=Y.next();!zb.done;zb=Y.next()){zb=zb.value;if(2==zb)return 2;1==zb&&(Ra=1)}return Ra};ea.prototype.fai=function(Y,Ra){this.DCa=new ya;Ra?Object(Bg.a)(xa,Ra)?this.Cza(Ra,Object(ob.a)(xa,Ra).GK):Object(Bg.a)(db,Ra)?this.Cza(Ra,Object(ob.a)(db,Ra).GK):this.Cza(Ra,0):(this.v_a=new db(Y),this.k5a=new xa(Y),this.Cza(this.v_a,this.v_a.GK),this.Cza(this.k5a,this.k5a.GK))};Qk.Object.defineProperties(ea.prototype,{Oha:{configurable:!0,
enumerable:!0,get:function(){return this.DCa}},t$a:{configurable:!0,enumerable:!0,get:function(){return this.zkb}},V5:{configurable:!0,enumerable:!0,get:function(){return this.Sfa}}});Object(Yc.a)(ea,"MergeSuspensionManager",ng.a,[555,2]);var ad=xd.a;vm(ia,ad);ia.prototype.create=function(){pc.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Gb(this.Pc.da.Aa(343)||this.Pc.da.Ha(343,new ea(this.Pc,eh.a.instance)))};ia.ka=function(Y){pc.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");
Y.da.Ha(344,new ia(Y))};Object(Yc.a)(ia,"MergeSuspensionFactory",xd.a,[]);ca.jti=3;ca.connected=0;Object(Yc.a)(ca,"ConnectionStateConstants",null,[]);var ha=b(107),Qa=b(113),Pb=b(41);W.prototype.JZf=function(){this.durationMs=Qa.a(aa.a.Ra,this.startTime)};W.prototype.bBd=function(Y){var Ra=this,zb;this.JZf();Pb.a(Y).Esc(this.lvf);Pb.a(Y).sg.Fsc(this.uca);Y.da.Za(291,function(gc){gc.Uab(Ra.iW)});if(null===(zb=Y.ea)||void 0===zb?0:zb.wf)Y.ea.wf.HJd(this.TBd),this.wasUserActiveOnPIEnd=Y.ea.wf.nr};W.prototype.al=
function(Y){var Ra=this;Pb.a(Y).VYb(this.lvf);this.isToastShown?this.toastRaiser="Immediate":Pb.a(Y).sg.mVc(this.uca);Y.da.Za(291,function(zb){Ra.hasTabbedOut=zb.Ci;zb.yFa(Ra.iW)});this.wasUserActiveOnPIStart&&Y.ea.wf.Ooe(this.TBd)};Object(Yc.a)(W,"PartialInteractivityData",null,[]);var rc=b(1210);vm(fa,W);fa.prototype.rJi=function(Y,Ra){this.swappedByOffline=Ra;this.bBd(Y)};fa.prototype.prj=function(Y){this.errorDataDuringConnectivityIssuesMode=Y};fa.prototype.T7i=function(Y){10>this.failedRequests.length&&
(Y=Y+"_"+ha.getElapsedSeconds(this.startTime,aa.a.Ra.Lb).toString(),this.failedRequests.push(Y))};Object(Yc.a)(fa,"ConnectivityIssuesData",W,[]);var gd=b(166);da.Gih="DuringWork";da.connectivityIssues="ConnectivityIssues";da.offline="Offline";Object(Yc.a)(da,"UnavailabilityTypes",null,[]);K.prototype.dispose=function(){this.$&&(Pb.a(this.$).sg.DQf(this.ywf),this.$.sf&&this.$.sf.CQf(this.vwf));this.data&&this.$.na.sf.ERf(this.Kn);this.$=null};K.prototype.ETg=function(Y){var Ra=this.X$c-1;return(this.data.averageDurationBetweenFailedRequestsSec*
(Ra-1)+Y)/Ra};Object(Yc.a)(K,"ConnectivityIssuesTelemetryManager",null,[2]);var hd=b(989),Bd=b(1255),qe=b(1209);T.prototype.dispose=function(){this.$&&(this.KQd&&this.$.na&&0<this.L8a.count&&this.$.na.xr(this.Mh),this.LQd&&(this.CTd("Dispose"),this.$.ea.wf.Kza(this.tca)))};T.prototype.K$h=function(){Nc.EwaSettings.la(213)&&this.K0i();this.LQd&&this.L0i()};T.prototype.gai=function(){this.ECb=this.FCb;this.qsd=0;var Y={};if(!this.L8a){this.L8a=new vf.a;var Ra=Bd.a.Lcd(this.ygj,"InitSampleMeasurement",
this.$);Ra=yl(Ra);for(var zb=Ra.next();!zb.done;zb=Ra.next())zb=zb.value,Y[zb.mkd]=zb.baseUrl,this.L8a.add(zb)}Y=Sys.Serialization.JavaScriptSerializer.serialize(Y);pc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.FCb,this.ECb,Y);0<this.L8a.count&&this.$.na.tq(this.Mh)};T.prototype.zGj=function(){for(var Y=yl(this.L8a),Ra=Y.next();!Ra.done;Ra=Y.next())Ra.value.dMd()};
T.prototype.jTd=function(Y){this.mSa&&this.mSa.ep||(pc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",Y),this.mSa=eh.a.instance.mC(this.boj,5E3,Uh.a.xEj),this.mSa.xka())};T.prototype.CTd=function(Y){this.mSa&&this.mSa.ep&&(pc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",Y),this.mSa.cancel())};T.prototype.Ayj=function(Y){return this.ECb>=this.FCb&&Y-this.qsd>this.uwd};
T.prototype.jXg=function(){return T.QUf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};T.prototype.K0i=function(){this.FCb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.uwd=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var Y=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.FCb&&0<this.uwd&&(this.KQd=T.QUf(Y))&&this.gai()};T.prototype.L0i=function(){if(!this.Xxc){this.Xxc=new vf.a;var Y=Bd.a.Lcd(this.Ofj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[qe.a.BDc]);
Y=yl(Y);for(var Ra=Y.next();!Ra.done;Ra=Y.next())this.Xxc.add(Ra.value);this.$.ea.wf.nr&&this.jTd("PrepareAndInitSlowNetworkTests")}};T.QUf=function(Y){return 100*Math.random()<Y};Object(Yc.a)(T,"NetworkMeasurement",null,[2]);var ef=b(913);H.prototype.bSj=function(){this.zU&&this.zU.JZf()};H.prototype.jCg=function(Y){this.allOfflinePartialInteractivitiesDataInSession.push(Y);this._count++};Qk.Object.defineProperties(H.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},
zU:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}}});Object(Yc.a)(H,"OfflinePartialInteractivitiesDataForLog",null,[]);vm(S,W);S.prototype.Ruj=function(Y){this.timeFromLastOffline=Y};S.prototype.qrj=function(Y){this._errorDataDuringOfflineMode=Y};Object(Yc.a)(S,"OfflinePartialInteractivityData",W,[]);ba.prototype.dispose=function(){this.$&&Pb.a(this.$)&&Pb.a(this.$).sg.nJd(this.F9a);
gh.a.Fa(this.Ftb);this.$=this.Ftb=null};ba.prototype.yQi=function(Y){this.zU=new S(aa.a.Ra.Lb,this.$,0!==Y);this.zU.Ruj(-1!==this.PEd?window.performance.now()-this.PEd:-1);this.jOa.jCg(this.zU);Pb.a(this.$).sg.mVc(this.uca);this.H2a();this.Ftb=eh.a.instance.mC(this.H2a,ba.yEh,Uh.a.H2a);gd.a(this.$).PUc(this.XVf)};ba.prototype.zQi=function(){this.zU.bBd(this.$);this.H2a();gh.a.Fa(this.Ftb);this.Ftb=null;this.PEd=window.performance.now();Pb.a(this.$).sg.Fsc(this.uca);gd.a(this.$).ZId(this.XVf);this.Pfj()};
ba.prototype.rlj=function(Y,Ra){var zb=this;this.$?this.Akf=Da.TaskExtensions.Ba(this.Akf,function(){zb.indexedDB.Qbb(new ef.a(Y,Ra))},this.$.ma):pc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};ba.prototype.Jfj=function(){var Y=this.$.ma;Da.TaskExtensions.Ba(Da.TaskExtensions.Ba(this.indexedDB.cKa(ba.UCd),this.ogj,Y),this.vaj,Y)};ba.prototype.Pfj=function(){if(this.zU){var Y=Sys.Serialization.JavaScriptSerializer.serialize(this.zU);
Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?bf.b().aJb(560791645,0,50,da.offline,this.zU.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Y):pc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Y)}Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&
this.zU&&this.zU.isToastShown&&Cc.Health.instance.recordQosError(Ka.a.OVj,[bb.a.jjc],!0,!1,!1,!1,null)};ba.mld="NetworkAvailability";ba.nld="NetworkAvailabilityData";ba.UCd="partialInteractivityData";ba.yEh=3E3;Object(Yc.a)(ba,"OfflineModeTelemetryManager",null,[2]);la.prototype.dispose=function(){gh.a.Fa(this.guf);gh.a.Fa(this.vxd);gh.a.Fa(this.Gla);gh.a.Fa(this.I1g);this.$=null};Object(Yc.a)(la,"NetworkConnectionTelemetryManager",null,[2]);vm(Q,W);Q.prototype.F9a=function(){this.wasInteruptedByOfflineMode=
!0};Object(Yc.a)(Q,"SilentReopenData",W,[]);U.prototype.dispose=function(){this.sg.cRf(this.qAf);this.sg.lej(this.ZDf);this.y7=this.sg=this.$=null};U.prototype.WDf=function(Y,Ra){Y.KP?this.y7=new Q(aa.a.Ra.Lb,this.$,0!==Y.boa,Ra):(5===Y.boa&&(this.y7.wasInteruptedByOfflineMode=!0),3!==Y.boa&&2!==Y.boa||pc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.y7.bBd(this.$),
2===Ra?Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?bf.b().bJb(571289604,0,50,da.offline,this.y7.durationMs,this.y7):pc.ULS.sendTraceTag(571289604,0,50,kh.a.Lc(this.y7)):Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?bf.b().bJb(542782150,0,50,da.Gih,this.y7.durationMs,this.y7):pc.ULS.sendTraceTag(542782150,0,50,kh.a.Lc(this.y7)),this.y7=null)};Object(Yc.a)(U,"SilentReopenPartialInteractivityTelemetryManager",
null,[2]);var nf=cd.a;vm(V,nf);V.prototype.dispose=function(){this.sf&&(this.Nwc&&(this.sf.kdj(this.IDb),this.sf.jHb(this.VAf)),this.sf.CQf(this.wwf),this.sf.Ybj(this.xwf));this.nzb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.ZGb(this.qya),this.nzb=!1);this.$&&(this.Erc&&this.IAc(),this.$.ea&&(this.$.ea.uRf(this.YDf),this.$.ea.wf&&this.$.ea.wf.Kza(this.tca)));Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.U0&&(this.U0.dispose(),
this.U0=null);gh.a.Fa(this.isf);this.$=null;nf.prototype.dispose.call(this)};V.prototype.ozi=function(){this.DQd=!0};V.prototype.vke=function(){this.Ona||(this.Ona=Pb.a(this.$).sg.cYa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};V.prototype.Xfi=function(){if(this.DQd)return this.DQd=!1,!0;var Y=this.J7>this.Knf||this.fld>this.Knf&&10>this.J7;pc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",
this.J7,this.fld,Y);return Y};V.prototype.Bgj=function(){Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.U0=eh.a.instance.create(function(){Cc.Health.instance.recordQosError(Ka.a.CEj,[bb.a.jjc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};V.prototype.Qzg=function(){var Y=this;this.Ona||this.J0?pc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.J0=eh.a.instance.create(function(){Y.$?Y.Ona?pc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):df.g(Y.$).isEditing?(Y.Fab||(df.g(Y.$).qc.Lo(Y.Jg),pc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),Y.Gab=
!0,pc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):Y.vke():pc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.s5f,Uh.a.wDj,void 0,!0)};V.prototype.brf=function(Y){this.j2c=this.Sve(2,Y,!0);this.kpe()};V.prototype.Zkc=function(Y,
Ra){this.EVb=this.Sve(Y,Ra,!1);this.kpe()};V.prototype.Sve=function(Y,Ra,zb){zb=zb?this.j2c:this.EVb;return Ra?zb|Y:zb&~Y};V.prototype.NVd=function(){var Y=!!this.kOa,Ra=!!this.hSa,zb=!!this.Ona,gc=!!this.V2b;this.kBb&&!Y?this.Pzg():!this.kBb&&Y&&this.Zbh();!this.Wjc||Ra||zb?this.Wjc||(Ra?this.zGe():(zb||this.J0&&this.J0.ep)&&this.AGe()):this.w2f&&this.Hfa?this.Nzg():!this.qKb||this.Hfa||Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.J0||
this.Qzg();this.Cka&&!gc?this.v$f(!0):!this.Cka&&gc&&this.v$f(!1)};V.prototype.Pzg=function(){this.$?this.kOa?pc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):df.g(this.$).isEditing?(this.Gab||(df.g(this.$).qc.Lo(this.Jg),pc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.Fab=!0,pc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.zke():pc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};V.prototype.zke=function(){this.kOa||(this.kOa=Pb.a(this.$).sg.cYa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};V.prototype.Zbh=function(){this.kOa&&
(gh.a.Fa(this.kOa),this.kOa=null)};V.prototype.zGe=function(){this.hSa&&(gh.a.Fa(this.hSa),this.hSa=null);Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.U0&&this.U0.ep&&this.U0.cancel();this.U0=null};V.prototype.AGe=function(){this.Ona&&(gh.a.Fa(this.Ona),this.Ona=null);this.J0&&(gh.a.Fa(this.J0),this.J0=null);this.Gab&&!this.Fab&&df.g(this.$).qc.Mn(this.Jg);this.Gab=!1};V.prototype.Nzg=function(){this.hSa||(this.hSa=Pb.a(this.$).sg.cYa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,le.a.instance.fa(2126)));this.Bgj()};V.prototype.v$f=function(Y){Y?(this.V2b=Pb.a(this.$).sg.cYa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.N3i()):(gh.a.Fa(this.V2b),this.V2b=null)};V.prototype.N3i=function(){if(this.$&&this.$.na){var Y=this.$.na.ta.$b();ge.jb(this.$.na.ta,null,null,null,Y)}};V.prototype.IAc=function(){ch.a(this.$).QQ(Rf.a.VOa).Lq(this.fBf);this.$.ol(this.ud);this.Erc=!1};V.prototype.kpe=function(){this.documentVisibilityObserver||pc.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Ci?this.nzb||(this.documentVisibilityObserver.inb(this.qya),this.nzb=!0,pc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.NVd()};Qk.Object.defineProperties(V.prototype,
{Rhi:{configurable:!0,enumerable:!0,get:function(){return this.Hfa}},kBb:{configurable:!0,enumerable:!0,get:function(){return!(this.EVb&1)}},Wjc:{configurable:!0,enumerable:!0,get:function(){return!(this.EVb&2)}},Cka:{configurable:!0,enumerable:!0,get:function(){return!!(this.j2c&2)}}});Object(Yc.a)(V,"NetworkConnectionStateManager",cd.a,[557,2]);var kf=xd.a;vm(D,kf);D.prototype.create=function(){var Y=this;Da.TaskExtensions.Ba(Lh.GetServiceTaskFactory.Wa(this.$.da,395,396,this.ub),function(Ra){Y.Gb(Y.$.da.Aa(400)||
new V(Y.$,Ra.result))},this.$.ma,3)};D.ka=function(Y){Y.da.Ha(401,new D(Y))};Object(Yc.a)(D,"NetworkConnectionStateManagerFactory",xd.a,[]);var Af=b(1368),Jg=b(1165);z.prototype.dispose=function(){this.ecg();this.mcg();this.vsd=this.gsd=this.hL=this.nk=this.pr=this.Sqc=this.$=null;this.VZd=0};z.prototype.uOg=function(Y){this.hL=Y;this.gsd=Y.eIg;this.vsd=Y.m8i};z.prototype.nIa=function(){if(this.hL){var Y=hf.K(this.hL.Jzh);this.KEj(Y);this.hide();this.ecg();this.hL=null}};z.prototype.KEj=function(Y){var Ra=
[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993];Nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&Y&&(null!=this.gAb&&Ra.includes(this.gAb.command)?(pc.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. Last command was {0}",Jg.a[this.gAb.command]),this.gAb=null):df.g(this.$).Sb.r5(Y)?pc.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered."):
df.g(this.$).Sb.Nka(Y)?pc.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered."):(Ra=Ef.d(this.$.xa.pa),Y=new If.a(Y,Ra),this.ONj(Y)))};z.prototype.smi=function(){return!!this.hL&&this.Sqc.Nii};z.prototype.JCj=function(Y){this.hL?this.show(Y):pc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};z.prototype.dTh=function(){return this.hL?this.hL.psi:null};z.prototype.show=
function(Y){var Ra=this.hL.UOh();Ra?(this.Sqc.showFloatie(Object.assign(new Af.a,{x:Ra.x,y:Ra.y}),this.hL.XJa(),Y),this.al()):pc.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};z.prototype.hide=function(){this.smi()&&this.Sqc.rC();this.mcg()};z.prototype.al=function(){if(!this.f6b){var Y=df.g(this.$);Y.view.Ls(this.meg);Y.xj.Xl(this.JIe);this.nk.ka("blur",this.Sfh);this.$.Ka.xFa(this.F_);this.$.xa.Qf(this.KIe);(Y=this.$.da.Aa(65))&&Y.l3&&Y.l3.registerForCommentEvents(this.IIe);
this.f6b=!0}this.tdc||(this.pr.nt(Fg.a.Tb,this.$.domElement,this.onKeyDown,!0),this.pr.nt(Fg.a.Xd,this.$.domElement,this.onKeyUp,!0),this.tdc=!0)};z.prototype.ecg=function(){if(this.f6b){var Y=df.g(this.$);Y.view.Mq(this.meg);Y.xj.nl(this.JIe);this.nk.detach("blur");this.$.Ka.mQa(this.F_);this.$.xa.ug(this.KIe);(Y=this.$.da.Aa(65))&&Y.l3&&Y.l3.unregisterForCommentEvents(this.IIe);this.f6b=!1}};z.prototype.mcg=function(){this.tdc&&(this.pr.tt(Fg.a.Tb,this.$.domElement,this.onKeyDown,!0),this.pr.tt(Fg.a.Xd,
this.$.domElement,this.onKeyUp,!0),this.tdc=this.j_=this.H8b=!1)};z.prototype.VTj=function(){this.hL&&250<=aa.a.Ra.ie.m-this.VZd&&this.show(-1)};z.prototype.ONj=function(Y){Da.TaskExtensions.Ba(Lh.GetServiceTaskFactory.Wa(this.$.da,426,427,1),function(Ra){Ra.result.tea(Y,"Paste")},this.$.ma,3)};Object(Yc.a)(z,"RecoveryUIController",null,[276,2]);var fh=xd.a;vm(I,fh);I.prototype.create=function(){var Y=this,Ra=this.$;Ra.YE(function(zb){zb.xld().then(function(gc){Y.Gb(Ra.da.Aa(406)||new z(Ra,gc,Ph.KeyInputManager.instance,
Dh.a.instance.pE()))})})};I.ka=function(Y){Y.da.Ha(405,new I(Y))};Object(Yc.a)(I,"RecoveryUIControllerFactory",xd.a,[]);var Oh=b(681),Qg=b(572),fi=b(38),Dg=b(1182),lh=Ca.a;vm(r,lh);r.prototype.validate=function(){this.Gj.FE||pc.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Gj.FE.value?!0:(r.Iz(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};r.prototype.KLi=function(Y){this.Uvg&&(this.Gj=this.N0f(Y,this.UWb))};r.prototype.cVi=function(){this.Gj&&this.Gj.FE&&
(this.u6d||(this.Gj.Z9i(Object(Xe.a)(this,this.aAd,"onFileChosen")),this.u6d=!0),this.Gj.sTe())};r.prototype.aAd=function(Y){this.YWa.uploadStatusLabel=Y;this.gBc(this.titleText,Object(Xe.a)(this,this.Jec,"insertDialogHandler"),this.YWa)};r.prototype.Jec=function(Y){1===Y&&this.isEnabled()?r.vy&&this.Gj.FE&&!this.Gj.FE.value?(this.YWa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.gBc(this.titleText,Object(Xe.a)(this,this.Jec,"insertDialogHandler"),this.YWa)):(this.Xwb(),this.UWb.finalizeUpload(this.Gj,
Object(Xe.a)(this,this.dispose,"dispose"))):0===Y&&this.hide()};r.prototype.O0f=function(){this.aIc=!1;this.Gj=this.N0f(document.getElementById("uploadFrameContainer"),this.UWb);Tc.AFrameworkApplication.ga.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Cga=Object(Xe.a)(this,this.RBd,"onUploadFrameLoad"),fi.a.addHandler(this.Gj.iFrame,"load",this.Cga));this.Gj.FE||pc.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.qKf()};r.prototype.RBd=function(){this.qKf()};r.prototype.qKf=
function(){if(this.Gj&&!this.aIc){var Y=this.Gj.FE;Y&&(fi.a.addHandler(Y,Fg.a.Tb,Object(Xe.a)(this,this.onKeyDown,"onKeyDown")),Y=[Y],this.Rm=Y.concat.apply(Y,this.Rm),this.Xdg(),this.aIc=!0)}};r.prototype.dispose=function(){if(this.Gj&&!r.vy){var Y=this.Gj.FE;Y&&fi.a.removeHandler(Y,Fg.a.Tb,Object(Xe.a)(this,this.onKeyDown,"onKeyDown"));this.Cga&&fi.a.removeHandler(this.Gj.iFrame,"load",this.Cga)}this.Gj=null;lh.prototype.dispose.call(this)};r.prototype.Xdg=function(){if(0<this.Rm.length){var Y=
new Dg.a(this.Rm),Ra=uc.FocusManager.instance().RQ();Ra&&(this.Rm[0].focus(),Ra.jf=Y,Ra.s_=!0)}};r.prototype.onKeyDown=function(Y){4!==uc.FocusManager.instance().sKf(Y)&&Y.preventDefault()};r.Iz=function(Y){var Ra=document.getElementById("errorText");Ra.innerText=Y;Ra.style.display="inline-block"};Qk.Object.defineProperties(r.prototype,{pVj:{configurable:!0,enumerable:!0,get:function(){return this.UWb}}});Qk.Object.defineProperties(r,{vy:{configurable:!0,enumerable:!0,get:function(){return Tc.AFrameworkApplication.sa.Qa.qw&&
Tc.AFrameworkApplication.sa.Qa.Sgf}}});Object(Yc.a)(r,"InsertFileDialog",Ca.a,[]);Qk.Object.defineProperties(B,{eg:{configurable:!0,enumerable:!0,get:function(){return Ca.a.Bn(B.Uj,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});B.Uj="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(Yc.a)(B,"InsertImageDialogHtml",null,[]);vm(u,r);u.prototype.validate=function(){this.Gj.FE||pc.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var Y=Object(ob.a)(Za,this.pVj),Ra=Y.Pfg(this.Gj.FE.value);return 0!==Ra?(r.Iz(Y.QZe(Ra)),!1):!0};Qk.Object.defineProperties(u.prototype,{tXb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},
Teh:{configurable:!0,enumerable:!0,get:function(){return B.eg}}});Object(Yc.a)(u,"InsertImageDialog",r,[]);var zg=b(576),Ah=b(192),Ui=b(419);A.prototype.abf=function(){this.FD=Jd.a.create().toString();this.Iqa?this.v8c():this.Pqe()};A.prototype.B4g=function(Y){this.Tn=document.createElement("iframe");this.Tn.className=Y;this.Tn.id=Y;this.a7d&&(this.Tn.style.visibility="visible",this.Tn.style.height="30px",this.Tn.setAttribute("frameborder","0"));this.Cga=Object(Xe.a)(this,this.RBd,"onUploadFrameLoad");
fi.a.addHandler(this.Tn,"load",this.Cga)};A.prototype.z6b=function(Y){var Ra=this;Tc.AFrameworkApplication.sa.Zpc();if(!this.Vq)return pc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";fi.a.addHandler(this.Vq,"change",function(){Ra.oBh(Y)});x(Object(Xe.a)(this,this.sTe,"fileInputClick"),1,"DoFileOpenDialog");return this.Vq.value};A.prototype.oBh=function(Y){Y&&Y(this.Vq.value)};A.prototype.pBh=function(){this.MRb&&(this.MRb.innerText=this.d0e())};A.prototype.Z9i=function(Y){var Ra=this;
fi.a.addHandler(this.Vq,"change",function(){Y(Ra.d0e())})};A.prototype.d0e=function(){var Y=null;if(this.Vq.value){var Ra=this.Vq.value,zb=Ra.lastIndexOf("\\");0<zb&&(Y=Ra.substring(zb+1,Ra.length))}return Y?Y:""};A.prototype.sTe=function(){try{pc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Vq.click()}catch(Y){throw pc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Y.message),Y;}};A.prototype.IHj=function(){this.pni()?
this.O7f():(this.FYd(),this.Es.submit())};A.prototype.pni=function(){return(this.Wqg||this.Iqa)&&!(void 0===window.self.FormData||null===window.self.FormData)};A.prototype.hYf=function(Y){if(Y){var Ra=this.eDe();this.Kg=new XMLHttpRequest;this.Kg.open("POST",Ra);this.Kg.setRequestHeader("X-CorrelationId",this.FD);this.ovi(Y);this.Kg.onreadystatechange=Object(Xe.a)(this,this.Foa,"uploadResponseReceived");this.Kg.send(Y)}};A.prototype.ovi=function(Y){if(!Qc.a.bB&&Y.get){var Ra=Y.get("ImageId");Y=window.self.navigator;
var zb={};Ra=(zb.CorrelationId=this.FD,zb.Canary=Tc.AFrameworkApplication.canary,zb.ImageNodeId=Ra,zb);Y&&(Y=Y.connection?Y.connection:Y.mozConnection?Y.mozConnection:Y.webkitConnection?Y.webkitConnection:null)&&(Ra.effectiveType=Y.effectiveType,Ra.downlink=Y.downlink,Ra.type=Y.type,Ra.rtt=Y.rtt);pc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Ra)}};A.prototype.O7f=function(){try{this.FYd();pc.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");
var Y=new (Type.parse("FormData"))(this.Es);this.hYf(Y)}catch(Ra){pc.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Ra.message),this.U9a(null)}};A.prototype.N7f=function(Y){try{if(this.FYd(),pc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.AWj(Y)){this.NRb=Y;this.Es.contains(this.Vq)&&this.Es.removeChild(this.Vq);var Ra=new (Type.parse("FormData"))(this.Es);Ra.append("applicationfileInput",
Y.blob,Y.filename);this.hYf(Ra)}else this.U9a(null)}catch(zb){pc.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+zb.message),this.U9a(null)}};A.prototype.AWj=function(Y){return Y&&void 0!==Y.blob&&null!==Y.blob&&void 0!==Y.filename&&null!==Y.filename&&""!==Y.filename?void 0===window.self.FormData||null===window.self.FormData?(pc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(Y=Y?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",
void 0===Y.blob||null===Y.blob,void 0===Y.filename||null===Y.filename||""===Y.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",pc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Y)),!1)};A.prototype.Foa=function(){if(4===this.Kg.readyState)if(200===this.Kg.status){pc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.FD);var Y=this.Kg.getResponseHeader("X-NewKey"),
Ra=this.zgi(this.Kg),zb=!1;if(void 0!==Y&&null!==Y&&Ra&&(zb=this.pWj(Y),!this.tSc&&zb)){pc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.FD);this.tSc=!0;void 0!==this.NRb&&null!==this.NRb?this.N7f(this.NRb):this.O7f();return}pc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.tSc,
Ra,!(void 0===Y||null===Y),zb,this.FD);this.U9a(this.Kg.responseText)}else pc.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Kg.status,this.Kg.responseText?!1:!0,this.FD),this.U9a(null)};A.prototype.zgi=function(Y){try{var Ra=Kf.a(Y.responseText).Responses;if(void 0!==Ra&&null!==Ra&&1===Ra.length){var zb=Ra[0];if(void 0!==zb&&null!==zb&&2===zb.length&&28===zb[1].StatusCode)return!0}}catch(gc){}return!1};A.prototype.pWj=function(Y){Ui.a.Ycg(Y);
return Tc.AFrameworkApplication.canary!==Y?!1:!0};A.prototype.FYd=function(){this.uSc||(this.uSc=new Date)};A.prototype.dispose=function(){this.sm||(this.Iqa?this._parent.removeChild(this.Es):(this._parent.removeChild(this.Tn),fi.a.removeHandler(this.Tn,"load",this.Cga),this.Cga=null),this.$Hc&&(fi.a.removeHandler(this.Vq,"change",this.$Hc),this.$Hc=null),this.tTe&&(this.eib&&(fi.a.removeHandler(this.Vq,"change",this.eib),this.eib=null),this.MRb=null),this.Vq=this.Es=this._parent=this.Tn=null,this.sm=
!0,this.uSc=null,pc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};A.prototype.delayedDispose=function(){this.dispose()};A.prototype.d7g=function(Y){if(this.Es){var Ra;(Ra=this.Es.querySelector("input[name=__REQUESTDIGEST]"))?Ra.value=Y:(Ra=this.T3c(),Ra.type="hidden",Ra.id="__REQUESTDIGEST",Ra.name="__REQUESTDIGEST",Ra.value=Y,this.Es.appendChild(Ra))}};A.prototype.T3c=function(){return this.Iqa?document.createElement("input"):this.Tn.contentWindow.document.createElement("input")};A.prototype.RBd=
function(){try{if(!this.Tn.contentWindow.document.body)return}catch(gc){this.S5h();return}if(!(this._initialized||this.G8a&&Qc.a.qF))this.v8c();else if(!this.G8a||!Qc.a.qF||this.ski){var Y=Qc.a.Af?this.Tn.contentWindow.document.body.innerText:this.kfg?this.Tn.contentWindow.document.body.firstChild.innerText:this.Tn.contentWindow.document.body.firstChild.innerHTML;var Ra=this.Tn.contentWindow.document.body.innerText.toLowerCase(),zb=0<=Ra.indexOf("responses")||0<=Ra.indexOf("wopisrc");Ra=0<=Ra.indexOf("http error");
!zb&&Ra&&pc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.Tn.contentWindow.document.body.innerText);this.U9a(Y)}};A.prototype.v8c=function(){if(!this._initialized){var Y=this.fa("uploadForm"),Ra=this.fa("fileInput"),zb=this.eDe();this.K6g();this.Es.id=Y;this.Es.method="post";this.Es.encoding="multipart/form-data";this.Es.action=zb;this.Vq.type="file";this.V0d&&(this.Vq.accept=this.V0d,this.T2d&&(this.Vq.capture=this.T2d));this.Vq.id=Ra;this.Vq.name=
Ra;this.lJg&&(this.Vq.multiple=!0);!this.tTe||Qc.a.Af||Qc.a.KH||(this.eib=Object(Xe.a)(this,this.pBh,"fileInputChangedHandleAccessibility"),fi.a.addHandler(this.Vq,"change",this.eib),this.MRb=ua.a.Lqe(this.Es,this.Vq,"InputFileDescription"));this.a7d&&(this.Iqa||(Y=this.Tn.contentWindow.document.body,Y.style.margin="0",Y.style.overflow="hidden"),Y=Tc.AFrameworkApplication.sa,this.Vq.style.fontFamily=Y.Y0,this.Vq.style.fontSize=Y.vAc,this.Vq.style.margin="0");(Y=document.getElementById("__REQUESTDIGEST"))&&
this.d7g(Y.value);this.Es.appendChild(this.Vq);this._initialized=!0;this.Dqg(this)}};A.prototype.K6g=function(){if(this.Iqa)this.Es=document.createElement("form"),this._parent.appendChild(this.Es),this.Vq=document.createElement("input");else{this.Es=this.Tn.contentWindow.document.createElement("form");var Y=this.Tn.contentWindow.document;Y.body.appendChild(this.Es);this.Vq=Y.createElement("input")}};A.prototype.Pqe=function(){this._parent.appendChild(this.Tn);this.G8a&&Qc.a.qF&&this.v8c()};A.prototype.eDe=
function(){var Y=new ec.QueryStringBuilder(this.yTe);Tc.AFrameworkApplication.Pmb(Y);this.Ypj(Y);Y=Y.toString();if(Qc.a.Df||Qc.a.qF||Qc.a.KH)Y=sg.a.fXe(Y);return Y};A.prototype.Kle=function(){var Y=new Qh.a(2,1,0,Object(Xe.a)(this,this.delayedDispose,"delayedDispose"),4);Tc.AFrameworkApplication.gj.Yg(Y)};Qk.Object.defineProperties(A.prototype,{gUf:{configurable:!0,enumerable:!0,get:function(){return this.evg}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.rQc}},iFrame:{configurable:!0,
enumerable:!0,get:function(){return this.Tn}},FE:{configurable:!0,enumerable:!0,get:function(){return this.Vq}},G8a:{configurable:!0,enumerable:!0,get:function(){return Tc.AFrameworkApplication.ga?Tc.AFrameworkApplication.ga.ra("NativeFileOpenDialogIsEnabled"):!1}},tTe:{configurable:!0,enumerable:!0,get:function(){return Tc.AFrameworkApplication.ga?Tc.AFrameworkApplication.ga.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},ski:{configurable:!0,enumerable:!0,get:function(){return this.Iqa?!1:
Ah.a(this.Tn.contentWindow.location.pathname,this.yTe,0)}},lJg:{configurable:!0,enumerable:!0,get:function(){return!Qc.a.bB&&Tc.AFrameworkApplication.ga.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(Yc.a)(A,"UploadFrame",null,[2]);vm(t,A);t.prototype.fa=function(Y){return Y};t.prototype.Ypj=function(Y){pc.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");pe.a.tWc(Y,this.$.ya);Y.C9(Xd.a.sessionId,this.sessionId);var Ra=df.g(this.$).ha;Ra=hf.o(Ra.va.p4,this.$);
Y.C9(Xd.a.F3i,this.$.xa.pa.name);Y.C9(Xd.a.E3i,Ra.FirstRow.toString());Y.C9(Xd.a.D3i,Ra.FirstColumn.toString())};t.prototype.S5h=function(){this.gUf("ServerUploadError")};t.prototype.U9a=function(Y){this.gUf(Y)};t.xii=function(Y){return!Y||Ge.a.equals(Y,"ServerUploadError",!1)};Object(Yc.a)(t,"UploadFrameWrapper",A,[]);vm(w,u);w.prototype.N0f=function(Y,Ra){return new t(Y,Object(Xe.a)(Ra,Ra.nEb,"onUploadFrameInitialized"),Object(Xe.a)(Ra,Ra.Foa,"uploadResponseReceived"),this.ga,!0,this.$)};w.prototype.dispose=
function(){this.LAc();this.aR=this.RBc=null;u.prototype.dispose.call(this)};w.prototype.hide=function(){u.prototype.hide.call(this);this.$.Ab.QC=!1};w.prototype.validate=function(){var Y=this.RBc.pZd(this.Gj.FE.value,this.RBc.Tag(this.Gj));return 0!==Y?(Y=this.RBc.oed(Y).Description,this.TXd(Y),this.UTd(),!1):!0};w.prototype.isEnabled=function(){return!0};w.prototype.TXd=function(Y){this.XU.innerHTML=Y};w.prototype.Nld=function(){this.XU=document.getElementById("errorText");this.XU.style.display=
"inline-block";this.TAa=!1;this.TXd("");this.gIa.style.maxWidth=this.gIa.currentStyle.minWidth};w.prototype.UTd=function(){this.aR.qa(Fg.a.click,this.Gj.FE,this.Hmc);this.aR.qa(Fg.a.Tb,this.Gj.FE,this.Hmc);this.TAa=!0};w.prototype.LAc=function(){this.TAa&&(this.aR.za(Fg.a.click,this.Gj.FE,this.Hmc),this.aR.za(Fg.a.Tb,this.Gj.FE,this.Hmc),this.TAa=!1)};Object(Yc.a)(w,"InsertImageDialogWrapper",u,[]);vm(v,Za);v.prototype.dispose=function(){gh.a.Fa(this.C_b);this.Gj&&this.Gj.Kle();this.Gj=this.C_b=this.vb=
null};v.prototype.X6i=function(Y){function Ra(){gc.Nw(!0)}var zb=this;if(!this.$)return pc.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),bg.Task.Ta(!0);if(!this.$.rba)return bg.Task.Ta(!0);var gc=new Mh.a,bd=new FileReader;Y=Y.FE.files[0];bd.onload=function(){zb.sDd=bd.result;gc.Nw(!0)};bd.onerror=Ra;bd.onabort=Ra;bd.readAsDataURL(Y);return gc.task};v.prototype.Tag=function(Y){var Ra=-1;Y=Y.FE;(null===Y||void 0===Y?0:Y.files)&&0<Y.files.length&&(Ra=Y.files[0].size);
return Ra};v.prototype.pZd=function(Y,Ra){var zb=v.z3g(Za.IBa(Y));0===zb?-1!==Ra&&(pc.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Ra,this.xkc,this.$.ea.ukf),Ra>this.xkc?zb=3:Ra>this.$.ea.ukf&&(zb=7)):6===zb&&this.kxi(Y);pc.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: {0}",zb);return zb};v.prototype.IBa=function(Y,Ra){Y=this.pZd(Y,this.Tag(Ra));return 0!==Y?(this.l1a||1===Y||this.HRd(Y),!1):
!0};v.prototype.oag=function(Y){Y.IHj()};v.prototype.oed=function(Y){var Ra=0,zb=1,gc=-1100324317,bd="InsertPictureUnknownError",Id=null;switch(Y){case 1:Ra=1708;zb=0;gc=940870981;bd="InsertPictureNoFileSelected";break;case 3:zb=0;gc=1250467391;bd="InsertPicturePictureTooBig";Id=String.format(le.a.instance.Cb(171),this.yzi.toLocaleString());break;case 6:Ra=1712;zb=0;gc=1380041209;bd="InsertPictureUnsupportedFormat";break;case 7:Ra=1709;zb=0;gc=-903115058;bd="InsertPictureExceedWorkbookSize";break;
case 4:Ra=1710;zb=0;gc=1218352119;bd="InsertPictureUploadTimeout";break;case 5:Ra=1711,zb=0,gc=1979899005,bd="InsertPictureServiceNonDeterministicError"}Y=v.jd(Ra,zb,gc,bd);Id&&(Y.Description=Id);return Y};v.prototype.showDialog=function(){v.twe()?(this.l1a=!1,this.Gj=new t(this.$.domElement,this.nEb,this.Foa,this.ga,!1,this.$,!0)):(pc.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Gzb&&(Qc.a.Vu||Qc.a.qF&&72>Qc.a.Hye)?(this.l1a=!1,this.Gj=new t(this.$.domElement,this.nEb,this.Foa,
this.ga,!1,this.$)):(this.l1a=!0,this.Gj=(new w(this,this.$,this.ga)).Gj))};v.prototype.E5h=function(Y){var Ra={};try{if(Ra=kh.a.oi(Y),bf.b().WB(this.g_d.id,Ra.ServerCorrelationId,"actions","ServerActions"),!kd.a.lh(Ra.Errors)&&Ra.Result){this.$.ea.vX(Ra.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");var zb=Ra.Result;$h.a(this.$).jna(1,zb);var gc=this.$.da.Aa(277);gc&&gc.hUc(this.$,1,Ra.Result,Ra,"InsertPicture");pc.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(bd){pc.ULS.sendTraceTag(526399113,
0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:-1,bd)}this.lAc(Ra,null,"InsertPictureWebMethod")};v.prototype.u6e=function(Y){Y={Errors:[this.oed(Y)]};this.lAc(Y,null,"InsertPictureWebMethod")};v.prototype.lAc=function(Y,Ra,zb){this.Br(Y,Ra,zb)};v.prototype.wWd=function(Y,Ra,zb){this.naa(Y,Ra,zb)};v.prototype.HRd=function(Y){Y=this.oed(Y);Nc.EwaSettings.nz()?new Oc.a(this.$,Y):(new Fb.ErrorDialog(this.$,Y)).mf()};
v.prototype.kxi=function(Y){var Ra=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;Y=Xf.a.Nl(Y);for(var zb=0;zb<Ra.length;++zb)if(Y.endsWith(Ra[zb])){pc.ULS.sendTraceTag(526399112,0,50,"Insert picture blocked invalid extension: {0}",Ra[zb]);break}};v.EWj=function(Y){return!Y||Ge.a.equals(Y,Xd.a.insertPictureUnknownError,!0)?2:Ge.a.equals(Y,Xd.a.insertPictureNoFileSelectedError,!0)?1:Ge.a.equals(Y,Xd.a.ndi,!0)?3:Ge.a.equals(Y,Xd.a.odi,!0)?5:0};v.jd=function(Y,Ra,zb,gc){return kd.a.jd(1,0,0,Y,
Ra,zb,gc)};v.z3g=function(Y){switch(Y){case 1:return 1;case 2:return 6}return 0};v.twe=function(){return Nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};Qk.Object.defineProperties(v.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},yzi:{configurable:!0,enumerable:!0,get:function(){return this.xkc/1024/1024}}});Object(Yc.a)(v,"BasePictureUploaderWrapper",Za,[2]);
vm(f,v);f.prototype.hBj=function(){this.xkc=28E5;this.HRd(3)};f.prototype.Mad=function(Y){var Ra=this;pc.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");var zb=new FileReader;Y=Y.FE.files;0==Y.length?pc.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found."):(Y=Y[0],zb.onload=function(){Ra.j9b.stop();Ra.uBh.STi(zb.result,Ra);pc.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function.")},
zb.onerror=function(){Ra.j9b.stop();pc.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image.")},zb.onabort=function(){Ra.j9b.stop();pc.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image.")},this.j9b.start(),zb.readAsDataURL(Y))};f.prototype.finalizeUpload=function(Y,Ra){this.Mad(Y,Ra)};Object(Yc.a)(f,"FileReaderUploaderWrapper",v,[304]);m.prototype.getSheetName=function(){return this.sheetName};Object(Yc.a)(m,
"MacroRecorderPictureInsertedPayload",null,[106]);vm(n,v);n.prototype.Mad=function(Y,Ra){var zb=this;v.prototype.finalizeUpload.call(this,Y,Ra);ud.a(this.$.userOperationManager,function(gc,bd){zb.Br=gc;zb.naa=bd;zb.g_d.start();zb.C_b.Oq();zb.Pzc=!1;zb.oag(Y);return zb.X6i(Y)},function(gc){function bd(){return new m(Vd,zb.sDd?zb.sDd:"")}var Id={};zb.$.Bj(Id);var Vd=Id.SheetName;gc=Nc.EwaSettings.tc()?new cf.a(510,0,gc,72,bd):new Md.a(510,0,gc,8,bd);gc.tAa(function(){return!0});gc.de=zb.de;return gc},
this.de)};n.prototype.finalizeUpload=function(Y,Ra){this.Mad(Y,Ra)};Object(Yc.a)(n,"PictureUploaderWrapper",v,[]);Object(Yc.a)(l,"UploadBlobParameters",null,[]);vm(d,n);d.prototype.wWd=function(Y,Ra,zb){n.prototype.wWd.call(this,Y,Ra,zb);this.Q0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};d.prototype.lAc=function(Y,Ra,zb){n.prototype.lAc.call(this,Y,Ra,zb);kd.a.lh(Y.Errors)?this.Q0.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",
kd.a.Uc(Y.Errors)))):this.Q0.setResult(!0)};d.prototype.oag=function(Y){var Ra=new l(this.dec.name,this.dec);Y.N7f(Ra)};d.AHh=function(Y){var Ra=Y.split(",");Y=Ra[0].includes("base64")?window.self.atob(Ra[1]):window.self.decodeURI(Ra[1]);Ra=Ra[0].split(":")[1].split(";")[0];for(var zb=new Uint8Array(Y.length),gc=0;gc<Y.length;gc++)zb[gc]=Y.charCodeAt(gc);Y=new Blob([zb],{type:Ra});Y.name="Image.png";return Y};Object(Yc.a)(d,"DataUrlUploaderWrapper",n,[]);c.prototype.Wbi=function(Y,Ra,zb,gc,bd){new n(Y,
Ra,zb,gc,bd,!0)};c.prototype.Uai=function(Y,Ra,zb,gc,bd,Id){new d(Y,null,Ra,zb,gc,bd,Id)};c.prototype.fbi=function(Y,Ra,zb,gc,bd){new f(Y,Ra,zb,gc,bd,!0)};Object(Yc.a)(c,"UploaderCreator",null,[273]);var xi=xd.a;vm(a,xi);a.ka=function(Y){Y.da.Ha(485,new a(Y))};a.prototype.create=function(){var Y;this.Gb(null!==(Y=this.$.da.Aa(484))&&void 0!==Y?Y:this.$.da.Ha(484,new c))};Object(Yc.a)(a,"UploaderCreatorFactory",xd.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");
Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");vc.main();Type.registerNamespace("Common.App.InProductMessaging");je.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Qf.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(function(){di.a.Ga(function(Y){Wb.ka(Y)})})();(function(){di.a.Ga(function(Y){rd.ka(Y)})})();(function(){di.a.Ga(function(){di.a.Ga($a.ka)})})();(function(){di.a.Ga(function(){di.a.Ga(fc.ka)})})();
(function(){di.a.Ga(function(Y){Ob.ka(Y)})})();ue.a.Zi(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
di.a.Ga(ia.ka);di.a.Ga(D.ka);(function(){di.a.Ga(function(Y){I.ka(Y)})})();(function(){di.a.Ga(function(Y){a.ka(Y)})})()},989:function(y,F,b){function a(A){var x=this;this.businessBar=this.E7a=null;this.SHi=function(u,B){B.S6c?x.UHi(B):x.THi(B)};this.Mh=function(u,B){u=B.context.methodName;x.E7a&&u===x.E7a&&(l.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',x.E7a),x.Y7a(a.eJb,!0),
x.E7a=null);x.bnf(!1);x.U2b=!1};this.Kn=function(u,B){m.a.kh(B.errors,[-1387426400])&&!x.U2b&&(x.U2b=!0,x.J2f()&&window.performance.mark(a.fuf),(new c(x)).Hri())};this.Vg=function(){x.bnf(!0);x.Y7a(a.iCb,!1);x.Y7a(a.eJb,!1)};this.zya=function(){l.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");x.Y7a(a.iCb,!0)};this.$=A;this.na=this.$.na;this.localStorage=new v.a;this.U2b=!1;this.$.ea.Tm(this.Vg);
this.na.sf.pnb(this.zya);this.na.tq(this.Mh);this.$.da.Za(5,function(u){x.businessBar=u;u.dEg(x.SHi)});this.na.Jy(this.Kn)}function c(A){var x=this;this.ukd=[w.a.jig,w.a.BDc];this.Ko=function(u,B){x.jO[B]=u;x.K6h()&&x.tgj("OnNetworkDownImmediatePing"===u.caller)};this.Gla=A;this.$=A.$;this.jO={}}function d(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(F);y=b(0);var l=b(13),n=b(314),m=b(27),f=b(8),v=b(305);Object(y.a)(d,"ConnectionErrorLogInfo",null,[]);var w=b(1209),
t=b(1255);c.prototype.Hri=function(){var A=t.a.Lcd(this.Ko,"OnNetworkDownImmediatePing",this.$,this.ukd);A=yl(A);for(var x=A.next();!x.done;x=A.next())x.value.dMd()};c.prototype.K6h=function(){for(var A=yl(this.ukd),x=A.next();!x.done;x=A.next())if(x=x.value,void 0===this.jO[x]||null===this.jO[x])return!1;return!0};c.prototype.tgj=function(A){var x=this.$.sf.KV;A&&this.vHj(x);A=yl(this.ukd);for(var u=A.next();!u.done;u=A.next())u=u.value,this.jO[u]=Sys.Serialization.JavaScriptSerializer.serialize(this.jO[u]);
A=Date.now();u=this.Gla.uhd(b(989).NetworkConnectionHealthChecker.iCb).returnValue;var B=this.Gla.uhd(b(989).NetworkConnectionHealthChecker.eJb).returnValue;this.jO.isOfflineMode=x;this.jO.networkDownBBAge=-1===u?u:A-u;this.jO.transientServerCommunicationFailuresBBAge=-1===B?B:A-B;this.Gla.businessBar?(this.jO.isNetworkDownBBShown=this.Gla.businessBar.cC(54).toString(),this.jO.isServerErrorBBShown=this.Gla.businessBar.cC(21).toString()):(this.jO.isNetworkDownBBShown="unknown",this.jO.isServerErrorBBShown=
"unknown");l.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",Sys.Serialization.JavaScriptSerializer.serialize(this.jO))};c.prototype.vHj=function(A){for(var x=b(989).NetworkConnectionHealthChecker,u={},B=yl(Object.keys(this.jO)),r=B.next();!r.done;r=B.next())r=this.jO[r.value],u[r.testName]=r.isSuccess;u.isOfflineMode=A;this.Gla.MTd(x.i2c,Sys.Serialization.JavaScriptSerializer.serialize(u))};Object(y.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(F,"NetworkConnectionHealthChecker",
function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.Kq(this.Vg),this.na&&(this.na.sf.jHb(this.zya),this.na.Dz(this.Kn),this.na.xr(this.Mh)))};a.prototype.UHi=function(A){var x={};x.Timestamp=Date.now().toString();switch(A.YZa){case 21:this.E7a=A.data.FailedMethod;x.FailedMethod=this.E7a;this.MTd(a.eJb,JSON.stringify(x));break;case 54:this.MTd(a.iCb,JSON.stringify(x))}};a.prototype.THi=function(A){switch(A.YZa){case 21:this.Y7a(a.eJb,!0);break;case 54:this.Y7a(a.iCb,
!0)}};a.prototype.MTd=function(A,x){try{this.localStorage.rg()&&this.localStorage.setItem(A,x)}catch(u){l.ULS.sendTraceTag(537155231,0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",u.message||"Unknown")}};a.prototype.uhd=function(A){if(this.localStorage.rg()&&(A=this.localStorage.N3a(A))&&"null"!==A){var x=JSON.parse(A);A=parseInt(x.Timestamp,10);x=Sys.Serialization.JavaScriptSerializer.serialize(x);return{returnValue:A,rawData:x}}return{returnValue:-1,
rawData:null}};a.prototype.bnf=function(A){if(this.localStorage.rg()){var x=this.localStorage.N3a(a.i2c);if(x&&"null"!==x){var u=-1;this.U2b&&(u=this.jPh(a.fuf,a.DGi));l.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(x),u,A);this.localStorage.removeItem(a.i2c)}}};a.prototype.jPh=function(A,x){if(!this.J2f())return-1;window.performance.measure(x,
A);A=window.performance.getEntriesByName(x);return A.length&&A[A.length-1]?A[A.length-1].duration:(l.ULS.sendTraceTag(537155228,0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",x),-1)};a.prototype.Y7a=function(A,x){try{var u=this.uhd(A);var B=u.rawData;var r=u.returnValue;if(-1!==r){var I=Object.assign(new d,{timeElapsed:Date.now()-r,scenario:A,isNewSession:!x,rawData:B});l.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",
JSON.stringify(I))}this.localStorage.removeItem(A)}catch(z){l.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",z.message||"Unknown")}};a.prototype.J2f=function(){return f.HelperMethods.AYc&&n.a.Qob};a.iCb="NetworkDownBBShown";a.eJb="ServerCommunicationFailureBBShown";a.i2c="ConnectionHealthPingRsults";a.fuf="offMoStMa";a.DGi="offMoDuMea";Object(y.a)(a,"NetworkConnectionHealthChecker",null,[2])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/b7019f0b299a1641815aff208a5cda70/EwaDS.pi.js.map