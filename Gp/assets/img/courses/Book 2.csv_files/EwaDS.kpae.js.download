(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1043:function(y,F,b){function a(f,v){var w=m.call(this,v.textBox.domElement)||this;w.xXc=null;w.EHi=function(){w.ezd()};w.uxf=function(t,A){w.Jg(t,A)};w.Axf=function(t,A){w.ej(t,A)};w.vb=f;w.cJ=v;v.yY&&(v.yY.add(w),v.Xl(w.Axf),v.Lo(w.uxf));return w}b.d(F,"a",function(){return a});y=b(0);var c=b(88);F=b(83);var d=b(44),l=b(42),n=b(69),m=F.a;vm(a,m);a.prototype.dispose=function(){var f=this.cJ;if(null===f||void 0===f?0:f.yY)f.yY.remove(this),
f.nl(this.Axf),f.Mn(this.uxf);c.a.Fa(this.xXc);this.cJ=null;m.prototype.dispose.call(this)};a.prototype.Qh=function(f,v){switch(v){case -1470715894:case -1231471547:this.oU(!1);break;default:if(this.AFd(f,v))return n.g(f),!0;a.Xki(v)||this.oU(!1)}return!1};a.prototype.oU=function(){c.a.Fa(this.xXc);this.xXc=d.a.instance.create(this.EHi,10,l.a.cti)};a.prototype.ej=function(){this.oU(!1)};a.Xki=function(f){switch(f){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};Qk.Object.defineProperties(a.prototype,
{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.cJ}}});Object(y.a)(a,"ListAutoCompleteBehavior",F.a,[492,2])},1187:function(y,F,b){function a(t){var A=w.call(this,document.createElement("div"))||this;A.kIa=!1;A.lIa=!1;A.jIa=!1;A.hIa=!1;A.iIa=!1;A.vR=!1;A.cJ=null;A.Ymc=function(x,u){A.ht(x,u)};A.mLa=function(){A.Ya.textBox.mK=!0};A.Eya=function(){A.Ly(!0)};A.Yuf=function(){A.Ya.textBox.focus()};A.Lh=function(){m.g(A.$).inRangePicker||
(A.isListVisible=!1)};A.$=t;m.g(t)&&m.g(t).ha&&m.g(A.$).ha.HG(A.Lh);A.mba=d.a.iN(t)&&l.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");return A}b.d(F,"a",function(){return a});y=b(0);F=b(230);var c=b(4),d=b(39),l=b(1),n=b(8),m=b(19),f=b(34),v=b(5),w=F.a;vm(a,w);a.prototype.ht=function(){this.yBa(!1);this.Ft.ht()};a.prototype.dispose=function(){this.$&&m.g(this.$)&&m.g(this.$).ha&&m.g(this.$).ha.fO(this.Lh);this.$=null;w.prototype.dispose.call(this)};a.prototype.Qh=
function(t,A,x){t=!1;if((this.H0a||(void 0===x?0:x))&&!this.Kwa()&&this.get_visible()&&this.isListVisible)switch(this.mba&&this.VAc(A),A){case 1872288872:this.isListVisible=!1;t=!0;break;case -798660877:this.Ft.iB(1);t=!0;break;case 137938150:this.Ft.iB(-1);t=!0;break;case 2091832999:this.Ft.iB(this.$H-1);t=!0;break;case 742457698:this.Ft.iB(-(this.$H-1));t=!0;break;case 125627505:t=this.Ly(!1);break;case 267796030:l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",
!1)&&(t=this.Ly(!1))}return t};a.prototype.yBa=function(t){if(this.isListVisible||t){var A=m.g(this.$);t=A.domElement;var x=this.cJ.textBox.domElement,u=f.a(this.$).Hi(x.offsetHeight),B=f.a(this.$).Hi(x.offsetTop),r=f.a(this.$).Hi(x.offsetWidth);x=f.a(this.$).Hi(x.offsetLeft);A=A.Cj;var I=v.AFrameworkApplication.sa&&v.AFrameworkApplication.sa.Qa.ph,z=$get(this.$.Jb+c.a.L_a,this.$.domElement);I&&(z=document.getElementById("EditorContainer"));var D=new Sys.UI.Point(A?this.Ft.i$b:0,A?this.SFh:a.Y2h);
u=z.offsetTop+D.y+(d.a.oN(this.$)&&A?0:u+B);this.$.j5||(B=$get(c.a.$Fa,this.$.domElement),u+=B&&!I?B.offsetHeight:0);B=this.domElement;B.style.top=n.HelperMethods.Rb(u);x=z.offsetLeft+x+D.x;!d.a.oN(this.$)&&this.$.isChromeRtl?B.style.right=n.HelperMethods.Rb(A?this.Ft.i$b:t.offsetLeft+t.offsetWidth-x-r):B.style.left=n.HelperMethods.Rb(x)}};a.prototype.FSa=function(t){this.Ft&&(t&&!this.vR?(this.Ft.I9(this.Yuf),this.Ft.NYb(this.mLa),this.Ft.wnb(this.Eya),this.vR=!0):this.vR&&(this.Ft.ida(this.Yuf),
this.Ft.wsc(this.mLa),this.Ft.oHb(this.Eya),this.vR=!1))};a.prototype.VAc=function(t){switch(t){case -798660877:case 137938150:case 2091832999:case 742457698:this.kIa=!0;break;case 125627505:this.jIa=!0;break;case 267796030:l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.hIa=!0)}};Qk.Object.defineProperties(a.prototype,{$H:{configurable:!0,enumerable:!0,get:function(){return this.Ft.$H}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Ft.isListVisible},
set:function(t){this.Ft.isListVisible=t}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.cJ},set:function(t){(this.cJ=t)&&this.cJ.lOb.add(this)}},SFh:{configurable:!0,enumerable:!0,get:function(){return d.a.oN(this.$)?-5:-40}}});a.i$b=0;a.Y2h=1;Object(y.a)(a,"AutoCompleteControl",F.a,[415])},1188:function(y,F,b){function a(d,l,n,m){l=void 0===l?0:l;n=void 0===n?"":n;m=void 0===m?"":m;var f=c.call(this)||this;f.length=d;f.selectedIndex=l;f.vI=n;f.description=m;return f}b.d(F,"a",function(){return a});
y=b(0);var c=Sys.EventArgs;vm(a,c);Object(y.a)(a,"ListEventArgs",Sys.EventArgs,[])},1189:function(y,F,b){function a(B,r){B=u.call(this,B,r,new x.a(l.a.listItem,l.a.RAb,l.a.UAb,l.a.VAb))||this;B.Acc=!1;B.$r=null;B.qlb=null;B.QVe=!1;B.RAa(!0);B.QVe=w.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");return B}b.d(F,"a",function(){return a});y=b(0);var c=b(13),d=b(23);F=b(977);var l=b(902),n=b(4),m=b(77),f=b(39),v=b(11),w=b(1),t=b(118),A=b(19),x=b(1042),u=F.a;vm(a,u);a.prototype.Xxa=
function(){var B=460,r=A.g(this.$),I=r.domElement,z=this.bTa.style,D=this.gg.offsetTop+this.Lk.offsetHeight*this.Lk.sectionRowIndex-this.gg.scrollTop;z.width="auto";z.whiteSpace="nowrap";z.position=d.a.vgc?"relative":"absolute";var V=I.offsetLeft+I.offsetWidth-(this.domElement.offsetLeft+this.gg.offsetLeft+this.gg.offsetWidth+3);I=this.domElement.offsetLeft-3-(I.offsetLeft+this.i$b);B=Math.min(this.bTa.offsetWidth,B,Math.max(V,I));v.DOMElementExtensions.Tq(this.bTa,B);z.whiteSpace="";z.position="absolute";
D+3>this.gg.offsetTop+this.gg.offsetHeight||D<this.gg.offsetTop||(B=this.gg.offsetLeft-3-this.bTa.offsetWidth,z=this.gg.offsetLeft+this.gg.offsetWidth+3,v.DOMElementExtensions.updatePosition(this.bTa,I>V!==r.rtl?B:z,D,!1))};a.prototype.iB=function(B){u.prototype.iB.call(this,B);this.Xxa()};a.prototype.ht=function(){this.Xxa()};a.prototype.Mra=function(){var B=this.Gn,r=this.gg,I=3===m.a.dc||d.a.Wp,z=I?this.FBb:this.$H;this.isListVisible=!0;r.style.height="auto";this.jGa.set_visible(!0);this.$mb(B,
I);this.$r.length>z?(v.DOMElementExtensions.nG(r,Math.floor(r.offsetHeight*z/this.$r.length)),r.style.overflowY="auto"):(r.style.height="auto",r.style.overflowY="hidden");v.DOMElementExtensions.Tq(r,B.offsetWidth+(this.$r.length>z?t.a.fq:0))};Qk.Object.defineProperties(a.prototype,{i$b:{configurable:!0,enumerable:!0,get:function(){if(f.a.oN(this.$)){var B=document.getElementById(this.$.Jb+n.a.PVe);return!this.QVe||B?v.DOMElementExtensions.getBoundingClientRect(B).x:0}B=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",
!1)?document.getElementById(n.a.Zwd):document.getElementById(this.$.Jb+n.a.Zwd+"-"+n.a.Nrf);c.ULS.shipAssertTag(537170323,0,!!B||this.$.mR,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return B?B.offsetWidth:0}},re:{configurable:!0,enumerable:!0,get:function(){return this.qlb},set:function(B){this.qlb=B}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return v.DOMElementExtensions.isVisible(this.gg)&&0<this.$r.length},set:function(B){v.DOMElementExtensions.setVisible(this.gg,
B);v.DOMElementExtensions.setVisible(this.bTa,B);var r=A.g(this.$).view;B?this.Acc||(r.Ls(this.jGa.Ymc),this.Acc=!0):(Array.clear(this.$r),this.Acc&&(r.Mq(this.jGa.Ymc),this.Acc=!1))}}});Object(y.a)(a,"AutoCompleteListBox",F.a,[])},1238:function(y,F,b){function a($b,Wb,lc,Oa){var qb=rd.call(this,$b,"PopulateGridContextMenu",1247109494,-2064931494,a.K2h,!0,!1,a.$Hb,Wb,lc,!0,Oa)||this;qb.EAa=!1;qb.Wva=!1;qb.lZ=!1;qb.refresh=!1;qb.expandCollapse=!1;qb.Yhc=!1;qb.rEe=!0;qb.grid=eb.g($b);qb.Jkc=!0;qb.rnd=
Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(qb.rnd){var Ub=hc.GetServiceTaskFactory.Wa(qb.$.da,309,310,3),jc=hc.GetServiceTaskFactory.create(qb.$.da,18,qb.ma,3);pa.TaskExtensions.Ba(pa.TaskExtensions.we([Ub,jc],qb.ma),function(){qb.$.da.Za(268,function(Kb){qb.t4a=new c($b,Ub.result,jc.result,Kb)})},qb.ma,3)}return qb}function c($b,Wb,lc,Oa){this.zWc=this.eeb=this.geb=0;this.$=$b;this.gridView=eb.g(this.$);this.namedSheetViewPublic=Wb;this.Fh=lc;
this.instantaneousSupportInformationManager=Oa;this.xMa=Za.a.Omd()}function d($b){this.ranges=null;this.ranges=$b}function l($b,Wb,lc,Oa,qb,Ub,jc,Kb){this.$=Wb;this.Sa=lc;this.km=Oa;this.selectedRanges=qb;this.grid=Ub;this.uB=Kb;this.iba=jc;this.Rra=w.a.all(qb,function(dc){return dc.isRow});this.Qra=w.a.all(qb,function(dc){return dc.Rh});this.sCb=w.a.all(qb,function(dc){return!dc.isRow&&!dc.Rh});Wb=Ub.Sb.khd(qb);this.i4b=!!Wb;this.nSf=!!Wb&&Wb.hasActiveFilter;this.menuSection=lc.Nc();Array.add($b.Ac,
this.menuSection);this.ska=this.Rra||this.Qra?this.menuSection:lc.Nc();this.Cta=this.Rra||this.Qra?this.menuSection:lc.Nc()}b.r(F);y=b(0);var n=b(13),m=b(268),f=b(97),v=b(47),w=b(309),t=b(571),A=b(5),x=b(84),u=b(411),B=b(842),r=b(9),I=b(28),z=b(16),D=b(58),V=b(4),U=b(922),Q=b(1169),la=b(976),ba=b(14);l.prototype.Fcd=function(){this.OHh();this.tHh();var $b=this.uB.R6a(this.selectedRanges,this.grid);Array.add(this.menuSection.buttons,this.Sa.Bb($b?149:148))};l.prototype.THh=function(){var $b=0;this.i4b?
this.iba.Fn(942362098)?$b=this.uB.Fn(this.km,942362098,this.selectedRanges,this.grid)?161:169:this.nSf&&($b=this.uB.Fn(this.km,-1113896058,this.selectedRanges,this.grid)?177:181):this.iba.Fn(-1113896058)&&($b=this.Rra?this.uB.Fn(this.km,-1113896058,this.selectedRanges,this.grid)?49:116:this.uB.Fn(this.km,-1113896058,this.selectedRanges,this.grid)?177:181);0!==$b&&Array.add(this.ska.buttons,this.Sa.Bb($b))};l.prototype.PHh=function(){var $b=0;this.i4b?this.iba.Fn(622604322)&&($b=this.grid.rtl?this.uB.Fn(this.km,
622604322,this.selectedRanges,this.grid)?191:192:this.uB.Fn(this.km,622604322,this.selectedRanges,this.grid)?162:170):this.iba.Fn(1415868706)&&($b=this.Qra?this.uB.Fn(this.km,1415868706,this.selectedRanges,this.grid)?50:117:this.uB.Fn(this.km,1415868706,this.selectedRanges,this.grid)?178:182);0!==$b&&Array.add(this.ska.buttons,this.Sa.Bb($b))};l.prototype.NHh=function(){this.iba.Fn(1035996630)&&(this.uB.Fn(this.km,1035996630,this.selectedRanges,this.grid)?(Array.add(this.ska.buttons,this.Sa.Bb(this.grid.rtl?
187:165)),Array.add(this.ska.buttons,this.Sa.Bb(166))):(Array.add(this.ska.buttons,this.Sa.Bb(this.grid.rtl?188:173)),Array.add(this.ska.buttons,this.Sa.Bb(174))))};l.prototype.OHh=function(){var $b=b(1238).GridContextMenu,Wb=null;this.sCb&&(Wb=this.Sa.Wv("ContextMenu.InsertCells",null,ba.a.instance.fa(346),1896159024),Array.add(Wb.menu.Ac,this.ska));$b.QHh(this.ska,this.Sa,this.$);this.THh();this.PHh();this.NHh();Wb&&0<this.ska.buttons.length&&Array.add(this.menuSection.buttons,Wb)};l.prototype.vHh=
function(){var $b=0;this.i4b?this.iba.Fn(1405456548)?$b=this.uB.Fn(this.km,1405456548,this.selectedRanges,this.grid)?163:171:this.nSf&&($b=this.uB.Fn(this.km,1554436520,this.selectedRanges,this.grid)?179:183):this.iba.Fn(1554436520)&&($b=this.Rra?this.uB.Fn(this.km,1554436520,this.selectedRanges,this.grid)?51:118:this.uB.Fn(this.km,1554436520,this.selectedRanges,this.grid)?179:183);0!==$b&&Array.add(this.Cta.buttons,this.Sa.Bb($b))};l.prototype.uHh=function(){var $b=0;this.i4b?this.iba.Fn(284490184)&&
($b=this.uB.Fn(this.km,284490184,this.selectedRanges,this.grid)?164:172):this.iba.Fn(674605324)&&($b=this.Qra?this.uB.Fn(this.km,674605324,this.selectedRanges,this.grid)?52:119:this.uB.Fn(this.km,674605324,this.selectedRanges,this.grid)?180:184);0!==$b&&Array.add(this.Cta.buttons,this.Sa.Bb($b))};l.prototype.sHh=function(){this.iba.Fn(1035996630)&&(this.uB.Fn(this.km,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Cta.buttons,this.Sa.Bb(this.grid.rtl?189:167)),Array.add(this.Cta.buttons,
this.Sa.Bb(168))):(Array.add(this.Cta.buttons,this.Sa.Bb(this.grid.rtl?190:175)),Array.add(this.Cta.buttons,this.Sa.Bb(176))))};l.prototype.tHh=function(){var $b=null;this.sCb&&($b=this.Sa.Wv("ContextMenu.DeleteCells",null,ba.a.instance.fa(406),-1554384558),Array.add($b.menu.Ac,this.Cta));this.vHh();this.uHh();this.sHh();$b&&0<this.Cta.buttons.length&&Array.add(this.menuSection.buttons,$b)};Object(y.a)(l,"CellsContextMenuGenerator",null,[]);Object(y.a)(d,"MacroRecorderRangeHyperlinkRemovedPayload",
null,[106]);var S=b(553),H=b(24),T=b(96),K=b(77),da=b(73),fa=b(43),W=b(164),ca=b(81),ia=b(650),ea=b(39),qa=b(141),pa=b(35),Pa=b(575),Ha=b(578),Ya=b(1),Na=b(175),eb=b(19),Ia=b(372),lb=b(34),hc=b(56),ma=b(236),Ja=b(20),Ta=b(29),pb=b(1180),Db=b(1041),fb=b(126),xa=b(521),ya=b(369),Ga=b(154),db=b(148),Ob=b(339),Ec=b(92),wb=b(27),kb=b(303),vb=b(272),Gb=b(127),Za=b(900),ub=b(901),fc=b(135),$a=b(40),nb=b(52),sc;(function($b){$b[$b.none=0]="none";$b[$b.once=1]="once";$b[$b.twice=2]="twice"})(sc||(sc={}));
Object(y.b)("ToggleState",sc);c.prototype.ahh=function(){var $b=this.fV(),Wb={};$b=(Wb.CommandValueId=$a.c($b),Wb);Wb=new Ec.a(-2058042992,2,this.$.hd,19,null);n.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Yb(Wb,$b)};c.prototype.rhh=function(){var $b=new Ec.a(644342024,2,this.$.hd,19,null);n.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");
return this.$.Ka.Yb($b)};c.prototype.ghh=function(){var $b=this.gridView.ha.va.activeCell,Wb=this.$.da.Aa(66).Lg;return Wb?this.ihh(Wb,$b):this.hhh($b)};c.prototype.ihh=function($b,Wb){if(this.RWg($b,Wb))return n.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),nb.Task.Ta(!1);if($b.hasAutoFilter)return this.geb=sc.none,this.xWc();this.geb=sc.once;return this.E6b(sc.once)};c.prototype.hhh=function($b){var Wb=fa.v(this.gridView.ha.va.Td,
this.$);Wb=this.gridView.$.xa.getItemByName(Wb.SheetName);var lc=fa.D(Wb.F0);if(this.QWg(lc,$b))return n.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),nb.Task.Ta(!1);if(Wb.hasAutoFilter){if(lc&&lc.contains(this.gridView.ha.va.activeCell))return this.geb=sc.none,this.xWc();this.geb=sc.twice;return this.E6b(sc.twice)}this.geb=sc.once;return this.E6b(sc.once)};c.prototype.E6b=function($b){function Wb(Kb){kb.a(Kb)?
n.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",wb.a.Uc(Kb.Errors)):(n.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),$b===sc.twice?Oa.E6b(sc.once):Oa.xWc())}function lc(){return new pb.a(qb)}var Oa=this,qb=fa.v(this.gridView.ha.va.Td,this.$);if(!qb)return nb.Task.Ta(!1);this.eeb||(this.eeb=Date.now());var Ub=new Ec.a(368460465,2,this.$.hd,19,null),jc=this.$.na.ta.$b();return Ya.EwaSettings.tc()?
ya.a(this.$.userOperationManager,function(Kb,dc,Qb){return ca.kb(Oa.$.na.ta,qb,vb.b(Kb,Wb),dc,Qb,null,jc)},function(Kb){return new W.a(516,0,Kb,64,lc)},Ub):ya.a(this.$.userOperationManager,function(Kb,dc,Qb){return ca.kb(Oa.$.na.ta,qb,vb.b(Kb,Wb),dc,Qb,null,jc)},function(Kb){return new xa.a(516,0,Kb,void 0,lc)},Ub)};c.prototype.RWg=function($b,Wb){return Ga.d($b)&&Wb.top===$b.usedRange.top?(this.Iqc(this.$,224),!0):Ga.g($b)&&Wb.top===$b.usedRange.bottom?(this.Iqc(this.$,225),!0):!1};c.prototype.QWg=
function($b,Wb){if($b&&$b.contains(Wb)&&Wb.top===$b.top||!$b&&this.SVg(Wb.top,Wb.left))return this.Iqc(this.$,226),!0;$b=new H.Range(Wb.top,Wb.left,Wb.top+1,Wb.left+1,!1,!1);return this.gridView.Sb.ohc($b)?(this.Iqc(this.$,227),!0):!1};c.prototype.Iqc=function($b,Wb){Wb=wb.a.jd(1,1,738,Wb,0,147079615,"ContextMenuFilterByCellValueError");Ya.EwaSettings.nz()?new Ob.a($b,Wb):($b=new db.ErrorDialog($b,Wb),$b.initialize(),$b.mf())};c.prototype.xWc=function(){function $b(Kb){var dc={};dc=(dc.ToggleFilterOperationCount=
Wb.geb,dc.ApplyFilterTime=Wb.zWc?Date.now()-Wb.zWc:-1,dc.ToggleAndApplyFilterTime=Wb.eeb?Date.now()-Wb.eeb:-1,dc.FilterByValueType=Oa.AutoFilterType,dc);n.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(dc));Wb.eeb&&(Wb.eeb=0);Za.a.Xwc(Kb)&&(dc=Za.a.N$b(Kb),Wb.xMa?Za.a.rQa(ub.a.filterByCellValue,dc.MessageIdName,fc.a.fsa,!0,Za.a.isSessionEndingError(dc.MessageId)):n.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",
dc.MessageIdName));kb.a(Kb)?n.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",wb.a.Uc(Kb.Errors)):(n.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Gb.b(Wb.$).fe(fb.a.zyf,Wb.fm(),void 0,!0),Kb={},Kb.FirstRow=Wb.kQh(),Kb.FirstColumn=Oa.Column,-1!==Kb.FirstRow&&(Kb=fa.C(Kb),Wb.JL(Kb)))}var Wb=this;this.zWc=Date.now();var lc=this.e1h();if(!lc)return n.ULS.sendTraceTag(527500296,0,50,
"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),nb.Task.Ta(!1);var Oa=this.fV(),qb={FirstRow:0};qb.FirstColumn=Oa.Column;qb.SheetName=Oa.SheetName;Gb.b(this.$).fe(fb.a.Nuf,this.fm(),void 0,!0);var Ub=this.n3c(Oa,qb),jc=new W.a(208,0,function(Kb,dc,Qb){return ca.a(Wb.$.na.ta,Ub,lc,vb.b(Kb,$b),dc,Qb,null,null)},6,function(){return new Db.a(lc,Ub)});this.namedSheetViewPublic?this.namedSheetViewPublic.GAa().continueWith(function(Kb){Kb.result&&Wb.$.userOperationManager.ic(jc,
null)}):this.$.userOperationManager.ic(jc,null);return nb.Task.Ta(!0)};c.prototype.JL=function($b){(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?ea.a.Mka(this.$):Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&pa.TaskExtensions.Ba(hc.GetServiceTaskFactory.Wa(this.$.da,430,431,1),function(Wb){Wb.result.tea($b);n.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.ma,3)};c.prototype.fm=function(){var $b={};return $b.Location="contextMenu",$b};c.prototype.fV=function(){var $b=0,Wb=this.$.da.Aa(66).Lg;if(Wb){var lc="Table";$b=Wb.objectId}else lc="Sheet";var Oa=this.gridView.ha.va.activeCell.left;Wb={};Wb.AutoFilterType=lc;Wb.Column=Oa;Wb.Id=$b;lc={};this.$.Bj(lc);lc.FirstRow=0;lc.FirstColumn=Wb.Column;$b=this.$.ea.isNamedObjectViewMode;Wb.NamedObjectView=$b;Wb.SheetName=$b?lc.NamedObjectName:lc.SheetName;Wb.ItemListOptions=null;return Wb};c.prototype.SVg=
function($b,Wb){$b=H.Range.ld($b,Wb);return this.gridView.Ca.f$($b,this.$.pa.name)&&($b=this.gridView.Ca.R3a($b))&&$b.autoFilterMenu?!0:!1};c.prototype.e1h=function(){var $b=null,Wb=this.gridView.wc(this.gridView.ha.va.activeCell);if(!Wb)return null;var lc=Wb.cell.eTd;var Oa=this.instantaneousSupportInformationManager.Beb(lc,!1).category;if(1===Wb.RI.type)if(3===Oa){if(!Wb.cell.X8a)return n.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",
Oa),null;$b=(Wb.cell.X8a.Start+Wb.cell.X8a.End).trim()}else if(!Oa&&(Ja.a.m0a(Wb.RI.value,"E")||Ja.a.m0a(Wb.originalText,"E"))){$b=this.Fh.xFh(Wb.RI.value,lc,Wb.cell.lia);if(!$b.success)return n.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",Oa),null;$b=$b.iH}$b||($b=Wb.originalText);return Ta.a.$_c($b)?["[Blanks]"]:["i"+$b.trim()]};c.prototype.kQh=function(){var $b=this.$.da.Aa(66).Lg;if($b)return $b.usedRange.top;
$b=this.$.xa.getItemByName(this.$.pa.sheetName);return($b=fa.D($b.F0))&&$b.contains(this.gridView.ha.va.activeCell)?$b.top:-1};c.prototype.n3c=function($b,Wb){var lc={};lc.Location=Wb;lc.FieldId=$b.Id.toString();lc.DataSourceIndex=-1;lc.FilterType=$b.AutoFilterType;lc.AnchorType=0;lc.ChartId=null;lc.AnchorValue1=-1;lc.AnchorValue2=-1;lc.Property=$b.RichProperty;return lc};Object(y.a)(c,"GridContextMenuFilter",null,[]);b.d(F,"GridContextMenu",function(){return a});var rd=B.a;vm(a,rd);a.prototype.dispose=
function(){rd.prototype.dispose.call(this);this.grid=null};a.prototype.Zc=function($b,Wb){$b=!this.eqd($b,Wb);if(!$b)switch(Wb){case -1977666927:$b=null==this.t4a||this.Nxj();break;case 1549396389:$b=null==this.t4a||this.Txj();break;case 1803952894:$b=null==this.t4a||!this.$.isEditMode&&!this.Bgi()}return $b};a.prototype.eqd=function($b,Wb){var lc=this.grid.ha.va.selectedRanges;return(new qa.a(this.$.xa)).Fn($b,Wb,lc,this.grid)};a.prototype.executeCommand=function($b,Wb,lc){var Oa=Wb.command;$b=null;
switch(Oa){case -1396319072:if(Wb=this.grid.wc(null))m.a.instance.QZc(!0),f.EventHandlerManager.instance.Sbd(),a.aWi(Wb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.va.selectedRanges,Wb);break;case 324156914:$b=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(lc);break;case -1977666927:$b=this.t4a.ahh();break;case 1549396389:$b=this.t4a.rhh();break;case 1803952894:$b=this.t4a.ghh();break;default:$b=Na.a(Oa)}return $b||pa.TaskExtensions.D4()};a.prototype.Kc=
function($b,Wb,lc){$b=!1;switch(Wb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:$b=!0;break;case 1441131127:$b=!!lc}return $b};a.prototype.VY=function($b){$b=void 0===$b?!1:$b;var Wb=!1,lc=!1,Oa=0;Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Oa=v.a.xe());var qb=this.Sa.Kp(this.menuId),Ub=this.grid.ha.va,jc=Ub.qh,Kb=jc&&Ub.Td.Rh,dc=jc&&Ub.Td.isRow;Ub=Ub.selectedRanges;var Qb=w.a.all(Ub,
function(ta){return ta.Rh}),O=w.a.all(Ub,function(ta){return ta.isRow}),Ba=fa.O(Ub),ra=fa.P(Ub);this.wgf(Kb,dc)?(Wb=!0,this.vIh(qb)):this.$.isEditMode?Ia.a(this.$)?this.wIh(qb,Kb,dc):(this.wHh(qb,!(dc||Kb||!this.Yhc)),this.RHh(qb,Ub,$b),this.HHh(qb,Qb,O,Ba,ra),this.YWe(qb,jc,Kb,dc),this.OIh(qb),this.zWe(qb,Kb,dc),this.mIh(qb,jc,Kb,dc,Ub),this.zHh(qb),this.xHh(qb,Ub),this.YHh(qb),this.JIh(qb,jc),Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.LHh(qb)):(lc=!0,
Ia.a(this.$)?this.SWe(qb):this.dJh(qb,jc,Kb,dc,Ub));Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&($b=v.a.xe()-Oa,n.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",$b,Wb,lc,this.rEe));this.rEe=!1;return qb};a.prototype.bKa=function($b){var Wb=[];if(Ia.a(this.$))return Wb;if(3===$b){$b=this.grid.ha.va;var lc=$b.qh,Oa=lc&&$b.Td.Rh,qb=lc&&$b.Td.isRow,Ub=
!1,jc=!1,Kb=!1;this.$.isMobileMode&&(jc=$b.selectedRanges,Ub=fa.O(jc),jc=fa.P(jc));if(lc){var dc=eb.e(this.grid);dc&&dc.range.contains($b.Td)&&this.JV(dc)&&(Kb=!0)}this.$.isEditMode?this.wgf(Oa,qb)?Array.addRange(Wb,[la.a.LHf,la.a.NHf]):Oa||qb?(Array.add(Wb,la.a.clipboard),qb?Array.add(Wb,la.a.akj):Oa&&Array.add(Wb,la.a.p_g)):(Array.addRange(Wb,[la.a.edit,la.a.clipboard]),Kb?Array.add(Wb,la.a.hyperlink):Array.add(Wb,la.a.color),lc&&Array.add(Wb,la.a.dNg)):(Array.add(Wb,la.a.copy),Kb&&Array.add(Wb,
la.a.openHyperlink),!qb||this.$.isMobileMode&&jc?!Oa||this.$.isMobileMode&&Ub||Array.add(Wb,la.a.qXj):Array.add(Wb,la.a.rXj));Array.add(Wb,la.a.B2h)}else 2===$b&&Array.add(Wb,la.a.zxe);return Wb};a.prototype.wgf=function($b,Wb){return(this.EAa||this.Wva||this.lZ||this.refresh||this.expandCollapse)&&!($b||Wb)};a.prototype.showGridContextMenu=function($b){this.expandCollapse=this.refresh=this.lZ=this.Wva=this.EAa=!1;var Wb=this.$,lc=Pa.a(Wb).pKa(),Oa=this.grid.ha.va,qb=Oa.qh,Ub=qb&&Oa.Td.Rh;Oa=qb&&
Oa.Td.isRow;if(lc&&!Ub&&!Oa){Ub=Ha.a(Wb);if(null===Ub||void 0===Ub?0:Ub.xQd)this.EAa=Ub=T.f(Wb.lg),this.Wva=!Ub;Ub=Wb.oc;this.lZ=lc.supportsBIExplore&&!!U.a(Wb)&&Ub.I2(32768);Ub.allowInteractivity&&(Wb=this.grid.wc(null),(null===Wb||void 0===Wb?0:Wb.cell)&&(Wb.cell.FZc||Wb.cell.e3f)&&(this.expandCollapse=!0),Ub.allowManualDataRefresh&&(this.refresh=!0))}Wb=null;lc=1;Ub=Object(x.a)(t.a,$b.eventArgs);$b=Object(x.a)(Q.a,$b.creationParams);Oa=this.oNh();$b?(Wb=$b.clientPoint,lc=$b.inputMethod):Ub&&1!==
Ub.yb?(Wb=new Sys.UI.Point(Ub.clientPoint.x,Ub.clientPoint.y),lc=Ub.yb):Oa&&(Wb=new Sys.UI.Point(Oa.x+(this.$.isChromeRtl?0:Oa.width),Oa.y+Oa.height));K.a.dc=lc;this.Yhc=3===lc;$b=I.a.btb;this.Do(Wb,!Ub||Ub.Ea.target.className!==$b,lc)};a.prototype.removeHyperlinksFromRange=function($b,Wb){var lc=this;if(!Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Ms($b,!0)){var Oa=fa.r($b,this.$),qb=this.$.na.ta.$b();this.$.userOperationManager.ic(new W.a(125,
0,function(Ub,jc,Kb){lc.$.ny();return ca.c(lc.$.na.ta,Oa,"","",!0,!1,127,Ub,jc,Kb,null,qb)},void 0,function(){return new d(Oa)}),Wb);this.grid.Gh.VG(!1)}};a.prototype.oNh=function(){var $b=this.grid.wc(null);if((null===$b||void 0===$b?0:$b.cell.hk)&&this.Hff($b))return this.grid.getCellBounds($b.cell);$b=this.grid.ha.va.activeCell;return($b=this.w9b(new H.Range($b.top,$b.left,r.a.Kh,$b.left,!1,!1),2,!0)||this.w9b(new H.Range(1,$b.left,$b.top,$b.left,!1,!1),2,!1)||this.w9b(new H.Range($b.top,$b.right,
$b.top,r.a.Wh,!1,!1),1,!0)||this.w9b(new H.Range($b.top,1,$b.top,$b.right,!1,!1),1,!1)||null)&&$b.hk?this.grid.getCellBounds($b):Sys.UI.DomElement.getBounds(this.grid.U4a.Kb)};a.prototype.Hff=function($b){var Wb=this.grid.rtl,lc=this.$.isChromeRtl;$b=$b.cell;var Oa=eb.g(this.$).YJ($b);return Oa?(Oa=Oa.topLeft,Wb=Oa.x+=Wb===lc?$b.offsetWidth:0,lc=Oa.y+=$b.offsetHeight,this.grid.view.visibleArea.contains(new D.a(Wb,lc,0,0))):!1};a.prototype.w9b=function($b,Wb,lc){$b=this.grid.wl("GridContextMenu.FindFirstCellInViewportArea",
$b,Wb,lc);try{for($b.$$rst();$b.$$mn();){var Oa=$b.$$cu();if(Oa&&this.Hff(Oa))return Oa.cell}}finally{$b&&$b.dispose()}return null};a.prototype.vIh=function($b){var Wb=this.Sa,lc=Wb.Nc();this.refresh&&Array.add(lc.buttons,Wb.Bb(100));this.lZ&&Array.add(lc.buttons,Wb.Bb(99));this.EAa?Array.add(lc.buttons,Wb.Bb(59)):this.Wva&&Array.add(lc.buttons,Wb.Bb(58));if(this.expandCollapse){var Oa=Wb.Wv("ContextMenu.PivotExpandCollapse",null,ba.a.instance.fa(1120),589118293);var qb=Wb.Nc();Array.add(qb.buttons,
Wb.Bb(243));Array.add(qb.buttons,Wb.Bb(244));Array.add(qb.buttons,Wb.Bb(245));Array.add(qb.buttons,Wb.Bb(246));Array.add(Oa.menu.Ac,qb);Oa&&0<qb.buttons.length&&Array.add(lc.buttons,Oa)}Array.add($b.Ac,lc)};a.prototype.YWe=function($b,Wb,lc,Oa){if(Wb&&!lc&&!Oa){Wb=this.Sa.Nc();this.rnd&&!this.$.mR&&this.HWe(Wb);this.Qcd(Wb);this.SIh(Wb);if(Ya.EwaSettings.la(500)&&eb.g(this.$).ha.va.qK()&&eb.g(this.$).ha.va.e_)switch(Ya.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:Array.add(Wb.buttons,this.Sa.Bb(237));break;case 2:Array.add(Wb.buttons,this.Sa.Bb(238));break;default:Array.add(Wb.buttons,this.Sa.Bb(236))}Array.add($b.Ac,Wb)}};a.prototype.Qcd=function($b){if(!Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new qa.a(this.$.xa)).ue(2048)){var Wb=this.Sa.Nc();Array.add(Wb.buttons,this.Sa.Bb(223));Array.add(Wb.buttons,this.Sa.Bb(224));this.$.isMobileMode||Array.add(Wb.buttons,this.Sa.Bb(225));
var lc=this.Sa.Wv("ContextMenu.sort",null,ba.a.instance.fa(228),-864298118);Array.add(lc.menu.Ac,Wb);Array.add($b.buttons,lc)}};a.prototype.HWe=function($b){var Wb=this.Sa.Wv("ContextMenu.filter",null,ba.a.instance.fa(1910),2045563128),lc=this.Sa.Nc(),Oa=this.NRh(),qb=this.Sa.Bb(234);qb.label=Oa;Array.add(lc.buttons,qb);Array.add(lc.buttons,this.Sa.Bb(235));Oa=this.Sa.Nc();Array.add(Oa.buttons,this.Sa.Bb(233));Array.add(Wb.menu.Ac,lc);Array.add(Wb.menu.Ac,Oa);Array.add($b.buttons,Wb)};a.prototype.SIh=
function($b){if(eb.g(this.$).ha.va.qK()){var Wb=this.Sa.Nc();Array.add(Wb.buttons,this.Sa.Bb(232));Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Array.add(Wb.buttons,this.Sa.Bb(285)),Array.add(Wb.buttons,this.Sa.Bb(286)));var lc=this.Sa.Wv("ContextMenu.table",null,ba.a.instance.fa(1909),-697806646);Array.add(lc.menu.Ac,Wb);Array.add($b.buttons,lc)}};a.prototype.MWe=function($b,Wb,lc,Oa,qb){if(Wb){var Ub=fa.K(qb),jc=eb.e(this.grid);if(jc&&!lc&&!Oa){lc=
new qa.a(this.$.xa);if(jc.range.contains(Ub)&&this.JV(jc)){(Wb=!jc.kMa&&!lc.Nj)&&this.$.isEditMode&&Array.add($b.buttons,this.Sa.Bb(45));jc.Xaa&&Array.add($b.buttons,this.Sa.Bb(53));Wb&&this.$.isEditMode&&Array.add($b.buttons,this.Sa.Bb(47));return}!jc.kMa&&this.$.isEditMode&&(jc=lc.ue(128),Array.add($b.buttons,this.Sa.Bb(jc?46:121)))}}this.L5i(qb)&&Array.add($b.buttons,this.Sa.Bb(48));Wb&&Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode&&
!this.$.isMobileMode&&(Wb=fa.K(qb),this.K5i(Wb)?Array.add($b.buttons,this.Sa.Bb(276)):Wb.Rh||Wb.isRow||Array.add($b.buttons,this.Sa.Bb(275)))};a.prototype.L5i=function($b){$b=yl($b);for(var Wb=$b.next();!Wb.done;Wb=$b.next()){Wb=this.grid.getRangeInformation(Wb.value);for(var lc=0;lc<Wb.length;lc++)if(Object(u.a)(S.HyperlinkRange,Wb[lc])){var Oa=this.grid.wc(Wb[lc]);if(Oa&&this.JV(Oa)&&!Oa.kMa)return!0}}return!1};a.prototype.K5i=function($b){if(eb.g(this.$).ha.va.qK()){var Wb=eb.g(this.$).Sb.Wj($b);
if(Wb&&Wb.usedRange.equals($b))return!0}return!1};a.prototype.zWe=function($b,Wb,lc){var Oa,qb;if(1===eb.g(this.$).ha.We&&!Wb&&!lc){Wb=Ia.a(this.$);lc=this.Sa;var Ub=lc.Nc(),jc=this.$.da.Aa(65);(null===(Oa=null===jc||void 0===jc?void 0:jc.Jn)||void 0===Oa?0:Oa.aF)&&!Wb&&Array.add(Ub.buttons,lc.Bb(227));jc&&jc.isCommentOperationEnabled(3)&&Array.add(Ub.buttons,lc.Bb(221));(null===(qb=null===jc||void 0===jc?void 0:jc.Jn)||void 0===qb?0:qb.m8e)&&!Wb&&Array.add(Ub.buttons,lc.Bb(228));(null===jc||void 0===
jc?0:jc.hasCommentAtActiveCell)?jc.fC.isResolved||Array.add(Ub.buttons,lc.Bb(159)):jc&&jc.hasCommentAtActiveCell||(jc&&jc.Jn&&jc.Jn.aF?Wb||(Array.add(Ub.buttons,lc.Bb(229)),Array.add(Ub.buttons,lc.Bb(230))):(Array.add(Ub.buttons,lc.Bb(160)),Wb||Array.add(Ub.buttons,lc.Bb(226))));Array.add($b.Ac,Ub)}};a.prototype.OIh=function($b){if(Ya.EwaSettings.la(135)){var Wb=this.Sa,lc=Wb.Nc();Array.add(lc.buttons,Wb.Bb(250));Array.add($b.Ac,lc)}};a.prototype.RHh=function($b,Wb,lc){if(!lc){lc=this.$.Ka.oH();var Oa=
new qa.a(this.$.xa),qb=new ia.a(lc,Wb,this.grid);(new l($b,this.$,this.Sa,lc,Wb,this.grid,qb,Oa)).Fcd()}};a.prototype.HHh=function($b,Wb,lc,Oa,qb){var Ub=(new qa.a(this.$.xa)).ue(8),jc=this.Sa,Kb=jc.Nc();Wb&&Array.add(Kb.buttons,jc.Bb(Ub?152:153));lc&&Array.add(Kb.buttons,jc.Bb(Ub?150:151));Wb&&(Oa||Array.add(Kb.buttons,jc.Bb(Ub?109:155)),Array.add(Kb.buttons,jc.Bb(Ub?111:157)));lc&&(qb||Array.add(Kb.buttons,jc.Bb(Ub?108:154)),Array.add(Kb.buttons,jc.Bb(Ub?110:156)));Array.add($b.Ac,Kb)};a.prototype.wHh=
function($b,Wb){var lc=this.Sa,Oa=lc.Nc();Array.add($b.Ac,Oa);Wb&&Array.add(Oa.buttons,lc.Bb(102));Array.add(Oa.buttons,lc.Bb(42));Array.add(Oa.buttons,lc.Bb(43));Wb=this.sIh(lc);Array.add($b.Ac,Wb)};a.prototype.sIh=function($b){var Wb=$b.Nc();Wb.title=ba.a.instance.fa(1100);Wb.e5f=!1;Wb.d5f=!1;Wb.j$f=!1;var lc=5,Oa=ea.a.zrd(this.$);Oa&&(lc=6);$b=$b.EA("PasteOptionsGallery",lc,"Size24by24",Wb.title);Array.add(Wb.buttons,$b);$b.At("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",
1101,void 0,"Paste_24",1,z.a.Wuh);$b.At("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1102,void 0,"PasteValues_24",1,z.a.avh);$b.At("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1103,void 0,"PasteFormulas_24",1,z.a.Yuh);$b.At("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1104,void 0,"PasteTranspose_24",1,z.a.$uh);$b.At("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",
1105,void 0,"PasteFormatting_24",1,z.a.Xuh);Oa&&$b.At("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1106,void 0,"PasteLink_24",1,z.a.Zuh);return Wb};a.prototype.dJh=function($b,Wb,lc,Oa,qb){var Ub,jc=this.Sa,Kb=jc.Nc();Array.add(Kb.buttons,jc.Bb(43));Array.add($b.Ac,Kb);this.rnd&&!this.$.mR&&(Kb=this.Sa.Nc(),this.HWe(Kb),Array.add($b.Ac,Kb));Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.oc.isMobileMode&&this.$.ea.oc.isReadOnlyEditMode&&
!this.$.ya.IsMeetingLiveSession||(Kb=this.Sa.Nc(),this.Qcd(Kb),Array.add($b.Ac,Kb),n.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Kb=this.$.da.Aa(65);if(null===(Ub=null===Kb||void 0===Kb?void 0:Kb.Jn)||void 0===Ub?0:Ub.aF)Ub=this.Sa.Nc(),Array.add(Ub.buttons,jc.Bb(229)),Array.add($b.Ac,Ub);Ub=this.Sa.Nc();this.MWe(Ub,Wb,lc,Oa,qb);Array.add($b.Ac,Ub);A.AFrameworkApplication.isMobileMode&&
!da.a(this.$.ya,30)&&(Wb=jc.Nc(),Array.add(Wb.buttons,jc.Bb(272)),Array.add($b.Ac,Wb))};a.prototype.mIh=function($b,Wb,lc,Oa,qb){var Ub=this.Sa.Nc();this.nIh(Ub);this.MWe(Ub,Wb,lc,Oa,qb);0<Ub.buttons.length&&Array.add($b.Ac,Ub)};a.prototype.nIh=function($b){Array.add($b.buttons,this.Sa.Bb(135))};a.prototype.LHh=function($b){var Wb=this.Sa.Nc();Array.add(Wb.buttons,this.Sa.Bb(185));Array.add($b.Ac,Wb)};a.prototype.JIh=function($b,Wb){Ya.EwaSettings.la(501)&&Wb&&(Wb=this.Sa.Nc(),Array.add(Wb.buttons,
this.Sa.Bb(262)),Array.add($b.Ac,Wb))};a.prototype.YHh=function($b){var Wb=this.grid.ha.va.selectedRanges;if(Wb&&Wb.length){for(var lc=!1,Oa=0;Oa<Wb.length;Oa++)if(this.grid.Sb.CMa(Wb[Oa])){lc=!0;break}if(lc){var qb=this.Sa;lc=qb.Nc();Oa=qb.Nc();for(var Ub=1===Wb.length&&(Wb[0].isSingle||this.grid.Sb.xzb(Wb[0])),jc=!1,Kb=!1,dc=!1,Qb=!1,O=0;O<Wb.length&&!(jc&&dc&&Kb&&Qb);O++)!jc&&this.grid.Sb.ali(Wb[O])&&(jc=!0),!dc&&this.grid.Sb.zff(Wb[O],!1)&&(dc=!0),!Kb&&this.grid.Sb.Wpd(Wb[O])&&(Kb=!0),!Qb&&this.grid.Sb.Dgi(Wb[O])&&
(Qb=!0);Ya.EwaSettings.la(105)&&Ub&&!this.grid.Sb.cfc(Wb[0])&&(Qb?Array.add(lc.buttons,qb.Bb(217)):Array.add(lc.buttons,qb.Bb(216)));Qb=jc;Qb=!(new qa.a(this.$.xa)).Nj&&Qb;dc&&(Ya.EwaSettings.la(131)&&T.l(this.$.lg)&&(Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Array.add(Oa.buttons,qb.Bb(220)):Array.add(Oa.buttons,qb.Bb(Qb?220:271))),Kb&&Array.add(Oa.buttons,
qb.Bb(Qb?218:269)),Ub&&(this.grid.Sb.Wpd(Wb[0])||this.grid.Sb.cfc(Wb[0]))&&Array.add(Oa.buttons,qb.Bb(Qb?219:270))),Array.add(Oa.buttons,qb.Bb(Qb?215:268)));0<Oa.buttons.length&&(Wb=qb.Wv(jc?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,ba.a.instance.fa(1733),798637440),Array.add(Wb.menu.Ac,Oa),Array.add(lc.buttons,Wb));0<lc.buttons.length&&Array.add($b.Ac,lc)}}};a.prototype.xHh=function($b,Wb){this.grid.Sb.Vdf(Wb)&&(Wb=this.Sa.Nc(),this.grid.ha.va.exa()?
(Array.add(Wb.buttons,this.Sa.Bb(241)),Array.add(Wb.buttons,this.Sa.Bb(239))):Array.add(Wb.buttons,this.Sa.Bb(240)),Array.add($b.Ac,Wb))};a.prototype.JV=function($b){return $b.cell.hasHyperlink};a.prototype.SWe=function($b){this.xIh($b);var Wb=this.Sa.Nc();this.Qcd(Wb);Array.add($b.Ac,Wb)};a.prototype.wIh=function($b,Wb,lc){this.SWe($b);this.zWe($b,Wb,lc)};a.prototype.xIh=function($b){if(this.grid.ha.va.qh&&!this.grid.$a.$i){var Wb=this.Sa,lc=Wb.Nc();lb.a(this.$).bRd()?Array.add(lc.buttons,Wb.Bb(265)):
Array.add(lc.buttons,Wb.Bb(264));Array.add($b.Ac,lc)}};a.aWi=function($b){var Wb=$b.gKa(a.Bkd);Wb&&Wb.qmd&a.Bkd&&$b.invoke(a.Bkd,null)};a.QHh=function($b,Wb,lc){if(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(lc=lc.da.Aa(254),!lc){n.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(lc=lc.da.Aa(254,!0),!lc)return;lc.Lod()&&lc.pkf()&&Array.add($b.buttons,
Wb.Bb(212));lc.Lod()&&lc.Ric()&&Array.add($b.buttons,Wb.Bb(213))};a.prototype.Nxj=function(){var $b=this.grid.ha.va.activeCell;return ma.c(this.$,$b)||!this.Cgi($b)};a.prototype.Cgi=function($b){var Wb=$b.left,lc=this.Z3e();if(null!=lc&&null!=lc.KTe&&Array.contains(lc.KTe,Wb-1))return!0;lc=this.Tgd();return null!=lc&&fa.D(lc).contains($b)&&null!=lc.FilteredColumns&&Array.contains(lc.FilteredColumns,Wb-1)?!0:!1};a.prototype.Txj=function(){var $b=this.$.da.Aa(66).Lg;if(null!=$b)return!$b.hasAutoFilter||
!$b.xob;$b=this.$.xa.getItemByName(this.$.pa.sheetName);return!$b.hasAutoFilter||!$b.xob};a.prototype.Bgi=function(){if(null!=this.Z3e())return!0;var $b=fa.D(this.Tgd());return null!=$b&&$b.contains(this.grid.ha.va.activeCell)?!0:!1};a.prototype.Z3e=function(){var $b=this.$.da.Aa(66);$b.Dn(this.grid.ha.va.activeCell);return $b.NXe(this.grid.ha.va.activeCell)};a.prototype.Tgd=function(){return this.$.xa.getItemByName(this.$.pa.sheetName).F0};a.prototype.NRh=function(){var $b=this.grid.ha.va.activeCell,
Wb=0,lc=!1,Oa=this.$.da.Aa(66).Lg;null!=Oa?(Wb=Oa.usedRange.top,lc=!0):(Oa=this.Tgd(),null!=Oa&&fa.D(Oa).contains($b)&&(Wb=Oa.FirstRow+1,lc=!0));return lc?($b=$b.left,Wb=H.Range.ld(Wb,$b),Wb=this.grid.wc(Wb),lc="",null!=Wb&&(lc=Wb.text),this.pQg(lc,$b)):ba.a.instance.fa(221)};a.prototype.pQg=function($b,Wb){null==$b||Ja.a.ni($b.trim())?$b=String.format(ba.a.instance.Cb(156),H.Range.qU(Wb)):$b.length>a.B0d?($b=$b.substring(0,a.B0d),$b=String.format(ba.a.instance.Cb(154),$b)):$b=String.format(ba.a.instance.Cb(155),
$b);return $b};Qk.Object.defineProperties(a.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return V.a.MMf}}});a.$Hb="GridContextMenuRootName";a.K2h=V.a.hCe;a.Bkd=192;a.B0d=26;Object(y.a)(a,"GridContextMenu",B.a,[])},1239:function(y,F,b){function a(Ha,Ya){var Na=Pa.call(this,Ha)||this;Na.KCa=null;Na.t_c=[];Na.F4d=null;Na.$va=!1;Na.Hdc=!1;Na.kq=null;Na.qae=null;Na.bKe=function(){Na.GY.kJa(Na.items,Na.KCa);
Na.raiseEvent("ACLBUpdated",new x.a(Na.items.length));Na.show()};Na.tableManager=Ya;Na.domElement.className=t.a.ZMe;Na.domElement.innerHTML=pa;ba.DOMElementExtensions.setVisible(Na.domElement,!1);qa.d(Na.style,Na.$.isChromeRtl);Na.uxe=$get(n.g8f,Na.domElement);Na.GY=new c(Na.$,Na.uxe);Na.FSa(!0);Na.$.domElement.appendChild(Na.domElement);Na.oob(Ha,W.a(Ha));Na.oob(Ha,U.g(Ha).zc);Na.$.da.Ha(1,Na);Na.Igi=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);
return Na}function c(Ha,Ya){Ha=K.call(this,Ha,Ya)||this;Ha.cellAutoCompleteControl=null;Ha.jra=null;Ha.$r=[];return Ha}function d(Ha,Ya){var Na=Q.call(this,Ha,Ya)||this;Na.W2d=null;Na.Nic=0;Na.K7a=null;Na.R0=null;Na.PLa=!1;Na.m6=function(eb,Ia){if(eb=Na.cellAutoCompleteControl.items)if(1===eb.length&&Na.cellAutoCompleteControl.H0a.length<eb[0].esa.length&&Na.cellAutoCompleteControl.$va&&V.a.yL(eb[0].esa,Na.cellAutoCompleteControl.H0a)&&(Ia.newValue=eb[0].esa),Na.Ya&&D.EwaSettings.la(136)){var lb=
-1;1<eb.length?lb=Na.cellAutoCompleteControl.Sbc(Na.Ya.text,!0):1===eb.length&&(Na.cellAutoCompleteControl.$va||Na.cellAutoCompleteControl.Hdc)&&(lb=0);if(0<=lb&&eb.length>lb&&eb[lb].wXc){var hc=z.C(eb[lb].wXc);hc&&U.g(Na.$).Sb.CMa(hc)&&(Ia.Rcf=!0,Ia.vxe=eb[lb].wXc)}}};Na.hEb=function(){Na.PLa&&(Na.cellAutoCompleteControl.$va=!1)};Na.Ya.xYa(Na.m6);Na.PLa=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");Na.PLa&&(Na.R0=Na.Qd.Ed(Na.Ya.textBox.domElement),Na.R0.ka("mousedown",
Na.hEb));return Na}function l(Ha,Ya){this.Alg=Ha;this.zlg=Ya}function n(){}b.r(F);y=b(0);var m=b(13),f=b(88),v=b(1187),w=b(9),t=b(902);n.g8f="suggested_cells_list_box";Object(y.a)(n,"CssElementIds",null,[]);var A=b(4),x=b(1188);Qk.Object.defineProperties(l.prototype,{esa:{configurable:!0,enumerable:!0,get:function(){return this.Alg}},wXc:{configurable:!0,enumerable:!0,get:function(){return this.zlg}}});Object(y.a)(l,"CellAutoCompleteItem",null,[477]);var u=b(5),B=b(84),r=b(1043),I=b(384),z=b(43),
D=b(1),V=b(20),U=b(19),Q=r.a;vm(d,Q);d.prototype.dispose=function(){this.Ya.XGb(this.m6);Q.prototype.dispose.call(this)};d.prototype.oU=function(Ha){Ha&&!this.cellAutoCompleteControl.isListVisible||Q.prototype.oU.call(this,Ha)};d.prototype.Qh=function(Ha,Ya){this.cellAutoCompleteControl.Ya=this.Ya;this.Nic=Ha.keyCode;if(this.Ya.isEditing){var Na=this.Ya.text;V.a.equals(this.K7a,Na,!1)||(this.K7a=Na)}else this.K7a=null;if(237279923===Ya)return this.cellAutoCompleteControl.isListVisible=!1;D.EwaSettings.la(136)&&
17===this.Nic&&this.cellAutoCompleteControl.$va&&(this.cellAutoCompleteControl.Hdc=!0);return Q.prototype.Qh.call(this,Ha,Ya)};d.prototype.ezd=function(){var Ha;if(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!u.AFrameworkApplication.Hg)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.$va=!1,this.Ya.isEditing){var Ya=!V.a.equals(this.K7a,this.Ya.text,!0),Na=this.Ya.Ond;(D.EwaSettings.$hf()?Na||!Ya&&229!==this.Nic:
!Ya)?Na&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(Ha=this.cellAutoCompleteControl.qNa)||void 0===Ha?void 0:Ha.cancel()):this.cellAutoCompleteControl.SLg(this.Nic)}else this.K7a=null};d.prototype.ej=function(){};d.prototype.Jg=function(){this.NV=!1;this.cellAutoCompleteControl.set_visible(!1);this.K7a=null;this.cellAutoCompleteControl.$va=!1;this.cellAutoCompleteControl.Hdc=!1;this.cellAutoCompleteControl.qNa&&this.cellAutoCompleteControl.qNa.cancel()};
d.prototype.AFd=function(Ha,Ya){return this.cellAutoCompleteControl.Qh(Ha,Ya)};Qk.Object.defineProperties(d.prototype,{nyb:{configurable:!0,enumerable:!0,get:function(){return!1}},NV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(Ha){this.cellAutoCompleteControl.isListVisible=Ha}},qLa:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return I.a.u_c}},cellAutoCompleteControl:{configurable:!0,
enumerable:!0,get:function(){var Ha=b(1239).CellAutoCompleteControl;return this.W2d||(this.W2d=Object(B.a)(Ha,this.$.da.Aa(1)))}}});Object(y.a)(d,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var la=b(29);r=b(1189);var ba=b(11),S=b(8),H=b(118),T=b(63),K=r.a;vm(c,K);c.prototype.dispose=function(){K.prototype.dispose.call(this);this.jra=null};c.prototype.Yyc=function(Ha){this.G7(!1);var Ya=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.Rba);for(var Na=0,eb=this.$r.length;Na<
eb;Na++){var Ia=la.a.Lf(Ha[this.$r[Na]].esa);Ia=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.m_,c.v_c,A.a.Tpe,Ia,la.a.t7b(Ia));Ya+=Ia}this.gg.innerHTML=Ya+"</tbody></table>";this.Gn=ba.DOMElementExtensions.Aj(this.domElement,this.Rba);this.G7(!0);this.Mra()};c.prototype.kJa=function(Ha,Ya){if(Ha&&Ha.length){var Na=[];if(Ya)for(var eb=0,Ia=Ha.length;eb<Ia;eb++)V.a.yL(Ha[eb].esa,Ya)&&Array.add(Na,eb);this.$r=Na;this.Yyc(Ha)}else this.isListVisible=!1,this.jra=
null};c.prototype.Xxa=function(){};c.prototype.DTg=function(Ha,Ya,Na){var eb=Math.min(Ha,Math.max(200,Na));Ya&&Ha<Na&&(eb+=H.a.fq);ba.DOMElementExtensions.Tq(this.gg,eb);Ya&&(eb-=H.a.fq);return eb};c.prototype.Mra=function(){K.prototype.Mra.call(this);var Ha=ba.DOMElementExtensions.Aj(this.get_element(),this.Rba),Ya=this.$r.length>this.$H,Na=U.g(this.$);if(Na=Na.wc(Na.ha.va.activeCell))for(Ha=this.DTg(Ha.offsetWidth,Ya,Na.width),Ya=this.gg.getElementsByClassName(c.v_c),Na=0;Na<Ya.length;Na++)Ya[Na].style.maxWidth=
S.HelperMethods.Rb(Ha);else m.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};c.prototype.gnc=function(Ha){if(Ha=K.prototype.gnc.call(this,Ha)){var Ya=U.g(this.$);Ya.Qq(!1);Ya.focus()}return Ha};Qk.Object.defineProperties(c.prototype,{Lk:{configurable:!0,enumerable:!0,get:function(){return this.jra},set:function(Ha){this.jBa(this.Lk);this.jra=Ha;var Ya=this.jBa(this.Lk);this.re=Ha?Ya.innerText:null;this.uuc(Ha)}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(T.a)(c.prototype,this,"isListVisible")},set:function(Ha){Object(T.b)(c.prototype,this,"isListVisible",Ha);Ha||(this.Lk=null)}},bTa:{configurable:!0,enumerable:!0,get:function(){return null}},jGa:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}}});c.v_c=t.a.guh;Object(y.a)(c,"CellAutoCompleteListBox",r.a,[]);var da=b(24),fa=b(61),W=b(119),ca=b(186),
ia=b(42),ea=b(32),qa=b(246);r=b(16);b.d(F,"CellAutoCompleteControl",function(){return a});var pa="<div id='"+n.g8f+"' class='"+t.a.s9c+" "+r.a.Sk+"' ></div>",Pa=v.a;vm(a,Pa);a.prototype.bVc=function(Ha){this.addHandler("ACLBUpdated",Ha)};a.prototype.iJd=function(Ha){this.removeHandler("ACLBUpdated",Ha)};a.prototype.C2=function(Ha){this.addHandler("ACLBSelectionChanged",Ha)};a.prototype.kda=function(Ha){this.removeHandler("ACLBSelectionChanged",Ha)};a.prototype.CFg=function(Ha){this.addHandler("ACLBMatchedItem",
Ha)};a.prototype.Pcj=function(Ha){this.removeHandler("ACLBMatchedItem",Ha)};a.prototype.s7f=function(Ha){for(var Ya=0;Ya<Ha.length;Ya++){var Na=Ha.charCodeAt(Ya);if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?V.a.isLetter(Na):V.a.Vod(Na))return!0}return!1};a.prototype.Kwa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.FSa(!1);var Ha=U.g(this.$);Ha&&Ha.view.Mq(this.Ymc)}f.a.sc([this.GY,this.qNa]);f.a.sc(this.t_c);
this.t_c=this.uxe=this.GY=this.Ya=null;Pa.prototype.dispose.call(this)};a.prototype.Qh=function(Ha,Ya){var Na=!1,eb=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");if(this.jyj(eb,Ya))switch(Ya){case -798660877:if(1===this.items.length&&this.re)break;this.Ft.iB(1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.Sbc(this.re),this.re));Na=this.Ly(!1);break;case 137938150:if(1===this.items.length&&this.re)break;this.Ft.iB(-1);this.raiseEvent("ACLBSelectionChanged",
new x.a(this.items.length,this.Sbc(this.re),this.re));Na=this.Ly(!1);break;case 2091832999:this.Ft.iB(this.$H-1);Na=this.Ly(!1);break;case 742457698:this.Ft.iB(-(this.$H-1));Na=this.Ly(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.isListVisible=!1;Na=!0;break;case 267796030:eb||1!==this.items.length?this.Ly(!0):this.hec(!0);break;default:Na=Pa.prototype.Qh.call(this,Ha,Ya)}return Na};a.prototype.show=function(){this.items&&this.items.length&&(this.GY.Lk=this.re?this.Ft.Gn.rows[this.Sbc(this.re)]:
null,this.isListVisible=0<this.GY.$r.length,this.yBa(!0),this.GY.Xxa())};a.prototype.SLg=function(Ha){var Ya=!!this.Ya&&!fa.f(this.$.pa);this.Hdc=this.$va=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):Ya&&!this.Cbh(this.activeCell)&&this.RBj(Ha)};a.prototype.Cbh=function(Ha){return!!this.dataValidationControl&&this.dataValidationControl.f7c(Ha)};a.prototype.Ly=function(Ha){if(!this.Ya||!this.isListVisible)return!1;var Ya=this.KCa;if(this.re){var Na=ba.DOMElementExtensions.yZ(ba.DOMElementExtensions.Aj(this.GY.Lk,
c.v_c),A.a.Tpe,""),eb=Na.substring(Ya.length,Na.length);Ha?this.Ya.text=Na:this.Ya.insertTextAt(eb,Ya.length,this.Ya.text.length)}Na=U.g(this.$);Na.Cj&&(Na=Na.zc,Na.text=this.Ya.text,Na.setCaretPosition(this.Ya.textBox.caretPosition));Ha?this.isListVisible=!1:this.Ya.textBox.selectRange(Ya.length,this.Ya.text.length);return!0};a.prototype.Sbc=function(Ha,Ya){Ya=void 0===Ya?!1:Ya;if(!this.GY.Gn)return-1;for(var Na=this.GY.Gn.children[0],eb=Na.children.length,Ia,lb=0;lb<eb;++lb)if(Ia=Na.children[lb],
V.a.equals(Ia.innerText.trim(),Ha,Ya))return lb;return-1};a.prototype.IAg=function(Ha,Ya,Na,eb,Ia,lb,hc){var ma=Na.originalText.replace(a.Lsf,String.fromCharCode(32)),Ja=new da.Range(Ha.top-1,Ha.left,Ha.bottom-1,Ha.right,!1,!1),Ta=hc?hc.Dn(Na.range):null;(!Na.LH||Na.range.left===Ha.left)&&1<ma.length&&!eb.xb(ma.toUpperCase())&&V.a.yL(ma,Ya)&&!V.a.equals(ma,Ya,!0)&&!a.xUe(Ya)&&this.s7f(ma)&&(!Ia&&!Ta||!Ia&&Ta.equals(hc.Dn(Ja))||Ia&&Na.range.Rd(lb)&&Na.range.top!==lb.top)&&(Ha=Na.formulaBarText,V.a.equals(Ha,
Na.text,!1)||!Ha)&&(Ha={},Ha.FirstRow=Na.range.top-1,Ha.FirstColumn=Na.range.left-1,Na=new l(ma,Ha),eb.add(ma.toUpperCase(),Na))};a.prototype.RBj=function(Ha){this.kq=this.d_h();this.qNa&&this.qNa.cancel();0<this.Ya.text.length&&(D.EwaSettings.$hf()||229!==Ha)&&0!==Ha?this.items&&((1<this.items.length||this.isListVisible)&&this.qih(),8!==Ha&&127!==Ha&&46!==Ha&&(1===this.items.length?this.hec(!1):this.GY.Lk&&this.Ly(!1))):this.isListVisible=!1};a.prototype.qih=function(){this.isListVisible?this.bKe():
this.qae=ca.AsyncMethodContext.Yy(this.bKe,500,ia.a.QVg,this.qNa)};a.prototype.hec=function(Ha){m.ULS.shipAssertTag(537167966,0,!this.Kwa()&&1===this.items.length,"Invalid Items");var Ya=this.items[0].esa,Na=this.Ya.text,eb=Ya.substring(Na.length,Ya.length);if(Ha&&!eb.length)this.Ya.text=Ya;else if(!Ha&&0<eb.length)this.Ya.appendText(eb),this.Ya.textBox.selectRange(Na.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new x.a(this.items.length,0,Ya));this.$va=!0};a.prototype.d_h=
function(){this.kq=null;var Ha=new ea.a(!1),Ya=this.activeCell;this.KCa=this.Ya.text.replace(a.Lsf,String.fromCharCode(32));var Na=this.tableManager.Dn(Ya),eb=Ya.Rd(Na);if(a.xUe(this.KCa)||!this.s7f(this.KCa))return this.items;var Ia=new da.Range(1,Ya.left,Ya.top-1,Ya.left,!1,!1),lb=new da.Range(Ya.top+1,Ya.left,w.a.Kh,Ya.left,!1,!1),hc=U.g(this.$);lb=hc.wl("CellAutoCompleteControl.GetSuggestedCells",lb);try{var ma=hc.wl("CellAutoCompleteControl.GetSuggestedCells2",Ia);try{for(var Ja=yl([ma,lb]),
Ta=Ja.next();!Ta.done;Ta=Ja.next())for(var pb=Ta.value;pb.$$mn();){var Db=pb.$$cu();this.IAg(Ya,this.KCa,Db,Ha,eb,Na,this.tableManager)}}finally{ma&&ma.dispose()}}finally{lb&&lb.dispose()}this.kq=Array(Ha.values.length);for(Ya=0;Ya<this.items.length;Ya++)this.items[Ya]=Ha.values[Ya];this.items.sort(function(fb,xa){return fb.esa.localeCompare(xa.esa)});return this.items};a.prototype.oob=function(Ha,Ya){Ha&&Ya&&Array.add(this.t_c,new d(Ha,Ya))};a.prototype.jyj=function(Ha,Ya){return this.Igi?Ha||267796030!==
Ya?this.H0a&&!this.Kwa()&&this.isListVisible?this.get_visible():!1:!0:this.H0a&&!this.Kwa()&&this.get_visible()&&this.isListVisible||!Ha&&267796030===Ya};a.xUe=function(Ha){Ha=0<Ha.length?Ha.charCodeAt(0):-1;return 35===Ha||61===Ha||43===Ha||45===Ha||64===Ha};Qk.Object.defineProperties(a.prototype,{Ft:{configurable:!0,enumerable:!0,get:function(){return this.GY}},H0a:{configurable:!0,enumerable:!0,get:function(){return this.KCa}},re:{configurable:!0,enumerable:!0,get:function(){return this.GY.re}},
items:{configurable:!0,enumerable:!0,get:function(){return this.kq}},qNa:{configurable:!0,enumerable:!0,get:function(){return this.qae}},activeCell:{configurable:!0,enumerable:!0,get:function(){return U.g(this.$).ha.va.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.F4d||(this.F4d=this.$.da.Aa(14))}}});Qk.Object.defineProperties(a,{Lsf:{configurable:!0,enumerable:!0,get:function(){return a.Zbe||(a.Zbe=new RegExp(String.fromCharCode(160),"g"))}}});a.Zbe=
null;Object(y.a)(a,"CellAutoCompleteControl",v.a,[414,415,416,2])},1373:function(y,F,b){function a(){this.tb=null;this.Vw=!1}function c(e,C){var J=Ua.call(this)||this;J.eqa=tl.a.gJh;J.EOc=!!window.PointerEvent;J.Oie=window.hasOwnProperty("ontouchstart");J.jkb=null;J.OVa=null;J.L8=!1;J.lT=new ff.a;J.Fkb=new ff.a;J.tpg=new va.a;J.zpa=null;J.gmb=!1;J.h3d=!1;J.ffe=!1;J.zMc=!1;J.QFc=!1;J.b3d=!1;J.VIc=!1;J.SUa=!1;J.Kjb=-1;J.nRc=null;J.session=null;J.handlers=null;J.element=null;J.curRecognizer=null;J.Wd=
dj.EventHandlerManager.instance;J.EOc?(Gd.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),J.jkb=Object(Sg.a)(J,J.Lnc,"onPointerEvent"),J.OVa=Ue.a.iJh):J.Oie?(Gd.ULS.sendTraceTag(593893140,310,50,"Using touch events"),J.jkb=Object(Sg.a)(J,J.Iya,"onTouchEvent"),J.OVa=Ue.a.touchEvents):(Gd.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),J.jkb=Object(Sg.a)(J,J.wnc,"onMouseEvent"),J.OVa=Ue.a.hJh);J.Ah=C;J.qfa=e;wg.AFrameworkApplication.ga&&(J.gmb=wg.AFrameworkApplication.ga.ra("UsePointerCaptureIsEnabled"),
J.h3d=wg.AFrameworkApplication.ga.ra("ClearCacheOnPrimaryPointerIsEnabled"),J.ffe=wg.AFrameworkApplication.ga.ra("ResetHandledBeforeInputHandlerIsEnabled"),J.zMc=wg.AFrameworkApplication.ga.ra("LogCoalescedEventsIsEnabled"),J.QFc=wg.AFrameworkApplication.ga.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),J.b3d=wg.AFrameworkApplication.ga.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),J.VIc=wg.AFrameworkApplication.ga.ra("HammerJsPerformanceTimersIsEnabled"),J.SUa=J.gmb&&wg.AFrameworkApplication.ga.ra("CancelDragFromGestureInputManagerIsEnabled")&&
wg.AFrameworkApplication.ga.ra("UseGestureInputManagerPointerCacheIsEnabled"));return J}function d(){}function l(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function n(e,
C,J,ja,Aa,gb,bc,Mc,Hc){e=G.call(this,e,J,ja,gb)||this;e.Wgb=C;e.rga=bc;e.LX=Mc;e.o_j=Hc;e.spg=Aa;return e}function m(){this.gHc=null}function f(){this.Xca=this.eXe=null}function v(e){var C=nl.call(this)||this;C.$=e;C.fc();return C}function w(e,C,J,ja,Aa){var gb=gl.call(this)||this;gb.YO=null;gb.p0=null;gb.kFa=null;gb.Buc=null;gb.yNc=null;gb.sXa=null;gb.qee=0;gb.pEc=!1;gb.Xh=function(){gb.uwa&&(gb.gridView?1===gb.gridView.ha.We?(gb.gridView.ha.va.activeCell.equals(gb.kFa)||gb.pN||gb.Lx(),gb.job.Oq()):
gb.Lx():Gd.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};gb.ej=function(){gb.Lx()};gb.ud=function(){gb.fX()};gb.qd=function(){gb.Lx()};gb.$c=function(){gb.showCallout()};gb.rya=function(){if(gb.nh.Dk&&gb.nh.Dk.length)if(gb.UYc)gb.nh.Xti||(gb.pEc=gb.nh.Dk[0].BlockingDataForExpand),gb.nh.$Ph&&Gd.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),gb.qee=gb.nh.Y4c&&gb.nh.bWe<gb.nh.Y4c.left-1?gb.nh.Y4c.left-1-gb.nh.bWe:
-1,gb.showCallout();else if(gb.gridView.ha.va.qh){var bc=gb.gridView.ha.va.activeCell;if(bc&&gb.p0){var Mc=gb.tableManager.Dn(bc);gb.oLc=!!Mc;var Hc=gb.gridView.ha.va.Td;Mc=gb.pN&&gb.p0.Rd(Mc);var yd=gb.kid&&!gb.pN&&Hc.equals(gb.selectedRange);Mc||yd?(Gd.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),gb.a9b=!0,xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!gb.pN&&gb.tableManager.nKa(bc)?Gd.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?gb.pN?gb.Th.DAa(gb.p0,gb.pN):gb.Th.DAa(Hc,gb.pN):gb.Th.DAa(gb.p0,gb.pN),gb.qtc())):Gd.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};gb.dj=function(){gb.w6a()&&gb.Th.hide();1===gb.gridView.ha.We&&gb.fX()};gb.LR=function(){var bc=gb.gridView.ha.We;gb.gridView.ha.va.activeCell&&1===bc&&gb.fX()};gb.ht=function(){if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(gb.pN){if(gb.p0&&
gb.kFa){var bc=gb.tableManager.Dn(gb.kFa);bc&&1<bc.bottom-bc.top&&(--bc.bottom,gb.gridView.b_(bc)&&gb.job.Oq())}}else gb.gridView.ha.va.qh&&gb.gridView.b_(gb.gridView.ha.va.Td)&&gb.job.Oq();else gb.p0&&gb.kFa&&gb.pN&&(bc=gb.tableManager.Dn(gb.kFa))&&1<bc.bottom-bc.top&&(--bc.bottom,gb.gridView.b_(bc)&&gb.job.Oq())};gb.fX=function(){if(gb.$&&gb.gridView){if(gb.a9b&&gb.pN){var bc=gb.gridView.ha.va.activeCell;gb.p0=gb.fUe();var Mc=!!gb.Buc&&gb.Buc.contains(bc);if(gb.p0&&(bc.equals(gb.kFa)||Mc)){gb.Th.DAa(gb.p0,
gb.pN);return}}gb.a9b=!1;gb.p0=gb.fUe();gb.p0&&gb.fya&&gb.gridView&&gb.gridView.Ca.ds(gb.fya)?(gb.UYc=!1,gb.zZ()):(gb.nh.SZc(),gb.nh.b1b());gb.a9b||gb.Th.hide()}};gb.$=e;gb.tableManager=J;gb.contextMenuManager=ja;gb.Th=new t(e,gb.$c,C,Aa);gb.nh=C.C3c(e,J);gb.UYc=!1;gb.a9b=!1;gb.kid=xe.EwaSettings.la(136);gb.oLc=!0;gb.gridView=Oe.g(gb.$);gb.gridView.zc.Xl(gb.ej);gb.gridView.$q(gb.LR);gb.$.Pk(gb.ud);gb.$.ul(gb.qd);gb.$.mA(gb.dj);gb.gridView.view.Ls(gb.ht);gb.gridView.ha.E2(gb.Xh);gb.job=Ai.a.instance.create(gb.fX,
250,ji.a.s3i);Gd.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");gb.nh.LYb(gb.rya);gb.fX();e.da.Ha(261,gb);return gb}function t(e,C,J,ja){var Aa=Wk.call(this)||this;Aa.isMac=Rh.a.isMac;Aa.$=e;Aa.ariaLiveNotifier=ja;Aa.Ip=J.k4b(e,null,C,k.a.ivh,fh.a.Fe(9),ue.a.instance.fa(1691),"PulloutPointerDown");return Aa}function A(e){var C=wk.call(this)||this;C.m4b=null;C.$=e;C.fc();return C}function x(e){var C=ql.call(this)||this;C.$=e;return C}function u(){}function B(e,C,J,ja,Aa){J=void 0===
J?null:J;ja=void 0===ja?null:ja;Aa=void 0===Aa?0:Aa;e=I.call(this,e,C)||this;e.vNa=null;e.gec=J||fh.a.current.oo(82);e.dmf=Aa;e.b5c=ja;e.JBg();return e}function r(e,C,J,ja){e=I.call(this,e,C)||this;e.$Ab=null;e.Ung=J;e.x7h=ja;e.KBg();return e}function I(e,C){e=ml.call(this,e)||this;e.aBb=null;e.j$h=Math.max(1,C);return e}function z(e,C,J,ja,Aa,gb,bc,Mc){Mc=void 0===Mc?"":Mc;var Hc=ll.call(this)||this;Hc.lwa=null;Hc.Z9e=!1;Hc.dlc=null;Hc.clc=null;Hc.buttons={};Hc.PMe={};Hc.$=e;Hc.svgIconProvider=C;
Hc.SIi=J;Hc.Ukd=ja;Hc.Tkd=Aa;Hc.altText=gb;Hc.jFb=bc;Hc.buttonText=Mc;return Hc}function D(e,C,J,ja,Aa,gb,bc,Mc){function Hc(we){nh.g(we)}var yd=el.call(this,document.createElement("div"))||this;yd.okf=null;yd.mSd=!1;yd.fSa=null;yd.gMb=null;yd.CF=function(){yd.raiseEvent("OnObjectButtonMouseOver")};yd.hI=function(){yd.raiseEvent("OnObjectButtonMouseOut")};yd.tDj=function(){yd.Cke()};yd.$c=function(we){yd.raiseEvent(yd.jFb,we);yd.hFb();return!0};yd.Ozd=function(we){100<Fj.a(Gg.a.Ra,yd.okf)&&yd.Pid(new Sys.UI.Point(Math.round(we.clientX),
Math.round(we.clientY)))};yd.JN=function(we){nh.g(we.Ea,!1);return!1};yd.eZ=yd.Qd.fta();yd.set_visible(!1);yd.Lhc=Aa;yd.jFb=gb;yd.Ilc=e;yd.$1b=C;yd.Lhc&&(yd.fSa=Ai.a.instance.create(yd.tDj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));e&&yd.domElement.classList.add(e);yd.$Za=document.createElement("div");yd.domElement.appendChild(yd.$Za);J&&yd.$Za.classList.add(J);ja&&(yd.$Za.innerHTML=ja);bc&&(yd.gMb=document.createElement("div"),yd.domElement.appendChild(yd.gMb),yd.gMb.classList.add(Mc),yd.gMb.innerText=
bc,yd.domElement.style.padding="3px",Z.a.instance.qa(Ue.a.pointerDown,yd.domElement,yd.JN));yd.RZa=new Vk.a(yd.domElement,7);ej.a.instance.qa(Ue.a.click,yd.domElement,yd.$c);xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Z.a.instance.qa(Ue.a.pointerDown,yd.domElement,yd.JN);yd.xc.ka("mouseup",Hc);yd.xc.ka("click",Hc);yd.xc.ka("dblclick",Hc);return yd}function V(){}function U(e,C,J,ja){var Aa=Q.call(this,e,C)||this;Aa.F1a=null;Aa.Uxf=function(){Aa.usc(Aa.Uxf);
if(Aa.Dk&&Aa.Dk.length&&Aa.contextMenuManager){var gb=Aa.contextMenuManager.Sdd("autoFilterRichFieldList"),bc=window.document.getElementById(Aa.F1a);gb.BO(null,bc,Aa,null,!0)}};Aa.Blg=J;Aa.contextMenuManager=ja;return Aa}function Q(e,C){var J=Bk.call(this)||this;J.rP=null;J.Tub=null;J.ved=null;J.QHb=null;J.nTb=!1;J.r4d=null;J.mMi=function(ja,Aa,gb){Gd.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+gb);J.QHb&&J.QHb.stop();J.rP=null;J.raiseEvent("GetFieldInfoListContextOperationFailed")};
J.nMi=function(ja){xh.a(ja)||(J.QHb&&J.QHb.stop(),J.nTb=!1,J.rP=ja.Result,J.rP&&0<J.rP.length&&Gd.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",J.rP.length),J.Wib=!0,J.UFd())};J.Wib=!1;J.vb=e;J.$Rb=-1;J.tableManager=C;return J}function la(e){var C=kj.call(this)||this;C.firstElement=null;C.so=null;C.eMa=!1;C.Bs=null;C.mxj=Rh.a.Df||Rh.a.bB;C.Wzf=function(J){var ja=J.Ea.keyCode;return ja===ve.a.Zh?C.SKi():ja===ve.a.yD&&J.Ea.shiftKey?C.Czh(C.firstElement):
!1};C.zFf=function(J){if(!C.eMa||J.Ea.keyCode!==ve.a.LL)return!1;la.y9e();Tf.Task.delay(1).CWRCC(function(){C.so.focus();return!0},C.ma);return!0};C.HVi=function(){document.activeElement&&document.activeElement.id===C.so.id||(la.y9e(),Tf.Task.delay(1).CWRCC(function(){C.so.focus();return!0},C.ma))};C.ayf=function(){C.bag(C.so)};C.Vzf=function(J){J.stopPropagation();J.preventDefault();C.eMa&&(C.eMa=!1)};C.$=e;(e=C.$.ea.oc)&&Gd.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",
e.B$,e.inWebPart?"Classic":"Non Classic",e.inEmbedView?"True (+Modern)":"False (not Modern)");e&&(e.inWebPart||e.inEmbedView)?Gd.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",e.inWebPart?"Classic":"Non Classic",e.inEmbedView?"True (+Modern)":"False (not Modern)"):(C.C6g(),C.z7g(),Wj.KeyInputManager.instance.qa(Ue.a.Tb,C.$.domElement,C.zFf));C.$.da.Ha(238,
C);return C}function ba(e,C,J,ja,Aa){Aa=void 0===Aa?null:Aa;var gb=Pj.call(this)||this;gb.Dnb=null;gb.SOa=null;gb.YYc=0;gb.Boc=null;gb.hSi=function(){var bc=gb.SOa.JZe();Gd.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",gb.sla,bc);gb.Boc=Ai.a.instance.create(gb.hma,Math.max(gb.Dve-bc,0),ji.a.oke)};gb.hma=function(){Gd.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",
gb.sla,gb.SOa.JZe(),gb.H5a);gb.YYc++;gb.YYc>gb.Cve&&Gd.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",gb.sla);gb.SOa.px.C();gb.oUe()};gb.qya=function(){gb.H5a&&Gd.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",gb.sla,gb.ELa,gb.H5a);gb.tmd()};gb.xzg=e;gb.yzg=C;gb.documentVisibilityObserver=J;gb.sla=ja;gb.MO=Aa;J&&gb.documentVisibilityObserver.inb(gb.qya);
gb.XYc=!!J&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);gb.Cve=xe.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);C=xe.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);gb.Dve=e.C$b(C);e=xe.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);gb.RSg=Math.max(gb.Dve-C,0)+e;return gb}
function S(){this.startTime=Gg.a.Ra.Lb;this.px=new Ej.a}function H(e){var C=Gh.call(this)||this;C.$=e;C.fc();return C}function T(e,C,J,ja,Aa,gb){var bc=this;this.$=e;this.functionInfoManager=C;this.calcManager=J;this.pluginScheduler=ja;this.formulaAssistanceUIControl=Aa;this.nh=gb;this.TRa=!0;this.bNa=null;this.aNa=-1;this.Lh=function(){Oe.g(bc.$).isEditing||Oe.g(bc.$).Bi||bc.vCb()};this.onFunctionInfoLoaded=function(){bc.functionInfoManager.dHb(bc.onFunctionInfoLoaded);bc.jUj();bc.rda()};this.Puf=
function(){bc.TRa=!1};this.Xuf=function(Mc,Hc){var yd=bc.Ya;Mc=yd.text;yd=yd.textBox.caretPosition;ra.instance.A7(["argumentAssistanceComputation"]);Hc.shouldRequestAutocompleteOnCommit?bc.RXf(Mc,yd):bc.pluginScheduler.requester().argumentAssistance({content:Mc,caretPosition:yd}).then(function(we){0===we.kind&&bc.c6e(we.payload)})};this.Jg=function(){bc.TRa=!0;xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&bc.DIe()};this.m6=function(Mc,Hc){bc.$Ld(Hc.newValue)};
this.Ig=function(){bc.odg()};this.odg=function(){bc.pluginScheduler.notifier().setDefinedNamesInfo(bc.A5b.iHe)};this.$=e;this.functionInfoManager=C;this.formulaAssistanceUIControl=Aa;this.pluginScheduler=ja;ra.instance.$=e;this.Wff=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.lba=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.dyd=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
this.Wff&&(this.A5b=new fc(e),Oe.g(this.$).Ca.Ep(this.Ig),this.odg());this.nDa=new W(this.$,this.formulaAssistanceUIControl);this.Zpa=new fa(this.$,this.formulaAssistanceUIControl);e.da.Ha(464,this);this.calcManager=J;vg.a.YZ()&&this.Vld();this.lba&&(Oe.g(this.$).qc.Lo(this.Jg),this.nDa.JEg(this.Puf));this.L5a=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache")}function K(e,C){var J=this;this.nh=e;this.$=C;this.rya=function(){J.$8b.resolve(J.nh.Dk);J.Hbg();
J.vxf||(Oe.g(J.$).qc.Lo(J.Jg),J.vxf=!0)};this.Eyf=function(){J.$8b.reject(null);J.Hbg()};this.Jg=function(){J.nh.ubb();Oe.g(J.$).qc.Mn(J.Jg);J.vxf=!1}}function da(){var e=this;this.promise=new Promise(function(C,J){e.dvg=C;e.Mug=J})}function fa(e,C){var J=Vg.call(this,fa.LJa())||this;J.Ya=null;J.jr=null;J.kIa=!1;J.lIa=!1;J.jIa=!1;J.hIa=!1;J.iIa=!1;J.Nv=null;J.x0=0;J.Nq=null;J.Kv=!1;J.Jfa=!1;J.KAa=!1;J.oSa=!1;J.jLb=!1;J.aNb=Zf.Dismissed;J.dismiss=function(){J.Kv=!1;J.mba&&J.Otd();J.lN&&J.Ya.isEditing&&
J.fda();J.Nq=null;J.formulaAssistanceUIControl&&(J.formulaAssistanceUIControl.dismiss(J.domElement),J.yka&&(J.jr.canReceiveFocus=!1),J.aNb=Zf.Dismissed)};J.vid=function(){J.gMa&&J.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};J.sKi=function(){J.dismiss();Oe.g(J.$).xj.textBox.focus()};J.gRa=function(){var ja={};J.KFf?ja[Ca.a.oZ]="SmartSuggestionsCard":ja[Ca.a.oZ]="FunctionAndSmartSuggestionsCard";J.$.ye(802602464,0,8,ja)};J.Jg=function(){J.Hyb&&J.PIg()};J.Fzd=function(ja,Aa){J.Yeb(Aa);J.mba&&(J.lIa=
!0)};J.od=function(){J.visible=!1};J.Ezd=function(ja){J.mba&&(J.iIa=!0);J.e0a(ja)};J.hi=function(){J.dismiss()};J.ht=function(){void 0!==J.Nq&&null!==J.Nq&&J.Nq()};J.$=e;J.formulaAssistanceUIControl=C;J.yka=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");J.yka&&(J.jr=new vb(J.$,J.formulaAssistanceUIControl,1,Mg.a.ccd,J.vid));Oe.g(J.$).view.Ls(J.ht);Oe.g(J.$).ha.MG(J.od);J.$.xa.Qf(J.hi);J.iN=vg.a.iN(J.$);J.Hyb=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");
J.Xnd=J.iN&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5543855_EnterCommitsSmartSuggestions");J.mba=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");J.gMa=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");J.Gnd=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");J.fMa=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");J.Hyb&&Oe.g(J.$).qc.Lo(J.Jg);return J}
function W(e,C){var J=Ie.call(this,W.LJa())||this;J.K2=0;J.jr=null;J.Nq=null;J.hla=null;J.Kv=!1;J.gR=!1;J.od=function(){J.visible=!1};J.onCardModeChange=function(ja){J.kNb(ja);1===ja?ra.instance.Eaa.argumentAssistanceCollapseCounter++:ra.instance.Eaa.argumentAssistanceExpandCounter++};J.gRa=function(ja){var Aa={};Aa[Ca.a.oZ]="ArgumentAssistanceCard";var gb={};gb.FunctionName=ja.functionName;Aa[Ca.a.bad]=gb;J.$.ye(802602464,0,8,Aa)};J.ht=function(){void 0!==J.Nq&&null!==J.Nq&&J.Nq()};J.onDismissClick=
function(){ra.instance.Eaa.argumentAssistanceDismissCounter++;J.dismiss();J.raiseEvent("DC");J.gR&&J.aH.clear();xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&0===J.K2&&J.kNb(1)};J.Jg=function(){J.gR&&J.aH.clear()};J.$=e;J.formulaAssistanceUIControl=C;J.Um=vg.a.iN(e);J.lba=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);J.DOd();J.jr=new vb(J.$,J.formulaAssistanceUIControl,0,Mg.a.Zbd);Oe.g(J.$).view.Ls(J.ht);
Oe.g(J.$).ha.MG(J.od);J.gR=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);J.gR&&(J.aH=new xa(J.formulaAssistanceUIControl),Oe.g(J.$).qc.Lo(J.Jg));return J}function ca(e,C,J,ja,Aa,gb,bc,Mc){var Hc=ae.call(this,e)||this;Hc.ndc=!1;Hc.jr=null;Hc.kGa=null;Hc.Lg=null;Hc.VV=null;Hc.Frd=null;Hc.C5=null;Hc.Y2a=0;Hc.p$b=0;Hc.P3=0;Hc.AJe=0;Hc.csb=0;Hc.Ndb=0;Hc.Q4b=0;Hc.Vwc=!1;
Hc.Uia=null;Hc.hpc=null;Hc.columnName="";Hc.g6c=!1;Hc.Qwe=!1;Hc.zJa=[];Hc.vQ=null;Hc.nSa=[];Hc.Nq=null;Hc.Bcd=null;Hc.m8=null;Hc.Jfa=!1;Hc.KAa=!1;Hc.oSa=!1;Hc.jLb=!1;Hc.bNa=null;Hc.aNa=0;Hc.N1d=null;Hc.Nmd=!1;Hc.vid=function(){Hc.gMa&&Hc.raiseEvent(ca.Dbd,null)};Hc.BTe=function(){Hc.Uia=!1;Hc.VV=Hc.Ya.text;Hc.Kf.kJa(Hc.Nv,Hc.VV,!0,Hc.columnName,void 0,!1);1===Hc.Kf.$r.length&&1===Hc.Kf.yW.length?(Hc.set_visible(!1),Hc.Qwe||Hc.hec()):Hc.show()};Hc.xNi=function(yd){if(xh.a(yd))-315732528!==yd.Errors[0].MessageId&&
Gd.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",dh.a.Uc(yd.Errors));else if((yd=yd.Result)&&yd.length){Hc.Lg.LO||(Hc.Lg.LO={},Hc.Lg.LO.HeadersList=[]);Hc.Lg.LO.IsFullTableHeaders=!0;for(var we=0;we<yd.length;++we)Hc.Lg.LO.HeadersList[we]={},Hc.Lg.LO.HeadersList[we].Index=we,Hc.Lg.LO.HeadersList[we].Name=yd[we];Hc.rIf(!0);Hc.VV=Hc.Y3e();Hc.Kf.kJa(Hc.Nv,Hc.VV,!0,void 0,void 0,!0);Hc.show()}else Gd.ULS.sendTraceTag(537162012,
0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};Hc.wNi=function(yd){yd=xg.a.og(yd.data);Gd.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",dh.a.Uc(yd))};Hc.Wyd=function(){Oe.g(Hc.$).isEditing||Oe.g(Hc.$).Bi||Hc.vCb()};Hc.m6=function(yd,we){Hc.$Ld(we.newValue)};Hc.od=function(){(xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",
!1)||Hc.Um)&&Hc.set_visible(!1)};Hc.wyf=function(){Hc.kGa=null;Hc.m8=null};Hc.hi=function(){Hc.Um&&Hc.p1a()};Hc.onFunctionInfoLoaded=function(){Hc.gob()};Hc.rya=function(){Hc.lka?(Hc.m8=null,Hc.kGa=null,Hc.gob()):Hc.nh.Dk&&Hc.wse()};Hc.pca=function(){Hc.vQ&&Ba(Hc.$,Hc.vQ.HelpId,Hc.vQ.IsDynamicUdf);return!0};Hc.p1a=function(){Hc.mba&&Hc.Otd();Hc.lN&&Hc.Ya.isEditing&&Hc.fda();Hc.Nq=null;Hc.formulaAssistanceUIControl&&(Hc.formulaAssistanceUIControl.dismiss(Hc.domElement),Hc.yka&&(Hc.jr.canReceiveFocus=
!1));Hc.Nmd=!1};Hc.nDf=function(){Hc.lN&&Hc.fda();Hc.J4f();1===Hc.BXf.type&&xe.EwaSettings.Eb()&&!Hc.Ya.text.includes("\n")&&Hc.yEd(Hc.BXf)};Hc.onDismiss=function(){Hc.isListVisible=!1;Oe.g(Hc.$).xj.textBox.focus()};Hc.gRa=function(){var yd={};Hc.Kf.Khc?yd[Ca.a.oZ]="SmartSuggestionsCard":yd[Ca.a.oZ]="FunctionAndSmartSuggestionsCard";Hc.$.ye(802602464,0,8,yd)};Hc.Fzd=function(yd,we){Hc.Kf.yeg(we);Hc.mba&&(Hc.lIa=!0)};Hc.Ezd=function(yd){Hc.mba&&(Hc.iIa=!0);Hc.lN?(Hc.aBe(),Oe.g(Hc.$).xj.endEdit(!0,
"FormulaAssistanceControl.OnCompletionItemClicked",0)):yd.textEdit?Hc.e0a(yd.textEdit):Hc.Ly(!0)};Hc.gridView=Oe.g(e);Hc.functionInfoManager=C;Hc.domElement.className=Th.a.ZMe;Hc.nh=gb.C3c(e,J);Hc.A5b=new fc(e);Hc.qxg=J;Hc.formulaAssistanceUIControl=bc;Hc.pluginScheduler=Mc;ra.instance.$=e;Hc.Um=vg.a.iN(e);ca.xkd||(ca.xkd=ca.LJa());Hc.domElement.innerHTML=ca.xkd;Hc.Dyd=RegExp("\\d+");Rg.d(Hc.style,Hc.$.isChromeRtl);Hc.hja=new fb(Hc.$,Hc.domElement,Hc.functionInfoManager,Hc.formulaAssistanceUIControl,
Hc.pluginScheduler);C=$get(ib.ycd,Hc.domElement);J=$get(ib.tcd,Hc.domElement);gb=$get(ib.Acd,Hc.domElement);Hc.hpg=new Ia(Hc.$,C,gb,J,Hc);Hc.nh.LYb(Hc.rya);Hc.functionInfoManager.nnb(Hc.onFunctionInfoLoaded);Hc.functionInfoManager.fFg(Hc.wyf);Hc.Um&&(Hc.$.xa.Qf(Hc.hi),Hc.Kf.xoe(Hc.nDf));Hc.FSa(!0);Hc.V7f(!0);Hc.$.domElement.appendChild(Hc.domElement);Hc.jQc=0;(J=Lk.a(e))&&Array.add(Hc.zJa,new pb(e,J,Hc));Array.add(Hc.zJa,new pb(e,Hc.gridView.zc,Hc));Hc.Utb=Hc.zJa[0];Hc.Apb=Hc.zJa[Hc.zJa.length-1];
e.da.Ha(221,Hc);Hc.calcManager=ja;Hc.instantaneousSupportInformationManager=Aa;Hc.instantaneousSupportInformationManager||Hc.$.da.Za(268,function(yd){Hc.instantaneousSupportInformationManager=yd});Hc.JSe=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Hc.JAa=vg.a.rod();Hc.Yxc=vg.a.Lqd();Hc.dyd=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");Hc.Gnd=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");
vg.a.YZ()&&Hc.Vld();vg.a.oN(Hc.$)&&C.classList.add("ewa-fb-refactor");Hc.Um?Oe.g(Hc.$).ha.MG(Hc.od):Oe.g(Hc.$).ha.E2(Hc.od);Hc.yka=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");Hc.yka&&(Hc.jr=new vb(Hc.$,Hc.formulaAssistanceUIControl,1,Mg.a.ccd,Hc.vid));Hc.gMa=Hc.Um&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");Hc.fMa=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");return Hc}function ia(){}
function ea(){this.caretPosition=this.content=null}function qa(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function pa(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function Pa(){this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function Ha(){this.v9=this._name=null}function Ya(){this._name=null}function Na(){this._name=null}function eb(){this.v9=this._name=null}function Ia(e,
C,J,ja,Aa){C=xc.call(this,e,C)||this;C.jra=null;C.Muc=0;C.iLb=0;C.b2c=null;C.kWe=J;C.aub=ja;C.formulaAssistanceControl=Aa;C.$r=[];C.yW=[];C.Um=vg.a.iN(e);C.Yff=C.Um&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return C}function lb(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.data=this.isPrefixed=this.detail=this.type=null}function hc(e,C){this.$=e;this.items=C}function ma(e,C){this.D1i=e;this.osf=C}function Ja(){}function Ta(e){this.index=
e}function pb(e,C,J){var ja=Ok.call(this,e,C)||this;ja.JFf=!1;ja.XRa=null;ja.eld=0;ja.FFc=null;ja.PHa=null;ja.wQ=0;ja.formulaAssistanceControl=J;ja.sob=C.textBox;ja.L5a=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache");ja.Um=vg.a.iN(e);ja.Laj=xe.EwaSettings.Eb();return ja}function Db(){this.Uha=this.Lsa=this.Msa=!1;this.WFf=40;this.Wze=41;this.O_a=this.sCd=this.tCd=this.OEb=0;this.Jwf=!0;this.YAd=!1;this.yUe=this.QMd=-1}function fb(e,C,J,ja,Aa){var gb=
Ak.call(this,fb.LJa(vg.a.iN(e)))||this;gb.A1a=null;gb.K2=0;gb.jr=null;gb.MWc=!1;gb.Nq=null;gb.hla=null;gb.TRa=!0;gb.gR=!1;gb.onCardModeChange=function(bc){gb.kNb(bc);1===bc?ra.instance.Eaa.argumentAssistanceCollapseCounter++:ra.instance.Eaa.argumentAssistanceExpandCounter++};gb.gRa=function(bc){var Mc={};Mc[Ca.a.oZ]="ArgumentAssistanceCard";var Hc={};Hc.FunctionName=bc.functionName;Mc[Ca.a.bad]=Hc;gb.$.ye(802602464,0,8,Mc)};gb.onDismissClick=function(){ra.instance.Eaa.argumentAssistanceDismissCounter++;
gb.TRa=!1;gb.Rrb();gb.gR&&gb.aH.clear();xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&0===gb.K2&&gb.kNb(1)};gb.Jg=function(){gb.TRa=!0;gb.gR&&gb.aH.clear()};gb.NLi=function(bc){bc.button===Sys.UI.MouseButton.leftButton&&bc.target&&(nh.g(bc),gb.A1a&&gb.A1a.Una(bc))};gb.ht=function(){void 0!==gb.Nq&&null!==gb.Nq&&gb.Nq()};gb.$=e;gb.wj=C;gb.functionInfoManager=J;gb.formulaAssistanceUIControl=ja;gb.pluginScheduler=Aa;gb.Um=vg.a.iN(e);
gb.lba=gb.Um&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);gb.Um?(gb.DOd(),gb.jr=new vb(gb.$,gb.formulaAssistanceUIControl,0,Mg.a.Zbd),gb.lba&&Oe.g(gb.$).qc.Lo(gb.Jg),gb.gR=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!gb.formulaAssistanceUIControl,gb.gR&&(gb.aH=new xa(gb.formulaAssistanceUIControl))):(gb.A1a=new wb(gb.domElement,
gb.$.Py,void 0,vg.a.oN(gb.$)),gb.xc.ka("mousedown",gb.NLi),e=$get(ib.ycd,gb.wj),gb.wj.insertBefore(gb.domElement,e));Oe.g(gb.$).view.Ls(gb.ht);return gb}function xa(e){this.gn=!1;var C={};this.usageCount=(C[Oj.Drag]=0,C[Oj.Move]=0,C);this.g$b=e;this.KCc=this.g$b.getWindowEdgeBuffer()+1;this.jrf=new Ga(this);this.PJe=new ya(this)}function ya(e){this.aH=e;this.gn=!1}function Ga(e){var C=this;this.aH=e;this.MZ=this.BQd=this.gn=!1;this.onKeyDown=function(J){if(!C.MZ&&J.keyCode===ve.a.Ioa&&J.altKey&&J.ctrlKey)return C.K7b(),
J.stopPropagation(),J.preventDefault(),!0};this.TMa=function(J){if(!C.MZ)return!1;if(J.eventName===Ue.a.Tb){var ja=J.Ea.ctrlKey?1:J.Ea.shiftKey?50:10;switch(J.Ea.keyCode){case ve.a.RTa:C.W5(0,-ja);break;case ve.a.Goa:C.W5(0,ja);break;case ve.a.Hoa:C.W5(-ja,0);break;case ve.a.jfb:C.W5(ja,0);break;case ve.a.LL:case ve.a.Zh:C.BQd=!0;break;default:return!1}}J.eventName===Ue.a.Xd&&C.BQd&&C.h4(!0);J.Ea.preventDefault();return!0};this.iFb=function(J){if(!C.MZ)return!1;J.Ea.preventDefault();C.h4();return!0};
this.onBlur=function(){if(!C.MZ)return!1;C.h4();return!0};this.pr=Wj.KeyInputManager.instance;this.pointerInputManager=Z.a.instance}function db(){this.content=null;this.caretPosition=0}function Ob(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function Ec(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function wb(e,C,J,ja){ja=void 0===ja?!1:ja;C=Rj.call(this,e,C,!1,void 0===J?null:J)||this;C.DRa(ja);C.jj=E.a.equals("rtl",e.dir,!0);return C}function kb(e,
C){var J=hi.call(this)||this;J.npg=[];J.Ccd={};J.nWe={};J.fT=null;J.K8=[];J.HJa={};J.Lyf=function(ja,Aa){Gd.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");J.xyf(ja,!!Aa&&1!==Aa.FilterType,!0)};J.Kyf=function(){Gd.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");J.fT=null};J.uyf=function(ja){Gd.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");
J.mHd(ja.nja,!0,!1)};J.Jyf=function(ja){Gd.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");J.xyf(ja,!0,!1)};J.KKc=!1;J.IKc=!1;J.vb=e;J.pluginScheduler=C;J.$.da.Ha(19,J);return J}function vb(e,C,J,ja,Aa){this.IZc=!1;this.$=e;this.formulaAssistanceUIControl=C;this.LVe=J;this.bnj=ja;this.E6e=void 0===Aa?null:Aa}function Gb(e,C,J){var ja=oj.call(this)||this;ja.zcd=e;ja.eNd=C;ja.LXi=J;return ja}function Za(e){var C=Uk.call(this)||this;C.eNd=e;return C}function ub(e,
C){var J=Nk.call(this)||this;J.functionName=e;J.zcd=C;return J}function fc(e){this.jHe={};this.$=e}function $a(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function nb(){this.jT=0;this.V8d=!1;this.NVa=this.s$d=null;this.$9d=!1;this.textEdit=null}function sc(e){var C=this;this.krb=this.Cha=this.calcManager=this.Ya=null;this.n9a=function(){C.Y4a(!1,!1)};this.$=e;this.Ttb=new $b(e);this.e$b=new lc(e);this.f$b=new rd(this);Oe.g(e).zc.Lo(this.n9a);this.$.da.Ha(317,this)}function rd(e){this.L7=
0;this.acd=e}function $b(e){this.sqa=this.HSa=this.Z1a=this.mQ=this.E$=this.Ya=null;this.njd=!1;this.Pc=e}function Wb(){}function lc(e){var C=this;this.Ozi=30;this.calcManager=null;this.Nd=!1;this.TOa=this.ZEb=this.w$a=null;this.YC=function(){C.Eha.PZ()};this.$=e;this.Eha=new qb;this.oTf=-1;this.$.ea.JG(this.YC)}function Oa(e,C,J,ja,Aa,gb,bc){bc=e.Na(1,void 0===bc?null:bc);bc.getPartialCalcResultsParameters=C;return jg.i(e,"GetPartialCalcResults",bc,J,ja,Aa,gb,4)}function qb(){this.EQa={}}function Ub(e){var C=
Si.call(this)||this;C.$=e;C.fc();return C}function jc(e,C){var J=this;this.GJa=this.Jua=this.ija=null;this.eCf=function(ja,Aa){J.N6i(Aa.functionName,Aa.zcd)};this.gCf=function(ja,Aa){J.M6i(Aa.zcd,Aa.eNd,Aa.LXi)};this.fCf=function(ja,Aa){ja=[];Aa=yl(Aa.eNd);for(var gb=Aa.next();!gb.done;gb=Aa.next())gb=gb.value,(!J.K5a||void 0!==gb&&null!==gb)&&(gb=gb.trim())&&Array.add(ja,gb);if(!J.K5a||ja.length){Aa="";for(gb=0;gb<ja.length;gb++){var bc=J.OYc(ja[gb]),Mc=jc.PDd(gb,ja.length);Aa+=bc+Mc;Mc&&(Aa+=J.ariaLiveNotifier.Gxa)}J.ariaLiveNotifier.readText(Aa)}};
this.hCf=function(ja,Aa){J.ariaLiveNotifier.P6i(Aa.vI,Aa.description,Aa.selectedIndex.toString(),Aa.length.toString(),J.fMa)};this.aCf=function(ja,Aa){J.ariaLiveNotifier.bNf(Aa.description,Aa.length)};this.qyf=function(){J.ariaLiveNotifier.qab(ue.a.instance.fa(865),Ca.a.mZa)};this.jyf=function(){J.ariaLiveNotifier.readText(ue.a.instance.fa(866))};this.myf=function(){J.ariaLiveNotifier.readText(ue.a.instance.fa(867))};this.$=C;this.ariaLiveNotifier=e;this.$.da.Ha(219,this);this.K5a=vg.a.iN(C);this.gMa=
vg.a.iN(C)&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");this.fMa=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout")}function Kb(e){return Ri.call(this,e)||this}function dc(e,C,J){var ja=this;this.IGh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){ja.menuId&&Array.contains(ja.IGh,
ja.menuId)&&ja.frame.Ow(ja.menuId)};this.$=e;this.functionInfoManager=J;this.Sa=C;if(this.kF=vg.a.kF(this.$))this.formulaAssistanceManager=this.$.da.Aa(464);this.wM={};this.frame=this.$.frame;this.functionInfoManager.nnb(this.onFunctionInfoLoaded)}function Qb(e,C){var J=Wh.call(this,e,ue.a.instance.fa(1003),void 0,void 0,void 0,xe.EwaSettings.la(407))||this;J.FJa=null;J.mja=null;J.EJa=null;J.cub=null;J.hWe=null;J.lja=null;J.iWe=null;J.lWe=null;J.fmf=null;J.bub=null;J.xjd=!1;J.k1b=null;J.X5=null;J.Mwb=
null;J.onFunctionInfoLoaded=function(){if(!J.EJa.count){for(var ja=J.functionInfoManager.cWe,Aa=0,gb=ja.length;Aa<gb;++Aa)J.EJa.oM(ja[Aa],ja[Aa],!1).className=Fd.a.Coh;J.EJa.selectedIndex=0;fg.a.sc([J.k1b,J.X5,J.Mwb]);J.k1b=J.Qd.Ed(J.FJa);J.X5=J.Qd.Ed(J.mja);J.Mwb=J.Qd.Ed(J.bub);J.k1b.ka("change",J.vyf);J.X5.ka("change",J.OLi);J.X5.ka("dblclick",J.PLi);J.Mwb.ka("click",J.pca);J.Mwb.ka("keyup",J.RNi);Bd.DOMElementExtensions.setVisible(J.mja,!0);Bd.DOMElementExtensions.setVisible(J.hWe,!1);J.$.t5c&&
Bd.DOMElementExtensions.setVisible(J.fmf,!0)}J.vyf(null);J.getButton(0).get_element().disabled=!1;J.FJa.disabled=!1;J.CJb();J.xjd=!0};J.pca=function(){J.M$&&Ba(J.$,J.M$.HelpId,J.M$.IsDynamicUdf)};J.RNi=function(ja){13!==ja.keyCode&&32!==ja.keyCode||J.pca(ja)};J.vyf=function(){var ja=J.functionInfoManager.w_e(J.EJa.re.value);J.Qua(ja);J.mja.scrollTop=0;J.vZf()};J.OLi=function(){J.vZf()};J.PLi=function(ja){J.M$&&(nh.g(ja),J.close(0))};J.dd=function(ja,Aa){se.b(Aa)&&J.Cu()};J.functionInfoManager=e.da.Aa(19);
J.formulaAssistanceControl=e.da.Aa(221);J.bcd=vg.a.kF(J.$);J.bcd&&(J.formulaAssistanceManager=e.da.Aa(464));J.DIa=C;J.m_c=C.textBox.caretPosition;return J}function O(e){var C=Fe.a.dca,J=e.da.Aa(368);J&&!Oe.g(e).Cj&&(C=J.zoom);return C}function Ba(e,C,J){if(e)if(ra.instance.Eaa.argumentAssistanceLearnMoreCounter++,J){if(C&&(!C||C.startsWith("http://")||C.startsWith("https://"))){if(e.la(157)&&(e=e.da.Aa(269))&&e.sBa(C))return;Lb.HelperMethods.vf(C,"_blank",rh.a)}}else{J=new hh.a(-859308420,If.a.dc,
e.hd,0,null);var ja={};C=(ja[If.a.nd]=Ca.a.JZ,ja[If.a.Tg]="HelpID="+C,ja);e.Ka.Yb(J,C)}}function ra(){var e=this;this.Eaa=new Tb;this.CJa=new Ab;this.N2=new kc;this.yob=new mb;this.vb=null;this.jvc=new Wa;this.qd=function(){e.quj();e.vb.sendBeaconTraceTag(88392384,50,!1,"{0}",e.getJsonForLogging())};this.x$a=new ff.a}function ta(e){var C=this;this.Qqf=e;this.Q_=new cb;this.$6b=[];this.Hkc=-1;(this.Pqf=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&e&&(this.Q_.countAboveThresholds=
{},e.forEach(function(J){return C.Q_.countAboveThresholds[J]=0}))}function Fa(){this.P95=this.P75=this.median=this.max=this.average=0}function cb(){this.firstAction=this.failedCount=this.count=0;this.excludingFirstAction=this.includingFirstAction=null}function Wa(){this.smartFormulaBarAutoCompleteFlight=this.autoCompleteUIFlight=this.argumentAssistanceFlight=null}function mb(){this.formulaAssistanceRequestOptimizedCounter=this.formulaAssistanceRequestAttemptedCounter=0}function kc(){this.commitByMouseClickCounter=
this.commitByEnterKeyCounter=this.commitByTabKeyCounter=this.selectByMouseHoverCounter=this.selectByArrowKeyCounter=0}function Ab(){this.smartSuggestionCommittedCounter=this.smartSuggestionSelectedCounter=this.smartSuggestionShownCounter=0}function Tb(){this.argumentAssistanceCardInitialMode=null;this.argumentAssistanceMoveTotalCounter=this.argumentAssistanceMoveCounter=this.argumentAssistanceDragTotalCounter=this.argumentAssistanceDragCounter=this.argumentAssistanceDismissCounter=this.argumentAssistanceLearnMoreCounter=
this.argumentAssistanceExpandCounter=this.argumentAssistanceCollapseCounter=0}function ib(){}function Sa(e){var C=zd.call(this)||this;C.$=e;C.fc();return C}function Mb(e){var C=Rc.call(this,document.createElement("div"))||this;C.vR=!1;C.ZQ=!1;C.z0b=!1;C.Ih=null;C.Uh=null;C.Dhi=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConditionalHideAll",!1);C.Ehi=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConstButtonWidth",!1);C.vki=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5862418_LogDataValidationButtonWidth");
C.zpi=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.VisibilityOptimizationOnTaggedElements",!1);C.Xod=!1;C.Ppd=!1;C.Wmd=!1;C.m5b=[];C.Lh=function(){C.R3f(!1)};C.FOa=function(ja,Aa){C.show(C.lR,!C.isListVisible,!0,Rh.a.Wp||3===Aa.yb||3===If.a.dc);C.Kzd(null,null)};C.Kzd=function(){C.gridView.setFocus()};C.mLa=function(){C.Ya.textBox.mK=!0};C.ht=function(){C.deg()};C.onContentReady=function(){C.R3f(C.isListVisible)};C.qd=function(){C.Lx()};C.Eya=function(){C.pRa()};C.sxf=function(){C.deg()};
C.$=e;C.gridView=Oe.g(C.$);C.cJ=C.gridView.zc;var J="<div id='dv_reader_description' class='"+Hi.a.mOe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+Xb.Qoh+" "+k.a.Wo+"'></div>\r\n<div id='dv_list_box' class='"+Xb.Xnh+" "+k.a.Sk+" "+k.a.Wo+"'></div>\r\n<div id='dv_prompt_box' class='"+Xb.Ooh+" "+k.a.Wo+"'></div>";C.domElement.className=Xb.Poh;C.domElement.innerHTML=J;Rg.d(C.style,C.isGridRtl);C.gg=$get("dv_list_box",C.domElement);C.BW=$get("dv_prompt_box",C.domElement);
C.zha=$get("dv_list_button",C.domElement);C.U7a=$get("dv_reader_description",C.domElement);C.zpi&&(C.domElement.setAttribute(hb.a.AZa,"true"),C.gg.setAttribute(hb.a.AZa,"true"),C.BW.setAttribute(hb.a.AZa,"true"),C.zha.setAttribute(hb.a.AZa,"true"),C.U7a.setAttribute(hb.a.AZa,"true"));(J=Lk.a(e))&&Array.add(C.m5b,new Nb(e,J,C));Array.add(C.m5b,new Nb(e,C.gridView.zc,C));C.gridView.ha.HG(C.Lh);C.gridView.$q(C.onContentReady);C.gridView.qc.NEg(C.sxf);C.$.ul(C.qd);J=C.gridView.wj;J.insertBefore(C.domElement,
J.firstChild);C.onContentReady(null,null);e.da.Ha(14,C);return C}function Jc(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd){var we=wa.call(this,document.createElement("a"))||this;we.sl=!1;we.$c=function($e){we.raiseEvent("ClickButton",$e);return!0};we.onKeyDown=function($e){we.raiseEvent("KeyDown",$e);return!1};we.ww=function(){we.hovered=!0;we.raiseEvent("PointerOver");return!1};we.UN=function(){we.hovered=!1;we.raiseEvent("PointerOut");return!1};we.onBlur=function($e){nh.g($e);we.focused=!1;we.raiseEvent("Blur")};
we.onFocus=function($e){nh.g($e);we.focused=!0;we.raiseEvent("Focus")};we.Zkh=Mc;we.Ifh=Hc;we.iJ=Jc.Bb(we.domElement,C,J,ja,Aa,gb,bc,yd);we.xc.ka("contextmenu",function($e){nh.g($e)});we.enable();we.hovered=!1;we.focused=!1;e.appendChild(we.domElement);return we}function Ib(e,C,J){e=Mk.call(this,e,C,new bj.a(Xb.listItem,Xb.RAb,Xb.UAb,Xb.VAb))||this;e.rlb=null;e.re=null;e.Cda=null;e.$V=null;e.UHa=null;e.zxa=0;e.DEb=[];e.tdg=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateDvListHeightUsingItemHeight",
!1);e.avi=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5858877_logDvListBoxHeight");e.U7a=J;return e}function Nb(e,C,J){e=kk.call(this,e,C)||this;e.dataValidationControl=J;return e}function sa(e,C,J){var ja=Gk.call(this,e)||this;ja.T$=null;ja.WU=null;ja.hhf=!1;ja.errorMessage=null;ja.V8e=null;ja.wm=null;ja.eea=null;ja.qGe=function(Aa){var gb=ja.$,bc=ja.hhf;ja.hide();var Mc=Oe.g(gb);Mc.isEditing&&Mc.zc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Aa&&bc&&Pd.TaskExtensions.Ba(Mc.startEdit(!1,
1),function(){var yd=Mc.zc.textBox;yd.text&&yd.selectRange(0,yd.text.length)},ja.ma,11,Df.a.current);if(1===Aa&&!bc){if(bc=Mc.wc(null)){Mc.Ca.IV();var Hc=Object.assign(new Hd.a,{Text:xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5785565_FixDataValidationErrorDialogHandlerBug")?bc.cell.userInput:bc.originalText});Mc.setCell(Hc,bc.range,0,63,null)}gb.ye(-798660877,If.a.dc,8,null)}2===Aa&&Pd.TaskExtensions.Ba(Mc.startEdit(!1,0),function(){var yd=Mc.zc.textBox;yd.text&&yd.selectRange(0,yd.text.length)},
ja.ma,11,Df.a.current)};ja.p9a=function(){Lb.HelperMethods.wca(ja.$.OI,ja.error.HelpTopicId,ja.$.xX)};ja.JNi=function(){ja.Xwb();ja.$.ye(802602464,2,8,ja.WU)};ja.fMi=function(){Gd.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};ja.gMi=function(Aa){!Aa||xh.a(Aa)?Gd.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(Aa=ja.iYh(Aa.Result),ja.T$.errorInformation=Aa,ja.gBc(ja.OIa,ja.Egd(ja.qGe),ja.T$))};ja.$zd=function(){ja.show(ja.kRb)};ja.DMe=J;ja.sqmManager=pk.a(ja.$);ja.error=sa.TQ(C,e,J);ja.Ab.Lp=ja;e=e.da.Aa(14);ja.Gu=e.v3a(ja.DMe);ja.OIa=ja.Gu&&ja.Gu.OIa?ja.Gu.OIa:ue.a.instance.fa(1687);ja.Yqj();ja.initializeAndShow(ja.OIa,ja.qGe,ja.T$);return ja}function Va(e,C,J){var ja=Jj.call(this,e,Va.TQ(C,e,J))||this;ja.od=function(){ja.setFocus()};Oe.g(ja.$).ha.MG(ja.od);xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&
(e=e.da.Aa(14).v3a(J))&&e.options&1&&Gd.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return ja}function Xb(){}function mc(e){var C=Tk.call(this)||this;C.$=e;C.fc();return C}function od(e,C){var J=this;this.xZa=null;this.bCf=function(ja,Aa){1<Aa.length&&(ja=ue.a.instance.fa(840),J.ariaLiveNotifier.bNf(ja,Aa.length))};this.cCf=function(ja,Aa){Gd.ULS.shipAssertTag(537167961,0,0<=Aa.selectedIndex&&
0<=Aa.length&&Aa.selectedIndex<Aa.length,"Invalid ListEventArgs: SelectedIndex/Length");Gd.ULS.shipAssertTag(537167960,0,!!Aa.vI,"ListEventArgs: SelectedValue should not be null");J.ariaLiveNotifier.O6i(Aa.vI,Aa.selectedIndex+1,Aa.length)};this.dCf=function(ja,Aa){J.ariaLiveNotifier.QPa(Aa.vI)};this.ariaLiveNotifier=e;C.Ha(213,this)}function ld(e){var C=vi.call(this)||this;C.$=e;C.fc();return C}function Zc(e){var C=ug.call(this)||this;C.$=e;C.fc();return C}function Rb(e,C){var J=this;this.dNa=1;this.Hga=
[];this.active=!1;this.xw=function(){var ja=J.gridView.zhd();if(!(0>=ja||ja===J.dNa||J.gridView.Pq)){for(var Aa=!1,gb=[],bc=[],Mc=J.Hga.length-1;0<=Mc;Mc--){var Hc=J.Hga[Mc];if(J.yhd(Hc)>ja||Hc.bottom<ja)Array.add(gb,Hc),Array.removeAt(J.Hga,Mc),Aa=!0}for(Mc=J.tableManager.rangeList.length-1;0<=Mc;Mc--){Hc=J.tableManager.rangeList[Mc];var yd=J.yhd(Hc);yd<=ja&&Hc.bottom>=ja&&!(yd<=J.dNa&&Hc.bottom>=J.dNa)&&Hc.Sva&&(Array.add(bc,Hc),Aa=!0)}if(Aa)for(Hc=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",
!1)?J.gridView.Xoc:[J.gridView.h3],Mc=yl(Hc),Hc=Mc.next();!Hc.done;Hc=Mc.next())for(yd=yl(Hc.value),Hc=yd.next();!Hc.done;Hc=yd.next()){var we=yl(Hc.value);for(Hc=we.next();!Hc.done;Hc=we.next()){for(var $e=Hc.value,Gf=$e.En,ag=Dk.a($e.P4),Nf=gb.length-1;0<=Nf;Nf--)Hc=gb[Nf],J.Szc(Hc,!1,ag,Gf)&&Array.removeAt(gb,Nf);for(Nf=bc.length-1;0<=Nf;Nf--)Hc=bc[Nf],J.Szc(Hc,!0,ag,Gf)&&Array.add(J.Hga,Hc);Aa&&$e.BOd(ag)}}else Gd.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
J.dNa=ja}};this.lzf=function(ja,Aa){Aa.isRow||Aa.AVc(J.TKa)};this.mzf=function(ja,Aa){Aa.isRow||(J.tableManager.rangeList.length||J.deactivate(),Aa.GJd(J.TKa))};this.TKa=function(ja,Aa){if(J.ue())J.activate();else if(ja=J.active,J.deactivate(),!ja){Gd.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(Aa=Aa.jw)&&J.S5f(Aa.En[0],Aa.En[Aa.En.length-1],Aa.P4,Aa.En)};this.WBf=function(ja,Aa){!J.gridView.Pq&&(J.ue()?J.activate():
(ja=J.active,J.deactivate(),ja||Gd.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Aa=Aa.jw)&&(ja=Dk.a(Aa.P4),J.S5f(Aa.En[0],Aa.En[Aa.En.length-1],ja,Aa.En)&&Aa.BOd(ja))};this.Re=function(){J.gridView.$a.L4?J.deactivate():J.activate()};this.tableManager=e;this.gridView=C;this.$=C.$;e.ooe(this.WBf);C.lFg(this.lzf);C.mFg(this.mzf);this.$.xa.Qf(this.Re);this.$.zb.Qf(this.Re);this.Lre(function(ja){ja.AVc(J.TKa)});this.ue()&&(this.activate(),
this.xw(this,null));this.$.da.Ha(68,this)}function fd(e){return cl.call(this,e)||this}function wd(e,C,J,ja,Aa,gb){var bc=this;this.uA=null;this.g_a=1461300262;this.ax=this.c_a=this.y8a=this.d$b=null;this.rOi=function(Mc,Hc){if(!xh.a(Mc)&&Hc){var yd=!!Mc&&!!Mc.RequestTelemetryData;Oe.g(bc.$).Li.wla(Hc,Mc.StateId,yd?Mc.RequestTelemetryData.EcsOperationDuration:0,yd?Mc.RequestTelemetryData.EcsRequestDuration:0,yd?Mc.RequestTelemetryData.WfeRequestDuration:0)}};this.Upb=function(){if(bc.gridView.e6a){var Mc=
bc.$.da.Aa(254,!0);Mc&&Mc.xdj(bc.Upb);bc.gridView.e6a=!1;bc.gridView.Gh.gu(Ca.a.Uaa);bc.gridView.ha.j0(bc.Ybd);Oe.g(bc.$).$.If()}};this.Ybd=function(){var Mc=bc.d$b;bc.d$b=kf.d(bc.$.xa.pa);if(Mc===bc.d$b)if(bc.gridView.ha.j0(bc.Ybd),(Mc=bc.$.da.Aa(254,!0))&&Mc.HZc(36,Oe.g(bc.$).ha.va.selectedRanges)){Mc=new hh.a(1804571062,2,2,0,null);var Hc={};bc.$.Ka.Yb(Mc,(Hc[Ca.a.skipClipboardAccess]=!0,Hc[Ca.a.n0c]=!0,Hc[Ca.a.isFormatPainter]=!0,Hc)).continueWith(function(){bc.Upb()})}else bc.gridView.Gh.VG(!1)};
this.$=e;this.gridView=C;this.Fh=J;this.oB=ja;this.borderFormatManager=Aa;this.moreColorsHelper=gb;this.Ibd=new cc(this.$);this.Eb=xe.EwaSettings.Eb();this.Qkc=new Ad(this.$,J);this.PC=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.kn=xe.EwaSettings.kn()}function Ad(e,C){this.$=e;this.Fh=C;this.eE=new je(Oe.g(this.$).Ca,this.$);this.Lgf=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.iyb=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");
this.bpd=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.Fgc=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Qef=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.uhi=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix")}function Ne(){this.scenario=0;this.xaa=null}function Ve(){this.KQa=
this.rGa=this.lNa=this.eTa=0}function Kd(e,C,J,ja){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=e;this.targetSheetRange=C;this.fillRangeType=J;this.fillRangeDirection=ja}function Ud(e,C,J){var ja=yk.call(this,e)||this;ja.fo=null;ja.C6c=0;ja.ddi=function(Aa,gb){if(0===Aa)Gd.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Aa={};var bc="",Mc=1035996630;switch(gb.selectedKey){case 0:bc=
1896159024===ja.pp?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:bc=1896159024===ja.pp?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===ja.pp?(bc="InsertRows",Mc=-1113896058):(bc="DeleteRows",Mc=1554436520);break;case 3:1896159024===ja.pp?(bc="InsertColumns",Mc=1415868706):(bc="DeleteColumns",Mc=674605324)}Gd.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",bc);gb=new hh.a(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5933270_RespectProtectionSettingsInInsertDeleteDialog")?
Mc:1035996630,1,2,8,null);Aa[If.a.nd]=bc;ja.$.Ka.Yb(gb,Aa)}};ja.pp=C;ja.selectedRanges=J;e=Object(X.a)(qh.a,ja.$.xa.pa);ja.isRtl=e.displayRtl;return ja}function te(e,C,J,ja,Aa,gb){var bc=this;this.a0d=!1;this.b0d=null;this.nDc=0;this.ij=null;this._state=0;this.moveNext=function(){try{for(bc._state=1;1===bc._state;)bc.vu=bc.vu()}catch(Mc){bc.dispose(),bc._state=3}};this.Bf=e;this.$Ba=C;this.ZBa=this.P_d=Aa;this.EOb=gb;this.vu=this.TL;this.moveNext()}function oe(e,C,J,ja,Aa,gb,bc,Mc){var Hc=this;this.kDc=
0;this.d0d=this.oDc=!1;this.ij=this.f0d=null;this._state=0;this.moveNext=function(){try{for(Hc._state=1;1===Hc._state;)Hc.vu=Hc.vu()}catch(yd){Hc.dispose(),Hc._state=3}};this.Bf=e;this.$Ba=C;this.Khg=Aa;this.ZBa=this.P_d=gb;this.EOb=bc;this.O_d=Mc;this.vu=this.TL;this.moveNext()}function Ke(e,C,J,ja,Aa){this.sVe=0;this.fpg=e;this.gpg=C;this.bxg=J;this.fWb=ja;this.sVe=void 0===Aa?0:Aa}function cc(e){var C=this;this.yBi="+mn-lt";this.uyi="+mj-lt";this.Yqf="MinorThemeFont";this.tpf="MajorThemeFont";
this.$Qi=function(J){C.zgf=!0;C.zTg=null;C.$.YE(function(ja){ja.tPa("FontName_New")});Gd.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",J))};this.$=e;this.ngi=!!String.fromCodePoint&&!Rh.a.Af&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.zgf=!1;this.zTg=null;this.kn=xe.EwaSettings.kn()}function sd(e){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=e}function zc(e){var C=ok.call(this)||this;C.$=e;
C.fc();return C}function nd(e){return Hj.call(this,e)||this}function rb(e,C){var J=this;this.l$b=this.xFd=null;this.ryf=function(){xe.EwaSettings.la(689)||J.ttc();if(J.l$b){var ja=Kj.a(Gg.a.Ra.ie,J.l$b);Gd.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",ja);J.l$b=null}J.$Ff()};this.$=e;this.gridView=Oe.g(e);this.uF=C.A0a(this.$.domElement,500,null,null);this.IKa=this.HKa=-1}function Zd(e){this.freezeOptions=
null;this.freezeOptions=e}function qc(){}function pd(e){var C=pj.call(this)||this;C.imj="formulaAssistance";C.$=e;C.fc();return C}function ne(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function be(e){var C=rj.call(this)||this;C.$=e;C.fc();return C}function td(e){var C=this;this.eE=this.calcManager=this.Cl=this.iSa=null;this.HLi=function(J,ja){if(J&&!xh.a(J)&&ja){var Aa=!!J&&!!J.RequestTelemetryData;Oe.g(C.$).Li.wla(ja.toString(),J.StateId,Aa?J.RequestTelemetryData.EcsOperationDuration:0,Aa?J.RequestTelemetryData.EcsRequestDuration:
0,Aa?J.RequestTelemetryData.WfeRequestDuration:0)}};this.$=e;this.$.da.Za(268,function(J){C.Cl=J});this.rFh=new $d(Oe.g(this.$).Ca,this.$);this.V2=new ee(this.$,Oe.g(this.$),this);this.$.da.Za(266,function(J){C.calcManager=J});this.Eb=xe.EwaSettings.Eb();this.kn=xe.EwaSettings.kn()}function Qe(e,C){this.success=e;this.iH=C}function Qf(){this.Yfg=this.eYj=!1;this.source=0;this.yLa=this.lhc=!1}function pf(e,C,J,ja,Aa){J=void 0===J?null:J;ja=void 0===ja?null:ja;Aa=void 0===Aa?null:Aa;Gd.ULS.shipAssertTag(537162128,
0,!!(!!(null!=J^!(void 0===ja||null===ja))^!(void 0===Aa||null===Aa))&&!(null!=J&&void 0!==ja&&null!==ja&&void 0!==Aa&&null!==Aa),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=J&&0>J&&(Gd.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),J=null);this.Cl=e;this.aq=C;this.epg=J;this.Z8a=ja;this.Hqa=Aa}function $d(e,C){this.eE=null;this.Ca=e;this.q2a=C}function je(e,C){this.Ca=e;this.q2a=C}function md(e,C,J){this.success=
e;this.Ulc=void 0===C?null:C;this.reason=void 0===J?"":J}function ee(e,C,J){var ja=this;this.Vca=[];this.calcManager=this.Qyc=this.lastSetCellInstantaneousOperation=null;this.$=e;this.grid=C;this.Fh=J;this.Pca=ee.YGe;this.$.da.Za(268,function(Aa){ja.Qyc=Aa});this.$.da.Za(266,function(Aa){ja.calcManager=Aa})}function qf(e,C,J,ja){this.rangeDelta=e;this.stateId=C;this.isFinished=J;this.priorityGroup=ja}function Fc(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd,we,$e,Gf,ag,Nf,Pg,Jh,jj,Xi,vj,qj,Xj,Yk,Yi,Zk){this.numberOfDependentRecalcedCellsInBatch=
this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=
!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===e?0:e;this.numberOfNonUpdatedCells=void 0===C?0:C;this.numberOfUpdatedCells=void 0===J?0:J;this.numberOfCellsUpdatedAlreadyByServer=void 0===
ja?0:ja;this.numberOfCellsSkippedDueToTimeout=void 0===Aa?0:Aa;this.numberOfCellsWithNoFormattedCell=void 0===gb?0:gb;this.numberOfUnsupportedErrorCellTypes=void 0===bc?0:bc;this.numberOfUnsupportedBlankCellTypes=void 0===Mc?0:Mc;this.numberOfUnsupportedRichCellTypes=void 0===Hc?0:Hc;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===yd?0:yd;this.totalExecutionTime=void 0===we?0:we;this.originalProcessingTimeLimit=void 0===$e?0:$e;this.newProcessingTimeLimit=void 0===Gf?0:Gf;this.numberOfEditedRecalcedCellsInBatch=
void 0===ag?0:ag;this.numberOfDependentRecalcedCellsInBatch=void 0===Nf?0:Nf;this.isNewTask=void 0===Pg?!1:Pg;this.lastSetCellInstantaneousOperation=void 0===Jh?"":Jh;this.taskId=void 0===jj?0:jj;this.isNewNumberFormatter=void 0===Xi?null:Xi;this.numberOfRecalcedCellsWithFormattedValue=void 0===vj?null:vj;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===qj?null:qj;this.totalNumberFormatterTime=void 0===Xj?null:Xj;this.newNumberFormatterFinalizeFailures=void 0===Yk?null:Yk;this.numberOfMeasureTextWidthCalls=
void 0===Yi?null:Yi;this.numberOfHashFormattedValues=void 0===Zk?null:Zk}function Ed(){}function Sd(e,C,J,ja,Aa){this.lU=void 0===e?0:e;this.cellValue=void 0===C?"":C;this.ifmt=void 0===J?0:J;this.priorityGroup=void 0===ja?"":ja;this.iH=void 0===Aa?"":Aa}function qd(e){e=ke(e);if(0===e)return 1;if(1===e)return 2;Gd.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function ke(e){if(e.priorityGroup===Cd.editCell)return 0;if(e.priorityGroup===
Cd.dependentCell)return 1;Gd.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function Se(e,C){var J=ke(C),ja=!(void 0===C.rangeDelta.data.format||null===C.rangeDelta.data.format);Gd.ULS.shipAssertTag(537162187,0,0===J||!ja,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",C.priorityGroup);e=Math.max(e.cell.Dm,0);ja&&(ja=excelOnlineCalc.calc.getCellFormatKind(C.rangeDelta.data.format.format),
"number"===ja?e=C.rangeDelta.data.format.format:"string"===ja?Gd.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===ja?Gd.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):Gd.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return e}function of(e){var C=e.value;switch(e.type){case 2:return void 0===C||null===C?"":C;case 1:return e=
parseFloat(C),isNaN(e)?null:e;case 3:return e=parseFloat(C),isNaN(e)?null:1===e;case 4:return e=parseFloat(C),isNaN(e)?null:excelOnlineCalc.calc.errorValue(e);default:return excelOnlineCalc.calc.blankValue}}function vc(e){e=excelOnlineCalc.calc.getCellValueKind(e.rangeDelta.data.value);var C=0;switch(e){case "number":C=1;break;case "string":C=2;break;case "boolean":C=3;break;case "Error":C=4;break;case "Blank":C=0;break;default:Gd.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",
e)}return C}function id(e,C){e=excelOnlineCalc.calc.getCellValueKind(e.rangeDelta.data.value);switch(e){case "number":case "string":case "boolean":return!0;case "Blank":if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;C.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;C.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return C.numberOfUnsupportedRichCellTypes++,
!1;default:return Gd.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",e),!1}}function Ac(e){if(e=e.color){if("String"===Object.getType(e).getName())return Ae.a.Sp(e);if("Number"===Object.getType(e).getName())return null}else return null;Gd.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function Yd(e){switch(e.alignment){case "Center":return 2;case "Left":return 1;
case "Right":return 3;default:return Gd.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function Cd(){}function wf(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd,we,$e,Gf){$e=void 0===$e?null:$e;Gf=void 0===Gf?null:Gf;Mc=yc.call(this,11,0,Mc,we)||this;Mc.qFh=e;Mc.Xbd=C;Mc.format=ja;Mc.activeCell=J;Mc.Gre=Aa;Mc.RHf=gb;Mc.MHf=bc;Mc.$Ea=Hc;Mc.clientCorrelationId=yd;Mc.Nlb=$e;Mc.bib=Gf;return Mc}function Vb(){}function wc(e){var C=ek.call(this)||
this;C.LRb=null;C.$=e;C.fc();return C}function yb(e){var C=Fh.call(this)||this;C.BJf=0;C.eH=null;C.e_g=function(J,ja){if(1===J&&C.eH.FileCollectionErrorStateId){J=C.$.na.ta;var Aa=C.eH.MessageId,gb=C.eH.OriginalEcsServerId,bc=C.eH.FileCollectionErrorStateId,Mc=J.Na(0);Mc.errorMessageId=Aa;Mc.ecsServerId=gb;Mc.fileCollectionErrorStateId=bc;Mc.userComment=ja;J.AZc("CollectFile",Mc,null,null,null,null,0)}C.raiseEvent("fileCollectionComplete",null,C)};C.$=e;return C}function oc(e){var C=yj.call(this,
!1,!1,oc.vy)||this;C.evd=!1;C.dpf=!0;C.oof=0;C.kc=1;C.Gc(1,CommonUIStrings.l_Send);C.Gc(0,CommonUIStrings.l_NoThanks);C.eg=Wc.ljg;C.hof=e;C.Ve=oc.aTg;return C}function Wc(){}function Qd(e){return gj.call(this,e)||this}function Sc(){}function Yc(e,C,J,ja){var Aa=Zj.call(this,e)||this;Aa.eCb=null;Aa.Tkc=null;Aa.Hec=null;Aa.o3=null;Aa.Aka=!1;Aa.disposed=!1;Aa.RMa=!1;Aa.gh=null;Aa.Jzd=function(gb){Gd.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(Aa.disposed)Gd.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(xh.a(gb)){Gd.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",gb?dh.a.Uc(gb.Errors):null);if(gb.Errors&&1===gb.Errors.length){var bc=gb.Errors[0].MessageId,Mc=Aa.bed(bc);if(Mc){Aa.Uzj(bc)?Aa.fvj(Mc):Aa.nv(Mc);Aa.ola("OkInvalidByServer",
gb.Errors[0].MessageIdName);return}}Gd.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",dh.a.Uc(gb.Errors))}Aa.ola("OkValid","None");Aa.hide()}};Aa.u5c=function(gb){Aa.OW(gb);2!==gb&&(Aa.gh=Aa.$.Wb.Ic("UserAction","DataValidationEditTimeToDialogTryClose"));1===gb?Aa.G9a():2===gb?Aa.oya():Aa.Ula()};Aa.qca=function(){Aa.MRj();Aa.RMa?Aa.qze():Aa.o0c();return Aa.Aka=!1};Aa.selectedRanges=C;Aa.jRb=J;Aa.command=
ja;3===ja&&(Aa.Aka=!0);Aa.kc=2;Aa.Cv=!1;Aa.eg=Uc.eg;return Aa}function pc(e,C){this.options=this.cellRange=null;this.cellRange=e;this.options=C}function Be(e,C){var J=lj.call(this,e)||this;J.O9=null;J.rha=null;J.bUa=null;J.Q9=null;J.P9=null;J.dnc=function(){J.O9.checked?(J.rha.disabled=!1,J.bUa.disabled=!1,J.Q9.disabled=!1,J.P9.disabled=!1):(J.rha.disabled=!0,J.bUa.disabled=!0,J.Q9.disabled=!0,J.P9.disabled=!0);return!1};J.get_visible=J.Tja;J.set_visible=J.Cna;J.vk=C;J.nka();return J}function Ce(e,
C){var J=mk.call(this,e)||this;J.eba=null;J.ibf=null;J.gba=null;J.fba=null;J.enc=function(){J.eba.checked?(J.gba.disabled=!1,J.fba.disabled=!1):(J.gba.disabled=!0,J.fba.disabled=!0);return!1};J.get_visible=J.Tja;J.set_visible=J.Cna;J.vk=C;J.nka();return J}function Xe(){}function ob(e,C,J,ja){var Aa=rk.call(this,e)||this;Aa.utb=null;Aa.SMd=null;Aa.Aka=!1;Aa.disposed=!1;Aa.RMa=!1;Aa.gh=null;Aa.xWj=function(gb,bc){Aa.yac(gb);var Mc=Aa.oZd();gb=Mc.errorString;var Hc=Mc.wq;if(Mc.returnValue)return Aa.G5a(121,
Aa.lOh(Aa.$,bc),0,Aa.tba,!1),"";Aa.ola("OkInvalidByClient",Hc);return gb};Aa.u5c=function(gb){Aa.OW(gb);Aa.gh=Aa.$.Wb.Ic("UserAction","DataValidationEditTimeToDialogTryClose");0===gb&&Aa.Ula()};Aa.selectedRanges=C;Aa.jRb=J;Aa.command=ja;3===ja&&(Aa.Aka=!0);Aa.kc=2;Aa.Cv=!1;return Aa}function Ic(e,C,J,ja,Aa,gb,bc,Mc){Mc=e.Na(9,void 0===Mc?null:Mc);Mc.selectedRanges=C;Mc.ruleOptions=J;return jg.i(e,"CreateOrEditDataValidation",Mc,ja,Aa,gb,bc,0)}function Cc(e,C,J){var ja=Ci.call(this,C)||this;ja.gwa=
null;ja.iec=null;ja.YT=null;ja.WK=null;ja.Mya=null;ja.Nya=null;ja.r5a=null;ja.rNa=null;ja.c$a=null;ja.ZOa=null;ja.Eoc=null;ja.lCd=null;ja.GDh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];ja.Smj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];ja.cnc=function(Aa){var gb=!1;(null===Aa||void 0===Aa?0:Aa.Ea)&&(Aa.Ea.keyCode===ve.a.Ioa||Aa.Ea.keyCode===ve.a.Zh)&&(gb=ja.qca(Aa),ja.YT.blur(),
ja.WK.blur());return gb};ja.qca=function(){var Aa=ja.YT.selectedIndex,gb=ja.WK.selectedIndex;ja.Eoc.innerText=ja.Uub(Aa,gb);ja.lCd.innerText=ja.Jgd(Aa,gb);switch(Aa){case 0:return ja.WK.disabled=!0,Bd.DOMElementExtensions.setVisible(ja.c$a,!1),Bd.DOMElementExtensions.setVisible(ja.ZOa,!1),Bd.DOMElementExtensions.setVisible(ja.r5a,!1),Bd.DOMElementExtensions.setVisible(ja.rNa,!1),ja.gwa.disabled=!0,!1;case 3:return ja.WK.disabled=!0,Bd.DOMElementExtensions.setVisible(ja.c$a,!0),Bd.DOMElementExtensions.setVisible(ja.ZOa,
!1),Bd.DOMElementExtensions.setVisible(ja.r5a,!0),Bd.DOMElementExtensions.setVisible(ja.rNa,!0),ja.gwa.disabled=!1;case 7:return ja.WK.disabled=!0,Bd.DOMElementExtensions.setVisible(ja.c$a,!0),Bd.DOMElementExtensions.setVisible(ja.ZOa,!1),Bd.DOMElementExtensions.setVisible(ja.r5a,!1),Bd.DOMElementExtensions.setVisible(ja.rNa,!1),ja.gwa.disabled=!1;default:ja.gwa.disabled=!1,Bd.DOMElementExtensions.setVisible(ja.c$a,!0),Bd.DOMElementExtensions.setVisible(ja.rNa,!1)}switch(gb){case 0:case 1:Bd.DOMElementExtensions.setVisible(ja.ZOa,
!0);break;default:Bd.DOMElementExtensions.setVisible(ja.ZOa,!1)}ja.WK.disabled=!1;ja.Eoc.disabled=!1;Bd.DOMElementExtensions.setVisible(ja.r5a,!1);Bd.DOMElementExtensions.setVisible(ja.rNa,!1);return!1};ja.get_visible=ja.Tja;ja.set_visible=ja.Cna;ja.uR=new va.a;ja.uR.add(ue.a.instance.fa(1627));ja.uR.add(ue.a.instance.fa(1628));ja.uR.add(ue.a.instance.fa(1631));ja.uR.add(ue.a.instance.fa(1629));ja.uR.add(ue.a.instance.fa(1630));ja.uR.add(ue.a.instance.fa(1632));ja.uR.add(ue.a.instance.fa(1633));ja.uR.add(ue.a.instance.fa(1634));
ja.uR.add(ue.a.instance.fa(1635));ja.uR.add(ue.a.instance.fa(1636));ja.uR.add(ue.a.instance.fa(1637));ja.uR.add(ue.a.instance.fa(1638));ja.uR.add("");ja.$=e;ja.vk=J;ja.nka();return ja}function Uc(){}function Tc(e,C){var J=this;this.CB=this.W0a=this.selectedRanges=null;this.jKe=!1;this.gh=null;this.eMi=function(ja){Gd.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ja||xh.a(ja)?Gd.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(J.W0a=ja.Result,J.o1i())};this.Gzh=function(ja){J.OW("DataValidationEdit.ExpandExisitngDialog",ja);J.CB.c=Tc.tia(ja);1===ja?J.uHa(new ce(J.W0a)):2===ja?J.uHa(new ce):J.Anf()};this.rXi=function(ja){J.OW("DataValidationEdit.OverrideExisitngDialog",ja);J.CB.c=Tc.tia(ja);1===ja?J.uHa(new ce):J.Anf()};this.$=e;this.v5c=C}function ce(e){this.k5=(e=void 0===e?null:e)?e.IsIgnoreBlank:!0;this.l5=e?e.IsInCellDropDown:!0;this.XN=e?e.LowerBoundary:"";this.YN=e?e.UpperBoundary:"";this.sB=e?e.ConditionType:0;
this.ruleType=e?e.RuleType:0;this.RZ=e?e.IsAlertBlocking:!0;this.XT=e?e.AlertTitle:"";this.WT=e?e.AlertMessage:"";this.EV=e?e.InputMessage:"";this.eF=e?e.InputTitle:"";this.v5=e?e.IsShowErrorAlert:!0;this.w5=e?e.IsShowInputMessage:!0}function ye(e){switch(e){case 0:e="AnyValue";break;case 1:e="WholeNumber";break;case 2:e="Decimal";break;case 3:e="List";break;case 4:e="Date";break;case 5:e="Time";break;case 6:e="TextLength";break;case 7:e="Custom";break;default:e="Unknown"}return e}function Kf(e){switch(e){case 0:e=
"Between";break;case 1:e="NotBetween";break;case 2:e="Equal";break;case 3:e="NotEqual";break;case 4:e="GreaterThan";break;case 5:e="LessThan";break;case 6:e="GreaterThanOrEqual";break;case 7:e="LessThanOrEqual";break;default:e="Unknown"}return e}function yf(e){var C=xj.call(this)||this;C.$=e;C.fc();return C}function Pf(e,C,J){var ja=this;this.Oxc={};this.Nd=!1;this.Zk=function(Aa,gb){ja.showContextMenu(void 0===gb?null:gb)};this.Fwf=function(Aa,gb){gb.NAi===Pf.C2h&&Oe.g(ja.$).focus()};this.F_=function(Aa,
gb){Aa=ja.$.Ka.Iaa(gb.de.command);(null===Aa||void 0===Aa?0:Aa.dismissesContextualUI)&&ja.I3()};this.j6=function(){ja.$.da.JU(342);Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.create(ja.$.da,338,ja.$.ma,3),function(Aa){Aa=Aa.result;for(var gb=yl(ja.Oxc),bc=gb.next();!bc.done;bc=gb.next())bc.value.COf(Aa)},ja.$.ma)};this.$=e;this.contextMenuController=J;this.v6d=new ec(this.$);e.da.Ha(8,this);for(J=0;J<C.length;J++)this.Oxc[Pf.E2g[J]]=C[J];this.ha=Oe.g(e).ha;this.ha.HYb(this.Zk);this.$.Ka.AFa(this.Fwf);
Tj.a.instance.vuj();xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.xFa(this.F_);xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.H9(this.j6)}function ec(e){this.GTe=null;this.$=e;this.w8a=new Jd;xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.GTe=new Qc(this.$))}function Qc(e){var C=
this;this.yZa=null;this.NQd=!1;this.IAb=0;this.a9c=1;this.SMe=0;this.qDb=function(J){C.sLf(J.domElement,J.hashCode)};this.ROf=function(J){for(var ja=0;window.performance.now()-J<C.Qmh&&0<C.yZa.length;)C.tme(C.yZa.shift()),ja++;Gd.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",C.a9c,ja,C.yZa.length);0<C.yZa.length?C.IAb=window.requestAnimationFrame(C.ROf):(Gd.ULS.sendTraceTag(537167051,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",C.a9c,window.performance.now()-C.SMe),C.a9c++,C.IAb=0)};this.onPointerDown=function(J){Eh.a.slim(J.Ea.rawEvent);return!1};this.$=e;this.gridView=Oe.g(this.$);this.B$h();this.Qmh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function Dd(){this.Yd=this.nte=this.cell=null}function Jd(){this.jdc={}}function ze(){this.menuModel=null;this.BFe=0}function ie(){this.dictionary=this.de=null}function jf(e){var C=
Wi.call(this)||this;C.zaf=!1;C.yld=function(){var J;(J=C.$.da.Aa(342))?C.Gb(J):C.$.YE(function(ja){ja.xld().then(function(Aa){(J=C.$.da.Aa(342))?C.Gb(J):(J=new mf(C.$,Aa),C.Gb(C.$.da.Ha(342,J)))})})};C.$=e;C.fc();return C}function mf(e,C){this.Fqb=C;this.$=e}function vf(e){return wj.call(this,e)||this}function rg(e,C,J,ja){e=Te.call(this,e,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,rg.VKj,!0,!1,rg.$Hb,C,J,!1,ja)||this;e.L0a=0;e.Asa=null;e.iKa=null;e.zKe=null;return e}function he(e,C,J){this.type=
e;this.z2g=C;this.pp=J}function eg(e,C,J,ja){return de.call(this,e,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",C,J,!0,ja)||this}function tg(e,C,J,ja){e=Vi.call(this,e,"PopulateSheetOpsContextMenu",274207288,-1497523576,gi,!0,!1,"SheetTabContextMenuRootName",C,J,!1,ja)||this;e.ngc=!1;e.Mhc=!1;return e}function Wd(e,C,J,ja){C=Yf.call(this,e,"PopulateRichTextContextMenu",679816325,1151222423,hg,!0,!1,hg,C,J,!0,ja)||this;C.grid=Oe.g(e);return C}
function Mf(e,C,J,ja){C=tf.call(this,e,"PopulateTableFieldListContextMenu",-751848458,-1085236154,fe,!0,!1,"TableFieldListContextMenuRoot",C,J,!1,ja)||this;C.N4b=null;C.vyd=0;C.GUb=null;C.grid=Oe.g(e);return C}function Rd(){}function Ze(e,C,J,ja){var Aa=ic.call(this,e,"PopulatePivotTableContextMenu",-1475408662,1114549926,ti,!0,!1,"PivotTableContextMenuRootName",C,J,!0,ja)||this;Aa.Vc=null;Aa.activeCell=null;Aa.ICc=null;Aa.Yhc=!1;Aa.hod=!1;Aa.expandCollapse=!1;Aa.refresh=!1;Aa.lZ=!1;Aa.ag=null;Aa.Oz=
null;Aa.p0a=null;Aa.Db=null;Aa.O$a=null;Aa.sba=!1;Aa.YMi=function(gb){gb&&!dh.a.lh(gb.Errors)&&Aa.Vc&&(Aa.Vc.Po=gb.Result,Aa.pJb());Aa.showPivotTableContextMenu()};Aa.XMi=function(){};Aa.NQi=function(){Aa.tbb()};Aa.MQi=function(){Aa.tbb()};Aa.DHi=function(){Aa.tbb()};Aa.CHi=function(){Aa.tbb()};Aa.Zt=function(){Aa.xXd();Aa.sba=!1};Aa.ft=function(){if(Aa.sba){Gd.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
var gb=Aa.Vc;Aa.grid.Sb.Zo(Aa.grid.ha.va.activeCell)!==gb&&(Aa.tbb(),Aa.O7h())}};Aa.Mhh=new DOMParser;Aa.Fxj=!0;Aa.grid=Oe.g(e);Aa.Jkc=!0;return Aa}function Xf(e,C,J,ja){return Xd.call(this,e,"PopulatePivotContextMenu",2123758504,912277356,C,J,ja)||this}function bg(e,C,J,ja){e=Tg.call(this,e,"PopulateFieldWellContextMenu",1374696078,495005930,Hg,!0,!1,Hg,C,J,!1,ja)||this;e.cell=null;e.ko=null;e.yo=null;e.externalSourceIndex=-1;e.D_d=-1;e.rSa=0;e.cyc=-1;e.ML=null;e.isOlap=!1;e.OH=!1;e.s2a=!1;return e}
function mg(e,C,J,ja,Aa,gb,bc,Mc,Hc){var yd=$f.call(this,Aa,ue.a.instance.Cb(60),!0,2,!0)||this;yd.v3f=!0;yd.Aje=null;yd.eSa=null;yd.Tfa=null;yd.xrb=null;yd.q5c=null;yd.wRc=null;yd.xHi=function(we){gh.a.any(we.Errors,function($e){return-103190598===$e.MessageId})&&yd.JSa.Gij()};yd.HNi=function(we){we&&!xh.a(we)&&(we=we.Result,yd.q5c.innerHTML=ue.a.instance.fa(1054)+Dg.a.Lf(we.ValueFieldSourceName),yd.isOlap&&!yd.OH?(yd.JSa.enabled=!1,yd.Tfa.activeTab=yd.Tfa.azc-1):(yd.JSa.enabled=!0,yd.Tfa.activeTab=
0),yd.JSa.ntj(we.PivotValueFieldSettingsSummarizeValueByInfo),yd.eSa.otj(we.PivotValueFieldShowValueAsInitialInfo),yd.mf())};yd.cell=e;yd.yo=C;yd.externalSourceIndex=J;yd.Ufg=ja;yd.de=gb;yd.fia=bc;yd.isOlap=Mc;yd.OH=Hc;return yd}function xf(e,C,J){J=void 0===J?null:J;this.Qlb=this.$lb=null;this.o1=-1;this.ai=e;this.iY=(void 0===C?null:C)||new va.a;this.oxg=J||new La;this.REa=new va.a;e=0;C=yl(this.iY);for(J=C.next();!J.done;J=C.next()){J=J.value;this.rrd(this.o1)||(this.o1=e);var ja=e++;this.REa.add(new ig(document.createElement("li"),
J.title,this.r6g(ja)))}}function ig(e,C,J){this.ai=e;this.Cp=C;this.YFc=J;this.Gfa=document.createElement("a");We.a.Gvc(this.Gfa,this.Cp);Sys.UI.DomElement.addCssClass(this.Gfa,wh.bJj);Sys.UI.DomElement.addCssClass(this.ai,wh.aJj);this.ai.appendChild(this.Gfa);this.Gfa.tabIndex=0;this.UAc();Vd.a.addHandler(this.ai,"click",this.YFc);Vd.a.addHandler(this.ai,"keyup",Object(Sg.a)(this,this.R9a,"onTitleKeyUp"))}function wh(){}function La(){}function Eb(e){e=gc.call(this,e)||this;e.Kde=null;e.get_visible=
e.Tja;e.set_visible=e.Cna;e.nka();return e}function uc(){}function Vc(e,C,J,ja,Aa,gb,bc,Mc){var Hc=Ra.call(this,e)||this;Hc.uF=null;Hc.k5b=null;Hc.U_b=null;Hc.Z1d=null;Hc.$1d=null;Hc.C4d=null;Hc.Mwf=function(){var yd=parseInt(Hc.B3.re.value,10);Hc.QUg(yd)?(Hc.bU.Pn.disabled=!0,Hc.VP.Pn.disabled=!0,Hc.VP.clear(),Vc.Fcf(yd)?(Hc.bU.Pn.disabled=!1,Hc.iNb(!0)):Vc.Gcf(yd)?(Hc.bU.Pn.disabled=!1,Hc.VP.Pn.disabled=!1,Hc.iNb(!0),Hc.Flf()):Hc.iNb(!1)):(yd=dh.a.jd(1,0,0,1084,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
xi.a(Hc.$).nv([yd]),Hc.B3.Kij())};Hc.IHi=function(){0>Hc.bU.selectedIndex||Hc.VP.Pn.disabled||(Hc.iNb(!0),Hc.Flf())};Hc.INi=function(yd){Hc.uF.BSa();Hc.VP.Pn.style.overflowY="scroll";if(yd&&!xh.a(yd)){yd=yd.Result;Hc.VP.clear();for(var we=yl(yd.BaseItems),$e=we.next();!$e.done;$e=we.next())$e=$e.value,Hc.VP.oM($e.DisplayString,$e.Id.toString(),$e.Id===yd.SelectedBaseItem);Hc.iNb(!1)}};Hc.get_visible=Hc.Tja;Hc.set_visible=Hc.Cna;Hc.$=C;Hc.cell=J;Hc.yo=ja;Hc.externalSourceIndex=Aa;Hc.de=gb;Hc.fia=bc;
Hc.Wki=Mc;Hc.zTj=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");Hc.nka();return Hc}function xd(){}function Od(e,C,J,ja,Aa){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=e;this.activeCell=C;this.pivotFieldTitle=J;this.summarizeBy=ja;this.showAsValueParameters=Aa}function re(e,C,J){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=
e;this.baseFieldIndex=C;this.baseItemIndex=J}function Zb(){}function Nc(){}function cd(e,C,J,ja){return Xd.call(this,e,"PopulateFieldListPivotMenu",-1793121409,1378457149,C,J,ja,fi)||this}function Xd(e,C,J,ja,Aa,gb,bc,Mc){Mc=void 0===Mc?Oh:Mc;var Hc=Qg.call(this,e,C,J,ja,Mc,!0,!1,"PivotFilterMenuRootName",Aa,gb,!1,bc)||this;Hc.I4b=null;Hc.Yjf=null;Hc.omb=null;Hc.pivotData=null;Hc.Fyd=null;Hc.amc=null;Hc.GCb=0;Hc.C1b=0;Hc.vY=0;Hc.M0a=null;Hc.LMi=function(yd,we){if(we)if(xh.a(yd))Hc.Fvd(we,!1);else if(yd=
yd.Result){Hc.Vrb=le.Cfd(we,Hc.$,Hc.pivotData.cell,Hc.vY);var $e=Hc.gwd(yd.MenuModel.Sections);Hc.M0a=$e;Xd.wN.set(Hc.pivotData.cell,we,$e,Hc.vY);Jg.a(Hc.$).rHj(yd);Hc.Fvd(we,!0)}};Hc.KMi=function(yd,we){Hc.Fvd(we,!1)};Hc.Se=function(yd,we){Xd.wN.W6b(we.ed.hash)};Hc.Em=function(yd,we){Xd.wN.W6b(we.ed.hash)};Hc.Uca=null;Hc.Gyd=Hc.GCb=-1;Hc.Yxe=Hc.C1b=-1;Hc.Ype=Hc.vY=0;Hc.ow=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Xd.wN||(Xd.wN=new le(Hc.$),Oe.g(Hc.$).Ca.rq(Hc.Se),Oe.g(Hc.$).Ca.IG(Hc.Em),
Oe.g(Hc.$).Ca.Tga(Hc.Se));return Hc}function Le(){this.cell=null;this.dataSourceIndex=0;this.yo=this.pivotName=null}function le(e){this.$=e;this.wN={}}function zf(e,C,J,ja){e=ef.call(this,e,"PopulateFieldListContextMenu",-1045020714,-170383950,qe,!0,!1,qe,C,J,!1,ja)||this;e.ko=null;e.ML=null;e.SZ=!1;e.OH=!1;e.isOlap=!1;e.jUd=!1;return e}function bf(e,C,J,ja){e=Lf.call(this,e,C,J,ja,"PopulateChartContextMenu",-498523270,1640762262,hd)||this;e.EAa=!1;e.Wva=!1;e.lZ=!1;e.refresh=!1;e.isPivotChart=!1;
return e}function Lf(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd){Mc=void 0===Mc?Ca.a.x2g:Mc;e=ha.call(this,e,void 0===Aa?"PopulateFloatingObjectContextMenu":Aa,void 0===gb?-2017893763:gb,void 0===bc?1350204367:bc,Mc,void 0===Hc?!0:Hc,void 0===yd?!1:yd,Mc,C,J,!0,ja)||this;e.floatingObject=null;e.yb=0;e.Jkc=!0;return e}function hf(e,C,J,ja){e=aa.call(this,e,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,hf.XAh,!0,!1,hf.$Hb,C,J,!1,ja)||this;e.em=null;return e}function pg(){}function df(){}function Uf(e,
C){e=Re.call(this,e,2,0,null)||this;e.mte=C;return e}function Re(e,C,J,ja){this.Isg=e;this.rng=C;this.vng=J;this.hxg=ja}function Je(){}function qg(e,C,J,ja){var Aa=Bb.call(this,e,"PopulateAutoFilterContextMenu",1675506831,1651433993,h,!0,!1,"AutoFilterContextMenuRoot",C,J,!1,ja)||this;Aa.M0a=null;Aa.sheetName=null;Aa.fTa=null;Aa.yWc=null;Aa.amf=!1;Aa.v2a=!1;Aa.TDd=null;Aa.lLb=null;Aa.s$c=null;Aa.xbc=null;Aa.jPa=null;Aa.SFe=null;Aa.r$a=null;Aa.M4c=null;Aa.FN=function(){Aa.ayc();Aa.$.ea.Kq(Aa.FN)};
Aa.tMi=function(gb){function bc(ag,Nf,Pg){Aa.M4c=jg.t(Aa.$.na.ta,yd,Jf.b(ag,we),Aa.v2a?Jf.a(Nf,$e):Nf,Pg,null,Gf);return Aa.M4c}Aa.v2a||ng.b(Aa.$).fe(sf.a.Fyf,Aa.fm(),void 0,!0);var Mc={};Aa.$.Bj(Mc);var Hc=Aa.$.ea.isNamedObjectViewMode,yd=Nd.a.oi(Aa.yWc);yd.SheetName=Hc?Mc.NamedObjectName:Mc.SheetName;yd.NamedObjectView=Hc;Mc=!!gb.searchText;Hc=586;Aa.v2a&&(Mc&&(yd.ItemListOptions=Aa.a5g(gb.searchText),Hc=597),gb={},ng.b(Aa.$).fe(sf.a.Fyf,(gb.UserOperation=Hc.toString(),gb),void 0,!0));var we=Aa.kAd(Mc),
$e=Aa.uMi(),Gf=Aa.$.na.ta.$b();Aa.SFe=Gf.RequestId;Aa.v2a&&Aa.xbc&&!Aa.xbc.dequeueUtcTime&&(Aa.$.userOperationManager.cIa(Aa.xbc),Aa.bVg());gb=xe.EwaSettings.tc()?new Sf.a(Hc,0,bc,80):new uf.a(Hc,0,bc,16);Aa.xbc=Aa.$.userOperationManager.ic(gb,null);Aa.r$a=Aa.M4c;Aa.jPa=Aa.SFe};Aa.onMenuItemClick=function(gb,bc,Mc){ng.b(Aa.$).fe(sf.a.qRi,Aa.fm(),void 0,!0);var Hc={};bc=(Hc.CommandValueId=bc,Hc.MenuItemId=bc,Hc.InputMethod=Mc,Hc.TopCellAddress=Aa.fTa,Hc);Hc=new hh.a(gb,Mc,Aa.$.isEditMode?2:1,19,null);
Aa.$.Ka.Yb(Hc,bc);Gd.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",gb,Mc)};Aa.tHi=function(gb){if(gb.checkedItems&&gb.checkedItems.length){ng.b(Aa.$).fe(sf.a.Nuf,Aa.fm(),void 0,!0);var bc=Nd.a.oi(Aa.yWc),Mc={};Aa.$.Bj(Mc);Mc.FirstRow=0;Mc.FirstColumn=bc.Column;var Hc=Aa.$.ea.isNamedObjectViewMode;bc.NamedObjectView=Hc;bc.SheetName=Hc?Mc.NamedObjectName:Mc.SheetName;var yd=function(Gf){if(mh.a.Xwc(Gf)){var ag=mh.a.N$b(Gf);Aa.xMa?mh.a.rQa(gg.a.applyItemFilter,ag.MessageIdName,
ai.a.fsa,!0,mh.a.isSessionEndingError(ag.MessageId)):Gd.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",ag.MessageIdName)}xh.a(Gf)||(Gd.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ng.b(Aa.$).fe(sf.a.zyf,Aa.fm(),void 0,!0),Gf=Object.assign(new Oc,{isSuccess:!0}),Aa.lLb.onApplyFilterByValueFinish(Gf),Aa.JL(Aa.fTa))},we=Aa.n3c(bc,Mc),$e=new Sf.a(208,0,function(Gf,ag,Nf){return jg.a(Aa.$.na.ta,
we,gb.checkedItems,Jf.b(Gf,yd),ag,Nf,null,null)},6,function(){return new me.a(gb.checkedItems,we)});Aa.t4f(function(){Aa.$.userOperationManager.ic($e,null)})}else Gd.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Aa.SKg=function(gb){var bc=ud.o(Aa.fTa,Aa.$),Mc=ud.v(Aa.fTa,Aa.$),Hc=Object.assign(new lf,{SortConditionType:gb.type,RowColOffset:bc.FirstColumn-Mc.FirstColumn,SortColor:gb.color,SortIconSet:gb.icon.IconSet,SortIcon:gb.icon.Icon,
IsAscending:!0}),yd={SortOptions:Object.assign(new Ge,{OperationType:1,ActiveCell:bc,SelectedRange:Mc,SortConditions:[Hc],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:Mc,OriginalActiveCell:bc,ShouldRestoreSelection:!1};Gd.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",gb.type);Aa.t4f(function(){var we={};Aa.$.ye(1659552324,If.a.dc,19,(we.CustomSortCommandData=yd,we))})};Aa.xMa=mh.a.Omd();Aa.ow=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
return Aa}function Xg(){this.top=this.left=0}function Lh(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function cg(){this.autoFilterMenu=this.targetPoint=null}function Lg(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function Da(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=
null}function Fb(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function Oc(){this.isSuccess=!1}function kd(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Ld(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function De(){this.Sections=this.Id=null}function Ge(){this.ActiveCell=this.SelectedRange=
null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function lf(){this.RowColOffset=0;this.IsAscending=!1;this.CustomOrder=null;this.SortColor=this.SortConditionType=0;this.FillGradient=null;this.SortIcon=this.SortIconSet=0;this.RichProperty=null}function Ka(){}function bb(e,C,J,ja){var Aa=this;this.w2d=this.s1=this.Ui=this.JD=
this.p8=null;this.dWb=e;this.mwg=ja;this.dWb.MLa&&(this.Ui=new Cg.a(3,2,5E3,Object(Sg.a)(this,this.WMg,"authenticationCheckTask"),2),wg.AFrameworkApplication.gj.Yg(this.Ui),this.Pg(C,J));this.dWb.dnb(function(){Aa.Vuf()});this.dWb.vYa(function(){Aa.Wuf()})}function ac(){}function Bc(e){return di.call(this,e)||this}function Lc(e,C,J){var ja=Og.call(this)||this;ja.LIi=function(Aa,gb){if(!xh.a(Aa)&&gb){var bc=!!Aa&&!!Aa.RequestTelemetryData;Oe.g(ja.$).Li.wla(gb.toString(),Aa.StateId,bc?Aa.RequestTelemetryData.EcsOperationDuration:
0,bc?Aa.RequestTelemetryData.EcsRequestDuration:0,bc?Aa.RequestTelemetryData.WfeRequestDuration:0)}};ja.$=e;ja.tableManager=C;ja.Fh=J;return ja}function Cb(e,C){this.command=0;this.selectedRanges=null;this.command=e;this.selectedRanges=C}function nc(e){return Mh.call(this,e)||this}function Td(e){var C=ki.call(this)||this;C.Zuf=function(J){var ja=Oe.g(C.$);if(J=J.Result){var Aa=ud.D(J.NewSelection),gb=ud.D(J.NewActiveCell);if(Aa&&gb)if(!J.Committed&&J.AutoSumFormula){var bc=ja.wc(gb);bc&&(ja.ha.updateSelection(Aa,
gb,60),Aa=gb=ud.D(J.MarkedArea),ja.vC=2,ge(ja.qc,bc,J.AutoSumFormula,!!Aa,J.FormulaMarkStart,J.FormulaMarkEnd),Aa&&gb&&ja.ha.updateSelection(Aa,gb,0),ja.qc.Opd=!1,Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.create(C.$.da,153,C.ma,0),function(Mc){Mc.result.Dsb(null)},C.ma,3))}else ja.ha.updateSelection(Aa,gb,60)}};C.$=e;return C}function Me(e,C){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=e;this.type=C}function ge(e,C,J,ja,Aa,gb){if(C){var bc=e.textBox;e.isEditing||e.startEdit(C,
!0);e.Opd=!0;e.text=J;bc.caretPosition=Aa;Aa<gb&&(ja&&e.NAa(),bc.selectRange(0,gb+1),bc.selectRange(Aa,gb))}}function Ef(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd){yd=e.Na(9,yd);yd.selectedRange=C;yd.activeCell=J;yd.autoSumType=ja;yd.topLeftCell=Aa;return jg.i(e,"AutoSum",yd,gb,bc,Mc,Hc,0)}function He(e,C,J,ja,Aa,gb){if(0===ja)return Object(gf.a)(yi.UnsupportedZeroResize);if(0>ja||0===J.length)return Object(gf.a)(yi.InvalidInput);if(e.N6h())return Object(gf.a)(yi.UnsupportedSkeletonInView);var bc=e.rf;if(!bc)return Object(gf.a)(yi.NullSPD);
var Mc=bc.O_e(J);if(Mc&&0<Mc.length)return Object(gf.a)(Mc.length.toString()+" "+yi.UnsupportedHiddenInRange);a:{Mc=yl(J);for(var Hc=Mc.next();!Hc.done;Hc=Mc.next())Hc=Hc.value,Aa?Hc.right=Fe.a.Wh:Hc.bottom=Fe.a.Kh;Mc=e.K$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",J);try{for(Mc.$$rst();Mc.$$mn();)if(Mc.eo.hFj){var yd=!0;break a}}finally{Mc&&Mc.dispose()}yd=!1}if(yd)return Object(gf.a)(yi.UnsupportedMergeCell);if(xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!Aa&&"undefined"!==typeof gridRenderer)for(yd=yl(J),Mc=yd.next();!Mc.done;Mc=yd.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Mc.value.left);e=e.Ca;yd=ph.a.create().toString();bc.ueg(J,ja,Aa);gb=e.Vcg(Aa,gb);C.q8i(J,Aa);e.ALf(gb,yd);return Object(gf.d)(ja)}b.r(F);var Of=b(516),Md=b(0),cf=b(817),Gd=b(13),pe=b(194),jg=b(81),If=b(77);Me.prototype.g4a=function(){return this.sharedSheetRange};Object(Md.a)(Me,"MacroRecorderAutoSumPayload",null,[106]);var ud=b(43),uf=b(521),Hh=b(369),
Sf=b(164),Zg=b(56),Pd=b(35),jh=b(148),ci=b(339),dh=b(27),xe=b(1),Ag=b(175),Jf=b(272),Oe=b(19),$h=b(155),kh=b(584),Tf=b(52),ki=pe.a;vm(Td,ki);Td.prototype.Zc=function(){return!1};Td.prototype.executeCommand=function(e,C,J){e=C.command;switch(e){case 1220954656:C=this.gJe(0,C);break;case -1537138325:C=this.gJe(parseInt(J[If.a.nd].toString(),10),C);break;default:C=Ag.a(e)}return C};Td.prototype.Kc=function(e,C){if(e=1===e)switch(C.command){case 1220954656:case -1537138325:break;default:e=!1}return e};
Td.prototype.gd=function(){return!1};Td.prototype.gJe=function(e,C){function J(){return new Me(bc,e)}var ja=this,Aa=Oe.g(this.$);Aa.Gh.VG(!1);if(!Oe.g(this.$).ha.va.qh)return Gd.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",e,Oe.g(this.$).ha.va.TK),this.cza(),Tf.Task.Ta(!1);var gb=Aa.sH();if(!gb)return null;var bc=ud.v(Aa.ha.va.Td,this.$),Mc=ud.o(Aa.ha.va.activeCell,this.$),Hc=ud.o(gb,
this.$),yd=this.$.na.ta.$b();return this.$.Ms(Aa.ha.va.selectedRanges,!0)?xe.EwaSettings.tc()?Hh.a(this.$.userOperationManager,function(we,$e,Gf){return Ef(ja.$.na.ta,bc,Mc,e,Hc,Jf.b(we,ja.Zuf),$e,Gf,e,yd)},function(we){return new Sf.a(502,0,we,64,J)},C):Hh.a(this.$.userOperationManager,function(we,$e,Gf){return Ef(ja.$.na.ta,bc,Mc,e,Hc,Jf.b(we,ja.Zuf),$e,Gf,e,yd)},function(we){return new uf.a(502,0,we,void 0,J)},C):Tf.Task.Ta(!1)};Td.prototype.cza=function(){kh.a($h.a.discontinuousSelectionBlocking,
["OtherICE"],!0,!0,!1,!1,null);var e=dh.a.jd(1,1,738,2128,0,371863010,"DiscontinuousSelectionBlocking");xe.EwaSettings.nz()?new ci.a(this.$,e):(e=new jh.ErrorDialog(this.$,e),e.initialize(),e.mf())};Object(Md.a)(Td,"AutoSumCommandHandler",pe.a,[239]);var Mh=cf.a;vm(nc,Mh);nc.prototype.Pd=function(){this.Gd([new Td(this.$)])};nc.ka=function(e){cf.a.he(96,new nc(e))};Object(Md.a)(nc,"AutoSumCommandHandlerFactory",cf.a,[]);var Nh=b(10),ph=b(177),gh=b(309),eh=b(36),Uh=b(319);Cb.prototype.Pt=function(){return this.command};
Object(Md.a)(Cb,"MacroRecorderRangeOperationAppliedPayload",null,[106]);var xh=b(303),Wg=b(67),Og=eh.a;vm(Lc,Og);Lc.prototype.lEg=function(e){this.addHandler("ekcvc",e)};Lc.prototype.Nbj=function(e){this.removeHandler("ekcvc",e)};Lc.prototype.Zc=function(){return!1};Lc.prototype.executeCommand=function(e,C){e=C.command;switch(e){case -730106152:C=this.zid(C,3);break;case -1228228458:C=this.zid(C,4);break;case -848953656:case 2045211913:if(this.Lli()){C=Tf.Task.Ta(!0);break}C=this.zid(C,1);break;default:C=
Ag.a(e)}return C};Lc.prototype.Kc=function(e,C){if(e=1===e)switch(C.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:e=!1}return e};Lc.prototype.gd=function(){return!1};Lc.prototype.zid=function(e,C){function J(){return new Cb(C,yd)}function ja($e,Gf,ag){Aa.$.ny();return jg.f(Aa.$.na.ta,C,yd,!1,Jf.b($e,Aa.LIi),Gf,ag,Hc,we)}var Aa=this,gb=Oe.g(this.$),bc=gb.ha.va.selectedRanges,Mc=e.command,Hc=ph.a.create().toString();if(!this.$.Ms(bc,!0)&&-730106152!==Mc)return Tf.Task.Ta(!0);
var yd=ud.r(bc,this.$);this.JBj(Mc,gb,bc,Hc);xe.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.w4i();var we=this.$.na.ta.$b(!0);return xe.EwaSettings.tc()?Hh.a(this.$.userOperationManager,ja,function($e){return new Sf.a(508,0,$e,67,J)},e):Hh.a(this.$.userOperationManager,ja,function($e){return new uf.a(508,0,$e,3,J)},e)};Lc.prototype.JBj=function(e,C,J,ja){var Aa=this;if(-848953656!==e&&2045211913!==e&&-730106152!==e&&-1228228458!==e)Gd.ULS.sendTraceTag(537167938,
0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",e);else if(!gh.a.any(J,function(bc){return 0<C.getRangeInformation(bc).length})){var gb=gh.a.any(J,function(bc){return Aa.tableManager.Xqd(bc)});if(-730106152!==e&&-1228228458!==e||!gb)this.PFj(C,e,ja,J),-730106152!==e&&-1228228458!==e||this.Fh.Vda(C,-730106152,{}),-1228228458!==e&&2045211913!==e&&-848953656!==e||this.Fh.KYg(J,ja),C.Li.L0(ja,Wg.BasicTelemetryCalculator.cR)}};Lc.prototype.PFj=function(e,C,J,ja){var Aa="";switch(C){case -1228228458:Aa=
"ClearAll";break;case 2045211913:case -848953656:Aa="ClearContent";break;case -730106152:Aa="ClearFormat";break;default:Gd.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",C)}C=ja.length;ja=ud.b(ja);e.Li.z7(15,J,Aa+(", ranges to clear: "+C+", cells to clear: "+ja))};Lc.prototype.w4i=function(){this.raiseEvent("ekcvc",new Uh.a)};Lc.prototype.Lli=function(){if(Oe.g(this.$).jz){var e=this.$.da.Aa(296);return!!e&&e.OU.cB}return!1};Object(Md.a)(Lc,
"ClearCommandHandler",eh.a,[239,420]);var di=cf.a;vm(Bc,di);Bc.prototype.Pd=function(){var e=this,C=Zg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.ub),J=Zg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([C,J],this.ma),function(){var ja=new Lc(e.$,C.result,J.result);e.Gd([ja]);e.$.da.Ha(313,ja)},this.ma,3)};Bc.ka=function(e){cf.a.he(101,new Bc(e))};Object(Md.a)(Bc,"ClearCommandHandlerFactory",cf.a,[]);var Ph=b(914),Fg=b(892),ei=b(865),
Dh=b(1145);ac.prototype.d9g=function(e,C){if(e&&!(1>e.length)&&C){var J=Object.assign(new ei.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.G6g(e,J.ControlList);C.push(J)}};ac.prototype.G6g=function(e,C){var J=Object.assign(new Ph.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Fg.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(C,J);C=Object.assign(new ei.a,{Title:"",ControlList:[]});
Array.add(J.Menu.MenuSectionList,C);this.K8g(e,C.ControlList)};ac.prototype.K8g=function(e,C){for(var J=0;J<e.length;J++){var ja=Object.assign(new Dh.a,{ExternalId:String.format("CoauthorPersona_{0}",J),Command:"336231556",DisplayName:e[J].userName,LabelText:e[J].userName,ImageBackColor:e[J].color,PersonaId:e[J].email,IsAnonymous:e[J].isAnonymous});Array.add(C,ja)}};Object(Md.a)(ac,"PresenceContextMenuSectionBuilder",null,[70]);var Sg=b(80),wg=b(5),yh=b(171),bh=b(581),Cg=b(108),uh=b(128),fg=b(88),
Qh=b(87),ii=b(104),kg=b(30);bb.prototype.Pg=function(e,C){var J=wg.AFrameworkApplication.Hb;J.ff(kg.a.authenticationLost,ii.a.frame,e,96);J.ff(kg.a.fte,ii.a.frame,C,96);J.hc(kg.a.$we,ii.a.frame,yh.ActionManager.$6c);J.hc(kg.a.axe,ii.a.frame,yh.ActionManager.$6c);J.hc(kg.a.Tsd,ii.a.frame,yh.ActionManager.$6c)};bb.prototype.Vuf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);wg.AFrameworkApplication.Hb.processAction(kg.a.authenticationLost,2)};bb.prototype.Wuf=function(){this.GJj();
wg.AFrameworkApplication.Hb.processAction(kg.a.fte,2)};bb.prototype.WMg=function(){this.dWb.authenticationCheck()};bb.prototype.GJj=function(){this.JD&&(this.JD.hide(),this.JD.dispose(),this.JD=null);this.p8&&this.businessBar&&(wg.AFrameworkApplication.Hg||this.businessBar.removeEntry(this.p8),this.p8.dispose(),this.p8=null)};bb.prototype.showDialog=function(e){fg.a.Fa(this.JD);this.JD=new uh.StandardDialog;this.mwg||(this.JD.Ru=!1,this.JD.kc=0);this.JD.Gc(1,CommonUIStrings.l_SignIn);this.JD.iX(CommonUIStrings.l_DefaultDialogTitle,
e,Object(Sg.a)(this,this.$v,"dialogHandler"))};bb.prototype.$v=function(e){1===e?(bh.a.A6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),wg.AFrameworkApplication.Hb.processAction(kg.a.Tsd,2)):(this.oRd(),wg.AFrameworkApplication.Hb.processAction(kg.a.axe,2))};bb.prototype.oRd=function(){this.businessBar&&this.qve&&(this.p8=this.qve.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.p8.closeable=!0,this.p8.addButton(CommonUIStrings.l_SignIn,
bb.vSg,""),this.p8.t$=Object(Sg.a)(this,this.ySg,"businessBarEntryCloseHandler"),this.businessBar.YD(this.p8,!1))};bb.prototype.ySg=function(){this.Gfh();wg.AFrameworkApplication.Hb.processAction(kg.a.$we,2)};bb.prototype.Gfh=function(){this.Ui&&(wg.AFrameworkApplication.gj.Mp(this.Ui),this.Ui=null)};bb.prototype.dispose=function(){this.Ui=this.JD=this.p8=null};bb.vSg=function(){bh.a.A6();wg.AFrameworkApplication.Hb.processAction(kg.a.Tsd,2)};Qk.Object.defineProperties(bb.prototype,{businessBar:{configurable:!0,
enumerable:!0,get:function(){return this.s1||(this.s1=Qh.a.instance.Nh("CommonUI.IBusinessBar"))}},qve:{configurable:!0,enumerable:!0,get:function(){return this.w2d||(this.w2d=Qh.a.instance.Nh("CommonUI.IBusinessBarEntryFactory"))}}});Object(Md.a)(bb,"SignOutResponseUI",null,[2]);var mi=b(273);Ka.prototype.ii=function(e){e.register(ac,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Cc()};Ka.prototype.init=function(){};Ka.prototype.dispose=
function(){fg.a.Fa(Ka.c2);Ka.c2=null};Ka.main=function(){mi.a.instance.rj(new Ka)};Qk.Object.defineProperties(Ka.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});Ka.c2=null;Object(Md.a)(Ka,"CommonAppUIPackage",null,[4,5]);var Yh=b(143);Object(Md.a)(lf,"SharedSortCondition",null,[]);Object(Md.a)(Ge,"SharedSortOptions",null,[]);var og=b(842),Ca=b(4),ua=b(465),tb=b(589),Nd=b(54),me=b(1041),sf=b(126),sg=b(877),Ff=b(141),xg=b(114),yg=b(201),hh=b(92),nh=b(69),Ng=b(32),
ue=b(14),Bg=b(62),ng=b(127),mh=b(900),gg=b(901),ai=b(135),ih=b(48),rf=b(34),Rf=b(417);Object(Md.a)(De,"AutoFilterMenu",null,[]);Object(Md.a)(Ld,"MenuItem",null,[]);Object(Md.a)(kd,"MenuSection",null,[]);Object(Md.a)(Oc,"ApplyFilterByValueResponse",null,[]);Object(Md.a)(Fb,"FilterByValueItem",null,[]);Object(Md.a)(Da,"GetColorsAndIconsResponse",null,[]);Object(Md.a)(Lg,"GetFilterByValueItemsResponse",null,[]);Object(Md.a)(cg,"ShowSortFilterMenuParams",null,[]);Object(Md.a)(Lh,"SortFilterControllerFactoryParams",
null,[]);Object(Md.a)(Xg,"TargetPoint",null,[]);var ch=b(335),vg=b(39),oh=b(178),h=Ca.a.r2g,Bb=og.a;vm(qg,Bb);qg.prototype.executeCommand=function(e,C,J){var ja=this;e=C.command;switch(e){case 1701016594:og.a.kzh(J);break;case 966232027:var Aa=J.domEvent;if(nh.e(Aa.rawEvent)&&nh.e(Aa.rawEvent)&&(nh.g(Aa),Aa.target&&(e=new Ff.a(this.$.xa),e.ue(4096)||e.ue(2048)))){var gb=Nd.a.oi(J[If.a.Tg]);this.U2f(gb)&&(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")?this.amf?this.Ssc(Aa,
Aa.target,gb,C):(this.TDd=function(){ja.U2f(gb)&&(ja.oci(),ja.Ssc(Aa,Aa.target,gb,C),ja.v2a=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),ja.amf=!0)},this.ayc()):this.BO(Aa,Aa.target,gb,C,!0))}break;default:return Ag.a(e)}return Tf.Task.Ta(!0)};qg.prototype.Kc=function(e,C,J){if(e=!!J)switch(C.command){case 1701016594:case 966232027:ua.a(this.$)||(e=!1,Gd.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",
ih.b().ti(C.command)));break;default:e=!1}return e};qg.prototype.BO=function(e,C,J){Gd.ULS.shipAssertTag(537167136,0,!!J,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");this.M0a=this.IKh(J);this.ow&&!J.IsHeaderSnapped?(!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||og.a.Afc(this.$,J.Cell))&&this.Do(og.a.pac(this.$,J.Cell,!0),!0):Bb.prototype.BO.call(this,e,C,J,null,!0)};qg.prototype.FDd=function(e){Array.addRange(e.MenuSectionList,
this.M0a)};qg.prototype.oci=function(){var e=this;Rf.a(function(){e.lLb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object.assign(new Lh,{getFilterByValueItemsRequest:e.tMi,applyFilterByValueRequest:e.tHi,onMenuItemClick:e.onMenuItemClick,autoFilterMenuWidth:qg.lte,applySortByColorOrIconRequest:e.SKg}))});this.s$c=Qh.a.instance.Nh("Common.IExternalUICommandDefinitionMapping")||new tb.a(this.$.Jb,this.$)};qg.prototype.Ssc=function(e,C,J){ng.b(this.$).fe(sf.a.Ssc,this.fm(),
void 0,!0);Gd.ULS.shipAssertTag(537167135,0,!!J,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");e=this.HKh(J);var ja=Sys.UI.DomElement.getBounds(C),Aa=ja.x+ja.width;ja=ja.y;if(this.ow&&!J.IsHeaderSnapped){if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!og.a.Afc(this.$,J.Cell))return;J=og.a.pac(this.$,J.Cell,!0);Aa=J.x;ja=J.y}J=Oe.g(this.$).rtl?new Sys.UI.Point(Aa-rf.a(this.$).OFa(qg.lte),ja):new Sys.UI.Point(Aa,ja);this.ATa(J,C);
J=rf.a(this.$).Jja(J);C=Object.assign(new cg,{targetPoint:Object.assign(new Xg,{left:J.x,top:J.y}),autoFilterMenu:e});this.lLb.showSortFilterMenu(C);this.$.ye(-544117314,-1,0,null)};qg.prototype.U2f=function(e){return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&e.Cell.SheetName?Oe.g(this.$).o5?e.Cell.SheetName===this.$.pa.name:e.Cell.SheetName===this.$.pa.sheetName:!0};qg.prototype.HKh=function(e){return(e=this.MXe(e))?this.lKf(e):null};qg.prototype.lKf=
function(e){for(var C=[],J=yl(e.Sections),ja=J.next();!ja.done;ja=J.next())ja=ja.value,Object(oh.c)(this.$)&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&ja.Title===ue.a.instance.fa(1899)||(ja=this.r2i(ja),Array.add(C,ja));return Object.assign(new De,{Id:e.Id,Sections:C})};qg.prototype.r2i=function(e){for(var C=[],J=yl(e.MenuItems),ja=J.next();!ja.done;ja=J.next())if(ja=ja.value,2===ja.Identifier)this.yWc=ja.CommandData;else switch(ja.Type){case 3:case 2:Array.add(C,this.p2i(ja,
2===ja.Type));break;case 1:Array.add(C,this.q2i(ja))}return Object.assign(new kd,{MenuItems:C,DisplayType:e.DisplayType,Id:this.hIh(e)})};qg.prototype.q2i=function(e){var C=this.TWe(e);var J=C.label;var ja=C.jLa;C=this.lKf(e.SubMenu);var Aa=this.IWe(e);ja=this.s$c.Kac(ja);J=J||e.Label;return Object.assign(new Ld,{Disabled:e.Disabled,Type:e.Type,Identifier:e.Identifier,Id:Aa,CommandData:e.CommandData,Label:J,SubMenu:C,IsChecked:e.IsChecked,IconName:"MissingIcon_20"===ja?null:ja})};qg.prototype.p2i=
function(e,C){var J=this.w$b(e,C&&e.IsChecked);C=J.label;var ja=J.jLa;J=J.pp;var Aa=this.Kcd(e,C);ja=this.s$c.Kac(ja);return Object.assign(new Ld,{Disabled:e.Disabled,Type:e.Type,Identifier:e.Identifier,Id:Aa,RibbonCommand:J,CommandData:e.CommandData,Label:C||e.Label,SubMenu:null,IsChecked:e.IsChecked,IconName:"MissingIcon_20"===ja?null:ja})};qg.prototype.MXe=function(e){var C;this.fTa=C=ud.C(e.Cell);this.sheetName=this.$.pa.sheetName;if(e.IsHeaderSnapped)C=ua.a(this.$).m9b.PRh(C);else{var J=Oe.g(this.$).Ca.R3a(C);
if(!J)return this.xMa?mh.a.rQa(gg.a.DMf,$h.a.L2h,ai.a.zZa,!0,!1):Gd.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",C,Oe.g(this.$).view.visibleArea),null;C=J.autoFilterMenu}if(!C)return this.xMa?mh.a.rQa(gg.a.DMf,$h.a.IAi,ai.a.zZa,!0,!1):Gd.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.Vrb=e.Cell.FirstRow+"_"+e.Cell.FirstColumn;return C};qg.prototype.IKh=function(e){return(e=this.MXe(e))?this.gwd(e.Sections):null};qg.prototype.ayc=function(){var e=this;if(this.$.ea.Sh){var C=Zg.GetServiceTaskFactory.Wa(this.$.da,283,284,1);Pd.TaskExtensions.Ba(C,function(){e.xMa?C.result.Sn.loadScript("sortFilter").then(function(){e.TDd()},function(J){Bg.a.pl(J,"AutoFilterContextMenu.SortFilterScriptLoad");mh.a.rQa(gg.a.ayc,$h.a.REj,ai.a.zZa,!1,!1)}):Pd.TaskExtensions.Ba(ch.c(C.result.Sn.loadScript("sortFilter")),
function(){e.TDd()},e.$.ma,3)},this.$.ma,3)}else this.$.ea.Tm(this.FN)};qg.prototype.a5g=function(e){var C={};C.SearchText=e;C.Page=1;C.DateNodeType=-1;return C};qg.prototype.bVg=function(){this.jPa&&(Gd.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",this.jPa),jg.j(this.$.na.ta,this.jPa,null,null,null),this.jPa=null);this.r$a&&(wg.AFrameworkApplication.Kd.nu(this.r$a.Et),this.r$a=null)};qg.prototype.kAd=
function(e){var C=this;return function(J){C.jPa=null;C.r$a=null;if(mh.a.Xwc(J)){var ja=mh.a.N$b(J);C.xMa?mh.a.rQa(e?gg.a.searchAutoFilterItemList:gg.a.getAutoFilterItemList,ja.MessageIdName,ai.a.zZa,!0,!0):Gd.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",ja.MessageIdName)}if(!xh.a(J)){Gd.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");J=J.Result;ja=new Ng.a(!0);
var Aa=J.AutoFilterDateNodes?!0:!1;J.AutoFilterItems&&ja.add("AutoFilterItemsCount",J.AutoFilterItems.length);Aa&&ja.add("AutoFilterDateItemsCount",J.AutoFilterDateNodes.length);ja.add("Location","contextMenu");ng.b(C.$).fe(sf.a.kAd,ja.Yu,void 0,!0);ja=C.v2a?Object.assign(new Lg,{filterByValueItems:C.vCe(J),hasMoreRecords:J.ItemListMaxExceeded,searchText:J.SearchText}):Object.assign(new Lg,{filterByValueItems:C.vCe(J),hasMoreRecords:J.ItemListMaxExceeded});C.lLb.onGetFilterByValueItemsFinish(ja);
!e&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SortByColor",!1)&&(Gd.ULS.shipAssertTag(529063959,0,null!==J.FontColors&&null!==J.CellColors&&null!==J.Icons&&null!==J.SelectedSortFontColors&&null!==J.SelectedSortCellColors&&null!==J.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),J=Object.assign(new Da,{fontColors:J.FontColors,cellColors:J.CellColors,icons:J.Icons,selectedSortFontColor:0<J.SelectedSortFontColors.length?
J.SelectedSortFontColors[0]:null,selectedSortCellColor:0<J.SelectedSortCellColors.length?J.SelectedSortCellColors[0]:null,selectedSortIcon:0<J.SelectedSortIcons.length?J.SelectedSortIcons[0]:null,getColorName:C.getColorName}),C.lLb.onGetColorsAndIconsFinish(J))}}};qg.prototype.uMi=function(){var e=this;return function(C){e.jPa=null;e.r$a=null;C=xg.a.og(C.data);Gd.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",dh.a.Uc(C))}};qg.prototype.vCe=
function(e){var C=this.T2g(e),J=this.$2g(e.AutoFilterItems),ja=[],Aa=0;e.HasBlanks&&(e=qg.D3c(ue.a.instance.fa(765),e.IsBlanksSelected?1:0,Ca.a.kte),ja[Aa++]=e);C=yl(C);for(e=C.next();!e.done;e=C.next())e=e.value,ja[Aa++]=e;J=yl(J);for(e=J.next();!e.done;e=J.next())C=e.value,ja[Aa++]=C;return ja};qg.prototype.T2g=function(e){var C=[];if(!e.AutoFilterDateNodes||!e.AutoFilterDateNodes.length)return C;for(var J=[this.O3a(e.YearKeys,e.YearValues),this.O3a(e.MonthKeys,e.MonthValues),this.O3a(e.DayKeys,
e.DayValues),this.O3a(e.HourKeys,e.HourValues),this.O3a(e.MinuteKeys,e.MinuteValues),this.O3a(e.SecondKeys,e.SecondValues)],ja=!1,Aa=!1,gb=0,bc=null,Mc=Array(6),Hc=null,yd=yl(e.AutoFilterDateNodes),we=yd.next();!we.done;we=yd.next()){we=we.value;Mc[0]&&(Hc.Year!==we.Year?(ja=!0,gb=0,bc=null):Hc.Month!==we.Month?(Aa=!0,gb=1,bc=Mc[0]):Hc.Day!==we.Day?(gb=2,bc=Mc[1]):e.ShowTime&&(Hc.Hour!==we.Hour?(gb=3,bc=Mc[2]):Hc.Minute!==we.Minute?(gb=4,bc=Mc[3]):(gb=5,bc=Mc[4])));for(;6>gb;){switch(gb){case 0:var $e=
we.Year;Hc=J[0].getItem($e.toString());break;case 1:$e=we.Month;Hc=J[1].getItem($e.toString());break;case 2:$e=we.Day;Hc=J[2].getItem($e.toString());break;case 3:$e=we.Hour;Hc=J[3].getItem($e.toString());break;case 4:$e=we.Minute;Hc=J[4].getItem($e.toString());break;case 5:$e=we.Second;Hc=J[5].getItem($e.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Hc=qg.D3c(Hc,-1!==we.NodeType&&gb>=we.NodeType?1:0,bc?bc.key+";"+$e:Ca.a.zXc+$e,!1,[]);bc=bc?bc.children:
C;bc=bc[bc.length]=Hc;Mc[gb]=Hc;switch(gb){case 5:gb=6;break;case 2:gb=e.ShowTime?gb+1:6;break;default:gb++}}Hc=we}ja||(Mc[0].expanded=!0,Aa||(Mc[1].expanded=!0));return C};qg.prototype.$2g=function(e){var C=[];if(!e)return C;var J=0;e=yl(e);for(var ja=e.next();!ja.done;ja=e.next())ja=ja.value,C[J++]=qg.D3c(ja.DisplayString,ja.Selected?1:0,Ca.a.AXc+ja.DisplayString);return C};qg.prototype.O3a=function(e,C){var J=new Ng.a(!0);if(!e||!C)return J;for(var ja=e.length<C.length?e.length:C.length,Aa=0;Aa<
ja;Aa++)J.add(e[Aa].toString(),C[Aa]);return J};qg.prototype.n3c=function(e,C){var J={};J.Location=C;J.FieldId=e.Id.toString();J.DataSourceIndex=-1;J.FilterType=e.AutoFilterType;J.AnchorType=0;J.ChartId=null;J.AnchorValue1=-1;J.AnchorValue2=-1;J.Property=e.RichProperty;return J};qg.prototype.JL=function(e){(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?vg.a.Mka(this.$):xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.Wa(this.$.da,
430,431,1),function(C){C.result.tea(e);Gd.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.ma,3)};qg.prototype.fm=function(){var e={};return e.Location="contextMenu",e};qg.prototype.getColorName=function(e){return sg.a.jKa(yg.a.jH(e))};qg.prototype.t4f=function(e){Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.Wa(this.$.da,309,310,3),function(C){C.result.GAa().continueWith(function(J){J.result&&e()})},this.$.ma,
3)};qg.D3c=function(e,C,J,ja,Aa){e=void 0===e?null:e;C=void 0===C?0:C;J=void 0===J?null:J;ja=void 0===ja?!1:ja;Aa=void 0===Aa?null:Aa;return Object.assign(new Fb,{displayText:e?og.a.xm(e):e,state:C,key:J,parent:null,children:Aa,indentationLevel:0,expanded:ja})};Qk.Object.defineProperties(qg.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.BMf}}});qg.lte=268;Object(Md.a)(qg,"AutoFilterContextMenu",
og.a,[]);var tc=b(849),X=b(84),va=b(185),P=b(64),k=b(16);Je.CTe=26;Je.Gad=[229,230,0,98,0,94,93];Object(Md.a)(Je,"Constants",null,[]);Qk.Object.defineProperties(Re.prototype,{Dki:{configurable:!0,enumerable:!0,get:function(){return 3===this.v4b}},eoi:{configurable:!0,enumerable:!0,get:function(){return 4===this.v4b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.hxg}},Bqf:{configurable:!0,enumerable:!0,get:function(){return this.Isg}},v4b:{configurable:!0,enumerable:!0,
get:function(){return this.rng}},c5c:{configurable:!0,enumerable:!0,get:function(){return this.vng}}});Object(Md.a)(Re,"FiltersMenuData",null,[]);vm(Uf,Re);Object(Md.a)(Uf,"AutoFilterFiltersMenuData",Re,[]);df.WJj=[new Re(99,2,0,null),new Re(100,2,1,null),new Re(0,3,0,null),new Re(171,2,2,null),new Re(173,2,4,null),new Re(0,3,0,null),new Re(175,2,6,null),new Re(176,2,7,null),new Re(0,3,0,null),new Re(107,0,0,null)];df.NFi=[new Re(99,2,0,null),new Re(100,2,1,null),new Re(0,3,0,null),new Re(101,2,8,
null),new Re(102,2,10,null),new Re(103,2,12,null),new Re(0,3,0,null),new Re(104,1,0,null),new Uf(105,1),new Uf(106,2),new Re(0,3,0,null),new Re(107,0,0,null)];df.Hbh=[new Re(99,2,0,null),new Re(0,3,0,null),new Re(111,2,10,null),new Re(112,2,8,null),new Re(103,2,12,null),new Re(0,3,0,null),new Uf(109,8),new Uf(108,9),new Uf(110,10),new Re(0,3,0,null),new Uf(114,11),new Uf(113,12),new Uf(115,13),new Re(0,3,0,null),new Uf(116,14),new Uf(117,15),new Uf(118,16),new Re(0,3,0,null),new Uf(119,17),new Uf(120,
18),new Uf(121,19),new Re(0,3,0,null),new Uf(122,20),new Uf(123,21),new Uf(124,22),new Re(0,3,0,null),new Uf(125,23),new Re(126,2,12,[new Uf(127,24),new Uf(128,25),new Uf(129,26),new Uf(130,27),new Re(0,3,0,null),new Uf(131,28),new Uf(132,29),new Uf(133,30),new Uf(134,31),new Uf(135,32),new Uf(136,33),new Uf(137,34),new Uf(138,35),new Uf(139,36),new Uf(140,37),new Uf(141,38),new Uf(142,39)]),new Re(0,3,0,null),new Re(107,0,0,null)];Object(Md.a)(df,"Constants",null,[]);var E=b(20);pg.prototype.compare=
function(e,C){return E.a.compare(e,C,!0)};Object(Md.a)(pg,"IgnoreCaseComparer",null,[532]);var L=b(71),aa=og.a;vm(hf,aa);hf.prototype.executeCommand=function(e,C,J){e=C.command;switch(e){case -699941697:this.applyAutoFilterFieldList(C,J);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return Ag.a(e)}return Tf.Task.Ta(!0)};hf.prototype.Jdd=function(e,C){return!e||e.length<=C?(Gd.ULS.sendTraceTag(537167117,0,10,
"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(e[C],10)};hf.prototype.kFd=function(e,C,J,ja,Aa,gb){var bc=this.Jdd(Aa,gb);0>bc&&Gd.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Je.Gad[bc]){case 98:e=new hh.a(-2058042992,C.method,C.mode,C.df,C.tabName);this.em.OG.ftb(this.$,ja,0,e);break;case 229:e=new hh.a(504133448,C.method,C.mode,C.df,C.tabName);this.em.OG.ftb(this.$,ja,0,e);break;case 230:e=new hh.a(-798968736,
C.method,C.mode,C.df,C.tabName);this.em.OG.ftb(this.$,ja,0,e);break;case 231:e=new hh.a(-1677817820,C.method,C.mode,C.df,C.tabName);this.em.OG.ftb(this.$,ja,0,e);break;case 94:this.AKf(e,C,ja,J,Aa,gb+1);break;case 93:this.em.OG.Tri(this.$,ja)}};hf.prototype.AKf=function(e,C,J,ja,Aa,gb){var bc=this.Jdd(Aa,gb);0>bc&&Gd.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!ja||bc>=ja.length)Gd.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");
else switch(ja=ja[bc],ja.v4b){case 1:this.em.OG.lsi(this.$,J);break;case 2:(Aa=Object(X.a)(Uf,ja))?(e=new hh.a(-2058042992,C.method,C.mode,C.df,C.tabName),this.em.OG.ftb(this.$,J,Aa.mte,e)):this.em.OG.Rkf(this.$,e,J,ja.c5c);break;case 0:this.em.OG.Rkf(this.$,e,J,ja.c5c);break;case 4:this.AKf(e,C,J,ja.subMenu,Aa,gb+1)}};hf.prototype.applyAutoFilterFieldList=function(e,C){var J=C[tc.a.AI];if(J)if(J=J.split(P.a.NU),3>J.length)Gd.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");
else{var ja=this.Jdd(J,1),Aa=this.aKa(ja),gb=this.vqf(ja).returnValue;gb?this.kFd(C,e,gb,Aa,J,2):Gd.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+ja.toString()+P.a.NU)}else Gd.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};hf.prototype.Kc=function(e,C){if(e=this.$.isEditMode)switch(C.command){case 216058793:break;case -699941697:break;case -1494291901:e=
!0;break;default:e=!1}return e};hf.prototype.BO=function(e,C,J){this.$.isEditMode&&((this.em=Object(X.a)(486,J))||Gd.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.VY(),aa.prototype.BO.call(this,e,C,null,null,!0))};hf.prototype.w3c=function(){if(!this.em||!this.em.Dk||1!==this.em.Dk.length)return Gd.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var e=
this.em.Dk[0],C=new va.a;C.add(ue.a.instance.fa(247));C=L.OBc(L.concat(C,L.select(L.asEnumerable(e.FieldInfoDataList),function(J){return J.Name})),function(J){return J},new pg);return L.toArray(C)};hf.prototype.fieldIndex=function(e){if(!this.em||!this.em.Dk||1!==this.em.Dk.length||!this.em.Dk[0].FieldInfoDataList)return-1;for(var C=0;C<this.em.Dk[0].FieldInfoDataList.length;++C)if(this.em.Dk[0].FieldInfoDataList[C].Name===e)return C;return-1};hf.prototype.aKa=function(e){return 0>e||!this.em||!this.em.Dk||
1!==this.em.Dk.length||!this.em.Dk[0].FieldInfoDataList||this.em.Dk[0].FieldInfoDataList.length<e?null:this.em.Dk[0].FieldInfoDataList[e].Name};hf.prototype.VY=function(){var e=this,C=this.w3c();if(!C||!C.length)return null;for(var J=this.Sa,ja=J.Nc(),Aa={},gb=0;gb<C.length;Aa={Qfb:Aa.Qfb},++gb){var bc=C[gb];Aa.Qfb=0<gb?this.fieldIndex(bc):-1;for(var Mc=hf.X5f+Aa.Qfb.toString()+P.a.NU,Hc=null,yd=this.em.OG.s6h(0<gb?bc:null),we=this.G3c(J,yd,hf.X5f+Aa.Qfb.toString(),bc),$e={},Gf=0;Gf<Je.Gad.length;$e=
{OOb:$e.OOb,Pfb:$e.Pfb},++Gf){var ag=Je.Gad[Gf],Nf=Mc+Gf.toString();Hc||(Hc=J.Nc());switch(ag){case 229:Array.add(Hc.buttons,J.fd(223,Nf,-699941697,this.em.OG.Rni(0<gb?bc:null)?k.a.mua:k.a.e4,8,229,!1,null));break;case 230:Array.add(Hc.buttons,J.fd(224,Nf,-699941697,this.em.OG.Sni(0<gb?bc:null)?k.a.nua:k.a.f4,8,230,!1,null));break;case 231:Array.add(Hc.buttons,J.fd(225,Nf,-699941697,k.a.j8b,1,231,!1,null));break;case 98:ag=this.vRg(bc);Nf=J.tHa(Nf+(yd?".enabled":".disabled"),ag,-699941697,null,"None",
null,!yd,void 0,!0);Nf.oS("Image16by16",8,k.a.g2a);Array.add(Hc.buttons,Nf);break;case 94:$e.OOb=void 0;$e.Pfb=void 0;var Pg=function(Jh,jj){return function(){var Xi=e.vqf(Jh.Qfb);jj.OOb=Xi.LTe;jj.Pfb=Xi.isChecked;return Xi}}(Aa,$e)().returnValue;if(!Pg)return null;ag=this.G3c(J,$e.Pfb&&yd,Nf,$e.OOb);Nf=this.ZWe(ag.menu,J,Nf+P.a.NU,Pg,$e.Pfb&&yd);Array.add(ag.menu.Ac,Nf);Array.add(Hc.buttons,ag);break;case 0:Hc&&(Array.add(we.menu.Ac,Hc),Hc=null);break;default:Nf=J.tHa(Nf,ue.a.instance.fa(ag),-699941697,
null,"None",null,!1,void 0,!0),this.gZf(Nf,yd&&93===ag&&this.em.OG.filter(),ue.a.instance.fa(ag)),Array.add(Hc.buttons,Nf)}}Array.add(we.menu.Ac,Hc);Array.add(ja.buttons,we)}C=J.Kp(this.menuId);Array.add(C.Ac,ja);return C};hf.prototype.ZWe=function(e,C,J,ja,Aa){for(var gb=null,bc=0;bc<ja.length;++bc){var Mc=ja[bc],Hc=J+bc.toString(),yd=!1;switch(Mc.v4b){case 1:yd=Aa&&this.em.OG.Oh.IsTop10;break;case 2:yd=Object(X.a)(Uf,Mc);yd=Aa&&this.em.OG.rhi(yd?yd.mte:0,Mc.c5c);break;case 0:yd=Aa&&this.em.OG.Oh.IsCustomSupportedAndNotPresent}gb||
(gb=C.Nc());if(Mc.Dki)gb&&(Array.add(e.Ac,gb),gb=null);else if(Mc.eoi){var we=ue.a.instance.fa(Mc.Bqf);we=this.G3c(C,yd,Hc,we);Array.add(we.menu.Ac,this.ZWe(we.menu,C,Hc+P.a.NU,Mc.subMenu,yd));Array.add(gb.buttons,we)}else Mc=ue.a.instance.fa(Mc.Bqf),Hc=C.tHa(Hc,Mc,-699941697,null,"None",null,!1,void 0,!0),this.gZf(Hc,yd,Mc),Array.add(gb.buttons,Hc)}return gb};hf.prototype.gZf=function(e,C,J){C?e.oS("Image16by16",8,k.a.gaa):e.oS("None",0,null);e.mS(J);e.label=J};hf.prototype.G3c=function(e,C,J,ja){return C?
e.y3c(J,this.menuId,ja,798637440,8,k.a.gaa):e.Wv(J,this.menuId,ja,798637440)};hf.prototype.ni=function(e){return!e||!e.length};hf.prototype.vqf=function(e){var C=0>e?0:this.em.Dk[0].FieldInfoDataList[e].MajorityDataTypeForField;var J=null;e=this.em.OG.r6h(C);switch(C){case 0:J=95;C=df.WJj;break;case 1:J=94;C=df.NFi;break;case 2:J=96;C=df.Hbh;break;default:return Gd.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,LTe:J,
isChecked:e}}J=ue.a.instance.fa(J);return{returnValue:C,LTe:J,isChecked:e}};hf.prototype.vRg=function(e){!e||this.ni(e.trim())?e=ue.a.instance.fa(97):e.length>Je.CTe?(e=e.substring(0,Je.CTe),e=String.format(ue.a.instance.Cb(154),e)):e=String.format(ue.a.instance.Cb(155),e);return e};Qk.Object.defineProperties(hf.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.CMf}}});hf.XAh=Ca.a.q2g;
hf.$Hb="AutoFilterFieldListContextMenuRoot";hf.X5f="ApplyAutoFilterFieldList.";Object(Md.a)(hf,"AutoFilterFieldListContextMenu",og.a,[]);var na=b(571),sb=b(976),Lb=b(8),Kc=b(115),ad=b(372),ha=og.a;vm(Lf,ha);Lf.prototype.executeCommand=function(e,C,J){e=Object(X.a)(na.a,J.eventArgs);switch(C.command){case -1372040782:J=Oe.g(this.$).ha.Pa.mc;Gd.ULS.shipAssertTag(537167048,0,!!J);J&&(this.floatingObject=J.floatingObject,this.yb=C.method,C=this.oac(e),this.Do(C,!0,e.yb));break;case 848910589:e&&(C=[sb.a.v1f],
e=new Sys.UI.Point(e.Ea.clientX,e.Ea.clientY),this.showFloatie(C,new Sys.UI.Bounds(e.x,e.y,0,0),2))}return Tf.Task.Ta(!0)};Lf.prototype.Kc=function(e,C,J){switch(C.command){case -1372040782:return!!J&&this.cif(e);case 848910589:return e=Oe.g(this.$).ha.Pa.mc,!!J&&!!e&&e.isEditing;default:return!1}};Lf.prototype.cif=function(e){switch(e){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};Lf.prototype.XTc=function(e,C,J){ad.a(this.$)?Oe.g(this.$).$a.$i||(rf.a(this.$).bRd()?Array.add(J.buttons,
e.Bb(265)):Array.add(J.buttons,e.Bb(264))):(this.$.isEditMode&&3===this.yb&&!this.P9b()&&Array.add(J.buttons,e.Bb(101)),5!==this.floatingObject.type||Kc.a.HH(this.floatingObject.Ib)||this.floatingObject.Ib.IsGroup||(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.oqd()?Array.add(J.buttons,e.Bb(186)):Array.add(J.buttons,e.Bb(147))),this.P9b()||this.oqd()||Array.add(J.buttons,e.Bb(146)),xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",
!1)&&(this.jHh(J),this.HIh(J)),xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Array.add(J.buttons,e.Bb(287)),xe.EwaSettings.la(167)&&0===this.floatingObject.type&&Array.add(J.buttons,e.Bb(249)),5===this.floatingObject.type&&Oe.g(this.$).ha.Pa.mc.t5()&&this.$.Lka&&this.$.gha&&Array.add(J.buttons,e.Bb(273)))};Lf.prototype.bKa=function(e){var C=[];if(ad.a(this.$))return C;3===e?(e=!!this.$.jg.get(5)&&this.floatingObject.hUd(),this.P9b()||
(this.$.isEditMode?(e&&Array.add(C,sb.a.fEh),5===Oe.g(this.$).ha.Pa.oC.floatingObject.type&&Array.add(C,sb.a.nwj)):e&&Array.add(C,sb.a.copy)),Array.add(C,sb.a.gEh)):2===e&&(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Oe.g(this.$).ha.Pa.mc&&this.S0e(Oe.g(this.$).ha.Pa.mc,C):this.S0e(Oe.g(this.$).ha.Pa.oC,C));return C};Lf.prototype.VY=function(){var e=this.Sa,C=e.Kp(this.menuId),J=ad.a(this.$);if(this.$.isEditMode){var ja=e.Nc();this.XTc(e,C,ja);Array.add(C.Ac,
ja)}this.$.jg.get(5)&&this.floatingObject.hUd()&&!this.P9b()&&!J&&(ja=e.Nc(),this.XAg(e,ja),Array.add(C.Ac,ja));!xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||J||this.$.isMobileMode||(J=e.Nc(),this.RCg(e,J),Array.add(C.Ac,J));return C};Lf.prototype.oac=function(e){var C=Oe.g(this.$).ha.Pa.mc;e=e&&1!==e.yb&&e.clientPoint?e.clientPoint:Sys.UI.DomElement.getLocation(C.domElement);var J=this.$.domElement,
ja=Oe.g(this.$).rtl;(C=Lb.HelperMethods.XA(C.Dg.domElement,J,ja))?(e.y=Math.max(e.y,C.y),e.x=Math.max(e.x,C.x)):Gd.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",wg.AFrameworkApplication.Hg);return e};Lf.prototype.oqd=function(){var e=Oe.g(this.$).ha.Pa.mc;return!!e&&e.isEditing};Lf.prototype.XAg=function(e,C){if(this.$.isEditMode){Array.add(C.buttons,e.Bb(42));Array.add(C.buttons,
e.Bb(43));var J=this.$.da.Aa(254,!0);(J&&2===J.vAb()||xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.oqd())&&Array.add(C.buttons,e.Bb(44))}else Array.add(C.buttons,e.Bb(43))};Lf.prototype.RCg=function(e,C){Array.add(C.buttons,e.Bb(274))};Lf.prototype.P9b=function(){return xe.EwaSettings.la(486)&&!!Oe.g(this.$).ha.Pa.Eo};Lf.prototype.S0e=function(e,C){5===e.floatingObject.type?xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&
e.isEditing?Array.add(C,sb.a.v1f):Array.add(C,sb.a.jwj):Array.add(C,og.a.OUe)};Lf.prototype.jHh=function(e){var C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(282));Array.add(C.buttons,this.Sa.Bb(281));var J=this.Sa.Wv("BringToFront","BringToFrontMenuId",ue.a.instance.fa(805),-1777747317);Array.add(J.menu.Ac,C);Array.add(e.buttons,J)};Lf.prototype.HIh=function(e){var C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(284));Array.add(C.buttons,this.Sa.Bb(283));var J=this.Sa.Wv("SendToBack","SendToBackMenuId",
ue.a.instance.fa(806),-1777747317);Array.add(J.menu.Ac,C);Array.add(e.buttons,J)};Qk.Object.defineProperties(Lf.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.KMf}}});Object(Md.a)(Lf,"FloatingObjectContextMenu",og.a,[]);var Qa=b(922),Pb=b(96),rc=b(578),gd=b(523),hd=Ca.a.t2g;vm(bf,Lf);bf.prototype.executeCommand=function(e,C,J){var ja=this.$;this.yb=C.method;C=J[bf.M_c];if(!(e&68)){if(!C){if(8===
e)C=gd.a(ja).Yc;else{var Aa=Oe.g(ja).ha.Pa.mc;if(null===Aa||void 0===Aa?0:Aa.floatingObject)C=Aa.floatingObject.Yc}if(!C)return Tf.Task.Ta(!0)}this.isPivotChart=!!(C.Attributes&4)}if(this.isPivotChart||ja.isEditMode)if(this.refresh=this.lZ=this.Wva=this.EAa=!1,Aa=Oe.g(this.$).ha.Pa.mc,Gd.ULS.shipAssertTag(537167107,0,!!Aa),Aa){this.floatingObject=Aa.floatingObject;Aa=rc.a(ja);if(null===Aa||void 0===Aa?0:Aa.xQd)this.EAa=Aa=Pb.f(ja.lg),this.Wva=!Aa;Aa=ja.oc;this.lZ=!!Qa.a(ja)&&!!C&&!!(C.Attributes&
512)&&!(e&8)&&Aa.I2(32768);Aa.allowManualDataRefresh&&Aa.allowInteractivity&&(this.refresh=!0);e=this.oac(Object(X.a)(na.a,J.eventArgs));this.Do(e,!0)}return Tf.Task.Ta(!0)};bf.prototype.Kc=function(e,C,J){return-149612405===C.command&&!!J&&this.cif(e)};bf.prototype.XTc=function(e,C,J){this.isPivotChart&&(this.refresh&&Array.add(J.buttons,e.Bb(100)),this.lZ&&Array.add(J.buttons,e.Bb(99)),this.EAa?Array.add(J.buttons,e.Bb(59)):this.Wva&&Array.add(J.buttons,e.Bb(58)));Lf.prototype.XTc.call(this,e,C,
J)};Qk.Object.defineProperties(bf.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.EMf}}});Qk.Object.defineProperties(bf,{M_c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(Md.a)(bf,"ChartContextMenu",Lf,[]);var Bd=b(11),qe=Ca.a.v2g,ef=og.a;vm(zf,ef);zf.prototype.executeCommand=function(e,C,J){e=C.command;switch(e){case 330754562:C=J.domElement;this.isOlap=J.isOlap;
this.ML=J.versionkey;this.ko=J.fieldItem;this.SZ=J.isChart;this.OH=J.isPpm;this.jUd="supportsImplicitMeasures"in J?J.supportsImplicitMeasures:!1;Oe.g(this.$).Qq(!0);e=Bd.DOMElementExtensions.getBounds(C);e=new Sys.UI.Point(e.x+e.width,e.y+e.height/2);this.ATa(e,C);"isKeyboardInput"in J&&J.isKeyboardInput?this.Do(e,!1,1):this.Do(e,!1);break;case 926905850:this.jUd&&this.ko&&5===this.ko.TypeTag&&!this.ko.IsCollapsible&&Gd.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");
rc.a(this.$).bH(this.ko,8,-1,this.ML,C);break;case -67292059:rc.a(this.$).bH(this.ko,1,-1,this.ML,C);break;case 745182485:rc.a(this.$).bH(this.ko,2,-1,this.ML,C);break;case 359279088:rc.a(this.$).bH(this.ko,4,-1,this.ML,C);break;case 547535945:rc.a(this.$).d6i(this.ko);break;default:return Ag.a(e)}return Tf.Task.Ta(!0)};zf.prototype.Kc=function(e,C,J){e=!1;switch(C.command){case 330754562:e=!!J;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:e=!0}return e};zf.prototype.VY=
function(){var e=this.Sa.Kp(this.menuId);this.N_i(e);this.SZ||this.isOlap||this.M_i(e);return e};zf.prototype.N_i=function(e){var C=this.Sa,J=C.Nc(),ja=!1;xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(ja=this.isOlap&&!this.OH&&this.jUd&&5===this.ko.TypeTag&&!this.ko.IsCollapsible);3!==this.ko.TypeTag&&37!==this.ko.TypeTag||this.ko.IsSet?17===this.ko.TypeTag||this.OH?(Array.add(J.buttons,C.Bb(79)),Array.add(J.buttons,C.Bb(this.SZ?91:80)),Array.add(J.buttons,
C.Bb(this.SZ?92:81)),Array.add(J.buttons,C.Bb(82))):13===this.ko.TypeTag||this.ko.IsSet?(Array.add(J.buttons,C.Bb(83)),Array.add(J.buttons,C.Bb(this.SZ?91:80)),Array.add(J.buttons,C.Bb(this.SZ?92:81)),Array.add(J.buttons,C.Bb(86))):(Array.add(J.buttons,C.Bb(79)),Array.add(J.buttons,C.Bb(this.SZ?91:80)),Array.add(J.buttons,C.Bb(this.SZ?92:81)),Array.add(J.buttons,C.Bb(ja?82:86))):(Array.add(J.buttons,C.Bb(83)),Array.add(J.buttons,C.Bb(this.SZ?93:84)),Array.add(J.buttons,C.Bb(this.SZ?94:85)),Array.add(J.buttons,
C.Bb(82)));Array.add(e.Ac,J)};zf.prototype.M_i=function(e){var C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(78));Array.add(e.Ac,C)};Qk.Object.defineProperties(zf.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.tGd}}});Object(Md.a)(zf,"FieldListContextMenu",og.a,[]);var nf=b(411),kf=b(61);le.prototype.get=function(e,C,J){var ja=this.Qag(e,"PivotFilterContextMenuCache.Get");return ja&&this.wN[ja]?
this.wN[ja][le.Cfd(C,this.$,e,J)]:null};le.prototype.set=function(e,C,J,ja){var Aa=this.Qag(e,"PivotFilterContextMenuCache.Set");Aa&&(this.wN[Aa]||(this.wN[Aa]={}),this.wN[Aa][le.Cfd(C,this.$,e,ja)]=J)};le.prototype.W6b=function(e){e in this.wN&&this.wN[e]&&(this.wN[e]=null)};le.prototype.Qag=function(e,C){return kf.f(this.$.pa)?this.$.activeItemName:(e=this.pOj(e,C))?e.Yd:null};le.prototype.pOj=function(e,C){e=ud.C(e);e=Oe.g(this.$).Ca.lva(e,this.$.activeItemName);Gd.ULS.shipAssertTag(537167008,
0,!!e,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",C);return e};le.Cfd=function(e,C,J,ja){return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===ja?C.pa.index+"_"+e.id+"_"+J.FirstRow.toString()+"_"+J.FirstColumn.toString():C.pa.index+"_"+e.id};Object(Md.a)(le,"PivotFilterContextMenuCache",null,[]);Object(Md.a)(Le,"ShowPivotFilterData",null,[]);var Af=b(575),
Jg=b(1273),fh=b(53),Oh=Ca.a.iCe,Qg=og.a;vm(Xd,Qg);Xd.prototype.B$c=function(e,C){var J=this,ja=e.rawEvent,Aa=e.cell,gb=e.requiresConfirmation;Af.a(this.$).Du(gb,function(bc){if(bc){bc=ja?new Sys.UI.DomEvent(ja):null;J.pivotData=new Le;J.pivotData.pivotName=e.pivotName;J.pivotData.dataSourceIndex=e.dataSourceIndex;J.pivotData.cell=Aa;J.pivotData.yo=e.optionalPivotMenuAnchorParameter;if(J.pivotData.yo&&0<J.pivotData.yo.AnchorType){J.amc=e.objectId;J.GCb=e.objectVersion;var Mc=J.pivotData.yo.AnchorType;
if(4===Mc||5===Mc||6===Mc||11===Mc||9===Mc||10===Mc||8===Mc)J.omb=e.location}else J.Fyd=J.amc=null,J.Gyd=J.GCb=-1;Oe.g(J.$).Qq(!0);J.$.Bj(Aa);J.BO(bc,bc?bc.target:e.domElement,J.pivotData,C,J.WLa())}});return!0};Xd.prototype.BO=function(e,C,J,ja){var Aa=this;if(Object(nf.a)(Le,J)){this.pivotData=J;this.I4b=C;this.Yjf=e;this.C1b=this.pivotData.yo?this.pivotData.yo.AnchorValue1:-1;this.vY=this.pivotData.yo?this.pivotData.yo.AnchorType:0;var gb=!1,bc=null;bc=Xd.wN.get(this.pivotData.cell,C,this.vY);
gb=!!bc;var Mc=!0;switch(this.vY){case 4:case 5:case 6:this.Uca=new Sys.UI.Point(this.omb.x,this.omb.y);Mc=!1;break;case 7:var Hc=Sys.UI.DomElement.getBounds(C);Mc=Hc.x+(0<=Hc.x?0:Hc.width);Hc=Hc.y+(0<=Hc.y?0:Hc.height);this.Uca=new Sys.UI.Point(0<=Mc?Mc:0,0<=Hc?Hc:0);Mc=!1;break;case 8:case 10:case 9:case 11:this.Uca=new Sys.UI.Point(this.omb.x,this.omb.y);break;default:this.Uca=null}gb&&this.amc===this.Fyd&&this.GCb===this.Gyd&&this.C1b===this.Yxe&&this.vY===this.Ype?(Gd.ULS.sendTraceTag(537167042,
0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.M0a=bc,this.Uca?(this.ATa(this.Uca,C),this.Do(this.Uca,this.WLa())):this.ow?(!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||og.a.Afc(this.$,this.pivotData.cell))&&this.Do(og.a.pac(this.$,this.pivotData.cell,!1),this.WLa()):Qg.prototype.BO.call(this,e,C,J,ja,this.WLa())):1!==Xd.ZPh(C)&&(Mc&&(C.parentNode.menuFetchStates=1,this.Iqj(C),this.PYf(!0)),this.$.userOperationManager.ic(new Sf.a(126,
0,function(yd,we,$e){var Gf=Aa.$;return jg.A(Gf.na.ta,Aa.pivotData.cell,Aa.pivotData.dataSourceIndex,Aa.pivotData.pivotName,Gf.domElement.id,Gf.isChromeRtl,Gf.workbookContext.NovMode,Jf.b(yd,Aa.LMi),Jf.a(we,Aa.KMi),$e,C,Aa.pivotData.yo)},16),ja))}};Xd.prototype.FDd=function(e){Array.addRange(e.MenuSectionList,this.M0a)};Xd.prototype.Fvd=function(e,C){e.parentNode.menuFetchStates=2;this.PYf(!1);if(C){if(this.I4b!==e||this.JAi())this.ATa(this.Uca,e),this.Do(this.Uca,this.WLa());else if(this.ow&&!this.Uca){if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&
!og.a.Afc(this.$,this.pivotData.cell))return;this.Do(og.a.pac(this.$,this.pivotData.cell,!1),this.WLa())}else Qg.prototype.BO.call(this,this.Yjf,e,null,null,this.WLa());this.Fyd=this.amc;this.Gyd=this.GCb;this.Ype=this.vY;this.Yxe=this.C1b}};Xd.prototype.WLa=function(){return 8!==this.vY&&9!==this.vY&&10!==this.vY&&11!==this.vY};Xd.prototype.JAi=function(){switch(this.pivotData.yo?this.pivotData.yo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};Xd.prototype.PYf=
function(e){var C=this.I4b;if(C){if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var J=Bd.DOMElementExtensions.yZ(C,"ewaprevsrc","");J=!!J&&"null"!==J}else J=!!Bd.DOMElementExtensions.yZ(C,"ewaprevsrc","");e&&J||!e&&!J||(e?(C.setAttribute("ewaprevsrc",C.src),C.src=fh.a.current.oo(77)):(e=Bd.DOMElementExtensions.yZ(C,"ewaprevsrc",""),C.src=e,C.setAttribute("ewaprevsrc",null)))}};Xd.prototype.Iqj=function(e){this.I4b=e};Xd.ZPh=function(e){var C=e.parentNode.menuFetchStates;
void 0===C&&(e.parentNode.menuFetchStates=0);return C};Xd.wN=null;Object(Md.a)(Xd,"PivotFilterContextMenuBase",og.a,[]);var fi="FieldList"+Ca.a.iCe;vm(cd,Xd);cd.prototype.executeCommand=function(e,C,J){return this.B$c(J,C)?Tf.Task.Ta(!0):Ag.a(C.command)};cd.prototype.Kc=function(e,C,J){return-1065117584===C.command&&!!J};Qk.Object.defineProperties(cd.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.IMf}}});
Object(Md.a)(cd,"FieldListPivotContextMenu",Xd,[]);var Dg=b(29),lh=b(851);Object(Md.a)(Nc,"PivotValueFieldSettingsApplyData",null,[]);Zb.nbh="dataFieldCustomLabel";Zb.iGe="dataFieldSourceLabel";Zb.lSd="showValueAsSelect";Zb.jSd="showValueAsBaseFieldSelect";Zb.kSd="showValueAsBaseItemSelect";Zb.tZd="valueFieldsSettingsFieldName";Zb.Vfg="valueFieldSettingTabs";Object(Md.a)(Zb,"CssElementIds",null,[]);var zg=b(112);Object(Md.a)(re,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);Od.prototype.getActiveCell=
function(){return this.activeCell};Object(Md.a)(Od,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[106]);var Ah=b(230);Object(Md.a)(xd,"PivotValueFieldShowValueAsApplyData",null,[]);var Ui=b(852),xi=b(41),Y="<div id='showValueAsControlBody'><label for='"+Zb.lSd+"' class='"+zg.a.io+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+Zb.lSd+"' class='"+zg.a.wC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+Zb.jSd+"'>{1}</label><div><select size=6 id='"+
Zb.jSd+"' class='"+zg.a.wC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+Zb.kSd+"'>{2}</label><div><select size=6 id='"+Zb.kSd+"' class='"+zg.a.wC+"'></select></div></div></div>",Ra=Ah.a;vm(Vc,Ra);Vc.prototype.Tja=function(){return this.isVisible};Vc.prototype.Cna=function(e){return this.isVisible=e};Vc.prototype.setFocus=function(){Bd.DOMElementExtensions.setFocus(this.B3.Pn)};Vc.prototype.render=function(e){e.appendChild(this.domElement)};
Vc.prototype.dispose=function(){fg.a.sc([this.B3,this.bU,this.VP,this.k5b,this.U_b]);Ra.prototype.dispose.call(this)};Vc.prototype.otj=function(e){fg.a.sc([this.k5b,this.U_b]);this.B3.clear();for(var C=yl(e.DataFormatTypes),J=C.next();!J.done;J=C.next())J=J.value,this.B3.oM(Vc.kOh(J),J.toString(),J===e.SelectedDataFormat);this.k5b=this.Qd.Ed(this.B3.domElement);this.k5b.ka("change",this.Mwf);this.bU.clear();C=yl(e.BaseFieldList);for(J=C.next();!J.done;J=C.next())J=J.value,this.bU.oM(J.DisplayString,
J.Id.toString(),J.Id===e.SelectedBaseField);this.U_b=this.Qd.Ed(this.B3.domElement);this.U_b.ka("change",this.IHi);this.uF=this.fia.A0a(this.VP.Pn.parentNode,1E3,null,"",723);this.Mwf(null)};Vc.prototype.$Q=function(e){this.B3.$Q(e);this.bU.$Q(e);this.VP.$Q(e)};Vc.prototype.nka=function(){this.domElement.innerHTML=String.format(Y,ue.a.instance.fa(1073),ue.a.instance.fa(1074),ue.a.instance.fa(1075));this.C4d=new Ui.a(Bd.DOMElementExtensions.getElementById(this.domElement,Zb.lSd),!1);this.Z1d=new Ui.a(Bd.DOMElementExtensions.getElementById(this.domElement,
Zb.jSd),!1);this.$1d=new Ui.a(Bd.DOMElementExtensions.getElementById(this.domElement,Zb.kSd),!1)};Vc.prototype.QUg=function(e){return this.Wki||!Vc.Fcf(e)&&!Vc.Gcf(e)?!0:!!this.bU.count};Vc.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var e=this;this.$.userOperationManager.ic(new Sf.a(108,0,function(C,J,ja){var Aa=e.$.na.ta,gb=parseInt(e.bU.re.value,10);C=Jf.b.call(null,C,e.INi);var bc=jg.nb(Aa,e.cell,e.externalSourceIndex,e.yo);bc.selectedBaseField=gb;return jg.i(Aa,"GetPivotValueFieldSettingsShowValueAsBaseItems",
bc,C,J,ja,null,4)},16),this.de)};Vc.prototype.Flf=function(){this.VP.clear();this.bU.re&&(this.uF.MAa(),this.VP.Pn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};Vc.prototype.iNb=function(e){var C=document.getElementById("WACDialogActionButton");this.zTj&&C&&(C.disabled=e)};Vc.kOh=function(e){switch(e){case 0:return ue.a.instance.fa(1076);case 1:return ue.a.instance.fa(1077);case 2:return ue.a.instance.fa(1078);case 3:return ue.a.instance.fa(1079);case 4:return ue.a.instance.fa(1080);
case 5:return ue.a.instance.fa(1081);case 6:return ue.a.instance.fa(1082);case 7:return ue.a.instance.fa(1083);case 8:return ue.a.instance.fa(1085);case 9:return ue.a.instance.fa(1086);case 10:return ue.a.instance.fa(1087);case 11:return ue.a.instance.fa(1088);case 12:return ue.a.instance.fa(1089);case 13:return ue.a.instance.fa(1090);case 14:return ue.a.instance.fa(1091);default:return""}};Vc.Fcf=function(e){return 11===e||12===e||14===e||13===e||4===e};Vc.Gcf=function(e){return 1===e||3===e||2===
e};Qk.Object.defineProperties(Vc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ue.a.instance.fa(1072)}},wvb:{configurable:!0,enumerable:!0,get:function(){var e=this.B3.re?parseInt(this.B3.re.value,10):-1,C=this.bU.re?parseInt(this.bU.re.value,10):-1,J=this.VP.re?parseInt(this.VP.re.value,10):-1;return Object.assign(new xd,{SelectedDataFormat:0<=e?e:-1,SelectedBaseField:C,SelectedBaseItem:J})}},bU:{configurable:!0,enumerable:!0,get:function(){return this.Z1d}},VP:{configurable:!0,
enumerable:!0,get:function(){return this.$1d}},B3:{configurable:!0,enumerable:!0,get:function(){return this.C4d}}});Object(Md.a)(Vc,"ShowValueAsControl",Ah.a,[459,2]);Object(Md.a)(uc,"PivotValueFieldSummarizeValueByApplyData",null,[]);var zb="<div id='summarizeValuesByControlBody'><label class='"+(zg.a.io+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(zg.a.io+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+
(zg.a.wC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+Ca.a.zJ+"='pivotDataFieldSelectDescription'></select></div></div>"),gc=Ah.a;vm(Eb,gc);Eb.prototype.Tja=function(){return this.isVisible};Eb.prototype.Cna=function(e){return this.isVisible=e};Eb.prototype.setFocus=function(){Bd.DOMElementExtensions.setFocus(this.$k.Pn)};Eb.prototype.render=function(e){e.appendChild(this.domElement)};Eb.prototype.dispose=function(){fg.a.Fa(this.$k);gc.prototype.dispose.call(this)};Eb.prototype.focus=
function(){Bd.DOMElementExtensions.setFocus(this.$k.Pn)};Eb.prototype.ntj=function(e){this.$k.hTd();for(var C=yl(e.AggregationTypes),J=C.next();!J.done;J=C.next()){J=J.value;var ja=J===e.SelectedAggregation;this.$k.UTc(Eb.TJh(J),J.toString(),ja,"")}this.$k.g8c();this.$k.Pn.disabled=e.AggregationsDisabled};Eb.prototype.Gij=function(){this.$k.Hij()};Eb.prototype.nka=function(){this.domElement.innerHTML=String.format(zb,ue.a.instance.fa(1056),ue.a.instance.fa(1057));this.Kde=new Ui.a(Bd.DOMElementExtensions.getElementById(this.domElement,
Eb.HHf),!1)};Eb.TJh=function(e){switch(e){case 0:return ue.a.instance.fa(1059);case 1:return ue.a.instance.fa(1060);case 2:return ue.a.instance.fa(1061);case 3:return ue.a.instance.fa(1062);case 4:return ue.a.instance.fa(1063);case 5:return ue.a.instance.fa(1064);case 6:return ue.a.instance.fa(1065);case 7:return ue.a.instance.fa(1066);case 8:return ue.a.instance.fa(1067);case 9:return ue.a.instance.fa(1068);case 10:return ue.a.instance.fa(1069);case 11:return ue.a.instance.fa(1070);default:return""}};
Qk.Object.defineProperties(Eb.prototype,{wvb:{configurable:!0,enumerable:!0,get:function(){var e=this.$k.re?parseInt(this.$k.re.value,10):-1;return Object.assign(new uc,{Aggregation:0<=e?e:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return ue.a.instance.fa(1071)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.$k.Pn.disabled},set:function(e){this.$k.Pn.disabled=!e}},$k:{configurable:!0,enumerable:!0,get:function(){return this.Kde}}});Eb.HHf="pivotDataFieldSelect";
Object(Md.a)(Eb,"SummarizeValuesByControl",Ah.a,[459,2]);var bd=b(202),Id=b(463);La.prototype.HIj=function(e,C){e.set_visible(!1);C.set_visible(!0)};Object(Md.a)(La,"DefaultTabSwitchBehaviour",null,[467]);wh.tJj="TabsContainer";wh.cJj="TabTitlesContainer";wh.aJj="TabTitle";wh.bJj="TabTitleText";wh.GUd="TabTitleActive";Object(Md.a)(wh,"MultitabControlStyles",null,[]);var Vd=b(38),ve=b(91),Pe=b(89),We=b(85);ig.prototype.dispose=function(){Vd.a.removeHandler(this.ai,"keyup",Object(Sg.a)(this,this.R9a,
"onTitleKeyUp"));Vd.a.removeHandler(this.ai,"click",this.YFc);this.ai=this.Gfa=null};ig.prototype.setActive=function(e){e?Sys.UI.DomElement.addCssClass(this.ai,wh.GUd):Sys.UI.DomElement.removeCssClass(this.ai,wh.GUd);this.Gfa&&this.Gfa.setAttribute(Pe.a.iha,e)};ig.prototype.R9a=function(e){e.keyCode!==ve.a.Zh&&e.keyCode!==ve.a.Ioa||this.YFc(e)};ig.prototype.UAc=function(){this.ai.setAttribute(Pe.a.Ud,Pe.a.Qr);this.Gfa.setAttribute(Pe.a.Dt,this.Cp);this.Gfa.setAttribute(Pe.a.Ud,Pe.a.bob)};Qk.Object.defineProperties(ig.prototype,
{Kb:{configurable:!0,enumerable:!0,get:function(){return this.ai}},title:{configurable:!0,enumerable:!0,get:function(){return this.Cp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.ai,wh.GUd)},set:function(e){this.setActive(e)}}});Object(Md.a)(ig,"TabTitleControl",null,[2]);var Vf=b(47);xf.prototype.LRf=function(){this.$lb=document.createElement("ul");this.$lb.className=wh.cJj;this.Qlb=document.createElement("div");this.Qlb.className=wh.tJj;
for(var e=0;e<this.azc;++e){var C=this.iY.oa(e),J=this.REa.oa(e);C.set_visible(!1);J.isActive=!1;var ja=document.createElement("div");C.render(ja);this.Qlb.appendChild(ja);this.$lb.appendChild(J.Kb)}this.Kb.appendChild(this.$lb);this.Kb.appendChild(this.Qlb);this.rrd(this.o1)&&(this.REa.oa(this.o1).isActive=!0,this.iY.oa(this.o1).set_visible(!0))};xf.prototype.dispose=function(){for(var e=0;e<this.azc;++e)this.iY.oa(e).dispose(),this.REa.oa(e).dispose();this.REa=this.iY=this.ai=this.Qlb=this.$lb=
null};xf.prototype.setFocus=function(){this.iY.oa(this.o1).setFocus()};xf.prototype.rrd=function(e){return 0<=e&&e<this.azc};xf.prototype.C8f=function(e){this.o1!==e&&this.rrd(e)&&(this.oxg.HIj(this.iY.oa(this.o1),this.iY.oa(e)),this.REa.oa(this.o1).isActive=!1,this.REa.oa(e).isActive=!0,this.o1=e,this.setFocus())};xf.prototype.r6g=function(e){var C=this;return function(){C.C8f(e)}};Qk.Object.defineProperties(xf.prototype,{azc:{configurable:!0,enumerable:!0,get:function(){return this.iY.count}},activeTab:{configurable:!0,
enumerable:!0,get:function(){return this.o1},set:function(e){this.C8f(e)}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.ai}},visible:{configurable:!0,enumerable:!0,get:function(){return Vf.a.isVisible(this.ai)},set:function(e){this.ai.style.visibility=e?"visible":"hidden"}}});Object(Md.a)(xf,"MultitabControl",null,[458,2]);var $f=lh.a;vm(mg,$f);mg.prototype.dispose=function(){this.q5c=this.xrb=this.eSa=this.wRc=null;fg.a.Fa(this.Tfa);this.Tfa=null;$f.prototype.dispose.call(this)};
mg.prototype.initialize=function(){var e="<div id='"+Zb.iGe+"' class='"+zg.a.io+"'></div><div id='"+Zb.nbh+"' class='"+zg.a.io+"'><label for='"+Zb.tZd+"'>{0}</label><input type='text' id='"+Zb.tZd+"' value='{1}' class='"+zg.a.wC+" UIFont' /></div><div id='"+Zb.Vfg+"'></div>";e=String.format(e,ue.a.instance.fa(1055),Dg.a.Lf(this.Ufg));this.Pb.innerHTML=e;this.Ne||(this.z2(),this.Vk());this.Aje=[-103190598];this.d1h();$f.prototype.initialize.call(this)};mg.prototype.close=function(e){1===e&&(this.v3f=
!1);$f.prototype.close.call(this,e)};mg.prototype.mIe=function(e){this.fR=e;this.domElement.disabled=e;for(var C=["input","option","select"],J=0,ja=C.length;J<ja;++J)for(var Aa=this.domElement.getElementsByTagName(C[J]),gb=0;gb<Aa.length;++gb)Aa[gb].disabled=e};mg.prototype.Vk=function(){this.xrb=document.getElementById(Zb.tZd);this.q5c=Bd.DOMElementExtensions.getElementById(this.Pb,Zb.iGe);var e=Bd.DOMElementExtensions.getElementById(this.Pb,Zb.Vfg);this.wRc=new Eb(document.createElement("div"));
this.eSa=new Vc(document.createElement("div"),this.$,this.cell,this.yo,this.externalSourceIndex,this.de,this.fia,!this.isOlap);var C;this.Tfa=new xf(e,(C=new va.a,C.add(this.JSa),C.add(this.eSa),C));this.Tfa.LRf()};mg.prototype.Npc=function(){var e=new mg(this.cell,this.yo,this.externalSourceIndex,this.Ufg,this.$,this.de,this.fia,this.isOlap,this.OH);e.initialize();e.mf()};mg.prototype.STa=function(){var e=new Id.a;if(!this.v3f)return e.isValid=!0,e;this.xrb.value.length?e.isValid=!0:(this.mIe(!0),
e.error=dh.a.jd(1,0,738,753,0,1783218700,"PivotTableValueFieldNoBlank"),this.fR=!0,this.Ne||(this.sx.disabled=!0),e.isValid=!1);return e};mg.prototype.t6e=function(){this.fR=!1;this.Ne||(this.sx.disabled=!1);this.mIe(!1)};mg.prototype.oya=function(e){var C=new hh.a(2105621672,0,this.$.hd,30,null);this.$.Ka.Yb(C);this.OW(5,e.yb,"Number Format");return!0};mg.prototype.lm=function(){this.iBa=String.format(ue.a.instance.Cb(60),null);$f.prototype.lm.call(this)};mg.prototype.setFocus=function(){if(this.Ne){var e=
Bd.DOMElementExtensions.getElementById(this.Pb,Eb.HHf);bd.a.tAc(e)}else this.Tfa.setFocus()};mg.prototype.Yl=function(){var e=this,C=this.eSa.wvb,J=new re(C.SelectedDataFormat,C.SelectedBaseField,C.SelectedBaseItem);return function(){return new Od(e.externalSourceIndex,e.cell,e.xrb.value,e.JSa.wvb.Aggregation,J)}};mg.prototype.nx=function(){var e=this,C=Object.assign(new Nc,{PivotValueFieldSummarizeValueByApplyData:this.JSa.wvb,PivotValueFieldShowValueAsApplyData:this.eSa.wvb,PivotValueFieldTitle:this.xrb.value});
return function(J,ja,Aa){var gb=e.$.na.ta;J=Jf.b(J,e.xHi);var bc=jg.nb(gb,e.cell,e.externalSourceIndex,e.yo);bc.pivotValueFieldSettingsApplyData=C;return jg.i(gb,"ApplyPivotValueFieldSettings",bc,J,ja,Aa,null,0)}};mg.prototype.$Q=function(e){var C=this;this.$.da.Za(40,function(){C.eSa.$Q(e)})};mg.prototype.d1h=function(){var e=this;this.$.userOperationManager.ic(new Sf.a(123,0,function(C,J,ja){var Aa=e.$.na.ta;C=Jf.b.call(null,C,e.HNi);var gb=jg.nb(Aa,e.cell,e.externalSourceIndex,e.yo);return jg.i(Aa,
"GetPivotValueFieldSettingsInitial",gb,C,J,ja,null,4)},16),this.de)};Qk.Object.defineProperties(mg.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},Hea:{configurable:!0,enumerable:!0,get:function(){return this.Aje}},eCb:{configurable:!0,enumerable:!0,get:function(){return this.Tfa}},JSa:{configurable:!0,enumerable:!0,get:function(){return this.wRc}},Qw:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(Md.a)(mg,"ValueFieldSettingsDialog",
lh.a,[]);var Hg=Ca.a.w2g,Tg=og.a;vm(bg,Tg);bg.prototype.executeCommand=function(e,C,J,ja){var Aa=this;e=C.command;switch(e){case -1453503574:ja=J.domElement;this.ko=J.fieldItem;this.D_d=J.zoneCount;this.rSa=J.sourceAxis;this.cyc=J.sourceAxisPos;this.yo=J.optionalPivotMenuAnchorParameter;this.ML=J.versionkey;this.isOlap=J.isOlap;this.OH=J.isPpm;this.s2a="fieldItemsupportsImplicitMeasures"in J?J.fieldItemsupportsImplicitMeasures:!1;this.cell=J.cell;this.externalSourceIndex=J.externalSourceIndex;Oe.g(this.$).Qq(!0);
e=Bd.DOMElementExtensions.getBounds(ja);var gb=new Sys.UI.Point(e.x,e.y+e.height);this.$.isChromeRtl&&(gb.x+=e.width);this.ATa(gb,ja);"isKeyboardInput"in J&&J.isKeyboardInput?this.Do(gb,!1,1):this.Do(gb,!1);break;case 495005930:rc.a(this.$).vfh();break;case -1170196828:rc.a(this.$).bH(this.ko,this.rSa,this.cyc-1,this.ML,C);break;case -889576107:rc.a(this.$).bH(this.ko,this.rSa,this.cyc+2,this.ML,C);break;case 2033235475:rc.a(this.$).bH(this.ko,this.rSa,this.D_d,this.ML,C);break;case 389774337:rc.a(this.$).bH(this.ko,
this.rSa,0,this.ML,C);break;case -96230454:rc.a(this.$).bH(this.ko,4,-1,this.ML,C);break;case 74086617:rc.a(this.$).bH(this.ko,1,-1,this.ML,C);break;case 1529312473:rc.a(this.$).bH(this.ko,2,-1,this.ML,C);break;case 563292088:this.s2a&&Gd.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");rc.a(this.$).bH(this.ko,8,-1,this.ML,C);break;case -1092351914:rc.a(this.$).bH(this.ko,0,-1,this.ML,C);break;case -2141589616:var bc=Zg.GetServiceTaskFactory.Wa(this.$.da,12,
477,ja.Mja());return Pd.TaskExtensions.Ba(bc,function(){(new mg(Aa.cell,Aa.yo,Aa.externalSourceIndex,Aa.ko.Name,Aa.$,C,bc.result,Aa.isOlap,Aa.OH)).initialize()},this.ma);default:return Ag.a(e)}return Tf.Task.Ta(!0)};bg.prototype.Kc=function(e,C,J){e=!1;switch(C.command){case -1453503574:e=!!J;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:e=!0}return e};bg.prototype.VY=
function(){var e=this.Sa.Kp(this.menuId);this.S_i(e,this.cyc,this.D_d);this.T_i(e,this.rSa);this.U_i(e);8===this.rSa&&this.Q_i(e);return e};bg.prototype.S_i=function(e,C,J){var ja=this.Sa,Aa=ja.Nc();C||C!==J-1?!C&&C<J-1?(Array.add(Aa.buttons,ja.Bb(64)),Array.add(Aa.buttons,ja.Bb(61)),Array.add(Aa.buttons,ja.Bb(66)),Array.add(Aa.buttons,ja.Bb(63))):0<C&&C<J-1?(Array.add(Aa.buttons,ja.Bb(60)),Array.add(Aa.buttons,ja.Bb(61)),Array.add(Aa.buttons,ja.Bb(62)),Array.add(Aa.buttons,ja.Bb(63))):0<C&&C===J-
1&&(Array.add(Aa.buttons,ja.Bb(60)),Array.add(Aa.buttons,ja.Bb(65)),Array.add(Aa.buttons,ja.Bb(62)),Array.add(Aa.buttons,ja.Bb(67))):(Array.add(Aa.buttons,ja.Bb(64)),Array.add(Aa.buttons,ja.Bb(65)),Array.add(Aa.buttons,ja.Bb(66)),Array.add(Aa.buttons,ja.Bb(67)));Array.add(e.Ac,Aa)};bg.prototype.T_i=function(e,C){var J=this.Sa,ja=J.Nc(),Aa=1!==C&&(!this.isOlap||this.OH||8!==C||this.s2a),gb=2!==C&&(!this.isOlap||this.OH||8!==C||this.s2a),bc=8!==C&&-2!==this.ko.PivotTableIndex&&(!this.isOlap||this.OH||
this.s2a);Array.add(ja.buttons,J.Bb(4===C||this.ko.IsSet||-2===this.ko.PivotTableIndex||this.isOlap&&!this.OH&&8===C&&!this.s2a?72:68));8===this.yo.AnchorType||10===this.yo.AnchorType?(Array.add(ja.buttons,J.Bb(Aa?95:97)),Array.add(ja.buttons,J.Bb(gb?96:98))):(Array.add(ja.buttons,J.Bb(Aa?69:73)),Array.add(ja.buttons,J.Bb(gb?70:74)));Array.add(ja.buttons,J.Bb(bc?71:75));Array.add(e.Ac,ja)};bg.prototype.U_i=function(e){var C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(76));Array.add(e.Ac,C)};bg.prototype.Q_i=
function(e){var C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(77));Array.add(e.Ac,C)};Qk.Object.defineProperties(bg.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.uGd}}});Object(Md.a)(bg,"FieldWellContextMenu",og.a,[]);var Bi=b(1238);vm(Xf,Xd);Xf.prototype.executeCommand=function(e,C,J){var ja=!1,Aa=C.command;switch(Aa){case 37023044:ja=this.B$c(J,C);break;case 541421805:case -569786022:ja=
this.Zid(e,C)}return ja?Tf.Task.Ta(!0):Ag.a(Aa)};Xf.prototype.Kc=function(e,C,J){e=!1;switch(C.command){case 37023044:e=!!J;break;case 541421805:case -569786022:e=!0}return e};Xf.prototype.Zid=function(e,C){var J=8===e,ja=this.$,Aa=gd.a(ja),gb=Oe.g(ja).ha.Pa.mc,bc=e=null;J&&Aa?(e=Aa.chartId,bc=Aa.Yc):!J&&gb&&(e=gb.floatingObject.id,bc=gb.floatingObject.Yc);return Xf.Vre(bc,260)?(J={},ja.Bj(J),J.FirstColumn=J.FirstRow=-1,ja={},bc=(ja.rawEvent=null,ja.pivotName=null,ja.cell=J,ja.requiresConfirmation=
Xf.Vre(bc,64),ja.dataSourceIndex=bc.ExternalSourceIndex,ja),gb?(Aa=gb.floatingObject,bc.domElement=gb.domElement,bc.objectId=Aa.id,bc.objectVersion=Aa.version):Aa&&(bc.domElement=Aa.Xj,bc.objectId=Aa.chartId,bc.objectVersion=Aa.$xe),gb={AnchorType:7},gb.ChartId=e,gb.AnchorValue1=-1,gb.AnchorValue2=-1,bc.optionalPivotMenuAnchorParameter=gb,this.B$c(bc,C)):!1};Xf.Vre=function(e,C){return(e.Attributes&C)===C};Qk.Object.defineProperties(Xf.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},
pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.OMf}}});Object(Md.a)(Xf,"PivotFilterContextMenu",Xd,[]);var Cf=b(1271),Ih=b(975),Eh=b(150),Gg=b(26),ti=Ca.a.A2g,R=ti+".RemoveField",za=ti+".Subtotal",jb=ti+".ClearFilter",Jb=ti+".LayoutSameColumn",Dc=ti+".LayoutNextColumn",ic=og.a;vm(Ze,ic);Ze.prototype.executeCommand=function(e,C,J){C=C.command;e=null;this.grid=Oe.g(this.$);this.activeCell=ud.o(this.grid.ha.va.activeCell,this.$);if(this.$.isEditMode&&(this.Vc=this.grid.Sb.Zo(this.grid.ha.va.activeCell),
!this.Vc))return Gd.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),Pd.TaskExtensions.D4();this.ICc=this.$.na.ta;this.p0a=Object(X.a)(na.a,J.eventArgs);switch(C){case 671488277:!this.$.isEditMode||this.Vc.Xfc||this.Vc.Qgc()&&!this.t2f(!1)?(this.tbb(),this.showPivotTableContextMenu()):this.PVh();break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,
7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.GRa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.GRa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.GRa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.GRa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.GRa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.GRa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:J=Number.parseInvariant(J.MenuItemId.split(".")[2]);this.GRa(11,J);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.ye(-1556797033,If.a.dc,8,null);break;case 1514686611:this.$ri();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:J=Number.parseInvariant(J.MenuItemId);this.HYg(J);break;case 1778578888:J=Number.parseInvariant(J.MenuItemId);
this.DKg(J);break;default:e=Ag.a(C)}return e||Pd.TaskExtensions.D4()};Ze.prototype.Kc=function(e,C){e=!1;switch(C.command){case 671488277:e=Ih.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:e=!0;break;case 1600778266:e=!0;break;case -556893687:e=!0;break;case -1966978671:e=!0;break;case -1951357930:e=!0;break;case -1390365353:case -1457478532:e=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:e=
!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:e=!0;break;case -1007663920:case 234234584:case 1194992911:e=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:e=!0}return e};Ze.prototype.Zc=function(e,C){var J=!1;switch(C){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:J=
this.qS();break;case -1007663920:case 234234584:J=this.Vxj()||this.qS();break;case 1194992911:J=this.Wxj()||this.qS();break;case 1217404289:J=!Cf.j(this.Db.LabelOrDateFilterType)||this.qS();break;case -743135194:J=!Cf.m(this.Db.ValueFilterType)&&!Cf.l(this.Db.ValueFilterType)||this.qS();break;case 771421327:J=0===this.Db.LabelOrDateFilterType&&0===this.Db.ValueFilterType&&!this.Db.HasManualFilter||this.qS();break;case 1015867427:J=!Cf.i(this.Db.LabelOrDateFilterType)||this.qS();break;case 1105960559:J=
!Cf.k(this.Db.LabelOrDateFilterType)||this.qS()}return J||ic.prototype.Zc.call(this,e,C)};Ze.prototype.tbb=function(){this.O$a=this.Db=this.ag=null};Ze.prototype.TTd=function(){this.grid.QT(this.ft);this.$.Ka.AFa(this.Zt)};Ze.prototype.xXd=function(){this.grid.gO(this.ft);this.$.Ka.Yab(this.Zt)};Ze.prototype.pJb=function(){if(this.Vc&&this.Vc.Po){this.ag=this.Vc.Po;this.Db=this.Vc.tac();if(this.h3f()){var e=this.Vc.qL[4===this.ag.CellType?this.Vc.s5c-1:this.ag.CurrentFieldIndex-1];e&&(this.O$a=-2===
e.Index?this.Vc.nGe:e.Caption)}this.tai();this.Db&&8===this.ag.CellArea&&(this.Oz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Db.DataFieldAggregationType,this.Oz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Db.DataFieldFormatType,this.Oz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Db.BaseFieldIndex,this.Oz.PivotValueFieldTitle=this.Db.Caption)}};Ze.prototype.t2f=function(e){if(!this.Vc)return!1;e=this.Vc.isOlap&&!this.Vc.h7a(!e);return xe.EwaSettings.la(605)&&
e};Ze.prototype.cyj=function(){var e=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.Db.MeasureType&&(!this.Vc.Zgf||e&&2===this.Db.MeasureType)};Ze.prototype.VY=function(){var e=this.Sa.Kp(this.menuId),C=this.Sa.Nc();if(this.Vc)this.ag&&this.Vc.Po&&this.ag!==this.Vc.Po&&Gd.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Db&&this.Db!==this.Vc.tac()&&Gd.ULS.shipAssertTag(537167005,0,
!1,"CurrentField is out of sync with field from PivotTable Range");else return e;this.mHh(e);if(this.$.isEditMode){this.refresh&&this.AIh(e);if(this.ag&&this.Db){var J=this.Sa.Nc();this.PIh(J);this.BHh(J);Array.add(e.Ac,J)}this.lZ&&Array.add(C.buttons,this.Sa.Bb(99));this.ag&&this.Db&&this.XHh(e);if(this.expandCollapse){J=this.Sa.Wv("ContextMenu.PivotExpandCollapse",null,ue.a.instance.fa(1120),589118293);var ja=this.Sa.Nc();Array.add(ja.buttons,this.Sa.Bb(243));Array.add(ja.buttons,this.Sa.Bb(244));
Array.add(ja.buttons,this.Sa.Bb(245));Array.add(ja.buttons,this.Sa.Bb(246));Array.add(J.menu.Ac,ja);J&&0<ja.buttons.length&&Array.add(C.buttons,J)}this.ag&&this.BIh(e);this.ag&&this.Db&&8===this.ag.CellArea&&8!==this.ag.CellType&&(J=this.Sa.Nc(),this.cyj()&&this.RIh(J),3!==this.ag.CellType&&this.MIh(J),Array.add(e.Ac,J));!this.Vc.Qgc()&&this.ag&&0===this.ag.CellType&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.LIh(e);xe.EwaSettings.la(325)&&(this.Eli()?
Array.add(C.buttons,this.Sa.Bb(257)):Array.add(C.buttons,this.Sa.Bb(258)));this.hod?Array.add(C.buttons,this.Sa.Bb(59)):Array.add(C.buttons,this.Sa.Bb(58))}Array.add(e.Ac,C);return e};Ze.prototype.fRd=function(){return this.Db&&this.Db.Caption?20<this.Db.Caption.length:!1};Ze.prototype.wed=function(e){return this.Db&&this.Db.Caption?e?this.Db.Caption.substring(0,20)+"...":this.Db.Caption:""};Ze.prototype.mva=function(e){return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?
E.a.hashCode(e).toString():e};Ze.prototype.PIh=function(e){if(this.ag&&this.Db&&4!==this.ag.CellArea){var C=this.Pua(this.nH("PivotTableContextMenu.Sort",this.mva(this.Db.Caption)),-1777747317,0,0!==this.Db.SortInfo,ue.a.instance.fa(228)),J=this.Sa.Nc();Array.add(J.buttons,this.ee("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Db.SortInfo,ue.a.instance.fa(229)));Array.add(J.buttons,this.ee("PivotTableContextMenu.SortDescending",234234584,0,2===this.Db.SortInfo,ue.a.instance.fa(230)));
1!==this.ag.CellArea&&2!==this.ag.CellArea||Array.add(J.buttons,this.ee("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Db.SortInfo||4===this.Db.SortInfo,ue.a.instance.fa(155)));Array.add(C.menu.Ac,J);C&&0<J.buttons.length&&Array.add(e.buttons,C)}};Ze.prototype.BHh=function(e){if(this.ag&&this.Db&&(1===this.ag.CellArea||2===this.ag.CellArea)){var C=this.rzj(),J=this.Pua(this.nH("PivotTableContextMenu.Filter",this.mva(this.Db.Caption)),-1777747317,0,C,ue.a.instance.fa(644)),ja=this.Sa.Nc(),
Aa="",gb=this.fRd(),bc=String.format(ue.a.instance.Cb(155),this.wed(gb));gb&&(Aa=String.format(ue.a.instance.Cb(155),this.Db.Caption));C=this.mva(this.Db.Caption)+"."+(C?"enabled":"disabled");Aa=this.ee(this.nH(jb,C),771421327,0,!1,bc,"0",Aa,8,k.a.g2a);C=this.mva(this.Db.Caption)+"."+this.Db.LabelOrDateFilterType.toString();this.Db.IsDateField?(bc=this.Pua(this.nH("PivotTableContextMenu.DateFilter",C),-1777747317,0,0!==this.Db.LabelOrDateFilterType,ue.a.instance.fa(96)),this.pHh(bc.menu)):(bc=this.Pua(this.nH("PivotTableContextMenu.LabelFilter",
C),-1777747317,0,0!==this.Db.LabelOrDateFilterType,ue.a.instance.fa(642)),this.WHh(bc.menu));C=this.mva(this.Db.Caption)+"."+this.Db.ValueFilterType.toString();C=this.Pua(this.nH("PivotTableContextMenu.ValueFilter",C),-1777747317,0,0!==this.Db.ValueFilterType,ue.a.instance.fa(643));this.cJh(C.menu);gb=this.Sa.Nc();Array.add(gb.buttons,this.ee("PivotTableContextMenu.ManualFilter",1514686611,0,this.Db.HasManualFilter,ue.a.instance.fa(93)));Array.add(ja.buttons,Aa);Array.add(ja.buttons,bc);Array.add(ja.buttons,
C);Array.add(J.menu.Ac,ja);Array.add(J.menu.Ac,gb);J&&0<ja.buttons.length&&Array.add(e.buttons,J)}};Ze.prototype.pHh=function(e){Array.add(e.Ac,this.Qac(!0,!1));Array.add(e.Ac,this.oOh());Array.add(e.Ac,this.nOh());Array.add(e.Ac,this.dQh());Array.add(e.Ac,this.gQh());Array.add(e.Ac,this.eQh());Array.add(e.Ac,this.fQh());Array.add(e.Ac,this.hQh());Array.add(e.Ac,this.iQh());Array.add(e.Ac,this.bOh())};Ze.prototype.gHh=function(e){Array.add(e.Ac,this.Qac(!0,!0));Array.add(e.Ac,this.KWh());Array.add(e.Ac,
this.fUh())};Ze.prototype.WHh=function(e){Array.add(e.Ac,this.Qac(!0,!1));Array.add(e.Ac,this.PZe(!0));Array.add(e.Ac,this.NKh());Array.add(e.Ac,this.kNh());Array.add(e.Ac,this.PYe(!0));Array.add(e.Ac,this.VXe(!0))};Ze.prototype.cJh=function(e){Array.add(e.Ac,this.Qac(!1,!1));Array.add(e.Ac,this.PZe(!1));Array.add(e.Ac,this.PYe(!1));Array.add(e.Ac,this.VXe(!1));Array.add(e.Ac,this.a0h())};Ze.prototype.a0h=function(){var e=this.Sa.Nc();Array.add(e.buttons,this.ee("PivotTableContextMenu.Top10",-1611233597,
0,Cf.l(this.Db.ValueFilterType),ue.a.instance.fa(104)));return e};Ze.prototype.kNh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.Contains",786260386,0,10===this.Db.LabelOrDateFilterType,ue.a.instance.fa(645),"10")),Array.add(e.buttons,this.ee("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Db.LabelOrDateFilterType,ue.a.instance.fa(646),"11")));return e};Ze.prototype.NKh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.BeginsWith",
786260386,0,6===this.Db.LabelOrDateFilterType,ue.a.instance.fa(647),"6")),Array.add(e.buttons,this.ee("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Db.LabelOrDateFilterType,ue.a.instance.fa(648),"7")),Array.add(e.buttons,this.ee("PivotTableContextMenu.EndsWith",786260386,0,8===this.Db.LabelOrDateFilterType,ue.a.instance.fa(649),"8")),Array.add(e.buttons,this.ee("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.Db.LabelOrDateFilterType,ue.a.instance.fa(650),"9")));return e};
Ze.prototype.PZe=function(e){var C=this.Sa.Nc();if(this.Db){var J=e?Cf.c:Cf.f;Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.Equals",J),786260386,0,e?4===this.Db.LabelOrDateFilterType:18===this.Db.ValueFilterType,ue.a.instance.fa(99),e?"4":"18"));Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.DoesNotEqual",J),786260386,0,e?5===this.Db.LabelOrDateFilterType:19===this.Db.ValueFilterType,ue.a.instance.fa(100),e?"5":"19"))}return C};Ze.prototype.PYe=function(e){var C=this.Sa.Nc();
if(this.Db){var J=e?Cf.c:Cf.f;Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.GreaterThan",J),786260386,0,e?12===this.Db.LabelOrDateFilterType:20===this.Db.ValueFilterType,ue.a.instance.fa(101),e?"12":"20"));Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.GreaterThanOrEqualTo",J),786260386,0,e?13===this.Db.LabelOrDateFilterType:21===this.Db.ValueFilterType,ue.a.instance.fa(651),e?"13":"21"));Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.LessThan",J),786260386,0,
e?14===this.Db.LabelOrDateFilterType:22===this.Db.ValueFilterType,ue.a.instance.fa(102),e?"14":"22"));Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.LessThanOrEqualTo",J),786260386,0,e?15===this.Db.LabelOrDateFilterType:23===this.Db.ValueFilterType,ue.a.instance.fa(652),e?"15":"23"))}return C};Ze.prototype.VXe=function(e){var C=this.Sa.Nc();if(this.Db){var J=e?Cf.c:Cf.f;Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.Between",J),786260386,0,e?16===this.Db.LabelOrDateFilterType:
24===this.Db.ValueFilterType,ue.a.instance.fa(103),e?"16":"24"));Array.add(C.buttons,this.ee(this.nH("PivotTableContextMenu.NotBetween",J),786260386,0,e?17===this.Db.LabelOrDateFilterType:25===this.Db.ValueFilterType,ue.a.instance.fa(653),e?"17":"25"))}return C};Ze.prototype.Qac=function(e,C){var J=this.Sa.Nc();if(this.Db){var ja=ue.a.instance.fa(97),Aa=e?this.Db.LabelOrDateFilterType.toString():this.Db.ValueFilterType.toString(),gb=["PivotTableContextMenu.ClearFilter",this.mva(this.Db.Caption),Aa];
e=e?this.Db.IsDateField?C?1015867427:1105960559:1217404289:-743135194;gb.push(e.toString());gb=gb.join(".");ja=this.ee(gb,e,0,!1,ja,Aa,ja,8,k.a.g2a);Array.add(J.buttons,ja)}return J};Ze.prototype.oOh=function(){var e=this.Sa.Nc();this.Db&&Array.add(e.buttons,this.ee(this.nH("PivotTableContextMenu.Equals",Cf.d),786260386,0,26===this.Db.LabelOrDateFilterType,ue.a.instance.fa(99),"26"));return e};Ze.prototype.nOh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.Before",
786260386,0,27===this.Db.LabelOrDateFilterType,ue.a.instance.fa(111),"27")),Array.add(e.buttons,this.ee("PivotTableContextMenu.After",786260386,0,28===this.Db.LabelOrDateFilterType,ue.a.instance.fa(112),"28")),Array.add(e.buttons,this.ee("PivotTableContextMenu.Between",786260386,0,29===this.Db.LabelOrDateFilterType,ue.a.instance.fa(103),"29")));return e};Ze.prototype.dQh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Db.LabelOrDateFilterType,
ue.a.instance.fa(109),"30")),Array.add(e.buttons,this.ee("PivotTableContextMenu.Today",1778578888,0,31===this.Db.LabelOrDateFilterType,ue.a.instance.fa(108),"31")),Array.add(e.buttons,this.ee("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Db.LabelOrDateFilterType,ue.a.instance.fa(110),"32")));return e};Ze.prototype.gQh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Db.LabelOrDateFilterType,ue.a.instance.fa(114),
"33")),Array.add(e.buttons,this.ee("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.Db.LabelOrDateFilterType,ue.a.instance.fa(113),"34")),Array.add(e.buttons,this.ee("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Db.LabelOrDateFilterType,ue.a.instance.fa(115),"35")));return e};Ze.prototype.eQh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Db.LabelOrDateFilterType,ue.a.instance.fa(116),"36")),Array.add(e.buttons,
this.ee("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Db.LabelOrDateFilterType,ue.a.instance.fa(117),"37")),Array.add(e.buttons,this.ee("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Db.LabelOrDateFilterType,ue.a.instance.fa(118),"38")));return e};Ze.prototype.fQh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Db.LabelOrDateFilterType,ue.a.instance.fa(119),"39")),Array.add(e.buttons,this.ee("PivotTableContextMenu.ThisQuarter",
1778578888,0,40===this.Db.LabelOrDateFilterType,ue.a.instance.fa(120),"40")),Array.add(e.buttons,this.ee("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Db.LabelOrDateFilterType,ue.a.instance.fa(121),"41")));return e};Ze.prototype.hQh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.NextYear",1778578888,0,42===this.Db.LabelOrDateFilterType,ue.a.instance.fa(122),"42")),Array.add(e.buttons,this.ee("PivotTableContextMenu.ThisYear",1778578888,0,43===
this.Db.LabelOrDateFilterType,ue.a.instance.fa(123),"43")),Array.add(e.buttons,this.ee("PivotTableContextMenu.LastYear",1778578888,0,44===this.Db.LabelOrDateFilterType,ue.a.instance.fa(124),"44")));return e};Ze.prototype.iQh=function(){var e=this.Sa.Nc();if(this.Db){Array.add(e.buttons,this.ee("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Db.LabelOrDateFilterType,ue.a.instance.fa(125),"45"));var C=this.Pua("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Cf.i(this.Db.LabelOrDateFilterType),
ue.a.instance.fa(126));this.gHh(C.menu);Array.add(e.buttons,C)}return e};Ze.prototype.bOh=function(){var e=this.Sa.Nc();this.Db&&Array.add(e.buttons,this.ee("PivotTableContextMenu.CustomFilter",786260386,0,this.ozj(this.Db.LabelOrDateFilterType),ue.a.instance.fa(107),"26"));return e};Ze.prototype.KWh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Db.LabelOrDateFilterType,ue.a.instance.fa(127),"46")),Array.add(e.buttons,this.ee("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.Db.LabelOrDateFilterType,ue.a.instance.fa(128),"47")),Array.add(e.buttons,this.ee("PivotTableContextMenu.Quarter3",1778578888,0,48===this.Db.LabelOrDateFilterType,ue.a.instance.fa(129),"48")),Array.add(e.buttons,this.ee("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Db.LabelOrDateFilterType,ue.a.instance.fa(130),"49")));return e};Ze.prototype.fUh=function(){var e=this.Sa.Nc();this.Db&&(Array.add(e.buttons,this.ee("PivotTableContextMenu.January",1778578888,0,50===this.Db.LabelOrDateFilterType,
ue.a.instance.fa(131),"50")),Array.add(e.buttons,this.ee("PivotTableContextMenu.February",1778578888,0,51===this.Db.LabelOrDateFilterType,ue.a.instance.fa(132),"51")),Array.add(e.buttons,this.ee("PivotTableContextMenu.March",1778578888,0,52===this.Db.LabelOrDateFilterType,ue.a.instance.fa(133),"52")),Array.add(e.buttons,this.ee("PivotTableContextMenu.April",1778578888,0,53===this.Db.LabelOrDateFilterType,ue.a.instance.fa(134),"53")),Array.add(e.buttons,this.ee("PivotTableContextMenu.May",1778578888,
0,54===this.Db.LabelOrDateFilterType,ue.a.instance.fa(135),"54")),Array.add(e.buttons,this.ee("PivotTableContextMenu.June",1778578888,0,55===this.Db.LabelOrDateFilterType,ue.a.instance.fa(136),"55")),Array.add(e.buttons,this.ee("PivotTableContextMenu.July",1778578888,0,56===this.Db.LabelOrDateFilterType,ue.a.instance.fa(137),"56")),Array.add(e.buttons,this.ee("PivotTableContextMenu.August",1778578888,0,57===this.Db.LabelOrDateFilterType,ue.a.instance.fa(138),"57")),Array.add(e.buttons,this.ee("PivotTableContextMenu.September",
1778578888,0,58===this.Db.LabelOrDateFilterType,ue.a.instance.fa(139),"58")),Array.add(e.buttons,this.ee("PivotTableContextMenu.October",1778578888,0,59===this.Db.LabelOrDateFilterType,ue.a.instance.fa(140),"59")),Array.add(e.buttons,this.ee("PivotTableContextMenu.November",1778578888,0,60===this.Db.LabelOrDateFilterType,ue.a.instance.fa(141),"60")),Array.add(e.buttons,this.ee("PivotTableContextMenu.December",1778578888,0,61===this.Db.LabelOrDateFilterType,ue.a.instance.fa(142),"61")));return e};
Ze.prototype.XHh=function(e){var C=this.Sa.Nc();if(this.h3f()){var J=this.Vc.qL[4===this.ag.CellType?this.Vc.s5c-1:this.ag.CurrentFieldIndex-1];if(J&&this.O$a){var ja=this.Sa.Wv("ContextMenu.PivotTableLayout",null,ue.a.instance.fa(640),-1777747317);var Aa=this.Sa.Nc(),gb=String.format(ue.a.instance.Cb(160),this.O$a),bc=String.format(ue.a.instance.Cb(161),this.O$a);Array.add(Aa.buttons,this.ee(Dc,-1457478532,0,!J.IsCompactLayout,gb));Array.add(Aa.buttons,this.ee(Jb,-1390365353,0,J.IsCompactLayout,
bc));Array.add(ja.menu.Ac,Aa);ja&&Array.add(C.buttons,ja)}}if(1===this.ag.CellArea||2===this.ag.CellArea)this.Db.Caption&&(J="",Aa=this.fRd(),ja=String.format(ue.a.instance.Cb(158),this.wed(Aa)),Aa&&(J=String.format(ue.a.instance.Cb(158),this.Db.Caption)),1===this.ag.CellArea?(J=this.Pua("ContextMenu.PivotTableSubtotal",1801458190,0,this.Db.ShowSubtotal,ja),ja=this.Sa.Nc(),Array.add(ja.buttons,this.Sa.Bb(259)),Array.add(ja.buttons,this.ee("ContextMenu.PivotTableSubtotalOnTop",671485366,632,this.Db.ShowSubtotal&&
this.Db.ShowSubtotalAtTop)),Array.add(ja.buttons,this.ee("ContextMenu.PivotTableSubtotalOnBottom",772221736,633,this.Db.ShowSubtotal&&!this.Db.ShowSubtotalAtTop)),Array.add(J.menu.Ac,ja),J&&0<ja.buttons.length&&Array.add(C.buttons,J)):(Aa=Aa?this.nH(za,this.mva(ja)):za,Array.add(C.buttons,this.ee(Aa,1801458190,0,this.Db.ShowSubtotal,ja,null,J)))),Array.add(C.buttons,this.ee("ContextMenu.RepeatItemLabels",-556893687,635,this.Db.RepeatItemLabels));1===this.ag.CellArea&&Array.add(C.buttons,this.ee("ContextMenu.PivotBlankLineAfterEachItem",
1600778266,634,this.Db.ShowBlankLineAfterEachItem));Array.add(e.Ac,C)};Ze.prototype.LIh=function(e){var C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(247));Array.add(e.Ac,C)};Ze.prototype.BIh=function(e){var C="",J="",ja=!1;3===this.ag.CellType?C=ue.a.instance.fa(637):8===this.ag.CellType?this.Vc&&(C=String.format(ue.a.instance.Cb(159),this.Vc.nGe)):this.Db&&((ja=this.fRd())&&(J=String.format(ue.a.instance.Cb(159),this.Db.Caption)),C=String.format(ue.a.instance.Cb(159),this.wed(ja)));if(C){var Aa=
this.Sa.Nc();ja=ja?this.nH(R,this.mva(C)):R;C=this.ee(ja,-1951357930,0,!1,C,null,J,8,k.a.X9c);Array.add(Aa.buttons,C);Array.add(e.Ac,Aa)}};Ze.prototype.mHh=function(e){var C=this.Sa.Nc();xe.EwaSettings.la(483)&&Array.add(C.buttons,this.Sa.Bb(43));this.Db&&this.ag&&this.$.isEditMode&&(0===this.ag.CellType||4===this.ag.CellType)&&Array.add(C.buttons,this.Sa.Bb(136));Array.add(e.Ac,C)};Ze.prototype.AIh=function(e){var C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(100));Array.add(e.Ac,C)};Ze.prototype.RIh=
function(e){var C=2===this.Db.MeasureType&&!this.Db.IsNumeric,J=this.Sa.Wv("ContextMenu.SummarizeValuesBy",null,ue.a.instance.fa(638),-249874296),ja=this.Sa.Nc();Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesBySum",-1255320719,1059,0===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByCount",1746132849,1060,1===this.Db.DataFieldAggregationType));Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByAverage",
-771066011,1061,2===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByMax",835007294,1062,3===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByMin",929115636,1063,4===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByProduct",1935475057,1064,5===this.Db.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.t2f(!0)||C));2!==this.Db.MeasureType&&(Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1065,6===this.Db.DataFieldAggregationType)),Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByStdDeviation",588680636,1066,7===this.Db.DataFieldAggregationType)),Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1067,8===this.Db.DataFieldAggregationType)),Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByVariant",
1668427539,1068,9===this.Db.DataFieldAggregationType)),Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1069,10===this.Db.DataFieldAggregationType)));this.Vc&&this.Vc.Qgc()&&Array.add(ja.buttons,this.ee("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1070,11===this.Db.DataFieldAggregationType));Array.add(J.menu.Ac,ja);Array.add(e.buttons,J)};Ze.prototype.MIh=function(e){var C=this.Sa.Wv("ContextMenu.ShowValuesAs",null,ue.a.instance.fa(639),-1128612833),
J=this.Sa.Nc();Array.add(J.buttons,this.ee("ContextMenu.ShowValuesAsNoCalculation",-841863025,1076,0===this.Db.DataFieldFormatType));Array.add(J.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1083,7===this.Db.DataFieldFormatType));Array.add(J.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1082,6===this.Db.DataFieldFormatType));Array.add(J.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1081,5===this.Db.DataFieldFormatType));
Array.add(J.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1086,9===this.Db.DataFieldFormatType));Array.add(J.buttons,this.ee("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1087,10===this.Db.DataFieldFormatType));if(this.Vc&&this.Vc.qL&&0<this.Vc.qL.length||this.Vc.x$&&0<this.Vc.x$.length){for(var ja=this.Pua("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1088,11===this.Db.DataFieldFormatType),Aa=this.Sa.Nc(),gb=this.QIh(),bc=0;bc<gb.length;bc++){var Mc=
gb[bc];Array.add(Aa.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfParentTotal."+Mc.Caption,-2031744961,1088,11===this.Db.DataFieldFormatType&&this.Db.BaseFieldIndex===Mc.Index,Mc.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Mc.Index))}Array.add(ja.menu.Ac,Aa);Array.add(J.buttons,ja)}Array.add(C.menu.Ac,J);Array.add(e.buttons,C)};Ze.prototype.showPivotTableContextMenu=function(){this.hod=!0;this.expandCollapse=this.lZ=this.refresh=!1;var e=this.$,C=Oe.g(e),J=Af.a(e).pKa();if(J){var ja=
rc.a(e);if(null===ja||void 0===ja?0:ja.xQd)this.hod=Pb.f(e.lg);ja=e.oc;this.lZ=J.supportsBIExplore&&!!Qa.a(e)&&ja.I2(32768);ja.allowInteractivity&&(e=C.wc(null),(null===e||void 0===e?0:e.cell)&&(e.cell.FZc||e.cell.e3f)&&(this.expandCollapse=!0),ja.allowManualDataRefresh&&(this.refresh=!0))}e=null;J=1;this.p0a&&1!==this.p0a.yb?(e=new Sys.UI.Point(this.p0a.clientPoint.x,this.p0a.clientPoint.y),J=this.p0a.yb):(C=Ih.e(C,this.$))&&(e=new Sys.UI.Point(C.x+(this.$.isChromeRtl?0:C.width),C.y+C.height));If.a.dc=
J;this.Yhc=3===J;this.Do(e,!0,J);this.sba=!0;this.TTd()};Ze.prototype.O7h=function(){var e=new hh.a(1114549926,0,this.$.hd,19,null);this.$.Ka.Yb(e)};Ze.prototype.PVh=function(){var e=this;if(this.Vc&&this.Vc.Po){var C=this.Vc.Po.CurrentCol;if(this.Vc.Po.CurrentRow===this.activeCell.FirstRow&&C===this.activeCell.FirstColumn){this.pJb();this.showPivotTableContextMenu();return}}C=new Sf.a(228,0,function(J,ja,Aa){return jg.C(e.$.na.ta,e.activeCell,Jf.b(J,e.YMi),Jf.a(ja,e.XMi),Aa,null)},16);this.$.userOperationManager.ic(C,
null)};Ze.prototype.Eli=function(){if(vg.a.Ld(this.$)){var e=this.$.da.Aa(441);if(e)return e.Yr}else if(e=this.$.da.Aa(346))return e.Yr;return!1};Ze.prototype.nH=function(e,C){return e+"."+C};Ze.prototype.performPivotTableOperation=function(e,C){var J=this,ja=Gg.a.Ra.Lb;if(!this.Vc||!this.Db&&this.ag&&3!==this.ag.CellType)this.ui();else{var Aa=this.Vc.isOlap;Af.a(this.$).Du(Aa,function(gb){gb&&J.$.ic(e,function(bc,Mc,Hc){if(xe.EwaSettings.la(523)){var yd=J.ICc,we=J.activeCell,$e=J.Db?J.Db.Caption:
null,Gf=J.O$a;bc=Jf.b(bc,J.NQi);Mc=Jf.a(Mc,J.MQi);var ag=J.$.na.ta.$b();ag=yd.Na(41,void 0===ag?null:ag);ag.activeCell=we;ag.operationType=C;ag.fieldCaption=$e;ag.prevFieldCaption=Gf;Hc=jg.i(yd,"ExecutePivotTableOperation",ag,bc,Mc,Hc,null,0)}else yd=J.ICc,we=J.activeCell,$e=J.$.na.ta.$b(),$e=yd.Na(41,void 0===$e?null:$e),$e.activeCell=we,$e.operationType=C,Hc=jg.i(yd,"PerformPivotTableOperation",$e,bc,Mc,Hc,null,0);return Hc},ja,0,4,229)})}};Ze.prototype.applyValueFieldSettingsToPivotTable=function(e,
C){var J=this;C=void 0===C?!1:C;var ja=Gg.a.Ra.Lb;this.Vc&&this.Db?(C&&2===this.Db.MeasureType&&Gd.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),C=this.Vc.isOlap,Af.a(this.$).Du(C,function(Aa){Aa&&J.$.ic(e,function(gb,bc,Mc){var Hc=J.ICc,yd=J.activeCell,we=J.Oz;gb=Jf.b(gb,J.DHi);bc=Jf.a(bc,J.CHi);var $e=J.$.na.ta.$b();$e=Hc.Na(41,void 0===$e?null:$e);$e.activeCell=yd;$e.pivotValueFieldSettingsApplyData=we;return jg.i(Hc,"ApplyValueFieldSettingsToPivotTable",
$e,gb,bc,Mc,null,0)},ja,0,4,231)})):this.ui()};Ze.prototype.ee=function(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd){Aa=void 0===Aa?null:Aa;gb=void 0===gb?null:gb;bc=void 0===bc?null:bc;Mc=void 0===Mc?8:Mc;Hc=void 0===Hc?null:Hc;yd=void 0===yd?!1:yd;ja&&(e+=".Checked");yd&&(e+=".Disabled");this.Sa.Vmd(e)&&this.Sa.mId(e);J=Aa||ue.a.instance.fa(J);e=this.Sa.tHa(e,J,C,null,"None",gb,yd,null);e.Bvc(null);bc&&e.mS(bc);ja?e.oS("Image16by16",3,k.a.haa):Hc?e.oS("Image16by16",Mc,Hc):e.T1b();return e};Ze.prototype.Pua=function(e,
C,J,ja,Aa){J=(void 0===Aa?null:Aa)||ue.a.instance.fa(J);this.Sa.Vmd(e)?this.Sa.mId(e):this.Sa.mId(e+".Checked");ja&&(e+=".Checked");this.Fxj&&(J=this.Mhh.parseFromString(J,"text/html").body.innerText);e=this.Sa.y3c(e,null,J,C,3,k.a.haa);e.M$e=ja;!ja&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&e.T1b();return e};Ze.prototype.tai=function(){this.Oz=Object.assign(new Nc,{PivotValueFieldSummarizeValueByApplyData:Object.assign(new uc,{Aggregation:-1}),
PivotValueFieldShowValueAsApplyData:Object.assign(new xd,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};Ze.prototype.GRa=function(e,C){this.Oz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=e;this.Oz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=C;this.Oz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};Ze.prototype.QIh=function(){var e=[];if(this.Vc&&this.Vc.x$&&0<this.Vc.x$.length)for(var C=yl(this.Vc.x$),J=C.next();!J.done;J=
C.next())(J=J.value)&&Array.add(e,J);if(this.Vc&&this.Vc.qL&&0<this.Vc.qL.length)for(C=yl(this.Vc.qL),J=C.next();!J.done;J=C.next())(J=J.value)&&Array.add(e,J);e.sort(function(ja,Aa){return ja.Index-Aa.Index});return e};Ze.prototype.h3f=function(){if(!this.ag||!this.Vc||!this.Vc.qL)return!1;var e=1===this.ag.CellArea||4===this.ag.CellType&&this.ag.IsRowAxis,C=4===this.ag.CellType?0<this.Vc.s5c:0<this.ag.CurrentFieldIndex;return 1<this.Vc.qL.length&&e&&C};Ze.prototype.bKa=function(e){var C=[];3===
e?this.$.isEditMode?Array.addRange(C,[sb.a.LHf,sb.a.NHf,sb.a.GZi]):Array.addRange(C,[sb.a.copy]):2===e&&Array.add(C,sb.a.zxe);return C};Ze.prototype.ui=function(){var e=dh.a.jd(1,0,0,641,0,104573951,"PivotTableContextMenuOperationFailure");xi.a(this.$).ui(e)};Ze.prototype.rzj=function(){return this.Db?0!==this.Db.LabelOrDateFilterType||0!==this.Db.ValueFilterType||this.Db.HasManualFilter:!1};Ze.prototype.ozj=function(e){return 62<=e&&65>=e};Ze.prototype.$ri=function(){if(this.activeCell&&this.Db&&
this.Vc){var e={};e.cell=this.activeCell;e.dataSourceIndex=this.Vc.externalSourceIndex;e.fieldId=this.Db.Index.toString();e.isOlap=this.Vc.isOlap;e.confirmationRequired=this.Vc.confirmationRequiredForDataOps;this.$.ye(492140419,If.a.dc,19,{showPivotFilterDialogCommandData:e})}};Ze.prototype.HYg=function(e){var C=this;this.activeCell&&this.Db&&this.Vc&&this.$.userOperationManager.ic(new Sf.a(153,0,function(J,ja,Aa){return jg.X(C.$.na.ta,C.activeCell,C.Vc.externalSourceIndex,C.Db.Index.toString(),e,
J,ja,Aa,null,null)}),null)};Ze.prototype.DKg=function(e){var C=this;!(30>e||61<e)&&this.activeCell&&this.Db&&this.Vc&&this.$.userOperationManager.ic(new Sf.a(152,0,function(J,ja,Aa){return jg.g(C.$.na.ta,C.activeCell,C.Vc.externalSourceIndex,C.Db.Index.toString(),e,J,ja,Aa,null,null)}),null)};Ze.prototype.applyPivotSort=function(e){var C=this;if(this.Vc&&this.Db&&this.activeCell&&this.ag){var J=1===this.ag.CellArea||2===this.ag.CellArea;8===this.ag.CellArea?Hh.a(this.$.userOperationManager,function(ja,
Aa,gb){return jg.e(C.$.na.ta,C.activeCell,e,C.Db.Caption,ja,Aa,gb,null)},function(ja){return new Sf.a(1015,0,ja,void 0,null)},null):J&&(J=1===this.ag.CellArea?1:2,this.$.la(724)?Eh.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Vc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,this.Vc.isOlap?"":this.Db.Caption,J,1===e):Eh.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Vc.externalSourceIndex,this.Db.Index.toString(),
1===e))}};Ze.prototype.qS=function(){return!this.Vc||!this.Vc.isActionable&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadOnlyPivotTable",!1)};Ze.prototype.Vxj=function(){return(this.ag||this.Vc)&&4!==this.ag.CellType&&(0!==this.ag.CellType||8!==this.ag.CellArea||this.Vc.x$&&this.Vc.x$.length||this.Vc.qL&&this.Vc.qL.length)?!1:!0};Ze.prototype.Wxj=function(){return this.ag&&this.Vc&&(1===this.ag.CellArea||2===this.ag.CellArea)&&this.Vc.bOb&&this.Vc.bOb.length?!1:!0};Qk.Object.defineProperties(Ze.prototype,
{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.PMf}}});Object(Md.a)(Ze,"PivotTableContextMenu",og.a,[]);Rd.prototype.compare=function(e,C){return(e||"").localeCompare(C||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(Md.a)(Rd,"DigitsAsNumberComparer",null,[532]);var Hd=b(256),fe=Ca.a.C2g,tf=og.a;vm(Mf,tf);Mf.prototype.executeCommand=function(e,C,J){e=C.command;switch(e){case 639960842:this.applyTableFieldList(J);
this.dO.uda();break;case -1085236154:J=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.vyd);Gd.ULS.sendTraceTag(537166999,0,50,J);this.dO.uda();break;case 1833782813:this.dO.showCallout();break;default:return Ag.a(e)}return Tf.Task.Ta(!0)};Mf.prototype.applyTableFieldList=function(e){var C=e.MenuItemId.toString();xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(C=C.replace("'","''"),C=C.replace("[",
"'["),C=C.replace("]","']"));var J=Object(X.a)(String,e.SourceControlId),ja={};ja.PulloutField=C;ja.PulloutCardPath=e.SourceCardKeyPath;ja.PulloutCardSourceRow=e.SourceCardRow;ja.PulloutCardSourceColumn=e.SourceCardColumn;if(this.dO.pN){Gd.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");ja.ParameterType=2;e=e.ColumnIndex;if(void 0===e||null===e){if(void 0===J||null===J){Gd.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}e=0<=this.dO.TKf?this.dO.TKf:parseInt(J.substring(20+C.length+1,J.length),10);if(isNaN(e)){C=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",J);Gd.ULS.shipAssertTag(537166997,0,!1,C);return}}ja.PulloutRichColumnSourceIndex=e;if(this.GUb.gIg){this.WIg(C,ja);return}}else Gd.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),ja.ParameterType=4,J=this.dO.selectedRange.right,void 0!==ja.PulloutCardSourceColumn&&null!==ja.PulloutCardSourceColumn&&
(J=ja.PulloutCardSourceColumn+1),ja.PulloutRichColumnSourceIndex=J;this.qOd(C,ja)};Mf.prototype.qOd=function(e,C,J){J=void 0===J?0:J;var ja=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.vyd,C.PulloutRichColumnSourceIndex);Gd.ULS.sendTraceTag(537166996,0,50,ja);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",C.ParameterType,C.PulloutRichColumnSourceIndex);
e=Object.assign(new Hd.a,{Text:e});this.grid.setCell(e,this.dO.fya,0,127,C,J);this.grid.focus();this.N4b=null;this.dO.uda();this.dO.Hhj()};Mf.prototype.Kc=function(e,C,J){if(e=this.$.isEditMode&&xe.EwaSettings.la(136)&&!!this.dO)switch(C.command){case -1085236154:break;case 639960842:e=!!J;break;case 1833782813:e=this.dO.uwa&&this.dO.HAb;break;default:e=!1}return e};Mf.prototype.BO=function(e,C,J){this.$.isEditMode&&(this.N4b=this.fIh(Object(X.a)(487,J)),tf.prototype.BO.call(this,e,C,null,null,!1))};
Mf.prototype.VY=function(){return this.N4b};Mf.prototype.w3c=function(e){if(!this.dO||!e||!e.Dk)return Gd.ULS.shipAssertTag(537166994,0,!!this.dO,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),Gd.ULS.shipAssertTag(537166993,0,!!e,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),e&&Gd.ULS.shipAssertTag(537166992,0,!!e.Dk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var C=new va.a;e=
yl(e.Dk);for(var J=e.next();!J.done;J=e.next()){var ja=J.value;J=new va.a;J.add(ja.ColumnName);J.add(ja.ColumnIndex.toString());var Aa=new va.a,gb=null;gb=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Rd:new pg;Aa=L.OBc(L.concat(Aa,L.select(L.asEnumerable(ja.FieldInfoDataList),function(bc){return bc.Name})),function(bc){return bc},gb);ja=new va.a;ja.add(L.toArray(L.concat(J,Aa)));C=L.toList(L.concat(C,ja))}return L.toArray(C)};Mf.prototype.fIh=
function(e){var C=this.w3c(e);if(!C||!C.length)return this.N4b=null;var J=this.Sa;e=J.Nc();var ja=1<C.length;this.vyd=C.length;C=yl(C);for(var Aa=C.next();!Aa.done;Aa=C.next()){var gb=Aa.value;ja||(e.title=gb[0]);Aa=J.Nc();for(var bc=2,Mc=gb.length;bc<Mc;++bc)Array.add(ja?Aa.buttons:e.buttons,J.tHa("ApplyTableFieldList."+gb[bc]+"."+gb[1],gb[bc],639960842,null,"None",gb[bc],!1,void 0,!0));ja&&(gb=J.Wv("ApplyTableFieldList."+gb[0],this.menuId,gb[0],798637440),Array.add(gb.menu.Ac,Aa),Array.add(e.buttons,
gb))}J=J.Kp(this.menuId);Array.add(J.Ac,e);return J};Mf.prototype.WIg=function(e,C){var J=this,ja=dh.a.jd(12,1,0,881,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(xe.EwaSettings.nz()){var Aa=new ci.a(this.$,ja);Aa.LP(function(){2===Aa.returnValue&&J.qOd(e,C,8)})}else{var gb=new jh.ErrorDialog(this.$,ja);gb.LP(function(){2===gb.returnValue&&J.qOd(e,C,8)});gb.mf()}};Qk.Object.defineProperties(Mf.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},
pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.RMf}},dO:{configurable:!0,enumerable:!0,get:function(){this.GUb||(this.GUb=this.$.da.Aa(261));return this.GUb}}});Object(Md.a)(Mf,"PulloutFieldListContextMenu",og.a,[]);var hg=Ca.a.TMf,Yf=og.a;vm(Wd,Yf);Wd.prototype.Kc=function(e,C,J){return-1687037502===C.command&&!!J&&this.grid.isEditing};Wd.prototype.executeCommand=function(e,C,J){this.showRichTextFloatie(J);return Tf.Task.Ta(!0)};Wd.prototype.bKa=function(){return[sb.a.fWg]};Wd.prototype.showRichTextFloatie=
function(e){var C=Object(X.a)(na.a,e.eventArgs);C&&(e=this.bKa(C.yb),C=new Sys.UI.Point(C.Ea.clientX,C.Ea.clientY),this.showFloatie(e,new Sys.UI.Bounds(C.x,C.y,0,0),2))};Qk.Object.defineProperties(Wd.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.TMf}}});Object(Md.a)(Wd,"RichTextContextMenu",og.a,[]);var qh=b(94),gi=Ca.a.B2g,Vi=og.a;vm(tg,Vi);tg.prototype.executeCommand=function(e,C,J){if(ad.a(this.$))return Tf.Task.Ta(!0);
this.$.isEditMode&&(e=J[Ca.a.U1f],e=e.x&&e.y?new Sys.UI.Point(e.x+(this.$.isChromeRtl?10:-10),e.y):Bd.DOMElementExtensions.getLocation(J[Ca.a.V1f]),this.Do(e,!1));return Tf.Task.Ta(!0)};tg.prototype.Kc=function(e,C,J){return-1075099431===C.command&&!!J};tg.prototype.VY=function(){var e=this.Sa.Kp(this.menuId),C=this.$.isEditMode;this.uUj();this.SHh(e,C);this.IHh(e);this.KIh(e);return e};tg.prototype.pYb=function(e,C,J,ja){Array.add(e,this.Sa.Bb(C?J:ja))};tg.prototype.SHh=function(e,C){var J=this.Sa,
ja=J.Nc();Array.add(ja.buttons,J.Bb(54));this.pYb(ja.buttons,this.Mhc,127,56);Array.add(ja.buttons,J.Bb(55));C&&this.pYb(ja.buttons,this.Mhc,126,125);Array.add(ja.buttons,J.Bb(158));this.$.ea.dKb&&(C=Object(X.a)(qh.a,this.$.pa))&&kf.q(C)&&this.$.isEditMode&&(Array.add(ja.buttons,J.Bb(277)),C.isLockPausedInSession?Array.add(ja.buttons,J.Bb(279)):C.Nj&&Array.add(ja.buttons,J.Bb(278)));C=J.Wv("ContextMenu.TabColor",null,ue.a.instance.fa(511),1841703919);J=J.s3c(467002767,1549407384,534,-221093529,this.pB);
Array.add(C.menu.Ac,J);Array.add(ja.buttons,C);Array.add(e.Ac,ja)};tg.prototype.IHh=function(e){var C=this.Sa.Nc();this.pYb(C.buttons,this.Mhc,114,112);this.pYb(C.buttons,!this.ngc,115,113);Array.add(e.Ac,C)};tg.prototype.KIh=function(e){if(xe.EwaSettings.la(501)&&!kf.e(this.$.xa.pa)){var C=this.Sa,J=C.Nc();Array.add(J.buttons,C.Bb(263));Array.add(e.Ac,J)}};tg.prototype.uUj=function(){var e=this.$.e3c();var C=e.f3c;e=e.aDe;this.Mhc=1===C;this.ngc=0<e};Qk.Object.defineProperties(tg.prototype,{$t:{configurable:!0,
enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.UMf}}});Object(Md.a)(tg,"SheetOpsContextMenu",og.a,[]);var dk=b(524),de=og.a;vm(eg,de);eg.prototype.Zc=function(e,C){var J=!0;switch(C){case -231711729:J=!1;break;case -1909381757:J=this.Obc();J=!!J&&J.Fii;break;case 1312363469:J=xe.EwaSettings.la(466)}return!J||de.prototype.Zc.call(this,e,C)};eg.prototype.executeCommand=function(e,C,J){if(!this.$.isEditMode)return Pd.TaskExtensions.D4();
e=C.command;C=this.Obc();var ja=null;switch(e){case 2108047455:C&&C.wze();break;case -231711729:Gd.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:C&&C.a2b();break;case 1312363469:this.showSlicerContextMenu(J);break;default:ja=Ag.a(e)}return ja||Pd.TaskExtensions.D4()};eg.prototype.Kc=function(e,C,J){e=!1;switch(C.command){case -231711729:case 2108047455:case -1909381757:e=!0;break;case 1312363469:e=xe.EwaSettings.la(466)&&!!J}return e};eg.prototype.VY=
function(){var e=this.Sa.Kp(this.menuId),C=this.Sa.Nc();Array.add(C.buttons,this.Sa.Bb(252));xe.EwaSettings.la(504)&&Array.add(C.buttons,this.Sa.Bb(253));Array.add(C.buttons,this.Sa.Bb(254));Array.add(e.Ac,C);C=this.Sa.Nc();this.Pni()?Array.add(C.buttons,this.Sa.Bb(266)):Array.add(C.buttons,this.Sa.Bb(267));Array.add(e.Ac,C);return e};eg.prototype.Pni=function(){if(vg.a.Ld(this.$)){var e=this.$.da.Aa(439);if(e)return e.Yr}else if(e=this.$.da.Aa(371))return e.Yr;return!1};eg.prototype.showSlicerContextMenu=
function(e){var C=Object(X.a)(na.a,e.eventArgs);e=this.oac(Object(X.a)(na.a,e.eventArgs));C=C.yb;If.a.dc=C;this.Do(e,!1,C)};eg.prototype.YWe=function(e){var C=this.Sa.Nc(),J=this.Sa.Nc();Array.add(J.buttons,this.Sa.Bb(255));Array.add(J.buttons,this.Sa.Bb(256));var ja=this.Sa.y3c("ContextMenu.SlicerSort",null,ue.a.instance.fa(2115),-814639094,0,k.a.MPe);Array.add(ja.menu.Ac,J);Array.add(C.buttons,ja);Array.add(e.Ac,C)};eg.prototype.Hzj=function(e){return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
e.Ub.className===k.a.E9c||xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===e.yb};eg.prototype.oac=function(e){var C=Oe.g(this.$).ha.Pa.mc,J=e&&1!==e.yb&&e.clientPoint?e.clientPoint:Sys.UI.DomElement.getLocation(C.domElement);if(this.Hzj(e)){var ja=this.Obc();ja&&(e.Ub.className===k.a.E9c&&(J=Lb.HelperMethods.Cub(e.Ea)),1===e.yb&&(J=rf.a(this.$).Jja(Bd.DOMElementExtensions.getLocation(ja.frame))))}else if(e=this.Obc())e=this.dRh(e.frame),(ja=Lb.HelperMethods.XA(this.$.tf,
this.$.domElement,Oe.g(this.$).rtl,!1))?(e.x=rf.a(this.$).Hi(e.x-ja.x)+ja.x,e.y=rf.a(this.$).Hi(e.y-ja.y)+ja.y):Gd.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),J.y+=e.y,J.x+=e.x;e=this.$.domElement;ja=Oe.g(this.$).rtl;C=Lb.HelperMethods.XA(C.Dg.domElement,e,ja);J.y=Math.max(J.y,C.y);J.x=Math.max(J.x,C.x);return J};eg.prototype.Obc=function(){var e=Oe.g(this.$).ha.Pa.mc;Gd.ULS.shipAssertTag(537166988,0,!!e);return dk.a(this.$).FC(e.floatingObject.id)};eg.prototype.dRh=function(e){var C=
new Sys.UI.Point(e.offsetParent.offsetLeft,e.offsetParent.offsetTop),J=Oe.g(this.$);if(!J)return C;var ja=Oe.g(this.$).rtl;C=Lb.HelperMethods.XA(e,this.$.ar.ownerDocument.body,ja);J.SCe(C);C.x=ja?this.$.ar.clientWidth-C.x-e.clientWidth:C.x;e=J.view.Pob;J=ja?-J.pO.eca(e.x):e.x;C.x-=J;C.y-=e.y;return C};Qk.Object.defineProperties(eg.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},pB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.VMf}}});Object(Md.a)(eg,
"SlicerContextMenu",og.a,[]);Object(Md.a)(he,"TimeSlicerRibbonButtonParameter",null,[]);var Te=og.a;vm(rg,Te);rg.prototype.executeCommand=function(e,C,J){e=C.command;switch(e){case 2000085697:e=J.DOMElement;this.Asa=J.ChangeLevelCallback;this.iKa=J.GetLevelLabelCallback;this.L0a=J.CurrentLevel;var ja=J.DomEvent;nh.g(ja);var Aa=J.location;J=J.levelLabelText;this.zKe=Bd.DOMElementExtensions.kz(document.activeElement,"iframe")&&J?J.parentNode:null;J=Sys.UI.DomElement.getBounds(J);J.x=Aa.x;J.y=Aa.y;this.BO(ja,
e,J,C,!0);break;case -649826274:this.Asa(0);break;case 149600865:this.Asa(1);break;case -2012435159:this.Asa(2);break;case -1979934975:this.Asa(3);break;case 1634477200:Bd.DOMElementExtensions.setFocus(this.zKe);break;default:return Ag.a(e)}return Tf.Task.Ta(!0)};rg.prototype.Kc=function(e,C,J){e=!1;switch(C.command){case 2000085697:e=!!J;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:e=!0}return e};rg.prototype.BO=function(e,C,J){e=Sys.UI.DomElement.getBounds(C);
J.x=rf.a(this.$).Hi(J.x);J.y=rf.a(this.$).Hi(J.y);e.x=rf.a(this.$).Hi(e.x);e.y=rf.a(this.$).Hi(e.y);e=new Sys.UI.Point(e.x+J.x,e.y+J.y);this.ATa(e,C);this.showContextMenu(new Sys.UI.Bounds(e.x,e.y-J.height,J.width,J.height))};rg.prototype.VY=function(){for(var e=this.Sa,C=e.Kp(this.menuId),J=e.Nc(),ja=0;3>=ja;ja++){var Aa=this.iKa(ja),gb=rg.xLh(ja);gb=e.x4g(gb.z2g,gb.pp,this.L0a===ja,rg.Cye);gb.label=Aa;gb.mS(Aa);this.L0a===ja?gb.oS("Image16by16",8,rg.Cye):gb.T1b();Array.add(J.buttons,gb)}Array.add(C.Ac,
J);return C};rg.xLh=function(e){var C=null;switch(e){case 0:C=new he(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:C=new he(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:C=new he(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:C=new he(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return C};Qk.Object.defineProperties(rg.prototype,{$t:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},pB:{configurable:!0,enumerable:!0,
get:function(){return Ca.a.YMf}}});rg.VKj=Ca.a.D2g;rg.$Hb="TimeSlicerLevelMenuRootName";rg.Cye=k.a.gaa;Object(Md.a)(rg,"TimeSlicerLevelMenu",og.a,[]);var Pi=b(308),Mj=b(220),Bf=b(3),wj=cf.a;vm(vf,wj);vf.prototype.Pd=function(){var e=this,C=this.$,J=Mj.a.D0a(ih.b(),this.ma,"Task","IRootUser"),ja=Yh.a(C),Aa=null;Aa=function(Mc,Hc){ja.gRf(Aa);J.setResult(Hc.l3b)};ja.doe(Aa);ja.H1e();var gb=Zg.GetServiceTaskFactory.create(C.da,102,C.ma,this.ub),bc=Zg.GetServiceTaskFactory.Wa(C.da,342,338,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([J.task,
gb,bc],this.ma),function(){var Mc=gb.result,Hc=J.task.result,yd=bc.result;e.Gd([new qg(C,Hc,Mc,yd),new bf(C,Hc,Mc,yd),new zf(C,Hc,Mc,yd),new cd(C,Hc,Mc,yd),new bg(C,Hc,Mc,yd),new Lf(C,Hc,Mc,yd),new Bi.GridContextMenu(C,Hc,Mc,yd),new Xf(C,Hc,Mc,yd),new tg(C,Hc,Mc,yd),new rg(C,Hc,Mc,yd),new Mf(C,Hc,Mc,yd),new hf(C,Hc,Mc,yd),new Ze(C,Hc,Mc,yd),new eg(C,Hc,Mc,yd),new Wd(C,Hc,Mc,yd)])},C.ma,3)};vf.initData=function(){var e=Pi.a.u2;e(2000085697,20479,0,0);e(-227942804,Bf.a.Jc|24576,0,0);e(1634477200,Bf.a.Jc|
131072,0,0);e(-649826274,4095,0,0);e(149600865,4095,0,0);e(-2012435159,4095,0,0);e(-1979934975,4095,0,0);e(1247109494,Bf.a.Jc|24576,0,0);e(-2064931494,Bf.a.Jc|131072,0,0);e(-1396319072,Bf.a.Ja,128,0);e(-425234874,Bf.a.Ja,128,0);e(-1253126584,Bf.a.Ja,0,0);e(274207288,Bf.a.Jc|24576,0,0);e(-1497523576,Bf.a.Jc|131072,0,0);e(-498523270,Bf.a.Jc|24576,64,0);e(1640762262,Bf.a.Jc|131072,64,0);e(-2017893763,Bf.a.Jc|24576,0,0);e(1350204367,Bf.a.Jc|131072,0,0);e(-889576107,Bf.a.Sv,128,0);e(-1170196828,Bf.a.Sv,
128,0);e(389774337,Bf.a.Sv,128,0);e(1529312473,Bf.a.Sv,128,0);e(2033235475,Bf.a.Sv,128,0);e(-96230454,Bf.a.Sv,128,0);e(74086617,Bf.a.Sv,128,0);e(563292088,Bf.a.Sv,128,0);e(-1092351914,Bf.a.Sv,128,0);e(-2141589616,Bf.a.Sv|16384,128,0);e(745182485,Bf.a.Sv,0,0);e(359279088,Bf.a.Sv,128,0);e(-67292059,Bf.a.Sv,128,0);e(926905850,Bf.a.Sv,128,0);e(547535945,Bf.a.Sv,128,0);e(1374696078,Bf.a.Jc|24576,0,0);e(495005930,Bf.a.Jc|212992,0,0);e(-1045020714,Bf.a.Jc|24576,0,0);e(-170383950,Bf.a.Jc|212992,0,0);e(324156914,
Bf.a.Ja,0,0);e(-1085236154,Bf.a.Au,0,0);e(-751848458,Bf.a.il|16384,0,0);e(216058793,Bf.a.Au,0,0);e(474690375,Bf.a.il|16384,0,0);e(-1920954846,Bf.a.Jc|24576,0,0);e(723126814,Bf.a.Jc|131072,0,0);e(2108047455,128,128,0);e(-231711729,128,128,0);e(-1909381757,128,128,0);e(-814639094,128,128,0);e(1701016594,Bf.a.Jc|3072,128,0);e(-1475408662,Bf.a.Jc|24576,0,0);e(1114549926,Bf.a.Jc|131072,32,0)};vf.ka=function(e){cf.a.he(10,new vf(e))};Object(Md.a)(vf,"ContextMenuCommandHandlerFactory",cf.a,[]);var Bh=b(214),
Vh=b(1368),dj=b(97),Zh=b(249);mf.prototype.dispose=function(){};mf.prototype.U$=function(){this.Fqb.I3()};mf.prototype.rC=function(){this.Fqb.rC()};mf.prototype.wRd=function(e,C,J){Ih.h(this.$,Ih.b);this.Fqb.showContextMenu(Object.assign(new Vh.a,{x:C.x,y:C.y}),J,e);dj.EventHandlerManager.instance.Sbd()};mf.prototype.pxc=function(e,C,J){Ih.h(this.$,Ih.b);this.Fqb.showFloatie(Object.assign(new Vh.a,{x:C.x,y:C.y}),e,J);Zh.a(function(){dj.EventHandlerManager.instance.Sbd()},this.$.ma)};mf.prototype.vRd=
function(e,C,J,ja){Ih.h(this.$,Ih.b);this.Fqb.vRd(Object.assign(new Vh.a,{x:C.x,y:C.y}),e,J,ja)};Object(Md.a)(mf,"ReactContextMenuController",null,[419,2]);var Wi=Bh.a;vm(jf,Wi);jf.prototype.dispose=function(){this.zaf&&this.$&&this.$.ea.Kq(this.yld);Wi.prototype.dispose.call(this)};jf.prototype.create=function(){this.$.ea.Sh?(Gd.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.Sh),this.yld(null,null)):(this.zaf=!0,
this.$.ea.Tm(this.yld))};jf.ka=function(e){e.da.Ha(338,new jf(e))};Object(Md.a)(jf,"ContextMenuControllerFactory",Bh.a,[]);var Tj=b(158);Object(Md.a)(ie,"RibbonCommandParams",null,[]);Object(Md.a)(ze,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);Jd.prototype.ILh=function(e){return(e=this.jdc[e.toString()])?e.menuModel:null};Jd.prototype.oTg=function(e,C){this.jdc[C.toString()]=Object.assign(new ze,{menuModel:e,BFe:Lb.HelperMethods.lc()})};Jd.prototype.W6b=function(e){this.jdc[e.toString()]=null};
Jd.prototype.S_h=function(e){return(e=this.jdc[e.toString()])?e.BFe:-1};Object(Md.a)(Jd,"FilterMenuCache",null,[]);var Ue=b(12),qi=b(206),ej=b(275);Object(Md.a)(Dd,"AutoFilterEventRegistrationArgs",null,[]);var Yg=b(24);Qc.prototype.dispose=function(){window.cancelAnimationFrame(this.IAb);this.gridView&&this.gridView.vsc(this.qDb);this.gridView=null};Qc.prototype.B$h=function(){if(this.NQd=Lb.HelperMethods.C6a)this.yZa=[];this.qCg();this.gridView.MYb(this.qDb)};Qc.prototype.qCg=function(){for(var e=
yl(this.gridView.mn),C=e.next();!C.done;C=e.next()){C=C.value.LBa;for(var J in C){var ja=C[J];this.sLf(ja.domElement,ja.hashCode)}}};Qc.prototype.sLf=function(e,C){if(Oe.g(this.$).Ca.Kl.t1a(C))if(e){e=e.querySelectorAll('[id^="'+Ca.a.Fad+'"]');for(var J=0;J<e.length;J++){var ja=e[J],Aa=ja.getAttribute(Ca.a.bCh),gb=ja.getAttribute(Ca.a.VBh);Gd.ULS.shipAssertTag(537167053,0,!!Aa&&!!gb,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",
ja.id,C);Aa=Yg.Range.ld(parseInt(Aa,10),parseInt(gb,10));ja=Object.assign(new Dd,{cell:Aa,nte:ja,Yd:C});this.NQd?(this.yZa.push(ja),this.IAb||(this.SMe=window.performance.now(),this.IAb=window.requestAnimationFrame(this.ROf))):this.tme(ja)}}else Gd.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",C);else Gd.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",
C)};Qc.prototype.tme=function(e){var C=this.gridView.Ca.R3a(e.cell,e.Yd);C?this.pCg(e.nte,C):Gd.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",e.Yd,e.cell)};Qc.prototype.pCg=function(e,C){C.hasAutoFilter?this.sAg(e,C.Dad):C.N4?this.nCg(e,C.Dad,C.vgf):Gd.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
Tj.a.instance.qa(Ue.a.Hf,e,this.onPointerDown);qi.a.instance.qa(Ue.a.$xa,e,this.onPointerDown)};Qc.prototype.sAg=function(e,C){ej.a.instance.qa(Ue.a.click,e,function(J){C&&Eh.a.hrc(J.Ea.rawEvent,966232027,C,null);return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5465680_FixForAutoFilterClickHandlers")?!0:!1})};Qc.prototype.nCg=function(e,C,J){var ja=Nd.a.oi(C);ej.a.instance.qa(Ue.a.click,e,function(Aa){J?Eh.a.spf(document.getElementById(ja.EwaElementId),ja.Cell,ja.DataSourceIndex,ja.FieldId,ja.IsOlap,
ja.RequiresConfirmation,Aa.Ea.rawEvent,ja.OptionalPivotMenuAnchor):Eh.a.spfm(Aa.Ea.rawEvent,ja.RequiresConfirmation,ja.Cell,ja.DataSourceIndex,ja.PivotName,ja.OptionalPivotMenuAnchor);return!1})};Object(Md.a)(Qc,"FilterMenuPointerEventsManager",null,[2]);ec.prototype.dispose=function(){xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.GTe.dispose();this.$=null};ec.prototype.PRh=function(e){var C=
Oe.g(this.$).Ca.f$(e,this.$.activeItemName);return C&&C.blockPresentInViewportTimeStamp>this.w8a.S_h(e.left)?C.Us(e).autoFilterMenu:this.w8a.ILh(e.left)};ec.prototype.PNi=function(e,C,J){this.w8a&&this.w8a.oTg(e.menuModel[C],J)};ec.prototype.QNi=function(e){this.w8a&&this.w8a.W6b(e)};Object(Md.a)(ec,"FilterMenuManager",null,[418,2]);var Ug=b(222),sh=b(173);Pf.prototype.Sdd=function(e){return Ng.a.Hc(this.Oxc,e)};Pf.prototype.dispose=function(){this.Nd?Gd.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):
(this.Nd=!0,this.$&&(this.$.ol(Pf.ud),this.$.da.JU(8),this.ha&&this.ha.psc(this.Zk),this.$.Ka.Yab(this.Fwf),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.mQa(this.F_),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.W6(this.j6)),this.$=this.ha=null,this.m9b.dispose(),this.Oxc=this.v6d=null)};Pf.prototype.showContextMenu=function(e,C,J){C=void 0===C?null:C;J=void 0===
J?null:J;this.nzj(e)&&(Ih.h(this.$,Ih.i),e=this.H5g(e,C,J),this.$.Ka.Yb(e.de,e.dictionary))};Pf.prototype.I3=function(){this.contextMenuController?this.contextMenuController.U$():Gd.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};Pf.prototype.nzj=function(e){return xi.a(this.$).Cq()?(Gd.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
xi.a(this.$).a0(sh.a.grid,Ug.a.showContextMenu),!1):!this.$.Ka.zzh&&(!e||e.Ub!==Oe.g(this.$).domElement&&!E.a.equals(e.Ub.tagName,"INPUT",!0))};Pf.prototype.H5g=function(e,C,J){C=void 0===C?null:C;var ja={};J=(ja.eventArgs=e,ja.creationParams=void 0===J?null:J,ja);e=e?e.yb:-1;ja=this.ha.Pa.mc;var Aa=1441131127;ja?(C=ja.floatingObject,Gd.ULS.shipAssertTag(537167059,0,!!C,"floatingObj shouldn't be null."),Pf.Kqd(C)?Aa=1312363469:Pf.isPivotChart(C)?(J[bf.M_c]=C?C.Yc:null,Aa=-149612405):Aa=-1372040782):
Pf.ugf(C)?(J[bf.M_c]=C,Aa=-149612405):!Ih.g(this.$)&&Ih.f(Oe.g(this.$))&&(Aa=671488277);C=new hh.a(Aa,e,this.$.hd,30,null);return Object.assign(new ie,{de:C,dictionary:J})};Pf.ka=function(e){e.Pk(Pf.ud)};Pf.isPivotChart=function(e){return!!e&&0===e.type&&Pf.ugf(e.Yc)};Pf.Kqd=function(e){return!!e&&2===e.type};Pf.ugf=function(e){return!!e&&!!(e.Attributes&4)};Qk.Object.defineProperties(Pf.prototype,{m9b:{configurable:!0,enumerable:!0,get:function(){return this.v6d}}});Pf.E2g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Pf.C2h="GridContextMenu";Pf.ud=function(e){(e=Object(X.a)(8,e))&&Zg.GetServiceTaskFactory.create(e.da,9,e.ma,0)};Object(Md.a)(Pf,"ContextMenuManager",null,[395,2]);var xj=Bh.a;vm(yf,xj);yf.prototype.create=function(){var e=this,C=this.$,J=C.oc;if(J.allowSelection||J.allowEdits||J.allowFiltering||J.allowSorting||J.allowPivotSpecificOperations){var ja=Zg.GetServiceTaskFactory.create(C.da,10,C.ma,this.ub),Aa=Zg.GetServiceTaskFactory.Wa(C.da,342,338,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([ja,
Aa],this.ma),function(){e.Gb(ua.a(C)||new Pf(C,ja.result,Aa.result))},this.$.ma,3)}else Gd.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),C.da.JU(8),this.Gb(null)};yf.ka=function(e){e.da.Ha(9,new yf(e))};Object(Md.a)(yf,"ContextMenuManagerFactory",Bh.a,[]);ce.prototype.isEqual=function(e){return e?this.k5===e.k5&&this.l5===e.l5&&this.XN===e.XN&&this.YN===e.YN&&this.sB===e.sB&&this.ruleType===e.ruleType&&
this.RZ===e.RZ&&this.XT===e.XT&&this.WT===e.WT&&this.EV===e.EV&&this.eF===e.eF&&this.v5===e.v5&&this.w5===e.w5:(Gd.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(Md.a)(ce,"DataValidationEditDialogState",null,[]);Tc.prototype.Zc=function(){return!1};Tc.prototype.executeCommand=function(e,C){-1728432249!==C.command&&Ag.a(C.command);this.selectedRanges=ud.r(Oe.g(this.$).ha.va.selectedRanges,this.$);Oe.g(this.$).I0(!0);this.getDataValidationInitialState();
this.gh=this.$.Wb.Ic("UserAction","DataValidationEditTimeToDialogOpen");this.jKe?Gd.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(Gd.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.jKe=!0);return Tf.Task.Ta(!0)};Tc.prototype.Kc=function(e,C){return-1728432249===C.command};Tc.prototype.gd=function(){return!1};Tc.prototype.getDataValidationInitialState=function(){var e=this,C=this.$.na.ta.$b();Hh.a(this.$.userOperationManager,
function(J,ja,Aa){return jg.u(e.$.na.ta,e.selectedRanges,Jf.b(J,e.eMi),Jf.a(ja),Aa,C)},function(J){return new Sf.a(120,0,J,16)},null)};Tc.prototype.o1i=function(){var e=this.CB={};switch(this.W0a.Command){case 0:var C="CreateNew";break;case 1:C="CreateNewFromRule";break;case 2:C="ExpandExisitng";break;case 3:C="OverrideExisitng";break;default:C="Unknown"}e.a=C;this.gh&&(this.gh.stop(),this.CB.r=this.gh.id);switch(this.W0a.Command){case 0:this.CB.b=!1;this.CB.c="None";this.uHa(new ce);break;case 1:this.CB.b=
!1;this.CB.c="None";this.uHa(new ce(this.W0a));break;case 2:this.CB.b=!0;this.v5c.G4g(this.$,this.Gzh);break;case 3:this.CB.b=!0;this.v5c.I4g(this.$,this.rXi);break;default:Gd.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};Tc.prototype.uHa=function(e){this.v5c.uHa(this.$,this.selectedRanges,e,this.W0a.Command);this.lxi(e)};Tc.prototype.lxi=function(e){Tc.Nrb(e,this.CB);this.CB.d=!0;ih.b().Qe(48,this.CB,!0)};Tc.prototype.Anf=function(){this.CB.d=
!1;ih.b().Qe(48,this.CB,!0)};Tc.prototype.OW=function(e,C){var J={};e=(J.ButtonType=Tc.tia(C),J.DialogName=e,J.Location="dialog",J.NumberOfSelectedRanges=Oe.g(this.$).ha.va.TK,J);ng.b(this.$).fe(sf.a.R5b,e)};Tc.Nrb=function(e,C){C.e=ye(e.ruleType);C.f=Kf(e.sB);C.g=!!e.XN;C.h=!!e.YN;C.i=e.k5;C.j=e.l5;C.k=e.w5;C.l=!!e.eF;C.m=!!e.EV;C.n=e.v5;C.o=e.RZ;C.p=!!e.XT;C.q=!!e.WT};Tc.tia=function(e){switch(e){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return Gd.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(Md.a)(Tc,"DataValidationEditCommandHandler",null,[239]);var fj=b(972),Uj;(function(e){e[e.between=0]="between";e[e.notBetween=1]="notBetween";e[e.equal=2]="equal";e[e.notEqual=3]="notEqual";e[e.greaterThan=4]="greaterThan";e[e.lessThan=5]="lessThan";e[e.greaterThanOrEqual=6]="greaterThanOrEqual";e[e.lessThanOrEqual=7]="lessThanOrEqual"})(Uj||(Uj={}));Object(Md.b)("DataValidationRuleConditionType",
Uj);var Qj;(function(e){e[e.anyValue=0]="anyValue";e[e.wholeNumber=1]="wholeNumber";e[e.decimal=2]="decimal";e[e.list=3]="list";e[e.date=4]="date";e[e.time=5]="time";e[e.textLength=6]="textLength";e[e.custom=7]="custom"})(Qj||(Qj={}));Object(Md.b)("DataValidationRuleType",Qj);var dg=b(140),ui=b(157);Qk.Object.defineProperties(Uc,{eg:{configurable:!0,enumerable:!0,get:function(){return dg.a.Bn(Uc.Uj,"")}},Leh:{configurable:!0,enumerable:!0,get:function(){return dg.a.Bn(Uc.Peh,ui.a.fa(1625),ui.a.fa(1640),
ui.a.fa(1641),ui.a.fa(1642),ui.a.fa(1643),ui.a.fa(1644),ui.a.fa(1645),ui.a.fa(1646),ui.a.fa(1647),ui.a.fa(1626),ui.a.fa(1650),ui.a.fa(1651),ui.a.fa(1652),ui.a.fa(1653),ui.a.fa(1654),ui.a.fa(1655),ui.a.fa(1656),ui.a.fa(1657),ui.a.fa(1627),ui.a.fa(1628),ui.a.fa(1648),ui.a.fa(1649),ui.a.fa(1639),"255")}},Seh:{configurable:!0,enumerable:!0,get:function(){return dg.a.Bn(Uc.Qeh,ui.a.fa(1662),ui.a.fa(1666),ui.a.fa(1667),"255","32")}},Weh:{configurable:!0,enumerable:!0,get:function(){return dg.a.Bn(Uc.Reh,
ui.a.fa(1661),ui.a.fa(1664),ui.a.fa(1663),ui.a.fa(1665),ui.a.fa(1666),ui.a.fa(1667),"255","32")}}});Uc.w9f=255;Uc.Uj="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";Uc.Peh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
Uc.Qeh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
Uc.Reh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(Md.a)(Uc,"DataValidationEditDialogHtml",null,[]);var vh=b(576),Ci=Ah.a;vm(Cc,Ci);Cc.prototype.qAa=function(e){this.YT.selectedIndex=e.ruleType;this.WK.selectedIndex=e.sB;this.iec.checked=e.l5;this.gwa.checked=e.k5;this.Mya.value=e.XN;this.Nya.value=e.YN;this.qca(null)};Cc.prototype.gpb=function(e){e.k5=this.gwa.checked;e.l5=this.iec.checked;e.sB=this.WK.selectedIndex;e.ruleType=this.YT.selectedIndex;e.XN=this.Mya.value;e.YN=this.Nya.value};Cc.prototype.dispose=function(){this.tn();this.vk=
this.lCd=this.Eoc=this.ZOa=this.c$a=this.rNa=this.r5a=this.iec=this.Nya=this.Mya=this.WK=this.YT=this.gwa=null;Ci.prototype.dispose.call(this)};Cc.prototype.render=function(e){e.appendChild(this.domElement)};Cc.prototype.Tja=function(){return this.isVisible};Cc.prototype.Cna=function(e){return this.isVisible=e};Cc.prototype.setFocus=function(){};Cc.prototype.Uub=function(e,C){return this.D1e(e,C,this.GDh)};Cc.prototype.Jgd=function(e,C){return 0!==C&&1!==C?"":this.D1e(e,C,this.Smj)};Cc.prototype.nka=
function(){this.domElement.innerHTML=Uc.Leh;this.gwa=Bd.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.YT=Bd.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.WK=Bd.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Mya=Bd.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Nya=Bd.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Eoc=Bd.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.lCd=Bd.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.r5a=Bd.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.rNa=Bd.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.c$a=Bd.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.ZOa=Bd.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.iec=Bd.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.al()};Cc.prototype.D1e=function(e,C,J){return J.length<e||J[e].length<C?(Gd.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",e,C),""):this.uR.oa(J[e][C])};Cc.prototype.al=function(){vh.a.instance.qa(Ue.a.Tb,this.YT,this.cnc);vh.a.instance.qa(Ue.a.Tb,this.WK,this.cnc);vh.a.instance.qa(Ue.a.change,this.YT,this.qca);vh.a.instance.qa(Ue.a.change,this.WK,this.qca);vh.a.instance.qa(Ue.a.change,
this.WK,this.vk);vh.a.instance.qa(Ue.a.change,this.YT,this.vk);vh.a.instance.qa(Ue.a.change,this.Mya,this.vk);vh.a.instance.qa(Ue.a.Tb,this.Mya,this.vk);vh.a.instance.qa(Ue.a.change,this.Nya,this.vk);vh.a.instance.qa(Ue.a.Tb,this.Nya,this.vk)};Cc.prototype.tn=function(){vh.a.instance.za(Ue.a.Tb,this.YT,this.cnc);vh.a.instance.za(Ue.a.Tb,this.WK,this.cnc);vh.a.instance.za(Ue.a.change,this.YT,this.qca);vh.a.instance.za(Ue.a.change,this.WK,this.qca);vh.a.instance.za(Ue.a.change,this.WK,this.vk);vh.a.instance.za(Ue.a.change,
this.YT,this.vk);vh.a.instance.za(Ue.a.change,this.Mya,this.vk);vh.a.instance.za(Ue.a.Tb,this.Mya,this.vk);vh.a.instance.za(Ue.a.change,this.Nya,this.vk);vh.a.instance.za(Ue.a.Tb,this.Nya,this.vk)};Cc.pja=function(){var e;return e=new va.a,e.add("operatorInputId1"),e.add("operatorInputId2"),e};Qk.Object.defineProperties(Cc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ue.a.instance.fa(1658)}},a1g:{configurable:!0,enumerable:!0,get:function(){return this.YT.selectedIndex}}});
Object(Md.a)(Cc,"DataValidationEditConditionsControl",Ah.a,[459,2,462]);var Zi=b(193),rk=fj.a;vm(ob,rk);ob.prototype.iSd=function(){var e={};e=(e.RuleType=this.Fd.ruleType,e.RuleOperatorType=this.Fd.sB,e.OperatorInput1=this.Fd.XN,e.OperatorInput2=this.Fd.YN,e.IsIgnoreBlank=this.Fd.k5,e.IsInCellDropDown=this.Fd.l5,e.IsAlertBlocking=this.Fd.RZ,e.AlertTitle=this.Fd.XT,e.AlertMessage=this.Fd.WT,e.InputTitle=this.Fd.eF,e.InputMessage=this.Fd.EV,e.IsShowErrorAlert=this.Fd.v5,e.IsShowInputMessage=this.Fd.w5,
e);this.Gc(2,ue.a.instance.fa(1624));var C={};e=(C[ob.Zy]=this.Bc,C.validateDialogValues=this.xWj,C.RangePickerController=Oe.g(this.$).Gh.Ebc(),C.isModal=!1,C.bodyProps=e,C);this.initializeAndShow(ue.a.instance.fa(1623),this.u5c,e);Gd.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};ob.prototype.dispose=function(){this.disposed||(rk.prototype.dispose.call(this),this.disposed=!0)};ob.prototype.pja=function(){return Cc.pja()};ob.prototype.lOh=function(e,C){var J=this;return function(ja,
Aa,gb){var bc=e.na.ta.$b();return Ic(J.$.na.ta,J.selectedRanges,J.mRg(),J.y_a(ja,J.Jzd(C)),Jf.a(Aa),gb,bc)}};ob.prototype.Jzd=function(e){var C=this;return function(J){Gd.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var ja;xh.a(J)?(Gd.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",J?dh.a.Uc(J.Errors):null),J.Errors&&1===J.Errors.length&&((ja=C.bed(J.Errors[0].MessageId))?
C.ola("OkInvalidByServer",J.Errors[0].MessageIdName):(C.ola("OkValid","None"),C.hide()),e(ja)),Gd.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",dh.a.Uc(J.Errors))):C.hide()}};ob.prototype.mRg=function(){var e={};e.Command=this.command;e.RuleType=this.Fd.ruleType;e.ConditionType=this.Fd.sB;e.IsIgnoreBlank=this.Fd.k5;e.IsInCellDropDown=this.Fd.l5;e.LowerBoundary=this.Fd.XN;e.UpperBoundary=this.Fd.YN;e.IsAlertBlocking=
this.Fd.RZ;e.IsShowErrorAlert=this.Fd.v5;e.IsShowInputMessage=this.Fd.w5;e.AlertTitle=this.Fd.XT;e.AlertMessage=this.Fd.WT;e.InputTitle=this.Fd.eF;e.InputMessage=this.Fd.EV;e.ShouldIgnoreFormulaError=this.RMa;return e};ob.prototype.bed=function(e){switch(e){case 1173235830:return ue.a.instance.fa(1673);case 43935303:return ue.a.instance.fa(1674);case -1323438439:return ue.a.instance.fa(1676);case 2112020473:return ue.a.instance.fa(1670);case -219503282:return ue.a.instance.fa(1671);case 1689335445:return ue.a.instance.fa(1672);
case 2146493810:return ue.a.instance.fa(1675);case -2104909922:return String.format(ue.a.instance.Cb(104),this.utb,this.SMd);case -869372599:return String.format(ue.a.instance.Cb(103),this.utb);case -1181828368:return ue.a.instance.fa(1678);case -758480861:return ue.a.instance.fa(1679);case -13729088:return ue.a.instance.fa(1680);case -846654055:return ue.a.instance.fa(1681);case 751854001:return ue.a.instance.fa(1682);case -453846397:return ue.a.instance.fa(1683);case 1102013489:return ue.a.instance.fa(1684);
case 835813260:return ue.a.instance.fa(1685);case 1577787509:return ue.a.instance.fa(1686);case 2083564019:return ue.a.instance.fa(1677);default:Gd.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",e.toString())}return null};ob.prototype.Ula=function(){this.ola("Cancel","None")};ob.prototype.OW=function(e){Gd.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===e?"Ok":"Cancel");var C={};e=(C.ButtonType=
ob.tia(e),C.DialogName=this.Bc,C.Location="dialog",C.NumberOfSelectedRanges=Oe.g(this.$).ha.va.TK,C);ng.b(this.$).fe(sf.a.R5b,e)};ob.prototype.ola=function(e,C){var J={};ob.Nrb(this.Fd,J);J.o=e;J.p=C;J.n=this.Aka;this.gh&&(this.gh.stop(),J.q=this.gh.id);ih.b().Qe(49,J,!0)};ob.prototype.yac=function(e){this.Fd.ruleType=e.RuleType;this.Fd.sB=e.RuleOperatorType;this.Fd.XN=e.OperatorInput1;this.Fd.YN=e.OperatorInput2;this.Fd.RZ=e.IsAlertBlocking;this.Fd.v5=e.IsShowErrorAlert;this.Fd.XT=e.AlertTitle;this.Fd.WT=
e.AlertMessage;this.Fd.w5=e.IsShowInputMessage;this.Fd.eF=e.InputTitle;this.Fd.EV=e.InputMessage;this.Fd.k5=e.IsIgnoreBlank;this.Fd.l5=e.IsInCellDropDown;this.utb=e.firstOperatorLabel;this.SMd=e.secondOperatorLabel};ob.prototype.ZNb=function(e,C,J){var ja;var Aa=ja=null;if(!e)return J?(ja=String.format(ue.a.instance.Cb(104),this.utb,this.SMd),Aa="DataValidationEditNoMinMaxError"):(ja=String.format(ue.a.instance.Cb(103),this.utb),Aa="DataValidationEditNoValueError"),{returnValue:!1,errorString:ja,
wq:Aa};if(e.length>Uc.w9f)return ja=ue.a.instance.fa(1677),{returnValue:!1,errorString:ja,wq:Aa};if(Zi.d(e))return{returnValue:!0,errorString:ja,wq:Aa};if(1===C||2===C||6===C){if(!E.a.p5(e))return ja=ue.a.instance.fa(1670),{returnValue:!1,errorString:ja,wq:Aa};if(1===C&&!E.a.isInteger(e))return ja=ue.a.instance.fa(1671),{returnValue:!1,errorString:ja,wq:Aa};if(6===C){if(!E.a.isInteger(e))return ja=ue.a.instance.fa(1671),{returnValue:!1,errorString:ja,wq:Aa};if(0>parseInt(e,10))return ja=ue.a.instance.fa(1672),
{returnValue:!1,errorString:ja,wq:Aa}}}return{returnValue:!0,errorString:ja,wq:Aa}};ob.prototype.oZd=function(){var e=this,C;var J=C=null;var ja=this.Fd.XN,Aa=this.Fd.YN,gb=Qj[this.Fd.ruleType],bc=Uj[this.Fd.sB];if(0===gb)return{returnValue:!0,errorString:C,wq:J};var Mc=(0===bc||1===bc)&&3!==gb&&7!==gb;return!function(){var Hc=e.ZNb(ja,gb,Mc);C=Hc.errorString;J=Hc.wq;return Hc}().returnValue||Mc&&!function(){var Hc=e.ZNb(Aa,gb,Mc);C=Hc.errorString;J=Hc.wq;return Hc}().returnValue?{returnValue:!1,
errorString:C,wq:J}:Mc&&(1===gb||2===gb||6===gb)&&!Zi.d(ja)&&!Zi.d(Aa)&&parseFloat(ja)>parseFloat(Aa)?(C=ue.a.instance.fa(1675),J="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:C,wq:J}):{returnValue:!0,errorString:C,wq:J}};ob.tia=function(e){switch(e){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Gd.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};ob.Nrb=function(e,C){C.a=ye(e.ruleType);
C.b=Kf(e.sB);C.c=!!e.XN;C.d=!!e.YN;C.e=e.k5;C.f=e.l5;C.g=e.w5;C.h=!!e.eF;C.i=!!e.EV;C.j=e.v5;C.k=e.RZ;C.l=!!e.XT;C.m=!!e.WT};Qk.Object.defineProperties(ob.prototype,{Fd:{configurable:!0,enumerable:!0,get:function(){return this.jRb}},Bc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},o1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Fd.ruleType}}});Object(Md.a)(ob,"DataValidationEditDialog",fj.a,[]);var ik=b(304);Xe.Bbh="DataValidationDialogPanel";Xe.Abh=
"DataValidationButtonPanel";Xe.zbh="DataValidationButtonClearAll";Object(Md.a)(Xe,"CssClassNames",null,[]);var mk=Ah.a;vm(Ce,mk);Ce.prototype.render=function(e){e.appendChild(this.domElement)};Ce.prototype.Tja=function(){return this.isVisible};Ce.prototype.Cna=function(e){return this.isVisible=e};Ce.prototype.setFocus=function(){};Ce.prototype.dispose=function(){this.tn();this.vk=this.gba=this.fba=this.ibf=this.eba=null;mk.prototype.dispose.call(this)};Ce.prototype.nka=function(){this.domElement.innerHTML=
Uc.Seh;this.eba=Bd.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.ibf=Bd.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.gba=Bd.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.fba=Bd.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.eba.checked=!0;this.al();this.enc(null)};Ce.prototype.qAa=function(e){this.gba.value=void 0===e.eF||null===e.eF?"":e.eF;this.fba.value=void 0===
e.EV||null===e.EV?"":e.EV;this.eba.checked=e.w5;this.enc(null)};Ce.prototype.gpb=function(e){e.eF=this.gba.value;e.EV=this.fba.value;e.w5=this.eba.checked};Ce.prototype.al=function(){vh.a.instance.qa(Ue.a.change,this.eba,this.enc);vh.a.instance.qa(Ue.a.change,this.eba,this.vk);vh.a.instance.qa(Ue.a.change,this.gba,this.vk);vh.a.instance.qa(Ue.a.Tb,this.gba,this.vk);vh.a.instance.qa(Ue.a.change,this.fba,this.vk);vh.a.instance.qa(Ue.a.Tb,this.fba,this.vk)};Ce.prototype.tn=function(){vh.a.instance.za(Ue.a.change,
this.eba,this.enc);vh.a.instance.za(Ue.a.change,this.eba,this.vk);vh.a.instance.za(Ue.a.change,this.gba,this.vk);vh.a.instance.za(Ue.a.Tb,this.gba,this.vk);vh.a.instance.za(Ue.a.change,this.fba,this.vk);vh.a.instance.za(Ue.a.Tb,this.fba,this.vk)};Qk.Object.defineProperties(Ce.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ue.a.instance.fa(1660)}}});Object(Md.a)(Ce,"DataValidationEditInputControl",Ah.a,[459,2,460]);var lj=Ah.a;vm(Be,lj);Be.prototype.render=function(e){e.appendChild(this.domElement)};
Be.prototype.Tja=function(){return this.isVisible};Be.prototype.Cna=function(e){return this.isVisible=e};Be.prototype.setFocus=function(){};Be.prototype.dispose=function(){this.tn();this.vk=this.Q9=this.P9=this.bUa=this.rha=this.O9=null;lj.prototype.dispose.call(this)};Be.prototype.nka=function(){this.domElement.innerHTML=Uc.Weh;this.O9=Bd.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.rha=Bd.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.bUa=
Bd.DOMElementExtensions.getElementById(this.domElement,"warningId");this.Q9=Bd.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.P9=Bd.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.O9.checked=!0;this.rha.checked=!0;this.al();this.dnc(null)};Be.prototype.qAa=function(e){this.rha.checked=e.RZ;this.bUa.checked=!e.RZ;this.Q9.value=void 0===e.XT||null===e.XT?"":e.XT;this.P9.value=void 0===e.WT||null===e.WT?"":e.WT;this.O9.checked=e.v5;this.dnc(null)};
Be.prototype.gpb=function(e){e.XT=this.Q9.value;e.WT=this.P9.value;e.RZ=this.rha.checked;e.v5=this.O9.checked};Be.prototype.al=function(){vh.a.instance.qa(Ue.a.change,this.O9,this.dnc);vh.a.instance.qa(Ue.a.change,this.O9,this.vk);vh.a.instance.qa(Ue.a.change,this.rha,this.vk);vh.a.instance.qa(Ue.a.change,this.bUa,this.vk);vh.a.instance.qa(Ue.a.change,this.Q9,this.vk);vh.a.instance.qa(Ue.a.Tb,this.Q9,this.vk);vh.a.instance.qa(Ue.a.change,this.P9,this.vk);vh.a.instance.qa(Ue.a.Tb,this.P9,this.vk)};
Be.prototype.tn=function(){vh.a.instance.za(Ue.a.change,this.O9,this.dnc);vh.a.instance.za(Ue.a.change,this.O9,this.vk);vh.a.instance.qa(Ue.a.change,this.rha,this.vk);vh.a.instance.qa(Ue.a.change,this.bUa,this.vk);vh.a.instance.za(Ue.a.change,this.Q9,this.vk);vh.a.instance.za(Ue.a.Tb,this.Q9,this.vk);vh.a.instance.za(Ue.a.change,this.P9,this.vk);vh.a.instance.za(Ue.a.Tb,this.P9,this.vk)};Qk.Object.defineProperties(Be.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ue.a.instance.fa(1659)}}});
Object(Md.a)(Be,"DataValidationEditMessagesControl",Ah.a,[459,2,461]);pc.prototype.q3a=function(){return this.cellRange};Object(Md.a)(pc,"MacroRecorderRangeDataValidationChangedPayload",null,[106]);var ri=b(63),Zj=ik.a;vm(Yc,Zj);Yc.prototype.iSd=function(){var e={};e=(e.key=this.Fd,e);this.initializeAndShow(ue.a.instance.fa(1623),this.u5c,e);Gd.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};Yc.prototype.dispose=function(){this.disposed||(this.Hec=this.Tkc=this.o3=
null,fg.a.Fa(this.eCb),this.eCb=null,ng.b(this.$)&&ng.b(this.$).ETd("DataValidationDialogCorellation"),Zj.prototype.dispose.call(this),this.disposed=!0)};Yc.prototype.mv=function(e){Zj.prototype.mv.call(this,e);this.Gc(2,ue.a.instance.fa(1624));e=this.gV(2);var C=this.gV(1),J=this.gV(0),ja=C.parentNode;ja.appendChild(e);ja.appendChild(C);ja.appendChild(J);e.parentNode.classList.add(Xe.Abh);e.classList.add(Xe.zbh);e=document.getElementById("dataValidationTabsId");C=new Cc(this.$,document.createElement("div"),
this.qca);J=new Ce(document.createElement("div"),this.qca);ja=new Be(document.createElement("div"),this.qca);this.vci(C,J,ja);var Aa;this.eCb=new xf(e,(Aa=new va.a,Aa.add(C),Aa.add(J),Aa.add(ja),Aa));this.eCb.LRf();this.XU=document.getElementById("validationErrorMessageId");this.qAa();ng.b(this.$)&&ng.b(this.$).qTd("DataValidationDialogCorellation")};Yc.prototype.DO=function(){Zj.prototype.DO.call(this);document.getElementById(this.pi("WACDialogPanel")).classList.add(Xe.Bbh)};Yc.prototype.pja=function(){return Cc.pja()};
Yc.prototype.ned=function(){return"validationErrorMessageId"};Yc.prototype.vci=function(e,C,J){this.o3=e;this.Hec=C;this.Tkc=J};Yc.prototype.aoj=function(){function e(){return new pc(C.selectedRanges,J)}var C=this,J={};J.IsClearAll=this.Aka;J.Command=this.command;J.RuleType=this.Fd.ruleType;J.ConditionType=this.Fd.sB;J.IsIgnoreBlank=this.Fd.k5;J.IsInCellDropDown=this.Fd.l5;J.LowerBoundary=this.Fd.XN;J.UpperBoundary=this.Fd.YN;J.IsAlertBlocking=this.Fd.RZ;J.IsShowErrorAlert=this.Fd.v5;J.IsShowInputMessage=
this.Fd.w5;J.AlertTitle=this.Fd.XT;J.AlertMessage=this.Fd.WT;J.InputTitle=this.Fd.eF;J.InputMessage=this.Fd.EV;J.ShouldIgnoreFormulaError=this.RMa;var ja=this.$.na.ta.$b();Hh.a(this.$.userOperationManager,function(Aa,gb,bc){return Ic(C.$.na.ta,C.selectedRanges,J,Jf.b(Aa,C.Jzd),Jf.a(gb),bc,ja)},function(Aa){return new Sf.a(121,0,Aa,void 0,e)},null)};Yc.prototype.Uzj=function(e){return 1577787509===e};Yc.prototype.fvj=function(e){this.XU.innerText=e;this.Gz(this.gV(0));this.RMa=!0};Yc.prototype.qze=
function(){this.RMa=!1;this.XU.innerText=""};Yc.prototype.bed=function(e){switch(e){case 1173235830:return ue.a.instance.fa(1673);case 43935303:return ue.a.instance.fa(1674);case -1323438439:return ue.a.instance.fa(1676);case 2112020473:return ue.a.instance.fa(1670);case -219503282:return ue.a.instance.fa(1671);case 1689335445:return ue.a.instance.fa(1672);case 2146493810:return ue.a.instance.fa(1675);case -2104909922:return String.format(ue.a.instance.Cb(104),this.o3.Uub(this.Fd.ruleType,this.Fd.sB),
this.o3.Jgd(this.Fd.ruleType,this.Fd.sB));case -869372599:return String.format(ue.a.instance.Cb(103),this.o3.Uub(this.Fd.ruleType,this.Fd.sB));case -1181828368:return ue.a.instance.fa(1678);case -758480861:return ue.a.instance.fa(1679);case -13729088:return ue.a.instance.fa(1680);case -846654055:return ue.a.instance.fa(1681);case 751854001:return ue.a.instance.fa(1682);case -453846397:return ue.a.instance.fa(1683);case 1102013489:return ue.a.instance.fa(1684);case 835813260:return ue.a.instance.fa(1685);
case 1577787509:return ue.a.instance.fa(1686);case 2083564019:return ue.a.instance.fa(1677);default:Gd.ULS.sendTraceTag(537163265,0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",e.toString())}return null};Yc.prototype.G9a=function(){Gd.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.yac();var e=this.oZd();var C=e.errorString;var J=e.wq;if(!e.returnValue)return this.nv(C),this.ola("OkInvalidByClient",
J),!1;this.aoj();return!0};Yc.prototype.Ula=function(){this.yac();this.ola("Cancel","None");this.hide()};Yc.prototype.oya=function(){Gd.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.RMa?this.qze():this.o0c();this.nhj();this.Aka=!0};Yc.prototype.OW=function(e){var C={};e=(C.ButtonType=Yc.tia(e),C.DialogName=this.Bc,C.Location="dialog",C.NumberOfSelectedRanges=Oe.g(this.$).ha.va.TK,C);ng.b(this.$).fe(sf.a.R5b,e)};Yc.prototype.nhj=function(){this.jRb=
new ce;this.qAa()};Yc.prototype.qAa=function(){this.Tkc.qAa(this.Fd);this.Hec.qAa(this.Fd);this.o3.qAa(this.Fd)};Yc.prototype.yac=function(){this.o3.gpb(this.Fd);this.Tkc.gpb(this.Fd);this.Hec.gpb(this.Fd)};Yc.prototype.ola=function(e,C){var J={};Yc.Nrb(this.Fd,J);J.o=e;J.p=C;J.n=this.Aka;this.gh&&(this.gh.stop(),J.q=this.gh.id);ih.b().Qe(49,J,!0)};Yc.prototype.ZNb=function(e,C){var J;var ja=J=null;if(!e)return C?(J=String.format(ue.a.instance.Cb(104),this.o3.Uub(this.Fd.ruleType,this.Fd.sB),this.o3.Jgd(this.Fd.ruleType,
this.Fd.sB)),ja="DataValidationEditNoMinMaxError"):(J=String.format(ue.a.instance.Cb(103),this.o3.Uub(this.Fd.ruleType,this.Fd.sB)),ja="DataValidationEditNoValueError"),{returnValue:!1,errorString:J,wq:ja};if(e.length>Uc.w9f)return J=ue.a.instance.fa(1677),{returnValue:!1,errorString:J,wq:ja};if(Zi.d(e))return{returnValue:!0,errorString:J,wq:ja};if(1===this.Fd.ruleType||2===this.Fd.ruleType||6===this.Fd.ruleType){if(!E.a.p5(e))return J=ue.a.instance.fa(1670),{returnValue:!1,errorString:J,wq:ja};if(1===
this.Fd.ruleType&&!E.a.isInteger(e))return J=ue.a.instance.fa(1671),{returnValue:!1,errorString:J,wq:ja};if(6===this.Fd.ruleType){if(!E.a.isInteger(e))return J=ue.a.instance.fa(1671),{returnValue:!1,errorString:J,wq:ja};if(0>parseInt(e,10))return J=ue.a.instance.fa(1672),{returnValue:!1,errorString:J,wq:ja}}}return{returnValue:!0,errorString:J,wq:ja}};Yc.prototype.oZd=function(){var e=this,C;var J=C=null;if(this.Aka||0===this.Fd.ruleType)return{returnValue:!0,errorString:C,wq:J};var ja=(0===this.Fd.sB||
1===this.Fd.sB)&&3!==this.Fd.ruleType&&7!==this.Fd.ruleType;return!function(){var Aa=e.ZNb(e.Fd.XN,ja);C=Aa.errorString;J=Aa.wq;return Aa}().returnValue||ja&&!function(){var Aa=e.ZNb(e.Fd.YN,ja);C=Aa.errorString;J=Aa.wq;return Aa}().returnValue?{returnValue:!1,errorString:C,wq:J}:ja&&(1===this.Fd.ruleType||2===this.Fd.ruleType||6===this.Fd.ruleType)&&!Zi.d(this.Fd.XN)&&!Zi.d(this.Fd.YN)&&parseFloat(this.Fd.XN)>parseFloat(this.Fd.YN)?(C=ue.a.instance.fa(1675),J="DataValidationEditMaximumLessMinimumError",
{returnValue:!1,errorString:C,wq:J}):{returnValue:!0,errorString:C,wq:J}};Yc.tia=function(e){switch(e){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Gd.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Yc.Nrb=function(e,C){C.a=ye(e.ruleType);C.b=Kf(e.sB);C.c=!!e.XN;C.d=!!e.YN;C.e=e.k5;C.f=e.l5;C.g=e.w5;C.h=!!e.eF;C.i=!!e.EV;C.j=e.v5;C.k=e.RZ;C.l=!!e.XT;C.m=!!e.WT};Qk.Object.defineProperties(Yc.prototype,
{Fd:{configurable:!0,enumerable:!0,get:function(){return this.jRb}},Bc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var e=this;return function(){e.OW(1);e.G9a()}},set:function(e){Object(ri.b)(Yc.prototype,this,"onCommitDialogHandler",e)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},o1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.o3.a1g}}});Object(Md.a)(Yc,
"DataValidationEditDialogDeprecated",ik.a,[]);Sc.prototype.uHa=function(e,C,J,ja){xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new ob(e,C,J,ja)).iSd():(new Yc(e,C,J,ja)).iSd()};Sc.prototype.G4g=function(e,C){var J=new uh.StandardDialog;J.kc=3;J.FAa(e.Ab.wZ,ue.a.instance.fa(1668),C)};Sc.prototype.I4g=function(e,C){var J=new uh.StandardDialog;J.kc=1;J.iX(e.Ab.wZ,ue.a.instance.fa(1669),C)};Object(Md.a)(Sc,"DataValidationEditDialogFactory",null,[417]);var gj=
cf.a;vm(Qd,gj);Qd.prototype.Pd=function(){this.Gd([new Tc(this.$,new Sc)])};Qd.ka=function(e){cf.a.he(245,new Qd(e))};Object(Md.a)(Qd,"DataValidationEditCommandHandlerFactory",cf.a,[]);Wc.ljg='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(Md.a)(Wc,"FileUploadDialogHTML",null,[]);var Aj=b(370),yj=dg.a;vm(oc,yj);oc.prototype.ui=function(e,C,J,ja,Aa){Aa=void 0===Aa?!0:Aa;this.evd=void 0===ja?!1:ja;this.VAj(C);this.oof=e;Aa&&wg.AFrameworkApplication.WF(e)};oc.prototype.VAj=function(e){if(oc.vy)this.HCj(e);else{var C={};C[oc.XSg]=e;C[oc.cTg]=CommonUIStrings.l_SendFileErrorReportMessage;C[oc.dTg]=CommonUIStrings.l_SendFileErrorReportTextCaption;C[oc.gZc]="";C[oc.$Sg]=CommonUIStrings.l_UserReportLinkText;C[oc.F0b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(Sg.a)(this,this.Asi,"legacyDialogHandler"),C);this.cX(oc.iTg)}};oc.prototype.HCj=function(e){var C={},J={},ja={},Aa={},gb={};e=(gb.id=this.Ve,gb.bodyControls=(Aa.reportErrorCheckboxProps=this.evd?(C.label=CommonUIStrings.l_UserReportLinkText,C):null,Aa.textAreaProps=this.dpf?{}:null,Aa.privacyStatementLinkProps=(ja.text=CommonUIStrings.l_PrivacyStatement,ja.handler=(J.href=wg.AFrameworkApplication.Cma,J.target="_blank",J),ja),Aa),gb.errorMessage=e,gb.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
gb.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,gb);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Sg.a)(this,this.sGd,"reactDialogHandler"),e)};oc.prototype.r9a=function(){if(!oc.vy){var e=document.getElementById(oc.fTg);e&&(e.className=oc.eTg,e.appendChild(Aj.createClusteredImage(32,32,oc.bTg,null,!0,CommonUIStrings.l_DialogError)));if(e=document.getElementById(oc.gTg))e.innerText=CommonUIStrings.l_PrivacyStatement,e.href=wg.AFrameworkApplication.Cma,Vd.a.addHandler(e,
"click",Object(Sg.a)(this,this.cRi,"onPrivacyClickHandler"));this.dpf||(e=document.getElementById(oc.gZc))&&e.parentNode&&e.parentNode.removeChild(e);this.evd||(e=document.getElementById(oc.ZSg))&&e.parentNode&&e.parentNode.removeChild(e)}};oc.prototype.DO=function(){oc.vy||(yj.prototype.DO.call(this),document.getElementById(this.pi("WACDialogPanel")).style.width=String.format("{0}px",400))};oc.prototype.Asi=function(e,C){var J=C[oc.gZc]||"",ja=!0;void 0!==C[oc.F0b]&&null!==C[oc.F0b]&&(ja=C[oc.F0b]);
this.$v(e,J,ja)};oc.prototype.sGd=function(e,C){this.$v(e,C.text||"",C.reportErrorChecked)};oc.prototype.$v=function(e,C,J){this.hof&&(J&&Gd.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.oof),this.hof(e,C,J))};oc.prototype.cRi=function(e){wg.AFrameworkApplication.Hb.De(kg.a.kza,2,e)};Qk.Object.defineProperties(oc.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Qk.Object.defineProperties(oc,{vy:{configurable:!0,enumerable:!0,get:function(){return wg.AFrameworkApplication.sa.Qa.qw&&
wg.AFrameworkApplication.sa.Qa.jmi}}});oc.XSg="WACDialogErrorMessage";oc.cTg="WACDialogErrorReportMessage";oc.dTg="WACDialogErrorTextPrompt";oc.gZc="WACDialogInput";oc.gTg="WACDialogPrivacyText";oc.fTg="WACDialogIconPanel";oc.bTg="CancelRequest_32x32x32";oc.eTg="WACDialogIcon";oc.iTg="WACDialogTextPanel";oc.F0b="WACDialogSendFileCheckbox";oc.ZSg="WACDialogSendFileCheckboxContainer";oc.$Sg="WACDialogSendFileCheckboxText";oc.aTg="FileUploadErrorDialog";Object(Md.a)(oc,"FileUploadErrorDialog",dg.a,[]);
var Fh=eh.a;vm(yb,Fh);yb.prototype.wEg=function(e){this.addHandler("fileCollectionComplete",e)};yb.prototype.Wbj=function(e){this.removeHandler("fileCollectionComplete",e)};yb.prototype.d_g=function(e,C,J){this.BJf=C;this.eH=e;this.wEg(J);wg.AFrameworkApplication.Cma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;e=new oc(this.e_g);wg.AFrameworkApplication.Hb.hc(kg.a.kza,ii.a.frame,yb.l2i);e.ui(0,"",null,!1,!1)};yb.prototype.Haj=function(e){this.Wbj(e)};yb.l2i=function(e,C,J,ja,Aa){Vd.a.Gt(Aa);
wg.AFrameworkApplication.Cma&&Lb.HelperMethods.vf(wg.AFrameworkApplication.Cma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(Md.a)(yb,"FileCollectionOperation",eh.a,[412,2]);var ek=Bh.a;vm(wc,ek);wc.prototype.create=function(){var e=this;Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){e.Gb(e.gBh)},this.ma,3)};wc.prototype.dispose=function(){fg.a.Fa(this.LRb);this.LRb=null;ek.prototype.dispose.call(this)};wc.ka=function(e){e.da.Ha(125,
new wc(e))};Qk.Object.defineProperties(wc.prototype,{gBh:{configurable:!0,enumerable:!0,get:function(){return this.LRb||(this.LRb=new yb(this.$))}}});Object(Md.a)(wc,"FileCollectionCommandHandlerFactory",Bh.a,[]);var jk=b(929),$c=b(179),Ee=b(260),ni=b(1019);Vb.WGh="GalleryGeneral";Vb.YGh="GalleryNumber";Vb.UGh="GalleryCurrency";Vb.SGh="GalleryAccounting";Vb.aHh="GalleryShortDate";Vb.XGh="GalleryLongDate";Vb.cHh="GalleryTime";Vb.ZGh="GalleryPercentage";Vb.VGh="GalleryFraction";Vb.$Gh="GalleryScientific";
Vb.bHh="GalleryText";Vb.BSg="ButtonComma";Vb.buttonPercentage="ButtonPercentage";Vb.keyboardNumber="KeyboardNumber";Vb.keyboardCurrency="KeyboardCurrency";Vb.keyboardDate="KeyboardDate";Vb.keyboardTime="KeyboardTime";Vb.keyboardPercentage="KeyboardPercentage";Object(Md.a)(Vb,"RibbonFormatKind",null,[]);var zh=b(287),N=b(665),Ea=b(664),Hb=b(663),yc=zh.a;vm(wf,yc);wf.prototype.S2=function(e){return yc.prototype.S2.call(this,e)||this.qFh.S2(this.Xbd,this.activeCell,this.format,this.Gre,this.RHf,this.MHf,
this.FZb,this.$Ea,this.clientCorrelationId,this.Nlb,this.bib)};wf.prototype.Yl=function(){var e=[];if(this.zcc)for(var C=yl(this.zcc),J=C.next();!J.done;J=C.next())e.push(Hb.a(J.value));else e.push(new Ea.a(this.format,this.Xbd,this.activeCell));return function(){return new N.a(e)}};wf.prototype.deb=function(){var e={OperationType:0};e.FormatCellsMultiRange=this.Xbd;e.ActiveCell=this.activeCell;e.Format=this.format;e.ApplyFormatOnPivotTableValueField=this.Gre;e.PivotTableXluid=this.RHf;e.PivotTableFieldCaption=
this.MHf;return e};Qk.Object.defineProperties(wf.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return xe.EwaSettings.tc()?Object(ri.a)(wf.prototype,this,"operationWorkingState"):0}},Br:{configurable:!0,enumerable:!0,get:function(){return this.Nlb}},j4:{configurable:!0,enumerable:!0,get:function(){return this.bib}},YBc:{configurable:!0,enumerable:!0,get:function(){return this.$Ea}}});Object(Md.a)(wf,"FormatCellsBatchOperation",zh.a,[]);var Xc=b(200);Cd.editCell="Edited";
Cd.dependentCell="Dependents";Object(Md.a)(Cd,"RecalcPriorityGroupType",null,[]);var Ae=b(215),Fe=b(9);Object(Md.a)(Sd,"RecalcAccuracyObject",null,[]);Ed.string="String";Ed.blank="Blank";Ed.general="General";Ed.XDh="Flexible";Object(Md.a)(Ed,"FormattedUnitKind",null,[]);Object(Md.a)(Fc,"RecalcResultProcessingStatistics",null,[]);Object(Md.a)(qf,"RecalcedCellInfo",null,[]);var af=b(106),Df=b(59),gf=b(586);ee.prototype.dispose=function(){this.calcManager=this.Qyc=this.Fh=this.grid=this.$=null};ee.prototype.xKf=
function(e){var C;if(e&&e.rangeDeltas){for(var J=this.Vca.length,ja=0;ja<e.rangeDeltas.length;ja++)(null===(C=e.rangeDeltas[ja])||void 0===C?0:C.data)&&void 0!==e.rangeDeltas[ja].data.value&&null!==e.rangeDeltas[ja].data.value&&void 0!==e.rangeDeltas[ja].range&&null!==e.rangeDeltas[ja].range&&Array.add(this.Vca,new qf(e.rangeDeltas[ja],e.stateId,e.isFinished,e.priorityGroup));Gd.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
e.stateId,e.priorityGroup,e.isFinished,e.rangeDeltas.length,J,this.Vca.length,this.lastSetCellInstantaneousOperation);!J&&this.Vca.length&&this.jCf(!1,0)}};ee.prototype.Jad=function(e,C,J,ja,Aa,gb,bc){if(!C)return Object(gf.a)("Null");var Mc=excelOnlineCalc.numfmt.renderCallback(ja,function(yd){return gridRenderer.CanvasRendererGlobals.measureTextWidth(yd,Aa,!0,xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},bc),Hc=e.renderValue(C,Mc);if(!excelOnlineCalc.util.isSuccess(Hc))return Object(gf.a)("Finalize");
ja=null;if(bc=excelOnlineCalc.numfmt.isHashesValue(Hc.value)){if(Hc=e.renderHashesValue(Hc.value,Mc),!excelOnlineCalc.util.isSuccess(Hc))return Object(gf.a)("Hashes")}else ja=ee.CFh(C,Hc.value);Mc=Hc.value;e=excelOnlineCalc.numfmt.renderedValueToString(Mc);C=Yd(Mc);Mc=Ac(Mc);return Object(gf.d)({text:e,valueType:J,fontColor:Mc,Dm:gb,X8a:ja,horizontalAlignment:C,isHashesValue:bc})};ee.prototype.jCf=function(e,C){var J=this;this.$&&this.grid&&this.calcManager&&this.Qyc&&this.calcManager.aq?(e&&(this.Pca=
this.Qyc.ybf),this.P2i(this.grid,this.calcManager.aq,e,C),!this.Pca&&this.Vca.length?Tf.Task.delay(0).CWRCT(function(ja){J.jCf(!0,ja.id);return!0},null,0,Df.a.current):Tf.Task.Ta(!0)):(Gd.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Tf.Task.Ta(!1))};ee.prototype.P2i=function(e,C,J,ja){var Aa=Lb.HelperMethods.lc();for(J=new Fc(this.Vca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.Pca,void 0,void 0,void 0,J,void 0,ja,!0,0,0,0,0,0,0);0<this.Vca.length;){ja=Lb.HelperMethods.lc()-Aa;if(!this.Pca||ja>this.Pca){J.numberOfCellsSkippedDueToTimeout=this.Vca.length;break}ja=Array.dequeue(this.Vca);if(id(ja,J)){var gb=Yg.Range.ld(ja.rangeDelta.range.row+1,ja.rangeDelta.range.column+1);(gb=e.wc(gb))?ee.zUg(ja.stateId,gb.cell)?(ee.Plc(e,gb,ja,J),this.PKg(C,gb,ja,J)):J.numberOfCellsUpdatedAlreadyByServer++:J.numberOfCellsWithNoFormattedCell++}}ja=Math.round(Lb.HelperMethods.lc()-
Aa);this.SUj(ja);this.eIj(J,ja);this.wgj(J)};ee.prototype.PKg=function(e,C,J,ja){var Aa=Se(C,J),gb=J.rangeDelta.data.formatted,bc=vc(J);e=this.Jad(e,gb,bc,C.cell.QSa,C.cell.lia,Aa,!1);if(Object(gf.c)(e))xe.EwaSettings.isChangeGateEnabled("OfficeVSO:OfficeVSO:6123700_checkTextAlignmentColorAndApplyNumberFormat")?this.nxj(C,e.value)&&(this.Fh.fZa(C,e.value),Aa=qd(J),this.Fh.i8c(C,this.lastSetCellInstantaneousOperation,2,Aa,!0,!0),ja.numberOfUpdatedCells++):C.text!==e.value.text&&(this.Fh.fZa(C,e.value),
Aa=qd(J),this.Fh.i8c(C,this.lastSetCellInstantaneousOperation,2,Aa,!0,!0),ja.numberOfUpdatedCells++);else switch(e.reason){case "Null":ja.numberOfRecalcedCellsWithoutFormattedValue=null==ja.numberOfRecalcedCellsWithoutFormattedValue?0:ja.numberOfRecalcedCellsWithoutFormattedValue+1;break;case "Hashes":ja.numberOfHashFormattedValues=null==ja.numberOfHashFormattedValues?0:ja.numberOfHashFormattedValues+1;break;case "Finalize":ja.newNumberFormatterFinalizeFailures=null==ja.newNumberFormatterFinalizeFailures?
0:ja.newNumberFormatterFinalizeFailures+1}Object(gf.b)(e)&&"Null"!==e.reason&&(ja.numberOfRecalcedCellsWithFormattedValue=null==ja.numberOfRecalcedCellsWithFormattedValue?0:ja.numberOfRecalcedCellsWithFormattedValue+1);J=ke(J);ja=0===J?C.cell.userInput:C.formulaBarText;Aa=Object(gf.c)(e)?e.value.text:"";gb=Object(gf.b)(e)?e.reason:"";Gd.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",
C.range.top,C.range.left,e.success,gb,J,C.cell.Dm,ja?E.a.yJ(ja):"null",Aa?E.a.yJ(Aa):"null")};ee.prototype.SUj=function(e){this.Pca=Math.max(this.Pca-Math.max(e,1),0)};ee.prototype.eIj=function(e,C){e.numberOfNonUpdatedCells=this.Vca.length;e.totalExecutionTime=C;e.newProcessingTimeLimit=this.Pca;e.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};ee.prototype.wgj=function(e){e=Sys.Serialization.JavaScriptSerializer.serialize(e);Gd.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",
e)};ee.CFh=function(e,C){e=e.units;var J=C.units;if(e.length!==J.length)return Gd.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;C=[];for(var ja=-1,Aa=0;Aa<e.length;Aa++)switch(e[Aa].kind){case Ed.blank:C.push.apply(C,af.h(" ",J[Aa].str.length));break;case Ed.string:C.push(e[Aa].str);break;case Ed.XDh:C.push("");ja=Aa;break;case Ed.general:C.push(J[Aa].str);
break;default:Gd.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=ja||""===J[ja].str)return null;J={};J.Start=C.slice(0,ja).join("");J.Separator=e[ja].str;J.End=C.slice(ja+1,C.length).join("");return J};ee.XLh=function(e){return e&&e&&e.Rt?e.Rt.BJ:Fe.a.Ue};ee.zUg=function(e,C){if(!C)return!1;C=ee.XLh(C);return C===Fe.a.Ue||C===e};ee.Plc=function(e,C,J,ja){var Aa=J.rangeDelta.data.value.toString(),gb=vc(J),bc=Se(C,J);Aa=new Sd(gb,Aa,bc,
J.priorityGroup);C.cell.Plc(Aa,e.Ca.rF);1===ke(J)?ja.numberOfDependentRecalcedCellsInBatch++:ja.numberOfEditedRecalcedCellsInBatch++};ee.prototype.nxj=function(e,C){return e.text!==C.text||e.horizontalAlignment!==C.horizontalAlignment||null!=C.fontColor&&e.xAe!=C.fontColor.xS()?!0:!1};ee.YGe=20;Object(Md.a)(ee,"CalcResultProcessor",null,[481,2]);Object(Md.a)(md,"GetRibbonNumberFormatResult",null,[]);je.prototype.mJb=function(e,C,J){var ja=C.Border;C=C.BorderFormat;var Aa=0,gb=!1;if(0===ja)e.cell.Orc(),
this.hId(e.cell.getRange());else{for(var bc=0;3>=bc;bc++)je.wxj(e,J,bc,ja)&&(Aa|=Lb.HelperMethods.n3a(bc),this.IXd(e.cell.getRange(),bc,C),gb=!0);Lb.HelperMethods.iR(ja,16)&&!Zi.c(e,0,J)&&(Aa|=2,this.IXd(e.cell.getRange(),0,C),gb=!0);Lb.HelperMethods.iR(ja,32)&&!Zi.c(e,2,J)&&(Aa|=4,this.IXd(e.cell.getRange(),2,C),gb=!0);gb&&(J=e.cell.Rt.Zf,Lb.HelperMethods.iR(Aa,2)&&this.T2f(e,J,0)&&(Aa&=-3),Lb.HelperMethods.iR(Aa,1)&&this.S2f(e,J,1)&&(Aa&=-2),Lb.HelperMethods.iR(Aa,4)&&this.T2f(e,J,2)&&(Aa&=-5),
Lb.HelperMethods.iR(Aa,8)&&this.S2f(e,J,3)&&(Aa&=-9),e.cell.setBorders(C,Aa,!1))}};je.prototype.xZ=function(e,C){e=je.qXe(e,C);return e.isValidRange?(e=this.Ca.NJa(e))&&e.length?e:null:null};je.prototype.hId=function(e){for(var C=0;3>=C;C++){var J=je.qXe(e,C);if(J.isValidRange&&(J=this.Ca.NJa(J))&&J.length)for(var ja=je.E1e(C),Aa=0;Aa<J.length;Aa++)J[Aa].gId(ja)}};je.prototype.IXd=function(e,C,J){if(e=this.xZ(e,C))for(var ja=je.E1e(C),Aa=Lb.HelperMethods.n3a(ja),gb=0;gb<e.length;gb++){var bc=e[gb];
this.jgi(bc,ja)&&je.setBorders(bc,J,Aa,C,ja)}};je.prototype.jgi=function(e,C){var J=e.Rt.Zf,ja=e.getRange();ja=this.xZ(ja,C);var Aa=!1,gb=!1,bc=!1,Mc=!1;ja&&(Aa=je.r6a(ja,!0),gb=je.r6a(ja,!1),Mc=je.cpd(ja),bc=1===ja.length?!0:!1);switch(C){case 0:return je.yfi(e,J,Mc,gb,bc);case 1:return je.vfi(e,J,Mc,Aa,bc);case 2:return je.wfi(e,J,Mc,Aa,bc);case 3:return je.xfi(e,J,Mc,gb,bc)}return!1};je.prototype.T2f=function(e,C,J){if(!e.cell.nN)return!1;var ja=e.range,Aa=this.xZ(ja,J),gb=Zi.c(e,J,C),bc=!1;C=
0===J?ja.top<C.top:ja.left<C.left;!je.Yyb(e.cell)&&Aa&&1!==Aa.length&&(bc=(0===J?je.r6a(Aa,!0):je.r6a(Aa,!1))?!1:!0);return!gb&&bc||C?!0:!1};je.prototype.S2f=function(e,C,J){var ja=e.cell,Aa=this.xZ(ja.getRange(),J);e=Zi.c(e,J,C);C=!1;if(Aa){var gb=je.r6a(Aa,!0),bc=je.r6a(Aa,!1),Mc=gb&&!bc;bc=bc&&!gb;1!==J||je.Mzb(ja)?3!==J||je.Nyb(ja)||je.Dxj(ja,Aa,bc,Mc)&&(C=!0):je.Cxj(ja,Aa,gb,bc)&&(C=!0)}return!e&&C||je.Yyb(ja)?!0:!1};je.ZPg=function(e,C,J){var ja={};ja.LineStyle=Array(4);ja.LineStyle[J]=e.LineStyle[C];
ja.Color=Array(4);ja.Color[J]=e.Color[C];return ja};je.Icf=function(e,C,J,ja,Aa){return Lb.HelperMethods.iR(e,Aa)&&Zi.c(C,J,ja)};je.wxj=function(e,C,J,ja){return je.Icf(ja,e,J,C,Lb.HelperMethods.n3a(J))||je.Icf(ja,e,J,C,64)||112===ja};je.setBorders=function(e,C,J,ja,Aa){C=je.ZPg(C,ja,Aa);e.setBorders(C,J,!1)};je.qXe=function(e,C){switch(C){case 0:return new Yg.Range(e.top-1,e.left,e.top-1,e.right,!1,!1);case 2:return new Yg.Range(e.top,e.left-1,e.bottom,e.left-1,!1,!1);case 1:return new Yg.Range(e.bottom+
1,e.left,e.bottom+1,e.right,!1,!1);case 3:return new Yg.Range(e.top,e.right+1,e.bottom,e.right+1,!1,!1)}return e};je.E1e=function(e){switch(e){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};je.r6a=function(e,C){for(var J=0;J<e.length;J++){var ja=e[J];if(ja.nN)return C?je.Nyb(ja):je.Mzb(ja)}return!1};je.Yyb=function(e){var C=e.Rt.Zf,J=e.getRange();return e.nN&&(J.top<C.top||J.bottom>C.bottom||J.left<C.left||J.right>C.right)?!0:!1};je.cpd=function(e){for(var C=0;C<e.length;C++)if(je.Yyb(e[C]))return!0;
return!1};je.Cxj=function(e,C,J,ja){if(!e.nN){if(!J||je.cpd(C))return!0}else if(je.Nyb(e)&&(1===C.length&&je.iLg(e,C[0])||!J))return!0;return ja};je.Dxj=function(e,C,J,ja){if(!e.nN){if(!J||je.cpd(C))return!0}else if(je.Mzb(e)&&(1===C.length&&je.jLg(e,C[0])||!J))return!0;return e.Uka||ja};je.yfi=function(e,C,J,ja,Aa){var gb=e.getRange();return je.Nyb(e)?je.Yyb(e)||Aa:C.top===gb.top||!ja||J};je.vfi=function(e,C,J,ja,Aa){var gb=e.getRange();return je.Nyb(e)?C.bottom===gb.bottom&&Aa:ja&&!J||C.bottom===
gb.bottom};je.wfi=function(e,C,J,ja,Aa){var gb=e.getRange();return je.Mzb(e)?je.Yyb(e)||Aa:C.left===gb.left||!ja||J};je.xfi=function(e,C,J,ja,Aa){var gb=e.getRange();return e.Uka?!1:je.Mzb(e)?C.right===gb.right&&Aa:ja&&!J||C.right===gb.right};je.Nyb=function(e){return 0<e.getRange().right-e.getRange().left};je.Mzb=function(e){return 0<e.getRange().bottom-e.getRange().top};je.jLg=function(e,C){e=e.getRange();C=C.getRange();return e.top===C.top&&e.bottom===C.bottom};je.iLg=function(e,C){e=e.getRange();
C=C.getRange();return e.left===C.left&&e.right===C.right};Object(Md.a)(je,"BorderModelAccessorHelper",null,[]);$d.prototype.ocb=function(e,C,J,ja,Aa,gb){e&&(e.n7(C,J,void 0===Aa?!1:Aa,void 0===gb?!1:gb),e.verticalAlignment=ja)};$d.prototype.mJb=function(e,C,J){this.eE||(this.eE=new je(this.Ca,this.q2a));this.eE.mJb(e,C,J)};Object(Md.a)($d,"FormatCellsActionModelAccessor",null,[480]);pf.prototype.isValid=function(){return this.Cl&&this.aq?!(void 0===this.formatString||null===this.formatString):!1};
pf.prototype.eSh=function(){return null!=this.QE?this.QE:this.formatString};Qk.Object.defineProperties(pf.prototype,{QE:{configurable:!0,enumerable:!0,get:function(){return this.epg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.Z8a)return this.Z8a;if(this.Hqa)return this.Hqa.formatString;if(!this.Cl)return null;if(null!=this.QE){var e=this.QE;return 0>e?(Gd.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(e=this.Cl.hca[e])?this.Z8a=
e.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.Hqa?this.Hqa:this.aq&&this.formatString?this.Hqa=this.aq.createFormat(this.formatString,this.uSg).value:null}},uSg:{configurable:!0,enumerable:!0,get:function(){if(!this.Cl||null==this.QE||0>this.QE)return!1;var e=this.Cl.hca[this.QE];return e?e.Builtin:!1}}});Object(Md.a)(pf,"NumberFormatHolder",null,[479]);var Rg=b(246);Object(Md.a)(Qf,"FormatCellInstantaneousResult",null,[]);Object(Md.a)(Qe,
"FormatStringResult",null,[]);var Ig=b(1185),Kg=b(526),bi=b(192),yi;(function(e){e.InvalidInput="invalid input";e.UnsupportedZeroResize="resizing to 0 - ignore";e.UnsupportedSkeletonInView="skeleton in view - ignore";e.NullSPD="ActiveSheetProcessedData is null";e.UnsupportedHiddenInRange="hiddens in resizeRanges";e.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(yi||(yi={}));Object(Md.b)("InstantaneousRowColumnResizeFailureReason",yi);var oi=b(307);td.prototype.dispose=
function(){fg.a.sc([this.iSa,this.V2]);this.$=this.V2=this.iSa=null};td.prototype.aSa=function(e,C,J,ja,Aa,gb,bc,Mc,Hc){return this.KBj(e,C,J,void 0===Aa?!1:Aa,void 0===Mc?0:Mc,void 0===gb?"":gb,void 0===Hc?null:Hc)};td.prototype.i8c=function(e,C,J,ja,Aa,gb){e.cell.Rt.sQ|=ja;td.O0g(Oe.g(this.$),e,J,Aa);this.V2.lastSetCellInstantaneousOperation=C;gb&&Oe.g(this.$).Li.L0(C,Wg.BasicTelemetryCalculator.cR)};td.prototype.Vda=function(e,C,J,ja,Aa,gb){ja=void 0===ja?!1:ja;Aa=void 0===Aa?null:Aa;var bc=void 0===
bc?null:bc;gb=(void 0===gb?null:gb)||e.ha.va.selectedRanges;if(!(-1690267012===C&&1<gb.length)){-1690267012===C&&Gd.ULS.shipAssertTag(537162176,0,1===gb.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",gb.length);var Mc=e.K$("FormatCellsAction.ShowInstantaneousFormatting",gb);try{Mc.$$rst();for(var Hc=!1;Mc.$$mn();){var yd=void 0,we=Mc.$$cu().LH?e.JIb(Mc.$$cu().range):(yd=new va.a,yd.add(Mc.$$cu()),yd);yd={};for(var $e=yl(we),Gf=$e.next();!Gf.done;yd={Ifb:yd.Ifb},
Gf=$e.next()){var ag=Gf.value;if(Oe.g(this.$).jz&&ag&&bc&&-1690267012===C&&(yd.Ifb=ag.range,yd.Ifb&&bc.contains(yd.Ifb)&&gh.a.all(gb,function(Nf){return function(Pg){return!ud.c(Pg,Nf.Ifb)}}(yd))))continue;if(!ag||Mc.kd.contains(ag.range))if(this.LBj(C,ag,J,ja,Aa,Mc.$$cu().LH),Hc||(e.Ca.IV(),Hc=!0),Aa)break}}}finally{Mc&&Mc.dispose()}}};td.prototype.fZa=function(e,C,J){if(J=void 0===J?null:J)J.yLa=!0;J=!C.text;var ja=E.a.fgf(C.text),Aa,gb=e.LH?Oe.g(this.$).JIb(e.range):(Aa=new va.a,Aa.add(e),Aa);
Aa=yl(gb);for(gb=Aa.next();!gb.done;gb=Aa.next())this.NKg(this.$,gb.value,C.text,C.horizontalAlignment,C.fontColor,C.Dm,e.cell.Dm,J,ja,C.valueType,C.X8a);e.cell.KBc()};td.prototype.NYi=function(e,C,J,ja,Aa){Aa=void 0===Aa?null:Aa;try{var gb=ud.D(C),bc=ud.D(J);if(e.Sb.s6a(gb)||e.Sb.s6a(bc))return 8;if(-185374993!==ja&&this.Tni(e,gb,bc))return 9;if(-185374993!==ja&&(e.Sb.r5(bc)||e.Sb.kzb(gb)))return 10;if(1804571062!==ja&&e.Sb.Nka(bc))return 11;if(this.Ihh(bc))return 12;if(this.Ioi(gb,bc))return 13;
var Mc=this.$.Wb.Ic("UserAction","PasteInstantaneous");Mc.start();Kg.a(Mc);Aa&&ih.b().WB(Mc.id,Aa.id,"actions","actions");!gb.isSingle&&bc.isSingle&&(bc=td.expandRange(gb,bc),e.ha.updateSelection(bc,bc,0));switch(ja){case 237279923:case 808159687:if(!this.fZi(gb,bc))return 14;this.U2c(e,gb,bc,!0,!1);break;case 1804571062:this.U2c(e,gb,bc,!0,!1);break;case -185374993:this.U2c(e,gb,bc,!1,!0);break;default:return 2}Gd.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");
return 1}catch(Hc){return Gd.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Hc)),15}};td.prototype.KYg=function(e,C){e=yl(e);for(var J=e.next();!J.done;J=e.next())this.x0c(J.value,!0,C)};td.prototype.x0c=function(e,C,J){J=void 0===J?"":J;if(e){var ja=Oe.g(this.$);if(C){if(C=ja.wl("FormatCellsAction.ClearRangeInstantaneous",e),e=e.isSingle?null:e,C.$$mn()&&void 0!==C.$$cu()&&null!==C.$$cu())for(ja=Object.assign(new Hd.a,{Text:""}),
this.aSa(C.$$cu(),ja,!1,void 0,vg.a.Ood(this.$),J,void 0,void 0,e);C.$$mn();)void 0!==C.$$cu()&&null!==C.$$cu()&&this.aSa(C.$$cu(),ja,!1,void 0,!1,J)}else this.Vda(ja,-1228228458,{},void 0,void 0,[e])}else Gd.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};td.prototype.q8i=function(e,C){if(!C){C=Lb.HelperMethods.lc();var J=Oe.g(this.$),ja=J.K$("FormatCellsAction.ReformatCells",e);try{ja.$$rst();for(var Aa=!1;ja.$$mn();){var gb=ja.$$cu().cell;
if(0===gb.lU||2===gb.lU)this.CUj(gb,e),Aa||(J.Ca.IV(),Aa=!0)}}finally{ja&&ja.dispose()}Gd.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",Lb.HelperMethods.lc()-C)}};td.prototype.gjd=function(e,C){if(this.Eb){if(e.formulaBarText)return!E.a.equals(C.Text,e.formulaBarText,!1);var J=e.cell.formattedText;J=Rg.a(J,e.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(J,C).isEqual}return!E.a.equals(C.Text,
e.text,!1)};td.prototype.GVe=function(e){if(void 0===e||null===e)return new Qe(!1,"1234.56");e=new pf(this.Cl,this.aq,void 0,e);if(!e.isValid())return new Qe(!1,"1234.56");e=this.N2a({value:"1234.56",type:1},e,244,"12px sans-serif");return Object(gf.b)(e)?new Qe(!1,"1234.56"):new Qe(!0,e.value.text)};td.prototype.MBj=function(e,C,J,ja){return He(e,this,C,J,ja,!0)};td.prototype.IBj=function(e,C,J){if(!this.gjd(C,J))return Object(gf.d)("Skip unchanged cell content");C=C.cell;var ja=new pf(this.Cl,this.aq,
C.Dm);J=this.IVe(J.Text,ja,C.QSa,C.lia,!0);if(Object(gf.b)(J))e=J;else{J=J.value;ja=J.text;var Aa=J.valueType;ja=C.hasRichValueIcon?"Unsupported rich value icon":C.l1?xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==Aa&&'normal 11pt "calibri"'===C.lia&&C.aCe(ja)>=C.offsetWidth*Math.floor(C.offsetHeight/Fe.a.Erb)?"Unsupported wrapped text with long input":"Unsupported wrapped text":C.Ozb||null!=C.x9f&&0!==C.x9f?"Unsupported rotated text":!0;!0!==ja?e=
Object(gf.a)(ja):(C.isCellWidthFixed?ja="Skip fixed width cell":(ja=J.valueType,ja=0===ja?"Skip empty cell value":2===ja?"Skip string cell value":C.nN&&!C.Mni?"Skip merged cell":C.Hxc?"Skip shrunk to fit":J.isHashesValue?"Skip hashes cell value":!0),!0!==ja?e=Object(gf.d)(ja):(J=C.aCe(J.text),J>C.offsetWidth?(C=[C.getRange().clone()],e=He(e,this,C,J,!1,!1),e=Object(gf.b)(e)?e:Object(gf.d)(J)):e=Object(gf.d)("Column is wide enough")))}return e};td.prototype.xFh=function(e,C,J){var ja=Number.POSITIVE_INFINITY;
C=new pf(this.Cl,this.aq,C);if(!C.isValid())return new Qe(!1,e);var Aa={};Aa.value=e;Aa.type=1;J=this.N2a(Aa,C,ja,J);return Object(gf.b)(J)?new Qe(!1,e):new Qe(!0,J.value.text)};td.prototype.CUj=function(e,C){var J=e.getRange(),ja=!1;C=yl(C);for(var Aa=C.next();!Aa.done;Aa=C.next())if(J.left===Aa.value.left){ja=!0;break}e.LRj(ja)};td.prototype.KBj=function(e,C,J,ja,Aa,gb,bc){var Mc=void 0;gb=void 0===gb?"":gb;Mc=void 0===Mc?1:Mc;bc=void 0===bc?null:bc;var Hc=new Qf;Hc.source=0;Hc.yLa=!1;e.cell.Ioc=
e.cell.Dm;var yd=C.Text,we=!yd,$e=E.a.fgf(yd);E.a.qo(yd)&&(Gd.ULS.shipAssertTag(537162142,0,!((void 0===yd||null===yd)&&void 0!==C.TextRuns&&null!==C.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),C=Object.assign(new Hd.a,{Text:""}),yd="");e.cell.userInput=yd;if(!this.gjd(e,C))return this.hWg(e,Aa,we,$e,Hc);J?this.aWg(e,yd,this.$.workbookContext.DefaultHyperlinkStyle,Hc):this.VVg(e,C,yd,we,$e,ja,Hc,bc);this.i8c(e,gb,Aa,Mc,Hc.lhc,Hc.yLa);return Hc};
td.prototype.hWg=function(e,C,J,ja,Aa){Aa.Yfg=!0;Aa.lhc=!0;Aa.yLa=!1;0===C&&Oe.g(this.$).Ca.IV();0===e.cell.Pya&&(J?e.cell.n7(0,!1):ja&&e.cell.n7(1,!1));return Aa};td.prototype.aWg=function(e,C,J,ja){ja.yLa=!0;e.insertHyperlink(C,Xc.a.jbd(C),J)};td.prototype.VVg=function(e,C,J,ja,Aa,gb,bc,Mc){Mc=void 0===Mc?null:Mc;bc.yLa=!1;var Hc=e.cell;this.Cl||(this.Cl=this.$.da.Aa(268));this.LNj(this.Cl,Hc.Dm);ja||Aa?this.XVg(e,ja,Aa,bc):(ja=new pf(this.Cl,this.aq,Hc.Dm),ja=this.IVe(J,ja,Hc.QSa,Hc.lia,!1),Object(gf.c)(ja)?
(this.Jyj(C.TextRuns,C.Fonts)&&this.ZVg(e,C,ja.value),this.fZa(e,ja.value,bc)):this.eWg(e,C.Text),C=Object(gf.c)(ja)?ja.value.text:"",Aa=Object(gf.b)(ja)?ja.reason:"",Gd.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",e.range.top,e.range.left,ja.success,Aa,Hc.Dm,E.a.Knb(Hc.userInput),E.a.Knb(C)));Hc.formulaBarText=J;gb&&this.qNj(this.Cl,e,J,Mc);bc.lhc=!0};td.prototype.XVg=function(e,
C,J,ja){ja.yLa=!0;e.text="";e.formulaBarText="";e.cell.userInput="";this.s_c(e,null,null,C,J)};td.prototype.ZVg=function(e,C,J){C.Text===J.text&&2===J.valueType&&(e.cell.formattedText=C)};td.prototype.eWg=function(e,C){e.text=C;e.formulaBarText=C;this.s_c(e,1)};td.prototype.s_c=function(e,C,J,ja,Aa,gb){J=void 0===J?null:J;ja=void 0===ja?!1:ja;Aa=void 0===Aa?!1:Aa;gb=void 0===gb?!1:gb;var bc=e.horizontalAlignment;J=null!=J?J:e.verticalAlignment;0===e.cell.Pya&&(null!=C||ja||Aa||gb)&&(ja?bc=0:Aa||gb?
bc=1:null!=C&&(bc=C),this.Iua.ocb(e,bc,!1,J,!0))};td.prototype.LNj=function(e,C){(null===e||void 0===e?0:e.hca)&&C>=td.DDh&&C>e.hca.length-1&&(Gd.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",C),e.zVe())};td.prototype.qNj=function(e,C,J,ja){ja=void 0===ja?null:ja;if(void 0!==e&&null!==e)if(this.Cl.nmd)Gd.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");
else{var Aa=this.$.da.Aa(266);Aa&&(this.V2.Pca=ee.YGe,e&&(this.V2.Pca=e.ybf),Aa.OTg(C,J,Object(Sg.a)(this.V2,this.V2.xKf,"processResults"),ja))}};td.prototype.N2a=function(e,C,J,ja){var Aa=this.$.da.Aa(266);if(!Aa)return Object(gf.a)("calcManager is null");if(!Aa.aq)return Object(gf.a)("calcManager.NumberFormatter is null");if(!this.Cl)return Object(gf.a)("instantaneousManager is null");if(!C||!C.isValid())return Object(gf.a)("numberFormatHolder is invalid or null");var gb=Aa.Nfd(C);if(null===gb)return Object(gf.a)("cellFormat is null");
var bc=Aa.aq,Mc=of(e);if(void 0===Mc||null===Mc)return Object(gf.a)("cellValue is null");Aa=excelOnlineCalc.calc.cellValueToReadOper(Aa.config.mathpack,Mc);if(void 0===Aa||null===Aa)return Object(gf.a)("readOper is null");gb=bc.applyFormat(gb,Aa);return excelOnlineCalc.util.isSuccess(gb)?this.V2.Jad(bc,gb.value,e.type,J,ja,null!=C.QE?C.QE:-1,!1):Object(gf.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(gb.reason.kind))};td.prototype.IVe=function(e,C,J,ja,Aa){var gb=this.$.da.Aa(266);if(void 0===
gb||null===gb)return Object(gf.a)("calcManager is null");if(void 0===gb.aq||null===gb.aq)return Object(gf.a)("calcManager.NumberFormatter is null");if(void 0===this.Cl||null===this.Cl)return Object(gf.a)("instantaneousManager is null");if(void 0===C||null===C||!C.isValid())return Object(gf.a)("numberFormatHolder is invalid or null");if(xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1))return Object(gf.a)("No main thread number formatter");var bc=gb.Nfd(C);
if(void 0===bc||null===bc)return Object(gf.a)("cellFormat is null");var Mc=gb.aq;e=Mc.parseEdit(e,bc);if(!excelOnlineCalc.util.isSuccess(e))return Object(gf.a)("ParseEdit failure: reason="+e.reason.kind+", features="+e.reason.features);if(e.value.kind===ni.a.formula)return Object(gf.a)("Main thread - skipping formula edit");gb=excelOnlineCalc.numfmt.applyValueEdit(Mc,gb.localeInfo,bc,e.value);if(!excelOnlineCalc.util.isSuccess(gb))return Object(gf.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(gb.reason.kind));
bc=e.value;Gd.ULS.shipAssertTag(537162190,0,bc.kind!==ni.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");bc=excelOnlineCalc.numfmt.getValueEditOperKind(bc);e=0;switch(bc){case 0:case 128:e=0;break;case 1:e=1;break;case 2:e=2;break;case 4:e=3;break;case 8:e=4;break;case 16:case 32:case 64:case 256:Gd.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",bc);break;
default:Gd.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",bc)}return this.V2.Jad(Mc,gb.value,e,J,ja,null!=C.QE?C.QE:-1,Aa)};td.prototype.Tni=function(e,C,J){if(C.width<J.width)for(var ja=e.wl("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new Yg.Range(C.top,C.left,C.bottom,C.left,!0,!0));ja.$$mn();){var Aa=ja.$$cu();if(Aa&&Aa.OKa())return Gd.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),
!0}if(C.height<J.height)for(e=e.wl("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new Yg.Range(C.top,C.left,C.top,C.right,!0,!0));e.$$mn();)if((C=e.$$cu())&&C.SKa())return Gd.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};td.prototype.U2c=function(e,C,J,ja,Aa){for(var gb=C.HL().FirstRow,bc=C.HL().LastRow,Mc=J.HL().LastRow,Hc=gb,yd=J.HL().FirstRow;yd<=Mc;yd++,Hc++){Hc>bc&&(Hc=gb);var we=C.HL();we.FirstRow=we.LastRow=
Hc;var $e=J.HL();$e.FirstRow=$e.LastRow=yd;this.I3g(e,$c.a.PQ(we),$c.a.PQ($e),ja,Aa)}};td.prototype.fZi=function(e,C){var J=this.$.da.Aa(266);return void 0!==J&&null!==J?(J.ITg(e,C.topLeft,Object(Sg.a)(this.V2,this.V2.xKf,"processResults")),!0):!1};td.prototype.Ioi=function(e,C){var J=e.right-e.left+1;e=e.bottom-e.top+1;var ja=C.right-C.left+1;C=C.bottom-C.top+1;if(ja>J&&C>e){if(!(ja%J&&C%e))return!0}else if(ja===J&&C>e){if(!(C%e))return!0}else if(ja>J&&C===e&&!(ja%J))return!0;return!1};td.prototype.Ihh=
function(e){if(xe.EwaSettings.la(103)){e=Oe.g(this.$).h1(e).gridView.getRangeInformation(e);e=yl(e);for(var C=e.next();!C.done;C=e.next())if(C=C.value,Object(nf.a)(Ee.DynamicArrayRange,C)&&!Object(X.a)(Ee.DynamicArrayRange,C).Glc)return!0}return!1};td.prototype.QCe=function(e,C,J,ja,Aa,gb){C=yl(C);for(var bc=C.next();!bc.done;bc=C.next())bc=bc.value,J&&(this.M3g(bc,Aa),bc.setCell(!0)),ja&&(gb=this.N4h(Aa,bc)),gb||(e.Ca.IV(),gb=!0);return gb};td.prototype.ZQh=function(e,C,J){C=new Yg.Range(C,J,C,J,
!0,!0);return e.wc(C)};td.prototype.I3g=function(e,C,J,ja,Aa){if(J){this.iSa&&J.equals(this.iSa.range)||(fg.a.Fa(this.iSa),this.iSa=e.wl("FormatCellsAction.CopyBetweenRows",J));J=this.iSa;J.$$rst();var gb=!1;if(xe.EwaSettings.getBooleanFeatureGate(oi.a.EFe,!1)){var bc=C.HL().FirstColumn+1,Mc=C.HL().LastColumn+1;C=C.HL().FirstRow+1;for(var Hc=bc;J.$$mn();){Hc>Mc&&(Hc=bc);var yd=this.ZQh(e,C,Hc);Hc+=1;var we=void 0,$e=J.$$cu().LH?e.JIb(J.$$cu().range):(we=new va.a,we.add(J.$$cu()),we);yd&&(gb=this.QCe(e,
$e,ja,Aa,yd,gb));L.lastOrDefault($e)}}else for(bc=e.wl("FormatCellsAction.CopyBetweenRows2",C);J.$$mn();)bc.$$mn()||(bc.$$rst(),bc.$$mn()),Mc=bc.$$cu(),C=void 0,Hc=J.$$cu().LH?e.JIb(J.$$cu().range):(C=new va.a,C.add(J.$$cu()),C),Mc&&(gb=this.QCe(e,Hc,ja,Aa,Mc,gb)),L.lastOrDefault(Hc)}else Gd.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};td.prototype.D4f=function(){var e=dh.a.jd(1,0,0,641,0,104573951,"PivotTableContextMenuOperationFailure");xi.a(this.$).ui(e)};
td.prototype.dzi=function(e,C){var J={ValidMembers:32},ja=C.NumberFormat;switch(e){case 1890566896:if(1001===ja||1002===ja||1003===ja){J.NumberFormat=14;J.NumberFormatOptions={};switch(ja){case 1001:J.NumberFormatOptions.TimeType=2;break;case 1002:J.NumberFormatOptions.DateType=7;break;case 1003:J.NumberFormatOptions.DecimalPlaces=0}J.NumberFormatOptions.NumberFormatCategory=this.BKg(ja)}else J.NumberFormat=ja;break;case 1886928607:J.NumberFormat=13;break;case -992833457:J.NumberFormat=11;break;case 218524921:J.NumberFormat=
12;break;case 996232352:J.NumberFormat=14;J.NumberFormatOptions=Object.assign(new jk.a,{DecimalPlaces:0});J.NumberFormatOptions.NumberFormatCategory=6;break;default:return C}return J};td.prototype.formatCells=function(e,C,J,ja,Aa,gb,bc){ja=void 0===ja?null:ja;Aa=void 0===Aa?null:Aa;gb=void 0===gb?null:gb;bc=void 0===bc?null:bc;var Mc=this.$.Wb.Ic("UserAction","FormatCellsInstantaneous, command = "+ih.b().ti(e)),Hc=this.$.Wb.Vh("UserAction","FormatCellsInstantaneousFrame");Hc.start();Kg.a(Hc);var yd=
ih.b().ti(e),we=this.$,$e=Oe.g(we),Gf=$e.ha.va,ag=Aa||Gf.selectedRanges,Nf=af.g(ag,function(vj){return vj.kU});yd=String.format("{0}, cellCount={1}",yd,Nf);Oe.g(this.$).Li.z7(1,Mc.id,yd);ag=ud.r(ag,this.$);Gf=Gf.activeCell;yd=-168056295===J.command;var Pg=Nf=null;if(yd){Pg=$e.Sb.Zo(Gf);if(!Pg){this.D4f();return}Nf=Pg.Eca.substring(1,Pg.Eca.length-1);Pg=Pg.tac();if(!Pg){this.D4f();return}Pg=Pg.Caption}$e.Gh.VG(!1,!0);var Jh=ud.o(Gf,we),jj=we.na.ta.$b(!0),Xi=this.dzi(J.command,C);yd||this.Vda($e,e,
C,!1,ja,Aa);Mc.stop();Oe.g(this.$).Li.L0(Mc.id,Wg.BasicTelemetryCalculator.cR);J.zdi=Gg.a.Ra.Lb;ja=this.$.Wb.Ic("UserAction","FormatCellsUserAction");this.uvi(e,J.taskId,C,ag,Gf,ja.id);ih.b().WB(Mc.id,ja.id,"actions","actions");ih.b().WB(Hc.id,ja.id,"actions","actions");xe.EwaSettings.tc()?we.userOperationManager.ic(new wf(this,ag,Jh,Xi,yd,Nf,Pg,jj,ja,Mc.id,64,gb,bc),J):we.userOperationManager.ic(new wf(this,ag,Jh,Xi,yd,Nf,Pg,jj,ja,Mc.id,0,gb,bc),J)};td.prototype.S2=function(e,C,J,ja,Aa,gb,bc,Mc,
Hc,yd,we){var $e=this,Gf=this.$;return function(ag,Nf,Pg){Gf.ny();ag=[ag,$e.HLi];Nf=[Nf];yd&&ag.push(yd);we&&Nf.push(we);return jg.q(Gf.na.ta,e,C,J,ja,Aa,gb,Jf.b.apply(null,ag),Jf.a.apply(null,Nf),Pg,Hc,bc,Mc)}};td.prototype.LBj=function(e,C,J,ja,Aa,gb){if(C&&J){var bc=J.Font,Mc=J.HorizontalAlignment,Hc=J.VerticalAlignment;J.ValidMembers&2||(Mc=C.horizontalAlignment);J.ValidMembers&1||(Hc=C.verticalAlignment);var yd=0!==Mc;td.Efi(e)&&0===Mc&&(Mc=this.R_e(C));var we=!1;switch(e){case -394785302:this.Iua.ocb(C,
Mc,yd,0);break;case 1041132226:this.Iua.ocb(C,Mc,yd,1);break;case -571165336:this.Iua.ocb(C,Mc,yd,2);break;case -1150205178:case -1142465846:case -286432209:this.Iua.ocb(C,Mc,yd,Hc,!1,!1);break;case 1650812936:this.setFillColor(C,J,gb);break;case -287251124:C.bold=bc.Bold;break;case -1690267012:Oe.g(this.$).ha.va.qh&&(bc=Oe.g(this.$).ha.va.Td,this.Iua.mJb(C,J,bc));break;case 1970784898:J=Ae.a.Sp(C.color,C.backgroundColor);if(yg.a.compare(J,yg.a.red)&&(E.a.p5(C.text)||E.a.S7e(C.text)))break;bc=yg.a.jH(bc.FontColor);
C.color=bi.c(Ae.a.hG(bc));break;case -1925065947:C.italic=bc.Italic;break;case -1293291468:J=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");this.kn?(C.FJb(bc.FontName,J,"ShowInstantaneousFormattingOnCell"),C.e_f(bc.FontScheme)):C.FJb(bc.FontName,J,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:C.fontSize=bc.FontSize;this.$.If();break;case -1077965542:C.fontSize=bc.FontSize;break;case 1764140053:C.underline=bc.Underline;break;case -1685033574:C.doubleUnderline=
bc.DoubleUnderline;break;case -1590502662:C.fontStrikethrough=bc.Strikethrough;break;case -848953656:case 2045211913:we=C.Qpb();break;case 2105621672:bc=Object(X.a)(Ig.a,Aa);if(!bc)break;J=yg.a.xGh(bc.color);C.color=bi.c(Ae.a.hG(J));this.Mre(C,bc.Z8a);break;case -1409276245:this.Mre(C,J.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.MKg(C,J);break;case -1228228458:C.Qpb();C.clearFormat();this.BWc(C,0);we=!0;break;case -730106152:C.clearFormat();this.BWc(C,0);break;case 932244020:this.pqj(C,
J,gb);break;case -1942512156:case -1920201820:this.jsj(C,J)}ja||(we?C.Lab(!0):C.setCell(!0))}else Gd.ULS.shipAssertTag(537162135,0,!C,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),Gd.ULS.shipAssertTag(537162134,0,!J,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};td.prototype.M3g=function(e,C){e&&C?(e.Zpb(C),e.S0c(C),this.BWc(e,C.cell.Dm)):Gd.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};
td.prototype.BWc=function(e,C){if(0>C)this.r_("ApplyNumberFormatIndexOnCell",e,!1,"ApplyNumberFormatIndexOnCell: negative format index was supplied");else if(C=new pf(this.Cl,this.aq,C),C.isValid()){var J=this.N2a(e.RI,C,e.cell.QSa,e.cell.lia);Object(gf.b)(J)?this.r_("ApplyNumberFormatIndexOnCell",e,!1,J.reason):(this.fZa(e,J.value),this.r_("ApplyNumberFormatIndexOnCell",e,!0,void 0,J.value,C))}else this.r_("ApplyNumberFormatIndexOnCell",e,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};
td.prototype.Mre=function(e,C){if(void 0===C||null===C)this.r_("ApplyNumberFormatStringOnCell",e,!1,"ApplyNumberFormatStringOnCell: no format string was supplied");else if(C=new pf(this.Cl,this.aq,void 0,C),C.isValid()){var J=this.N2a(e.RI,C,e.cell.QSa,e.cell.lia);Object(gf.b)(J)?this.r_("ApplyNumberFormatStringOnCell",e,!1,J.reason):(this.fZa(e,J.value),this.r_("ApplyNumberFormatStringOnCell",e,!0,void 0,J.value,C))}else this.r_("ApplyNumberFormatStringOnCell",e,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};
td.prototype.MKg=function(e,C){if(C=void 0===C?null:C)if(C=this.YXh(e,C),C.success){var J=this.N2a(e.RI,C.Ulc,e.cell.QSa,e.cell.lia);Object(gf.b)(J)?this.r_("ApplyNumberFormatCategoryOnCell",e,!1,J.reason,void 0,C.Ulc):(this.fZa(e,J.value),this.r_("ApplyNumberFormatCategoryOnCell",e,!0,void 0,J.value,C.Ulc))}else this.r_("ApplyNumberFormatCategoryOnCell",e,!1,C.reason,void 0,C.Ulc);else this.r_("ApplyNumberFormatCategoryOnCell",e,!1,"ApplyNumberFormatCategoryOnCell: no format was supplied")};td.prototype.BKg=
function(e){switch(e){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<e?-1:e};td.prototype.YXh=function(e,C){if(!this.Cl||!this.localeInfo||!C)return e=this.Cl?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new md(!1,void 0,"GetRibbonNumberFormat: "+e);C=C.NumberFormat;switch(C){case 0:e=Vb.WGh;break;case 1:e=Vb.YGh;break;case 2:e=Vb.UGh;break;
case 3:e=Vb.SGh;break;case 4:e=Vb.aHh;break;case 5:e=Vb.XGh;break;case 6:e=Vb.cHh;break;case 7:e=Vb.ZGh;break;case 8:e=Vb.VGh;break;case 9:e=Vb.$Gh;break;case 10:e=Vb.bHh;break;case 11:case 12:return this.Cl.zVe(),this.rOh(e,C);case 13:e=Vb.BSg;break;case 1006:e=Vb.buttonPercentage;break;case 1004:e=Vb.keyboardNumber;break;case 1005:e=Vb.keyboardCurrency;break;case 1002:e=Vb.keyboardDate;break;case 1001:e=Vb.keyboardTime;break;case 1003:e=Vb.keyboardPercentage;break;case 14:return e="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",
Gd.ULS.shipAssertTag(537162132,0,!1,e),new md(!1,void 0,e);default:return e="GetRibbonNumberFormat: unknown NumberFormatType!",Gd.ULS.shipAssertTag(537162131,0,!1,e),new md(!1,void 0,e)}if(!e)return new md(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");e=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,e);if(!e)return new md(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");e=new pf(this.Cl,this.aq,
void 0,e);return new md(!0,e)};td.prototype.rOh=function(e,C){if(!this.calcManager||!this.aq)return C=this.calcManager?"numberFormatter is null":"calcManager is null",new md(!1,void 0,"GetDecimalChangeNumberFormat: "+C);e=this.calcManager.Nfd(new pf(this.Cl,this.aq,e.cell.Dm));if(!e)return new md(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");C=this.aq.changeFormatDecimals(e,11===C?1:-1);if(!excelOnlineCalc.util.isSuccess(C))return new md(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");
if(void 0===C.value||null===C.value)return new md(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");C=new pf(this.Cl,this.aq,void 0,void 0,C.value);return new md(!0,C)};td.prototype.r_=function(e,C,J,ja,Aa,gb){ja=void 0===ja?"":ja;Aa=void 0===Aa?null:Aa;gb=(gb=void 0===gb?null:gb)?gb.QE?gb.QE.toString():E.a.Knb(gb.formatString):"null";var bc=E.a.Knb(C.RI.value)||"null";Aa=Aa?E.a.Knb(Aa.text)||"null":"null";e=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",
e,C.range.top,C.range.left,J,ja,bc,C.RI.type,gb,Aa);Gd.ULS.sendTraceTag(537162130,0,50,e)};td.prototype.NKg=function(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd,we){Mc=void 0===Mc?!1:Mc;Hc=void 0===Hc?!1:Hc;var $e=C.cell;$e.lU=void 0===yd?0:yd;yd=C.text;yd!==J&&($e.text=J);$e.X8a=void 0===we?null:we;Zi.e(yd)?C.formulaBarText=yd:C.formulaBarText="";e=Oe.g(e).Sb.Pgf(C.range);this.s_c(C,ja,null,Mc,Hc,e);Aa&&(C.color=bi.c(Ae.a.hG(Aa)));C.cell.Dm=gb;C.cell.Ioc=bc;C.cell.eTd=gb};td.prototype.uvi=function(e,C,J,ja,Aa,gb){var bc=
{};bc.a=this.$.ya.UserSessionId;bc.b=C;bc.c=ja.Ranges.length;bc.d=this.H7g(ja.Ranges);bc.e=Aa.toString();bc.f=e;bc.h=gb;1890566896===e?bc.g=J.NumberFormat.toString():2105621672===e&&(bc.g=J.NumberFormatOptions.NumberFormatCategory.toString());ih.b().Qe(3,bc,!0)};td.prototype.H7g=function(e){for(var C=0,J=0,ja=0,Aa=0;Aa<e.length;Aa++){var gb=ud.B(e[Aa]).kU;C+=gb;gb>ja&&(ja=gb,J=Aa)}e=ud.B(e[J]).toString();return"TotalCellCount:"+C+"; Max range:"+e+"; MaxRangeSize:"+ja+";"};td.prototype.pqj=function(e,
C,J){64===(C.ValidMembers&64)&&this.setFillColor(e,C,J);16===(C.ValidMembers&16)&&td.Orj(e,C);128===(C.ValidMembers&128)&&this.Iua.mJb(e,C,e.range);if(2===(C.ValidMembers&2)||1===(C.ValidMembers&1)){J=C.VerticalAlignment;C=C.HorizontalAlignment;var ja=0!==C;xe.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!ja&&this.R_e(e);this.Iua.ocb(e,C,ja,J)}};td.prototype.setFillColor=function(e,C,J){(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
e.Waa:e.Waa&&e.Ycc&&!e.rwb&&!e.bdc)||(C=-1===C.FillColor?J?Ae.a.hG(yg.a.white):null:Ae.a.hG(yg.a.jH(C.FillColor)),e.backgroundColor=C?bi.c(C):null)};td.prototype.jsj=function(e,C){0!==e.horizontalAlignment&&2!==e.horizontalAlignment||e.n7(1,!1);0<=e.indentation+C.IndentationIncrease&&(e.indentation+=C.IndentationIncrease)};td.prototype.R_e=function(e){var C=new pf(this.Cl,this.aq,e.cell.Dm);if(!C.isValid())return 0;e=this.N2a(e.RI,C,e.cell.QSa,e.cell.lia);return Object(gf.b)(e)?0:null!=e.value.horizontalAlignment?
e.value.horizontalAlignment:0};td.prototype.ttj=function(e,C,J){this.eE||(this.eE=new je(Oe.g(this.$).Ca,this.$));this.eE.mJb(e,C,J)};td.prototype.N4h=function(e,C){var J=new Hd.a;if(e.cell.formulaBarText&&e.cell.formulaBarText.startsWith("'"))J.Text=e.cell.formulaBarText;else{var ja=e.cellValue;ja&&4!==e.cell.lU||(ja=e.text);J.Text=ja}this.aSa(C,J,!1,void 0,vg.a.Ood(this.$));return!0};td.prototype.Jyj=function(e,C){return this.Eb&&!!e&&!!C};td.O0g=function(e,C,J,ja){ja&&C.setCell(!0);0===J&&e.Ca.IV()};
td.expandRange=function(e,C){C=C.clone();C.height<e.height&&(C.bottom=C.top+e.height-1);C.width<e.width&&(C.right=C.left+e.width-1);return C};td.Efi=function(e){switch(e){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};td.Orj=function(e,C){C=C.Font;var J=0!==(C.ValidMembers&16),ja=0!==(C.ValidMembers&16),Aa=0!==(C.ValidMembers&16);e.bold=0!==(C.ValidMembers&4);e.italic=0!==(C.ValidMembers&8);J&&(e.underline=J);ja&&(e.doubleUnderline=
ja);Aa&&(e.fontStrikethrough=Aa);J=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");e.FJb(C.FontName,J,"SetFont");e.fontSize=C.FontSize;J=Ae.a.Sp(e.color,e.backgroundColor);yg.a.compare(J,yg.a.red)&&(E.a.p5(e.text)||E.a.S7e(e.text))||(C=yg.a.jH(C.FontColor),e.color=bi.c(Ae.a.hG(C)))};Qk.Object.defineProperties(td.prototype,{Iua:{configurable:!0,enumerable:!0,get:function(){return this.rFh}},aq:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||
null===this.calcManager?null:this.calcManager.aq}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});td.DDh=36;Object(Md.a)(td,"FormatCellsAction",null,[411,2]);var rj=Bh.a;vm(be,rj);be.prototype.create=function(){this.Gb(new td(this.$))};be.ka=function(e){e.da.Ha(18,new be(e))};Object(Md.a)(be,"FormatCellsActionFactory",Bh.a,[]);Object(Md.a)(ne,"FormulaAssistanceUIContext",null,[]);var pj=Bh.a;vm(pd,
pj);pd.prototype.create=function(){var e=this,C=this.$.da.Aa(448);if(C)this.Gb(C);else{var J=Zg.GetServiceTaskFactory.Wa(this.$.da,283,284,this.ub);Pd.TaskExtensions.Ba(J,function(){Pd.TaskExtensions.Ba(ch.c(J.result.Sn.loadScript(e.imj)),function(){C=e.$.da.Aa(448);if(!C){var ja=Object.assign(new ne,{isFeedbackAllowed:e.$.isFeedbackEnabled});C=e.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(ja));e.$.qye(function(){var Aa={};Aa.isFeedbackAllowed=e.$.isFeedbackEnabled;C.updateContext(Aa)})}e.Gb(C)},
e.$.ma,3)},this.$.ma,3)}};pd.ka=function(e){e.da.Ha(449,new pd(e))};Object(Md.a)(pd,"FormulaAssistanceUIControlFactory",Bh.a,[]);var mj=b(690);Object(Md.a)(qc,"FreezePanesCommandParameters",null,[]);var Eg=b(174),Nj=b(389),Kj=b(262),$i=b(284),Fi=b(118);Zd.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(Md.a)(Zd,"MacroRecorderSheetPaneFrozenPayload",null,[106]);rb.prototype.Zc=function(e,C){var J=!1;switch(C){case 1844679312:J=1!==e&&!this.gridView.$a.L4}return J};rb.prototype.executeCommand=
function(e,C){e=this.gridView.$a;var J=this.gridView.Phd();wg.AFrameworkApplication.sa.Qa.oz&&this.$.Tka&&(1844679312===C.command||340334732===C.command||-806625837===C.command)&&mj.ShyRibbon.fQ(1,2);switch(C.command){case 1844679312:return this.setFreezePanes(C,J,e.$i);case 340334732:return e.F9b?Tf.Task.Ta(!1):this.Trj(C,J);case -806625837:return e.gTa?Tf.Task.Ta(!1):this.Urj(C,J)}return Tf.Task.Ta(!1)};rb.prototype.Kc=function(e,C){e=!1;switch(C.command){case 1844679312:case 340334732:case -806625837:case 1745254833:e=
!0}return e};rb.prototype.gd=function(){return!1};rb.prototype.setFreezePanes=function(e,C,J){if(J)return this.Xuc(e,!1,0,0,0,0,C,null);var ja=this.gridView.ha.va;J=ja.activeCell.clone();ja=ja.activeRange;ja.Rh&&(Gd.ULS.sendTraceTag(537159585,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",J.top,J.bottom,C.top),J.top=J.bottom=C.top);ja.isRow&&(Gd.ULS.sendTraceTag(537159584,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",J.left,J.right,C.left),J.left=J.right=C.left);J.top===C.top&&J.left===C.left&&(J=Yg.Range.ld(J.top+1,J.left));ja=J.top-1;var Aa=J.left-1,gb=ja-(C.top-1),bc=Aa-(C.left-1);return this.zWj(J,gb,bc)?this.Xuc(e,!0,ja,Aa,gb,bc,C,J):(this.$.If(),this.$Ff(),Tf.Task.Ta(!0))};rb.prototype.Trj=function(e,C){return this.Xuc(e,!0,0,C.left,
0,1,C,null)};rb.prototype.Urj=function(e,C){return this.Xuc(e,!0,C.top,0,1,0,C,null)};rb.prototype.zWj=function(e,C,J){var ja=this.gridView.pg(e),Aa=this.gridView.view.visibleArea;return!ja||Aa.topLeft.y>ja.bottomRight.y||Aa.topLeft.x>ja.bottomRight.x||Aa.bottomRight.y<ja.bottomRight.y||Aa.bottomRight.x<ja.bottomRight.x?(Gd.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",
e,ja?ja.toString():"null",Aa.toString()),e=dh.a.jd(1,0,26,1446,0,2105967339,"FreezePaneSelectionNotInViewErr"),xe.EwaSettings.nz()?new ci.a(this.$,e):(e=new jh.ErrorDialog(this.$,e),e.initialize(),e.mf()),!1):0>=C&&0>=J?(Gd.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),e=Oe.g(this.$).rtl?1448:1447,C=Oe.g(this.$).rtl?-2131054257:-1953454131,e=dh.a.jd(1,0,26,e,0,C,"FreezePaneA1SelectedErr"),xe.EwaSettings.nz()?new ci.a(this.$,
e):(e=new jh.ErrorDialog(this.$,e),e.initialize(),e.mf()),!1):!0};rb.prototype.Xuc=function(e,C,J,ja,Aa,gb,bc,Mc){function Hc(){return new Zd(we)}var yd=this;this.xFd=xi.a(this.$).G9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.QT(this.ryf);this.uF.MAa();this.gridView.qGj(C?"":"UnsetFreezePane");this.luj(e,C,this.gridView.$a);var we=Object.assign(new qc,{SheetName:this.$.pa.name,Freeze:C,FrozenRows:Aa,FrozenColumns:gb,FirstRow:J,FirstColumn:ja});Gd.ULS.sendTraceTag(573101852,
0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",C,Aa,gb,J,ja);this.l$b=Gg.a.Ra.ie;return Hh.a(this.$.userOperationManager,function($e,Gf,ag){if(xe.EwaSettings.la(61)){var Nf=window.performance;Nf.clearMarks();Nf.mark("FreezePanes request sent")}Nf=yd.gridView.Is;yd.$.la(718)&&Nf?(Nf=yd.Dmh(we,Nf,bc,Mc),yd.sNj(Nf)):yd.$.ny();Nf=yd.$.na.ta;var Pg=Nf.Na(9,null);Pg.freezeSettings=we;return jg.i(Nf,"FreezeOrUnfreezePanes",
Pg,$e,Gf,ag,C,0)},function($e){return new Sf.a(151,0,$e,void 0,Hc)},e)};rb.prototype.Dmh=function(e,C,J,ja){Gd.ULS.shipAssertTag(537159580,1,!!C,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!e.Freeze)return null;var Aa=$i.a();Aa.State=1;Aa.IsEstimated=!0;var gb=!1,bc=!1,Mc=C.hV(Yg.Range.ld(J.top,J.left)),Hc=e.FrozenRows,yd=e.FrozenColumns;1!==e.FrozenRows||e.FrozenColumns?e.FrozenRows||1!==e.FrozenColumns?(yd=C.hV(Yg.Range.ld(e.FirstRow+1,
e.FirstColumn+1)),C=C.hV(Yg.Range.ld(J.top,J.left)),Aa.Width=yd.Zl-Mc.Zl,Aa.Height=yd.Im-Mc.Im,0<e.FrozenRows&&(Aa.AbsoluteTop=yd.Im,bc=!0),0<e.FrozenColumns&&(Aa.AbsoluteLeft=yd.Zl,gb=!0),Hc=yd.rL-C.rL,yd=yd.IJ-C.IJ):(Aa.Width=C.bXh(Eg.a.ld(J.top,J.left)),ja=Yg.Range.ld(J.top,J.left+1),Aa.AbsoluteLeft=Mc.Zl+Aa.Width,gb=!0):(Aa.Height=C.$Wh(Eg.a.ld(J.top,J.left)),ja=Yg.Range.ld(J.top+1,J.left),Aa.AbsoluteTop=Mc.Im+Aa.Height,bc=!0);bc&&(Aa.FirstFrozenRow=J.top,Aa.FirstScrollableRow=ja.top);gb&&(Aa.FirstFrozenColumn=
J.left,Aa.FirstScrollableColumn=ja.left);Aa.VisibleRows=Hc;Aa.VisibleColumns=yd;return Aa};rb.prototype.sNj=function(e){var C=this;Tf.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){C.$.pa&&C.$.ea&&(C.$.ea.vX(Fe.a.Ue,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Nj.b(C.$.pa,e,-1,void 0,!0))})};rb.prototype.luj=function(e,C,J){if(!xe.EwaSettings.la(689))switch(e.command){case 1844679312:if(C||-1===this.HKa&&-1===this.IKa)this.HKa=J.hx-J.width+this.gridView.scrollLeft,
this.IKa=J.ix-J.height+this.gridView.scrollTop;break;case 340334732:if(C||-1===this.HKa)this.HKa=J.hx-J.width+this.gridView.scrollLeft;break;case -806625837:if(C||-1===this.IKa)this.IKa=J.ix-J.height+this.gridView.scrollTop}};rb.prototype.ttc=function(){var e=this.gridView.$a;0<e.width?this.gridView.scrollLeft=Fi.a.o0b(this.gridView.domElement,Oe.g(this.$).rtl,0):-1!==this.HKa&&(this.gridView.scrollLeft=this.HKa,this.HKa=-1);0<e.height?this.gridView.scrollTop=0:-1!==this.IKa&&(this.gridView.scrollTop=
this.IKa,this.IKa=-1)};rb.prototype.$Ff=function(){this.uF.BSa();fg.a.Fa(this.xFd);this.xFd=null;this.gridView.gO(this.ryf)};Object(Md.a)(rb,"FreezePanesCommandHandler",null,[239]);var Hj=cf.a;vm(nd,Hj);nd.prototype.Pd=function(){var e=this;Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.Wa(this.$.da,12,477,this.ub),function(C){e.Gd([new rb(e.$,C.result)])},this.$.ma)};nd.ka=function(e){e.da.Ha(116,new nd(e))};Object(Md.a)(nd,"FreezePanesCommandHandlerFactory",cf.a,[]);var nk=b(938),ok=Bh.a;vm(zc,ok);
zc.prototype.create=function(){var e=this,C=Zg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub),J=Zg.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([C,J],this.ma),function(){e.Gb(e.$.da.Aa(296)||e.$.da.Ha(296,new nk.BorderFormatManager(e.$,C.result,J.result)))},this.ma,3)};zc.ka=function(e){xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&e.da.Ha(468,new zc(e))};Object(Md.a)(zc,"BorderFormatManagerFactory",
Bh.a,[]);var hj=b(958),Rh=b(23),Ck=b(99),fk=b(274),al=b(354),Rk=b(351),bl=b(95),Cj;(function(e){e[e.insert=1]="insert";e[e.delete=2]="delete";e[e.rows=4]="rows";e[e.columns=8]="columns";e[e.cellsShiftHorizontal=16]="cellsShiftHorizontal";e[e.cellsShiftVertical=32]="cellsShiftVertical";e[e.insertRows=5]="insertRows";e[e.insertColumns=9]="insertColumns";e[e.insertCellsShiftRight=17]="insertCellsShiftRight";e[e.insertCellsShiftDown=33]="insertCellsShiftDown";e[e.deleteRows=6]="deleteRows";e[e.deleteColumns=
10]="deleteColumns";e[e.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";e[e.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(Cj||(Cj={}));Object(Md.b)("InsertDeleteCellFlags",Cj);var xk=b(418);Object(Md.a)(sd,"MacroRecorderRangeInsertedOrDeletedPayload",null,[106]);var Lk=b(119),Dj=b(252),Vj=b(1140);b(823);cc.prototype.JWe=function(e,C,J,ja){ja=void 0===ja?null:ja;var Aa=Object.assign(new Fg.a,{Id:"FontDropdownMenu"});Aa.MenuSectionList=[];if(this.kn&&this.themesManager){this.themesManager.oad(ja);if(null==
this.themesManager.FL||this.themesManager.brd)return Aa;ja=Object.assign(new ei.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:ue.a.instance.fa(1293),ControlList:this.J_h(e,C,J)});Array.add(Aa.MenuSectionList,ja)}ja=Object.assign(new ei.a,{ControlsId:"FontsMenuSectionControl"});this.kn&&(ja.Title=ue.a.instance.fa(1294));ja.ControlList=this.OQh(e,C,J);Array.add(Aa.MenuSectionList,ja);return Aa};cc.prototype.J_h=function(e,C,J){var ja,Aa=[],gb=Oe.g(this.$).ha.Pa.mc;gb=5===(null===(ja=null===gb||
void 0===gb?void 0:gb.floatingObject)||void 0===ja?void 0:ja.type);if(this.themesManager.FL){var bc=this.themesManager.FL.Xqf;var Mc=this.themesManager.FL.qpf}else Gd.ULS.sendTraceTag(525361436,1,15,"ThemeFonts are Null");null!=Mc?(ja=this.qFe(Mc,1,gb,e,C,J),Array.add(Aa,ja)):Gd.ULS.sendTraceTag(525361435,1,15,"Major Theme Font is Null");null!=bc?(e=this.qFe(bc,2,gb,e,C,J),Array.add(Aa,e)):Gd.ULS.sendTraceTag(525361434,1,15,"Minor Theme Font is Null");return Aa};cc.prototype.qFe=function(e,C,J,ja,
Aa,gb){var bc=2===C?this.yBi:this.uyi;J=J?bc:Dg.a.xf(e);bc=Dg.a.xf(Lb.HelperMethods.Ybc(e,C));e=Dg.a.xf(e);return Object.assign(new Vj.a,{MenuItemId:2===C?this.Yqf:this.tpf,CommandValueId:J,LabelText:bc,LabelCss:String.format("font-size:12pt;font-family:{0};",e),Styles:cc.tvb(e),AriaLabel:bc,Alt:bc,Command:ja.toString(),CommandPreviewId:Aa.toString(),CommandRevertId:gb.toString()})};cc.prototype.OQh=function(e,C,J){var ja=[],Aa=this.ngi&&!this.zgf;cc.Hbd||cc.nbi();var gb=cc.Hbd,bc;for(bc in gb){var Mc=
bc,Hc=gb[bc],yd=Dg.a.xf(Mc),we=Dg.a.xf(Lb.HelperMethods.gUd[Mc]);Mc=Dg.a.xf(Mc);Aa||(Hc=0);yd=Object.assign(new Vj.a,{MenuItemId:yd,CommandValueId:yd,LabelText:Aa&&0<Hc?Dg.a.xf(String.fromCodePoint(Hc)):we,LabelCss:String.format("font-size:12pt;font-family:{0};",Aa&&0<Hc?"msofp":Mc),Styles:cc.tvb(Aa&&0<Hc?"msofp":Mc),AriaLabel:we,Alt:we,Command:e.toString(),CommandPreviewId:C.toString(),CommandRevertId:J.toString()});Array.add(ja,yd)}Aa&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.$Qi);
return ja};cc.nbi=function(){var e={};cc.Hbd=(e["Angsana New"]=983046,e["Arial Black"]=983051,e.Arial=983050,e.Batang=983061,e["Book Antiqua"]=983077,e["Browallia New"]=983082,e.Calibri=983085,e.Cambria=983089,e.Candara=983091,e.Century=983095,e["Comic Sans MS"]=983100,e.Consolas=983101,e.Constantia=983102,e.Corbel=983106,e["Cordia New"]=983107,e["Courier New"]=983109,e.DilleniaUPC=983121,e.Dotum=983123,e.FangSong=983138,e.Garamond=983154,e.Georgia=983156,e.Gulim=983182,e.GungSuh=983186,e.KaiTi=983222,
e.JasmineUPC=983218,e["Malgun Gothic"]=983258,e.Mangal=983262,e.Meiryo=983264,e["Microsoft JhengHei"]=983272,e["Microsoft YaHei"]=983284,e.MingLiU=983292,e.MingLiU_HKSCS=983296,e["MS Gothic"]=983245,e["MS Mincho"]=983247,e["MS PGothic"]=983249,e["MS PMincho"]=983251,e.PMingliU=983322,e["PMingLiU-ExtB"]=983324,e.SimHei=983382,e.SimSun=983384,e["SimSun-ExtB"]=983386,e["Source Sans Pro"]=983396,e.Tahoma=983405,e.THSarabunPSK=983404,e["Times New Roman"]=983415,e["Trebuchet MS"]=983419,e.Verdana=983443,
e["Yu Gothic"]=983464,e["Yu Mincho"]=983474,e)};cc.tvb=function(e){var C={};C["font-family"]=e;C["font-size"]="12pt";return{optionText:C}};Qk.Object.defineProperties(cc.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.ax||(this.ax=this.$.da.Aa(422));return this.ax}}});cc.Hbd=null;Object(Md.a)(cc,"FontDropdownHelper",null,[]);Ke.sRg=function(e,C){return new Ke(e,C,null,null,null)};Ke.PYc=function(e,C){return new Ke(e,null,C,null,null)};Ke.tRg=function(e,C){return new Ke(e,
null,null,C,null)};Ke.rRg=function(e,C,J){return new Ke(e,null,C,null,J)};Qk.Object.defineProperties(Ke.prototype,{yJa:{configurable:!0,enumerable:!0,get:function(){return this.fpg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.gpg}},style:{configurable:!0,enumerable:!0,get:function(){return this.bxg}},size:{configurable:!0,enumerable:!0,get:function(){return this.fWb}},Baa:{configurable:!0,enumerable:!0,get:function(){return this.sVe}}});Object(Md.a)(Ke,"CachedPreviewCellGroup",
null,[]);var Ij=b(65);oe.prototype.TL=function(){var e=this;this.oDc=!1;if(xh.b(this.$Ba,514846606)){this.oDc=!0;Gd.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");Ij.a(this.Bf.$).rd.XD(514846606);if(this.EOb&&this.O_d)window.setTimeout(function(){e.Bf.baa(e.Bf.gridView,e.ZBa,!0,!0)},0);else return this.d0d=Oe.g(this.Bf.$).rtl,this.f0d=dh.a.jd(3,2,0,this.d0d?628:627,0,514846606,"MergeCellsLoseData"),this.ij=xi.a(this.Bf.$).ui(this.f0d).G(),this.ij.isCompleted||(this._state=2,this.ij.IN(this.moveNext)),
this.hDc;return this.Bfb}return this.m1};oe.prototype.m1=function(){this.Bf.zmf(this.oDc,this.O_d,this.Khg.scenario,this.EOb);this._state=3};oe.prototype.Bfb=function(){return this.m1};oe.prototype.hDc=function(){this.kDc=this.ij.gz();if(0===this.kDc)return Gd.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.ij=this.Bf.baa(this.Bf.gridView,this.ZBa,!0,!1).g(),this.ij.isCompleted||(this._state=2,this.ij.IN(this.moveNext)),this.iDc;1===this.kDc&&Gd.ULS.sendTraceTag(537159428,
0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.Dfb};oe.prototype.Dfb=function(){return this.Bfb};oe.prototype.iDc=function(){this.ij.gz();return this.Dfb};oe.prototype.dispose=function(){};Object(Md.a)(oe,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[2]);te.prototype.TL=function(){return xh.b(this.$Ba,514846606)?(Gd.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),Ij.a(this.Bf.$).rd.XD(514846606),this.a0d=Oe.g(this.Bf.$).rtl,
this.b0d=dh.a.jd(3,2,0,this.a0d?628:627,0,514846606,"MergeCellsLoseData"),this.ij=xi.a(this.Bf.$).ui(this.b0d).G(),this.ij.isCompleted||(this._state=2,this.ij.IN(this.moveNext)),this.Afb):this.m1};te.prototype.m1=function(){this._state=3};te.prototype.Afb=function(){this.nDc=this.ij.gz();if(0===this.nDc)return Gd.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.ij=this.Bf.baa(this.Bf.gridView,this.ZBa,!0,this.EOb).g(),this.ij.isCompleted||(this._state=2,this.ij.IN(this.moveNext)),
this.Vhg;1===this.nDc&&Gd.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.Cfb};te.prototype.Cfb=function(){return this.m1};te.prototype.Vhg=function(){this.ij.gz();return this.Cfb};te.prototype.dispose=function(){};Object(Md.a)(te,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[2]);var aj=b(371),yk=aj.a;vm(Ud,yk);Ud.prototype.Bh=function(){1896159024===this.pp?(this.fo=ue.a.instance.fa(23),
this.C6c=0):(this.fo=ue.a.instance.fa(22),this.C6c=1);var e=this.selectedRanges[0].f_&&!this.selectedRanges[0].x5?0:1;this.kc=1;var C={};e=(C[Ud.Zy]=this.Bc,C.dialogToDisplay=this.C6c,C.defaultSelectedKey=e,C.isRtl=this.isRtl,C);this.initializeAndShow(this.fo,this.ddi,e)};Qk.Object.defineProperties(Ud.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(Md.a)(Ud,"InsertDeleteCellsDialog",aj.a,[]);Object(Md.a)(Kd,"MacroRecorderRangeFilledPayload",null,
[106]);Object(Md.a)(Ve,"RangeBorders",null,[]);Object(Md.a)(Ne,"ScenarioInfo",null,[]);Ad.prototype.dispose=function(){this.$=null};Ad.prototype.Ahi=function(e,C){return!(void 0===C||null===C)&&!!(C.scenario&16384)&&155820588!==e&&this.Kcf(C,e)};Ad.prototype.K0e=function(){var e=Vf.a.xe(),C=Oe.g(this.$),J=C.ha.va.selectedRanges,ja=0,Aa=0,gb=J.length,bc=new Ne;if(1<gb)return bc.scenario=4,bc;this.bpd&&Oe.g(this.$).rtl&&(ja|=65536);if(!C.xba(J[0]))if(this.iyb)ja|=32;else return bc.scenario=32,bc;if(C=
C.Ca.I3a(J[0],this.$.activeItemName))for(C=yl(C),gb=C.next();!gb.done;gb=C.next())if(Aa+=1,1<Aa)return this.iyb?(ja|=256,bc.scenario=ja):bc.scenario=256,bc;Aa=Oe.g(this.$).Ca.NJa(J[0]);if(!Aa)return bc.scenario=32768,bc;C=Aa.length;J=J[0];gb=J.bottom-J.top+1;for(var Mc=J.right-J.left+1,Hc=new Ve,yd=0;yd<C;yd++)if(this.Lgf&&this.SWh(Aa[yd],J,Hc),ja=ja|(void 0!==Aa[yd].text&&null!==Aa[yd].text&&""!==Aa[yd].text?1:0)|(Aa[yd].nN?2:0)|(Aa[yd].MKa?8:0)|(Aa[yd].owb?16:0)|(Aa[yd].iK?64:0)|(Aa[yd].Waa?128:
0),void 0!==Aa[yd].text&&null!==Aa[yd].text&&""!==Aa[yd].text||Aa[yd].MKa)void 0===bc.xaa||null===bc.xaa?bc.xaa=Oe.g(this.$).wc(Aa[yd].getRange()):ja|=16384;this.Lgf&&(Hc.eTa===Mc&&(ja|=512),Hc.rGa===Mc&&(ja|=2048),Hc.lNa===gb&&(ja|=4096),Hc.KQa===gb&&(ja|=1024),0<Hc.eTa&&Hc.eTa<Mc||0<Hc.rGa&&Hc.rGa<Mc||0<Hc.lNa&&Hc.lNa<gb||0<Hc.KQa&&Hc.KQa<gb)&&(ja|=8192);e=Vf.a.xe()-e;Gd.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenrio is : {0}",e);bc.scenario=ja;return bc};Ad.prototype.Dqf=
function(e,C){e=e.command;if(void 0===C||null===C)C=this.K0e();if(!this.Kcf(C,e))return!1;var J=Oe.g(this.$).ha.va.selectedRanges,ja=Oe.g(this.$).Ca.NJa(J[0]);if(!ja)return!1;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===ja.length&&!ja[0].nN)return-167499203===e?(ja[0].n7(2,!0),!0):!1;ja=Oe.g(this.$).ha.va.$A;var Aa=this.$.pa.sheetName;switch(e){case -167499203:2===(C.scenario&2)&&this.Fgc?this.Wbg(C.scenario,J,e):this.PAi(C,J);break;case 1097660126:this.Eqf(C,
J);break;case 155820588:this.Wbg(C.scenario,J,e);break;default:return!1}Oe.g(this.$).sV(J,ja,Aa,null,J[0],null,null,0,"MergeCellCommandAction");return!0};Ad.prototype.Kcf=function(e,C){var J=this.rgi(e,C);if(!this.Qef)return J;var ja=Oe.g(this.$).ha.va.selectedRanges[0].DC(!1);Gd.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",C.toString(),e.scenario,J,ja);return J};Ad.prototype.rgi=function(e,C){if(-255094134===C||this.bpd&&65536===
(e.scenario&65536))return!1;if(this.Voi(C,e))return this.Uoi(e);this.iyb&&32===(e.scenario&32)&&(e.scenario&=-33);return 32768===e.scenario||4===e.scenario||256===e.scenario||128===(e.scenario&128)||!this.iyb&&32===e.scenario||void 0!==e.xaa&&null!==e.xaa&&e.xaa.l1?!1:0===e.scenario?!0:16384===(e.scenario&16384)?xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):(1===(e.scenario&1)||8===(e.scenario&8))&&xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",
!1)||(-167499203==C||1097660126===C)&&this.igi(e)?!0:!1};Ad.prototype.igi=function(e){return xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)?16===(e.scenario&16)||this.K7e(e.scenario)||this.v8e(e.scenario)||this.g8e(e.scenario)||this.z8e(e.scenario)||8192===(e.scenario&8192)?!0:!1:!1};Ad.prototype.Voi=function(e,C){return 155820588===e||-167499203===e&&2===(C.scenario&2)&&this.Fgc?!0:!1};Ad.prototype.Uoi=function(e){if(!xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",
!1)||this.uhi&&void 0!==e.xaa&&null!==e.xaa&&e.xaa.l1)return!1;this.iyb&&32===(e.scenario&32)&&(e.scenario&=-33);return 32768===e.scenario||4===e.scenario||256===e.scenario||128===(e.scenario&128)?!1:2===(e.scenario&2)&&512!==(e.scenario&512)&&4096!==(e.scenario&4096)&&1024!==(e.scenario&1024)&&2048!==(e.scenario&2048)?!0:!1};Ad.prototype.SWh=function(e,C,J){var ja=e.getRange();if(ja.top===C.top)if(e.SKa)J.eTa+=ja.right-ja.left+1;else{var Aa=this.eE.xZ(ja,0);if(Aa){var gb=yl(Aa);for(Aa=gb.next();!Aa.done;Aa=
gb.next())Aa=Aa.value,Aa.pwb&&(J.eTa+=Aa.getRange().right-Aa.getRange().left+1)}}if(ja.left===C.left)if(e.OKa)J.lNa+=ja.bottom-ja.top+1;else if(Aa=this.eE.xZ(ja,2))for(gb=yl(Aa),Aa=gb.next();!Aa.done;Aa=gb.next())Aa=Aa.value,Aa.xwb&&(J.lNa+=Aa.getRange().bottom-Aa.getRange().top+1);if(ja.bottom===C.bottom)if(e.pwb)J.rGa+=ja.right-ja.left+1;else if(Aa=this.eE.xZ(ja,1))for(gb=yl(Aa),Aa=gb.next();!Aa.done;Aa=gb.next())Aa=Aa.value,Aa.SKa&&(J.rGa+=Aa.getRange().right-Aa.getRange().left+1);if(ja.right===
C.right)if(e.xwb)J.KQa+=ja.bottom-ja.top+1;else if(e=this.eE.xZ(ja,3))for(e=yl(e),Aa=e.next();!Aa.done;Aa=e.next())C=Aa.value,C.OKa&&(J.KQa+=C.getRange().bottom-C.getRange().top+1)};Ad.prototype.oaj=function(e){e=Oe.g(this.$).Ca.NJa(e);for(var C=e.length,J=1;J<C;J++){var ja=Oe.g(this.$).wc(e[J].getRange());xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)?ja.cell.deleteCellFromModel():(ja.Qpb(),ja.clearFormat(),ja.cell.raj());ja.Lab(!0)}};Ad.prototype.QUj=
function(e,C){e.backgroundColor=C.backgroundColor;e.color=C.color};Ad.prototype.QXh=function(e,C,J,ja){C.cell.Isj(J.bottom-J.top,J.right-J.left);var Aa=this.b3(this.c5(C),!0,0,ja,"merge");if(void 0!==e&&null!==e){var gb=e.cell.formattedText,bc=Object.assign(new Hd.a,{TextRuns:gb.TextRuns,Fonts:gb.Fonts});bc.Text=void 0!==e.cell.originalText&&null!==e.cell.originalText?e.cell.originalText:void 0!==e.cell.userInput&&null!==e.cell.userInput?e.cell.userInput:gb.Text;Aa=this.b3(this.c5(C),Aa,1,ja,"merge");
this.Fh.aSa(C,bc,!1,null,!0,"MergeCells",void 0,2);Aa=this.b3(this.c5(C),Aa,2,ja,"merge");this.bpd?C.Zpb(e):this.QUj(C,e);Aa=this.b3(this.c5(C),Aa,3,ja,"merge");C.cell.K3g(e.cell);Aa=this.b3(this.c5(C),Aa,4,ja,"merge")}this.oaj(J);Aa=this.b3(this.c5(C),Aa,5,ja,"merge");C.cell.KBc(!1);this.b3(this.c5(C),Aa,6,ja,"merge");return C};Ad.prototype.g8e=function(e){return 4096===(e&4096)};Ad.prototype.z8e=function(e){return 512===(e&512)};Ad.prototype.K7e=function(e){return 2048===(e&2048)};Ad.prototype.v8e=
function(e){return 1024===(e&1024)};Ad.prototype.fTh=function(e,C){C=C.cell.$ua().Borders;1<C.length&&(C=[C[1]]);return e=[].concat(Gl(C),Gl(e))};Ad.prototype.b0h=function(e,C){C=C.cell.$ua().Borders;1<C.length&&(C=[C[0]]);return e=[].concat(Gl(C),Gl(e))};Ad.prototype.iLh=function(e,C){C=this.eE.xZ(C.cell.getRange(),1);var J=[];0<C.length&&(J=C[0].$ua().Borders);J[0].BorderPosition=1;return e=[].concat(Gl(J),Gl(e))};Ad.prototype.aYh=function(e,C){C=this.eE.xZ(C.cell.getRange(),3);var J=[];0<C.length&&
(J=C[0].$ua().Borders);J[0].BorderPosition=3;return e=[].concat(Gl(J),Gl(e))};Ad.prototype.TWh=function(e,C,J){this.g8e(e.scenario)&&(C=this.fTh(C,J));this.z8e(e.scenario)&&(C=this.b0h(C,J));this.K7e(e.scenario)&&(C=this.iLh(C,J));this.v8e(e.scenario)&&(C=this.aYh(C,J));return C};Ad.prototype.M0d=function(e,C,J){J=void 0===J?null:J;var ja=[];ja=null!==J?[].concat(Gl(J)):this.TWh(C,ja,e);var Aa=[0,0,0,0],gb=[1,1,1,1],bc=0;ja.forEach(function(Mc){var Hc=Mc.BorderPosition;gb[Hc]=Mc.BorderLineStyle;var yd=
new yg.a(Mc.Color.Red,Mc.Color.Green,Mc.Color.Blue);Aa[Hc]=yd.xS();bc|=Lb.HelperMethods.n3a(Mc.BorderPosition)});C={};C.LineStyle=gb;C.Color=Aa;J={};J.BorderFormat=C;J.Border=bc;e.cell.Orc(e.cell.getRange());this.eE.hId(e.cell.getRange());this.Fh.Vda(Oe.g(this.$),-1690267012,J,!1,null,[e.cell.getRange()])};Ad.prototype.Vli=function(e){return 512===(e.scenario&512)||4096===(e.scenario&4096)||1024===(e.scenario&1024)||2048===(e.scenario&2048)?!0:!1};Ad.prototype.c0h=function(e){e=this.eE.xZ(e.cell.getRange(),
1);return e[0].SKa?(e=e[0].$ua().Borders[0],e.BorderPosition=1,e):null};Ad.prototype.d0h=function(e){e=this.eE.xZ(e.cell.getRange(),3);return e[0].OKa?(e=e[0].$ua().Borders[0],e.BorderPosition=3,e):null};Ad.prototype.y4h=function(e,C,J,ja,Aa){C.cell.Zdg();this.Vli(e)?this.M0d(C,e):Aa&&(Aa=[],null!==J&&Aa.push(J),null!==ja&&Aa.push(ja),0<Aa.length?this.M0d(C,e,Aa):(C.cell.Orc(C.cell.getRange()),this.eE.hId(C.cell.getRange())))};Ad.prototype.CSh=function(e,C){return null===e||void 0===e?!0:e.cell.getRange().top===
C.topLeft.top&&e.cell.getRange().left===C.topLeft.left&&e.cell.getRange().bottom===C.topLeft.bottom&&e.cell.getRange().right===C.topLeft.right?!0:!1};Ad.prototype.PAi=function(e,C){C=this.Eqf(e,C);C.n7(2,!0);this.b3(this.c5(C),!0,8,e.scenario,"merge")};Ad.prototype.Eqf=function(e,C){var J=e.xaa,ja=Oe.g(this.$).wc(C[0]),Aa=null,gb=null;xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)&&(Aa=this.c0h(ja),gb=this.d0h(ja));ja=this.QXh(J,ja,C[0],e.scenario);Oe.g(this.$).Ca.f$(C[0],
this.$.activeItemName).$dg(C[0],!0);this.b3(this.c5(ja),!0,9,e.scenario,"merge");xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)&&(C=this.CSh(J,C[0]),this.y4h(e,ja,Aa,gb,C));return ja};Ad.prototype.cQj=function(e,C){for(var J=e.length,ja=0;ja<J;ja++){e[ja].cell.KBc();var Aa=e[ja].cell.getRange();Aa=Oe.g(this.$).Ca.NJa(Aa);var gb=Aa.length;if(-167499203===C&&this.Fgc){var bc=0;2===e[ja].cell.KGd||1===e[ja].cell.lU?bc=3:2===e[ja].cell.lU&&(bc=1);e[ja].n7(bc,
!1)}for(bc=1;bc<gb;bc++)Aa[bc].attachCellToModel(),Aa[bc].Zpb(e[ja]),-167499203===C&&this.Fgc&&Aa[bc].n7(null,!1)}};Ad.prototype.Wbg=function(e,C,J){var ja=Oe.g(this.$).Ca.lva(C[0],this.$.activeItemName),Aa=Oe.g(this.$).Ca.f$(C[0],this.$.activeItemName),gb=[];if(void 0!==ja&&null!==ja&&(C=Oe.g(this.$).kva(C[0],ja),void 0!==C&&null!==C)){for(ja=C.$$ge();ja.$$mn();)C=ja.$$cu(),C.LH&&(gb.push(C),this.b3(this.c5(C),!0,10,e,"unmerge"),C.cell.zYg(),this.b3(this.c5(C),!1,11,e,"unmerge"),Aa.$dg(C.cell.getRange(),
!1));0<gb.length&&(Aa.Cf.resetCellLookup(),this.cQj(gb,J))}};Ad.prototype.b3=function(e,C,J,ja,Aa){if(this.Qef)return e!==C&&Gd.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",J,ja,Aa,C?"populated":"empty",e?"populated":"empty"),e};Ad.prototype.c5=function(e){return!!e.cell.cell.Merge};Object(Md.a)(Ad,"MergeCellCommandAction",null,[]);var Qi=b(105),sk=b(462),hl=b(377),Sk=b(818);wd.prototype.Uji=
function(e){return 1896159024===e||-1554384558===e||-1113896058===e||1554436520===e||1415868706===e||674605324===e||1035996630===e};wd.prototype.Zc=function(e,C){return 2054778433===C&&e&1?!Af.a(this.$).shc:600686207===C?!1:this.Uji(C)&&gh.a.any(this.gridView.ha.va.selectedRanges,function(J){return J.Rh||J.isRow})&&!this.Dhf&&!this.zhf?!0:this.Jhc(e,C)};wd.prototype.executeCommand=function(e,C,J){return this.Yb(C,J)};wd.prototype.Kc=function(e,C,J){if(e=1===e)switch(C.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:e=
!!J;break;case 862825906:case 1532790410:case 46555851:case -1522760979:e=!0;break;default:e=!1}return e};wd.prototype.gd=function(e,C,J){switch(C){case "PopulateFontColor":J.MenuItems=this.oB.fac(1970784898,-803000997,535,null,null,-128950598,2036397036,1688184685,862825906,J.MenuId);break;case "PopulateFillColor":J.MenuItems=this.oB.fac(1650812936,null,null,87208751,533,673562736,1457172838,-446735083,1532790410,J.MenuId);break;case "PopulateBorderColor":J.MenuItems=this.oB.fac(-236759591,-1803452024,
535,void 0,void 0,void 0,void 0,void 0,46555851,J.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.Q4h(J);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":J.MenuItems=this.Ibd.JWe(-1293291468,324978188,-1428968098,J.MenuId);break;default:return!1}return!0};wd.prototype.Jhc=function(e,C){var J=Oe.g(this.$).ha.va.selectedRanges;return!(new Ff.a(this.$.xa)).Fn(e,C,J,this.gridView)};wd.prototype.Yb=function(e,C){var J=this,ja=this.gridView,Aa=e.command,gb=Pd.TaskExtensions.nm(),
bc=!0;switch(Aa){case -1077965542:bc=this.H6e(C,e,!1);break;case 909774670:this.hpb(Aa);bc=this.H6e(C,e,!0);break;case -1293291468:bc=this.F6e(C,e,!1);break;case 324978188:xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Gd.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.hpb(Aa);bc=this.F6e(C,e,!0);break;case 862890474:case 963349338:bc=this.l4h(e);break;case -1832800737:bc=this.Icc(Aa,C,!1,e);break;case 1970784898:bc=
this.Icc(Aa,C,!1,e);break;case -803000997:bc=this.Icc(Aa,C,!1,e);break;case -128950598:case 1688184685:this.hpb(Aa);bc=this.Icc(Aa,C,!0,e);break;case 1597684571:bc=this.bwb(Aa,C,!1,e);break;case 87208751:C.Color="-1";C.IntColor=!0;bc=this.bwb(Aa,C,!1,e);break;case -446735083:this.hpb(Aa);C.Color="-1";C.IntColor=!0;bc=this.bwb(Aa,C,!0,e);break;case 1650812936:bc=this.bwb(Aa,C,!1,e);break;case 673562736:this.hpb(Aa);bc=this.bwb(Aa,C,!0,e);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(e=ih.b().ti(Aa),Gd.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",e));this.nUf(Aa);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:bc=this.X3h(Aa,e);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:bc=this.h3h(Aa,e);break;case -1803452024:case -236759591:bc=this.xid(Aa,C,e);break;case -2118943501:bc=this.borderFormatManager.r3h(C,e);break;case 1012765228:bc=
this.borderFormatManager.d5h(C,e);break;case 1256700402:bc=this.borderFormatManager.Did(e);break;case -1756763834:bc=this.borderFormatManager.Eid(e);break;case -1418159950:bc=this.borderFormatManager.s6e(e);break;case -1920201820:case -1942512156:bc=this.m4h(Aa,e);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:bc=this.borderFormatManager.d6e(C,e);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:bc=this.J4h(Aa,C,e);break;case -693675336:case 322710748:break;
case 1696566924:bc=this.Y3h(e);break;case -167499203:case -255094134:case 1097660126:case 155820588:gb=this.handleMergeCellsCommand(this.gridView,e);break;case 1896159024:case -1554384558:C=this.gridView.ha.va.selectedRanges;if(this.uzj(e,C))Gd.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new Ud(this.$,Aa,C)).Bh(),bc=!0;else if(gh.a.any(C,function(Hc){return J.gridView.Sb.Wwa(Hc)})){ja="";gb=1461300262;var Mc=-1554384558===Aa&&this.gridView.Sb.Wli(C[0]);
C=C[0].height>C[0].width&&!Mc;switch(Aa){case 1896159024:ja=C?"InsertColumnsTable":"InsertRowsTable";gb=C?622604322:942362098;break;case -1554384558:ja=C?"DeleteColumnsTable":"DeleteRowsTable",gb=C?284490184:1405456548}C=Ng.a.Rn(wd.fmd,ja,1);new hh.a(gb,1,2,6,null);gb=this.insertOrDeleteCells(C,e,!0)}else gb=this.insertOrDeleteCells(1896159024===Aa?1:2,e,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:gb=this.insertOrDeleteCells(Ng.a.Rn(wd.fmd,C[If.a.nd],1),e,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:gb=
this.insertOrDeleteCells(Ng.a.Rn(wd.fmd,C[If.a.nd],1),e,!1);break;case 504848446:gb=ja.startEdit(!1,1,C[Ca.a.event],void 0,void 0,!0);break;case 1504715724:if(Oe.g(this.$).jz&&this.borderFormatManager.OU.cB)break;gb=ja.startEdit(!0,0,C[Ca.a.event],void 0,void 0,!0);break;case 1872288872:this.Upb();break;case 41465729:gb=this.fill(ja.ha.va.Td,null,0,1,e);break;case -1451655532:case 1972143101:gb=this.fillDownAbsoluteValueAndStartEdit(ja,C[Ca.a.event],-1451655532===Aa);break;case -475861485:gb=this.fill(ja.ha.va.Td,
null,ja.rtl?1:2,1,e);break;case -978843926:gb=this.fill(ja.ha.va.Td,null,3,1,e);break;case 2098035706:gb=this.fill(ja.ha.va.Td,null,ja.rtl?2:1,1,e);break;case -2142700828:gb=this.fill(ja.ha.sourceRange,ja.ha.va.Td,wd.a_e(ja.ha.va.Td,ja.ha.sourceRange),2,e);break;case 1405660955:gb=this.fill(ja.ha.sourceRange,ja.ha.va.Td,wd.a_e(ja.ha.va.Td,ja.ha.sourceRange),4,e);break;case 1983983164:gb=this.fill(ja.ha.va.Td,null,0,0,e);break;case 478842689:(e=this.$.da.Aa(376))?(e.I4i(),bc=!0):Gd.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:bc=ja.ha.Yb(null,Aa);break;case -208772570:this.E4h();bc=!0;break;case -987339782:this.z3h();bc=!0;break;case -1770246794:ja.ha.A3h();bc=!0;break;case 748067091:case -381232414:this.D3h(Aa);bc=!0;break;case -1522760979:this.gridView.toggleFormulaView();bc=!0;break;case 886009118:gb=this.j4h();break;case 894341014:this.o4h();
bc=!0;break;case 862825906:gb=this.W6e(1970784898,e);break;case 1532790410:gb=this.W6e(1650812936,e);break;case 46555851:gb=this.A4h(e);break;default:bc=!1}bc||(gb=Ag.a(Aa));return gb};wd.prototype.uzj=function(e,C){var J=this,ja=gh.a.all(C,function(bc){return!J.gridView.Sb.Wwa(bc)}),Aa=1<C.length&&!!this.gridView.Sb.khd(C),gb=gh.a.all(C,function(bc){return!J.gridView.Sb.Nka(bc)});C=!gh.a.any(C,function(bc){return bc.isRow||bc.Rh});return 1===e.method&&6===e.df&&(ja||Aa)&&gb&&C};wd.prototype.fillDownAbsoluteValueAndStartEdit=
function(e,C,J){var ja=this,Aa=e.ha.va.activeCell,gb=ud.E(Aa,this.gridView.Is);return e.startEdit(!0,0,C).CWR(function(){var bc=e.wc(gb),Mc=e.wc(Aa);if(!bc||!Mc)return Gd.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",Aa.toString(),gb.toString()),Tf.Task.Ta(!1);ja.gridView.zc.text=J?bc.Z0:bc.text;ja.gridView.zc.textBox.setCaretPositionToEnd();return Tf.Task.Ta(!0)})};wd.prototype.insertOrDeleteCells=
function(e,C,J){function ja(){return new sd(yd)}var Aa=this,gb=ph.a.create().toString(),bc=Enum.toString(Cj,e);this.gridView.Li.z7(17,gb,bc);bc=this.gridView.ha.va.selectedRanges;var Mc=this.Dhf,Hc=this.zhf;if(!this.$.Ms(null,!1,void 0,C.df)&&!Hc&&!Mc&&5!==e&&9!==e)return Tf.Task.Ta(!0);2===e?e=Hc?10:Mc?6:bc[0].height>bc[0].width?18:34:1===e?e=Hc?9:Mc?5:bc[0].height>bc[0].width?17:33:18===e&&Mc?e=34:34===e&&Hc&&(e=18);bc=this.xIg(bc,e);if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5931745_AllowDeleteRowColFromDialog")){if((10===
e||6===e)&&!this.$.Ms(bc,!0,1,C.df))return Tf.Task.Ta(!0)}else if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5670217_PromptPasswordDialogForDeleteRowCol")&&(10===e||6===e)&&!this.$.Ms(bc,!0))return Tf.Task.Ta(!0);var yd={};yd.InsertDeleteRangeItems=Array(bc.length);yd.SheetName=this.$.pa.sheetName;yd.IsTableCommand=J;for(J=0;J<bc.length;J++){Mc=bc[J];var we={},$e=Hc=void 0;e&4?(we.FirstRow=Mc.top-1,we.LastRow=Fe.a.qz,we.FirstColumn=0,we.LastColumn=Fe.a.tw,Hc=Mc.bottom-Mc.top+1,$e=0,6===e&&(Mc.Rh||
(we.FirstRow=Mc.bottom),Hc=-Hc)):e&8?(we.FirstRow=0,we.LastRow=Fe.a.qz,we.FirstColumn=Mc.left-1,we.LastColumn=Fe.a.tw,Hc=0,$e=Mc.right-Mc.left+1,10===e&&(Mc.isRow||(we.FirstColumn=Mc.right),$e=-$e)):e&16?(we.FirstRow=Mc.top-1,we.LastRow=Mc.bottom-1,we.FirstColumn=Mc.left-1,we.LastColumn=Fe.a.tw,Hc=0,$e=Mc.right-Mc.left+1,18===e&&(we.FirstColumn=Mc.right,$e=-$e)):(we.FirstRow=Mc.top-1,we.LastRow=Fe.a.qz,we.FirstColumn=Mc.left-1,we.LastColumn=Mc.right-1,Hc=Mc.bottom-Mc.top+1,$e=0,34===e&&(we.FirstRow=
Mc.bottom,Hc=-Hc));we={InsertDeleteRange:we};we.DeltaRow=Hc;we.DeltaColumn=$e;we.AdjustedSelectedRange=ud.j(Mc);yd.InsertDeleteRangeItems[J]=we}this.gridView.Gh.VG(!1);var Gf=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");yd.IsDecoupleRecalc=Gf;var ag=this.$.na.ta.$b();return Hh.a(this.$.userOperationManager,function(Nf,Pg,Jh){Gf&&!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Aa.$.ny();var jj=Aa.$.na.ta;Nf=Jf.b(Nf,Aa.rOi);var Xi=jj.Na(41,
void 0===ag?null:ag);Xi.insertDeleteMultiRangeParameters=yd;return jg.i(jj,"InsertDeleteCells",Xi,Nf,Pg,Jh,gb,0)},function(Nf){return new Sf.a(237,0,Nf,void 0,ja)},C)};wd.prototype.xIg=function(e,C){return C&32?this.PYa(e,function(J){return J.bottom},function(J){return J.top},function(J,ja){J.bottom=ja},!1,!0):C&16?this.gridView.rtl?this.PYa(e,function(J){return J.left},function(J){return J.right},function(J,ja){J.left=ja},!1,!1):this.PYa(e,function(J){return J.right},function(J){return J.left},function(J,
ja){J.right=ja},!1,!1):C&4?this.PYa(e,function(J){return J.bottom},function(J){return J.top},function(J,ja){J.bottom=ja},!0,!0):C&8?this.gridView.rtl?this.PYa(e,function(J){return J.left},function(J){return J.right},function(J,ja){J.left=ja},!0,!1):this.PYa(e,function(J){return J.right},function(J){return J.left},function(J,ja){J.right=ja},!0,!1):e};wd.prototype.PYa=function(e,C,J,ja,Aa,gb){e=ud.d(e);e.sort(function(Hc,yd){return C(yd)-C(Hc)});if(Aa){Aa=[];gb=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?
gb?Fe.a.Kh+1:Fe.a.Wh+1:gb?Fe.a.qz:Fe.a.tw;for(var bc=0;bc<e.length;bc++){var Mc=e[bc];J(Mc)<gb&&(ja(Mc,Math.min(C(Mc),gb-1)),Array.add(Aa,Mc),gb=J(Mc))}e=Aa}return e};wd.prototype.fill=function(e,C,J,ja,Aa){function gb(){return new Kd(Hc,yd,ja,J)}var bc=this,Mc=this.$;if(!Mc.Ms([C],!0))return Tf.Task.Ta(!0);var Hc=ud.v(e,Mc),yd=C?ud.v(C,Mc):Hc,we=this.$.na.ta.$b();return Hh.a(this.$.userOperationManager,function($e,Gf,ag){bc.$.ny();var Nf=bc.$.na.ta,Pg=Nf.Na(9,we);Pg.sourceRange=Hc;Pg.targetRange=
yd;Pg.fillDirection=J;Pg.fillType=ja;return jg.i(Nf,"FillRange",Pg,$e,Gf,ag,null,0)},function($e){return new Sf.a(155,0,$e,void 0,gb)},Aa)};wd.prototype.J4h=function(e,C,J){var ja={ValidMembers:32};switch(e){case 1890566896:e=parseInt(C[If.a.nd].toString(),10);if(14===e)return J=new hh.a(2105621672,J.method,J.mode,J.df,J.tabName),C[If.a.nd]=null,this.$.Ka.Yb(J,C),Gd.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),
!0;ja.NumberFormat=e;break;case 1886928607:ja.NumberFormat=13;break;case -992833457:ja.NumberFormat=11;break;case 218524921:ja.NumberFormat=12;break;case 996232352:ja.NumberFormat=1006;break;default:return Gd.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+ih.b().ti(J.command)),!1}Gd.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",ih.b().ti(J.command),C[If.a.nd]);this.Fh.formatCells(1890566896,ja,J);
this.$.If();return!0};wd.prototype.l4h=function(e){var C=this.gridView.wc(this.gridView.ha.va.activeCell);if(this.Eb&&this.gridView.isEditing){C=this.gridView.xj.H3a(C?Zi.a(C).Font:null);if(!C)return Gd.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.va.activeCell.toString()),!1;var J=C.FontSize}else if(C)J=C.fontSize;else return!1;C=e.command;var ja=0;if(862890474===C)for(;ja<wd.wJa.length-
1&&wd.wJa[ja]<=J;)ja++;else if(963349338===C)for(ja=wd.wJa.length-1;0<ja&&wd.wJa[ja]>=J;)ja--;Gd.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",J,wd.wJa[ja]);if(J===wd.wJa[ja])return!0;J=wd.vvc(2);J.Font.FontSize=wd.wJa[ja];this.Eb&&this.gridView.isEditing?(this.Qnb(e,!1,J),this.$.If()):this.Fh.formatCells(C,J,e);return!0};wd.prototype.H6e=function(e,C,J){e=e[e[hj.a.IsFreeForm]?hj.a.Value:If.a.Tg].toString();if(!wd.f0i.test(e))return Gd.ULS.sendTraceTag(537159499,
0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) is not a number.",e),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;e=parseFloat(e);if(8>e||72<e)return Gd.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) not within expected limits ({1} - {2}).",e,8,72),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var ja=
Math.round(2*e)/2,Aa=wd.vvc(2);Aa.Font.FontSize=ja;this.Eb&&this.gridView.isEditing?(this.Qnb(C,J,Aa,!0),ja===e||J||this.$.If()):J?this.Fh.Vda(this.gridView,-1077965542,Aa,J):(this.Fh.formatCells(-1077965542,Aa,C),this.I_a());return!0};wd.prototype.F6e=function(e,C,J){var ja=e[If.a.Tg],Aa=Lb.HelperMethods.gUd[ja],gb=0;this.kn&&(e=e.MenuItemId,e===this.Ibd.Yqf?(ja==this.themesManager.FL.Xqf&&(Aa=ja),gb=2):e===this.Ibd.tpf&&(ja==this.themesManager.FL.qpf&&(Aa=ja),gb=1));if(!Aa)return!0;ja=wd.vvc(1);
ja.Font.FontName=Aa;this.kn&&(ja.Font.FontScheme=gb);this.Eb&&this.gridView.isEditing?(this.Qnb(C,J,ja),this.$.If()):J?this.Fh.Vda(this.gridView,-1293291468,ja,J):(this.Fh.formatCells(-1293291468,ja,C),this.I_a());return!0};wd.prototype.Icc=function(e,C,J,ja){var Aa=-803000997===e||1688184685===e?"black":C.Color;this.moreColorsHelper&&(-1832800737===e?Aa=E.a.compare(Aa,"WindowText",!0)?this.moreColorsHelper.lGb:"black":J||(this.moreColorsHelper.lGb=Aa,this.moreColorsHelper.Wca(C,Aa,ja)));e=wd.vvc(32);
e.Font.FontColor=Ae.a.kH(Aa,Ng.a.yg(C,"IntColor"));this.Eb&&this.gridView.isEditing?this.Qnb(ja,J,e,17===ja.df):J?this.Fh.Vda(this.gridView,1970784898,e,J):(this.PC&&(J=this.getThemeColor(C),C=J.themeColor,J.returnValue&&(e.Font.ThemeFontColor=C,e.Font.ColorTypeOption=1)),this.Fh.formatCells(1970784898,e,ja),this.I_a());return!0};wd.prototype.D3h=function(e){var C=(new Date).format(748067091===e?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),J=this.gridView.Cj?Lk.a(this.gridView.$):this.gridView.zc;
e=J.textBox;if(this.gridView.isEditing)J.insertText(C);else{var ja=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeEditingModeAfterInsertDateOrTime",!1)?0:1;this.gridView.startEdit(!0,ja);J.text=C;C=C.length;e.oRa(C);e.caretPosition=C}};wd.prototype.E4h=function(){this.gridView.xba(this.gridView.ha.va.activeCell)||this.gridView.Quc||this.gridView.rMa()||this.gridView.Qt(this.gridView.ha.va.activeCell,3,Qi.a.M5e)};wd.prototype.z3h=function(){if(!(this.gridView.Quc||this.gridView.rMa()||
this.gridView.isEditing&&Rh.a.isMac)){var e=this.gridView.ha.va.p4;this.gridView.Ug(ud.v(e,this.$),e,null,null,60,Qi.a.M5e)}};wd.prototype.Y3h=function(e){var C=this;this.d$b=kf.d(this.$.xa.pa);var J=this.$.da.Aa(254,!0);if(this.gridView.e6a)return this.gridView.Gh.VG(!1),!!J;if(!J)return Gd.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.D2(this.Ybd);var ja=String.format(Ca.a.tta,fh.a.current.oo(84));this.gridView.Gh.gu(ja);
e=new hh.a(-911352779,e.method,e.mode,e.df,e.tabName);ja={};this.$.Ka.Yb(e,(ja[Ca.a.silentClipboardAccessFailures]=!0,ja[Ca.a.isFormatPainter]=!0,ja)).continueWith(function(Aa){(6>Aa.status||6===Aa.status&&!Aa.result)&&C.Upb()});this.gridView.e6a=!0;J.tGg(this.Upb);return!0};wd.prototype.bwb=function(e,C,J,ja){var Aa=87208751===e?"-1":C.Color;this.moreColorsHelper&&(1597684571===e?Aa=this.moreColorsHelper.uab:J||(this.moreColorsHelper.uab=Aa===wd.notSet?wd.rWd:Aa,this.moreColorsHelper.Wca(C,Aa,ja)));
e={ValidMembers:64};e.FillColor=Ae.a.kH(Aa,Ng.a.yg(C,"IntColor"));J?this.Fh.Vda(this.gridView,1650812936,e,!0):(this.PC&&(J=this.getThemeColor(C),C=J.themeColor,J.returnValue&&(e.ThemeFillColor=C,e.ColorTypeOption=1)),this.Fh.formatCells(1650812936,e,ja),this.I_a());return!0};wd.prototype.o4h=function(){Gd.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var e=this.$.da.Aa(221);if(e){var C=this.gridView.xj;if(C){var J=e.fdi(C.text,
C.textBox.caretPosition);var ja=J.ksf;var Aa=J.zUe;(J=J.returnValue)?(e.isListVisible=!1,C.text=J,C.textBox.selectRange(ja,ja+Aa),Gd.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):Gd.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else Gd.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else Gd.ULS.sendTraceTag(537159492,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};wd.prototype.X3h=function(e,C){var J=0,ja=this.gridView,Aa=Zi.a(ja.wc(null));this.Eb&&ja.isEditing&&(Aa.Font=ja.xj.H3a(Aa.Font));var gb=Aa.Font;gb||(gb={ValidMembers:0});switch(e){case -287251124:J|=4;Dj.e(gb,4)?gb.Bold=!gb.Bold:gb.Bold=!0;break;case -1925065947:J|=8;Dj.e(gb,8)?gb.Italic=!gb.Italic:gb.Italic=!0;break;case 1764140053:J|=16;Dj.e(gb,16)?gb.Underline=!gb.Underline:gb.Underline=!0;break;case -1685033574:J|=
64;Dj.e(gb,64)?gb.DoubleUnderline=!gb.DoubleUnderline:gb.DoubleUnderline=!0;break;case -1590502662:J|=128,Dj.e(gb,128)?gb.Strikethrough=!gb.Strikethrough:gb.Strikethrough=!0}if(!J)return!1;gb.ValidMembers=J;Aa.Font=gb;Aa.ValidMembers=16;this.Eb&&this.gridView.isEditing?this.Qnb(C,!1,Aa):(xe.EwaSettings.la(684)||ja.Gh.VG(!1),this.Fh.formatCells(e,Aa,C));this.$.If();return!0};wd.prototype.h3h=function(e,C){var J=0,ja=this.gridView,Aa=Zi.a(ja.wc(null));-571165336===e||1041132226===e||-394785302===e?
(J|=1,Aa.VerticalAlignment=Ng.a.Rn(wd.UYa,e.toString(),2)):wd.Eji(e)?(J|=2,this.g4h(Aa,e)):-1116189897===e&&(J|=8,Aa.Wrap=Aa.ValidMembers&8?!Aa.Wrap:!0);if(!J)return!1;Aa.ValidMembers=J;xe.EwaSettings.la(684)||ja.Gh.VG(!1);this.Fh.formatCells(e,Aa,C);this.$.If();return!0};wd.prototype.g4h=function(e,C){!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==C&&(C=-1150205178===C?-286432209:-1150205178);C=Ng.a.Rn(wd.UYa,C.toString(),
0);e.HorizontalAlignment=C===e.HorizontalAlignment?0:C};wd.prototype.uKf=function(e,C,J,ja){var Aa=this,gb=!1;xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(gb=this.Qkc.Dqf(C,J))&&Oe.g(this.$).Li.L0(this.y8a,Wg.BasicTelemetryCalculator.cR);return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.baa(e,C,!1,gb,function(bc){Aa.EPi(bc,J,C,gb,ja)}):this.baa(e,C,!1,gb,function(bc,
Mc,Hc){Aa.GPi(bc,Mc,Hc,J,C,gb,ja)})};wd.prototype.handleMergeCellsCommand=function(e,C){var J=this;this.y8a=ph.a.create().toString();var ja=null;ja=this.Qkc.K0e();var Aa=xk.a(C.command),gb=this.Qkc.Ahi(C.command,ja),bc=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),Mc=0;bc&&gb?Mc=Vf.a.xe():Oe.g(this.$).Li.z7(4,this.y8a,Aa+", Scenario = "+ja.scenario.toString());Aa=e.ha.va.selectedRanges;Gd.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",
ih.b().ti(C.command),Aa.length,ud.i(Aa,",",this.$,!1));Aa=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);e.Gh.VG(!1,Aa);if(10===Ng.a.Rn(wd.Fqf,C.command.toString(),10))return Tf.Task.Ta(!1);var Hc=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Aa&&Hc)return gb?(bc?this.ARd(ja,C,!0,!0,Mc):this.ARd(ja,C,!0),Tf.Task.Ta(!0)):this.uKf(e,C,ja,!1);var yd=!1;Aa&&(yd=this.Qkc.Dqf(C,ja))&&Oe.g(this.$).Li.L0(this.y8a,
Wg.BasicTelemetryCalculator.cR);return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.baa(e,C,!1,yd,function(we){J.FPi(we,C,yd)}):this.baa(e,C,!1,yd,function(we,$e,Gf){J.HPi(we,$e,Gf,C,yd)})};wd.prototype.baa=function(e,C,J,ja,Aa){function gb(Gf,ag,Nf){Hc.$.ny();Gf=Aa?Jf.b(Gf,Aa):Gf;Gf=Jf.b(Gf,bc);return jg.f(Hc.$.na.ta,we,$e,J,Gf,ag,Nf,null,yd)}function bc(Gf){var ag=!!Gf&&!!Gf.RequestTelemetryData;Oe.g(Hc.$).Li.wla(Hc.y8a,
Gf.StateId,ag?Gf.RequestTelemetryData.EcsOperationDuration:0,ag?Gf.RequestTelemetryData.EcsRequestDuration:0,ag?Gf.RequestTelemetryData.WfeRequestDuration:0)}function Mc(){return new Cb(we,$e)}var Hc=this;Aa=void 0===Aa?null:Aa;var yd=this.$.na.ta.$b(),we=Ng.a.Rn(wd.Fqf,C.command.toString(),10),$e=ud.r(e.ha.va.selectedRanges,e.$);return ja?xe.EwaSettings.tc()?Hh.a(this.$.userOperationManager,gb,function(Gf){return new Sf.a(156,0,Gf,64,Mc)},C):Hh.a(this.$.userOperationManager,gb,function(Gf){return new uf.a(156,
0,Gf,void 0,Mc)},C):Hh.a(this.$.userOperationManager,gb,function(Gf){return new Sf.a(156,0,Gf,void 0,Mc)},C)};wd.prototype.ARd=function(e,C,J,ja,Aa){var gb=this;ja=void 0===ja?!1:ja;Aa=void 0===Aa?0:Aa;Gd.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",J);var bc=Oe.g(this.$).rtl,Mc=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");bc=dh.a.jd(3,2,0,bc?628:627,0,514846606,"MergeCellsLoseData");Pd.TaskExtensions.Ba(xi.a(this.$).ui(bc),
function(Hc){Hc=Hc.result;if(ja){var yd=Vf.a.xe()-Aa;Gd.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",yd,Hc)}0===Hc?(Gd.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),J?(ja&&Mc&&(Hc=xk.a(C.command),Oe.g(gb.$).Li.z7(4,gb.y8a,Hc+", Scenario = "+e.scenario.toString())),gb.uKf(Oe.g(gb.$),C,e,!0)):gb.baa(gb.gridView,C,!0,!1)):1===Hc&&Gd.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},
this.$.ma,11)};wd.prototype.zmf=function(e,C,J,ja){C!==e&&Gd.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",C,e,J,ja)};wd.prototype.FPi=function(e,C,J){var ja=this;xh.b(e,514846606)&&(Gd.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Ij.a(this.$).rd.XD(514846606),e=Oe.g(this.$).rtl,e=dh.a.jd(3,2,0,e?628:627,
0,514846606,"MergeCellsLoseData"),Pd.TaskExtensions.Ba(xi.a(this.$).ui(e),function(Aa){Aa=Aa.result;0===Aa?(Gd.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),ja.baa(ja.gridView,C,!0,J)):1===Aa&&Gd.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ma,11))};wd.prototype.HPi=function(e,C,J,ja,Aa){new te(this,e,C,J,ja,Aa)};wd.prototype.EPi=function(e,C,J,ja,Aa){var gb=this,bc=!1;xh.b(e,514846606)&&(bc=!0,Ij.a(this.$).rd.XD(514846606),ja&&Aa?
window.setTimeout(function(){gb.baa(gb.gridView,J,!0,!0)},0):this.ARd(C,J,!1));this.zmf(bc,Aa,C.scenario,ja)};wd.prototype.GPi=function(e,C,J,ja,Aa,gb,bc){new oe(this,e,C,J,ja,Aa,gb,bc)};wd.prototype.hpb=function(e){var C=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(C&&this.g_a!==e&&1461300262!==this.g_a){this.nUf(this.g_a);var J=ih.b().ti(e),ja=ih.b().ti(this.g_a);Gd.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",
ja,J)}C&&(this.g_a=e);if(this.Eb&&this.gridView.isEditing)this.c_a||(this.c_a=this.gridView.xj.formattedText);else if(!this.uA){this.uA=[];C=this.gridView.K$("GridCommandHandler.CacheFontStyles",this.gridView.ha.va.selectedRanges);try{for(C.$$rst();C.$$mn();){var Aa=C.$$cu(),gb=Aa.cell.hasRichText;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var bc=ih.b().ti(e);Gd.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",
bc,gb,this.uA.length)}if(gb)Array.add(this.uA,Ke.sRg(Aa,Aa.cell.formattedText));else switch(e){case 673562736:case -446735083:Array.add(this.uA,Ke.PYc(Aa,Aa.backgroundColor));xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Aa.backgroundColor&&Gd.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!Aa.backgroundColor);break;case -128950598:case 1688184685:Array.add(this.uA,Ke.PYc(Aa,Aa.color));
xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Aa.color&&Gd.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Aa.color);break;case 909774670:Array.add(this.uA,Ke.tRg(Aa,Aa.fontSize));if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Mc=Sk.c(Aa.fontSize)?"null or undefined":Aa.fontSize.toString();Gd.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",
Mc)}break;case 324978188:this.kn?Array.add(this.uA,Ke.rRg(Aa,Aa.fontName,Aa.Baa)):Array.add(this.uA,Ke.PYc(Aa,Aa.fontName)),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Aa.fontName?Gd.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Aa.fontName),Aa.fontName.length):Gd.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",
!Aa.fontName))}}}finally{C&&C.dispose()}}};wd.prototype.MDj=function(){return this.Eb&&this.gridView.isEditing?!this.c_a:!this.uA};wd.prototype.wgi=function(e){return!!this.uA&&this.uA.length>e&&!!this.uA[e].formattedText};wd.prototype.T$b=function(e){return this.uA[e].style};wd.prototype.KLh=function(e){return this.uA[e].size};wd.prototype.JLh=function(e){return this.uA[e].Baa};wd.prototype.nUf=function(e){if(this.MDj())xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
Gd.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",e);else{if(this.Eb&&this.gridView.isEditing)xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(e=ih.b().ti(e),Gd.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",e)),this.c_a&&(this.gridView.zc.formattedText=this.c_a);else for(var C=this.uA.length,
J=0;J<C;J++){var ja,Aa=this.uA[J].yJa.cell.getRange();if(ja=this.gridView.wc(Aa)){Aa=void 0;var gb=ja.LH?this.gridView.JIb(ja.range):(Aa=new va.a,Aa.add(ja),Aa);Aa=yl(gb);for(gb=Aa.next();!gb.done;gb=Aa.next()){gb=gb.value;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var bc=ih.b().ti(e);Gd.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
bc,gb.cell.hasRichText,J,ja.LH,C)}if(gb.cell.hasRichText&&1457172838!==e)this.wgi(J)&&(gb.cell.formattedText=this.uA[J].formattedText,xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!gb.cell.formattedText&&Gd.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(e){case 1457172838:gb.backgroundColor=this.T$b(J);xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!gb.backgroundColor&&Gd.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!gb.backgroundColor);break;case 2036397036:gb.color=this.T$b(J);xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!gb.color&&Gd.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!gb.color);break;case -1904244080:gb.fontSize=this.KLh(J);
xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(gb=Sk.c(gb.fontSize)?"null or undefined":gb.fontSize.toString(),Gd.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",gb));break;case -1428968098:bc=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),this.kn?(gb.FJb(this.T$b(J),bc,"RestoreCachedStyles"),gb.e_f(this.JLh(J))):gb.FJb(this.T$b(J),bc,"RestoreCachedStyles")}}}else Gd.ULS.sendTraceTag(537159441,
0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",Aa.DC(!1))}xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.g_a=1461300262);this.I_a()}};wd.prototype.I_a=function(){this.Eb&&this.gridView.isEditing?this.c_a=null:this.uA=null;xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Gd.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};wd.prototype.m4h=
function(e,C){var J={IndentationIncrease:0};if(-1942512156===e)J.IndentationIncrease=1;else if(-1920201820===e)J.IndentationIncrease=-1;else return!0;J.ValidMembers=256;this.Fh.formatCells(e,J,C);return!0};wd.prototype.j4h=function(){var e=this,C=Oe.g(this.$),J=ud.r(C.ha.va.selectedRanges,this.$),ja=ud.o(C.ha.va.activeCell,this.$);Gd.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return Hh.a(this.$.userOperationManager,function(Aa,gb,bc){return jg.L(e.$.na.ta,
ja,J,Aa,gb,bc,null)},function(Aa){return new Sf.a(201,0,Aa)},null)};wd.prototype.W6e=function(e,C){var J=null,ja=Oe.g(this.$).ha.va.selectedRanges;ja=this.gridView.K$("MoreColors",ja,1,!0);try{for(ja.$$rst();ja.$$mn();){var Aa=ja.$$cu().cell;if(Aa){var gb=wd.black;if(1970784898===e)gb=Aa.color;else if(1650812936===e){var bc=Aa.backgroundColor;gb=E.a.compare(bc,wd.rWd,!0)&&E.a.compare(bc,wd.empty,!0)?Aa.backgroundColor:wd.white}if(!J)J=gb;else if(J!==gb){J=wd.black;break}}}}finally{ja&&ja.dispose()}this.Eb&&
this.gridView.isEditing&&1970784898===e&&this.gridView.xj.textBox.hue();return this.moreColorsHelper.uxa(e,C,J)};wd.prototype.A4h=function(e){var C=Dg.a.b4a(this.borderFormatManager.u3);return this.moreColorsHelper.uxa(-236759591,e,C)};wd.prototype.Qnb=function(e,C,J,ja){var Aa=this;ja=void 0===ja?!1:ja;C?this.gridView.xj.uJf(J.Font):(this.bxi(e),ja?window.requestAnimationFrame(function(){Ck.FocusManager.instance().dk(fk.AFrame.xia);Aa.gridView.xj.HVe(J.Font)}):(Ck.FocusManager.instance().dk(fk.AFrame.xia),
this.gridView.xj.HVe(J.Font)),this.I_a())};wd.prototype.bxi=function(e){var C=xk.a(e.command);e=al.a[e.df]+"_"+Rk.a[e.method];var J=this.gridView.qc.Ixe.toString(),ja=new Map;ja.set("Command",C);ja.set("Source",e);ja.set("Ribbon","React");ja.set("CellTextRuns",J);bl.Health.instance.recordKpiUsage(hl.a.tFh,0,sk.a.MUf,ja)};wd.prototype.xid=function(e,C,J){e=this.borderFormatManager.xid(e,C,J);this.moreColorsHelper&&this.moreColorsHelper.Wca(C,this.borderFormatManager.u3,J);return e};wd.prototype.getThemeColor=
function(e){var C={};var J=!1;if((e.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return Gd.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:C};J=this.themesManager.getThemeColor(e.Color);e=J.themeIndex;var ja=J.dBa;if(J=J.returnValue)C.ThemeColorIndex=e,C.ThemeColorRow=ja}return{returnValue:J,themeColor:C}};wd.Eji=function(e){return-1150205178===e||-1142465846===e||-286432209===e};wd.vvc=function(e){var C=
{},J={};C.ValidMembers=16;C.Font=J;J.ValidMembers=e;return C};wd.a_e=function(e,C){var J=e.top<C.top?3:e.bottom>C.bottom?0:-1;return J=e.left<C.left?1:e.right>C.right?2:J};Qk.Object.defineProperties(wd.prototype,{Dhf:{configurable:!0,enumerable:!0,get:function(){return gh.a.all(this.gridView.ha.va.selectedRanges,function(e){return e.isRow})}},zhf:{configurable:!0,enumerable:!0,get:function(){return gh.a.all(this.gridView.ha.va.selectedRanges,function(e){return e.Rh})}},themesManager:{configurable:!0,
enumerable:!0,get:function(){this.ax||(this.ax=this.$.da.Aa(422));return this.ax}}});Qk.Object.defineProperties(wd,{f0i:{configurable:!0,enumerable:!0,get:function(){return wd.Tde||(wd.Tde=RegExp("^[0-9]+[.]?[0-9]*$"))}},fmd:{configurable:!0,enumerable:!0,get:function(){var e={};return wd.v8d||(wd.v8d=(e.InsertRows=5,e.InsertColumns=9,e.InsertCellsShiftRight=17,e.InsertCellsShiftDown=33,e.DeleteRows=6,e.DeleteColumns=10,e.DeleteCellsShiftLeft=18,e.DeleteCellsShiftUp=34,e.DeleteRowsTable=6,e.DeleteColumnsTable=
10,e.InsertRowsTable=5,e.InsertColumnsTable=9,e))}},UYa:{configurable:!0,enumerable:!0,get:function(){var e={};return wd.sgb||(wd.sgb=(e["-394785302"]=0,e["-571165336"]=2,e["1041132226"]=1,e["-1150205178"]=1,e["-1142465846"]=2,e["-286432209"]=3,e))}},Fqf:{configurable:!0,enumerable:!0,get:function(){var e={};return wd.ibe||(wd.ibe=(e["-167499203"]=2,e["-255094134"]=5,e["1097660126"]=6,e["155820588"]=7,e))}}});wd.rWd="transparent";wd.notSet="-1";wd.black="#000000";wd.empty="";wd.white="#FFFFFF";wd.v8d=
null;wd.sgb=null;wd.ibe=null;wd.Tde=null;wd.wJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(Md.a)(wd,"GridCommandHandler",null,[239]);var cl=cf.a;vm(fd,cl);fd.prototype.Pd=function(){var e=this;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var C=Zg.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.ub),J=Zg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub),ja=Zg.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.ub),Aa=Zg.GetServiceTaskFactory.Wa(this.$.da,
296,468,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([C,J,ja,Aa],this.ma),function(){e.Gd([new wd(e.$,Oe.g(e.$),J.result,C.result,Aa.result,ja.result)])},this.ma,3)}else{var gb=Zg.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.ub),bc=Zg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub),Mc=Zg.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.ub),Hc=Zg.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([gb,bc,Mc,Hc],this.ma),
function(){e.Gd([new wd(e.$,Oe.g(e.$),bc.result,gb.result,new nk.BorderFormatManager(e.$,bc.result,Mc.result),Hc.result)])},this.ma,3)}};fd.ka=function(e){cf.a.he(80,new fd(e))};Object(Md.a)(fd,"GridCommandHandlerFactory",cf.a,[]);var Hi=b(28),ak=b(203),Dk=b(1186);Rb.prototype.dispose=function(){var e=this;this.deactivate();this.gridView&&(this.tableManager.jRf(this.WBf),this.gridView.Ecj(this.lzf),this.gridView.Fcj(this.mzf),this.$.xa.ug(this.Re),this.$.zb.ug(this.Re),this.Lre(function(C){C.GJd(e.TKa)}));
this.gridView=this.tableManager=this.Hga=null};Rb.prototype.Szc=function(e,C,J,ja){if(!kf.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.$a.gTa)return!0;if(!J.length)return!1;var Aa=ja.length;if(ja[Aa-1]<e.left)return!1;var gb=Lb.HelperMethods.mx(new ak.a(ja),0,Aa,e.left,Lb.HelperMethods.UC);if(0>gb)return!1;var bc=e.l$f,Mc=!!e.A0b&&0<e.A0b.length,Hc=!!e.menuModel&&0<e.menuModel.length,yd=gb,we=0;for(Aa=Math.min(bc.length+gb,Aa);yd<Aa;yd++,we++)if(gb=J[yd],!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||
gb){var $e=null,Gf=gb.getElementsByClassName(Hi.a.j$c);Gf&&($e=Gf[0]);if($e&&$e.innerText){if(Gf=gb.getElementsByClassName(Hi.a.wpe))for(var ag=Gf.length-1;0<=ag;ag--)gb.removeChild(Gf[ag]);Gf=ja[yd];C?($e.innerText=bc[we],gb.classList.add(Hi.a.iRe),Mc&&e.A0b[we]&&($e=document.createElement("div"),$e.innerHTML=e.A0b[we],Hc&&e.menuModel[we]&&this.SBg(e,we,Gf),gb.appendChild($e.firstChild))):(gb.classList.remove(Hi.a.iRe),$e.textContent=Yg.Range.qU(Gf),this.tih(Gf))}}e.pSa=C;return!0};Rb.prototype.SBg=
function(e,C,J){this.$.da.Za(8,function(ja){ja.m9b.PNi(e,C,J)})};Rb.prototype.tih=function(e){this.$.da.Za(8,function(C){C.m9b.QNi(e)})};Rb.prototype.S5f=function(e,C,J,ja){for(var Aa=!1,gb=this.C0h(e,C),bc=this.Hga.length-1;0<=bc;bc--){var Mc=this.Hga[bc];C>=Mc.left&&e<=Mc.right&&(this.Szc(Mc,!1,J,ja),Array.removeAt(this.Hga,bc),Aa=!0)}e=0;for(C=gb.length;e<C;e++)this.Szc(gb[e],!0,J,ja)&&(Array.add(this.Hga,gb[e]),Aa=!0);return Aa};Rb.prototype.activate=function(){this.ue()&&!this.active&&(this.gridView.view.Ls(this.xw),
this.active=!0)};Rb.prototype.deactivate=function(){this.active&&(this.gridView.view.Mq(this.xw),this.active=!1)};Rb.prototype.ue=function(){return kf.b(this.$.pa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.$a.bP&&0<this.tableManager.rangeList.length};Rb.prototype.Lre=function(e){var C=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.gridView.Xoc:[this.gridView.h3];C=yl(C);for(var J=C.next();!J.done;J=C.next()){J=yl(J.value);for(var ja=
J.next();!ja.done;ja=J.next()){ja=yl(ja.value);for(var Aa=ja.next();!Aa.done;Aa=ja.next())e(Aa.value)}}};Rb.prototype.C0h=function(e,C){var J=[];if(!this.active)return J;this.dNa=this.gridView.zhd();for(var ja=this.tableManager.rangeList.length-1;0<=ja;ja--){var Aa=this.tableManager.rangeList[ja];Aa.bottom>=this.dNa&&this.yhd(Aa)<=this.dNa&&Aa.left>=e&&Aa.right<=C&&Aa.Sva&&Array.add(J,Aa)}return J};Rb.prototype.yhd=function(e){var C=this.gridView.Sb.Wj(e);return C&&this.tableManager.Jef(e,C.usedRange.topLeft)?
e.top+1:e.top};Object(Md.a)(Rb,"HeaderSnappingFeature",null,[2]);var ug=Bh.a;vm(Zc,ug);Zc.prototype.create=function(){var e=this,C=Zg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([C],this.ma),function(){e.Gb(e.$.da.Aa(68)||new Rb(C.result,Oe.g(e.$)))},this.ma,11)};Zc.ka=function(e){e.da.Ha(67,new Zc(e))};Object(Md.a)(Zc,"HeaderSnappingFactory",Bh.a,[]);var tk=b(1239),vi=Bh.a;vm(ld,vi);ld.prototype.create=function(){var e=this,C=this.$.da,J=
Zg.GetServiceTaskFactory.create(C,134,this.ma,this.ub),ja=Zg.GetServiceTaskFactory.Wa(C,213,214,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([J,ja],this.ma),function(){var Aa=C.Aa(1);Aa||(Aa=new tk.CellAutoCompleteControl(e.$,J.result),ja.result.ka(Aa));e.Gb(Aa)},this.ma,3)};ld.ka=function(e){e.da.Ha(151,new ld(e))};Object(Md.a)(ld,"CellAutoCompleteControlFactory",Bh.a,[]);od.prototype.dispose=function(){this.oXd();this.xZa=null};od.prototype.ka=function(e){e&&(this.xZa=e,e.bVc(this.bCf),e.C2(this.cCf),
e.CFg(this.dCf))};od.prototype.oXd=function(){this.xZa&&(this.xZa.iJd(this.bCf),this.xZa.kda(this.cCf),this.xZa.Pcj(this.dCf))};Object(Md.a)(od,"CellAutoCompleteReadoutHandler",null,[413,2]);var Tk=Bh.a;vm(mc,Tk);mc.prototype.create=function(){var e=this,C=this.$.da;Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.Wa(C,211,212,this.ub),function(J){J=C.Aa(213)||new od(J.result,C);e.Gb(J)},this.ma,3)};mc.ka=function(e){e.da.Ha(214,new mc(e))};Object(Md.a)(mc,"CellAutoCompleteReadoutHandlerFactory",Bh.a,
[]);Xb.Poh="ewa-dv";Xb.Qoh="ewa-dv-buttonarea";Xb.Xnh="ewa-dlb";Xb.UAb="list-table";Xb.listItem="list-item";Xb.RAb="list-item-selected";Xb.VAb="list-table-touch";Xb.Ooh="ewa-dpb";Xb.Iih="dv-prompt-title";Xb.Hih="dv-prompt-message";Object(Md.a)(Xb,"CssClassNames",null,[]);var uk=b(522),Ek=b(45),Di=b(431),Fk=b(960),Jj=jh.ErrorDialog;vm(Va,Jj);Va.prototype.dispose=function(){Oe.g(this.$).ha.UF(this.od);Jj.prototype.dispose.call(this)};Va.prototype.setFocus=function(){switch(this.error.Severity){case 0:var e=
4;break;case 1:e=3;break;case 2:e=0;break;default:e=this.closeAction}(e=this.getButton(e))?e.get_element().focus():Jj.prototype.setFocus.call(this)};Va.prototype.nqb=function(){var e=Oe.g(this.$);e.isEditing&&e.zc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.lTd(1);if(2===this.returnValue||0===this.returnValue){var C=e.wc(null);if(C){e.Ca.IV();var J=Object.assign(new Hd.a,{Text:C.originalText});e.setCell(J,C.range,0,63,null)}this.$.ye(-798660877,
If.a.dc,8,null)}Jj.prototype.nqb.call(this)};Va.prototype.EGa=function(){var e=Oe.g(this.$);e.isEditing&&e.zc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.lTd(0);Jj.prototype.EGa.call(this)};Va.prototype.lTd=function(e){var C=Oe.g(this.$);Pd.TaskExtensions.Ba(C.startEdit(!1,e),function(){var J=C.zc.textBox;J.text&&J.selectRange(0,J.text.length)},this.ma,11,Df.a.current)};Va.TQ=function(e,C,J){J=C.da.Aa(14).v3a(J);e.MessageId=-1083021405;e.MessageIdName=
"DataValidationError";e.MessageIdHash=Dg.a.Qv(e.MessageIdName);e.Severity=J?J.R8c:1;C=(null===J||void 0===J?0:J.OIa)?Dg.a.Lf(J.OIa):null;J=(null===J||void 0===J?0:J.error)?Dg.a.Lf(J.error):String.format("<p>{0}</p><p>{1}</p>",ue.a.instance.fa(877),ue.a.instance.fa(878));switch(e.Severity){case 0:e.Appearance=18;break;case 1:e.Appearance=12;J+=String.format("<p>{0}</p>",ue.a.instance.fa(879));break;default:e.Appearance=3}e.Caption=C;e.Description=J;e.HelpDescription=ue.a.instance.fa(1276);e.HelpTopicId=
Fk.a.pGe;return e};Object(Md.a)(Va,"DataValidationErrorDeprecatedDialog",jh.ErrorDialog,[]);var il=b(180),pk=b(166),Gk=aj.a;vm(sa,Gk);sa.prototype.dispose=function(){this===this.Ab.Lp&&(this.Ab.Lp=null);fg.a.Fa(this.wm);this.wm=null;Gk.prototype.dispose.call(this)};sa.prototype.Yqj=function(){this.Gu&&this.Gu.error?this.errorMessage=this.Gu.error:this.Gu&&this.Gu.options&1?(Gd.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),
this.errorMessage=ue.a.instance.fa(1689),this.V8e=fh.a.current.oo(96)):(this.errorMessage=ue.a.instance.fa(1688),this.mOh(this.DMe));var e=this.Gu?this.Gu.R8c:1,C={};this.T$=(C[sa.Zy]=this.Bc,C.errorDescription=this.errorMessage,C.helpImageUri=this.V8e,C);switch(e){case 0:this.kc=1;this.Gc(1,"Retry");this.T$.dialogIcon=2;this.hhf=!0;break;case 1:this.kc=4;this.T$.dialogIcon=1;this.T$.additionalInformation=ue.a.instance.fa(879);break;default:this.kc=1,this.T$.dialogIcon=3}e={};this.T$.helpLink=(e.type=
"AppLinkProps",e[sa.Zy]=this.error.HelpTopicId,e.text=ue.a.instance.fa(1276),e.handler=this.p9a,e);e=dh.a.HWc([this.error]);C={};this.WU=(C[Ca.a.X8b]=!0,C[Ca.a.fad]=e,C[Ca.a.gad]=pk.a(this.$).Jsb(this.error.MessageIdHash),C[Ca.a.oZ]=this.Bc,C.DismissHandler=this.$zd,C);e={};this.T$.giveFeedbackLink=(e.type="AppLinkProps",e[sa.Zy]=Ca.a.Zhd,e.text=ue.a.instance.fa(1725),e.handler=this.JNi,e)};sa.prototype.mOh=function(e){var C=this.$.na.ta.$b();jg.u(this.$.na.ta,ud.q(e,this.$),Jf.b(this.gMi),Jf.a(this.fMi),
null,C)};sa.prototype.iYh=function(e){switch(e.RuleType){case 1:switch(e.ConditionType){case 0:var C=ue.a.instance.Cb(107);return String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=ue.a.instance.Cb(108),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=ue.a.instance.Cb(109),String.format(C,e.LowerBoundary);case 3:return C=ue.a.instance.Cb(110),String.format(C,e.LowerBoundary);case 4:return C=ue.a.instance.Cb(111),String.format(C,e.LowerBoundary);case 5:return C=ue.a.instance.Cb(112),
String.format(C,e.UpperBoundary);case 6:return C=ue.a.instance.Cb(113),String.format(C,e.LowerBoundary);case 7:return C=ue.a.instance.Cb(114),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(e.ConditionType){case 0:return C=ue.a.instance.Cb(115),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=ue.a.instance.Cb(116),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=ue.a.instance.Cb(117),String.format(C,e.LowerBoundary);case 3:return C=
ue.a.instance.Cb(118),String.format(C,e.LowerBoundary);case 4:return C=ue.a.instance.Cb(119),String.format(C,e.LowerBoundary);case 5:return C=ue.a.instance.Cb(120),String.format(C,e.UpperBoundary);case 6:return C=ue.a.instance.Cb(121),String.format(C,e.LowerBoundary);case 7:return C=ue.a.instance.Cb(122),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(e.ConditionType){case 0:return C=ue.a.instance.Cb(123),String.format(C,e.LowerBoundary,e.UpperBoundary);
case 1:return C=ue.a.instance.Cb(124),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=ue.a.instance.Cb(125),String.format(C,e.LowerBoundary);case 3:return C=ue.a.instance.Cb(126),String.format(C,e.LowerBoundary);case 4:return C=ue.a.instance.Cb(127),String.format(C,e.LowerBoundary);case 5:return C=ue.a.instance.Cb(128),String.format(C,e.UpperBoundary);case 6:return C=ue.a.instance.Cb(129),String.format(C,e.LowerBoundary);case 7:return C=ue.a.instance.Cb(130),String.format(C,e.UpperBoundary);
default:return"we couldn't get the details"}case 5:switch(e.ConditionType){case 0:return C=ue.a.instance.Cb(131),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=ue.a.instance.Cb(132),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=ue.a.instance.Cb(133),String.format(C,e.LowerBoundary);case 3:return C=ue.a.instance.Cb(134),String.format(C,e.LowerBoundary);case 4:return C=ue.a.instance.Cb(135),String.format(C,e.LowerBoundary);case 5:return C=ue.a.instance.Cb(136),String.format(C,
e.UpperBoundary);case 6:return C=ue.a.instance.Cb(137),String.format(C,e.LowerBoundary);case 7:return C=ue.a.instance.Cb(138),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(e.ConditionType){case 0:return C=ue.a.instance.Cb(139),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=ue.a.instance.Cb(140),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=ue.a.instance.Cb(141),String.format(C,e.LowerBoundary);case 3:return C=ue.a.instance.Cb(142),
String.format(C,e.LowerBoundary);case 4:return C=ue.a.instance.Cb(143),String.format(C,e.LowerBoundary);case 5:return C=ue.a.instance.Cb(144),String.format(C,e.UpperBoundary);case 6:return C=ue.a.instance.Cb(145),String.format(C,e.LowerBoundary);case 7:return C=ue.a.instance.Cb(146),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 3:return C=ue.a.instance.Cb(105),String.format(C,e.LowerBoundary);case 7:return C=ue.a.instance.Cb(106),String.format(C,e.LowerBoundary);
default:return"we couldn't get the details"}};sa.prototype.lTd=function(e){var C=Oe.g(this.$);Pd.TaskExtensions.Ba(C.startEdit(!1,e),function(){var J=C.zc.textBox;J.text&&J.selectRange(0,J.text.length)},this.ma,11,Df.a.current)};sa.TQ=function(e,C,J){C=C.da.Aa(14).v3a(J);e.MessageId=-1083021405;e.MessageIdName="DataValidationError";e.MessageIdHash=Dg.a.Qv(e.MessageIdName);e.Severity=C?C.R8c:1;e.HelpDescription=ue.a.instance.fa(1276);e.HelpTopicId=Fk.a.pGe;return e};Qk.Object.defineProperties(sa.prototype,
{Bc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},ma:{configurable:!0,enumerable:!0,get:function(){this.wm=this.wm||new il.a;return this.wm.token}}});Object(Md.a)(sa,"DataValidationErrorDialog",aj.a,[98,99,2,100]);var gk=b(1043),zk=b(384),kk=gk.a;vm(Nb,kk);Nb.prototype.dispose=function(){this.dataValidationControl=null;kk.prototype.dispose.call(this)};Nb.prototype.Qh=function(e,C){this.dataValidationControl.Ya=this.Ya;var J=e.keyCode;return 1461300262!==C||16!==
J&&17!==J&&18!==J?kk.prototype.Qh.call(this,e,C):!1};Nb.prototype.ezd=function(){this.NV&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.lR,!0,!0,Rh.a.Wp||3===If.a.dc))};Nb.prototype.Jg=function(){};Nb.prototype.ej=function(){this.dataValidationControl.show(this.dataValidationControl.lR,!0,!0,Rh.a.Wp||3===If.a.dc)};Nb.prototype.AFd=function(e,C){return this.dataValidationControl.Qh(C)};Qk.Object.defineProperties(Nb.prototype,{nyb:{configurable:!0,
enumerable:!0,get:function(){return Object(nf.a)(sa,this.$.Ab.hh)}},NV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(e){this.dataValidationControl.isListVisible=e}},qLa:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return zk.a.w5c}}});Object(Md.a)(Nb,"DataValidationListAutoCompleteBehavior",gk.a,[]);var Hk=b(977),bj=b(1042),Mk=Hk.a;vm(Ib,Mk);Ib.prototype.dispose=function(){Mk.prototype.dispose.call(this);
this.U7a=this.rlb=null};Ib.prototype.wea=function(e,C,J,ja){if(e&&(!e||e.length)){this.G7(!1);this.UHa=e;this.$V=[];for(var Aa=0;Aa<e.length;Aa++)this.$V[Aa]=e[Aa]?e[Aa].Name:null;Aa=String.format("<table class='{0}' aria-live='polite'><tbody>",this.Rba);var gb="",bc="";e=0;var Mc=Oe.g(this.$).wc(null);ja=this.isEditing?ja?ja.text:this.editText:Mc?Mc.originalText:null;Mc=!ja;var Hc=0;Array.clear(this.DEb);var yd=[],we=[],$e=[],Gf=ja?ja.split(" "):[""];ja=ja.trim();for(var ag={},Nf=0;Nf<this.$V.length;ag=
{xDc:ag.xDc},Nf++){var Pg=this.$V[Nf],Jh=void 0;ag.xDc=Pg.split(" ");Jh=gh.a.all(Gf,function(vj){return function(qj){return gh.a.any(vj.xDc,function(Xj){return E.a.yL(Xj,qj)})}}(ag));var jj=!Pg,Xi=Array.contains($e,Pg);jj||Xi||this.isEditing&&!Jh||(Jh=Pg?Dg.a.Lf(Dg.a.t7b(Pg)):"",Jh=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.m_,Jh),Array.add($e,Pg),this.isEditing&&E.a.yL(Pg,ja)?(gb+=Jh,Array.add(yd,Nf)):(bc+=Jh,Array.add(we,Nf)),!Mc&&E.a.equals(ja,Pg,!0)&&(e=this.isEditing?yd.length-
1:Hc,Mc=!0),Hc++)}this.zxa=Hc;Array.addRange(this.DEb,yd);Array.addRange(this.DEb,we);this.gg.innerHTML=Aa+(gb+bc+"</tbody></table>");Aa=this.Gn=Bd.DOMElementExtensions.Aj(this.domElement,this.Rba);this.$mb(Aa,C);this.G7(!0);this.Mra(C,J);this.Lk=0<this.zxa?Aa.rows[e]:null}};Ib.prototype.pRa=function(e){var C=!1;this.isEditing&&e&&(C=!this.zxa,e.endEdit(C,"DataValidationListBox.SetCellContent",0));if(!C&&(e=Oe.g(this.$),C=e.wc(null))){var J=null;this.Cda&&-1!==this.Cda.SheetId&&-1!==this.Cda.Row&&
-1!==this.Cda.Column&&(J={},J.SheetName=this.Cda.SheetId.toString(),J.FirstRow=this.Cda.Row,J.FirstColumn=this.Cda.Column,J={ParameterType:6,SourceRange:J});var ja=Object.assign(new Hd.a,{Text:this.re});e.setCell(ja,C.range,0,63,J)}return!0};Ib.prototype.Mra=function(e,C){var J=e?this.FBb:this.$H;e=e?this.pjc:this.qjc;if(0>=this.zxa)this.gg.style.height=Lb.HelperMethods.Rb(e);else if(this.gg.style.height="auto",this.zxa>J){var ja=this.tdg?Math.floor(e*J):Math.floor(this.gg.offsetHeight*J/this.zxa);
!this.tdg&&this.avi&&Gd.ULS.sendTraceTag(529056667,0,50,"DataValidationListBox.adjustHeightAndWidth:\n            old height: "+ja+",\n            new height: "+Math.floor(e*J)+",\n            maxItems: "+J+", listItemHeight: "+e+", listItemCount: "+this.zxa);Bd.DOMElementExtensions.nG(this.gg,ja);this.gg.style.overflowY="auto"}else this.gg.style.height="auto",this.gg.style.overflowY="hidden";Bd.DOMElementExtensions.Tq(this.gg,C);Bd.DOMElementExtensions.Tq(this.Gn,C-(this.zxa>J?Fi.a.fq:0))};Qk.Object.defineProperties(Ib.prototype,
{Lk:{configurable:!0,enumerable:!0,get:function(){return this.rlb},set:function(e){this.jBa(this.rlb);if(e){this.rlb=e;this.U7a.innerText="";this.jBa(this.rlb);var C=this.DEb[e.rowIndex];this.re=this.$V[C];this.UHa&&(this.Cda=this.UHa[C],Gd.ULS.shipAssertTag(537163286,0,!this.DEb.length||!!this.Cda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.U7a.innerText=this.re;this.uuc(e)}else this.Cda=this.re=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return Oe.g(this.$).isEditing}},
editText:{configurable:!0,enumerable:!0,get:function(){return Oe.g(this.$).zc.text}}});Object(Md.a)(Ib,"DataValidationListBox",Hk.a,[]);var si=b(239),Wj=b(117),Z=b(169),wa=Ah.a;vm(Jc,wa);Jc.prototype.LUc=function(e){this.get_events().addHandler("ClickButton",e)};Jc.prototype.TId=function(e){this.get_events().removeHandler("ClickButton",e)};Jc.prototype.$Uc=function(e){this.get_events().addHandler("KeyDown",e)};Jc.prototype.hJd=function(e){this.get_events().removeHandler("KeyDown",e)};Jc.prototype.XYb=
function(e){this.get_events().addHandler("PointerOver",e)};Jc.prototype.uJd=function(e){this.get_events().removeHandler("PointerOver",e)};Jc.prototype.WYb=function(e){this.get_events().addHandler("PointerOut",e)};Jc.prototype.tJd=function(e){this.get_events().removeHandler("PointerOut",e)};Jc.prototype.enb=function(e){this.get_events().addHandler("Blur",e)};Jc.prototype.WGb=function(e){this.get_events().removeHandler("Blur",e)};Jc.prototype.I9=function(e){this.get_events().addHandler("Focus",e)};
Jc.prototype.ida=function(e){this.get_events().removeHandler("Focus",e)};Jc.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(uk.a.XY),this.domElement.style.cursor="",ej.a.instance.qa(Ue.a.click,this.domElement,this.$c),Wj.KeyInputManager.instance.qa(Ue.a.Tb,this.domElement,this.onKeyDown),Z.a.instance.qa(Ue.a.pointerOver,this.domElement,this.ww),Z.a.instance.qa(Ue.a.pointerOut,this.domElement,this.UN),this.xc.gn("blur")||this.xc.ka("blur",this.onBlur),this.xc.gn("focus")||
this.xc.ka("focus",this.onFocus),this.domElement.title=this.Zkh,this.sl=!0)};Jc.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(uk.a.XY),this.domElement.style.cursor="",this.isEnabled&&(ej.a.instance.za(Ue.a.click,this.domElement,this.$c),Wj.KeyInputManager.instance.za(Ue.a.Tb,this.domElement,this.onKeyDown),Z.a.instance.za(Ue.a.pointerOver,this.domElement,this.ww),Z.a.instance.za(Ue.a.pointerOut,this.domElement,this.UN)),this.domElement.title=this.Ifh,this.sl=!1)};Jc.prototype.dispose=
function(){this.isEnabled&&(ej.a.instance.za(Ue.a.click,this.domElement,this.$c),Wj.KeyInputManager.instance.za(Ue.a.Tb,this.domElement,this.onKeyDown),Z.a.instance.za(Ue.a.pointerOver,this.domElement,this.ww),Z.a.instance.za(Ue.a.pointerOut,this.domElement,this.UN),this.sl=!1);Bd.DOMElementExtensions.setVisible(this.domElement,!1);wa.prototype.dispose.call(this)};Jc.Bb=function(e,C,J,ja,Aa,gb,bc,Mc){e.removeAttribute("Href");e.setAttribute(Ca.a.Ud,Ca.a.Pr);e.className=C;e.tabIndex=Mc;C=document.createElement("span");
C.className=bc;C.classList.add(J);C.tabIndex=-1;e.appendChild(C);e=document.createElement("img");e.src=fh.a.Fe(ja);e.className=Aa;e.alt=gb;e.tabIndex=-1;C.appendChild(e);return e};Qk.Object.defineProperties(Jc.prototype,{Xj:{configurable:!0,enumerable:!0,get:function(){return this.iJ}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.sl}}});Object(Md.a)(Jc,"ListButton",Ah.a,[442,2]);var hb=b(124),Yb="<p class='"+Xb.Iih+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",
Gc="<p class='"+Xb.Hih+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",dd=k.a.ENe,ed=k.a.ENe,Pc=k.a.jZg,Rc=Ah.a;vm(Mb,Rc);Mb.prototype.dispose=function(){this.$&&(this.DLb(!1),this.gridView.ha.fO(this.Lh),this.gridView.ot(this.onContentReady),this.gridView.qc.lcj(this.sxf),this.$.rn(this.qd));this.GEe(!1);this.HEe(!1);fg.a.sc(this.m5b);this.m5b=this.zha=this.gg=this.BW=this.cJ=this.gridView=this.$=null;Rc.prototype.dispose.call(this)};Mb.prototype.f7c=function(e){return!!this.v3a(e)};
Mb.prototype.Rqb=function(e,C){return xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new sa(this.$,e,C):new Va(this.$,e,C)};Mb.prototype.v3a=function(e){e=this.gridView.getRangeInformation(e);for(var C=0;C<e.length;C++){var J=e[C];if(Object(nf.a)(Di.DataValidationRange,J))return J}return null};Mb.prototype.tKh=function(){if(!this.I4a)return"";var e=this.p8e?String.format("{0} {1}",this.Gu.KKf,this.Gu.prompt):"",C=this.vwb?ue.a.instance.fa(825):"";return String.format(ue.a.instance.Cb(17),
e,C)};Mb.prototype.Qh=function(e){var C=!1;if(this.isListVisible||(-569786022===e||541421805===e)&&this.vwb||1872288872===e&&this.lR)switch(e){case -569786022:case 541421805:this.show(this.lR,!this.isListVisible,!0,Rh.a.Wp||3===If.a.dc);C=!0;break;case 1872288872:this.isListVisible?(this.show(this.lR,!1,!0,!1),C=!0):this.lR?(this.show(!1,!1,!0,!1),C=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),C=!0);break;case -798660877:this.Uh.iB(1);C=!0;break;case 137938150:this.Uh.iB(-1);
C=!0;break;case 2091832999:this.Uh.iB(this.Uh.$H-1);C=!0;break;case 742457698:this.Uh.iB(-(this.Uh.$H-1));C=!0;break;case 125627505:case 267796030:C=this.pRa()}return C};Mb.prototype.show=function(e,C,J,ja){this.Lx();if(this.Jzb&&this.I4a){var Aa=this.lOa;if(Aa){if(e||C||J)this.isVisible=!0;Rg.d(this.style,this.isGridRtl);J&&this.vwb&&(this.HEe(!0),this.Vdg(Aa,!1));C&&this.vwb&&this.bSa(ja,Aa);e&&this.p8e&&this.FCj(Aa);this.Soi||(this.isVisible=!1)}}};Mb.prototype.qva=function(e,C){if(!C||!C.cell.hk)return null;
var J=this.gridView.qc.textBox.domElement;var ja=0<Bd.DOMElementExtensions.getHeight(J)&&0<Bd.DOMElementExtensions.getWidth(J)&&0<=J.offsetTop&&0<=J.offsetLeft;if(ja)J=Bd.DOMElementExtensions.qva(J,e.wj);else{J=e.getCellBounds(C.cell);var Aa=Bd.DOMElementExtensions.getBoundingClientRect(e.wj);J=new Sys.UI.Bounds(J.x-Aa.x,J.y-Aa.y,J.width,J.height)}if(J)if(ja)2<J.height&&2<J.height&&(J.x+=1,J.y+=1,J.height-=2,J.width-=2);else if(ja=Oe.g(this.$).YJ(C.cell))ja=ja.width+1,Aa=E.a.equals(si.a.u3a(C.cell,
e.rtl),"right",!0),e.rtl&&Aa&&(J.x=J.x+J.width-ja),C.Uka&&e.rtl===Aa&&(J.width=ja);else return null;return J};Mb.prototype.R3f=function(e){var C=this.I4a;this.DLb(C);C?this.show(!0,e,!0,!1):this.Lx()};Mb.prototype.pRa=function(){var e=!1;this.isListVisible&&(e=this.Uh.pRa(this.Ya),this.show(this.lR,!1,!0,!1));return e};Mb.prototype.Lx=function(){this.Dhi?(this.isListVisible&&(this.isListVisible=!1),this.OLa&&(this.OLa=!1),this.lR&&(this.lR=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=
this.OLa=this.lR=this.isVisible=!1;this.Xod=this.Wmd=this.Ppd=!1};Mb.prototype.bSa=function(e,C){this.vwb&&!this.Gu.UHa?this.OLa&&this.Ih.disable():(this.GEe(!0),this.Uh.wea(this.Gu.UHa,e,this.sTh(C),this.Ya),this.yBa(C,!1))};Mb.prototype.FCj=function(e){this.Gu.prompt&&(this.lR=!0,this.bUj(this.Gu.KKf,this.Gu.prompt),this.oeg(e,!1))};Mb.prototype.Vdg=function(e,C){var J=e.y;this.zha.style.top=Lb.HelperMethods.Rb(J);e=this.isGridRtl?e.x-this.zha.offsetWidth+1:e.x+e.width+1;this.zha.style.left=Lb.HelperMethods.Rb(e);
C?this.OLa=this.gridView.jic(new Ek.a(e,J))&&this.Wmd:this.Wmd=!0};Mb.prototype.yBa=function(e,C){var J=e.y+e.height;e=this.isGridRtl?e.x+e.width-this.gg.offsetWidth:e.x;this.gg.style.top=Lb.HelperMethods.Rb(J);this.gg.style.left=Lb.HelperMethods.Rb(e);C?this.isListVisible=this.gridView.jic(new Ek.a(e,J))&&this.Xod:this.Xod=!0};Mb.prototype.oeg=function(e,C){var J=e.y+e.height+5,ja=this.activeCell;ja=ja?ja.width/2:32;e=this.isGridRtl?e.x-this.BW.offsetWidth+ja:e.x+e.width-ja;this.BW.style.top=Lb.HelperMethods.Rb(J);
this.BW.style.left=Lb.HelperMethods.Rb(e);C?this.lR=this.gridView.jic(new Ek.a(e,J))&&this.Ppd:this.Ppd=!0};Mb.prototype.bUj=function(e,C){if(C){var J="";e&&(J+=String.format(Yb,Dg.a.Lf(e)));J+=String.format(Gc,Dg.a.Lf(C));this.BW.innerHTML=J;e=Bd.DOMElementExtensions.Aj(this.BW,"dv-prompt-titletext");if(C=Bd.DOMElementExtensions.Aj(this.BW,"dv-prompt-messagetext"))for(e=e?parseInt(String(Math.max(e.offsetWidth,C.offsetWidth)),10):C.offsetWidth,e+=6,Bd.DOMElementExtensions.Tq(this.BW,e),C=0,J=this.BW.children.length;C<
J;C++)Bd.DOMElementExtensions.Tq(this.BW.children[C],e)}};Mb.prototype.sTh=function(e){if(this.Ehi)return e.width+17-2+1;var C=this.zha.clientWidth;this.vki&&17!==C&&Gd.ULS.sendTraceTag(528855200,0,15,"DataValidationControl.getListBoxWidth: buttonWidth is "+C);return e.width+C-2+1};Mb.prototype.HEe=function(e){this.$&&!this.Jzb||!e?(this.U7f(!1),fg.a.Fa(this.Ih),this.Ih=null):(this.Ih||(this.Ih=new Jc(this.zha,dd,uk.a.mia,1,ed,ue.a.instance.fa(876),Pc,ue.a.instance.fa(875),"",-1),this.U7f(!0)),this.OLa=
!0,this.Gu.UHa?this.Ih.isEnabled||this.Ih.enable():this.Ih.disable())};Mb.prototype.GEe=function(e){this.$&&!this.Jzb||!e?(this.FSa(!1),fg.a.Fa(this.Uh),this.Uh=null):(this.Uh||(this.Uh=new Ib(this.$,this.gg,this.U7a),this.FSa(!0)),this.isListVisible=!0)};Mb.prototype.FSa=function(e){this.Uh&&(e&&!this.vR?(this.Uh.I9(this.Kzd),this.Uh.NYb(this.mLa),this.Uh.wnb(this.Eya),this.vR=!0):!e&&this.vR&&(this.Uh.ida(this.Kzd),this.Uh.wsc(this.mLa),this.Uh.oHb(this.Eya),this.vR=!1))};Mb.prototype.DLb=function(e){e&&
!this.ZQ?(this.gridView.view.Ls(this.ht),this.ZQ=!0):!e&&this.ZQ&&(this.gridView.view.Mq(this.ht),this.ZQ=!1)};Mb.prototype.U7f=function(e){this.Ih&&(e&&!this.z0b?(this.Ih.LUc(this.FOa),this.Ih.$Uc(this.FOa),this.Ih.enb(this.mLa),this.z0b=!0):!e&&this.z0b&&(this.Ih.TId(this.FOa),this.Ih.hJd(this.FOa),this.Ih.WGb(this.mLa),this.z0b=!1))};Mb.prototype.deg=function(){if(this.I4a){var e=this.lOa;e&&(this.Vdg(e,!0),this.yBa(e,!0),this.oeg(e,!0))}};Qk.Object.defineProperties(Mb.prototype,{Jzb:{configurable:!0,
enumerable:!0,get:function(){return!!(this.$.Jd&16)}},Soi:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.lR||this.OLa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Bd.DOMElementExtensions.isVisible(this.gg)},set:function(e){Bd.DOMElementExtensions.setVisible(this.gg,e)}},lR:{configurable:!0,enumerable:!0,get:function(){return Bd.DOMElementExtensions.isVisible(this.BW)},set:function(e){Bd.DOMElementExtensions.setVisible(this.BW,e)}},OLa:{configurable:!0,
enumerable:!0,get:function(){return Bd.DOMElementExtensions.isVisible(this.zha)&&!!this.Ih&&Bd.DOMElementExtensions.isVisible(this.Ih.domElement)},set:function(e){Bd.DOMElementExtensions.setVisible(this.zha,e);this.Ih&&Bd.DOMElementExtensions.setVisible(this.Ih.domElement,e)}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.cJ},set:function(e){this.cJ=e}},I4a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.f7c(this.activeCell.range)}},activeCell:{configurable:!0,
enumerable:!0,get:function(){return this.gridView.wc(null)}},p8e:{configurable:!0,enumerable:!0,get:function(){return this.I4a&&!!this.Gu&&!!(this.Gu.options&2)&&!!this.Gu.prompt}},vwb:{configurable:!0,enumerable:!0,get:function(){return this.I4a&&!!this.Gu&&!!(this.Gu.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},Gu:{configurable:!0,enumerable:!0,get:function(){return this.v3a(this.activeCell.range)}},lOa:{configurable:!0,enumerable:!0,get:function(){var e=
this.activeCell;return e?this.qva(this.gridView,e):null}}});Object(Md.a)(Mb,"DataValidationControl",Ah.a,[404,2]);var zd=Bh.a;vm(Sa,zd);Sa.prototype.create=function(){this.Gb(this.$.da.Aa(14)||new Mb(this.$))};Object(Md.a)(Sa,"DataValidationControlFactory",Bh.a,[]);ib.v$c="!";ib.fGf="[";ib.eGf="]";ib.openParen="(";ib.closeParen=")";ib.khg=" /.(*\\".split("");ib.k7b="...";ib.NEb="param_help_link";ib.LCd="param_help_udf";ib.ycd="function_list_box";ib.NGh="function_param_box";ib.Acd="function_reader_description";
ib.tcd="function_description_box";ib.jWe="function_param_table";ib.KXi="param_row_";ib.MCd="param_set";ib.MGf="param_row_0";ib.NGf="param_row_1";ib.OGh="<div id='{0}' class='{1}'></div>";ib.MGh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";ib.OGf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";ib.JGh="<div id='{0}' class='{1} {2} {3}'></div>";
ib.GGh="<div id='{0}' class='{1} {2} {3} {4}'></div>";ib.blf="[@";ib.$3g=1;ib.Z3g=3;ib.Ych=500;ib.jqf=50;Object(Md.a)(ib,"FormulaAssistanceConstants",null,[]);var Fd=b(68),se=b(217);Object(Md.a)(Tb,"FormulaAuthoringUsageDetails",null,[]);Object(Md.a)(Ab,"FormulaSuggestionsUsageDetails",null,[]);Object(Md.a)(kc,"AutocompleteCardInteractionUsageDetails",null,[]);Object(Md.a)(mb,"AutocompleteRenderOptimizationDetails",null,[]);Object(Md.a)(Wa,"SessionDetails",null,[]);Object(Md.a)(cb,"PerfMetrics",null,
[]);Object(Md.a)(Fa,"AggregatedPerfMetrics",null,[]);ta.prototype.vSa=function(){this.Hkc=Gg.a.Ra.ie.m};ta.prototype.Eia=function(e){-1!==this.Hkc&&(e?(this.Ymb(Gg.a.Ra.ie.m-this.Hkc),this.Hkc=-1):this.Q_.failedCount++)};ta.prototype.hCh=function(){this.Q_.excludingFirstAction=ta.MTe(this.$6b);Array.add(this.$6b,this.Q_.firstAction);this.Q_.includingFirstAction=ta.MTe(this.$6b)};ta.prototype.Ymb=function(e){var C=this;this.Q_.count?1E3>this.Q_.count&&Array.add(this.$6b,e):this.Q_.firstAction=e;this.Pqf&&
this.Qqf&&this.Qqf.forEach(function(J){e>J&&C.Q_.countAboveThresholds[J]++});this.Q_.count++};ta.MTe=function(e){var C=new Fa;0<e.length&&(af.i(e),C.median=e[Math.floor(.5*e.length)],C.P75=e[Math.floor(.75*e.length)],C.P95=e[Math.floor(.95*e.length)],C.max=e[e.length-1],C.average=af.g(e,function(J){return J})/e.length);return C};Object(Md.a)(ta,"PerformanceMeasurement",null,[]);var Ye=b(40),ff=b(100),Wf={},lg=(Wf.argumentAssistanceOverall=[50,80,100,130,150,170,200],Wf);ra.prototype.A7=function(e){var C=
this;e.forEach(function(J){C.x$a.xb(J)||C.x$a.ia(J,new ta(lg[J]));C.x$a.oa(J).vSa()})};ra.prototype.iZ=function(e,C){var J=this;C=void 0===C?!0:C;e.forEach(function(ja){J.x$a.xb(ja)&&J.x$a.oa(ja).Eia(C)})};ra.prototype.NYf=function(e){var C="Undefined";switch(e){case 1:C="Collapsed";break;case 0:C="Expanded";break;case 2:C="Hidden"}this.Eaa.argumentAssistanceCardInitialMode=C};ra.prototype.w7b=function(e){var C=this;window.requestAnimationFrame(function(){C.iZ([e])})};ra.prototype.getJsonForLogging=
function(){return"{"+this.p3("SessionDetails",this.jvc)+","+this.p3("FormulaAuthoringUsage",this.Eaa)+","+this.p3("FormulaSuggestionsUsage",this.CJa)+","+this.p3("AutocompleteCardInteraction",this.N2)+","+this.p3("AutocompleteRenderOptimization",this.yob)+","+this.LYh()+"}"};ra.prototype.quj=function(){this.jvc.argumentAssistanceFlight=this.Fed("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.jvc.autoCompleteUIFlight=this.Fed("Microsoft.Office.Excel.","AutoCompleteNewUI");this.jvc.smartFormulaBarAutoCompleteFlight=
this.Fed("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled")};ra.prototype.LYh=function(){for(var e=new va.a,C=yl(this.x$a),J=C.next();!J.done;J=C.next())J=J.value,J.value.hCh(),e.add(String.format('"{0}":{1}',J.key,Nd.a.Lc(J.value.Q_)));return String.format('"PerfMeasurements": {{{0}}}',e.toArray().join(","))};ra.prototype.Fed=function(e,C){return E.a.contains(this.vb.ya.FlightHolder.FlightId,C,!0)?xe.EwaSettings.getBooleanFeatureGate(e+C,!1)?"T":"C":"None"};ra.prototype.p3=
function(e,C){return String.format('"{0}":{1}',e.toString(),Ye.c(C))};Qk.Object.defineProperties(ra.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb},set:function(e){this.vb||(this.vb=e,this.vb.ul(this.qd))}}});Qk.Object.defineProperties(ra,{instance:{configurable:!0,enumerable:!0,get:function(){ra.Oa||(ra.Oa=new ra);return ra.Oa}}});ra.Oa=null;Object(Md.a)(ra,"FormulaAssistanceTelemetryManager",null,[]);var rh=b(352),Ch=Fd.a.Boh,th=Fd.a.zNe,Ii=Fd.a.ANe,zi=Fd.a.k9c,Ni=Fd.a.Doh,
Oi=Fd.a.Hoh,Ki=Fd.a.vNe,Bj=Fd.a.DNe,nj=Fd.a.Foh,$g=Fd.a.wNe,Wh=bd.a;vm(Qb,Wh);Qb.prototype.initialize=function(){this.Pb.classList.add(Fd.a.zoh);this.Pb.innerHTML=Qb.XG();this.Ne||(this.Vk(),this.z2());Wh.prototype.initialize.call(this);var e=Bd.DOMElementExtensions.Aj(this.Pb,$g);this.rtl&&(e.align="right",this.bub.style.marginLeft="5px");this.Ne&&(e.style.padding="1px");this.functionInfoManager.Dsb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};Qb.prototype.dispose=function(){this.functionInfoManager&&
(this.functionInfoManager.dHb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.kk(this.dd));fg.a.sc([this.k1b,this.X5,this.Mwb,this.EJa,this.cub]);Wh.prototype.dispose.call(this)};Qb.prototype.Vk=function(){this.FJa=Bd.DOMElementExtensions.Aj(this.Pb,Ch);this.mja=Bd.DOMElementExtensions.Aj(this.Pb,th);this.FJa.setAttribute(Ca.a.Ud,Ca.a.n_b);this.EJa=new Ui.a(this.FJa,!0);this.cub=new Ui.a(this.mja,!0);this.hWe=Bd.DOMElementExtensions.Aj(this.Pb,Oi);this.bub=Bd.DOMElementExtensions.Aj(this.Pb,
Ni);this.lWe=Bd.DOMElementExtensions.Aj(this.Pb,Bj);this.fmf=Bd.DOMElementExtensions.Aj(this.Pb,nj);this.iWe=$get(Qb.ucd,this.Pb);this.lja=Bd.DOMElementExtensions.Aj(this.Pb,Ki);this.Ne&&(this.lja.style.paddingLeft="1px");this.functionInfoManager.nnb(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Tj(this.dd)};Qb.prototype.$Q=function(e){var C=this;this.$.da.Za(40,function(){C.EJa.$Q(e)})};Qb.prototype.lm=function(){this.bcd?this.formulaAssistanceManager.DIe():this.formulaAssistanceControl.set_visible(!1);
Wh.prototype.lm.call(this);this.xjd||(this.getButton(0).get_element().disabled=!0)};Qb.prototype.setFocus=function(){!this.FJa.disabled&&this.xjd&&Bd.DOMElementExtensions.setFocus(this.FJa)};Qb.prototype.commit=function(){return!0};Qb.prototype.nqb=function(){var e=this,C=this.M$.NameDataStrings;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var J=new hh.a(-433697611,0,this.$.hd,8,null),ja={};ja=(ja[If.a.nd]=C,ja);this.$.Ka.Yb(J,ja)}else{C+=ib.openParen;J=Oe.g(this.$);
J.view.visibleArea.contains(J.pg(null))||J.Qt(J.ha.va.activeCell,3,Qi.a.HGh);var Aa=this.DIa.textBox;if(this.DIa.isEditing&&this.DIa.text){ja=this.DIa.text;var gb=this.m_c?ja.substring(0,this.m_c):"=";this.DIa.text=gb+C+ja.substring(this.m_c+(Aa.lv?Aa.lv.length:0),ja.length);Aa.caretPosition=gb.length+C.length}else Pd.TaskExtensions.Ba(J.startEdit(!0,1),function(){e.DIa.text="="+C;var bc=C.length+1;Aa.oRa(bc);Aa.caretPosition=bc},this.ma,11,Df.a.current);J.Cj&&(J=J.zc,J.text=Aa.text,J.setCaretPosition(Aa.caretPosition));
(J=this.DIa.yY.get(zk.a.X2a))&&J.oU(!1)}};Qb.prototype.EGa=function(){this.bcd?this.formulaAssistanceManager.rda():this.formulaAssistanceControl.gob()};Qb.prototype.Qua=function(e){this.cub.clear();for(var C=Qb.ucd+" "+Qb.dWe,J=0,ja=e.length;J<ja;++J){var Aa=this.cub.oM(e[J].NameUI,e[J].FunctionIndex.toString(),!1);Rh.a.Vu&&Aa.classList.add(zi);Aa.setAttribute(Ca.a.dE,Qb.eWe);Aa.setAttribute(Ca.a.zJ,C)}this.cub.selectedIndex=0};Qb.prototype.vZf=function(){if(this.M$){this.bub.parentNode.className=
Fd.a.wNe+(this.functionInfoManager.uod(this.M$)?"-udf":"");var e=this.M$.NameDataStrings;this.lWe.innerText=e;this.bub.innerText=e;this.lja.innerText=this.M$.Help;e=this.M$.Params.split(ib.v$c);this.iWe.innerText=ib.openParen+(1<e.length?ib.k7b:e[0])+ib.closeParen}};Qb.XG=function(){return String.format("<div class='"+Fd.a.Aoh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+zg.a.io+"'>{1}</div>\r\n<div class='"+Fd.a.uNe+
"'>\r\n\t<select id='{16}' class='{17} "+k.a.Wo+" "+k.a.Sk+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Fd.a.Eoh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+k.a.Wo+"'>\r\n\t\t\t<span class='"+k.a.fr+" "+Fd.a.Goh+"'>\r\n\t\t\t\t<img title='{3}' class='"+k.a.Nvh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
ue.a.instance.fa(1005),ue.a.instance.fa(1006),ue.a.instance.fa(723),ue.a.instance.Cb(3),fh.a.Fe(13),ue.a.instance.fa(1007),Qb.FGh,Qb.ucd,7,Ch,Ni,Oi,Ki,Bj,nj,$g,Qb.KGh,th+(Rh.a.Vu?" "+Ii:""),Qb.dWe,Qb.eWe)};Qk.Object.defineProperties(Qb.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}},M$:{configurable:!0,enumerable:!0,get:function(){if(!this.mja||!this.mja.firstChild)return null;var e=Number.parseInvariant(this.mja.children[this.mja.selectedIndex].value);return this.functionInfoManager.kRh(e)}}});
Qb.ucd="function_dialog_param_string";Qb.dWe="function_dialog_function_description";Qb.eWe="function_dialog_function_name";Qb.KGh="function_list";Qb.FGh="function_category";Object(Md.a)(Qb,"FunctionDialog",bd.a,[]);dc.prototype.Zc=function(e,C){if(!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(C){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return e=
Oe.g(this.$).xj,e.qLa||!e.isEditing||0>=e.text.length?!1:!0;default:return!1}};dc.prototype.executeCommand=function(e,C,J){C=C.command;e=Oe.g(this.$);switch(C){case 753860909:case -2060563418:xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")?(J=e.xj,e.inRangePicker&&J.gE(!1),this.create(J)):e.wc(null)&&(J=e.xj,J.qLa||!J.isEditing||0>=J.text.length)&&(e.inRangePicker&&J.gE(!1),this.create(J));break;case -433697611:var ja=J[If.a.nd]+ib.openParen;J.UILocation&&this.$.ye(-1075437823,
-1,0,null);e.view.visibleArea.contains(e.pg(null))||e.Qt(e.ha.va.activeCell,3,Qi.a.HFh);var Aa=e.xj,gb=Aa.textBox;J=Aa.textBox.caretPosition;if(Aa.isEditing&&Aa.text){C=Aa.text;var bc=J?C.substring(0,J):"=";Aa.text=bc+ja+C.substring(J+(gb.lv?gb.lv.length:0),C.length);gb.caretPosition=bc.length+ja.length}else Pd.TaskExtensions.Ba(e.startEdit(!0,1),function(){Aa.text="="+ja;var Mc=ja.length+1;gb.oRa(Mc);gb.caretPosition=Mc},this.$.ma,11,Df.a.current);e.Cj&&(e=e.zc,e.text=gb.text,e.setCaretPosition(gb.caretPosition));
this.kF?this.formulaAssistanceManager.rda():(e=Aa.yY.get(zk.a.X2a),null===e||void 0===e?void 0:e.oU(!1))}return Tf.Task.Ta(!0)};dc.prototype.Kc=function(e,C){switch(C.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};dc.prototype.DHh=function(e,C){C=this.Sa.Kp(C);var J=this.Sa.Nc(),ja=this.functionInfoManager.w_e(e);if(!ja)return Gd.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),C.$B();for(var Aa=0;Aa<
ja.length;++Aa){var gb=ja[Aa].NameUI,bc=this.Sa.nQ(280,"Formulas."+e+"MenuItem_"+ja[Aa].FunctionIndex.toString(),-433697611,null,1,"None",0,0,gb,!1,0);bc.label=gb;var Mc=ja[Aa].Params.split(ib.v$c);bc.mS(gb+" "+(ib.openParen+(1<Mc.length?ib.k7b:Mc[0])+ib.closeParen)+"\n"+ja[Aa].Help);Array.add(J.buttons,bc)}e=this.Sa.Nc();ja=this.Sa.nQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,k.a.dRe,3,"Image16by16",1004,0,"Formulas.MoreFunctionsMenuItem",!1,0);Array.add(e.buttons,ja);Array.add(C.Ac,J);Array.add(C.Ac,
e);return C.$B()};dc.prototype.gd=function(e,C,J){e=this.jRh(C);if(-1===e)return!1;this.menuId=J.MenuId;if(!this.functionInfoManager.i5)return this.functionInfoManager.Dsb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;e=this.functionInfoManager.cWe[e];this.wM[e]=this.wM[e]||this.DHh(e,J.MenuId);J.MenuItems=this.wM[e];return!0};dc.prototype.create=function(e){(new Qb(this.$,e)).mf()};dc.prototype.jRh=function(e){switch(e){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;
case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(Md.a)(dc,"FormulaAssistanceCommandHandler",null,[239]);var Ri=cf.a;vm(Kb,Ri);Kb.prototype.Pd=function(){var e=this,C=Zg.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.ub),J=Zg.GetServiceTaskFactory.create(this.$.da,153,this.ma,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([C,J],this.ma),function(){e.Gd([new dc(e.$,C.result,J.result)])},this.ma,3)};Kb.ka=function(e){cf.a.he(92,new Kb(e))};Object(Md.a)(Kb,"FormulaAssistanceCommandHandlerFactory",cf.a,[]);jc.prototype.dispose=function(){this.oXd();this.GJa=this.Jua=this.ija=null};jc.prototype.mXc=function(e){e&&(this.ija=e,this.ija.Hne(this.eCf),this.ija.woe(this.gCf),this.K5a&&this.ija.voe(this.fCf))};
jc.prototype.nXc=function(e){e&&(this.Jua=e,this.gMa&&(this.Jua.Fne(this.qyf),this.Jua.Dne(this.jyf)),this.fMa&&this.Jua.Ene(this.myf))};jc.prototype.Ose=function(e){e&&(this.GJa=e,this.GJa.xoe(this.hCf),this.GJa.bVc(this.aCf))};jc.prototype.oXd=function(){var e,C,J;this.ija&&(this.ija.QQf(this.eCf),this.ija.nRf(this.gCf),this.K5a&&this.ija.mRf(this.fCf));this.GJa&&(this.GJa.oRf(this.hCf),this.GJa.iJd(this.aCf));this.gMa&&(null===(e=this.Jua)||void 0===e?void 0:e.PQf(this.qyf),null===(C=this.Jua)||
void 0===C?void 0:C.NQf(this.jyf));this.fMa&&(null===(J=this.Jua)||void 0===J?void 0:J.OQf(this.myf))};jc.prototype.N6i=function(e,C){if(C){var J="";this.K5a||(J+=ue.a.instance.Cb(56)+this.ariaLiveNotifier.Gxa);for(var ja=0;ja<C.length;ja++)J+=e+this.ariaLiveNotifier.Gxa+this.OYc(C[ja])+jc.PDd(ja,C.length);this.K5a&&(J+=ue.a.instance.fa(864)+this.ariaLiveNotifier.Gxa);this.ariaLiveNotifier.readText(J)}};jc.prototype.M6i=function(e,C,J){if(e){var ja="",Aa=0;if(C){for(var gb=0;gb<C.length;gb++)if(J>=
e[gb].split(this.$.listSeparator).length)Aa++;else{var bc=C[gb].trim();if(!bc)return;bc=this.OYc(bc);var Mc=jc.PDd(gb-Aa,C.length-Aa);ja+=bc+Mc;Mc&&(ja+=this.ariaLiveNotifier.Gxa)}this.ariaLiveNotifier.readText(ja)}}};jc.prototype.OYc=function(e){if(!e)return"";var C=e.split(this.$.listSeparator);e="";C=yl(C);for(var J=C.next();!J.done;J=C.next()){var ja=J.value;jc.Und(ja)?e+=ja:(ja=(J=jc.kli(ja))?ja.replace("[","").replace("]",""):ja,e+=String.format(J?ue.a.instance.Cb(58):ue.a.instance.Cb(57),ja));
e+=this.ariaLiveNotifier.Gxa}return e};jc.PDd=function(e,C){if(e>=C||1===C)return Gd.ULS.shipAssertTag(537161997,0,e<C,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""};jc.Und=function(e){return E.a.contains(e,ib.k7b,!0)};jc.kli=function(e){return e.trimStart().startsWith(ib.fGf)||e.trimEnd().endsWith(ib.eGf)};Object(Md.a)(jc,"FormulaAssistanceReadoutHandler",null,[421,2]);var Si=Bh.a;vm(Ub,Si);Ub.prototype.create=function(){var e=this,C=this.$.da;Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.Wa(C,
211,212,this.ub),function(J){J=C.Aa(219)||new jc(J.result,e.$);e.Gb(J)},this.ma,3)};Ub.ka=function(e){e.da.Ha(220,new Ub(e))};Object(Md.a)(Ub,"FormulaAssistanceReadoutHandlerFactory",Bh.a,[]);var Ej=b(687),li=b(109),Li=b(1128);qb.prototype.fhd=function(e){return this.EQa&&e in this.EQa?this.EQa[e]:null};qb.prototype.q7f=function(e,C){this.EQa||(this.EQa={});this.EQa[e]=C};qb.prototype.PZ=function(){this.EQa=null};Object(Md.a)(qb,"FormulaAssistanceContextualPreviewCache",null,[]);lc.prototype.dispose=
function(){this.Nd||(this.$&&(this.$.ea.TF(this.YC),this.$=null),this.Eha=this.ZEb=null,this.Nd=!0)};lc.prototype.Tdd=function(e,C,J,ja){var Aa=this;if(C&&0>=C.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!e)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
var gb="="+C.substring(J.start,J.end);xe.EwaSettings.la(620)&&(gb=this.calcManager.$Zh(Oe.g(this.$).ha.va.activeCell,e,J));var bc=this.qNh(gb,J);if(xe.EwaSettings.la(620)){if(bc&&!this.calcManager.isFormulaSubExpressionVolatile(e))return Promise.resolve(bc)}else if(bc)return Promise.resolve(bc);return this.sNh(gb,J).then(function(Mc){if(Aa.X_c(ja))throw Error.create("OperationCanceledException");if(!Mc||Mc.Qij||Mc.Yma.startsWith("##UNSUPPORTED:"))return Aa.TYe(C,gb,J,ja);Aa.Eha.q7f(gb,Mc.Yma);return Promise.resolve(Mc)})};
lc.prototype.qNh=function(e,C){return(e=this.Eha.fhd(e))?new Li.a(e,C.start,C.end,0):null};lc.prototype.sNh=function(e,C){if(!e||0>=e.length||!C)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.CTg(Oe.g(this.$).ha.va.activeCell,e,this.Ozi,C)};lc.prototype.TYe=function(e,C,J,ja){var Aa=this;if(!e||0>=e.length||!C||0>=C.length||!J)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.TOa)return this.rNh(e,C,J,ja);var gb={};gb.PartialFormula=C;gb.Formula=e;gb.SourceRange=ud.v(Oe.g(this.$).ha.va.activeCell,this.$);return this.TOa=new Promise(function(bc,Mc){Aa.ZEb=new Ej.a;Aa.oTf=Aa.$.ea.uf;Aa.w$a=Oa(Aa.$.na.ta,gb,function(Hc){Aa.AVi(C,J,ja,Hc,bc,Mc)},function(Hc){Aa.TOa=null;Aa.w$a=null;Mc(Hc)},null,null,null);Aa.ZEb.token.R(function(){Aa.gVg(Mc)})})};lc.prototype.AVi=function(e,C,J,ja,Aa,gb){this.w$a=this.TOa=null;if(this.oTf!==this.$.ea.uf)gb(Error.create("OperationCanceledException"));
else if(ja.Result)if(ja=Nd.a.oi(ja.Result),!ja||li.a.isEmpty(ja))Aa(null);else{for(var bc in ja)this.Eha.q7f(bc,ja[bc]);this.X_c(J)?gb(Error.create("OperationCanceledException")):(e=this.Eha.fhd(e))?(""===e&&(e=" "),Aa(new Li.a(e,C.start,C.end,0))):gb(Error.create("SubexpressionNotFoundException"))}else Aa(null)};lc.prototype.rNh=function(e,C,J,ja){var Aa=this;return new Promise(function(gb,bc){Aa.TOa.then(function(){Aa.aUf(e,C,J,ja,gb,bc)}).catch(function(){Aa.aUf(e,C,J,ja,gb,bc)})})};lc.prototype.aUf=
function(e,C,J,ja,Aa,gb){if(this.X_c(ja))gb(Error.create("OperationCanceledException"));else{var bc=this.Eha.fhd(C);bc?Aa(new Li.a(bc,J.start,J.end,0)):this.TYe(e,C,J,ja).then(function(Mc){Aa(Mc)}).catch(function(Mc){gb(Mc)})}};lc.prototype.gVg=function(e){this.w$a&&(xg.a.nu(this.w$a.Et)?(this.TOa=this.w$a=null,e(Error.create("PendingWebReqeuestCancelled"))):Gd.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};lc.prototype.PZ=function(){this.hVg();this.Eha&&this.Eha.PZ()};
lc.prototype.hVg=function(){this.ZEb&&this.ZEb.C()};lc.prototype.X_c=function(e){return this.Nd||e.rK};Object(Md.a)(lc,"FormulaAssistanceContextualPreviewCalculator",null,[2]);var wi=b(139),Ji=b(208);Wb.oph="ewa-facp-text-box";Object(Md.a)(Wb,"CssClassNames",null,[]);$b.prototype.dispose=function(){(this.E$||this.mQ)&&this.f9e();this.Ya=this.sqa=null};$b.prototype.YRj=function(e,C,J,ja){e&&C&&ja&&C.Yma&&!(1>C.Yma.length)&&(this.Ya=e,this.VPf(),this.Z1a=C,this.HSa=ja,this.OAj(C,J,ja))};$b.prototype.f9e=
function(){this.D7h();this.VPf();this.HSa=this.Z1a=null};$b.prototype.OAj=function(e,C,J){var ja=this;if(e.Yma&&!(1>e.Yma.length)){var Aa=this.Pc.da.Aa(266);if(Aa){var gb=Aa.tTh();gb&&Pd.TaskExtensions.Ba(this.ZAb,function(){if(C)if(xe.EwaSettings.la(620)&&ja.Ya.isEditing&&0<J.length){ja.$wb(e.BJa,J[0].start,null);var bc=ja.T3e(J[0],gb),Mc=ja.Ya.text.substring(J[0].start,J[0].end).trim();Mc=ja.Ya.text.indexOf(Mc);Mc=ja.Ya.text.substring(0,Mc).lastIndexOf("\n");ja.$wb(0>Mc||1>=J.length?J[0].start:
Mc+1,J[0].end,bc?String.format(bc,.3):null);for(var Hc=1;Hc<J.length;Hc++)bc=ja.T3e(J[Hc],gb),Mc=ja.Ya.text.substring(J[Hc].start,J[Hc].end).trim(),Mc=ja.Ya.text.indexOf(Mc),Mc=ja.Ya.text.substring(J[Hc-1].end,Mc).lastIndexOf("\n"),ja.$wb(0>Mc?J[Hc-1].end:Mc+1+J[Hc-1].end,J[Hc].end,bc?String.format(bc,.3):null);Mc=ja.Ya.text.substring(J[J.length-1].end,e.Mua).indexOf("\n");ja.$wb(0>Mc?J[J.length-1].end:Mc+1+J[J.length-1].end,e.Mua,null);Gd.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else ja.$wb(e.BJa,
e.Mua,null),Gd.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");ja.E$||(ja.E$=document.createElement(Ji.a.div),ja.Ya.textBox.domElement.appendChild(ja.E$));ja.mQ||(ja.mQ=document.createElement(Ji.a.div),ja.mQ.className=Wb.oph,ja.Pc.domElement.appendChild(ja.mQ));bc=e.Mua;xe.EwaSettings.la(620)&&ja.Ya.isEditing&&J&&0<J.length&&J[0].start<bc&&J[0].start!==e.BJa&&!ja.Ya.textBox.lv.length&&
(bc=J[0].start);Hc=E.a.contains(ja.Ya.textBox.nf.id,"FormulaBar",!0)&&E.a.contains(ja.Ya.text.substring(e.BJa,e.Mua),"\n",!0);Mc=ja.Ya.isEditing?ja.Ya.textBox.caretPosition:0;bc=excelOnline.utils.getBoundingRectForText(ja.Ya.textBox.nf,Hc?Mc:e.BJa,Hc?Mc:bc,xe.EwaSettings.la(620));ja.mQ.style.left=Lb.HelperMethods.Rb(bc.left);ja.mQ.style.top=Lb.HelperMethods.Rb(bc.top);ja.mQ.style.width=Lb.HelperMethods.Rb(bc.width);ja.mQ.style.height=Lb.HelperMethods.Rb(bc.height);bc=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
e.Mua,e.Mua);dialogControls.renderToolTip(ja.E$,bc,e.Yma,ja.mQ,0,!1,!1,1)},this.Pc.ma,3)}}};$b.prototype.T3e=function(e,C){var J=this.Ya.text,ja=J.substring(e.start,e.end);ja=ja.trim();e=J.indexOf(ja,e.start);C=J.indexOf(C,e);ja=J.substring(e,C);ja=ja.trim();return this.Ya.colors.getItem(e+"-"+(e+ja.length))};$b.prototype.D7h=function(){var e=this;this.Ya&&this.E$&&this.mQ&&Pd.TaskExtensions.Ba(this.ZAb,function(){e.Ya.textBox.domElement.contains(e.E$)&&(dialogControls.clearToolTip(e.E$),e.Ya.textBox.domElement.removeChild(e.E$),
e.E$=null);e.Pc.domElement.contains(e.mQ)&&(e.Pc.domElement.removeChild(e.mQ),e.mQ=null)},this.Pc.ma,3)};$b.prototype.$wb=function(e,C,J){if(this.Ya&&!(e>=C)){var ja={};this.Ya.textBox.formatText(e,C-e,(ja.background=J||"#E3DDCC",ja));this.njd=!0}};$b.prototype.VPf=function(){if(this.Ya&&this.Z1a&&this.njd){var e=this.Z1a.Mua;xe.EwaSettings.la(620)&&0<this.HSa.length&&this.HSa[this.HSa.length-1].end>e&&(e=this.HSa[this.HSa.length-1].end);var C={};this.Ya.textBox.formatText(this.Z1a.BJa,e-this.Z1a.BJa,
(C.background=!1,C));this.njd=!1}};Qk.Object.defineProperties($b.prototype,{ZAb:{configurable:!0,enumerable:!0,get:function(){var e=this;if(this.sqa)return this.sqa;var C=new wi.a;this.Pc.YE(function(J){Pd.TaskExtensions.Ba(J.wtd(),function(){C.setResult(!0)},e.Pc.ma,3)});return this.sqa=C.task}}});Object(Md.a)($b,"FormulaAssistanceContextualPreviewControl",null,[2]);var Ai=b(44),ji=b(42);rd.prototype.O3f=function(e,C,J){J?this.W5g(e,C,J):this.k6e(e,C,J,!0)};rd.prototype.whj=function(){this.L7=0};
rd.prototype.W5g=function(e,C,J){var ja=this;this.L7++;var Aa=this.L7;Ai.a.instance.create(function(){ja.k6e(e,C,J,Aa===ja.L7)},500,ji.a.IFh,!0,!0)};rd.prototype.k6e=function(e,C,J,ja){var Aa=this,gb=this.acd.Tdd(e,C);gb&&gb.then(function(bc){ja&&Aa.acd.Fod(C)&&Aa.acd.XRj(e,bc,J)}).catch(function(bc){bc=Object(X.a)(Error,bc);"OperationCanceledException"===bc.message?Gd.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",bc):Gd.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",bc)})};Object(Md.a)(rd,"FormulaAssistanceContextualPreviewHoverManager",null,[]);sc.prototype.dispose=function(){this.VZc();fg.a.sc([this.Ttb,this.e$b]);this.f$b=this.e$b=this.Ttb=null;this.$&&Oe.g(this.$).zc.Mn(this.n9a);this.Cha=this.Ya=this.$=null};sc.prototype.PAj=function(e,C){C&&Zi.e(C.text)&&!(C.Dwa||C.textBox.lv||this.Ya&&this.Ya.textBox.lv)&&(this.Ya=C,this.calcManager=this.$.da.Aa(266))&&(Gd.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),e=Lb.HelperMethods.Cub(e),e=this.calcManager.XZh(Oe.g(this.$).ha.va.activeCell,this.Ya.text,e.x,e.y),C=this.calcManager.getSubExpressionSpan(e),!C||C.end<=C.start||this.Fod(C)||(this.Cha=C,this.f$b.O3f(e,C,!0)))};sc.prototype.yRd=function(e){if(e&&Zi.e(e.text))if(e.textBox.lv&&e.textBox.lv.trim()){if(this.Ya=e,this.calcManager=this.$.da.Aa(266)){Gd.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");e={};var C=this.Ya.textBox.lv.trim();e.start=this.Ya.text.indexOf(C,this.Ya.textBox.caretPosition);e.end=e.start+C.length;(C=this.calcManager.getFormulaSubExpressionObject(Oe.g(this.$).ha.va.activeCell,this.Ya.text,this.Ya.textBox.lv))&&!this.Fod(e)&&(this.Cha=e,this.f$b.O3f(C,e,!1))}}else this.Y4a(!1,!0)};sc.prototype.Y4a=function(e,C){!this.Ya||C&&this.Ya.textBox.lv||
(this.Cha=null,e&&(this.VZc(),this.e$b.PZ(),this.f$b.whj()),this.Ttb&&this.Ttb.f9e(),this.Ya.Dwa||(this.Ya.Dwa=!1,this.Ya=null))};sc.prototype.Tdd=function(e,C){if(!this.Ya||this.Ya.Dwa)return null;this.VZc();this.krb=new Ej.a;return this.e$b.Tdd(e,this.Ya.text,C,this.krb.token)};sc.prototype.XRj=function(e,C,J){this.krb=null;!e||!C||!C.Yma||0>=C.Yma.length?this.Y4a(!1,!1):(e=this.calcManager.YZh(Oe.g(this.$).ha.va.activeCell,e,this.Ya.text),this.Ttb.YRj(this.Ya,C,J,e))};sc.prototype.Fod=function(e){return this.Cha?
e.start===this.Cha.start&&e.end===this.Cha.end&&e.pre===this.Cha.pre&&e.post===this.Cha.post:!1};sc.prototype.VZc=function(){this.krb&&this.krb.C()};Object(Md.a)(sc,"FormulaAssistanceContextualPreviewManager",null,[510,2,511]);var Sh=b(1187),Th=b(902),Mg=b(244),bk=b(154);nb.prototype.h_f=function(e){this.jT=0;this.V8d=e.IsCompatibility;this.set_name(e.NameDataStrings);this.NVa=e.Help};nb.prototype.trj=function(e){this.jT=1;this.set_name(e.Name)};nb.prototype.Uqj=function(e){this.jT=2;this.set_name(e.name);
this.NVa=e.tooltip};nb.prototype.usj=function(e){this.jT=3;this.set_name(e.name);this.NVa=e.toolTip};nb.prototype.F0f=function(e){this.jT=4;this.set_name(e.name)};nb.prototype.Muj=function(e){this.jT=5;this.set_name(e.name);this.NVa=e.toolTip};nb.prototype.Luj=function(e){this.jT=7;this.set_name(e.name)};nb.prototype.jtj=function(){this.jT=6;this.set_name(ue.a.instance.Cb(182));this.NVa=ue.a.instance.Cb(183)};nb.prototype.set_name=function(e){return this.s$d=e};nb.l$g=function(){return Object.assign(new nb,
{$9d:!0})};Qk.Object.defineProperties(nb.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.jT}},ehi:{configurable:!0,enumerable:!0,get:function(){return this.V8d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.s$d}},lja:{configurable:!0,enumerable:!0,get:function(){return this.NVa}},Bzb:{configurable:!0,enumerable:!0,get:function(){return this.$9d}}});Object(Md.a)(nb,"AutoCompleteItem",
null,[536]);Object(Md.a)($a,"DefinedNameInfo",null,[]);fc.prototype.AOj=function(e){var C=this.jHe[e.toUpperCase()];if(!C)return{returnValue:!1,sheetName:"",range:null};e=C.sheetName;C=this.X2g(C.namedRange);return{returnValue:!0,sheetName:e,range:C}};fc.prototype.l3g=function(e){if(null!=e&&void 0!=e)return{top:e.top,left:e.left,bottom:e.bottom,right:e.right,maxRows:e.maxRows,maxColumns:e.maxColumns,sheetName:void 0}};fc.prototype.X2g=function(e){if(null!=e&&void 0!=e)return new $c.a(e.top,e.left,
e.bottom,e.right,e.maxRows,e.maxColumns)};fc.prototype.e3g=function(e){switch(e){case 2:return 0;case 3:return 1;default:return-1}};Qk.Object.defineProperties(fc.prototype,{iHe:{configurable:!0,enumerable:!0,get:function(){var e=[];if(!this.$.zb||!this.$.zb.items)return e;for(var C=0,J=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&vg.a.kF(this.$),ja=yl(this.$.zb.items),Aa=ja.next();!Aa.done;Aa=ja.next())if((Aa=Aa.value)&&(3===Aa.type&&Aa.usedRange||
J&&2===Aa.type)){var gb=new $a;gb.tooltip=Aa.sheetName+P.a.exclamation+Aa.usedRange.toString();gb.name=Aa.name;gb.namedRange=this.l3g(Aa.usedRange);gb.sheetName=Aa.sheetName;gb.type=this.e3g(Aa.type);Array.add(e,gb);this.jHe[Aa.name.toUpperCase()]=gb;++C;if(C===ib.jqf){Gd.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",ib.jqf);break}}return e}}});Object(Md.a)(fc,"DefinedNameInfoManager",null,[]);var Lj=b(120),Nk=Sys.EventArgs;vm(ub,Nk);Object(Md.a)(ub,
"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Uk=Sys.EventArgs;vm(Za,Uk);Object(Md.a)(Za,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var oj=Sys.EventArgs;vm(Gb,oj);Object(Md.a)(Gb,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var sj=b(255);vb.prototype.Oe=function(e,C){e=!1;C||(Oe.g(this.$).xj.textBox.mK=!0,e=this.formulaAssistanceUIControl.focus(this.LVe));return e};vb.prototype.Yf=function(e){var C=this.Kb;return!(void 0===C||
null===C)&&Bd.DOMElementExtensions.Pe(C,e)};vb.prototype.fi=function(){this.E6e&&this.E6e()};vb.prototype.Ph=function(){};vb.prototype.dispose=function(){sj.a(this.$).Cz(this)};Qk.Object.defineProperties(vb.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.IZc},set:function(e){this.IZc!==e&&(e?sj.a(this.$).Qg(this):sj.a(this.$).Cz(this),this.IZc=e)}},$d:{configurable:!0,enumerable:!0,get:function(){return this.bnj}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.LVe)}}});
Object(Md.a)(vb,"FormulaAssistanceFocusManager",null,[117,2]);var tj=b(1044),hi=eh.a;vm(kb,hi);kb.prototype.nnb=function(e){this.addHandler("FunctionInfoLoaded",e)};kb.prototype.dHb=function(e){this.removeHandler("FunctionInfoLoaded",e)};kb.prototype.fFg=function(e){this.addHandler("FunctionInfoReset",e)};kb.prototype.Acj=function(e){this.removeHandler("FunctionInfoReset",e)};kb.prototype.dispose=function(){var e=this.$.da.Aa(268);e&&e.aJd(this.uyf);this.vb=null;hi.prototype.dispose.call(this)};kb.prototype.HTf=
function(){this.raiseEvent("FunctionInfoReset")};kb.prototype.GKd=function(){this.HTf();this.KKc=!1;this.fT=null;this.IKc=!0};kb.prototype.Dsb=function(e,C){var J=this;C=void 0===C?!1:C;if(this.i5)this.KLf();else{Gd.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var ja=null;(ja=this.$.da.Aa(268))||Gd.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===ja||void 0===ja?0:ja.nja)&&
0<ja.nja.length)xe.EwaSettings.la(122)?ja.iFh(this.Jyf):this.mHd(ja.nja,!0,!1);else{var Aa=this.$.na.ta.$b();e&&(this.$.ea.rc||C)&&!this.$ii&&(C?Hh.a(this.$.userOperationManager,function(gb,bc,Mc){return jg.x(J.$.na.ta,e,Jf.b(gb,J.Lyf),Jf.a(bc,J.Kyf),Mc,e,Aa)},function(gb){return new Sf.a(130,0,gb,16)},null):jg.x(this.$.na.ta,e,this.Lyf,this.Kyf,null,e,Aa));!this.i5&&this.$.ea.rc&&(ja?(Gd.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.i5,this.$.ea.rc),ja.Gne(this.uyf)):(Gd.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),jg.x(this.$.na.ta,{FilterType:0},this.Jyf,null,null,null,Aa),this.IKc=!1))}}};kb.prototype.kRh=function(e){return 0>e||e>=this.fT.length?null:this.fT[e]};kb.prototype.Ted=function(e){return Ng.a.Hc(this.Ccd,e.toUpperCase())};kb.prototype.w_e=function(e){return Ng.a.Hc(this.HJa,e)};kb.prototype.uod=function(e){return!e.GroupUI};
kb.prototype.xyf=function(e,C,J){var ja=xh.a(e);Gd.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",ja);ja?(Oe.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.lp(e.Errors)):(this.mHd(e.Result,C,J),vg.a.YZ()&&!vg.a.kF(this.$)&&this.iUj())};kb.prototype.mHd=function(e,C,J){Gd.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
e.length,C,J,this.i5);this.i5||(this.fT=e,this.jQg(C),this.KKc=!J,this.KLf())};kb.prototype.KLf=function(){this.raiseEvent("FunctionInfoLoaded")};kb.prototype.iUj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.xcd)};kb.prototype.jQg=function(e){function C($e,Gf){return $e.NameUI.localeCompare(Gf.NameUI)}var J=ue.a.instance.fa(1001),ja=[];this.HJa={};this.K8=[];this.HJa[J]=ja;var Aa=ue.a.instance.fa(1002),gb=[];Array.add(this.K8,J);Array.add(this.K8,Aa);J=0;for(var bc=this.fT.length;J<
bc;J++){var Mc=this.fT[J];Mc.IsCompatibility||Array.add(gb,Mc);var Hc=Mc.NameUI,yd=Mc.NameDataStrings;this.Ccd[yd.toUpperCase()]||(this.Ccd[yd.toUpperCase()]=Mc);this.nWe[Hc.toUpperCase()]||(this.nWe[Hc.toUpperCase()]=Mc);if(!this.uod(Mc)){if(e){Hc=Mc.GroupUI;var we=Ng.a.Hc(this.HJa,Hc);we||(we=[],this.HJa[Hc]=we,Array.add(this.K8,Hc));Array.add(we,Mc)}Mc.IsCommonlyUsed&&Array.add(ja,Mc);Mc.IsCompatibility||Array.add(this.npg,yd)}}this.HJa[Aa]=gb;e&&(kb.lPf(ja,[2,3,0,5,4,9,1,7,8,6]),ja=Array(14),
ja[0]=0,ja[1]=1,ja[2]=7,ja[3]=11,ja[4]=5,ja[5]=2,ja[6]=6,ja[7]=10,ja[8]=9,ja[9]=3,ja[10]=4,ja[11]=13,ja[12]=12,ja[13]=8,kb.lPf(this.K8,ja),ja=[],Array.addRange(ja,this.K8),Array.removeAt(ja,13),this.K8=ja);this.fT=Array.clone(this.fT);this.fT.sort(function($e,Gf){return $e.NameDataStrings.localeCompare(Gf.NameDataStrings)});ja=1;for(Aa=this.K8.length;ja<Aa&&e;ja++)this.HJa[this.K8[ja]].sort(C);e=0;for(ja=this.fT.length;e<ja;e++)this.fT[e].FunctionIndex=e};kb.lPf=function(e,C){for(var J=Array.clone(e),
ja=0;ja<J.length&&ja<C.length;ja++)e[ja]=J[C[ja]]};Qk.Object.defineProperties(kb.prototype,{i5:{configurable:!0,enumerable:!0,get:function(){return this.KKc}},$ii:{configurable:!0,enumerable:!0,get:function(){return this.IKc}},xcd:{configurable:!0,enumerable:!0,get:function(){var e=this.fT,C=tj.a(this.$);if(!C)return e;C=C.yQh();var J=C.length;if(0>=J)return e;var ja=[];Array.addRange(ja,e);for(e=0;e<J;e++){var Aa=C[e],gb={};gb.FunctionIndex=ja.length;gb.HelpId=gb.GroupUI=null;gb.Help=Aa.description;
gb.IsCommonlyUsed=gb.IsCompatibility=!1;gb.NameDataStrings=Aa.name;gb.NameUI=Aa.name;gb.Params=null;gb.ParamsHelp=null;Array.add(ja,gb)}return ja}},cWe:{configurable:!0,enumerable:!0,get:function(){return this.K8}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(Md.a)(kb,"FunctionInfoManager",eh.a,[408,409,2]);var uj=b(1124),Rj=uj.a;vm(wb,Rj);wb.prototype.setVisible=function(e){Bd.DOMElementExtensions.setVisible(this.domElement,e);e||(this.domElement.style.top="auto",this.domElement.style.left=
"auto")};wb.prototype.isRtl=function(){return this.jj};wb.prototype.S1e=function(){return this.domElement.parentNode};wb.prototype.DRa=function(e){var C=this.domElement.style;C.cursor="move";C.position=e?"relative":"absolute"};Object(Md.a)(wb,"FunctionParamBoxDraggableItem",uj.a,[]);Object(Md.a)(Ec,"FormulaArgumentAssistanceCallbacks",null,[]);Object(Md.a)(Ob,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(Md.a)(db,"ArgumentAssistanceRequest",null,[]);Ga.prototype.ka=function(e){(this.root=
e)&&!this.gn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.gn=!0)};Ga.prototype.detach=function(){this.root&&this.gn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.gn=!1)};Ga.prototype.K7b=function(){this.root&&(this.target=this.aH.lEf("move",!0),this.yTd=this.target.getBoundingClientRect(),this.MZ=!0,this.BQd=!1,this.hv(),this.glc||this.b4c(),this.target.appendChild(this.glc))};Ga.prototype.h4=function(e){this.aH.Fxf(void 0===e?!1:e);this.MZ=!1;this.DId();this.bId();
this.yTd=this.target=void 0};Ga.prototype.hv=function(){this.pr.capture(this.TMa,null);this.pointerInputManager.nt(Ue.a.pointerDown,this.target,this.iFb,!0);this.target.addEventListener("blur",this.onBlur)};Ga.prototype.bId=function(){this.pr.releaseCapture();this.pointerInputManager.tt(Ue.a.pointerDown,this.target,this.iFb,!0);this.target.removeEventListener("blur",this.onBlur)};Ga.prototype.DId=function(){var e;this.target&&(null===(e=this.glc)||void 0===e?void 0:e.parentNode)===this.target&&this.target.removeChild(this.glc)};
Ga.prototype.W5=function(e,C){var J=this.target.getBoundingClientRect();e+=J.left-this.yTd.left;C+=J.top-this.yTd.top;this.aH.onMove(e,C)};Ga.prototype.b4c=function(){this.glc=Aj.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(Md.a)(Ga,"FormulaAssistanceMoveAdapter",null,[]);var lk=b(268);ya.prototype.oba=function(){return this.gn&&!!this.Yja};ya.prototype.vOa=function(e){this.Yja.style.cursor="grabbing";this.IGj=e.clientPoint.x;this.JGj=e.clientPoint.y;this.aH.lEf("drag");
return!0};ya.prototype.Yla=function(e){this.aH.onMove(e.clientPoint.x-this.IGj,e.clientPoint.y-this.JGj);return!0};ya.prototype.Xla=function(){this.Lt()};ya.prototype.Wla=function(){this.Lt()};ya.prototype.ka=function(e){if(this.Yja=e)this.Yja.style.cursor="grab",lk.a.instance.h0(this.Yja,this),this.gn=!0};ya.prototype.detach=function(){this.gn&&this.Yja&&(this.Yja.style.cursor="",lk.a.instance.U7(this.Yja,this),this.gn=!1)};ya.prototype.Lt=function(){this.Yja.style.cursor="grab";this.aH.Fxf()};Object(Md.a)(ya,
"FormulaAssistanceDragAdapter",null,[524]);xa.prototype.ka=function(e,C,J,ja){this.root=e;this.render=J;this.dismiss=ja;this.detach();C&&(this.PJe.ka(C),this.jrf.ka(e.firstChild),this.gn=!0)};xa.prototype.detach=function(){this.gn&&(this.PJe.detach(),this.jrf.detach(),this.gn=!1);Bd.DOMElementExtensions.Tf(this.placeholder)};xa.prototype.clear=function(){this.g$b.setOverrideTarget(void 0);this.detach();this.sKd()};xa.prototype.lEf=function(e,C){C=void 0===C?!1:C;this.usageCount[e]+=1;this.pyc=this.root.firstChild.getBoundingClientRect();
this.placeholder=this.root.cloneNode(!0);e=this.placeholder.firstChild;e.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);C&&(this.LEd=document.activeElement,e.tabIndex=0,e.focus());this.dismiss();return e};xa.prototype.onMove=function(e,C){e=Math.min(Math.max(e,this.KCc-this.pyc.left),window.innerWidth-this.pyc.right-this.KCc);C=Math.min(Math.max(C,this.KCc-this.pyc.top),window.innerHeight-this.pyc.bottom-this.KCc);this.placeholder.firstChild.style.transform="translate("+
e+"px, "+C+"px)"};xa.prototype.Fxf=function(e){var C=this;e=void 0===e?!0:e;var J=this.placeholder.firstChild.getBoundingClientRect(),ja=this.g$b.getDirectionalHint({top:J.top,left:J.left});this.g$b.setOverrideTarget({top:1===ja?J.bottom:J.top,left:J.left});this.render();window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){Bd.DOMElementExtensions.Tf(C.placeholder);C.LEd&&(e&&C.LEd.focus(),C.LEd=void 0)})})};xa.prototype.sKd=function(){var e=ra.instance.Eaa,C=this.usageCount[Oj.Drag],
J=this.usageCount[Oj.Move];0<C&&(e.argumentAssistanceDragCounter+=1,e.argumentAssistanceDragTotalCounter+=C,this.usageCount[Oj.Drag]=0);0<J&&(e.argumentAssistanceMoveCounter+=1,e.argumentAssistanceMoveTotalCounter+=J,this.usageCount[Oj.Move]=0)};Object(Md.a)(xa,"FormulaAssistanceDragControl",null,[]);var Oj;(function(e){e.Drag="drag";e.Move="move"})(Oj||(Oj={}));Object(Md.b)("FormulaAssistanceDragMode",Oj);var Ak=Ah.a;vm(fb,Ak);fb.prototype.Hne=function(e){this.addHandler("FAFunctionNameUpdated",
e)};fb.prototype.QQf=function(e){this.removeHandler("FAFunctionNameUpdated",e)};fb.prototype.woe=function(e){this.addHandler("FAParameterSelectionChangedOld",e)};fb.prototype.nRf=function(e){this.removeHandler("FAParameterSelectionChangedOld",e)};fb.prototype.voe=function(e){this.addHandler("FAParameterSelectionChanged",e)};fb.prototype.mRf=function(e){this.removeHandler("FAParameterSelectionChanged",e)};fb.prototype.set_visible=function(e){this.Um?e||this.Rrb():Sys.UI.Control.prototype.set_visible.call(this,
e);return e};fb.prototype.Rrb=function(){this.formulaAssistanceUIControl&&(this.Nq=null,this.gR&&this.aH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.hla=null,this.jr.canReceiveFocus=!1)};fb.prototype.show=function(e){this.Um||(ra.instance.A7(["argumentAssistanceRender"]),this.A1a.setVisible(!!e),ra.instance.iZ(["argumentAssistanceRender"]),this.MWc&&(this.MWc=!1,ra.instance.w7b("argumentAssistanceOverall")))};fb.prototype.Lgj=function(){var e=this;if(!this.lba||this.TRa){ra.instance.A7(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);var C=Oe.g(this.$).xj;this.pluginScheduler.requester().argumentAssistance(Object.assign(new db,{content:C.text,caretPosition:C.textBox.caretPosition})).then(function(J){0===J.kind?J.payload?(ra.instance.iZ(["argumentAssistanceComputation"]),e.tAj(e.gEd(J.payload),C.textBox.domElement)):e.Rrb():ra.instance.iZ(["argumentAssistanceComputation"],!1);return null})}};fb.prototype.update=function(e,C,J,ja){if(!this.Um&&e){ra.instance.A7(["argumentAssistanceComputation","argumentAssistanceOverall"]);
this.MWc=!0;var Aa=this.$.listSeparator;try{var gb=$get(ib.Acd,this.wj),bc=$get(ib.tcd,this.wj);gb.innerText="";bc.innerText="";var Mc=$get(ib.jWe,this.wj),Hc=e.Params.split(ib.v$c);gb=[];bc=0;for(var yd=Mc.rows.length;bc<yd;bc++){var we=Mc.rows[bc];Bd.DOMElementExtensions.setVisible(we,bc<Hc.length);var $e=Hc[bc],Gf=ib.KXi+bc+"_",ag=e.NameDataStrings;$get(Gf+ib.NEb,we).innerText=ag;$get(Gf+ib.LCd,we).innerText=ag;if($e){var Nf=Hc[bc].split(Aa),Pg=fb.Und(Nf[Nf.length-1]),Jh=fb.oli(e);Pg&&(Jh&&(2<
Nf.length?(Nf[Nf.length-2]+="1",Nf[Nf.length-3]+="1"):Gd.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",ag,Nf.length.toString(),C)),fb.mKg(Nf,Jh,C,e));$e=Nf.join(Aa.toString()+" ");Hc[bc]=$e;J<Nf.length?(gb[bc]=Nf[J],Gd.ULS.shipAssertTag(537162072,0,!!Nf[J]&&1<=Nf[J].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
J,Nf.length,ag,bc),Nf[J]=String.format("{0}{1}{2}","<b>",Nf[J],"</b>"),$e=Nf.join(Aa.toString()+" ")):Gd.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+J+"currRowParamsArray.Length = "+Nf.length+", current row = "+bc);ja&&Gd.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",ag,Nf.length,Pg,Jh,C)}$get(Gf+ib.MCd,we).innerHTML="("+($e||"")+")"}ja?
this.raiseEvent("FAFunctionNameUpdated",new ub(e.NameDataStrings,Hc)):this.raiseEvent("FAParameterSelectionChangedOld",new Gb(Hc,gb,J));Mc.className=Th.a.Tqh+(this.functionInfoManager.uod(e)?"-udf":"")}catch(jj){throw Gd.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",e.NameDataStrings,C,jj),jj;}ra.instance.iZ(["argumentAssistanceComputation"])}};fb.prototype.dispose=function(){this.Um||(this.xc.HA(),fg.a.Fa(this.xc),Oe.g(this.$).view.Mq(this.ht),
fg.a.Fa(this.A1a),this.A1a=null);this.Um&&fg.a.Fa(this.jr);this.lba&&Oe.g(this.$).qc.Mn(this.Jg);this.functionInfoManager=this.$=null;Ak.prototype.dispose.call(this)};fb.prototype.gEd=function(e){var C=new Ob;C.functionRenderingInfo=e;C.cardMode=this.K2;this.SHd(C);return C};fb.prototype.SHd=function(e){e.callbacks=new Ec;e.callbacks.onHelpLink=this.bfd(e.functionRenderingInfo);e.callbacks.onCardModeChange=this.onCardModeChange;e.callbacks.onFeedback=this.gRa;this.lba&&(e.callbacks.onDismissClick=
this.onDismissClick)};fb.prototype.tAj=function(e,C){var J=this;if(this.formulaAssistanceUIControl){ra.instance.A7(["argumentAssistanceRender"]);var ja={};ja.zoomLevel=O(this.$);this.formulaAssistanceUIControl.updateContext(ja);this.Nq=function(){J.formulaAssistanceUIControl.renderArgumentAssistanceCard(J.domElement,C,e)};this.Nq();this.lDd(e);this.gR&&this.aH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Nq,function(){return J.formulaAssistanceUIControl.dismiss(J.domElement)});
this.jr.canReceiveFocus=!0;ra.instance.iZ(["argumentAssistanceRender"]);ra.instance.w7b("argumentAssistanceOverall")}};fb.prototype.bfd=function(e){var C=this;return function(){Ba(C.$,e.helpID,e.isUDF)}};fb.prototype.DOd=function(){var e=Lj.a.get(Ca.a.l_b);this.K2=e?parseInt(e,10):fb.W5c;ra.instance.NYf(this.K2)};fb.prototype.lDd=function(e){var C=e.functionRenderingInfo.functionName;this.hla&&E.a.equals(this.hla,C,!0)?(C=gh.a.map(e.functionRenderingInfo.signatures,function(J){var ja="";0<=J.signatureParams.activeParam&&
J.signatureParams.activeParam<J.signatureParams.params.length&&(ja=J.signatureParams.params[J.signatureParams.activeParam]);return ja}),this.raiseEvent("FAParameterSelectionChanged",new Za(C))):(this.hla=C,e=gh.a.map(e.functionRenderingInfo.signatures,function(J){return J.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ub(C,e)))};fb.prototype.kNb=function(e){this.K2=e;try{Lj.a.pv(Ca.a.l_b,e.toString(),fk.AFrame.uea)}catch(C){Gd.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",
C.message)}};fb.Und=function(e){return E.a.contains(e,ib.k7b,!0)};fb.oli=function(e){return!!e&&E.a.M1a(e.NameDataStrings,"IFS")};fb.mKg=function(e,C,J,ja){try{if(!e||2>e.length)Gd.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",ja.NameDataStrings,e?e.length.toString():"currRowParamsArray == null",C,J);else{for(var Aa=e.pop().toString(),gb=e.length-1;gb<J;gb++){var bc=e[gb].trim();if(C){var Mc=
e[gb-1].trim();e.push(fb.rIh(Mc,bc))}else{var Hc=fb.Z$e(bc);e.push(fb.QWe(Hc))}}e.push(Aa)}}catch(yd){throw Gd.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",ja.NameDataStrings,e?e.length.toString():"currRowParamsArray == null",C,J,yd),yd;}};fb.rIh=function(e,C){e=fb.Z$e(e);var J=fb.R1e(e);C=fb.R1e(C);return fb.QWe(e,!0,!!J&&!!C&&J!==C)};fb.Z$e=function(e){var C=e.match(fb.Dyd);
e=E.a.trimEnd(E.a.trimStart(e,ib.fGf),ib.eGf);if(C&&C.length){C=C[C.length-1];var J=Number.parseLocale(C)+1;e=e.replace(C,J.toString())}else e=String.format("{0}{1}",e,1);return e};fb.QWe=function(e,C,J){var ja="[{0}]";(void 0===C?0:C)&&(ja=(void 0===J?0:J)?"[{0}":"{0}]");return String.format(ja,e)};fb.R1e=function(e){return(e=e.match(fb.Dyd))&&e.length?e[0]:null};fb.LJa=function(e){if(e)return document.createElement("div");e=String.format(ib.OGf,ib.MGf,ib.LCd,Th.a.jOe,ib.NEb,Th.a.iOe,ib.MCd);var C=
String.format(ib.OGf,ib.NGf,ib.LCd,Th.a.jOe,ib.NEb,Th.a.iOe,ib.MCd);e=String.format(ib.MGh,ib.NGh,Th.a.fPe,Th.a.Vmh,k.a.Wo,ib.jWe,e,C);C=document.createElement("div");C.innerHTML=e;return C.firstChild};fb.Dyd=RegExp("\\d+");fb.W5c=0;Object(Md.a)(fb,"FormulaArgumentAssistanceControlDeprecated",Ah.a,[535]);Object(Md.a)(Db,"ParseContext",null,[]);var Ik=b(315),Ok=gk.a;vm(pb,Ok);pb.prototype.Qh=function(e,C){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==C&&-1231471547!==C||this.L5a&&!this.dIe()||
(this.NV=!1);return Ok.prototype.Qh.call(this,e,C)};pb.prototype.ezd=function(){var e=this.qLa;if(e||this.ZQd){this.formulaAssistanceControl.Ya=this.Ya;if(this.L5a&&(ra.instance.yob.formulaAssistanceRequestAttemptedCounter++,!this.dIe())){ra.instance.yob.formulaAssistanceRequestOptimizedCounter++;return}if(!e&&this.ZQd)this.formulaAssistanceControl.wse();else if(xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.O9h){if(e=this.$.Wb.Ic("LoadingUIShown",
"FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.yse(),e.stop(),this.sob.text.endsWith("[")&&"["!==this.sob.text.charAt(this.sob.text.length-2)){var C=""===this.PHa?this.formulaAssistanceControl.tableManager.Lg:Object(X.a)(Ik.a,this.$.zb.getItemByName(this.PHa));Gd.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
C.hj,e.Ec,this.eld,this.NV)}}else this.formulaAssistanceControl.gob(),this.JFf&&(this.JFf=this.NV=!1)}else this.NV=!1};pb.prototype.ej=function(){this.Laj||(this.XRa=null,this.ZQd&&this.formulaAssistanceControl.zZ())};pb.prototype.Jg=function(){this.NV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.qtc();this.Um&&this.vvi()};pb.prototype.AFd=function(e,C){return this.formulaAssistanceControl.Qh(e,C)};pb.prototype.vvi=function(){this.formulaAssistanceControl.KAa&&(ra.instance.CJa.smartSuggestionShownCounter++,
this.formulaAssistanceControl.KAa=!1);this.formulaAssistanceControl.oSa&&(ra.instance.CJa.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.oSa=!1);this.formulaAssistanceControl.jLb&&(ra.instance.CJa.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.jLb=!1)};pb.prototype.BVg=function(e,C){for(var J=0,ja;-1!==J;)if(J=e.indexOf("[",J+1),-1!==J&&J<C&&(ja=e.indexOf("]",J+1),-1===ja||ja>=C))return J;return-1};pb.prototype.dIe=function(){var e=this.Ya.text,C=this.Ya.textBox.caretPosition,
J=this.formulaAssistanceControl.bNa,ja=this.formulaAssistanceControl.aNa;if(this.NV&&E.a.equals(e,J,!0)&&C===ja)return!1;this.formulaAssistanceControl.bNa=e;this.formulaAssistanceControl.aNa=C;return!0};Qk.Object.defineProperties(pb.prototype,{nyb:{configurable:!0,enumerable:!0,get:function(){return Object(nf.a)(Qb,this.$.Ab.hh)}},NV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(e){this.formulaAssistanceControl.isListVisible=e}},qLa:{configurable:!0,
enumerable:!0,get:function(){return this.Ya.qLa}},O9h:{configurable:!0,enumerable:!0,get:function(){var e=this.sob.text,C=!1;if(0>=e.length)return C;var J=this.$.Wb.Ic("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),ja=Oe.g(this.$).ha.va.activeCell.clone(),Aa=e.charCodeAt(0);this.PHa="";this.wQ=this.BVg(e,this.sob.caretPosition);Aa=61===Aa&&-1!==this.wQ;if(!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Aa&&(C=!0);else if(Aa){if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Aa=
0;for(var gb=this.wQ-1;1<=gb&&!(this.wQ-gb>pb.fqf);gb--)if(Array.contains(pb.zue,e.charAt(gb))){Aa=gb;break}Aa=e.substring(Aa+1,this.wQ);e=""!==Aa?this.$.zb.getItemByName(Aa):null;gb=this.wQ;for(var bc=this.wQ+1;bc<=this.Ya.textBox.caretPosition;bc++)if("["===this.Ya.text.charAt(bc))gb=bc;else break;this.wQ=gb}else{Aa=e.lastIndexOf("[");gb=0;for(bc=Aa-1;1<=bc&&!(Aa-bc>pb.fqf);bc--)if(Array.contains(pb.zue,e.charAt(bc))){gb=bc;break}Aa=e.substring(gb+1,Aa);e=""!==Aa?this.$.zb.getItemByName(Aa):null}e&&
2===e.type?(C=!0,this.PHa=Aa):Oe.g(this.$).Sb.Wj(ja)&&(C=!0,this.PHa="")}J.stop();this.eld=J.Ec;Gd.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.eld);return C}},key:{configurable:!0,enumerable:!0,get:function(){return zk.a.X2a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.FFc||(this.FFc=this.$.da.Aa(266,!1));return this.FFc}},ZQd:{configurable:!0,
enumerable:!0,get:function(){if(null!=this.XRa)return this.XRa;if(!xe.EwaSettings.la(136))return this.XRa=!1;var e=Oe.g(this.$).ha.va.activeCell.clone();if(1!==e.Opf||!e.left||Oe.g(this.$).ha.va.Ggc())return!1;var C=this.formulaAssistanceControl.tableManager.Dn(e);if(C)return this.XRa=!1;--e.left;--e.right;if(!e.isValidRange)return!1;C=this.formulaAssistanceControl.tableManager.Dn(e);return this.XRa=!!C&&e.top===C.top&&this.formulaAssistanceControl.tableManager.X3g(C,Oe.g(this.$))}}});pb.zue=" !%&'()*+,-/:;<=>@[]^{|}~".split("");
pb.fqf=255;Object(Md.a)(pb,"FormulaAutoCompleteListAutoCompleteBehavior",gk.a,[]);var Sj;(function(e){e[e.function=0]="function";e[e.field=1]="field";e[e.definedName=2]="definedName";e[e.letVariable=3]="letVariable";e[e.tableColHeaderName=4]="tableColHeaderName";e[e.tableSpecialStructRef=5]="tableSpecialStructRef";e[e.pendingData=6]="pendingData";e[e.tableNamedObject=7]="tableNamedObject"})(Sj||(Sj={}));Object(Md.b)("ItemType",Sj);var dl=b(1189),jl=b(1188);Ta.prototype.execute=function(e){Array.add(e,
this.index)};Object(Md.a)(Ta,"AppendIndexOperation",null,[558]);Ja.prototype.execute=function(){};Object(Md.a)(Ja,"NopIndexOperation",null,[558]);ma.prototype.execute=function(e){for(var C=0;C<e.length;C++)e[C]===this.D1i&&(e[C]=this.osf)};Object(Md.a)(ma,"ReplaceIndexOperation",null,[558]);hc.prototype.DEe=function(e,C){var J=new Ta(C);if(!vg.a.rod())return J;e=this.Zpi(e,C);return null!=e?this.items[e].Bzb?new ma(e,C):new Ja:J};hc.prototype.Zpi=function(e,C){var J=this,ja=this.items[C];Gd.ULS.shipAssertTag(537162075,
0,!!ja,"Internal error: invalid item index");e=L.where(L.asEnumerable(e),function(Aa){return J.items[Aa].name===ja.name});return L.Ct(e)?L.first(e):null};Object(Md.a)(hc,"FilterItemOperationFactory",null,[]);Object(Md.a)(lb,"CompletionItem",null,[]);var M="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+k.a.Wo+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+k.a.Wo+"'>{5}</td>\r\n</tr>",oa="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
k.a.Wo+"'></td>\r\n\t<td id='item_type_cell' class='"+k.a.Wo+"'>{2}</td>\r\n</tr>",Xa="<td>\r\n\t<div class='"+k.a.fr+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",Sb="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+k.a.Wo+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+k.a.Wo+"'>{2}</td>\r\n</tr>",xc=dl.a;vm(Ia,xc);Ia.prototype.xoe=function(e){this.addHandler("FLBSelectedRowChanged",e)};Ia.prototype.oRf=
function(e){this.removeHandler("FLBSelectedRowChanged",e)};Ia.prototype.bVc=function(e){this.addHandler("ACLBUpdated",e)};Ia.prototype.iJd=function(e){this.removeHandler("ACLBUpdated",e)};Ia.prototype.dispose=function(){xc.prototype.dispose.call(this);this.jra=this.kWe=this.aub=null};Ia.prototype.Yyc=function(e,C,J,ja){ja=void 0===ja?0:ja;this.Yff||this.G7(!1);var Aa="";J&&(Aa+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",Th.a.o_g,
J));Aa+=String.format("<table class='{0}' aria-live='off'><tbody>",this.Rba);for(var gb=new va.a,bc=0,Mc=this.yW.length;bc<Mc;bc++)Aa+=this.$3e(e[this.yW[bc]],bc+1,C,ja),this.Um&&gb.add(this.QYe(e[this.yW[bc]]));bc=this.yW.length;Mc=0;for(var Hc=this.$r.length;Mc<Hc;Mc++)Array.contains(this.yW,this.$r[Mc])||(bc++,Aa+=this.$3e(e[this.$r[Mc]],bc,C,ja),this.Um&&gb.add(this.QYe(e[this.$r[Mc]])));this.gg.innerHTML=Aa+"</tbody></table>";this.Gn=Bd.DOMElementExtensions.Aj(this.domElement,this.Rba);this.Um&&
(this.b2c=gb.toArray());this.Yff?(this.isListVisible=!0,this.jGa.set_visible(!0)):(this.G7(!0),this.oIg(!!J))};Ia.prototype.kJa=function(e,C,J,ja,Aa,gb){ja=void 0===ja?"":ja;Aa=void 0===Aa?0:Aa;gb=void 0===gb?!1:gb;if(e){var bc=[],Mc=[];this.iLb=0;var Hc=new hc(this.$,e);if(C){var yd=!!C&&0<Aa,we=yd&&91===C.charCodeAt(Aa+1)?Aa+2:Aa+1;gb=yd?C.length===we:!1;yd&&C.length===Aa&&xe.EwaSettings.la(136)&&(gb=!0);var $e=null;!gb&&yd&&C.length>Aa+1&&($e=C.substring(we,C.length));if(C)for(yd=0,we=e.length;yd<
we;yd++){var Gf=e[yd].name;if(!e[yd].ehi){var ag=Hc.DEe(bc,yd);e[yd].Bzb&&this.iLb++;if(!$e&&!gb||0===e[yd].itemType)Mc=this.FTe(C,Gf,J,ag,bc,Mc),bc=Mc.gaf,Mc=Mc.TIf;$e&&1===e[yd].itemType&&(Mc=this.FTe($e,Gf,!0,ag,bc,Mc),bc=Mc.gaf,Mc=Mc.TIf);gb&&1===e[yd].itemType&&ag.execute(bc)}}}else for(J=0;J<e.length;++J)if(e[J].Bzb||gb)$e=Hc.DEe(bc,J),$e.execute(bc),$e.execute(Mc),e[J].Bzb&&this.iLb++;this.yW=Mc;this.$r=bc;this.Yyc(e,C,ja,Aa)}};Ia.prototype.nTj=function(e){if(e&&!(1<e.length)){var C=[],J=[];
C.push(0);J.push(0);this.yW=C;this.$r=J;this.Yyc(e,"","",0)}};Ia.prototype.Xxa=function(){this.Lk&&xc.prototype.Xxa.call(this)};Ia.prototype.V4i=function(e,C){this.raiseEvent("ACLBUpdated",new jl.a(e,void 0,void 0,C))};Ia.prototype.yeg=function(e){var C=this.Gn.rows[e];return(!this.Lk||this.Lk!==C)&&e<this.Gn.rows.length?(this.Lk=C,!0):!1};Ia.prototype.gnc=function(e){nh.g(e.Ea);0===this.Hw||2===this.Hw||3===this.Hw||4===this.Hw||5===this.Hw||7===this.Hw?(this.raiseEvent(Hk.a.q4a),this.Xxa()):1===
this.Hw?this.jGa.Ly(!1):(this.jGa.Ly(!1),e=Oe.g(this.$),e.Qq(!1),e.focus());return!0};Ia.prototype.oIg=function(e){this.Mra();if(e){var C=this.Gn.offsetWidth+(this.$r.length>this.$H?Fi.a.fq:0);e=$get("list_column_header");e.offsetWidth>C&&Bd.DOMElementExtensions.Tq(this.gg,e.offsetWidth);C=this.gg.getElementsByClassName(this.m_);for(var J=0;J<C.length;J++)C[J].style.width=Lb.HelperMethods.Rb(e.offsetWidth)}};Ia.prototype.$3e=function(e,C,J,ja){if(1===e.itemType){var Aa=Dg.a.Lf(e.name),gb=Dg.a.Lf(ja?
J.substring(ja+1,J.length):J),bc=0;Aa.substring(0,gb.length).toLowerCase()!==gb.toLowerCase()&&(bc=Ia.oGj(Aa,ib.khg,gb));J="";J=0<=bc?J+(Aa.substring(0,bc)+"<b>"+Aa.substring(bc,bc+gb.length)+"</b>"+Aa.substring(bc+gb.length,Aa.length)):J+Aa;ja=ja?String.format(Xa,k.a.KPe,Dg.a.AV(fh.a.Fe(0)),ue.a.instance.fa(699)):"";return String.format(oa,ja,C,Sj[e.itemType],this.m_,J)}if(5===e.itemType)return String.format(Sb,"",C,Sj[e.itemType],this.m_,Dg.a.Lf(e.name),Dg.a.Lf(e.lja));if(4===e.itemType)return String.format(Sb,
"(...)",C,Sj[e.itemType],this.m_,Dg.a.Lf(e.name));if(6===e.itemType)return ja=ja?String.format(Xa,k.a.KPe,Dg.a.AV(fh.a.Fe(0)),ue.a.instance.fa(699)):"",String.format(M,ja,this.m_,Dg.a.Lf(e.name),Dg.a.Lf(e.lja),C,Sj[e.itemType]);ja=String.format(Xa,2===e.itemType||3===e.itemType?k.a.Vuh:k.a.Tuh,Dg.a.AV(fh.a.Fe(0)),ue.a.instance.fa(696));return String.format(M,ja,this.m_,Dg.a.Lf(e.name),Dg.a.Lf(e.lja),C,Sj[e.itemType])};Ia.prototype.QYe=function(e){var C=new lb;C.label=e.label;C.textEdit=e.textEdit;
C.kind=Ia.aNh(e.itemType);C.type=e.Bzb?1:0;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===C.kind){var J=this.formulaAssistanceControl.lRh(e.label);C.detail=J?J:e.lja}else C.detail=e.lja;return C};Ia.prototype.FTe=function(e,C,J,ja,Aa,gb){E.a.equals(C,"Pretend this is the line.",!1)&&0<Aa.length||E.a.yL(C,e)?(ja.execute(Aa),ja.execute(gb)):J&&e.length>=ib.$3g&&Ia.Cdh(C,ib.khg,e)?ja.execute(Aa):!J&&e.length>=ib.Z3g&&E.a.contains(C,e,!0)&&ja.execute(Aa);return{gaf:Aa,
TIf:gb}};Ia.aNh=function(e){switch(e){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};Ia.Cdh=function(e,C,J){C=yl(C);for(var ja=C.next();!ja.done;ja=C.next())if(ja=e.split(ja.value),!(2>ja.length)){ja=yl(ja);for(var Aa=ja.next();!Aa.done;Aa=ja.next())if(E.a.yL(Aa.value,J))return!0}return!1};Ia.oGj=function(e,C,J){C=yl(C);for(var ja=C.next();!ja.done;ja=C.next())if(ja=e.toLowerCase().indexOf((ja.value+
J).toLowerCase()),0<ja)return ja+1;return-1};Qk.Object.defineProperties(Ia.prototype,{Khc:{configurable:!0,enumerable:!0,get:function(){return 0<this.iLb&&this.iLb===this.$r.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(ri.a)(Ia.prototype,this,"isListVisible")},set:function(e){Object(ri.b)(Ia.prototype,this,"isListVisible",e);e||(this.Muc=0,this.re=null);0===this.Muc?Bd.DOMElementExtensions.setVisible(this.aub,e&&!this.Um):Bd.DOMElementExtensions.setVisible(this.aub,
!1)}},Lk:{configurable:!0,enumerable:!0,get:function(){return this.jra},set:function(e){this.jBa(this.Lk);if(e){this.kWe.innerText="";this.jra=e;var C=this.jBa(this.Lk),J=e.rowIndex+1,ja=$get("description_cell"+J,e);this.aub.innerText=ja.innerText;var Aa=$get("item_type_cell",e);this.re=C=C.innerText;this.Muc="field"===Aa.innerText?1:"definedName"===Aa.innerText?2:"letVariable"===Aa.innerText?3:"tableColHeaderName"===Aa.innerText?4:"tableSpecialStructRef"===Aa.innerText?5:"pendingData"===Aa.innerText?
6:"tableNamedObject"===Aa.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new jl.a(this.$r.length,J,C,ja.innerText));this.uuc(e)}}},bTa:{configurable:!0,enumerable:!0,get:function(){return this.aub}},jGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},Hw:{configurable:!0,enumerable:!0,get:function(){return this.Muc}}});Object(Md.a)(Ia,"FormulaAutoCompleteListBox",dl.a,[534]);Qk.Object.defineProperties(eb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
toolTip:{configurable:!0,enumerable:!0,get:function(){return this.v9}}});Object(Md.a)(eb,"LETVariableInfo",null,[]);Qk.Object.defineProperties(Na.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Md.a)(Na,"TableColHeaderNameInfo",null,[]);Qk.Object.defineProperties(Ya.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Md.a)(Ya,"TableNamedObjectInfo",null,[]);Qk.Object.defineProperties(Ha.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.v9}}});Object(Md.a)(Ha,"TableSpecialStructRefInfo",null,[]);var jd=b(186),vd=b(176);Object(Md.a)(Pa,"FormulaAutoCompleteCallbacks",null,[]);Object(Md.a)(pa,"FormulaAutoCompleteRenderingInfo",null,[]);Object(Md.a)(qa,"CellMessage",null,[]);Object(Md.a)(ea,"FunctionSuggestionRequest",null,[]);Object(Md.a)(ia,"RunExperimentRequest",null,[]);var ae=Sh.a;vm(ca,ae);ca.prototype.Fne=function(e){this.addHandler(ca.jcd,
e)};ca.prototype.PQf=function(e){this.removeHandler(ca.jcd,e)};ca.prototype.Dne=function(e){this.addHandler(ca.Dbd,e)};ca.prototype.NQf=function(e){this.removeHandler(ca.Dbd,e)};ca.prototype.Ene=function(e){this.addHandler("FormulaAutoCompleteShown",e)};ca.prototype.OQf=function(e){this.removeHandler("FormulaAutoCompleteShown",e)};ca.prototype.set_visible=function(e){this.hja.set_visible(e);this.Um&&!e&&this.p1a();Sys.UI.Control.prototype.set_visible.call(this,e);return e};ca.prototype.IUg=function(e,
C){this.isListVisible&&(e+=ib.openParen,C++,this.QCd(e,C));var J=0<C&&e.charAt(C-1)===ib.openParen,ja=C===e.length||e.charAt(C)===ib.closeParen;if(!J||!ja)return Gd.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",C,!e.length,!!this.vQ),!1;J=e.substring(0,C).lastIndexOf(this.$.listSeparator);ja=e.substring(0,C-1).lastIndexOf(ib.openParen);e=e.substring(-1===J&&-1===ja?1:Math.max(J,
ja)+1,C-1).trim();return this.functionInfoManager.Ted(e)?!0:(Gd.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.vQ),!1)};ca.prototype.fdi=function(e,C){var J=this.IUg(e,C);if(!J||!this.vQ)return Gd.ULS.shipAssertTag(537162051,0,!J||J&&!!this.vQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,ksf:0,zUe:0};J=this.vQ.Params;J=
J.replace(RegExp("[\\[\\]]","g"),"");var ja=e.charAt(C-1)===ib.openParen,Aa=ja?"":"(",gb=C===e.length?")":"";var bc=this.$.listSeparator;bc=J.includes(bc)?J.indexOf(bc):J.length;return{returnValue:e.substring(0,C)+Aa+J+gb+e.substring(C,e.length),ksf:ja?C:C+1,zUe:bc}};ca.prototype.ht=function(e,C){this.Um&&void 0!==this.Nq&&null!==this.Nq&&this.Nq();this.Um||ae.prototype.ht.call(this,e,C)};ca.prototype.dispose=function(){if(this.$){this.FSa(!1);var e=Oe.g(this.$);e&&(e.ha&&(this.Um?e.ha.UF(this.od):
e.ha.lda(this.od),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")&&e.ha.Gza(this.Wyd)),e.view.Mq(this.Ymc));this.Um&&this.$.xa&&this.$.xa.ug(this.hi)}this.functionInfoManager&&(this.functionInfoManager.dHb(this.onFunctionInfoLoaded),this.functionInfoManager.Acj(this.wyf));this.nh&&this.nh.usc(this.rya);this.Um&&this.Kf&&this.Kf.oRf(this.nDf);vg.a.ifc&&this.Ya&&this.Ya.XGb(this.m6);this.V7f(!1);fg.a.Fa(this.Kf);fg.a.Fa(this.x_b);fg.a.Fa(this.hja);this.yka&&fg.a.Fa(this.jr);
this.Ya=this.functionInfoManager=this.nh=null;fg.a.sc(this.zJa);this.Lg=this.m8=this.hja=this.zJa=null;ae.prototype.dispose.call(this)};ca.prototype.Kwa=function(){return!this.Nv};ca.prototype.cki=function(){return!this.kGa};ca.prototype.Qh=function(e,C){if(!this.Kwa()){if(this.Um&&this.lN){if(125627505===C||267796030===C)return this.mba&&this.VAc(C),this.aBe(),!1;if(1872288872===C)return this.fda(),this.isListVisible=!1,!0;if(this.Kf.Khc&&(-798660877===C||137938150===C))return!1}if(1!==this.Kf.Hw||
125627505!==C&&267796030!==C)if(6===this.Kf.Hw){var J=e.keyCode;13!==J&&9!==J||this.Ly(!1)}else{if(4===this.Kf.Hw||5===this.Kf.Hw)return ae.prototype.Qh.call(this,e,C,!0);1===this.Kf.yW.length&&(J=e.keyCode,this.Qwe=8===J||127===J||46===J?!0:!1)}else{if(this.Ly(!1)&&!this.lka)return Oe.g(this.$).ha.Qh(e,C);if(125627505===C&&this.lka)return!0}}return ae.prototype.Qh.call(this,e,C)};ca.prototype.qtc=function(){this.nh.ubb();this.m8=null;null==this.Uia||this.Uia||this.Ejc("NoFieldChosen",1,2,1);this.Uia=
null;this.O3=0;this.C5=this.Frd=this.hpc=null};ca.prototype.gob=function(){var e=this,C=!!this.Ya&&!kf.f(this.$.pa);if((this.JAa||this.Yxc)&&C){var J=this.Ya.text;this.pluginScheduler.requester().functionSuggestion(Object.assign(new ea,{content:J})).then(function(ja){0===ja.kind&&(Gd.ULS.shipAssertTag(537162050,0,!!ja&&!!ja.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),ja=L.toArray(L.select(L.asEnumerable(ja.payload.items),function(Aa){return ca.U2g(Aa)})),
e.Yxc&&"="===J&&0<ja.length&&e.gridView.D1a.xsj("="+ja[0].textEdit.newText),e.JAa&&(e.nSa=ja,wg.AFrameworkApplication.Hg||e.xse(C,!0)));return null})}this.JAa&&C||this.xse(C,!1)};ca.prototype.Y3e=function(){if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var e=Oe.g(this.$).Cj?this.Utb.wQ:this.Apb.wQ;"@"===this.Ya.text.charAt(e+1)&&this.Ya.textBox.caretPosition>e+1?this.Ndb=e+2:this.Ndb=e+1}else{e=this.Ya.text.lastIndexOf(ib.blf);var C=this.Ya.text.lastIndexOf("[");
this.Ndb=e+1>=C?e+2:C+1}return this.Ya.text.substring(this.Ndb,this.Ya.textBox.caretPosition)};ca.prototype.yse=function(){this.X4f()&&(this.C$g(),this.Nv&&(this.Uia=!1,this.VV=this.Y3e(),this.Kf.kJa(this.Nv,this.VV,!0,void 0,void 0,!0),this.show(),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.hja.Rrb()))};ca.prototype.wse=function(){this.X4f()&&(this.x_b&&this.x_b.cancel(),this.nh.yyb?(this.Kwa()&&this.tDe(!0),this.get_visible()?this.BTe():
this.N1d=jd.AsyncMethodContext.Yy(this.BTe,ib.Ych,ji.a.JFh,this.x_b)):this.zZ())};ca.prototype.X4f=function(){return this.Ya?0<this.$.Ab.WN||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):kf.f(this.$.pa)?!1:!0:!1};ca.prototype.e0a=function(e){this.Ya&&this.isListVisible&&(this.jmd(this.Ya.text,e),this.Ya.textBox.caretPosition=e.range.start.character+e.newText.length,this.set_visible(!1))};ca.prototype.Ly=function(){var e;if(!this.Ya||!this.isListVisible)return!1;var C="",J=0,ja=Oe.g(this.$),
Aa=this.Ya.text,gb=0,bc=this.Kf.re,Mc=!1;if(0===this.Kf.Hw||2===this.Kf.Hw||3===this.Kf.Hw||7===this.Kf.Hw)C+=Aa.substr(0,this.Y2a)+this.Kf.re,0!==this.Kf.Hw||this.Kf.re.endsWith(")")||(C+="("),J=C.toString().length,C+=Aa.substr(this.p$b),2===this.Kf.Hw&&(gb=4,bc="DefinedName",Mc=!0,this.set_visible(!1));else if(1===this.Kf.Hw)if(this.Uia=!0,this.lka){C+=Aa.substr(0,this.O3+2);!C.toString().endsWith(P.a.NU)&&xe.EwaSettings.la(136)&&(C+=P.a.NU);gb=this.Kf.re;gb=gb.replace("'","''");gb=gb.replace("[",
"'[");gb=gb.replace("]","']");if(this.g6c||this.eBh(gb))gb=P.a.wsi+gb+P.a.Njj,Mc=!0;C+=gb;J=C.length;gb=3;vd.a("PulloutFieldAccepted")}else return this.Ya.text=this.Kf.re,this.set_visible(!1),ja.Qq(!1),ja.focus(),this.Ejc("FieldName",1,1,1),vd.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Kf.Hw)Gd.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),C+=Aa.substr(0,this.Ndb),E.a.equals(this.Kf.re,"@ - "+this.instantaneousSupportInformationManager.Ke.ThisRowStructRefString,
!1)?C+="@":(C+=this.Kf.re,Mc=!0,this.set_visible(!1)),J=C.length;else if(4===this.Kf.Hw){Gd.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");C+=Aa.substr(0,this.Ndb);Mc="";J=!1;for(var Hc=[39,91,93,64,35],yd=0;yd<this.Kf.re.length;yd++){var we=this.Kf.re.charCodeAt(yd);Array.contains(Hc,we)&&(Mc+="'");Mc+=this.Kf.re.charAt(yd).toString();J||E.a.isNumeral(we)||E.a.tff(we)||(J=!0)}Hc=Oe.g(this.$).Cj?this.Utb.wQ:this.Apb.wQ;Aa=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
"@"===Aa.charAt(Hc+1)&&J:Aa.lastIndexOf(ib.blf)+1>=Aa.lastIndexOf("[")&&J;C+=Aa?"["+Mc+"]":Mc;Mc=!0;this.set_visible(!1);J=C.toString().length}else if(6===this.Kf.Hw)C+=Aa.substr(0,this.csb);else return Gd.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=C;this.Ya.textBox.caretPosition=J;this.Ya.LMa()&&(null===(e=ja.It)||void 0===e?0:e.Lua)&&ja.It.WIb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.lv.length);
ja.Cj&&(e=ja.zc,e.text=this.Ya.text,e.setCaretPosition(this.Ya.textBox.caretPosition));bc=(null==this.Uia?0:this.Uia)?"FieldName":bc;this.Kf.Lk.sectionRowIndex>=this.Kf.yW.length?this.Ejc(bc,4,gb,0):this.Ejc(bc,1,gb,0);Mc||(5===this.Kf.Hw||4===this.Kf.Hw?this.yse():this.gob());return!0};ca.prototype.zZ=function(e,C){e=void 0===e?null:e;C=void 0===C?null:C;e?(this.nh.ubb(),this.nh.zZ(e,!1,!1,C)):(e=Oe.g(this.$),e.ha.va.qh&&(e=ud.v(e.ha.va.Td,this.$),this.nh.zZ(e,!0,!0,C)))};ca.prototype.fda=function(){this.Jfa=
!1;this.Ya.HIe()};ca.prototype.lRh=function(e){e=this.calcManager.getWorksheetFuncId(e);return this.oWe?this.oWe.descriptionsMap.get(e):null};ca.prototype.tDe=function(e){if(this.cki()){if(this.nh.yyb&&this.nh.Dk&&(!this.nh.Dk.length||!this.nh.Dk[0].FieldInfoDataList))return;this.qRj(e)}e=L.asEnumerable(this.kGa);e=L.concat(e,this.kTh(this.Ya.text));xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Um&&(e=L.concat(e,this.uUh()));L.OBc(e,function(C){return C.name},
new pg);this.JAa&&(e=L.concat(L.asEnumerable(this.nSa),e),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.nSa.length&&(this.KAa=!0),this.nSa=[]));this.m8=L.toArray(e)};ca.prototype.C$g=function(){var e=this.Ya.text;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var C=Oe.g(this.$).Cj?this.Utb.PHa:this.Apb.PHa,J=!0;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==C&&
(this.Lg=Object(X.a)(Ik.a,this.$.zb.getItemByName(C))),this.Lg||(this.Lg=this.tableManager.Lg,J=!1),!this.Lg){Gd.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",this.$.zb.count,""===C);return}}else this.Lg=Object(X.a)(Ik.a,this.$.zb.getItemByName(C)),this.Lg||(this.Lg=this.tableManager.Lg,J=!1);this.Lg.LO&&this.Lg.LO.IsFullTableHeaders?this.rIf(J):
bk.d(this.Lg)?(Gd.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Lg.hj),jg.I(this.$.na.ta,this.Lg.hj,this.xNi,this.wNi,null,null)):Gd.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",this.Lg.hj)}else if(this.calcManager&&this.tableManager.Lg)if(C=this.calcManager.Qvb(this.tableManager.Lg))if(this.calcManager.bJg(this.tableManager.Lg,
C)){e=L.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var ja=this.C0a("@ - "+this.instantaneousSupportInformationManager.Ke.ThisRowStructRefString);e=L.concat(e,(J=new va.a,J.add(ja),J))}e=L.concat(e,L.select(L.asEnumerable(C.toArray()),function(Aa){var gb=new nb,bc=new Na;bc._name=Aa.toString();gb.F0f(bc);return gb}));this.m8=L.toArray(e)}else e.endsWith("[")&&"["!==e.charAt(e.length-2)&&Gd.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",
C.count,this.tableManager.Lg.hj,this.tableManager.Lg.usedRange.right-this.tableManager.Lg.usedRange.left+1);else e.endsWith("[")&&"["!==e.charAt(e.length-2)&&Gd.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};ca.prototype.eBh=function(e){if(!e)return!1;var C=e.charCodeAt(0);if(46===C||48<=C&&57>=C||63===C)return!0;for(var J=0;J<e.length;J++,
C=e.charCodeAt(J))if(!((xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?E.a.isLetter(C):E.a.Vod(C))||92===C||95===C||63===C||48<=C&&57>=C))return!0;return!1};ca.prototype.QCd=function(e,C){var J=!1,ja=!1,Aa=!1,gb=0,bc=0;this.Y2a=0;this.p$b=C;this.Q4b=1;for(var Mc=C-1;0<=Mc;--Mc)switch(e.charCodeAt(Mc)){case 39:ja=!ja;break;case 34:J=!J;break;case 91:++gb;Aa=gb>bc;break;case 93:++bc}Aa=Object.assign(new Db,{Lsa:!J,Msa:!ja,Uha:!Aa,OEb:1});
gb=this.fYi(e,C,Aa);C=this.gYi(e,C,Aa.Lsa,Aa.Msa,Aa.Uha);this.Q4b=gb+C;if(this.jQc=gb-1)this.Vwc=!1;this.TBh(e,J,ja,Aa.sCd,Aa.tCd)};ca.prototype.Vld=function(){xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")?Oe.g(this.$).ha.Jra(this.Wyd):Oe.g(this.$).ha.HG(this.Wyd);this.vCb();vg.a.ifc&&Oe.g(this.$).xj.xYa(this.m6);ca.bMd(this.pluginScheduler);this.JAa&&this.eXg()};ca.prototype.rAh=function(){return this.JAa||this.JSe};ca.prototype.hYi=function(){var e=this.C5;if(!this.Hyj||
!e)return this.O3=0,this.kGa=this.m8=null,!1;e=e.endsWith(P.a.NU);var C;if(C=xe.EwaSettings.la(136)){C=this.QOj(this.C5.substring(0,this.P3));var J=C.sheetRange;C=C.returnValue}return C&&(C=this.C5.substring(0,this.O3),e&&C!==this.Frd)?(this.Frd=C,this.O3=this.C5.length-(e?1:0),this.zZ(J,this.C5),this.Uia=!1,Gd.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0):!1};ca.prototype.kTh=function(e){var C=new va.a;this.calcManager&&xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
Gd.ULS.shipAssertTag(537162014,0,!!this.calcManager.Zsa(Yg.Range.ld(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.JSe&&(e=this.calcManager.extractLetVariables(e,this.Ya.textBox.caretPosition))){e=yl(e);for(var J=e.next();!J.done;J=e.next()){var ja=J.value;J=new eb;J._name=ja;J.v9=ue.a.instance.fa(2152);ja=new nb;ja.usj(J);C.add(ja)}}return C};ca.prototype.uUh=function(){for(var e=new va.a,C=this.$.zb.items,J=0,ja=C.length;J<ja;J++){var Aa=
C[J];if(kf.o(Aa)){var gb=new Ya;gb._name=Aa.name;Aa=new nb;Aa.Luj(gb);e.add(Aa)}}return e};ca.prototype.C0a=function(e){var C=new nb,J=new Ha;J._name=e;C.Muj(J);return C};ca.prototype.rIf=function(e){var C=new va.a,J=this.Ya.text.charCodeAt(this.Ya.text.length-1),ja=this.Ya.textBox.caretPosition-1;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Ya.text.charCodeAt(ja):91===J){var Aa=this.C0a("@ - "+this.instantaneousSupportInformationManager.Ke.ThisRowStructRefString);
C.add(Aa)}Aa=yl(this.Lg.LO.HeadersList);for(var gb=Aa.next();!gb.done;gb=Aa.next()){gb=gb.value;var bc=new nb,Mc=new Na;Mc._name=gb.Name;bc.F0f(Mc);C.add(bc)}Aa=Oe.g(this.$).Cj?this.Utb.wQ:this.Apb.wQ;gb=this.Ya.text.charCodeAt(Aa+1);(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!e||ja!==Aa&&35!==gb:!e||91!==J&&35!==J)||(e=this.C0a("#"+this.instantaneousSupportInformationManager.Ke.AllStructRefString),C.add(e),e=this.C0a("#"+this.instantaneousSupportInformationManager.Ke.DataStructRefString),
C.add(e),e=this.C0a("#"+this.instantaneousSupportInformationManager.Ke.HeadersStructRefString),C.add(e),e=this.C0a("#"+this.instantaneousSupportInformationManager.Ke.TotalsStructRefString),C.add(e));C&&(this.m8=C.toArray())};ca.prototype.qRj=function(e){var C=L.empty();!e&&this.functionInfoManager.i5&&(C=L.concat(C,L.select(L.asEnumerable(this.functionInfoManager.xcd),function(J){var ja=new nb;ja.h_f(J);return ja})),e=this.A5b.iHe,0<e.length&&(C=L.OBc(L.concat(C,L.select(L.asEnumerable(e),function(J){var ja=
new nb;ja.Uqj(J);return ja})),function(J){return J.name},new pg)));if(this.nh.yyb&&this.nh.Dk){if(!this.nh.Dk.length||!this.nh.Dk[0].FieldInfoDataList)return;C=L.OBc(L.concat(C,L.select(L.asEnumerable(this.nh.Dk[0].FieldInfoDataList),function(J){var ja=new nb;ja.trj(J);return ja})),function(J){return J.name},new pg);this.columnName=this.nh.Dk[0].ColumnName}this.kGa=L.toArray(C)};ca.prototype.vCb=function(){var e=Oe.g(this.$).ha.va.activeCell;if(e){var C=this.calcManager.Zsa(e);if(C){var J=this.$.xa,
ja=C.sheet.index;0>=J.count||0>ja||ja>=J.count||(ja=J=null,this.dyd&&void 0!==this.calcManager&&null!==this.calcManager&&(e=Oe.g(this.$).Ca.ds(e))&&(e=this.calcManager.Ofd(e.Dm),void 0!==e&&null!==e&&(J=e.FormatString,ja=e.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new qa,{colIndex:C.range.col,rowIndex:C.range.row,sheetIndex:this.$.xa.getItem(C.sheet.index).sheetId,docName:C.sheet.document.name,docPath:C.sheet.document.path,formatString:J,builtIn:ja})))}}};ca.prototype.eXg=
function(){Oe.g(this.$).Cj?this.Utb.oU(!1):this.Apb.oU(!1)};ca.prototype.Nif=function(e){var C=xe.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?E.a.isLetter(e):E.a.Vod(e);return 48<=e&&57>=e||46===e||95===e||C};ca.prototype.show=function(){if(this.Nv){var e=this.Kf.yeg(0);this.Um?0<this.Kf.$r.length?e||this.J4f():this.p1a():((e=0<this.Kf.$r.length)&&ra.instance.A7(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&e&&this.Kf.V4i(this.Kf.$r.length,
this.columnName),this.isListVisible=e,this.hja.show(this.vQ),this.yBa(!0),this.Kf.Xxa(),e&&ra.instance.iZ(["autoCompleteRender"]))}};ca.prototype.gYi=function(e,C,J,ja,Aa){for(J=Object.assign(new Db,{WFf:41,Wze:40,Lsa:J,Msa:ja,Uha:Aa});C<e.length&&!this.SGf(e,C,J);++C);return J.OEb};ca.prototype.fYi=function(e,C,J){for(--C;0<=C&&!this.SGf(e,C,J);--C);return J.OEb};ca.prototype.SGf=function(e,C,J){var ja=e.charCodeAt(C);0>=this.P3&&(this.P3=e.substring(0,C).lastIndexOf(P.a.NU));46===ja&&(C<this.P3?
this.P3=C:C>this.csb&&(this.O3=this.csb=C));if(!this.Nif(ja)&&!ca.spi(ja)&&(!this.lka||C<=this.P3||!ca.q9h(ja,J))){J.Jwf&&(J.Jwf=!1,this.Y2a=C+1);if(J.YAd){J.tCd=C+1;if(this.functionInfoManager.Ted(e.substring(J.tCd,J.sCd)))return!0;J.YAd=!1}switch(ja){case 39:J.Msa=!J.Msa;break;case 34:J.Lsa=!J.Lsa;break;case 91:J.Uha=!1;break;case 93:J.Uha=!0}ja===this.$.listSeparator.toString().charCodeAt(0)&&J.Msa&&J.Lsa&&!J.O_a&&(!this.lka||J.Uha)&&(C<J.QMd||-1===J.QMd)&&(J.OEb+=1,this.Q4b++);ja===J.Wze&&J.Lsa&&
J.Msa&&(!this.lka||J.Uha)?J.O_a+=1:ja===J.WFf&&J.Lsa&&J.Msa&&(!this.lka||J.Uha)?0<J.O_a?--J.O_a:(J.QMd=J.yUe,J.yUe=C,0<C&&this.Nif(e.charCodeAt(C-1))&&(J.YAd=!0,J.sCd=C)):this.lka&&46===ja&&C>this.P3&&(C<this.P3?this.P3=C:C>this.csb&&(this.O3=this.csb=C))}return!1};ca.prototype.TBh=function(e,C,J,ja,Aa){this.p$b>this.Y2a&&0<=this.Y2a?C||J||(this.VV=e.substring(this.Y2a,this.p$b)):this.VV=null;ja!==Aa?(e=e.substring(Aa,ja),this.vQ&&E.a.equals(this.vQ.NameDataStrings,e,!0)||(this.Vwc=!0),this.vQ=this.functionInfoManager.Ted(e)):
(this.Vwc=!1,this.vQ=null)};ca.prototype.V7f=function(e){var C=$get(ib.MGf+"_"+ib.NEb,this.domElement),J=$get(ib.NGf+"_"+ib.NEb,this.domElement);e&&!this.ndc?(C&&ej.a.instance.qa(Ue.a.click,C,this.pca),J&&ej.a.instance.qa(Ue.a.click,J,this.pca),this.ndc=!0):this.ndc&&(C&&ej.a.instance.za(Ue.a.click,C,this.pca),J&&ej.a.instance.za(Ue.a.click,J,this.pca),this.ndc=!1)};ca.prototype.QOj=function(e){var C=this;var J=null;var ja;if(function(){var Mc=ud.Z(e,C.$.ea.xa);gb=Mc.sheetName;ja=Mc.range;return Mc}().returnValue&&
ja){if(!gb){var Aa=Object(X.a)(qh.a,this.$.pa);if(!Aa)return{returnValue:!1,sheetRange:J};var gb=Aa.name}J=ud.v(ja,this.$);J.SheetName=gb;this.g6c=!1;return{returnValue:!0,sheetRange:J}}var bc=null;return function(){var Mc=C.A5b.AOj(e);gb=Mc.sheetName;bc=Mc.range;return Mc}().returnValue?(J=ud.v(bc,this.$),J.SheetName=gb,this.g6c=!0,{returnValue:!0,sheetRange:J}):{returnValue:!1,sheetRange:J}};ca.prototype.$Ld=function(e){this.pluginScheduler.requester().runAuthoringExperiment({content:e})};ca.prototype.hec=
function(){if(1===this.Kf.yW.length&&this.Nv.length){var e=this.Nv[this.Kf.yW[0]];if(1===e.itemType){var C=e.name;e=this.Ya.text;C=C.substring(e.length,C.length);C.length&&(this.Ya.text=e+C,this.Ya.textBox.selectRange(e.length,this.Ya.text.length))}}else Gd.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Kf.yW.length)};ca.prototype.Ejc=function(e,C,J,ja){var Aa={};Aa.a=e;Aa.b=C;Aa.c=J;Aa.d=ja;ih.b().Qe(38,Aa,!0)};ca.prototype.xse=
function(e,C){if(!this.functionInfoManager.i5){if(e)if(this.QCd(this.Ya.text,this.Ya.textBox.caretPosition),this.JAa||this.VV){var J={};J.Filter=this.VV?this.VV.charAt(0).toString():"";J.FilterType=1;J.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.Dsb(J)}else xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);if(!C)return}0<this.$.Ab.WN||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):e&&(this.QCd(this.Ya.text,
this.Ya.textBox.caretPosition),this.hja.update(this.vQ,this.Q4b,this.jQc,this.Vwc),this.C5=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.P3=this.C5.indexOf(P.a.NU),this.O3=this.C5.lastIndexOf(P.a.NU),this.hYi()?(e=new nb,e.jtj(),this.kGa=this.m8=e=[e],this.Kf.nTj(e),this.show()):((this.rAh()||this.Kwa())&&this.tDe(!1),0<this.O3?this.Kf.kJa(this.Nv,this.C5,!1,void 0,this.C5.lastIndexOf(P.a.NU),!1):this.Kf.kJa(this.Nv,this.VV,!1,void 0,this.O3,!1),this.show(),this.Um&&(this.Kf.$r.length||
Oe.g(this.$).xj.eL?this.hja.Rrb():(this.hja.Lgj(),this.Um&&this.p1a()))))};ca.prototype.J4f=function(){var e=this;if(0<this.Kf.$r.length){ra.instance.A7(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var C={};C.zoomLevel=O(this.$);this.formulaAssistanceUIControl.updateContext(C);this.Nq=function(){e.formulaAssistanceUIControl.renderAutoCompleteMenu(e.domElement,Oe.g(e.$).xj.textBox.domElement,e.Ped())};this.Nq();this.gMa&&this.Kf.Khc&&this.raiseEvent(ca.jcd,null);!this.fMa||this.Nmd||
this.Kf.Khc||this.raiseEvent("FormulaAutoCompleteShown");this.yka&&(this.jr.canReceiveFocus=!0);this.Nmd=!0}ra.instance.iZ(["autoCompleteRender"]);!xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.nSa&&null!==this.nSa&&0<this.nSa.length&&(this.KAa=!0)}};ca.prototype.Otd=function(){this.kIa&&(ra.instance.N2.selectByArrowKeyCounter++,this.kIa=!1);this.lIa&&(ra.instance.N2.selectByMouseHoverCounter++,this.lIa=!1);this.jIa&&(ra.instance.N2.commitByTabKeyCounter++,
this.jIa=!1);this.hIa&&(ra.instance.N2.commitByEnterKeyCounter++,this.hIa=!1);this.iIa&&(ra.instance.N2.commitByMouseClickCounter++,this.iIa=!1)};ca.prototype.Ped=function(){var e=new pa;e.completionItems=this.Kf.b2c;e.activeItemIndex=this.Kf.Lk?this.Kf.Lk.rowIndex:-1;this.QHd(e);return e};ca.prototype.QHd=function(e){e.callbacks=new Pa;e.callbacks.onCompletionItemSelected=this.Fzd;e.callbacks.onCompletionItemCommitted=this.Ezd;e.callbacks.onFeedback=this.gRa;xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&
(e.callbacks.onDismiss=this.Gnd?this.onDismiss:this.p1a)};ca.prototype.yEd=function(e){this.Jfa=!0;var C=e.textEdit.newText;this.Ya.idb(C.substring(this.Ya.text.length-e.textEdit.range.start.character,C.length))};ca.prototype.aBe=function(){this.Ly(!0);this.Jfa=this.isListVisible=!1;this.oSa=!0};ca.prototype.jmd=function(e,C){this.Ya.text=e.substring(0,C.range.start.character)+C.newText+e.substring(C.range.end.character,e.length);Oe.g(this.$).Cj&&(Oe.g(this.$).zc.text=this.Ya.text)};ca.bMd=function(e){e.requester().runExperiment(new ia)};
ca.U2g=function(e){var C=nb.l$g(),J={IsCompatibility:!1};J.NameDataStrings=e.label;J.Help=e.detail;C.h_f(J);C.textEdit=e.textEdit;return C};ca.LJa=function(){var e=String.format(ib.OGh,ib.Acd,Hi.a.mOe),C=String.format(ib.JGh,ib.ycd,Th.a.s9c,k.a.Sk,k.a.Wo),J=String.format(ib.GGh,ib.tcd,Th.a.s9c,k.a.Sk,Th.a.fPe,k.a.Wo);return String.format("{0}\r\n{1}\r\n{2}",e,C,J)};ca.spi=function(e){return 36===e||58===e||33===e||39===e||32===e};ca.q9h=function(e,C){return 32===e||91===e||!C.Uha};Qk.Object.defineProperties(ca.prototype,
{Ft:{configurable:!0,enumerable:!0,get:function(){return this.Kf}},Nv:{configurable:!0,enumerable:!0,get:function(){return this.m8}},NIb:{configurable:!0,enumerable:!0,get:function(){return this.Kf.re}},gWe:{configurable:!0,enumerable:!0,get:function(){return this.Kf}},KVe:{configurable:!0,enumerable:!0,get:function(){return this.hja}},Kf:{configurable:!0,enumerable:!0,get:function(){return this.hpg}},H0a:{configurable:!0,enumerable:!0,get:function(){return this.JAa?this.Ya?this.Ya.text:null:this.VV}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Ft.isListVisible},set:function(e){this.Um&&!e&&this.p1a();this.Ft.isListVisible=e}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.qxg}},lka:{configurable:!0,enumerable:!0,get:function(){return 0<this.O3}},lN:{configurable:!0,enumerable:!0,get:function(){return this.Jfa}},x_b:{configurable:!0,enumerable:!0,get:function(){return this.N1d}},O3:{configurable:!0,enumerable:!0,get:function(){return this.AJe},
set:function(e){this.AJe=e;e||(this.P3=0)}},Hyj:{configurable:!0,enumerable:!0,get:function(){if(null==this.hpc){var e=this.$.oc;this.hpc=!!e&&!e.inEmbedView}return this.hpc}},BXf:{configurable:!0,enumerable:!0,get:function(){return this.Kf.b2c[this.Kf.Lk.rowIndex]}},oWe:{configurable:!0,enumerable:!0,get:function(){!this.Bcd&&this.pluginScheduler&&(this.Bcd=this.pluginScheduler.getFunctionsShortDescriptions());return this.Bcd}}});ca.jcd="FACardOpened";ca.Dbd="FAFocusOnSmartSuggestionsCard";ca.xkd=
null;Object(Md.a)(ca,"FormulaAssistanceControl",Sh.a,[512,415,2,484,513]);var Ie=Ah.a;vm(W,Ie);W.prototype.Hne=function(e){this.addHandler("FAFunctionNameUpdated",e)};W.prototype.QQf=function(e){this.removeHandler("FAFunctionNameUpdated",e)};W.prototype.woe=function(e){this.addHandler("FAParameterSelectionChangedOld",e)};W.prototype.nRf=function(e){this.removeHandler("FAParameterSelectionChangedOld",e)};W.prototype.voe=function(e){this.addHandler("FAParameterSelectionChanged",e)};W.prototype.mRf=
function(e){this.removeHandler("FAParameterSelectionChanged",e)};W.prototype.JEg=function(e){this.addHandler("DC",e)};W.prototype.icj=function(e){this.removeHandler("DC",e)};W.prototype.dismiss=function(){this.Kv=!1;this.formulaAssistanceUIControl&&(this.Nq=null,this.gR&&this.aH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.hla=null,this.jr.canReceiveFocus=!1)};W.prototype.show=function(e,C){var J=this;this.Kv=!0;this.BUc();var ja=this.gEd(e);this.formulaAssistanceUIControl&&
(ra.instance.A7(["argumentAssistanceRender"]),e={},e.zoomLevel=O(this.$),this.formulaAssistanceUIControl.updateContext(e),xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Nq=function(){J.formulaAssistanceUIControl.renderArgumentAssistanceCard(J.domElement,C,ja)},this.Nq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,C,ja),this.lDd(ja),this.gR&&this.aH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Nq,function(){return J.formulaAssistanceUIControl.dismiss(J.domElement)}),this.jr.canReceiveFocus=!0,ra.instance.iZ(["argumentAssistanceRender"]),ra.instance.w7b("argumentAssistanceOverall"))};W.prototype.dispose=function(){if(this.$){var e=Oe.g(this.$);e&&(e.ha&&e.ha.UF(this.od),e.view.Mq(this.ht),this.gR&&e.qc.Mn(this.Jg))}fg.a.Fa(this.jr);this.$=null};W.prototype.BUc=function(){Oe.g(this.$).xj.lOb.add(this)};W.prototype.gEd=function(e){var C=new Ob;C.functionRenderingInfo=e;C.cardMode=this.K2;
this.SHd(C);return C};W.prototype.SHd=function(e){e.callbacks=new Ec;e.callbacks.onHelpLink=this.bfd(e.functionRenderingInfo);e.callbacks.onCardModeChange=this.onCardModeChange;e.callbacks.onFeedback=this.gRa;this.lba&&(e.callbacks.onDismissClick=this.onDismissClick)};W.prototype.bfd=function(e){var C=this;return function(){Ba(C.$,e.helpID,e.isUDF)}};W.prototype.DOd=function(){var e=Lj.a.get(Ca.a.l_b);this.K2=e?parseInt(e,10):W.W5c;ra.instance.NYf(this.K2)};W.prototype.lDd=function(e){var C=e.functionRenderingInfo.functionName;
this.hla&&E.a.equals(this.hla,C,!0)?(C=gh.a.map(e.functionRenderingInfo.signatures,function(J){var ja="";0<=J.signatureParams.activeParam&&J.signatureParams.activeParam<J.signatureParams.params.length&&(ja=J.signatureParams.params[J.signatureParams.activeParam]);return ja}),this.raiseEvent("FAParameterSelectionChanged",new Za(C))):(this.hla=C,e=gh.a.map(e.functionRenderingInfo.signatures,function(J){return J.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ub(C,e)))};
W.prototype.kNb=function(e){this.K2=e;try{Lj.a.pv(Ca.a.l_b,e.toString(),fk.AFrame.uea)}catch(C){Gd.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",C.message)}};W.LJa=function(){return document.createElement("div")};Qk.Object.defineProperties(W.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Kv},set:function(e){e||this.dismiss();this.Kv=e}}});W.W5c=0;Object(Md.a)(W,"FormulaArgumentAssistanceControl",Ah.a,
[485]);var Zf;(function(e){e[e.Dismissed=0]="Dismissed";e[e.Smart=1]="Smart";e[e.Simple=2]="Simple";e[e.Mixed=3]="Mixed"})(Zf||(Zf={}));Object(Md.b)("UIState",Zf);var Vg=Ah.a;vm(fa,Vg);fa.prototype.Fne=function(e){this.addHandler("FACardOpened",e)};fa.prototype.PQf=function(e){this.removeHandler("FACardOpened",e)};fa.prototype.Dne=function(e){this.addHandler("FAFocusOnSmartSuggestionsCard",e)};fa.prototype.NQf=function(e){this.removeHandler("FAFocusOnSmartSuggestionsCard",e)};fa.prototype.Ene=function(e){this.addHandler("FormulaAutoCompleteShown",
e)};fa.prototype.OQf=function(e){this.removeHandler("FormulaAutoCompleteShown",e)};fa.prototype.dispose=function(){if(this.$){var e=Oe.g(this.$);e&&(e.ha&&e.ha.UF(this.od),e.qc&&this.Hyb&&e.qc.Mn(this.Jg),e.view.Mq(this.ht));this.$.xa&&this.$.xa.ug(this.hi)}this.yka&&fg.a.Fa(this.jr);this.$=null};fa.prototype.vEg=function(e){this.addHandler("CVIC",e)};fa.prototype.Vbj=function(e){this.removeHandler("CVIC",e)};fa.prototype.Qh=function(e,C){if(!this.visible)return!1;this.mba&&this.VAc(C);if(this.lN){if(125627505===
C||this.Xnd&&267796030===C)return this.e0a(this.Nv.items[this.x0]),!this.Xnd;if(1872288872===C)return this.fda(),this.visible=!1,!0;if(!this.Xnd&&267796030===C)this.fda();else if(this.KFf&&(-798660877===C||137938150===C))return!1}e=!1;switch(C){case 1872288872:this.visible=!1;e=!0;break;case -798660877:this.Yeb(this.Jvb(this.x0+1));e=!0;break;case 137938150:this.Yeb(this.Jvb(this.x0-1));e=!0;break;case 2091832999:this.Yeb(this.Jvb(this.x0+8));e=!0;break;case 742457698:this.Yeb(this.Jvb(this.x0-8));
e=!0;break;case 125627505:this.e0a(this.Nv.items[this.x0]);e=!0;break;case 267796030:xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.e0a(this.Nv.items[this.x0]),e=!0)}return e};fa.prototype.show=function(e){this.Ya=Oe.g(this.$).xj;this.Kv=!0;this.BUc();this.x0=0;this.Nv=e;0<this.Nv.items.length&&(this.render(),this.Yeb(this.Jvb(this.x0)),1===this.Nv.items[0].type&&this.Hyb&&(this.KAa=!0))};fa.prototype.fda=function(){this.Jfa=!1;this.Ya.HIe()};
fa.prototype.render=function(){var e=this;ra.instance.A7(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var C={};C.zoomLevel=O(this.$);this.formulaAssistanceUIControl.updateContext(C);this.Nq=function(){e.formulaAssistanceUIControl.renderAutoCompleteMenu(e.domElement,e.Ya.textBox.domElement,e.Ped())};this.Nq();this.fMa&&(C=this.aNb,this.aNb=this.w0h(this.Nv.items),C!==Zf.Dismissed&&C!==Zf.Smart||this.aNb!==Zf.Simple&&this.aNb!==Zf.Mixed||this.raiseEvent("FormulaAutoCompleteShown"));this.yka&&
(this.jr.canReceiveFocus=!0);ra.instance.iZ(["autoCompleteRender"]);ra.instance.w7b("autoCompleteOverall")}};fa.prototype.BUc=function(){this.Ya.lOb.add(this)};fa.prototype.e0a=function(e){if(this.Ya&&this.visible){var C=e.textEdit;this.jmd(this.Ya.text,C);this.Ya.textBox.caretPosition=C.range.start.character+C.newText.length;this.lN&&(this.Jfa=!1,this.Hyb&&(this.oSa=!0),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:e.shouldRequestAutocompleteOnCommit})}};
fa.prototype.PIg=function(){this.KAa&&(ra.instance.CJa.smartSuggestionShownCounter++,this.KAa=!1);this.oSa&&(ra.instance.CJa.smartSuggestionSelectedCounter++,this.oSa=!1);this.jLb&&(ra.instance.CJa.smartSuggestionCommittedCounter++,this.jLb=!1)};fa.prototype.Ped=function(){var e=new pa;e.completionItems=this.Nv.items;e.activeItemIndex=this.x0;this.QHd(e);return e};fa.prototype.QHd=function(e){e.callbacks=new Pa;e.callbacks.onCompletionItemSelected=this.Fzd;e.callbacks.onCompletionItemCommitted=this.Ezd;
e.callbacks.onFeedback=this.gRa;xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(e.callbacks.onDismiss=this.Gnd?this.sKi:this.dismiss)};fa.prototype.yEd=function(e){this.Jfa=!0;var C=e.textEdit.newText;this.Ya.idb(C.substring(this.Ya.text.length-e.textEdit.range.start.character,C.length))};fa.prototype.Yeb=function(e){var C=this.x0;this.x0=e;var J=this.Nv.items[e];this.lN&&this.fda();C!==e&&this.render();1===J.type&&xe.EwaSettings.Eb()&&!Oe.g(this.$).xj.text.includes("\n")&&
this.yEd(J)};fa.prototype.Jvb=function(e){return 0>e?0:Math.min(e,this.Nv.items.length-1)};fa.prototype.jmd=function(e,C){this.Ya.text=e.substring(0,C.range.start.character)+C.newText+e.substring(C.range.end.character,e.length);Oe.g(this.$).Cj&&(Oe.g(this.$).zc.text=this.Ya.text)};fa.prototype.Otd=function(){this.kIa&&(ra.instance.N2.selectByArrowKeyCounter++,this.kIa=!1);this.lIa&&(ra.instance.N2.selectByMouseHoverCounter++,this.lIa=!1);this.jIa&&(ra.instance.N2.commitByTabKeyCounter++,this.jIa=
!1);this.hIa&&(ra.instance.N2.commitByEnterKeyCounter++,this.hIa=!1);this.iIa&&(ra.instance.N2.commitByMouseClickCounter++,this.iIa=!1)};fa.prototype.VAc=function(e){switch(e){case -798660877:case 137938150:case 2091832999:case 742457698:this.kIa=!0;break;case 125627505:this.jIa=!0;break;case 267796030:xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.hIa=!0)}};fa.LJa=function(){return document.createElement("div")};fa.prototype.w0h=function(e){return e.reduce(function(C,
J){return C|=0===J.type?Zf.Simple:Zf.Smart},Zf.Dismissed)};Qk.Object.defineProperties(fa.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Kv},set:function(e){e||this.dismiss();this.Kv=e}},lN:{configurable:!0,enumerable:!0,get:function(){return this.Jfa}},KFf:{configurable:!0,enumerable:!0,get:function(){return 1===this.Nv.items.length&&1===this.Nv.items[0].type}}});Object(Md.a)(fa,"FormulaAutoCompleteControl",Ah.a,[483,2,484]);da.prototype.then=function(e,C){return this.promise.then(e,
C)};da.prototype.resolve=function(e){this.dvg(e);return null!=e&&"function"===typeof e.then?this.promise.then():void 0};da.prototype.reject=function(e){this.Mug(e);return null!=e&&"function"===typeof e.then?this.promise.then():void 0};Object(Md.a)(da,"ResolvablePromise",null,[]);K.prototype.getRichValueFieldListContext=function(e,C,J,ja){this.akf&&e!==this.akf&&this.nh.ubb();this.akf=e;this.nh.zZ(e,J,ja,C);this.$8b=new da;this.nh.yyb?this.$8b.resolve(this.nh.Dk):this.r9i();return this.$8b.promise};
K.prototype.r9i=function(){this.nh.LYb(this.rya);this.nh.hFg(this.Eyf)};K.prototype.Hbg=function(){this.nh.usc(this.rya);this.nh.Ccj(this.Eyf)};Object(Md.a)(K,"ServerDataProvider",null,[482]);T.prototype.dispose=function(){if(this.$){var e=Oe.g(this.$);e&&(e.ha&&vg.a.YZ()&&e.ha.Gza(this.Lh),this.Wff&&e.Ca&&e.Ca.Jq(this.Ig))}this.lba&&(Oe.g(this.$).qc.Mn(this.Jg),this.nDa.icj(this.Puf));this.Zpa.Vbj(this.Xuf);this.functionInfoManager&&this.functionInfoManager.dHb(this.onFunctionInfoLoaded);vg.a.ifc&&
this.Ya&&this.Ya.XGb(this.m6);fg.a.Fa(this.nDa);fg.a.Fa(this.Zpa);this.Zpa=this.nDa=this.functionInfoManager=this.$=null};T.prototype.fhj=function(){this.aNa=-1;this.bNa=null};T.prototype.DIe=function(){this.Kua.visible=!1;this.$bd.visible=!1};T.prototype.Qh=function(){this.rda();return!1};T.prototype.rda=function(e){var C=this;e=void 0===e?0:e;if(27!==e&&9!==e&&13!==e&&!this.Ya.eL){if(this.L5a&&(ra.instance.yob.formulaAssistanceRequestAttemptedCounter++,!this.$yj())){ra.instance.yob.formulaAssistanceRequestOptimizedCounter++;
return}this.functionInfoManager.i5||(this.functionInfoManager.nnb(this.onFunctionInfoLoaded),this.functionInfoManager.Dsb({}));var J=this.Ya;e=J.text;J=J.textBox.caretPosition;!this.lba||this.TRa?(ra.instance.A7(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.RXf(e,J)):(ra.instance.A7(["autoCompleteComputation","autoCompleteOverall"]),this.pluginScheduler.requester().functionSuggestion(Object.assign(new ea,{content:e,caretPosition:J})).then(function(ja){0===
ja.kind&&C.J6e(ja.payload);return null}))}};T.prototype.RXf=function(e,C){var J=this;this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:e,caretPosition:C},argumentAssistance:{content:e,caretPosition:C}}).then(function(ja){0===ja.kind&&(J.c6e(ja.payload.argumentAssistance),J.J6e(ja.payload.functionSuggestion));return null})};T.prototype.$yj=function(){var e=this.Ya,C=e.text;e=e.textBox.caretPosition;if(this.Zpa.visible&&E.a.equals(C,this.bNa,
!0)&&e===this.aNa)return!1;this.bNa=C;this.aNa=e;return!0};T.prototype.bMd=function(){this.pluginScheduler.requester().runExperiment(new ia)};T.prototype.c6e=function(e){e&&this.Ya.isEditing?(ra.instance.iZ(["argumentAssistanceComputation"]),this.nDa.show(e,this.Ya.textBox.domElement)):this.nDa.dismiss()};T.prototype.J6e=function(e){e&&0<e.items.length&&this.Ya.isEditing?(ra.instance.iZ(["autoCompleteComputation"]),this.Zpa.show(e)):this.Zpa.dismiss()};T.prototype.$Ld=function(e){this.pluginScheduler.requester().runAuthoringExperiment({content:e})};
T.prototype.vCb=function(){var e=Oe.g(this.$).ha.va.activeCell;if(e){var C=this.calcManager.Zsa(e);if(C){var J=this.$.xa,ja=C.sheet.index;0>=J.count||0>ja||ja>=J.count||(ja=J=null,this.dyd&&void 0!==this.calcManager&&null!==this.calcManager&&(e=Oe.g(this.$).Ca.ds(e))&&(e=this.calcManager.Ofd(e.Dm),void 0!==e&&null!==e&&(J=e.FormatString,ja=e.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new qa,{colIndex:C.range.col,rowIndex:C.range.row,sheetIndex:this.$.xa.getItem(C.sheet.index).sheetId,
docName:C.sheet.document.name,docPath:C.sheet.document.path,formatString:J,builtIn:ja})))}else Gd.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};T.prototype.jUj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.xcd)};T.prototype.Vld=function(){Oe.g(this.$).ha.Jra(this.Lh);this.vCb();vg.a.ifc&&this.Ya.xYa(this.m6);this.bMd();this.Zpa.vEg(this.Xuf);this.pluginScheduler.setServerDataProvider(new K(this.nh,
this.$));this.rda()};Qk.Object.defineProperties(T.prototype,{Kua:{configurable:!0,enumerable:!0,get:function(){return this.Zpa}},$bd:{configurable:!0,enumerable:!0,get:function(){return this.nDa}},Ya:{configurable:!0,enumerable:!0,get:function(){return Oe.g(this.$).xj}}});Object(Md.a)(T,"FormulaAssistanceManager",null,[410,2]);var Gh=Bh.a;vm(H,Gh);H.prototype.create=function(){var e=this,C=vg.a.YZ(),J=xe.EwaSettings.la(383),ja=xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1),Aa=vg.a.kF(this.$),gb=this.$.da,bc=Zg.GetServiceTaskFactory.create(gb,134,this.ma,this.ub),Mc=Zg.GetServiceTaskFactory.Wa(this.$.da,12,477,this.ub);var Hc=vg.a.iN(this.$)?Zg.GetServiceTaskFactory.create(this.$.da,449,this.$.ma,1):Tf.Task.Ta(null);var yd=vg.a.YZ()?Zg.GetServiceTaskFactory.create(this.$.da,414,this.$.ma,1):Tf.Task.Ta(null);if(ja||C){var we=Zg.GetServiceTaskFactory.Wa(gb,266,265,this.ub),$e=Zg.GetServiceTaskFactory.Wa(gb,219,220,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([we,
yd,Hc,$e],this.ma),function(){var ag=gb.Aa(19)||new kb(e.$,yd.result),Nf=$e.result;if(Aa){var Pg=gb.Aa(464);Pg||(Pg=new T(e.$,ag,we.result,yd.result,Hc.result,Mc.result.C3c(e.$,bc.result)),Nf.mXc(Pg.$bd),Nf.nXc(Pg.Kua))}else Pg=gb.Aa(221),Pg||(Pg=new ca(e.$,ag,bc.result,we.result,null,Mc.result,Hc.result,yd.result),Nf.mXc(Pg.KVe),Nf.Ose(Pg.gWe),Nf.nXc(Pg)),J&&(gb.Aa(317)||new sc(e.$));e.Gb(ag)},this.ma,3)}else{var Gf=Zg.GetServiceTaskFactory.Wa(gb,219,220,this.ub);Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([Gf,
Hc,yd],this.ma),function(){var ag=gb.Aa(19)||new kb(e.$,yd.result),Nf=Gf.result,Pg=gb.Aa(221);Pg||(Pg=new ca(e.$,ag,bc.result,null,null,Mc.result,Hc.result,yd.result),Nf.mXc(Pg.KVe),Nf.Ose(Pg.gWe),Nf.nXc(Pg));J&&(gb.Aa(317)||new sc(e.$));e.Gb(ag)},this.ma,3)}};H.ka=function(e){e.da.Ha(153,new H(e))};Object(Md.a)(H,"FunctionInfoManagerFactory",Bh.a,[]);var pi=b(199),ij=b(74),Fj=b(113);S.prototype.JZe=function(){return Fj.a(Gg.a.Ra,this.startTime)};Object(Md.a)(S,"OngoingAction",null,[]);var Pj=ij.a;
vm(ba,Pj);ba.prototype.vpc=function(e){Gd.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.sla,this.ELa,this.H5a);this.Dnb=this.yzg.DZb(e,this.Dnb);this.tmd()};ba.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.ZGb(this.qya);this.bxe();Pj.prototype.dispose.call(this)};ba.prototype.W_f=function(e){this.XYc?(this.SOa=e?new S:null,e?this.startTimer():this.bxe()):
this.SOa=e?{}:null};ba.prototype.oUe=function(e){e=void 0===e?null:e;this.XYc&&e&&e.rK?Gd.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.sla):(Gd.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.sla,this.ELa,this.H5a),this.W_f(!1),this.tmd())};ba.prototype.tmd=function(){var e=this;if(!this.DKb()){var C=this.Dnb;this.Dnb=null;this.W_f(!0);Gd.ULS.sendTraceTag(537153857,
0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.sla);var J=this.XYc?this.SOa.px.token:pi.a.none;Pd.TaskExtensions.Ba(this.xzg.tpc(C),function(){e.oUe(J)},J,0,this.MO)}};ba.prototype.DKb=function(){return!this.H5a||this.ELa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Ci?(Gd.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.sla),!0):!1};ba.prototype.bxe=function(){this.Boc&&
this.Boc.cancel()};ba.prototype.startTimer=function(){this.YYc<=this.Cve&&(this.Boc=Ai.a.instance.create(this.hSi,this.RSg,ji.a.oke))};Qk.Object.defineProperties(ba.prototype,{ELa:{configurable:!0,enumerable:!0,get:function(){return!!this.SOa}},H5a:{configurable:!0,enumerable:!0,get:function(){return!!this.Dnb}}});Object(Md.a)(ba,"ActionAggregator",ij.a,[488,2]);var Gi=b(122),kj=eh.a;vm(la,kj);la.prototype.GFg=function(e){this.addHandler("KBIS",e)};la.prototype.Tcj=function(e){this.removeHandler("KBIS",
e)};la.prototype.dispose=function(){this.firstElement&&Vd.a.removeHandler(this.firstElement,Ue.a.focus,this.ayf);this.Bs&&this.Bs.detach("focus");this.so&&(Vd.a.removeHandler(this.so,Ue.a.focus,this.Vzf),Vd.a.removeHandler(this.so,Ue.a.blur,la.onBlur),Wj.KeyInputManager.instance.za(Ue.a.Tb,this.so,this.Wzf));Wj.KeyInputManager.instance.za(Ue.a.Tb,this.$.domElement,this.zFf);this.Bs=this.so=this.firstElement=this.$=null;kj.prototype.dispose.call(this)};la.prototype.C6g=function(){this.mxj?(this.firstElement=
document.documentElement,this.Bs=Gi.a.instance.pE(document.parentWindow),this.Bs.ka("focus",this.HVi)):(this.firstElement=la.VDe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),Vd.a.addHandler(this.firstElement,Ue.a.focus,this.ayf))};la.prototype.z7g=function(){this.so=la.VDe();this.so.id=Ca.a.cLe;this.so.setAttribute(Ca.a.Dt,ue.a.instance.fa(845));document.body.appendChild(this.so);Vd.a.addHandler(this.so,Ue.a.focus,this.Vzf);Vd.a.addHandler(this.so,Ue.a.blur,la.onBlur);
Wj.KeyInputManager.instance.qa(Ue.a.Tb,this.so,this.Wzf)};la.prototype.Czh=function(e){this.bag(e);return!1};la.prototype.SKi=function(){this.eMa=!0;Oe.g(this.$).focus();Oe.g(this.$).ha.C6e();this.raiseEvent("KBIS");return!0};la.prototype.bag=function(e){this.eMa?this.eMa=!1:(this.eMa=!0,e&&e.focus())};la.VDe=function(){var e=document.createElement("div");e.tabIndex=0;return e};la.y9e=function(){document.body.classList.add(k.a.FNe)};la.onBlur=function(){document.body.classList.remove(k.a.FNe)};Object(Md.a)(la,
"EmbedViewFocusControl",eh.a,[489,2]);var hk=b(58),vk=b(528),Bk=eh.a;vm(Q,Bk);Q.prototype.LYb=function(e){this.addHandler("FieldInfoListContextLoaded",e)};Q.prototype.usc=function(e){this.removeHandler("FieldInfoListContextLoaded",e)};Q.prototype.hFg=function(e){this.addHandler("GetFieldInfoListContextOperationFailed",e)};Q.prototype.Ccj=function(e){this.removeHandler("GetFieldInfoListContextOperationFailed",e)};Q.prototype.dispose=function(){this.vb=null;this.ubb();Bk.prototype.dispose.call(this)};
Q.prototype.zZ=function(e,C,J,ja){ja=void 0===ja?null:ja;if(e){this.SZc();this.b1b();var Aa=null,gb=!1,bc;if(bc=!ja)bc=this.sOj(e,C,J),gb=bc.o$a,Aa=bc.Dk,bc=bc.returnValue;if(bc&&(this.OZf(Aa),this.nTb=!0,(this.rP=Aa)&&0<this.rP.length&&(this.Wib=!0,this.UFd()),!gb))return;this.Qdg(e,ja,C,J,!1)}};Q.prototype.Qdg=function(e,C,J,ja,Aa){if(this.$.ea.rc){this.$.Wb&&(this.QHb=this.$.Wb.Ic("WebServiceCall","GetRichValueFieldInfoListContext"));this.Tub=null;var gb=this.$.na.ta.$b(),bc=this.$.na.ta,Mc=this.nMi,
Hc=this.mMi,yd=bc.Na(1,null);yd.selectedRange=e;yd.richValueKeyPath=C;yd.singleColumn=J;yd.searchForRange=ja;yd.calculateMajorityDataType=Aa;this.Tub=jg.i(bc,"GetRichValueFieldListContextList",yd,Mc,Hc,null,gb,4)}else this.rP=null};Q.prototype.ubb=function(){this.rP=null;this.Wib=!1;this.SZc();this.b1b();this.Tub=null;this.$Rb=-1};Q.prototype.SZc=function(){Q.xpb(this.Tub)};Q.prototype.b1b=function(){Q.xpb(this.ved)};Q.prototype.UFd=function(){this.raiseEvent("FieldInfoListContextLoaded")};Q.prototype.Dn=
function(e){e=ud.D(e);--e.left;--e.right;return this.tableManager.Dn(e)};Q.prototype.$Ja=function(e){var C=this;e.FirstColumn=e.FirstColumn;e.LastColumn=e.LastColumn;e.FirstRow=e.FirstRow;e.LastRow=e.LastRow;this.b1b();this.ved=null;return Hh.a(this.$.userOperationManager,function(J,ja,Aa){return jg.w(C.$.na.ta,e,Jf.b(J,function(gb){C.xMi(gb)}),Jf.a(ja,ja,function(gb){C.wMi(gb)}),Aa,null)},function(J){return new Sf.a(264,0,J,80)},null)};Q.prototype.wMi=function(e){e=xg.a.og(e.data);Gd.ULS.sendTraceTag(525336847,
0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",dh.a.Uc(e))};Q.prototype.xMi=function(e){if(xh.a(e))-315732528!==e.Errors[0].MessageId&&Gd.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",dh.a.Uc(e.Errors));else if(e&&e.Result){e=e.Result;var C=e.HasHeaderRow;C=new vk.AutofilterRange(e.TableRange.FirstRow+(C?1:0)+1,e.TableRange.FirstColumn+1,e.TableRange.LastRow+1,e.TableRange.LastColumn+
1,null,null,null,0,C);this.$Rb=e.TableRange.FirstColumn;(e=this.zKf(!1,!0,C))||Gd.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.OZf(e)}else Gd.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};Q.prototype.sOj=function(e,C,J){var ja=null;var Aa=!1;if(e.SheetName!==this.$.ea.pa.sheetName)return{returnValue:!1,o$a:Aa,$Ja:!1,Dk:ja};this.$Rb=-1;if(J){var gb=this.Dn(e);
if(!gb||!gb.Sva)return{returnValue:!1,o$a:Aa,$Ja:!1,Dk:ja};var bc=Oe.g(this.$).Sb.Q2e(gb);this.r4d=gb;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&bc&&0<bc.count)return--e.FirstColumn,--e.LastColumn,this.ved=this.$Ja(e),{returnValue:!0,o$a:Aa,$Ja:!0,Dk:ja};gb.top+=1;gb.right=ud.D(e).right-1}else gb=new vk.AutofilterRange(e.FirstRow+1,e.FirstColumn+1,e.LastRow+1,e.LastColumn+1,null,null,null,0,!1);if(gb.top>gb.bottom||gb.left>
gb.right)return{returnValue:!0,o$a:Aa,$Ja:!1,Dk:ja};e=Oe.g(this.$);var Mc=e.$a.width,Hc=e.$a.height;bc=e.view.visibleArea;Mc=new hk.a(bc.x-Mc,bc.y-Hc,bc.width+Mc,bc.height+Hc);Hc=e.pg(gb);if(!bc||!Hc||!e.phc(gb))return{returnValue:!1,o$a:Aa,$Ja:!1,Dk:ja};Mc.contains(Hc)||(Aa=!0);ja=this.zKf(C,J,gb);return{returnValue:!0,o$a:Aa,$Ja:!1,Dk:ja}};Q.prototype.OZf=function(e){e&&Gd.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",e.length);this.nTb=!0;(this.rP=e)&&
0<this.rP.length&&(this.Wib=!0,this.UFd())};Q.prototype.zKf=function(e,C,J){var ja=null;var Aa=J.clone();if(C){C=J.right;for(var gb=0;C>=J.left;--C){Aa.left=C;Aa.right=C;var bc=this.YZe(Aa,!0,J.left);if(bc){ja||(ja=[]);ja[gb]=bc;if(e)break;++gb}}}else if(e=this.YZe(Aa,!1))ja=[],ja[0]=e;return ja};Q.prototype.YZe=function(e,C,J){J=void 0===J?0:J;var ja=null;if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Aa=Oe.g(this.$).Sb.$Xh(e);if(Aa&&0<Aa.count){var gb=
Array(Aa.count),bc=0;Aa=yl(Aa.values);for(ja=Aa.next();!ja.done;ja=Aa.next()){var Mc={};Mc.Name=ja.value;gb[bc]=Mc;++bc}bc="";Aa=-1;0<e.top&&C&&(e=new Yg.Range(e.top-1,e.left,e.top-1,e.left,!1,!1),bc=Oe.g(this.$).wc(e).originalText,Aa=e.left-J);ja={};ja.ColumnName=bc;ja.ColumnIndex=Aa;ja.FieldInfoDataList=gb}}else if((Aa=Oe.g(this.$).Sb.Q2e(e))&&0<Aa.count){gb=Array(Aa.count);bc=0;Aa=yl(Aa);for(ja=Aa.next();!ja.done;ja=Aa.next())Mc={},Mc.Name=ja.value,gb[bc]=Mc,++bc;bc="";Aa=-1;0<e.top&&C&&(e=new Yg.Range(e.top-
1,e.left,e.top-1,e.left,!1,!1),bc=Oe.g(this.$).wc(e).originalText,Aa=e.left-J);ja={};ja.ColumnName=bc;ja.ColumnIndex=Aa;ja.FieldInfoDataList=gb}return ja};Q.xpb=function(e){e&&wg.AFrameworkApplication.Kd.nu(e.Et)};Qk.Object.defineProperties(Q.prototype,{yyb:{configurable:!0,enumerable:!0,get:function(){return this.Wib}},Xti:{configurable:!0,enumerable:!0,get:function(){return this.nTb}},bWe:{configurable:!0,enumerable:!0,get:function(){return this.$Rb}},Y4c:{configurable:!0,enumerable:!0,get:function(){return this.r4d}},
$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Dk:{configurable:!0,enumerable:!0,get:function(){return this.rP}},$Ph:{configurable:!0,enumerable:!0,get:function(){return!!this.Tub}}});Object(Md.a)(Q,"FieldInfoManager",eh.a,[487,2]);vm(U,Q);U.prototype.jQh=function(e,C){this.F1a=C;Gd.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",e.FirstRow,e.FirstColumn,
e.LastRow,e.LastColumn);this.Qdg(e,null,!0,!1,!0)};Qk.Object.defineProperties(U.prototype,{OG:{configurable:!0,enumerable:!0,get:function(){return this.Blg}}});Object(Md.a)(U,"FilterInfoManager",Q,[486,487,2]);V.pth="ewa-sharedUi-launchButton";V.sth="ewa-sharedUi-launchButtonWithText";V.qth="ewa-sharedUi-launchButtonClick";V.tth="ewa-sharedUi-launchButtonWithTextClick";V.rth="ewa-sharedUi-launchButtonText";Object(Md.a)(V,"CssClassNames",null,[]);var Vk=b(279),el=Ah.a;vm(D,el);D.prototype.A2=function(e){this.addHandler(this.jFb,
e)};D.prototype.hda=function(e){this.get_events().removeHandler(this.jFb,e)};D.prototype.XFg=function(e){this.addHandler("OnObjectButtonMouseOver",e)};D.prototype.idj=function(e){this.get_events().removeHandler("OnObjectButtonMouseOver",e)};D.prototype.WFg=function(e){this.addHandler("OnObjectButtonMouseOut",e)};D.prototype.hdj=function(e){this.get_events().removeHandler("OnObjectButtonMouseOut",e)};D.prototype.Wcg=function(e){e&&(this.$Za.innerHTML=e)};D.prototype.ARj=function(e,C,J){this.$Za.innerHTML=
"";e?e.hba(C,16,16,this.$Za,16,16,void 0,J):Gd.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};D.prototype.BRj=function(e,C){e&&(this.gMb.innerText=e);this.domElement.title=C};D.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.xc.HA(),fg.a.sc([this.eZ,this.RZa]),ej.a.instance.za(Ue.a.click,this.domElement,this.$c),Z.a.instance.za(Ue.a.pointerDown,this.domElement,this.JN),this.fSa&&this.fSa.dispose(),el.prototype.dispose.call(this))};
D.prototype.sbb=function(){this.$1b&&this.domElement.classList.remove(this.$1b);this.Ilc&&this.domElement.classList.add(this.Ilc)};D.prototype.hFb=function(){this.Ilc&&this.domElement.classList.remove(this.Ilc);this.$1b&&this.domElement.classList.add(this.$1b);this.T1a()};D.prototype.T1a=function(){this.Lhc&&(this.fSa.cancel(),this.f7f(),this.setOpacity(1));this.set_visible(!0)};D.prototype.Do=function(e,C,J,ja,Aa){Aa=void 0===Aa?!1:Aa;e=rf.a(ja).Hi(e);C=rf.a(ja).Hi(C);rf.a(ja).Zvc(this.domElement);
this.domElement.style.top=Lb.HelperMethods.Rb(C);this.domElement.style.left=this.domElement.style.right="";C=e;Aa&&(C=e-this.domElement.offsetWidth);Rg.c(this.domElement.style,J,Lb.HelperMethods.Rb(C));this.set_visible(!0);this.setOpacity(1);this.Lhc&&(this.mSd=!1,this.mGj(),this.fSa.Oq())};D.prototype.hide=function(){this.sbb();this.set_visible(!1);this.Lhc&&(this.f7f(),this.fSa.cancel())};D.prototype.p7b=function(){this.xc.ka("mouseover",this.CF,!0);this.xc.ka("mouseout",this.hI,!0)};D.prototype.mGj=
function(){this.eZ.gn("mousemove")||this.eZ.ka("mousemove",this.Ozd)};D.prototype.f7f=function(){this.eZ.gn("mousemove")&&this.eZ.detach("mousemove")};D.prototype.Pid=function(e){if(this.domElement.parentNode){var C=Sys.UI.DomElement.getBounds(this.domElement),J=new Sys.UI.Point(Math.round(C.x+C.width),Math.round(C.y+C.height));C=Math.abs(J.x-e.x);e=Math.abs(J.y-e.y);e=C>e?C:e;this.mSd?this.setOpacity(D.UTg(e)):100>=e&&this.Cke()}};D.prototype.Cke=function(){this.mSd=!0;this.fSa.cancel()};D.prototype.setOpacity=
function(e){Rh.a.setOpacity(this.domElement,e);this.okf=Gg.a.Ra.Lb};D.UTg=function(e){return 100>=e?1:250<=e?0:.01*(100-(e-100)/150*100)};Object(Md.a)(D,"OnObjectButton",Ah.a,[456,165,2]);var kl=b(925),fl=V.rth,ll=ij.a;vm(z,ll);z.prototype.dispose=function(){this.vgh();this.$=null;ll.prototype.dispose.call(this)};z.prototype.getButton=function(e,C){return this.Yua(e,void 0===C?!0:C)};z.prototype.Yua=function(e,C){var J=e.toString();J in this.buttons||this.B7g(e,void 0===C?!0:C);return this.buttons[J]};
z.prototype.Do=function(e,C,J,ja,Aa,gb){Aa=void 0===Aa?!0:Aa;gb=void 0===gb?!1:gb;this.hide();if(this.$.ea.isNamedObjectViewMode&&kf.i(this.$.pa)){var bc=Oe.g(this.$).pO.domElement,Mc=e+this.buttonWidth-bc.scrollWidth;bc=C+this.buttonWidth-bc.scrollHeight;e=0<Mc?e-Mc:e;C=0<bc?C-bc:C}this.Yua(ja,Aa).Do(e,C,J,this.$,gb)};z.prototype.hide=function(){var e=this.buttons,C;for(C in e)e[C].hide()};z.prototype.p7b=function(e,C){!this.Z9e&&(C=this.buttons[C.toString()])&&(this.dlc=function(J,ja){e(ja,!0)},
C.XFg(this.dlc),this.clc=function(J,ja){e(ja,!1)},C.WFg(this.clc),this.Z9e=!0,C.p7b())};z.prototype.B7g=function(e,C){function J(gb,bc){ja.SIi(bc,e)}var ja=this;this.lwa=String.format(this.Ukd===k.a.e8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Dg.a.Lf(this.Ukd),Dg.a.Lf(this.Tkd),"{0}");var Aa=String.format(this.lwa,Dg.a.Lf(this.altText));C=new D(""===this.buttonText?V.pth:V.sth,
""===this.buttonText?V.qth:V.tth,k.a.fr,Aa,C,this.jFb,this.buttonText,fl);C.A2(J);this.buttons[e.toString()]=C;this.PMe[e.toString()]=J;Aa=Oe.g(this.$).Sf(e);Aa.domElement.insertBefore(C.domElement,Aa.domElement.firstChild)};z.prototype.vgh=function(){for(var e=yl(kl.a(this.buttons)),C=e.next();!C.done;C=e.next()){C=C.value;var J=this.buttons[C];J.hda(this.PMe[C]);fg.a.Fa(J);delete this.buttons[C];this.dlc&&J.idj(this.dlc);this.clc&&J.hdj(this.clc)}};z.prototype.domElement=function(e){return this.Yua(e).domElement};
z.prototype.T1a=function(e){this.Yua(e).T1a()};z.prototype.JNb=function(e,C,J){J=void 0===J?!0:J;this.lwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Dg.a.Lf(this.Ukd),Dg.a.Lf(this.Tkd),"{0}");e=String.format(this.lwa,Dg.a.Lf(e));this.Yua(C,J).Wcg(e)};z.prototype.DTa=function(e,C,J){this.Yua(J,!1).BRj(e,C)};z.prototype.Ndg=function(){var e=void 0===e?!1:e;this.lwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
"{0}",Dg.a.Lf(this.Tkd),"{1}");var C=String.format(this.lwa,void 0,Dg.a.Lf(void 0));this.Yua(void 0,e).Wcg(C)};z.prototype.Odg=function(e,C,J){this.Yua(J,!1).ARj(this.svgIconProvider,e,C)};Qk.Object.defineProperties(z.prototype,{iz:{configurable:!0,enumerable:!0,get:function(){return rf.a(this.$).OFa(Fe.a.uQi)}},B1b:{configurable:!0,enumerable:!0,get:function(){return Fe.a.tQi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return rf.a(this.$).OFa(Fe.a.vQi)}}});Object(Md.a)(z,"OnObjectLaunchButton",
ij.a,[445,2]);var pl=b(83),ml=pl.a;vm(I,ml);I.prototype.dispose=function(){fg.a.Fa(this.aBb);this.aBb=null;ml.prototype.dispose.call(this)};I.prototype.MAa=function(){fg.a.Fa(this.aBb);this.aBb=Ai.a.instance.create(Object(Sg.a)(this,this.display,"display"),this.j$h,ji.a.aui)};I.prototype.BSa=function(){fg.a.Fa(this.aBb);this.hide()};Object(Md.a)(I,"LoadingIndicatorBehavior",pl.a,[455,2]);vm(r,I);r.prototype.dispose=function(){this.$Ab=null;I.prototype.dispose.call(this)};r.prototype.display=function(){this.Ung(this.$Ab)};
r.prototype.hide=function(){this.x7h(this.$Ab)};r.prototype.KBg=function(){this.$Ab=document.createElement("div");this.domElement.appendChild(this.$Ab)};Object(Md.a)(r,"ShimmerLoadingIndicatorBehavior",I,[]);vm(B,I);B.prototype.dispose=function(){this.vNa=null;I.prototype.dispose.call(this)};B.prototype.display=function(){Bd.DOMElementExtensions.setVisible(this.vNa,!0)};B.prototype.hide=function(){Bd.DOMElementExtensions.setVisible(this.vNa,!1)};B.prototype.JBg=function(){this.vNa=document.createElement("div");
this.vNa.classList.add(Fd.a.nrh);var e=document.createElement("div");e.classList.add(Fd.a.orh);this.b5c&&""!=this.b5c&&e.classList.add(this.b5c);var C=0===this.dmf?"":ue.a.instance.fa(this.dmf),J=String.format('<div class="'+Fd.a.prh+'">{0}</div>',C);this.gec?(C=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.gec,C),e.innerHTML=C+J):e.innerHTML=J;this.vNa.appendChild(e);this.domElement.appendChild(this.vNa)};Object(Md.a)(B,"SpinnerLoadingIndicatorBehavior",I,[]);u.prototype.Z3c=function(e,
C,J){return new Hk.a(e,C,J)};u.prototype.h4b=function(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd){return new Jc(e,C,J,ja,Aa,gb,bc,Mc,Hc,yd)};u.prototype.A0a=function(e,C,J,ja,Aa){return new B(e,C,J,ja,void 0===Aa?0:Aa)};u.prototype.Yfd=function(e){return e.da.Aa(238)||new la(e)};u.prototype.k4b=function(e,C,J,ja,Aa,gb,bc,Mc){return new z(e,C,J,ja,Aa,gb,bc,void 0===Mc?"":Mc)};u.prototype.C3c=function(e,C){return new Q(e,C)};u.prototype.y6g=function(e,C,J,ja){return new U(e,C,J,ja)};u.prototype.K3b=function(e,C,J,
ja){return new ba(e,C,J,ja)};Object(Md.a)(u,"SharedUIControlsFactory",null,[407]);var ql=Bh.a;vm(x,ql);x.prototype.create=function(){xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1)?this.Gb(this.$.da.Aa(12)||new u):this.Gb(new u)};x.ka=function(e){e.da.Ha(477,new x(e))};Object(Md.a)(x,"SharedUIControlsFactoryServiceFactory",Bh.a,[]);var rl=b(1020),wk=Bh.a;vm(A,wk);A.prototype.create=function(){var e=this;Gd.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");
rl.a.then(this.S8g(),function(C){e.Gb(C);return!0})};A.prototype.S8g=function(){var e=this;if(this.m4b)return this.m4b;var C=Mj.a.D0a(ih.b(),pi.a.none,"LoadResource","x10Scheduler loading");if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&Rh.a.Vu){var J=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,J);C.setResult(J);return this.m4b=C.task}this.$.da.Za(266,function(){e.$.da.Za(283,function(ja){var Aa=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();
ja=ch.b(Tf.Task.Ta(ja.Sn));if(xe.EwaSettings.isChangeGateEnabled("OfficeVSO:6035660_attachX10PluginsOnOouiSide"))excelOnlineCalc.x10.ensureAllPluginsAttached(ja).then(function(){e.$.da.Ha(413,Aa);C.setResult(Aa)});else{var gb=excelOnlineCalc.x10.ensurePluginAttached(1,ja),bc=excelOnlineCalc.x10.ensurePluginAttached(4,ja),Mc=excelOnlineCalc.x10.ensurePluginAttached(1E3,ja),Hc=excelOnlineCalc.x10.ensurePluginAttached(1002,ja),yd=excelOnlineCalc.x10.ensurePluginAttached(9,ja),we=excelOnlineCalc.x10.ensurePluginAttached(10,
ja),$e=excelOnlineCalc.x10.ensurePluginAttached(11,ja),Gf=excelOnlineCalc.x10.ensurePluginAttached(12,ja),ag=excelOnlineCalc.x10.ensurePluginAttached(1004,ja),Nf=excelOnlineCalc.x10.ensurePluginAttached(13,ja),Pg=excelOnlineCalc.x10.ensurePluginAttached(1006,ja);gb=[gb,bc,Mc,Hc,yd,we,Gf,ag,$e,Nf,Pg];xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5818445_AttachDataTypesExperiment")&&(ja=excelOnlineCalc.x10.ensurePluginAttached(1003,ja),gb.push(ja));Promise.all(gb).then(function(){e.$.da.Ha(413,Aa);
C.setResult(Aa)})}})});return this.m4b=C.task};A.ka=function(e){e.da.Ha(414,new A(e))};Object(Md.a)(A,"PluginSchedulerFactory",Bh.a,[]);var Wk=ij.a;vm(t,Wk);t.prototype.dispose=function(){this.Ip.dispose();this.$=null;Wk.prototype.dispose.call(this)};t.prototype.domElement=function(e){return this.Ip.domElement(e)};t.prototype.getButton=function(e){return this.Ip.getButton(e,!1)};t.prototype.JNb=function(e,C){this.Ip.JNb(e,C,!1)};t.prototype.DAa=function(e,C){var J=Oe.g(this.$),ja=J.$a.nj(e);this.Ip.JNb(C?
ue.a.instance.fa(1691):ue.a.instance.fa(1692),ja);C=this.isMac?C?ue.a.instance.fa(1695):ue.a.instance.fa(1696):C?ue.a.instance.fa(1693):ue.a.instance.fa(1694);var Aa=J.pg(e,ja);e=J.Sf(ja).nn;if(Aa&&0<=Aa.x&&0<=Aa.y){var gb=Aa.bottomRight.x+this.iz;Aa=Aa.topLeft.y-this.iz-this.buttonWidth;if(Aa<e.topLeft.y+this.iz){if(J.$a.gTa){this.hide();return}Aa=e.topLeft.y+this.iz}this.Do(gb,Aa,J.rtl,ja);this.ariaLiveNotifier.QPa(C)}else this.hide()};t.prototype.Do=function(e,C,J,ja){this.Ip.Do(e,C,J,ja,!1)};
t.prototype.hide=function(){this.Ip.hide()};Qk.Object.defineProperties(t.prototype,{iz:{configurable:!0,enumerable:!0,get:function(){return this.Ip.iz}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Ip.buttonWidth}}});Object(Md.a)(t,"PulloutLaunchButton",ij.a,[]);var gl=ij.a;vm(w,gl);w.prototype.dispose=function(){this.gridView&&(this.gridView.ha.lda(this.Xh),this.gridView.view.Mq(this.ht),this.gridView.zc&&this.gridView.zc.nl(this.ej));if(this.$){var e=this.$;e.ol(this.ud);
e.rn(this.qd);e.kD(this.dj);Oe.g(e).ot(this.LR)}this.nh&&this.nh.usc(this.rya);fg.a.Fa(this.Th);this.nh=this.$=this.gridView=this.job=this.Th=null;gl.prototype.dispose.call(this)};w.prototype.Lx=function(){this.Th.hide()};w.prototype.uda=function(){this.Th?this.Th.getButton(this.Cea).sbb():Gd.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};w.prototype.Hhj=function(){this.p0=null};w.prototype.mKf=function(){this.Th&&this.Th.hide()};w.prototype.b1h=function(){if(!this.kid||
1!==this.selectedRange.width)return null;for(var e=this.selectedRange.clone();this.gridView.b_(e);){e.left+=1;e.right+=1;if(!this.gridView.Sf(this.gridView.$a.nj(e)).Jh.zf(e))break;if(this.gridView.Ca.ds(e)){var C=this.gridView.wl("PulloutManager.GetValidatedRangeToFill",e,2);try{if(w.lWj(C))return e}finally{C&&C.dispose()}}}return null};w.prototype.qtc=function(){this.nh.ubb()};w.prototype.showCallout=function(){var e=this;this.uwa&&(this.nh.yyb?(this.Th.getButton(this.Cea).hFb(),xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1)?Pd.TaskExtensions.Ba(Zg.GetServiceTaskFactory.Wa(this.$.da,8,9,0),function(C){e.E3f(C.result)},this.$.ma,3):this.E3f(this.contextMenuManager)):(this.UYc=!0,this.zZ()))};w.prototype.E3f=function(e){e.Sdd("tableFieldList").BO(null,this.Th.domElement(this.Cea),this.nh,null,!0);this.qtc()};w.prototype.fUe=function(){if(!this.uwa||!this.gridView||this.gridView.ha.Pa.mc||!this.gridView.ha.va.qh)return null;var e=this.gridView.ha.va.activeCell,C=Oe.g(this.$).$a.nj(e);if(!e)return null;this.kFa=e.clone();
var J=this.tableManager.Dn(e);this.oLc=!!J;if(this.pN){this.Th.JNb(ue.a.instance.fa(1691),C);this.YO=w.Sfg(J);if(!this.YO)return null;C=this.tableManager.XCe(J,this.gridView);e=C.AY;C=C.returnValue||e;this.pEc=e;if(C)return this.Buc=new Yg.Range(J.top,J.left,J.bottom,J.right,!1,!1),this.yNc=new Yg.Range(this.YO.top,this.YO.right+1,this.YO.top,this.YO.right+1,!1,!1),this.YO}else if(this.kid){this.Th.JNb(ue.a.instance.fa(1692),C);this.sXa=this.gridView.ha.va.Td.clone();J=Oe.g(this.$).Sb.CMa(this.selectedRange);
this.YO=w.Sfg(this.selectedRange);if(!J||!this.YO||!this.selectedRange||xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.nKa(this.selectedRange))return null;this.yNc=this.b1h();if((xe.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.b_(this.selectedRange):this.gridView.b_(this.YO))&&this.fya)return this.Buc=this.YO,J=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",
this.fya?this.fya.toString():"null",this.YO?this.YO.toString():"null",e?e.toString():"null"),Gd.ULS.sendTraceTag(537154137,0,50,J),this.YO}return null};w.prototype.zZ=function(){this.pN?this.nh.zZ(ud.v(this.fya,this.$),!1,!0):xe.EwaSettings.la(136)&&this.nh.zZ(ud.v(this.selectedRange,this.$),!0,!1)};w.prototype.w6a=function(){return this.$.ea.isNamedObjectViewMode&&kf.f(this.$.pa)};w.lWj=function(e){for(;e.$$mn();)if(e.$$cu().text||e.$$cu().LH||e.$$cu().Ci||e.eo.f8e)return!1;return!0};w.Sfg=function(e){return e.right===
Fe.a.Wh?null:new Yg.Range(e.top,e.right,e.top,e.right,!1,!1)};Qk.Object.defineProperties(w.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return this.Th.domElement(1)}},fya:{configurable:!0,enumerable:!0,get:function(){return this.yNc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.sXa}},pN:{configurable:!0,enumerable:!0,get:function(){return this.oLc}},TKf:{configurable:!0,enumerable:!0,get:function(){return this.qee}},HAb:{configurable:!0,enumerable:!0,get:function(){var e=
this.Th.domElement(this.Cea);return e?Bd.DOMElementExtensions.isVisible(e):!1}},uwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&xe.EwaSettings.la(136)?!(new Ff.a(this.$.xa)).Nj:!1}},gIg:{configurable:!0,enumerable:!0,get:function(){return this.pEc}},Cea:{configurable:!0,enumerable:!0,get:function(){return this.fya?this.gridView.$a.nj(this.YO):1}}});Object(Md.a)(w,"PulloutManager",ij.a,[399,2]);var nl=Bh.a;vm(v,nl);v.prototype.create=function(){var e=this;Nh.a.Ga(function(C){var J=
Zg.GetServiceTaskFactory.Wa(C.da,12,477,e.ub),ja=Zg.GetServiceTaskFactory.Wa(C.da,66,134,e.ub),Aa=Zg.GetServiceTaskFactory.Wa(C.da,211,212,e.ub),gb=null,bc=!xe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1);bc&&(gb=Zg.GetServiceTaskFactory.Wa(C.da,8,9,e.ub));Pd.TaskExtensions.Ba(Pd.TaskExtensions.we([J,ja,gb,Aa],C.ma),function(){bc?e.Gb(e.$.da.Aa(261)||new w(e.$,J.result,ja.result,gb.result,Aa.result)):e.Gb(e.$.da.Aa(261)||new w(e.$,J.result,ja.result,null,Aa.result))},
C.ma)})};v.ka=function(e){e.da.Ha(262,new v(e))};Object(Md.a)(v,"PulloutManagerFactory",Bh.a,[]);var tl=b(386);Object(Md.a)(f,"GestureAdapterInfo",null,[]);var sl=b(375),Xk=b(219);m.prototype.uti=function(){if(!this.gHc){var e="hammer.min.js";wg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",!1)&&(e=wg.AFrameworkApplication.ga.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");e=wg.AFrameworkApplication.e7(String.format("{0}",e),5);e=Xk.a.create(e,
null,null);sl.a.Fia(e);this.gHc=e.V7a}return this.gHc};Qk.Object.defineProperties(m,{instance:{configurable:!0,enumerable:!0,get:function(){m.Oa||(m.Oa=new m);return m.Oa}}});m.Oa=null;Object(Md.a)(m,"HammerJsDependencyLoader",null,[491]);var ck;(function(e){e[e.none=-1]="none";e[e.pinch=0]="pinch";e[e.pan=1]="pan";e[e.swipe=2]="swipe"})(ck||(ck={}));Object(Md.b)("GestureEvent",ck);var Pk=b(70),G=Pk.a;vm(n,G);n.create=function(e,C,J,ja,Aa,gb){if(J.rawEvent)if(gb){var bc=J.rawEvent;bc=new Sys.UI.Point(bc.clientX,
bc.clientY)}else bc=Pk.a.Dub(J);else bc=new Sys.UI.Point(J.clientX,J.clientY);return new n(e,bc,C,J,ja,Aa,J.shiftKey,J.ctrlKey,gb)};Qk.Object.defineProperties(n.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.rga}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.LX}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.Wgb}},Sua:{configurable:!0,enumerable:!0,get:function(){return this.spg}}});Object(Md.a)(n,"GestureEventArgs",Pk.a,
[]);Object(Md.a)(l,"GestureManagerData",null,[]);d.Pjg=2;d.Qjg=4;d.Rjg=8;d.Sjg=8;Object(Md.a)(d,"HammerConstants",null,[]);var ka=b(197),Ua=Vd.a;vm(c,Ua);c.prototype.rRh=function(){return this.EOc?0:this.Oie?1:2};c.prototype.en=function(e){Ua.prototype.en.call(this,e);this.Wd.oka(this.OVa,e,0,this.jkb)};c.prototype.$l=function(e){Ua.prototype.$l.call(this,e);this.Wd.aIa(e,this.OVa)};c.prototype.z9i=function(e,C,J){var ja=this;J=void 0===J?null:J;var Aa=void 0===Aa?null:Aa;wg.AFrameworkApplication.Jgc()?
m.instance.uti().continueWith(function(gb){ja.xGj();if(gb.kg||gb.Hh)Gd.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",gb.status);else{Gd.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",gb.status);if(ja.b3d){gb=window.Hammer;if("undefined"===typeof gb){Gd.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");ja.Ayc();return}if("undefined"===typeof gb.inputHandler){Gd.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");ja.Ayc();return}}if(!e)throw ja.Ayc(),
Error.argumentNull("source element can not be null");gb=ka.a.pva(e,ja.eqa);if(void 0===gb||null===gb)gb=new ff.a,ka.a.xcb(e,ja.eqa,gb),ja.A9i(e);var bc=null;if(!gb.xb(ck[0])){bc=Object;var Mc=bc.assign,Hc=new f,yd=ck[0],we=Aa;we=void 0===we?null:we;if(void 0===ja||null===ja)throw Gd.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var $e=null;switch(yd){case Ue.a.pinch:$e=new Hammer.Pinch(we);break;case Ue.a.pan:$e=new Hammer.Pan(we)}$e&&($e.manager=
ja);bc=Mc.call(bc,Hc,{Xca:$e,eXe:C});gb.add(ck[0],bc)}if(void 0!==J&&null!==J)for(Mc=0;Mc<J.length;Mc++)gb.xb(ck[J[Mc]])&&(Hc=gb.oa(ck[J[Mc]]),bc.Xca.recognizeWith(Hc.Xca))}ja.Ayc()}):Gd.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};c.prototype.xGj=function(){this.VIc&&(this.Ah?this.nRc=this.Ah.Ic("Task","RegisterGestureAdapterAfterLoad"):Gd.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};c.prototype.Ayc=function(){this.VIc&&
(this.nRc?this.nRc.stop():Gd.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};c.prototype.A9i=function(e){this.tpg.add(e);this.Wd.oka(this.OVa,e,0,this.jkb)};c.prototype.recognize=function(e){for(var C=Array(e.pointers.length),J=0;J<e.pointers.length;J++)C[J]=e.pointers[J].target;J=null;for(this.zpa=this.ITh(C);void 0!==this.zpa&&null!==this.zpa&&(J=ka.a.pva(this.zpa,this.eqa),void 0===J||null===J);this.zpa=this.zpa.parentNode);if(void 0!==J&&null!==J){this.curRecognizer&&
this.curRecognizer.state===d.Sjg&&(this.curRecognizer=null);C=yl(J.keys);for(var ja=C.next();!ja.done;ja=C.next()){ja=J.oa(ja.value);void 0!==ja&&null!==ja&&void 0!==ja.Xca&&null!==ja.Xca&&(void 0===this.curRecognizer||null===this.curRecognizer||ja.Xca===this.curRecognizer||ja.Xca.canRecognizeWith(this.curRecognizer))&&ja.Xca.recognize(e);var Aa=ja.Xca.state;this.curRecognizer||d.Pjg!==Aa&&d.Qjg!==Aa&&d.Rjg!==Aa||(this.curRecognizer=ja.Xca)}}};c.prototype.emit=function(e,C){if("hammer.input"!==e){this.L8=
!1;C=n.create(e,this.zpa,C.srcEvent,C,3,this.EOc);var J=ka.a.pva(this.zpa,this.eqa);if(this.Bli(e))var ja=0;else if(this.qli(e))ja=1;else if(this.noi(e))ja=2;else{Gd.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}J=J.Hc(ck[ja]).value;void 0!==J&&null!==J&&((J=J.eXe,J.mji())?e.endsWith("start")?this.L8=J.ULi(C):e.endsWith("end")?(J.SLi(C),this.L8=!0):e.endsWith("cancel")?(J.RLi(C),this.L8=!0):e.endsWith("move")&&(this.L8=J.TLi(C)):Gd.ULS.sendTraceTag(42256257,
310,50,"App rejected to perform gesture now : {0}",e))}};c.prototype.get=function(e){return Object(X.a)(Hammer.Recognizer,e)};c.prototype.ITh=function(e){if(1>e.length)return null;if(1===e.length)return e[0];for(var C=e[0],J=!0,ja=1;ja<e.length;ja++){if(!e[ja])return null;if(C!==e[ja]){J=!1;break}}if(J)return C;C=this.wXe(e[0]);J=0;e=yl(e);for(ja=e.next();!ja.done;ja=e.next()){ja=this.wXe(ja.value);if(C.oa(C.count-1)!==ja.oa(ja.count-1))return null;for(var Aa=C.count-2,gb=ja.count-2;Aa>=J&&0<=gb;Aa--,
gb--)if(C.oa(Aa)!==ja.oa(gb)){J=Aa+1;break}}return C.oa(J)};c.prototype.wXe=function(e){for(var C=new va.a;void 0!==e&&null!==e;e=e.parentNode)C.add(e);return C};c.prototype.e0e=function(e){switch(e){case Ue.a.Hf:case Ue.a.nsa:return 1;case Ue.a.xg:case Ue.a.n0b:return 2;case Ue.a.ze:case Ue.a.Oob:return 4;case Ue.a.eAc:case Ue.a.xYc:return 8}return 0};c.prototype.Iya=function(e,C,J){e=this.e0e(e);C=this.rSh(J);Hammer.inputHandler(this,e,C);this.L8&&J.preventDefault();return this.L8};c.prototype.E7e=
function(){return 1<this.lT.count};c.prototype.d1b=function(){Gd.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.gmb)for(var e=yl(this.lT),C=e.next();!C.done;C=e.next())this.YPf(C.value.key);else this.lT=new ff.a;this.session=null};c.prototype.aCg=function(e,C,J){Gd.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",e);if(!this.Fkb.xb(e)){try{C.setPointerCapture(e)}catch(ja){Gd.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",ja)}this.Fkb.add(e,
C)}this.lT.ia(e,J);this.SUa&&1<this.lT.count&&this.qfa&&!this.qfa.upb&&(this.qfa.upb=!0)};c.prototype.YPf=function(e){Gd.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",e);if(this.Fkb.xb(e)){try{this.Fkb.oa(e).releasePointerCapture(e)}catch(C){Gd.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",C)}this.Fkb.remove(e)}else Gd.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",e);this.lT.remove(e);this.SUa&&1>=this.lT.count&&this.qfa&&
this.qfa.upb&&(this.qfa.upb=!1)};c.prototype.Lnc=function(e,C,J){var ja=J.rawEvent.pointerType.toString(),Aa=J.rawEvent.pointerId.toString();if("touch"!==ja)return!1;e=this.e0e(e);if(1!==e&&!this.lT.xb(Aa))return!1;this.h3d&&1===e&&J.rawEvent.isPrimary&&this.lT.count&&(Gd.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.d1b());this.gmb?this.aCg(Aa,C,J):this.lT.ia(Aa,J);this.zMc&&2===e&&(!this.QFc||this.QFc&&"function"===typeof J.rawEvent.getCoalescedEvents)&&(C=J.rawEvent.getCoalescedEvents())&&
this.E7e()&&(this.Kjb=Math.max(this.Kjb,C.length));this.ffe&&(this.L8=!1);ja=this.qSh(this.lT,J,ja);Hammer.inputHandler(this,e,ja);if(4===e||8===e)this.gmb?this.YPf(Aa):this.lT.remove(Aa),this.lT.count||(this.session=null,this.zMc&&-1!==this.Kjb&&(Gd.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Kjb),this.Kjb=-1));this.L8&&J.preventDefault();return this.L8};c.prototype.wnc=function(){return!1};c.prototype.rSh=function(e){var C=new l,J=e.rawEvent,ja=J.touches;J=J.changedTouches;
C.pointers=Array.clone(ja);C.pointers=Array.clone(0<ja.length?ja:J);C.changedPointers=Array.clone(J);C.srcEvent=e;C.pointerType="touch";return C};c.prototype.qSh=function(e,C,J){var ja=new l;ja.pointers=L.toArray(e.values);ja.changedPointers=[C];ja.pointerType=J;ja.srcEvent=C;return ja};c.prototype.Bli=function(e){return Dg.a.startsWith(e,Ue.a.pinch)};c.prototype.qli=function(e){return Dg.a.startsWith(e,Ue.a.pan)};c.prototype.noi=function(e){return Dg.a.startsWith(e,Ue.a.swipe)};Object(Md.a)(c,"GestureInputManager",
Vd.a,[402,403]);a.prototype.ii=function(e){e.register(c,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Cc().Mc(function(){return new c(lk.a.instance,wg.AFrameworkApplication.sa.vD)});this.tb=e};a.prototype.init=function(){this.Vw||(this.tb.resolve("Common.App.GestureManager.GestureInputManager"),this.Vw=!0)};a.prototype.dispose=function(){};a.main=function(){mi.a.instance.rj(new a)};Qk.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});
Object(Md.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Of.a.Zi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
Nh.a.Ga(nc.ka);Nh.a.Ga(Bc.ka);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Ka.main();Of.a.Zi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){vf.initData();Nh.a.Ga(function(e){jf.ka(e);yf.ka(e);vf.ka(e);Pf.ka(e)})})();Of.a.Zi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
Of.a.Zi(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
Nh.a.Ga(Qd.ka);Nh.a.Ga(wc.ka);Nh.a.Ga(be.ka);Of.a.Zi(".ewa-facp-text-box{position:absolute}");(function(){Nh.a.Ga(function(e){pd.ka(e)})})();(function(){Nh.a.Ga(function(e){nd.ka(e)})})();Nh.a.Ga(fd.ka);Nh.a.Ga(zc.ka);Nh.a.Ga(Zc.ka);Of.a.Zi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Nh.a.Ga(ld.ka);Nh.a.Ga(mc.ka);(function(){Nh.a.Ga(function(e){e.da.Ha(150,new Sa(e))})})();(function(){Nh.a.Ga(function(e){Kb.ka(e);Ub.ka(e);H.ka(e)})})();Nh.a.Ga(x.ka);(function(){Nh.a.Ga(function(e){A.ka(e)})})();(function(){Nh.a.Ga(function(e){e.la(136)&&v.ka(e)})})();Type.registerNamespace("Common.App.GestureManager");a.main()},842:function(y,F,b){function a(W,ca,ia,ea,qa,pa,Pa,Ha,Ya,Na,eb,Ia){var lb=fa.call(this)||this;lb.Jkc=!1;lb.contextMenuController=null;lb.zIc=null;lb.LFc=null;lb.lod=!1;
lb.x0j=0;lb.w0j=0;lb.Vrb=null;lb.Ptc=null;lb.rC=function(){lb.contextMenuController?lb.contextMenuController.rC():c.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");lb.hcg()};lb.vb=W;lb.Aqf=qa;lb.EPc=Na;lb.Q_j=ia;lb.P_j=ea;lb.w_j=ca;lb.iIf=pa;lb.populateOnlyOnce=Pa;lb.t6h=eb;lb.COf(Ia);return lb}b.d(F,"a",function(){return a});y=b(0);var c=b(13),d=b(892),l=b(88),n=b(23),m=b(865),f=b(844),v=b(995),
w=b(914),t=b(109),A=b(309),x=b(87),u=b(411),B=b(814);F=b(74);var r=b(16),I=b(4),z=b(975),D=b(77),V=b(43),U=b(57),Q=b(141),la=b(119),ba=b(1),S=b(8),H=b(20),T=b(14),K=b(19),da=b(34),fa=F.a;vm(a,fa);a.prototype.Zc=function(W,ca){W=!0;switch(ca){case 1651433993:case 1675506831:case 966232027:W=this.ue(4096)||this.ue(2048);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:W=this.ue(8192)}return!W};a.prototype.gd=function(W,ca,ia){ia.IsShadowMenuOpen||z.h(this.$,z.d);W=!1;ca===this.$t&&
(ia.IsShadowMenuOpen||z.h(this.$,z.a),ca=Object.assign(new d.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.FDd(ca,ia.IsShadowMenuOpen),ia.MenuItems=ca,ia.IsShadowMenuOpen||z.h(this.$,z.c),W=!0);W&&this.Jkc&&S.HelperMethods.p0b&&!ia.IsShadowMenuOpen&&z.j(this.$);return W};a.prototype.FDd=function(W,ca){(ca=this.VY(ca))?(this.f$e(ca),Array.addRange(W.MenuSectionList,ca.$B().MenuSectionList),this.tCg(W)):c.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};
a.prototype.VY=function(){c.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.BO=function(W,ca,ia,ea,qa){W=Sys.UI.DomElement.getBounds(ca);ia=new Sys.UI.Point(W.x,W.y+W.height);this.ATa(ia,ca);this.$.isChromeRtl&&(ia.x+=W.width);this.Do(ia,qa)};a.prototype.Do=function(W,ca,ia){ia=void 0===ia?0:ia;ca&&(W=da.a(this.$).Jja(W));ca=!0;if(this.t6h){var ea;3===ia?(ea=this.bKa(3))&&0<ea.length?
(ca=!1,this.showFloatie(ea,new Sys.UI.Bounds(W.x,W.y,0,0),ia)):c.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===ia&&this.$.isEditMode&&((ea=this.bKa(2))&&0<ea.length?ea[0]!==a.OUe?(ca=!1,this.xRd(ea,new Sys.UI.Bounds(W.x,W.y,0,0),ia)):c.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",
this.menuId):c.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ca&&this.showContextMenu(new Sys.UI.Bounds(W.x,W.y,0,0),ia)};a.prototype.bKa=function(){return null};a.prototype.pgd=function(W,ca){var ia="";3===W?ia="touch":2===W&&(ia="mouse");W={};return W.ContextMenuId=this.menuId,W.IsEditMode=this.$.isEditMode,W.IsSLR=!!U.a.Rf&&U.a.Rf.NC,W.IsReactMLR=!!U.a.Rf&&
U.a.Rf.OV,W.IsNov=this.$.ea.isNamedObjectViewMode,W.InputType=ia,W.FloatieGroups=JSON.stringify(void 0===ca?null:ca),W};a.prototype.showContextMenu=function(W,ca){ca=void 0===ca?0:ca;var ia=this.pgd(ca);c.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",JSON.stringify(ia));this.contextMenuController?this.pB!==I.a.tGd&&this.pB!==I.a.uGd||0===ca?this.contextMenuController.wRd(this.pB,W,D.a.dc):this.contextMenuController.wRd(this.pB,
W,ca):c.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(W,ca,ia){var ea=this.pgd(ia,W);c.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(ea));this.contextMenuController?(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.IOf(),this.contextMenuController.pxc(W,
ca,ia)):c.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(W))};a.prototype.xRd=function(W,ca,ia){var ea=this.pgd(ia,W);c.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(ea));this.contextMenuController?(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.IOf(),this.contextMenuController.vRd(W,ca,ia,this.pB)):c.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.COf=function(W){this.contextMenuController=W};a.prototype.dispose=function(){this.$&&this.$.Ka.Mab(this);this.vb=null;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.hcg();this.Ptc&&(l.a.Fa(this.Ptc),this.Ptc=
null);fa.prototype.dispose.call(this)};a.prototype.zHh=function(W){var ca=this.$.da.Aa(204);ca&&(ca=ca.gIh(this.Aqf))&&Array.add(W.Ac,ca)};a.prototype.ATa=function(W,ca){W&&ca&&this.$.ea.oc.isDivSyndicated&&n.a.Af&&(ca=ca.ownerDocument.documentElement,W.x-=ca.scrollLeft,W.y-=ca.scrollTop)};a.prototype.ue=function(W){return(new Q.a(this.$.xa)).ue(W)};a.prototype.f$e=function(W){W=yl(W.Ac);for(var ca=W.next();!ca.done;ca=W.next())if(ca=ca.value,Object(u.a)(289,ca)){ca.title&&(ca.title=a.xm(ca.title));
ca=yl(ca.buttons);for(var ia=ca.next();!ia.done;ia=ca.next())ia=ia.value,Object(u.a)(218,ia)?(ia.label=a.xm(ia.label),ia.mS(a.xm(ia.alt))):Object(u.a)(293,ia)&&this.f$e(ia.menu)}};a.prototype.gwd=function(W,ca){ca=void 0===ca?!1:ca;var ia=[];W=yl(W);for(var ea=W.next();!ea.done;ea=W.next())ia.push(this.vU(ea.value,ca));return ia};a.prototype.vU=function(W){for(var ca=[],ia=yl(W.MenuItems),ea=ia.next();!ea.done;ea=ia.next())switch(ea=ea.value,ea.Type){case 3:Array.add(ca,this.h5g(ea));break;case 2:Array.add(ca,
this.M$g(ea));break;case 1:Array.add(ca,this.H6g(ea))}return Object.assign(new m.a,{ControlList:ca,Title:W.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.Kcd=function(W,ca){ca=[this.Vrb,W.RibbonCommand.toString(),ca?this.I_e(ca):this.I_e(W.Label),W.Disabled?W.Disabled.toString():"False"];var ia=W.CommandData;ia=H.a.hashCode(ia).toString();ca.push(ia,W.Identifier.toString());ca=ca.join("_");W.IsChecked&&(ca+="_Checked");
return ca};a.prototype.hIh=function(W){var ca=[this.Vrb,H.a.hashCode(W.Title).toString()];W=yl(W.MenuItems);for(var ia=W.next();!ia.done;ia=W.next())ca.push(ia.value.RibbonCommand.toString());return ca.join("_")};a.prototype.IWe=function(W){var ca=W.Label;ca=H.a.hashCode(ca).toString();ca=[this.Vrb,ca];ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&W.Id&&ca.push(H.a.hashCode(W.Id).toString());ca=ca.join("_");W.IsChecked&&(ca+="_Checked");return ca};
a.prototype.h5g=function(W){var ca=this.w$b(W,!1);var ia=ca.label;var ea=ca.jLa;ca=ca.pp;var qa=this.Kcd(W,ia);return Object.assign(new f.a,{Command:W.Disabled?(-251203935).toString():ca.toString(),ExternalId:qa,Id:qa,Image16by16Class:ea,LabelText:ia||W.Label,MenuItemId:W.CommandData,CommandValueId:W.CommandData})};a.prototype.M$g=function(W){var ca=this.w$b(W,W.IsChecked);var ia=ca.label;var ea=ca.jLa;ca=ca.pp;var qa=this.Kcd(W,ia);return Object.assign(new v.a,{Command:W.Disabled?(-251203935).toString():
ca.toString(),ExternalId:qa,Id:qa,Image16by16Class:ea,LabelText:ia||W.Label,MenuItemId:W.CommandData,CommandValueId:W.CommandData,IsChecked:W.IsChecked})};a.prototype.H6g=function(W){var ca=this.TWe(W);var ia=ca.label;ca=ca.jLa;var ea=Object.assign(new d.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(ea.MenuSectionList,this.gwd(W.SubMenu.Sections,!0));var qa=this.IWe(W);W=ia||W.Label;return Object.assign(new w.a,{ExternalId:qa,Id:qa,LabelText:W,PopulateOnlyOnce:!1,Menu:ea,Image16by16Class:ca,
ImageIsVisible:!!ca})};a.prototype.TWe=function(W){W=this.w$b(W,!0);return{label:W.label,jLa:W.jLa,pp:W.pp}};a.prototype.w$b=function(W,ca){var ia=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled");switch(W.Identifier){case 26:var ea=912804500;ca=r.a.SQe;W=T.a.instance.fa(1899);break;case 3:ea=-1902148570;ca=ca?r.a.haa:null;W=T.a.instance.fa(1859);break;case 4:ea=-1902148570;ca=ca?r.a.haa:null;W=T.a.instance.fa(1860);break;case 5:ea=-1902148570;ca=ca?r.a.haa:null;W=null;
break;case 1:ea=-1677817820;ca=r.a.j8b;W=T.a.instance.fa(231);break;case 2:ea=-1649376918;ca=W.IsChecked?r.a.gaa:null;W=T.a.instance.fa(2062);break;case 23:ea=1701016594;ca=W.IsChecked?r.a.gaa:null;W=T.a.instance.fa(2062);break;case 6:ea=-87741481;ca=null;W=T.a.instance.fa(2063);break;case 7:ea=1948650742;ca=r.a.GPe;W=T.a.instance.fa(1897);break;case 8:ea=1933713114;ca=r.a.FPe;W=T.a.instance.fa(1898);break;case 14:ea=504133448;ca=ia?r.a.e4:ca?r.a.mua:r.a.e4;W=T.a.instance.fa(144);break;case 30:ea=
504133448;ca=ia?r.a.e4:ca?r.a.mua:r.a.e4;W=T.a.instance.fa(148);break;case 32:ea=504133448;ca=ia?r.a.e4:ca?r.a.mua:r.a.e4;W=T.a.instance.fa(150);break;case 34:ea=504133448;ca=ia?r.a.e4:ca?r.a.mua:r.a.e4;W=T.a.instance.fa(152);break;case 27:ea=1701016594;ca=ca?r.a.mua:r.a.e4;W=T.a.instance.fa(144);break;case 15:ea=-798968736;ca=ia?r.a.f4:ca?r.a.nua:r.a.f4;W=T.a.instance.fa(146);break;case 31:ea=-798968736;ca=ia?r.a.f4:ca?r.a.nua:r.a.f4;W=T.a.instance.fa(149);break;case 33:ea=-798968736;ca=ia?r.a.f4:
ca?r.a.nua:r.a.f4;W=T.a.instance.fa(151);break;case 35:ea=-798968736;ca=ia?r.a.f4:ca?r.a.nua:r.a.f4;W=T.a.instance.fa(153);break;case 28:ea=1701016594;ca=ca?r.a.nua:r.a.f4;W=T.a.instance.fa(146);break;case 21:ea=-2058042992;ca=r.a.g2a;W=null;break;case 29:ea=1701016594;ca=r.a.g2a;W=null;break;case 9:ea=1701016594;W=ca=null;break;case 11:ea=-1494291901;W=ca=null;break;case 25:ea=-1045020714;ca=W.IsChecked?r.a.gaa:null;W=null;break;case 13:ea=1701016594;ca=W.IsChecked?r.a.gaa:null;W=T.a.instance.fa(155);
break;case 16:ea=1701016594;ca=r.a.TIa;W=T.a.instance.fa(1035);break;case 17:ea=1701016594;ca=r.a.kua;W=null;break;case 18:ea=1701016594;ca=r.a.jua;W=null;break;case 19:ea=1701016594;ca=r.a.f2a;W=T.a.instance.fa(1040);break;case 20:ea=1701016594;ca=r.a.D9c;W=T.a.instance.fa(1041);break;case 24:ea=1675506831;ca=ia?null:W.IsChecked?r.a.gaa:null;W=null;break;case 22:ea=W.RibbonCommand;ca=W.IsChecked?ia?r.a.haa:r.a.gaa:null;W=null;break;case 36:ea=1461300262;ca=null;W=T.a.instance.fa(154);break;default:c.ULS.shipAssertTag(537167069,
0,!1,"Unable to map menu item: {0}",JSON.stringify(W)),ea=1461300262,W=ca=null}return{label:W,jLa:ca,pp:ea}};a.prototype.I_e=function(W){return ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6130289_FixLoggingColumnNameInButtonId")?H.a.hashCode(W+S.HelperMethods.Jpj).toString():W};a.prototype.tCg=function(W){if(!this.$.ea.amIAlone){var ca=this.$.da.Aa(25);if((void 0!==ca&&null!==ca||!ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!t.a.isEmpty(ca.FBa)&&(ca=ca.q1h(),!A.a.ni(ca))){var ia=
[];x.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").d9g(ca,ia);Array.addRange(W.MenuSectionList,ia)}}};a.prototype.IOf=function(){this.lod||(this.Vtb&&this.Vtb.PYb(this.rC),this.Bpb&&this.Bpb.PYb(this.rC),this.lod=!!this.Vtb||!!this.Bpb)};a.prototype.hcg=function(){this.Vtb&&this.Vtb.ysc(this.rC);this.Bpb&&this.Bpb.ysc(this.rC);this.lod=!1};a.Afc=function(W,ca){ca=V.C(ca);W=K.g(W).Ca.R3a(ca);return!(null===W||void 0===W||!W.hk)};a.pac=function(W,ca,ia){ca=V.C(ca);var ea=K.g(W).Ca.R3a(ca);
ca=K.g(W).getCellBounds(ea);var qa=ea.gNg;ea=ea.fNg;var pa=ca.x+qa.x;ca=ca.y+qa.y;ia&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(K.g(W).rtl||(pa+=ea),ca-=ea);return new Sys.UI.Point(pa,ca)};a.kzh=function(W){try{Object(B.a)(W.CommandValueId)}catch(ca){}};a.xm=function(W){var ca=a.Mta.parseFromString(W,"text/html");return ca?ca.body.innerText:(c.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),W)};Qk.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,
enumerable:!0,get:function(){return this.Ptc}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.EPc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Jb+this.Aqf}},Vtb:{configurable:!0,enumerable:!0,get:function(){this.zIc||(this.zIc=la.a(this.$));return this.zIc}},Bpb:{configurable:!0,enumerable:!0,get:function(){this.LFc||(this.LFc=K.g(this.$).zc);return this.LFc}}});a.Mta=new DOMParser;a.OUe="Unsupported";
Object(y.a)(a,"ContextMenuBase",F.a,[239,478,2])},902:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.ZMe="ewa-ac";a.Vmh="ewa-ac-param";a.iOe="ewa-function-help-link";a.s9c="ewa-lb";a.MNe="ewa-fb-refactor";a.listItem="list-item";a.RAb="list-item-selected";a.VAb="list-table-touch";a.UAb="list-table";a.guh="ewa-suggested-cell-name";a.o_g="columnName-header";a.fPe="ewa-tt";a.Tqh="ewa-function-link-container";a.jOe="ewa-function-udf-name";a.rtl="rtl";Object(y.a)(a,"CssClassNames",
null,[])},938:function(y,F,b){function a(fa,W,ca){this.$Pb=null;this.NF={};this.PQb=this.ax=null;m.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=fa;this.l4d=a.O5c;this.m4d=a.borderStyleSolidLine;this.Fh=W;this.Sa=ca;B.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ha(296,this);this.OU=new c(this.$,this.Fh);this.PC=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);m.ULS.sendTraceTag(537159565,
0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(fa,W){var ca=this;this.zFb=this.ribbonCommandInfo=this.cellFormat=this.Rr=this.Ob=this.ha=null;this.yrc=!1;this.yJf=this.wLa=this.IJf=this.a8d=this.hza=this.yma=null;this.i0b=this.Tta=this.GJf=0;this.borderStyle=this.PZa=this.borderColor=null;this.cB=!1;this.V4b=this.R$a=null;this.m0=function(){if(!ca.cB||K.g(ca.$).jz)ca.cB=!1,K.g(ca.$).jz=!1,ca.Tta=0,K.g(ca.$).Gh.gu(w.a.Uaa),1===ca.$.Ka.oH()&&(K.g(ca.$).sV(I.a.clone(ca.IJf),
ca.GJf,ca.$.pa?ca.$.pa.sheetName:null,null,ca.yJf.clone(),null,null,0,T.a.lih,!0),K.g(ca.$).I0(!0)),ca.wv(),ca.lXd(),ca.tn(),ca.yrc=!1,ca.yma=null,ca.hza=null,ca.Rr&&(ca.Rr.cancel(),ca.Rr.dispose()),m.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ia){try{if(ia=ca.Ie(ia),K.g(ca.$).jz=!0,ca.yma={},ca.hza={},ca.R$a=null,ca.Tob(ca.i0b),2===ia.yb){var ea=K.g(ca.$).ha.vr(ia.clientPoint,ia.Ub,5,void 0,void 0,!1);ea&&(ca.wLa=ea,ca.V4b=
ea,ca.i9i())}}catch(qa){K.g(ca.$).jz=!1}return!0};this.pj=function(ia){try{ia=ca.Ie(ia);var ea=K.g(ca.$).ha.vr(ia.clientPoint,ia.Ub,5,void 0,void 0,!1),qa=K.g(ca.$).Ca.ds(ea);if(!ca.zFb||qa&&(qa.oK!==ca.zFb.oK||qa.nK!==ca.zFb.nK))if(ca.cB=!0,ca.zFb=qa,ea){var pa=new Q.Range(ca.wLa.top,ca.wLa.left,ca.wLa.top,ca.wLa.left,!0,!1);pa.union(ea);pa=K.g(ca.$).ha.RWh(pa);ca.m0b(ea);ca.lUf(ca.R$a,pa);if(ca.bottomRightCorner(pa.bottom,pa.right))return m.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;var Pa=new Q.Range(pa.top,pa.left,pa.bottom+1,pa.right+1,!0,!1),Ha=K.g(ca.$).K$("DrawBorderBehavior.OnPointerMove",[Pa]);if(ca.yma&&ca.hza)for(;Ha.$$mn();){var Ya=Ha.$$cu(),Na=Ya.cell.getRange().toString();Na in ca.yma&&1!==ca.Tta||(ca.yma[Na]=Ya,ca.hza[Na]=Ya.cell.$ua())}ca.R$a=Pa;ca.V4b=pa;K.g(ca.$).sV([pa],0,ca.$.pa.sheetName,null,pa.topLeft,null,null,0,T.a.iih,!0);ca.Fh.Vda(K.g(ca.$),-1690267012,ca.cellFormat,!0,null,[pa])}return!0}catch(eb){return K.g(ca.$).jz=!1}};this.Ng=function(ia){ia=
ca.Ie(ia);(ia=K.g(ca.$).ha.vr(ia.clientPoint,ia.Ub,5,void 0,void 0,!1))?ca.cB&&(ca.m0b(ia),ca.wLa.union(ia),3===ca.Tta?ca.Tob(0):ca.Tob(ca.i0b),K.g(ca.$).sV([ca.wLa],0,ca.$.pa.sheetName,null,null,null,null,0,T.a.jih,!0),ca.Fh.formatCells(-1690267012,ca.cellFormat,ca.ribbonCommandInfo)):(3===ca.Tta?ca.Tob(0):ca.Tob(ca.i0b),K.g(ca.$).sV([ca.V4b],0,ca.$.pa.sheetName,null,null,null,null,0,T.a.kih,!0),ca.Fh.formatCells(-1690267012,ca.cellFormat,ca.ribbonCommandInfo));ca.cB=!1;ca.lXd();ca.yma=null;ca.hza=
null;return!0};this.onKeyDown=function(ia){ia=ca.Ie(ia);if(ca.cB||Array.contains([17,16,18,20],ia.Ea.keyCode))return!0;ca.m0();return!1};this.onKeyUp=function(ia){ia=ca.Ie(ia);if(ia.Ea.keyCode===z.a.LL&&ca.cB)return ca.cB=!1,ca.lUf(ca.R$a,ca.V4b,!0),ca.lXd(),!0;if(ca.cB||ia.Ea.keyCode===z.a.GBa||ia.Ea.keyCode===z.a.O0d||ia.Ea.keyCode===z.a.N0d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ia.Ea.keyCode)||ia.Ea.keyCode===z.a.rkg||ia.Ea.keyCode===z.a.nkg||ia.Ea.keyCode===z.a.jkg)return!0;ca.m0();
return!1};this.F_=function(ia,ea){K.g(ca.$).jz&&!Array.contains(ca.p9h,ea.de.command)&&(m.ULS.sendTraceTag(537159512,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",ea.de),ca.m0())};this.$=fa;this.Fh=W}function d(fa){fa.SOf()}function l(){this.iconName=this.title=this.key=null}function n(fa,W,ca,ia,ea,qa,pa,Pa){this.Plg=fa;this.Qlg=W;this.Olg=ca;this.IP=ia;this.Zwg=ea;this.htg=qa;this.ujb=pa;this.dsg=Pa}b.r(F);y=b(0);var m=b(13),f=b(947),v=b(849),w=b(4),t=b(77),A=b(53),
x=b(215),u=b(32),B=b(1),r=b(14);n.dQg=function(){return new n("BorderStyleSolidLine",1903,1,"1","",1,8,0)};n.$Pg=function(){return new n("BorderStyleDashedLine",1904,3,"1","5,3",1,8,0)};n.aQg=function(){return new n("BorderStyleDottedLine",1905,4,"1","1,1",1,8,0)};n.cQg=function(){return new n("BorderStyleMediumLine",1906,2,"2","",1,8,0)};n.eQg=function(){return new n("BorderStyleThickLine",1907,5,"3","",1,8,0)};n.bQg=function(){return new n("BorderStyleDoubleLine",1908,6,"1","",2,8,3)};Qk.Object.defineProperties(n.prototype,
{tue:{configurable:!0,enumerable:!0,get:function(){return this.Plg}},g0b:{configurable:!0,enumerable:!0,get:function(){return this.Qlg}},sue:{configurable:!0,enumerable:!0,get:function(){return this.Olg}},width:{configurable:!0,enumerable:!0,get:function(){return this.IP}},DHj:{configurable:!0,enumerable:!0,get:function(){return this.Zwg}},$Fi:{configurable:!0,enumerable:!0,get:function(){return this.htg}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.ujb}},Wsi:{configurable:!0,
enumerable:!0,get:function(){return this.dsg}}});Object(y.a)(n,"BorderLineStyleProperties",null,[]);Object(y.a)(l,"BorderLineStyleProps",null,[]);d.prototype.getBorderLineStyleProps=function(){var fa=b(938).BorderFormatManager.OZa,W=Array(Object.keys(fa).length),ca=0,ia;for(ia in fa){var ea=ia,qa=fa[ia];W[ca]=new l;W[ca].key=ea;ea=qa;W[ca].title=r.a.instance.fa(ea.g0b);W[ca].iconName=ea.tue;ca++}return W};Object(y.a)(d,"BorderMenuController",null,[476]);var I=b(309),z=b(91),D=b(169),V=b(12),U=b(117),
Q=b(24),la=b(44),ba=b(42),S=b(201),H=b(8),T=b(105),K=b(19),da=b(34);c.prototype.Fzg=function(fa){m.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=K.g(this.$).ha;this.Ob=K.g(this.$).Ob;this.ribbonCommandInfo=fa;this.IJf=I.a.clone(this.ha.va.selectedRanges);this.GJf=this.ha.va.$A;this.yJf=this.ha.va.activeCell.clone();this.Ob&&this.Ob.Sjd();this.hv();this.al()};c.prototype.dispose=function(){this.m0();this.zFb=this.ribbonCommandInfo=this.cellFormat=
null};c.prototype.Tob=function(fa){var W=b(938).BorderFormatManager;this.cellFormat={};var ca={};this.borderColor=this.borderColor||W.O5c;var ia=x.a.kH(this.borderColor,!1);ca.Color=[ia,ia,ia,ia];B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.PZa&&(ca.ThemeBorderColor=[this.PZa,this.PZa,this.PZa,this.PZa],ca.ColorTypeOption=1);ia=b(938).BorderFormatManager.OZa;this.borderStyle=this.borderStyle||W.borderStyleSolidLine;W=ia[this.borderStyle].sue;ca.LineStyle=[W,W,
W,W];this.cellFormat.BorderFormat=ca;this.cellFormat.ValidMembers=128;this.cellFormat.Border=fa};c.prototype.hv=function(){for(var fa=yl(K.g(this.$).mn),W=fa.next();!W.done;W=fa.next())D.a.instance.qa(V.a.pointerDown,W.value.domElement,this.onPointerDown);U.KeyInputManager.instance.qa(V.a.Tb,document.documentElement,this.onKeyDown);U.KeyInputManager.instance.qa(V.a.Xd,document.documentElement,this.onKeyUp)};c.prototype.i9i=function(){for(var fa=yl(K.g(this.$).mn),W=fa.next();!W.done;W=fa.next())W=
W.value,D.a.instance.qa(V.a.fh,W.domElement,this.pj),D.a.instance.qa(V.a.Zd,W.domElement,this.Ng);D.a.instance.qa(V.a.Zd,document.documentElement,this.Ng);D.a.instance.qa(V.a.gy,document.documentElement,this.Ng);this.yrc=!0};c.prototype.wv=function(){try{for(var fa=yl(K.g(this.$).mn),W=fa.next();!W.done;W=fa.next())D.a.instance.za(V.a.pointerDown,W.value.domElement,this.onPointerDown);U.KeyInputManager.instance.za(V.a.Tb,document.documentElement,this.onKeyDown);U.KeyInputManager.instance.za(V.a.Xd,
document.documentElement,this.onKeyUp)}catch(ca){K.g(this.$).jz=!1,m.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",ca)}};c.prototype.lXd=function(){if(this.yrc)try{this.yrc=!1;for(var fa=yl(K.g(this.$).mn),W=fa.next();!W.done;W=fa.next()){var ca=W.value;D.a.instance.za(V.a.fh,ca.domElement,this.pj);D.a.instance.za(V.a.Zd,ca.domElement,this.Ng)}D.a.instance.za(V.a.Zd,document.documentElement,this.Ng);D.a.instance.za(V.a.gy,
document.documentElement,this.Ng)}catch(ia){K.g(this.$).jz=!1,m.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",ia)}};c.prototype.al=function(){this.$.xa.Qf(this.m0);K.g(this.$).zc.Xl(this.m0);K.g(this.$).aE(this.m0);this.$.Ka.xFa(this.F_)};c.prototype.tn=function(){this.$.xa.ug(this.m0);K.g(this.$).zc.nl(this.m0);K.g(this.$).SF(this.m0);this.$.Ka.mQa(this.F_)};c.prototype.lUf=function(fa,W,ca){ca=void 0===ca?!1:ca;
if(fa&&this.yma&&this.hza)for(fa=K.g(this.$).K$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[fa]);fa.$$mn();){var ia=fa.$$cu().cell.getRange();if(ca||!W.contains(ia)||1===this.Tta){ia=ia.toString();var ea=u.a.Hc(this.yma,ia);if(ea){var qa=u.a.Hc(this.hza,ia);this.setBorders(ea,qa);delete this.yma[ia];delete this.hza[ia]}}}};c.prototype.setBorders=function(fa,W){var ca=fa.cell,ia=ca.getRange();ca.Orc();ia.right!==this.R$a.right&&(ca=new Q.Range(ia.top,ia.left-1,ia.bottom,ia.left-1,!0,!1),K.g(this.$).Ca.ds(ca).gId(3));
ia.bottom!==this.R$a.bottom&&(ca=new Q.Range(ia.top-1,ia.left,ia.top-1,ia.right,!0,!1),K.g(this.$).Ca.ds(ca).gId(1));if(null===W||void 0===W?0:W.Borders.length){var ea={};ca=0;for(var qa=Array(4),pa=Array(4),Pa=0;4>Pa;Pa++)qa[Pa]=1,pa[Pa]=0;W=yl(W.Borders);for(Pa=W.next();!Pa.done;Pa=W.next()){Pa=Pa.value;var Ha=Pa.BorderPosition;qa[Ha]=Pa.BorderLineStyle;var Ya=new S.a(Pa.Color.Red,Pa.Color.Green,Pa.Color.Blue);pa[Ha]=Ya.xS();ca|=H.HelperMethods.n3a(Pa.BorderPosition)}ea.LineStyle=qa;ea.Color=pa;
ea={BorderFormat:ea};ea.Border=ca;this.Fh.ttj(fa,ea,ia)}};c.prototype.m0b=function(fa){var W=this,ca=new Q.Range(Math.max(1,fa.top-1),Math.max(1,fa.left-1),fa.bottom+1,fa.right+1,!1,!1);K.g(this.$).xba(ca)||this.Rr&&this.Rr.ep||(this.Rr=la.a.instance.create(function(){K.g(W.$).Qt(ca,60,T.a.gih)},40,ba.a.hih))};c.prototype.bottomRightCorner=function(fa,W){return 1048576<=fa||16384<=W?!0:!1};c.prototype.Ie=function(fa){return da.a(this.$).Ie(fa)};Qk.Object.defineProperties(c.prototype,{p9h:{configurable:!0,
enumerable:!0,get:function(){return this.a8d||(this.a8d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(y.a)(c,"DrawBorderBehavior",null,[2]);b.d(F,"BorderFormatManager",function(){return a});a.prototype.d6e=function(fa,W){m.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",W.command.toString());
var ca={},ia={};var ea=x.a.kH(this.u3,!1);ia.Color=[ea,ea,ea,ea];this.PC&&this.ota&&(ia.ThemeBorderColor=[this.ota,this.ota,this.ota,this.ota],ia.ColorTypeOption=1);fa=-600086683===W.command?"OutsideBorders":fa[t.a.nd];ia.LineStyle=u.a.Hc(a.MIf,fa);ia.LineStyle?m.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",fa):(ea=a.OZa[this.FHa].sue,ia.LineStyle=[ea,ea,ea,ea],m.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",
this.FHa));ea=u.a.Rn(a.cPg,fa,0);m.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",fa,this.u3);ca.BorderFormat=ia;4!==ea&&8!==ea||!this.$.pa.displayRtl||(ea=4===ea?8:4);ca.ValidMembers=128;ca.Border=ea;this.Fh.formatCells(-1690267012,ca,W);m.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",W.command.toString());return!0};a.prototype.xid=
function(fa,W,ca){m.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",fa.toString(),this.u3);if(this.PC){if((W.SqmControlId||"").includes("ThemeColorPicker")){var ia=this.themesManager.getThemeColor(W.Color);var ea=ia.themeIndex;var qa=ia.dBa;ia.returnValue?(this.PQb={},this.ota.ThemeColorIndex=ea,this.ota.ThemeColorRow=qa):this.PQb=null}else this.PQb=null;this.OU.PZa=this.ota}this.l4d=-1803452024===fa?a.O5c:W.Color;this.OU.borderColor=this.u3;
this.pLe(ca);this.$.If();m.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",fa.toString(),this.u3);return!0};a.prototype.Q4h=function(fa){m.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var W=this.Sa.Kp(),ca=this.Sa.Nc();W.Ac.push(ca);var ia=this.Sa.EA("StyleDashGallery",1,"Size120by20");ca.buttons.push(ia);ca=a.OZa;for(var ea in ca){var qa=ea,pa=ca[ea],Pa=r.a.instance.fa(pa.g0b);ia.At(qa,-2118943501,
"QueryBorderStyle",pa.g0b,qa,qa,void 0,void 0,Pa)}m.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");fa.MenuItems=W.$B();m.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.r3h=function(fa,W){m.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.FHa);fa=fa[t.a.nd];if(a.gpi(fa))this.m4d=fa,m.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.FHa);
else return m.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",fa),!0;this.OU.borderStyle=this.FHa;this.pLe(W);this.$.If();m.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.FHa);return!0};a.prototype.Did=function(fa){m.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.nTc(fa,64,
this.u3,86,1);return!0};a.prototype.Eid=function(fa){m.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.nTc(fa,112,this.u3,87,2);return!0};a.prototype.s6e=function(fa){m.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.nTc(fa,112,"white",88,3);return!0};a.prototype.T4h=function(fa){this.csj(this.dPg,fa,fa.MenuItemId?fa.MenuItemId:
a.borderStyleSolidLine)};a.prototype.csj=function(fa,W,ca){ca in fa?(fa=fa[ca],m.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",ca),this.esj(W,fa)):m.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",ca)};a.prototype.d5h=function(fa,W){var ca=fa[t.a.nd];return"DrawBorder"===ca?this.Did(W):"DrawBorderGrid"===ca?this.Eid(W):"EraseBorder"===ca?this.s6e(W):this.d6e(fa,W)};a.prototype.SOf=
function(){this.$Pb||this.fQg()};a.prototype.hLh=function(){return new d(this)};a.prototype.fQg=function(){this.$Pb={};var fa=0,W=a.OZa,ca={},ia;for(ia in W){ca.Mea=W[ia];var ea=ca.Mea.tue;r.a.instance.fa(ca.Mea.g0b);var qa=function(pa){return function(){return appChrome.buildBorderStyleIconNew(pa.Mea.DHj,pa.Mea.width,pa.Mea.$Fi,pa.Mea.lineHeight,pa.Mea.Wsi)}}(ca);this.$Pb[ea]=ea;this.Eab(ea,qa);fa++;ca={Mea:ca.Mea}}};a.prototype.Eab=function(fa,W){if(!(fa in this.NF)){var ca={};W=W();ca[fa]=W;appChrome.api.registerIconProvider(function(){return ca});
this.NF[fa]=!0}return fa};a.prototype.esj=function(fa,W){fa.MenuItemId&&(fa[f.a.On]=fa.MenuItemId===this.FHa,fa[v.a.Icon]=W)};a.prototype.nTc=function(fa,W,ca,ia,ea){m.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.bXg(fa,ea)?(m.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.OU.m0()):(K.g(this.$).jz&&this.OU.m0(),A.a.current&&(ia=String.format(w.a.tta,
A.a.current.oo(ia)),K.g(this.$).Gh.gu(ia)),this.OU.i0b=W,this.OU.borderColor=ca,K.g(this.$).jz=!0,this.OU.Fzg(fa),this.OU.Tta=ea)};a.prototype.pLe=function(fa){if(fa)switch(this.OU.Tta){case 2:this.Eid(fa);break;default:this.Did(fa)}};a.prototype.bXg=function(fa,W){return this.OU.Tta===W&&-236759591!==fa.command&&-2118943501!==fa.command?!0:!1};a.gpi=function(fa){return fa?fa in a.MIf||fa in a.OZa:!1};Qk.Object.defineProperties(a.prototype,{FHa:{configurable:!0,enumerable:!0,get:function(){return this.m4d}},
u3:{configurable:!0,enumerable:!0,get:function(){return this.l4d}},ota:{configurable:!0,enumerable:!0,get:function(){return this.PQb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.ax||(this.ax=this.$.da.Aa(422));return this.ax}},dPg:{configurable:!0,enumerable:!0,get:function(){this.SOf();return this.$Pb}}});Qk.Object.defineProperties(a,{OZa:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.n2d||(a.n2d=(fa.BorderStyleSolidLine=n.dQg(),fa.BorderStyleDashedLine=n.$Pg(),
fa.BorderStyleDottedLine=n.aQg(),fa.BorderStyleMediumLine=n.cQg(),fa.BorderStyleThickLine=n.eQg(),fa.BorderStyleDoubleLine=n.bQg(),fa))}},cPg:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.m2d||(a.m2d=(fa.NoBorder=0,fa.BottomBorder=1,fa.TopBorder=2,fa.LeftBorder=4,fa.RightBorder=8,fa.OutsideBorders=64,fa.AllBorders=112,fa.ThickOutsideBorders=64,fa.InsideBorders=48,fa.InsideHorizontalBorders=16,fa.InsideVerticalBorders=32,fa.BottomDoubleBorder=1,fa.ThickBottomBorder=1,fa.TopBottomBorder=
3,fa.TopThickBottomBorder=3,fa.TopDoubleBottomBorder=3,fa))}},MIf:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.Wde||(a.Wde=(fa.ThickOutsideBorders=[2,2,2,2],fa.BottomDoubleBorder=[1,6,1,1],fa.ThickBottomBorder=[1,2,1,1],fa.TopBottomBorder=a.Cch,fa.TopThickBottomBorder=[1,2,1,1],fa.TopDoubleBottomBorder=[1,6,1,1],fa))}}});a.m2d=null;a.n2d=null;a.Wde=null;a.O5c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.Cch=[1,1,1,1];Object(y.a)(a,"BorderFormatManager",null,[422])},
975:function(y,F,b){function a(I,z,D){window.performance.measure(I,z,D);z=window.performance.getEntriesByName(I);z.length||w.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",I);return z[z.length-1]?z[z.length-1].duration:-1}function c(){if(t.a.Qob){var I=a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),z=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),D=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");
w.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",I,z,D)}}function d(I,z){B.HelperMethods.AYc&&window.performance.mark(z)}function l(I){I=r.g(I).ha.va;return I.qh&&(I.Td.isRow||I.Td.Rh)}function n(I){return I.Sb.Nka(I.ha.va.activeCell)}function m(I,z,D,V,U){I=V.wl("ContextMenuHelper.FindFirstCellInViewportArea",I,z,D);try{for(I.$$rst();I.$$mn();){var Q=I.$$cu();if(Q&&f(Q,V,U))return Q.cell}}finally{I&&
I.dispose()}return null}function f(I,z,D){var V=z.rtl,U=D.isChromeRtl;I=I.cell;return(D=r.g(D).YJ(I))?(D=D.topLeft,V=D.x+=V===U?I.offsetWidth:0,U=D.y+=I.offsetHeight,z.view.visibleArea.contains(new x.a(V,U,0,0))):!1}function v(I,z){var D=I.wc(null);if((null===D||void 0===D?0:D.cell.hk)&&f(D,I,z))return I.getCellBounds(D.cell);D=I.ha.va.activeCell;return(z=m(new u.Range(D.top,D.left,A.a.Kh,D.left,!1,!1),2,!0,I,z)||m(new u.Range(1,D.left,D.top,D.left,!1,!1),2,!1,I,z)||m(new u.Range(D.top,D.right,D.top,
A.a.Wh,!1,!1),1,!0,I,z)||m(new u.Range(D.top,1,D.top,D.right,!1,!1),1,!1,I,z)||null)&&z.hk?I.getCellBounds(z):Sys.UI.DomElement.getBounds(I.U4a.Kb)}b.d(F,"i",function(){return"ContextMenuPerf.A"});b.d(F,"b",function(){return"ContextMenuPerf.B"});b.d(F,"d",function(){return"ContextMenuPerf.C1"});b.d(F,"a",function(){return"ContextMenuPerf.C2"});b.d(F,"c",function(){return"ContextMenuPerf.D"});b.d(F,"e",function(){return v});b.d(F,"f",function(){return n});b.d(F,"g",function(){return l});b.d(F,"h",
function(){return d});b.d(F,"j",function(){return c});var w=b(13),t=b(314),A=b(9),x=b(58),u=b(24),B=b(8),r=b(19)},976:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.dNg="AutoFill";a.akj="RowOperations";a.p_g="ColumnOperations";a.rXj="ViewModeRowOperations";a.qXj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.nwj="ShapeStyle";a.fEh="FloatingObjectClipboard";a.LHf="PivotTableCopyDelete";
a.NHf="PivotTableFieldListActions";a.zxe="CellFloatie";a.jwj="ShapeFloatie";a.contextMenu="ContextMenu";a.B2h="GridContextMenu";a.GZi="PivotTableContextMenu";a.gEh="FloatingObjectContextMenu";a.fWg="CellRTEFloatie";a.v1f="ShapeRTEFloatie";Object(y.a)(a,"FloatieGroupIdentifiers",null,[])},977:function(y,F,b){function a(t,A,x){var u=w.call(this,A)||this;u.vR=!1;u.sjc=!1;u.pNa=null;u._selectedRowListBox=null;u.Gn=null;u.Hzf=function(B){return u.gnc(B)};u.CAd=function(B){f.g(B.Ea);u.raiseEvent(a.q4a);
u.raiseEvent(a.cOd);return!0};u.onScroll=function(B){f.g(B);u.XFd();u.raiseEvent(a.q4a)};u.onBlur=function(B){f.g(B);u.XFd()};u.onPointerDown=function(){u.XFd();u.raiseEvent(a.q4a);u.raiseEvent(a.qPa);return!1};u.vDb=function(B){var r=B.Ea;if(r.button===Sys.UI.MouseButton.leftButton||r.button===Sys.UI.MouseButton.rightButton)u.Lk=u.bac(r),u.onPointerDown(B);u.raiseEvent(a.Grd);return!1};u.vb=t;u.QAb=x;u.RAa(!0);return u}b.d(F,"a",function(){return a});y=b(0);var c=b(88),d=b(275),l=b(12),n=b(169);
F=b(230);var m=b(11),f=b(69),v=b(19),w=F.a;vm(a,w);a.prototype.I9=function(t){this.get_events().addHandler(a.q4a,t)};a.prototype.ida=function(t){this.get_events().removeHandler(a.q4a,t)};a.prototype.NYb=function(t){this.get_events().addHandler(a.Hkd,t)};a.prototype.wsc=function(t){this.get_events().removeHandler(a.Hkd,t)};a.prototype.wnb=function(t){this.get_events().addHandler(a.cOd,t)};a.prototype.oHb=function(t){this.get_events().removeHandler(a.cOd,t)};a.prototype.EYa=function(t){this.get_events().addHandler(a.qPa,
t)};a.prototype.$ab=function(t){this.get_events().removeHandler(a.qPa,t)};a.prototype.YUc=function(t){this.get_events().addHandler(a.Grd,t)};a.prototype.gJd=function(t){this.get_events().removeHandler(a.Grd,t)};a.prototype.dispose=function(){this.G7(!1);this.RAa(!1);c.a.sc([this.pNa]);this.pNa=null;w.prototype.dispose.call(this)};a.prototype.bac=function(t){return m.DOMElementExtensions.Ced(t.target,"tr",!0)};a.prototype.iB=function(t){if(t){if(!this.Lk){var A=this.Gn;if(!A||!A.rows.length)return;
this.Lk=A.rows[0];0<t?t--:t++}A=this.Lk;for(var x=0,u=Math.abs(t);x<u;x++)if(0>t){if(!A.previousSibling)break;A=A.previousSibling}else{if(!A.nextSibling)break;A=A.nextSibling}A&&(this.Lk=A)}};a.prototype.$mb=function(t,A){m.DOMElementExtensions.toggleCssClass(t,this.QAb.ListTableClassInTouch,A)};a.prototype.G7=function(t){var A=this.Gn;A&&(t&&!this.sjc?(d.a.instance.qa(l.a.click,A,this.Hzf),d.a.instance.qa(l.a.gk,A,this.CAd),n.a.instance.qa(l.a.pointerDown,A,this.vDb),this.sjc=!0):this.sjc&&(d.a.instance.za(l.a.click,
A,this.Hzf),d.a.instance.za(l.a.gk,A,this.CAd),n.a.instance.za(l.a.pointerDown,A,this.vDb),this.sjc=!1))};a.prototype.jBa=function(t){var A=null;t&&(A=m.DOMElementExtensions.Aj(t,this.QAb.ListCellClass))&&A.classList.toggle(this.QAb.ListCellSelectedClass);return A};a.prototype.RAa=function(t){this.gg&&(t&&!this.vR?(this.pNa=this.Qd.Ed(this.gg),this.pNa.ka("scroll",this.onScroll),this.pNa.ka("blur",this.onBlur),n.a.instance.qa(l.a.pointerDown,this.domElement,this.onPointerDown),this.vR=!0):this.vR&&
(c.a.Fa(this.pNa),this.pNa=null,n.a.instance.za(l.a.pointerDown,this.domElement,this.onPointerDown),this.vR=!1))};a.prototype.gnc=function(t){return this.CAd(t)};a.prototype.uuc=function(t){if(t){var A=t.offsetTop,x=this.gg.scrollTop;A<x?this.bXf(!0):A+t.offsetHeight>x+this.gg.clientHeight&&this.bXf(!1)}};a.prototype.bXf=function(t){this.gg.scrollTop=t?this.Lk.offsetTop:this.Lk.offsetTop+this.Lk.offsetHeight-this.gg.clientHeight};a.prototype.XFd=function(){v.g(this.$).isEditing&&this.raiseEvent(a.Hkd)};
Qk.Object.defineProperties(a.prototype,{Lk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(t){this.jBa(this._selectedRowListBox);t?(this._selectedRowListBox=t,this.jBa(this._selectedRowListBox),this.uuc(t)):this._selectedRowListBox=null}},m_:{configurable:!0,enumerable:!0,get:function(){return this.QAb.ListCellClass}},Rba:{configurable:!0,enumerable:!0,get:function(){return this.QAb.ListTableClass}},$H:{configurable:!0,enumerable:!0,get:function(){return 8}},
FBb:{configurable:!0,enumerable:!0,get:function(){return 5}},qjc:{configurable:!0,enumerable:!0,get:function(){return 24}},pjc:{configurable:!0,enumerable:!0,get:function(){return 35}},gg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});a.q4a="GotFocus";a.Hkd="IgnoreBlur";a.cOd="SetCell";a.qPa="PointerDown";a.Grd="ItemPointerDown";Object(y.a)(a,"ListBox",F.a,[466,2])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/1a8402d2bb9ea2688cbfdf95cd433ae6/EwaDS.kpae.js.map