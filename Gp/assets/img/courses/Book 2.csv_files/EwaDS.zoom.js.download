(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[40],{1401:function(y,F,b){function a(Ja){var Ta=ma.call(this)||this;Ta.$=Ja;Ta.fc();return Ta}function c(Ja){var Ta=hc.call(this,Ja)||this;Ta.yAb=null;Ta.qxa=null;Ta.zoomEventManager=null;Ta.DAb=-1;Ta.pef=!1;Ta.od=function(){Ta.DAb=-1};t.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");Ta.zfb=new d(Ja);Ta.CZi()&&(t.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),Ta.lMg());
Ta.P$i();return Ta}function d(Ja){var Ta=lb.call(this)||this;Ta.statusBarManager=null;Ta.TVe=!1;Ta.$=Ja;Ta.$.da.Za(29,function(pb){Ta.statusBarManager=pb;pb.vJ(Ta)});return Ta}function l(){return eb.call(this)||this}function n(Ja){this.v5a=this.zec=0;this.t1b=null;this.sef=!1;this.$=Ja;this.sef=Ja.mic}function m(Ja){return D.call(this,Ja)||this}function f(Ja){this.$=Ja}b.r(F);var v=b(10);y=b(0);var w=b(817),t=b(13),A=b(958),x=b(9),u=b(77),B=b(175),r=b(372),I=b(34),z=b(52);f.prototype.Zc=function(){return!1};
f.prototype.executeCommand=function(Ja,Ta,pb){var Db=!1;Ja=Ta.command;var fb=I.a(this.$);11!==Ta.df&&7!==Ta.df&&6!==Ta.df&&2!==Ta.df&&14!==Ta.df&&15!==Ta.df&&16!==Ta.df&&t.ULS.sendTraceTag(537149787,0,15,"ZoomCommandHandler.ExecuteCommand - unsupported zoom origin {0}",Ta.df);var xa=6===Ta.df;switch(Ta.command){case -1365094462:case -1441674458:fb.fDc(Math.floor(10*fb.zoom)/10+.1,xa);Db=!0;break;case 1056010365:case 1664364901:fb.fDc(Math.ceil(10*fb.zoom)/10-.1,xa);Db=!0;break;case 346087880:fb.fDc(x.a.dca,
xa);Db=!0;break;case -1918142559:case 1517993347:u.a.nd in pb?(pb=parseFloat(pb[u.a.nd]),pb!==fb.zoom&&fb.eDc(pb,1517993347===Ta.command),Db=!0):t.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:Ta=parseFloat(pb[A.a.Value]);isNaN(Ta)||fb.eDc(Ta/100,!0);Db=!0;break;case 1409187195:fb.zoomFitToScreen();Db=!0;break;case -1836771825:fb.zoomFitToScreenUndo(),Db=!0}return Db?z.Task.Ta(!0):B.a(Ja)};f.prototype.Kc=function(Ja,
Ta){switch(Ta.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return I.a(this.$).CX();case -1365094462:case 1056010365:case -2096586688:return r.a(this.$);default:return!1}};f.prototype.gd=function(){return!1};Object(y.a)(f,"ZoomCommandHandler",null,[239]);var D=w.a;vm(m,D);m.prototype.Pd=function(){this.Gd([new f(this.$)])};m.ka=function(Ja){w.a.he(370,new m(Ja))};Object(y.a)(m,"ZoomCommandHandlerFactory",
w.a,[]);F=b(214);var V=b(88),U=b(23),Q=b(87),la=b(567),ba=b(45),S=b(4),H=b(153),T=b(61),K=b(283),da=b(126),fa=b(43),W=b(39),ca=b(11),ia=b(1),ea=b(8),qa=b(102),pa=b(105),Pa=b(19),Ha=b(300),Ya=b(127);n.prototype.mji=function(){return Pa.g(this.$).isEditing?(t.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.Ab.QC?(t.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),
!1):!0};n.prototype.ULi=function(Ja){this.t1b=new Sys.UI.Point(Math.round(Ja.Sua.center.x),Math.round(Ja.Sua.center.y));this.zec=I.a(this.$).zoom;this.v5a=Ja.Sua.scale;var Ta={};Ta=(Ta.InitialZoom=this.zec,Ta.Location="canvas",Ta.InputMethod=Ja.yb,Ta);Ya.b(this.$).fe(da.a.BZi,Ta);t.ULS.sendTraceTag(537149793,0,50,"PinchToZoomAdapter.OnGestureStart starting gesture. center ({0},{1}), initial zoom {2}, initial scale {3}",this.t1b.x,this.t1b.y,this.zec,this.v5a);this.q8a(Ja,"onGestureStart");return!0};
n.prototype.TLi=function(Ja){if(!this.v5a)return t.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.q8a(Ja,"OnGestureEvent"),!0;if(!isFinite(this.v5a))return t.ULS.sendTraceTag(537149791,0,15,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale={0}",this.v5a),this.q8a(Ja,"OnGestureEvent"),!0;var Ta=Ja.Sua.scale/this.v5a*this.zec;I.a(this.$).Ehg(Ta,this.t1b);t.ULS.sendTraceTag(537149790,0,50,"PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom {0}. Current scale {1}",
Ta,Ja.Sua.scale);this.q8a(Ja,"OnGestureEvent");return!0};n.prototype.SLi=function(Ja){I.a(this.$).Fhg();t.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.q8a(Ja,"OnGestureEnd")};n.prototype.RLi=function(Ja){t.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.q8a(Ja,"OnGestureCancel")};n.prototype.q8a=function(Ja,Ta){var pb,Db,fb;this.sef&&(t.ULS.sendTraceTag(536990857,0,50,"PinchToZoomAdapter.markGestureEventAsHandled - Invoked from {0},        eventArgs non-null: {1}, gestureData non-null: {2},        srcEvent non-null: {3}",
Ta,isNullOrUndefined(Ja),isNullOrUndefined(null===Ja||void 0===Ja?void 0:Ja.Sua),isNullOrUndefined(null===(pb=null===Ja||void 0===Ja?void 0:Ja.Sua)||void 0===pb?void 0:pb.srcEvent)),null===(fb=null===(Db=null===Ja||void 0===Ja?void 0:Ja.Sua)||void 0===Db?void 0:Db.srcEvent)||void 0===fb?void 0:fb.preventDefault())};Object(y.a)(n,"PinchToZoomAdapter",null,[338]);var Na=b(36),eb=Na.a;vm(l,eb);l.prototype.Roe=function(Ja){this.addHandler("ZCIEK",Ja)};l.prototype.HRf=function(Ja){this.removeHandler("ZCIEK",
Ja)};l.prototype.Qoe=function(Ja){this.addHandler("ZCUIK",Ja)};l.prototype.GRf=function(Ja){this.removeHandler("ZCUIK",Ja)};l.prototype.QHg=function(Ja){this.addHandler("ZCEK",Ja)};l.prototype.Hej=function(Ja){this.removeHandler("ZCEK",Ja)};l.prototype.B5i=function(){this.raiseEvent("ZCIEK")};l.prototype.A5i=function(){this.raiseEvent("ZCUIK")};l.prototype.C5i=function(){this.raiseEvent("ZCEK")};Object(y.a)(l,"ZoomEventManager",Na.a,[337]);var Ia=b(20),lb=Na.a;vm(d,lb);d.prototype.sq=function(Ja){this.addHandler("Zoom",
Ja)};d.prototype.Lq=function(Ja){this.removeHandler("Zoom",Ja)};d.prototype.uz=function(){this.jn("QueryZoomStatus")&&this.raiseEvent("Zoom")};d.prototype.Zr=function(Ja,Ta){return"QueryZoomStatus"!==Ja?!1:this.b5h(Ta)};d.prototype.jn=function(){return I.a(this.$).CX()};d.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.$=null;lb.prototype.dispose.call(this)};d.prototype.$4e=function(Ja){Ja=this.E1h(Ja);if(!Ja)return null;Ja=Ja.getElementsByClassName("cui-ctl-mediumlabel");
return 1!==Ja.length?(t.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):Ja[0]};d.prototype.b5h=function(Ja){if(!this.$)return!1;var Ta=I.a(this.$).AOb,pb=this.$4e("HandleQueryZoomStatusCommand");pb?Ia.a.equals(Ja.LabelText.toString(),Ta,!1)||(pb.innerText="",this.E_f(Ja,Ta)):this.E_f(Ja,Ta);return!0};d.prototype.E_f=function(Ja,Ta){Ja.LabelText=Ta};d.prototype.E1h=function(Ja){var Ta=ca.DOMElementExtensions.getElementById(this.$.domElement,
"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!Ta)return Ta=(Ta=this.$.ea.oc)?Ta.inEmbedView:!1,U.a.Wp||Ta||t.ULS.sendTraceTag(537149763,0,15,"ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from {0}",Ja),null;this.TVe||(this.TVe=!0,t.ULS.sendTraceTag(537149762,0,50,"ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from {0}",Ja));return Ta};Object(y.a)(d,"ZoomStatusBarManager",Na.a,[2,245,210]);var hc=la.a;vm(c,hc);c.prototype.dispose=function(){this.zfb&&
(V.a.Fa(this.zfb),this.zfb=null);this.zoomEventManager&&(this.$.da.JU(419),this.zoomEventManager=null);this.pef&&this.Deh();hc.prototype.dispose.call(this)};c.prototype.CX=function(){return!0};c.prototype.Ehg=function(Ja,Ta){Ja=this.Aua(Ja);if(Pa.g(this.$).rtl){var pb=Math.round(ca.DOMElementExtensions.getBounds(this.$.tf).width*I.a(this.$).zoom);this.yAb=new Sys.UI.Point(pb-Ta.x,Ta.y)}else this.yAb=Ta;this.sAa(Ja,!1,"ZoomWithPinch")};c.prototype.dDc=function(){return!0};c.prototype.cDc=function(Ja,
Ta){var pb=U.a.isMac?.07:.15;Ja=this.zoom+(Ja?pb:-pb);Ja=this.Aua(Ja);Pa.g(this.$).rtl?(pb=Math.round(ca.DOMElementExtensions.getBounds(this.$.tf).width*I.a(this.$).zoom),this.qxa=new Sys.UI.Point(pb-Ta.x,Ta.y)):this.qxa=Ta;Ta=this.zoom;this.sAa(Ja,!0,"ZoomWithMouse");pb={};Ta=(pb.InitialZoom=Ta,pb.FinalZoom=Ja,pb.Location="canvas",pb);Ya.b(this.$).fe(da.a.EZj,Ta)};c.prototype.Fhg=function(){this.yAb=null};c.prototype.eDc=function(Ja,Ta){this.sAa(this.Aua(Ja),!1,Ta?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")};
c.prototype.Ghg=function(Ja){isNaN(Ja)?t.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.sAa(this.Aua(Ja),!1,"ZoomToLevelInExcelLive")};c.prototype.Hhg=function(Ja){this.sAa(this.Aua(Ja),!1,"ZoomWithActionPen")};c.prototype.fDc=function(Ja,Ta){this.sAa(this.Aua(Ja),!0,Ta?"ZoomWithShortcuts":"ZoomWithButtons")};c.prototype.X2e=function(Ja,Ta){var pb=Pa.g(this.$).rtl,Db=yl(this.cgd(pb));pb=Db.next().value;Db=Db.next().value;
var fb=yl(this.Ohd(Ja,Db)),xa=fb.next().value;fb=fb.next().value;return this.qxa?(Ja=this.Ifd(this.qxa,Ja,Ta,Db,pb,"ZoomWithMouse"),this.qxa=null,Ja):this.yAb?this.Ifd(this.yAb,Ja,Ta,Db,pb,"ZoomWithPinch"):Pa.g(this.$).ha.Pa.f5?this.DZj(Ja,Ta,Db,pb,xa,fb,Pa.g(this.$).rtl):this.FZj(Ja,Ta,Db,pb,xa,fb,Pa.g(this.$).rtl)};c.prototype.eXf=function(Ja,Ta,pb){Ja?(t.ULS.sendTraceTag(537149782,0,50,"Zoom To: ({0} {1}) (new top-left) from zoom:{2} to zoom:{3}",Ja.x,Ja.y,Ta,pb),Ja=new ba.a(Ja.x,Ja.y),ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6055130_UseViewportInDocumentCoordinatesForZoomScroll")?
(pb=Pa.g(this.$).rtl,pb=yl(this.cgd(pb)),pb.next(),pb=pb.next().value,pb=yl(this.Ohd(Ta,pb)),Ta=pb.next().value,pb=pb.next().value):(Ta=Pa.g(this.$).view.visibleArea.width,pb=Pa.g(this.$).view.visibleArea.height),Pa.g(this.$).rpe(Ja,Ta,pb,pa.a.yKg)):t.ULS.sendTraceTag(537149781,0,50,"Zooming top-left: from zoom:{0} to zoom:{1}",Ta,pb)};c.prototype.zoomFitToScreen=function(){var Ja=this.zoom,Ta=Pa.g(this.$).rtl,pb=yl(this.cgd(Ta)),Db=pb.next().value,fb=pb.next().value,xa=yl(this.Ohd(Ja,fb));pb=xa.next().value;
var ya=xa.next().value;(Ta=(xa=Pa.g(this.$).ha.Pa.f5)?this.l_e(this.AEb,pb,ya,!1):this.d3e(this.AEb,fb,Db,pb,ya,Ta,!1))?(Ta=Math.min(pb/(Ta.width+100),ya/(Ta.height+100)),Ta=this.VDh(Ta),this.sAa(Ta,!0,"ZoomWithFitToScreen"),xa?Pa.g(this.$).ha.Pa.Bsa(Pa.g(this.$).ha.Pa.mc,!1):(Ta=fa.v(Pa.g(this.$).ha.va.activeRange,this.$),Pa.g(this.$).Ug(Ta,null,null,null,3,pa.a.CZj)),this.DAb=Ja,this.pef||this.iMg()):t.ULS.sendTraceTag(537149780,0,15,"ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: {0}",
xa)};c.prototype.zoomFitToScreenUndo=function(){this.sAa(this.DAb,!1,"ZoomWithFitToScreen")};c.prototype.bRd=function(){return-1!==this.DAb};c.prototype.iMg=function(){var Ja=Pa.g(this.$);Ja&&(Ja.ha.MG(this.od),Ja.aE(this.od))};c.prototype.Deh=function(){var Ja=Pa.g(this.$);Ja&&(Ja.ha.UF(this.od),Ja.SF(this.od))};c.prototype.VDh=function(Ja){Ja=Math.min(Ja,x.a.nAi);Ja=Math.max(Ja,x.a.qBi);return Math.round(100*Ja)/100};c.prototype.sAa=function(Ja,Ta,pb){if(this.aDc()){var Db=Pa.g(this.$).view.visibleArea.toString();
Ja=this.Aua(Ja);var fb=T.d(this.$.xa.pa);fb||(fb=la.a.Ksf);Pa.g(this.$).Li.z7(5,Ha.a.$Cc,pb);Pa.g(this.$).Li.wla(Ha.a.$Cc,this.$.ea.uf);t.ULS.sendTraceTag(537149779,0,50,"ZoomManager.SetNewZoomLevel Setting zoom {0} to sheet {1} origin {2} prevZoom {3}",Ja,fb,pb,this.zoom);this.mvj(fb,Ja);this.zoomEventManager.C5i();this.zNj(pb);this.GNj(Ta);this.DAb=-1;r.b(this.$,pb);t.ULS.sendTraceTag(537149778,0,50,"ZoomManager.SetNewZoomLevel OldGridVisibleArea: {0}, NewGridVisibleArea: {1}, IsShyRibbonActive: {2}",
Db,Pa.g(this.$).view.visibleArea.toString(),this.$.Tka)}};c.prototype.gNh=function(Ja){return(Ja=ea.HelperMethods.XA(this.$.tf,this.$.domElement,Ja))?Ja:new Sys.UI.Point(0,0)};c.prototype.cgd=function(Ja){var Ta=this.gNh(Ja);Ja=this.SRh(Ta,Ja);return[Ta,Ja]};c.prototype.Ohd=function(Ja,Ta){var pb=ca.DOMElementExtensions.getBounds(this.$.tf);return[Math.round((pb.width-Ta.x)*Ja),Math.round((pb.height-Ta.y)*Ja)]};c.prototype.SRh=function(Ja,Ta){Ta=ea.HelperMethods.XA(Pa.g(this.$).domElement,this.$.domElement,
Ta);return Ta?(Ja=new Sys.UI.Point(Math.round(Ta.x-Ja.x),Math.round(Ta.y-Ja.y)),Ja):new Sys.UI.Point(0,0)};c.prototype.FZj=function(Ja,Ta,pb,Db,fb,xa,ya){return(ya=this.d3e(Ja,pb,Db,fb,xa,ya))?this.d2e(ya,Ja,Ta,pb,Db,fb,xa):null};c.prototype.d3e=function(Ja,Ta,pb,Db,fb,xa,ya){ya=void 0===ya?!0:ya;var Ga=fa.F(Pa.g(this.$).ha.va.selectedRanges);if(ya&&(Ga=Ga.zf(fa.F(Pa.g(this.$).fcc())),!Ga))return t.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),
null;var db=Pa.g(this.$).wc(Ga.topLeft);Ga=Pa.g(this.$).wc(Ga.bottomRight);if(!db||!Ga)return t.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;Ja=db.cell.oK===Ga.cell.oK&&db.cell.nK===Ga.cell.nK?this.YLh(Ja,Ga,Ta,pb,Db,xa):this.t0h(Ja,db,Ga,Ta,pb,Db,xa);return Ja?ya?this.LUe(Ja,Db,fb):Ja:(t.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)};
c.prototype.LUe=function(Ja,Ta,pb){if(0>Ja.x||Ja.x>Ta)Ja.x=0;if(0>Ja.y||Ja.y>pb)Ja.y=0;Ja.x+Ja.width>Ta&&(Ja.width=Ta-Ja.x);Ja.y+Ja.height>pb&&(Ja.height=pb-Ja.y);return Ja};c.prototype.t0h=function(Ja,Ta,pb,Db,fb,xa,ya){Ta=Pa.g(this.$).getCellBounds(Ta.cell);if(!Ta)return null;var Ga=Pa.g(this.$).getCellBounds(pb.cell);if(!Ga)return null;var db=fb.x;ya&&(db=0,Ta.x=Math.round(xa/Ja)-Ta.x-Math.round(Ta.width),Ga.x=Math.round(xa/Ja)-Ga.x-Math.round(Ga.width));Ja=new Sys.UI.Bounds(Math.round((Ta.x-Db.x)*
Ja)-db,Math.round((Ta.y-Db.y)*Ja-fb.y),Math.round((Ga.x+Ga.width-Ta.x)*Ja),Math.round((Ga.y+Ga.height-Ta.y)*Ja));t.ULS.sendTraceTag(537149774,0,50,"ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:{0}, b:{1}, r:{2}, l:{3}) in bounds ({4}, {5}, {6}, {7})",pb.cell.getRange().top,pb.cell.getRange().bottom,pb.cell.getRange().right,pb.cell.getRange().left,Ja.x,Ja.y,Ja.width,Ja.height);return Ja};c.prototype.YLh=function(Ja,Ta,pb,Db,fb,xa){var ya=
Pa.g(this.$).getCellBounds(Ta.cell);if(!ya)return null;var Ga=Db.x;xa&&(Ga=0,ya.x=Math.round(fb/Ja)-ya.x-Math.round(ya.width));Ja=new Sys.UI.Bounds(Math.round((ya.x-pb.x)*Ja)-Ga,Math.round((ya.y-pb.y)*Ja-Db.y),Math.round(ya.width*Ja),Math.round(ya.height*Ja));t.ULS.sendTraceTag(537149773,0,50,"ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:{0}, l:{1}) in bounds ({2}, {3}, {4}, {5})",Ta.cell.getRange().top,Ta.cell.getRange().left,Ja.x,Ja.y,Ja.width,Ja.height);return Ja};
c.prototype.DZj=function(Ja,Ta,pb,Db,fb,xa){var ya=this.l_e(Ja,fb,xa);return ya?this.d2e(ya,Ja,Ta,pb,Db,fb,xa):null};c.prototype.d2e=function(Ja,Ta,pb,Db,fb,xa,ya){Ja=new Sys.UI.Point(this.D2e(xa,Ja.x,Ja.width),this.D2e(ya,Ja.y,Ja.height));return this.Ifd(Ja,Ta,pb,Db,fb)};c.prototype.D2e=function(Ja,Ta,pb){return Ja===pb?(t.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),Ja/2):Ja*Ta/(Ja-pb)};c.prototype.l_e=
function(Ja,Ta,pb,Db){Db=void 0===Db?!0:Db;var fb=Pa.g(this.$).ha.Pa.mc.domElement,xa=ea.HelperMethods.XA(fb,Pa.g(this.$).domElement,Pa.g(this.$).rtl);if(!xa)return t.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;var ya=ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6055130_UseViewportInDocumentCoordinatesForZoomScroll")?Pa.g(this.$).Uvb():Pa.g(this.$).view.visibleArea;xa=new Sys.UI.Point(Math.round((xa.x-ya.topLeft.x)*Ja),Math.round((xa.y-
ya.topLeft.y)*Ja));Ja=new Sys.UI.Bounds(xa.x,xa.y,Math.round(fb.offsetWidth*Ja),Math.round(fb.offsetHeight*Ja));return Db?this.LUe(Ja,Ta,pb):Ja};c.prototype.htf=function(){this.zfb.uz()};c.prototype.fFi=function(Ja){"ZoomToLevelInExcelLive"===Ja?this.zoomEventManager.B5i():this.zoomEventManager.A5i()};c.prototype.P$i=function(){this.zoomEventManager=this.$.da.Ha(419,new l)};c.prototype.Ifd=function(Ja,Ta,pb,Db,fb,xa){xa=void 0===xa?"":xa;var ya=Pa.g(this.$).rtl?0:fb.x;fb="ZoomWithPinch"===xa||"ZoomWithMouse"===
xa?new Sys.UI.Point(Ja.x-ya-Math.round(Db.x*Ta),Ja.y-fb.y-Math.round(Db.y*Ta)):Ja;fb=new Sys.UI.Point(Math.round(fb.x/Ta),Math.round(fb.y/Ta));t.ULS.shipAssertTag(537149770,0,!!Ta,"Original zoom level must be different than 0");ya=pb/Ta;fb=new Sys.UI.Point(Math.round(fb.x*(1-1/ya)),Math.round(fb.y*(1-1/ya)));"ZoomWithMouse"===xa||"ZoomWithPinch"===xa?(fb.x+=Math.round((Db.x-Pa.g(this.$).uI)*(ya-1)),fb.y+=Math.round((Db.y-Pa.g(this.$).JJ)*(ya-1))):(ya=Math.round(Db.x*(pb-Ta)),0<ya&&fb.x>ya&&(fb.x+=
ya),Ta=Math.round(Db.y*(pb-Ta)),0<Ta&&fb.y>Ta&&(fb.y+=Ta));"ZoomWithMouse"===xa&&(Ja.x||(fb.x=0),Ja.y||(fb.y=0));Ja=ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6055130_UseViewportInDocumentCoordinatesForZoomScroll")?Pa.g(this.$).Uvb():Pa.g(this.$).view.visibleArea;return new Sys.UI.Point(fb.x+Ja.topLeft.x,fb.y+Ja.topLeft.y)};c.prototype.lMg=function(){var Ja=this,Ta=[];Q.a.instance.pc("Common.IGestureInputManager").execute(function(pb){0===pb.rRh()&&pb.z9i(document.body,new n(Ja.$),Ta)})};c.prototype.CZi=
function(){return this.aDc()&&(U.a.cp&&U.a.TLa(67)||this.$.mic)};c.prototype.mvj=function(Ja,Ta){r.a(this.$)?this.setZoomLevel(Ja,Ta,this.K_d,x.a.jJf):this.setZoomLevel(Ja,Ta,this.zoomPerSheetId,this.AEb)};c.prototype.setZoomLevel=function(Ja,Ta,pb,Db){pb.remove(Ja);Ta!==Db&&pb.add(Ja,Ta)};c.prototype.zNj=function(Ja){this.s0f();this.$.qza(K.a.DZ("TriggerImmediateZoomOperations"));this.dVj();this.fFi(Ja)};c.prototype.dVj=function(){this.Kmi()?this.$.If():this.zfb.uz();var Ja=this.zfb.$4e("UpdateZoomStatusBar");
Ja&&(Ja.innerText=this.AOb)};c.prototype.Kmi=function(){var Ja=H.a(this.$);return Ja?Ja.Hm.Co===(W.a.Xwa(this.$)?S.a.Wqc:this.$.Jb+S.a.JUf):!1};c.prototype.GNj=function(Ja){Pa.g(this.$).BZj(Ja);this.yIg()};c.prototype.yIg=function(){var Ja=qa.a(this.$);if(Ja)for(var Ta=yl(Pa.g(this.$).Ca.UE()),pb=Ta.next();!pb.done;pb=Ta.next())if(pb=pb.value,!pb)t.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");else{if(pb.hk&&(pb=pb.Xi))for(var Db=0;Db<
pb.count;Db++)if(2===pb.fg(Db).type){var fb=Ja.Tp(pb.fg(Db).Gg());fb?(fb.a1(!1),t.ULS.sendTraceTag(537149766,0,50,"ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom {0}",this.zoom)):t.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else t.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")};Object(y.a)(c,"ZoomManager",la.a,[]);var ma=F.a;vm(a,ma);a.prototype.create=
function(){var Ja=new c(this.$);this.fVj(Ja);this.Gb(Ja)};a.prototype.fVj=function(Ja){var Ta=I.a(this.$);if(Ta){var pb=Ta.Vhd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");Ja.pPd(pb);Ja.luc(Ta.PAc)}else t.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")};a.ka=function(Ja){Ja.da.Ha(369,new a(Ja))};Object(y.a)(a,"ZoomManagerFactory",
F.a,[]);b=b(516);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(function(){v.a.Ga(function(Ja){a.ka(Ja);m.ka(Ja)})})();b.a.Zi(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.zoom.js.map/ab97a8156e83100ab966dfa1b9a418f4/EwaDS.zoom.js.map