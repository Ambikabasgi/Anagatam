(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1132:function(y,F,b){function a(n,m){n=l.call(this,n,m)||this;m!==d.a.T9&&n.qFa(m);n.Mga(a.iterateNext);n.Mga(a.kxa);n.RTc(c.a.$Ta);n.RTc(c.a.aUa);return n}b.d(F,"a",function(){return a});y=b(0);var c=b(170);F=b(1247);var d=b(889),l=F.a;vm(a,l);a.iterateNext="IterateNext";a.kxa="IteratePrevious";a.BMb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.ROa=
"OnVHDiffReady";Object(y.a)(a,"VersionHistoryMessenger",F.a,[])},1250:function(y,F,b){function a(K,da,fa,W){var ca=this;this.authorColor=this.j2=this.Dea=null;this.a7a=!1;this.Q$f=0;this.Q0a=-1;this.Z4c=0;this.bIa=100;this.ala=-1;this.AZd=null;this.Dob=v.a.bXj;this.JGe=v.a.cXj;this.Mh=function(ia){(ia=r.a(ia)?null:ia.Result)?ia.OperationWaitingForFileDownload?20>ca.Z4c?(ca.bIa*=2,T.Task.delay(ca.bIa).continueWith(function(){ca.KWd()})):(ca.nBc(),d.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
ia.ActivityList?(ca.initialize(ia.ActivityList,ia.VersionAuthors),I.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?ca.ROa():ca.wxc(!0),ca.AZd.stop(),d.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",ca.AZd.Ec.toString())):(ca.nBc(),d.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(ca.bIa*=2,T.Task.delay(ca.bIa).continueWith(function(){ca.KWd()}),
d.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.Kya=function(){ca.nBc();d.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Hrd=function(ia){d.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ia.MessageId);switch(ia.MessageId){case ba.a.iterateNext:ca.iterateNext();ca.ala=(ca.ala+1)%ca.sS.length;ca.VIb(ba.a.setCurrentChangeCount,
ca.ala+1);break;case ba.a.kxa:ca.kxa();ca.ala=0>ca.ala?0:ca.ala;ca.ala=(ca.ala+ca.sS.length-1)%ca.sS.length;ca.VIb(ba.a.setCurrentChangeCount,ca.ala+1);break;case ba.a.BMb:ca.wxc(ia.Values.ToggleValue)}};this.H0g=function(ia,ea){return ca.G2b(ia.ym,ea.ym)};this.G0g=function(ia,ea){return ca.G2b(ia.ym,ea)};this.od=function(){ca.I5b()};this.kp=function(){ca.I5b()};this.ej=function(){ca.I5b()};d.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=K;this.ariaLiveNotifier=
W;this.gridView=Q.g(this.$);this.gridView.ha.MG(this.od);this.gridView.aE(this.kp);this.gridView.zc.Xl(this.ej);this.YSj();da&&(this.AZd=K.Wb.Ic("UserAction","VersionHistoryDiffManagerStopWatch"),this.KWd());if(this.fs=fa)K=l.a.Oaa(this.$.ya.VersionHistoryActionUrl)||H.a.T9,K!==H.a.T9&&this.fs.qFa(K),this.fs.Xn(ba.a.iterateNext),this.fs.Xn(ba.a.kxa),this.fs.Xn(ba.a.BMb),this.fs.Jl(ba.a.iterateNext,this.Hrd),this.fs.Jl(ba.a.kxa,this.Hrd),this.fs.Jl(ba.a.BMb,this.Hrd)}function c(K,da,fa){this.nFa=K;
this.ym=da;this.ZBc=fa}y=b(0);var d=b(13),l=b(78),n=b(961),m=b(84),f=b(185),v=b(9),w=b(203),t=b(61),A=b(43),x=b(521),u=b(164),B=b(106),r=b(303),I=b(1),z=b(8),D=b(94),V=b(14),U=b(272);b(105);var Q=b(19),la=b(336);Object(y.a)(c,"UserActivityLocation",null,[]);var ba=b(1132),S=b(81),H=b(889),T=b(52);b.d(F,"a",function(){return a});a.prototype.dispose=function(){this.Eza();this.Dea=this.j2=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.UF(this.od),this.gridView.SF(this.kp),this.gridView.zc&&
this.gridView.zc.nl(this.ej),this.fs&&(this.fs.voa(ba.a.kxa),this.fs.voa(ba.a.iterateNext),this.fs.voa(ba.a.BMb)))};a.prototype.initialize=function(K,da){K?(this.Eza(),this.Q0a=-1,this.Dea=[],this.a7a=!1,this.j2={},this.authorColor={},this.czi(da),this.F4c(K)):d.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.KWd=function(){function K(fa,W,ca){var ia=da.$.na.ta;fa=U.b(fa,da.Mh);W=U.a(W,da.Kya);var ea=ia.Na(1,null);return S.i(ia,
"GetVersionHistoryHighlightActivitiesData",ea,fa,W,ca,null,4)}var da=this;d.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.Z4c.toString(),this.bIa.toString());this.Z4c++;I.EwaSettings.tc()?this.$.userOperationManager.ic(new u.a(537,0,K,80),null):this.$.userOperationManager.ic(new x.a(537,0,K,16),null)};a.prototype.wxc=function(K){var da=this.j2,fa;for(fa in da){var W=fa,ca=da[fa];ca?ca.RKb(K):d.ULS.shipAssertTag(537150404,
0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+W+"view was Null")}};a.prototype.Eza=function(){var K=this.j2,da;for(da in K){var fa=da,W=K[da];W?W.Naj():d.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+fa+"view was Null")}this.Dea=this.j2=null};a.prototype.wXf=function(K){var da=this.OUh(K,this.Q0a);var fa=da.eaf;K=da.rfg;da.returnValue&&(d.ULS.shipAssertTag(537150402,0,!!K,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),
this.I5b(),K.nFa.toString()in this.j2?(this.j2[K.nFa.toString()].rnj(K.ym),da=A.D(K.ym),this.ariaLiveNotifier.setEnabled(!1),this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(V.a.instance.Cb(157),fa+1,this.sS.length,da.DC(!1),K.ZBc.DisplayName)),this.Q0a=fa):d.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",K.nFa.toString())))};a.prototype.VIb=function(K,da){if(I.EwaSettings.la(329))if(this.fs){var fa=
{};fa.count=da;K=new n.a(K);K.Values=fa;this.fs.send(K)}else d.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else d.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.OUh=function(K,da){var fa=!1;var W=null;for(var ca=0;!fa&&ca<this.sS.length;){da=K?this.FUh(da):this.oWh(da);W=this.sS[da];var ia=Object(m.a)(D.a,this.$.xa.getItemByName(W.ym.SheetName));
if(!ia)return d.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),{returnValue:!1,eaf:da,rfg:W};ia.visible&&(fa=!0);ca++}return{returnValue:fa,eaf:da,rfg:W}};a.prototype.FUh=function(K){return-1===K?this.e1e():(K+1)%this.sS.length};a.prototype.oWh=function(K){-1===K&&(K=this.e1e());return K=(K+this.sS.length-1)%this.sS.length};a.prototype.F4c=function(K){this.bah(K);
this.k4c()};a.prototype.K0h=function(K,da){var fa=[];if(!K.RangeList)return d.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),fa;K=yl(K.RangeList);for(var W=K.next();!W.done;W=K.next())(W=W.value)&&this.$.xa.yj(W.SheetName)?(W=new c(0,W,da),fa.push(W)):d.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+W.SheetName);return fa};a.prototype.bah=function(K){K=yl(K);for(var da=K.next();!da.done;da=
K.next())if(da=da.value,!da||B.e(da.LocationList))d.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var fa=yl(da.LocationList),W=fa.next();!W.done;W=fa.next())if(W=W.value)switch(W.Type){case 0:this.Dea.push.apply(this.Dea,Gl(this.K0h(W,da.Person)));break;default:d.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else d.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};
a.prototype.k4c=function(){for(var K={},da=new f.a,fa=[],W=yl(this.Dea),ca=W.next();!ca.done;ca=W.next())if(ca=ca.value,da.contains(ca.ZBc)||da.add(ca.ZBc),0===ca.nFa){var ia=new la.a(A.D(ca.ym),t.d(this.$.xa.getItemByName(ca.ym.SheetName))),ea=a.zwc(ia);ea in K||fa.push(ia);K[ea]=this.HMh(ca.ZBc)}d.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",
this.Dea.length,fa.length,da.count,this.Q$f);this.nBc();0<fa.length&&(K=new (b(1343).RangeVersionHistoryHighlightView)(this.$,fa,K,this.Dob),this.j2["0"]=K)};a.prototype.nBc=function(){var K=this.Dea?this.sS.length:0;this.VIb(ba.a.setCurrentChangeCount,0);this.VIb(ba.a.setTotalChangesCount,K)};a.prototype.ROa=function(){this.VIb(ba.a.ROa,0)};a.prototype.czi=function(K){if(K){this.Q$f=K.length;for(var da=0;da<K.length;++da)if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&
!K[da].InitialsColor)d.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var fa=K[da].EmailAddress;var W=K[da].UserName;var ca=null;if(K[da].LoginName){var ia=K[da].LoginName.split("|");3===ia.length&&(ca=ia[2])}ca?this.authorColor[ca]=K[da].InitialsColor:fa?(d.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[fa]=K[da].InitialsColor):
W?(d.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[W]=K[da].InitialsColor):d.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else d.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.YSj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var K=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?
Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,da=0;da<K.length;da++){var fa=K[da],W=fa.key?fa.key:fa.Key?fa.Key:"";fa=fa.value?fa.value:fa.Value?fa.Value:"";"DefaultColor"===W?this.JGe=fa:"InitialTint"===W?this.Dob=fa:d.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else d.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};
a.prototype.HMh=function(K){if(K.Email in this.authorColor)return this.authorColor[K.Email];if(K.DisplayName in this.authorColor)return this.authorColor[K.DisplayName];d.ULS.sendTraceTag(537150356,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.JGe};a.prototype.G2b=function(K,da){var fa=Object(m.a)(D.a,this.$.xa.getItemByName(K.SheetName)),W=Object(m.a)(D.a,this.$.xa.getItemByName(da.SheetName));return fa&&
W?(fa=(fa=z.HelperMethods.UC(fa.index,W.index))||z.HelperMethods.UC(K.FirstRow,da.FirstRow))||z.HelperMethods.UC(K.FirstColumn,da.FirstColumn):(d.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.e1e=function(){var K=A.m(this.gridView.ha.va.activeRange,this.$.xa.pa);if(!K)return d.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;K=
z.HelperMethods.mx(new w.a(this.sS),0,this.sS.length,K,this.G0g);0>K&&(K=~K);return K%this.sS.length};a.prototype.I5b=function(){if(this.OIb){if(!(this.OIb.nFa.toString()in this.j2)){d.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",this.OIb.nFa.toString()));return}this.j2[this.OIb.nFa.toString()].Ldh(this.OIb.ym)}this.Q0a=-1};a.prototype.iterateNext=function(){this.wXf(!0)};a.prototype.kxa=function(){this.wXf(!1)};
a.zwc=function(K){return String.format("{0}{1}",K.range,K.sheetId)};Qk.Object.defineProperties(a.prototype,{rfb:{configurable:!0,enumerable:!0,get:function(){return this.j2}},OIb:{configurable:!0,enumerable:!0,get:function(){return-1===this.Q0a?null:this.sS[this.Q0a]}},sS:{configurable:!0,enumerable:!0,get:function(){this.a7a||(this.Dea.sort(this.H0g),this.a7a=!0);return this.Dea}}});Object(y.a)(a,"VersionHistoryHighlightManager",null,[713,2])},1343:function(y,F,b){function a(x,u,B,r){this.zib=null;
this.$=x;this.Zvg=u;this.ORa=B;this.PRa={};this.Dob=r;this.mci()}function c(){}b.r(F);y=b(0);var d=b(13),l=b(9);c.nuh="ewa-vhr-rectinnerborder";Object(y.a)(c,"CssClassNames",null,[]);var n=b(61),m=b(43),f=b(215),v=b(105),w=b(19),t=b(336),A=b(1250);b.d(F,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.RKb=function(x){x?this.Ob.xs(this.AH):this.Ob.kl(this.AH)};a.prototype.Naj=function(){this.RKb(!1);this.Ob.GJb(new t.a(null,n.d(this.$.pa)),this.AH)};a.prototype.rnj=function(x){if(this.ORa){var u=
new t.a(m.D(x),n.d(this.$.xa.getItemByName(x.SheetName))),B=A.a.zwc(u);if(B in this.ORa)if(B in this.PRa){u=f.a.Sp(this.ORa[B]);B=this.PRa[B];for(var r in B)B[r].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",u.r,u.g,u.b,l.a.dXj);w.g(this.$).ha.Pa.$G(null);w.g(this.$).H5e(x,60,!0,v.a.R5i)}else d.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+B);else d.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+
B)}else d.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.Ldh=function(x){x=new t.a(m.D(x),n.d(this.$.xa.getItemByName(x.SheetName)));var u=A.a.zwc(x);if(u in this.PRa)if(u in this.ORa){x=f.a.Sp(this.ORa[u]);u=this.PRa[u];for(var B in u)u[B].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",x.r,x.g,x.b,this.Dob)}else d.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+
u);else d.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+u)};a.prototype.mci=function(){var x=this;this.Ob.qy(this.Zvg,[a.U4],!1,function(u,B){if(u&&u.range&&u.sheetId&&B){var r=new t.a(u.range,u.sheetId);r=A.a.zwc(r);r in x.PRa||(x.PRa[r]={});x.PRa[r][u.paneType.toString()]=B;r in x.ORa?(u=x.ORa[r],r=f.a.Sp(u),B.style.borderColor=u,B.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",r.r,r.g,r.b,x.Dob),u=document.createElement("div"),
u.className=c.nuh,B.appendChild(u)):d.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+r)}else d.ULS.shipAssertTag(537150423,0,!!u,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),d.ULS.shipAssertTag(537150422,0,!u||!!u.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),d.ULS.shipAssertTag(537150421,0,!u||!!u.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),
d.ULS.shipAssertTag(537150420,0,!!B,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Qk.Object.defineProperties(a.prototype,{AH:{configurable:!0,enumerable:!0,get:function(){return[a.U4]}},Ob:{configurable:!0,enumerable:!0,get:function(){return this.zib||(this.zib=w.g(this.$).Ob)}}});a.U4=23;Object(y.a)(a,"RangeVersionHistoryHighlightView",null,[752])},1381:function(y,F,b){function a(Zb){var Nc=re.call(this)||this;Nc.$=Zb;Nc.fc();return Nc}function c(Zb,Nc,cd,Xd){var Le=this;
cd=void 0===cd?null:cd;Xd=void 0===Xd?null:Xd;this.JGa=null;this.L7e=!1;this.EFf=function(le){Le.t_a.Npj();Le.t_a.wxc(!0);Mf.a.ni(le.wywaActivities)||2===le.wywaActivities[0].type||Le.t_a.i8h(le.wywaActivities[0])};this.$=Zb;this.t_a=new U(this.$);this.U2d=new fa(cb.AFrameworkApplication.Hb,te.EwaSettings.la(470));Zb=Rd.a.LLj(Se.a.instance.pc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.plf=Xd;this.qxe=new w(this.$,Zb,this.q6a());this.pxe=new V(this.$,cb.AFrameworkApplication.Hb);this.emptyCatchUpBehaviorManager=
new v(this.$);this.pti(function(le){Le.jIi(le)},Nc);this.lvi();Nc=null;cd||(Nc=Se.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=cd||new n(Nc);this.flyoutFocus=new m(this.$,this.flyoutRibbonButton)}function d(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=
this.activityContentManager=null}function l(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function n(Zb){this.buttonClickedCallback=null;this.Yib=this.Cyb=!1;this.MEh=new Date;this.TUe=Zb}function m(Zb,Nc){this.$=Zb;this.flyoutRibbonButton=void 0===
Nc?null:Nc;sd.a(this.$).Qg(this);this.hasFocus=!1}function f(Zb){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+Zb)}function v(Zb){this.$=Zb}function w(Zb,Nc,cd){cd=void 0===cd?!1:cd;this.$=Zb;this.rxe=Nc;this.$Eb=Se.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.wqc=Se.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.q6a=cd}function t(){var Zb=r.call(this)||this;Zb.relationship=0;return Zb}function A(){this.color=
this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function x(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function u(){this.activityFeedItems=null}function B(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function r(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=
this.relevancy=this.displayTimestamp=this.location=this.actors=null}function I(Zb,Nc,cd,Xd,Le,le,zf){zf=Zb.Na(1,void 0===zf?null:zf);zf.getRelevantActivitiesDataRequest=Nc;return pc.i(Zb,"GetRelevantActivitiesData",zf,cd,Xd,Le,le,0)}function z(Zb,Nc,cd,Xd,Le,le){le=Zb.Na(1,void 0===le?null:le);return pc.i(Zb,"GetLineageWywaAuthors",le,Nc,cd,Xd,Le,4)}function D(){}function V(Zb,Nc){this.$=Zb;this.Fi=Nc}function U(Zb){var Nc=this;this.cRa=this.q3b=this.Yea=null;this.T4={};this.cDa=null;this.bkd=!1;
this.uDb=function(cd,Xd){switch(Xd.state){case 0:case 1:3===Xd.UEd&&(Nc.A7h(),Nc.cRa=null);break;case 2:break;case 3:Nc.o6c();Nc.cRa=Xd.activityId;Nc.LAj();break;default:mb.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Xd.state)}};this.Zk=function(){Nc.Jrb()};this.od=function(){Nc.Jrb()};this.kp=function(){Nc.Jrb()};this.ej=function(){Nc.Jrb()};this.w3f=function(cd,Xd){Nc.Yea&&Xd.zH!==Nc.eka&&(Xd.isSticky&&Nc.e6b(!0),
(cd=Nc.tOj(Xd.zH))?(Nc.Yea.createActivityIndicatorTooltip(Object.assign(new ba,{target:Xd.zH,container:cd,activityIds:[Xd.activityId],isSticky:Xd.isSticky,dirHint:Nc.gridView.rtl?12:9})),Xd.isSticky?(Nc.eka=Xd.zH,mb.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(Nc.Fdc=Xd.zH,mb.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),
Nc.egc||(Nc.gridView.view.Ls(Nc.RAc),Nc.gridView.$q(Nc.RAc),Nc.egc=!0)):mb.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.BIe=function(cd,Xd){Nc.e6b(Xd.Ufh)};this.RAc=function(){Nc.Yea?(Nc.eka&&Nc.Yea.updateActivityIndicatorTooltip(Object.assign(new Q,{target:Nc.eka,isSticky:!0})),Nc.Fdc&&Nc.Yea.updateActivityIndicatorTooltip(Object.assign(new Q,{target:Nc.eka,isSticky:!1}))):mb.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};
this.$=Zb;this.gridView=Sc.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.zc;this.ha.HYb(this.Zk);this.ha.MG(this.od);this.gridView.aE(this.kp);this.Ya.Xl(this.ej);this.eka=this.Fdc=null;this.egc=!1;this.rbd={}}function Q(){this.target=null;this.isSticky=!1}function la(){this.clearSticky=!1}function ba(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function S(){this.Z1c=[];this.eKb={};this.Vke={}}function H(Zb,Nc,cd,Xd,Le){Zb=T.call(this,Zb,Nc,cd,Xd)||
this;Zb.ranges=Le;Zb.a7a=!1;return Zb}function T(Zb,Nc,cd,Xd){var Le=Eb.call(this)||this;Le.$=Zb;Le.k1d=Nc;Le.Ckg=cd;Le.UB=Xd;Le.state=0;return Le}function K(Zb,Nc,cd){cd=wh.call(this,Zb,Nc,cd)||this;cd.gridView=Sc.g(Zb);cd.Fma=Nc;return cd}function da(Zb){var Nc=this;this.uDb=function(){switch(Nc.Su.model.state){case 1:Nc.y4f(!0);break;case 0:Nc.RKb(!1);break;case 2:case 3:Nc.RKb(!0);break;default:mb.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+
Nc.Su.model.state)}};this.gqg=Zb;this.Su.hne(this.uDb);this.gN=[]}function fa(Zb){this.Fi=Zb}function W(Zb){return Wd.call(this,Zb)||this}function ca(Zb,Nc){this.$=Zb;this.catchUpActivityManager=Nc}function ia(){this.tb=null}function ea(Zb){this.wu=Zb}function qa(Zb){this.Qtg=Zb}function pa(Zb){this.yXa=Zb;this.Eae=new he.a}function Pa(Zb,Nc,cd){this.Vsg=Zb;this.JUa=Nc;this.ZUa=cd}function Ha(Zb,Nc){return vf.call(this,Zb,Nc)||this}function Ya(Zb,Nc){this.Sg=Zb;this.wu=Nc}function Na(Zb){var Nc=ze.call(this)||
this;Nc.$=Zb;Nc.fc();return Nc}function eb(Zb,Nc){var cd=this;this.Xpd=!1;this.Mf=function(){cd.vag()};this.$=Zb;te.EwaSettings.la(639)&&this.$.ea.R7a&&!eb.Awb&&(Nc&&!Nc.mdb||this.UWj(),eb.N7e?mb.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):Nc&&!Nc.mdb||this.$Wj());mb.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Ia(Zb){var Nc=Jd.call(this)||this;
Nc.wi=null;Nc.eh=null;Nc.$=Zb;Nc.fc();return Nc}function lb(Zb,Nc,cd){var Xd=Dd.call(this,Zb)||this;Xd.pe=null;Xd.Sze=null;Xd.yDb=null;Xd.ypd=!0;Xd.Dr=0;Xd.vp=!1;Xd.qd=function(Le,le){le.Mg||Xd.b1c()};Xd.$j=function(){Xd.b1c();return!0};Xd.$=Nc;Xd.taskPaneManager=cd;Xd.$.ul(Xd.qd);sd.a(Xd.$).Qg(Xd);ke.a.Ld(Xd.$)&&(Xd.isVisible=!1);return Xd}function hc(Zb){var Nc=Xe.call(this)||this;Nc.lineageTaskPane=null;Nc.t7=null;Nc.$=Zb;Nc.fc();return Nc}function ma(Zb,Nc,cd,Xd){var Le=this;this.mtb=this.tF=
null;this.WD=this.ntd=0;this.yDb=function(){Le.t7&&(Le.t7.stop(),Le.t7=null);Le.HKb.start();Le.tF.createLineagePane(Le.itd,Le.mtb)};this.lineageOpenPaneOrChangeFilterRequest=function(le,zf){function bf(df,Uf,Re){var Je=Le.$.na.ta,qg=pg;df=Wc.b(df,Le.wfd("LineageOpenPaneOrChangeFilter"));Uf=Wc.a(Uf,Lf);var Xg=Je.Na(1,null);Xg.clientParams=hf;Xg.lineageFilter=qg;return pc.i(Je,"LineageOpenPaneOrChangeFilter",Xg,df,Uf,Re,null,0)}function Lf(df){df=wc.a.og(df.data);mb.ULS.sendTraceTag(537155481,0,50,
"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",Ud.a.Uc(df))}Le.HKb.stop();Yc.b(Le.$).fe(Yd.a.fPi,{});Le.cDj();var hf=Object.assign(new kb,{ClientViewCapacity:le.clientViewCapacity}),pg=null;zf&&(pg=Object.assign(new wb,{FilterSheetMultiRange:Le.nNj(zf.filterSheetMultiRange)}));te.EwaSettings.tc()?Le.$.userOperationManager.ic(new Vb.a(1010,0,bf,80),null):Le.$.userOperationManager.ic(new wf.a(1010,0,bf,16),null)};this.lineageLoadMoreRequest=function(le){function zf(Lf,
hf,pg){var df=Le.$.na.ta;Lf=Wc.b(Lf,Le.wfd("LineageLoadMore"));hf=Wc.a(hf,bf);var Uf=df.Na(1,null);Uf.fetchFromBelow=le;return pc.i(df,"LineageLoadMore",Uf,Lf,hf,pg,null,0)}function bf(Lf){Lf=wc.a.og(Lf.data);mb.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Ud.a.Uc(Lf))}Yc.b(Le.$).fe(Yd.a.ePi,{});te.EwaSettings.tc()?Le.$.userOperationManager.ic(new Vb.a(1011,0,zf,80),null):Le.$.userOperationManager.ic(new wf.a(1011,0,zf,16),null)};this.lineageRefreshViewRequest=
function(){function le(bf,Lf,hf){var pg=Le.$.na.ta;bf=Wc.b(bf,Le.wfd("LineageRefreshView"));Lf=Wc.a(Lf,zf);var df=pg.Na(1,null);return pc.i(pg,"LineageRefreshView",df,bf,Lf,hf,null,0)}function zf(bf){bf=wc.a.og(bf.data);mb.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Ud.a.Uc(bf))}Yc.b(Le.$).fe(Yd.a.gPi,{});te.EwaSettings.tc()?Le.$.userOperationManager.ic(new Vb.a(1012,0,le,80),null):Le.$.userOperationManager.ic(new wf.a(1012,0,le,16),null)};
this.lineageUpdateViewRequest=function(){Ec(Le.$.na.ta,function(le){if(le=oc.a(le)?null:le.Result){var zf={};zf=(zf.CountOfUpdatedActivities=le.LineageActivitiesResponse.ActivityList.length,zf);Yc.b(Le.$).fe(Yd.a.hPi,zf);le=Object.assign(new Ga,{activityList:Le.mFd(le.LineageActivitiesResponse.ActivityList),latestActivityId:le.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:le.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:le.LineageActivitiesResponse.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(le.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:le.HasNewActivities,filterSheetMultiRange:Le.dNj(le.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:le.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:le.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:le.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:le.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(le.LineageActivitiesResponse.EolDateHideHistory),
eolPersonHideHistory:Le.vvb(le.LineageActivitiesResponse.EolPersonHideHistory)});Le.tF.onLineageActivitiesUpdateResponse(le)}else mb.ULS.shipAssertTag(537155475,0,!!le,"LineageManager.LineageUpdateView returned null response.")},function(le){le=wc.a.og(le.data);mb.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Ud.a.Uc(le))},null,null)};this.onCardSelected=function(le,zf){if(le=le.rangeHighlightLocation){if(zf){var bf=Cd.Z(zf,null);var Lf=bf.range;
if(bf.returnValue){Le.A9e(le.sheetName,Le.Cvb([Cd.j(Lf)]));return}mb.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+zf+" is not valid.")}le.rangeList.length?Le.A9e(le.sheetName,le.rangeList):Le.j8h(le.sheetName)}};this.onLearnMoreLinkClicked=function(){if(te.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var le=new Kd.a(-859308420,Ac.a.dc,Le.$.hd,12,null),zf={};zf=(zf[Ac.a.Tg]="HelpID=XLO_LineageTS",zf.InputMethod=Ac.a.dc,zf[Ac.a.nd]=$d.a.JZ,
zf.ShouldCanvasTakeFocus=!0,zf);Le.$.Ka.Yb(le,zf)}};this.onVersionHistoryButtonClicked=function(le){Le.$.Ka.Yb(new Kd.a(-1112508866,le,Le.$.hd,12,null))};this.isFeatureEnabled=function(){return!1};this.Mf=function(){var le=Le.$.ea.Cm.LineageVersion;le!==Le.ntd&&(mb.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",le,Le.ntd),Le.ntd=le,Le.I8i())};this.dd=function(le,zf){Le.tF&&!Le.lineageTaskPane.zgc&&zf.EH&&(mb.ULS.sendTraceTag(587220563,
0,15,"LineageManager::SessionIdChanged detected."),Le.onStaleActivitiesDetected())};this.Gq=function(){Le.tF&&!Le.lineageTaskPane.zgc&&(mb.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),Le.onStaleActivitiesDetected())};this.XC=function(){var le=Le.i4a();Le.tF.onFilterableSheetListChange(le)};this.Gya=function(){var le=Le.i4a();Le.tF.onFilterableSheetListChange(le)};this.foc=function(){var le=Le.i4a();Le.tF.onFilterableSheetListChange(le)};this.onPaneClosed=function(){Le.tF.onPaneClosed();
Ob(Le.$.na.ta,null,function(le){le=wc.a.og(le.data);mb.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",Ud.a.Uc(le))},null,null)};this.onRangeFilterInputEnabled=function(le){le?Le.gridView.ha.E2(Le.od):Le.gridView.ha.lda(Le.od)};this.od=function(){var le=Cd.q(Le.gridView.ha.va.activeRange,Le.$);le=Object.assign(new pb,{rangeList:Le.Cvb(le.Ranges),sheetName:le.SheetName});Le.tF.onSelectedRangeUpdated(le)};this.tryParseRangeInfo=function(le){var zf=
Cd.Z(le,Le.$.xa);var bf=zf.sheetName;le=zf.range;return zf.returnValue?(bf||(bf=Le.$.xa.pa.sheetName),zf=[],zf.push(le),le=Cd.u(bf,null,zf),Object.assign(new pb,{rangeList:Le.Cvb(le.Ranges),sheetName:le.SheetName})):null};this.yz=function(){var le=Le.WD!==Le.$.ea.uf;Le.tF&&Le.lineageTaskPane.isVisible&&le&&(Le.WD=Le.$.ea.uf,Le.tF.onRefreshRequired())};this.$=Zb;Nc.Ha(366,this);this.gridView=Sc.g(this.$);this.lineageTaskPane=cd;this.itd=this.lineageTaskPane.HM();this.batchSize=50;this.t7=Xd;this.HKb=
this.$.Wb.Vh("UserAction","LineagePaneLoadingShimmerStopWatch");this.wqc=Se.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Kbi();this.gBg()}function Ja(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function Ta(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=
null;this.degradedCardTypeBits=0}function pb(){this.sheetName=this.rangeList=null}function Db(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function fb(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function xa(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function ya(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=
this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function Ga(){var Zb=db.call(this)||this;Zb.hasNewActivities=!1;Zb.filterSheetMultiRange=null;return Zb}function db(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;
this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Ob(Zb,Nc,cd,Xd,Le,le){le=Zb.Na(1,void 0===le?null:le);return pc.i(Zb,"LineageClosePane",le,Nc,cd,Xd,Le,0)}function Ec(Zb,Nc,cd,Xd,Le,le){le=Zb.Na(1,void 0===le?null:le);return pc.i(Zb,"LineageUpdateView",le,Nc,cd,Xd,Le,0)}function wb(){}function kb(){}function vb(Zb){var Nc=Sd.call(this)||this;Nc.$=Zb;Nc.fc();return Nc}function Gb(Zb){this.mdb=!0;Gb.Pcf()?Gb.Xcf()?(mb.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: {0}",
!Zb),this.mdb=Zb):this.mdb=!1:this.mdb=!0}function Za(Zb){return Ed.call(this,Zb)||this}function ub(Zb,Nc){this.$=Zb;this.lineageManager=Nc;Zb=[new qf.a(Sa.a.ktd,1038647878,0,0,2175),new qf.a(Sa.a.idle,1038647878,0,1)];qc.a(this.$).AHd(new Fc.a(Sa.a.jtd,Sa.a.idle,Zb),new fc(Sa.a.ktd,Sa.a.idle,Nc))}function fc(Zb,Nc,cd){Zb=ee.call(this,Zb,Nc)||this;Zb.lineageManager=cd;return Zb}function $a(Zb){var Nc=Qf.call(this)||this;Nc.$=Zb;Nc.fc();return Nc}function nb(Zb){return td.call(this,Zb)||this}function sc(Zb){var Nc=
this;this.baseVersionInfo=this.y3=this.Joa=this.mm=this.ewaAccessibilityManager=this.YMb=null;this.WHd=this.Esf=!1;this.VFe=!0;this.dialog=this.EB=this.JUe=this.pD=this.DZd=this.BZd=this.CZd=null;this.zCf=function(cd){mb.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(Nc.Vzj()){var Xd=function(le){Ab.c(2138207060,!1);Nc.mm.setRestoreFailedAtServer(le)};Nc.pD&&Nc.pD.startTimer(sc.$9f);var Le=function(){Nc.pD.endTimer(sc.$9f);Nc.jxe(Nc.pD)};
Nc.mm.setRestoreInProgress();oe.a(Nc.$).jt(new Ke.a(Sa.a.ez,5,function(){var le=qc.a(Nc.$).rd.activityState;le[Zd.a.Xq]=Sa.a.bAe;le[rb.a.qY]=!0;le[rb.a.DT]=0;le[ra.kgg]=cd;le[ra.Eqc]=cb.AFrameworkApplication.lj;le[ra.wud]=Le;le[O.R4f]=Xd}))}else Ab.c(2138207060,!1)};this.lFf=function(cd){Nc.YMb.then(function(Xd){Xd.enterFocusTrapZone();return null});mb.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");Nc.pD.endTimer(sc.qVd);Nc.pD.incrementCounter(sc.c4g);mb.ULS.sendTraceTag(537150348,
0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",Nc.pD.getTimerDuration(sc.qVd));Nc.ehj(cd.containerDiv);cd.versions&&0<cd.versions.length&&(Nc.JUe=sc.$E(cd.versions[cd.versions.length-1]));Nc.y3&&Nc.Joa&&Nc.cNd(Nc.y3);mb.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(cd){mb.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",
sc.$E(cd.currentVersion),sc.$E(Nc.y3));Nc.pD.incrementCounter(sc.b4g);Nc.y3=cd.currentVersion;Nc.baseVersionInfo=cd.baseVersion;Nc.Esf=cd.noBaseToCompareTo;Nc.Joa&&Nc.yWj()&&(Nc.cNd(cd.currentVersion),mb.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.dxf=function(cd){mb.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===cd||void 0===cd?0:cd.versionSelected)?
sc.$E(cd.versionSelected.currentVersion):null,(null===cd||void 0===cd?0:cd.updatedVersions)?cd.updatedVersions.length:0,sc.$E(Nc.y3));Nc.pD.incrementCounter(sc.a4g);if(Nc.baseVersionInfo){if((null===cd||void 0===cd?0:cd.updatedVersions)&&2<=cd.updatedVersions.length){var Xd=null,Le=null,le=sc.$E(Nc.y3),zf=sc.$E(Nc.baseVersionInfo);cd=yl(cd.updatedVersions);for(var bf=cd.next();!bf.done;bf=cd.next()){bf=bf.value;var Lf=sc.$E(bf);le===Lf?Xd=bf:zf===Lf&&(Le=bf);if(Xd&&Le)break}Xd&&Le?(Nc.y3=Xd,Nc.baseVersionInfo=
Le,mb.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",sc.$E(Nc.y3),sc.$E(Nc.baseVersionInfo)),Nc.cNd(Nc.y3)):mb.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",le,zf)}else mb.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
mb.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else mb.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.dwf=function(){mb.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");Nc.QZg();var cd=new Kd.a(1470556788,0,Nc.$.hd,0,null);Nc.$.Ka.Yb(cd)};this.QCf=function(cd){mb.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");
var Xd=new Kd.a(-1244760097,0,Nc.$.hd,0,null);Nc.$.jg.get(51)&&(mb.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Xd=new Kd.a(-309686558,0,Nc.$.hd,0,null));Ab.c(1604651619,!0);var Le={};Nc.$.Ka.Yb(Xd,(Le.FileDownloadUrl=cd,Le))};this.exf=function(cd){mb.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");cd=new Zc.QueryStringBuilder(cd);cd.Gi("fn",cb.AFrameworkApplication.fileName);mb.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+
cd.toString().length);8===Nc.$.frame.I8a(cd.toString(),!0)?(mb.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),Ab.c(1316171850,!1)):Ab.c(1316171850,!0)};this.Huf=function(cd){Nc.mm.setFullAppErrorCode(cd)};this.tyf=function(cd){switch(cd){case 101:cd="VHFailedToGetDownloadToken";break;case 100:cd="VHFailedToLoadVersionList";break;case 104:cd="VHVersioningNotEnabled";break;case 105:cd="VHFileNotFound";break;case 106:cd="VHVersionTooOld";break;default:cd="None"}Nc.pD.addEvent("OnFullAppError",
cd);mb.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",cd)};this.DBd=function(cd){Nc.VFe=cd;mb.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",cd.toString());var Xd={};Nc.zNd(cc.a.BMb,(Xd.ToggleValue=cd,Xd))};this.Lzf=function(cd){mb.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",cd);Ab.c(1488635506,!0);var Xd={};cd?Nc.zNd(cc.a.iterateNext,Xd):Nc.zNd(cc.a.kxa,Xd)};this.jGb=function(cd){switch(cd.MessageId){case Rb.a.$Ta:mb.ULS.sendTraceTag(537150289,
0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");te.EwaSettings.la(436)&&Nc.mm.setVersionLoadComplete();break;case Rb.a.aUa:mb.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case cc.a.setCurrentChangeCount:cd=cd.Values.count;mb.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",cd);Nc.mm.setCurrentChangeCount(cd);break;case cc.a.setTotalChangesCount:cd=
cd.Values.count;mb.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",cd);Nc.mm.setTotalChangesCount(cd);break;case cc.a.ROa:Nc.DBd(Nc.VFe);break;default:mb.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",cd.MessageId)}};this.$=Zb;this.w8b=this.$.Jb+sc.czh;this.VHd=!1;te.EwaSettings.la(397)&&this.fah();this.AAb="";this.Csd=0;this.perfTelemetryInfos=[]}function rd(){this.perfTelemetryInfos=
this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function $b(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=
this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function Wb(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function lc(){this.rootDiv=this.appBootSettings=null}function Oa(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function qb(Zb){this.yw=Zb}function Ub(Zb){this.yw=Zb}function jc(Zb){this.yw=Zb}function Kb(){}function dc(Zb,Nc){this.$=Zb;this.gXj=Nc}function Qb(Zb,Nc){var cd=
Ib.call(this)||this;cd.activityName=Zb;cd.JM=Nc;cd.fc();return cd}function O(Zb,Nc){return Jc.call(this,Zb,Nc)||this}function Ba(Zb,Nc,cd){var Xd=Mb.call(this)||this;Xd.activityName=Zb;Xd.JM=Nc;Xd.TJ=cd;Xd.fc();return Xd}function ra(Zb,Nc,cd,Xd,Le){var le=ib.call(this,Zb,Nc)||this;le.yi=null;le.retryCount=0;le.VRi=function(zf){var bf=le.vOj(zf);zf=bf.nLd;bf.returnValue?zf.Success?(Ab.c(2138207060,!0),mb.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):
(Ab.c(2138207060,!1),mb.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",zf.Output),le.vh(le.TJ)):(Ab.c(2138207060,!1),le.vh(le.TJ));(zf=le.yi.activityState[ra.wud])&&zf();le.hp();le.yi.HJ()};le.TRi=function(){if(0<le.retryCount)mb.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",le.retryCount),le.retryCount--,le.sUf();else{mb.ULS.sendTraceTag(42287320,
0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Ab.c(2138207060,!1);le.vh(le.TJ);var zf=le.yi.activityState[ra.wud];zf&&zf();le.hp();le.yi.HJ()}};le.TJ=cd;le.f3=Xd;le.baseUrl=Le;return le}b.r(F);var ta=b(10),Fa=b(0),cb=b(5),Wa=b(214),mb=b(13),kc=b(110),Ab=b(176),Tb=b(40),ib=kc.a;vm(ra,ib);ra.prototype.execute=function(Zb){this.yi=Zb;this.retryCount=3;this.sUf();return 1};ra.prototype.sUf=function(){var Zb=this.yi.activityState[ra.Eqc],Nc=this.yi.activityState[ra.kgg],
cd=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");Zb=Tb.c({VersionId:Nc,QuerySignature:Zb});this.f3.Wl(cd,2,Zb,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.VRi,this.TRi,null)};ra.prototype.vOj=function(Zb){var Nc=null;Zb=Zb?Zb.data?Zb.data.je:null:null;if(!Zb||!Zb.length)return mb.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,nLd:Nc};Zb=Tb.d(Zb);Nc=Zb.Iu;return Zb.returnValue?
{returnValue:!0,nLd:Nc}:(mb.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,nLd:Nc})};ra.kgg="RVAvi";ra.Eqc="RVAqs";ra.wud="RVlvrt";Object(Fa.a)(ra,"RestoreVersionActivity",kc.a,[]);var Sa=b(6),Mb=Wa.a;vm(Ba,Mb);Ba.prototype.create=function(){this.Gb(new ra(this.activityName,this.JM,this.TJ,cb.AFrameworkApplication.Kd,cb.AFrameworkApplication.sa.Qa.fW))};Ba.ka=function(Zb){Zb.da.Ha(320,new Ba(Sa.a.qLd,
Sa.a.qj,Sa.a.rLd))};Object(Fa.a)(Ba,"RestoreVersionActivityFactory",Wa.a,[]);var Jc=kc.a;vm(O,Jc);O.prototype.execute=function(Zb){var Nc=this;(0,Zb.activityState[O.R4f])(function(){Nc.hp();Zb.HJ()});return 1};O.R4f="RVEAssea";Object(Fa.a)(O,"RestoreVersionErrorActivity",kc.a,[]);var Ib=Wa.a;vm(Qb,Ib);Qb.prototype.create=function(){this.Gb(new O(this.activityName,this.JM))};Qb.ka=function(Zb){Zb.da.Ha(321,new Qb(Sa.a.rLd,Sa.a.qj))};Object(Fa.a)(Qb,"RestoreVersionErrorActivityFactory",Wa.a,[]);var Nb=
b(78),sa=b(817),Va=b(56),Xb=b(35),mc=b(175),od=b(372),ld=b(52);dc.prototype.Zc=function(){return cb.AFrameworkApplication.ga.ra("IsAnonymousUser")?(mb.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1};dc.prototype.executeCommand=function(Zb,Nc){mb.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");Zb=!1;switch(Nc.command){case -1112508866:od.a(this.$)&&this.$.da.Aa(423).xxc(!1),Zb=this.gXj.oDj()}mb.ULS.sendTraceTag(537150413,
0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",Zb);return Zb?ld.Task.Ta(Zb):mc.a(Nc.command)};dc.prototype.Kc=function(Zb,Nc){return-1112508866===Nc.command&&this.$.isVersionHistoryEnabled()};dc.prototype.gd=function(){return!1};Object(Fa.a)(dc,"VersionHistoryCommandHandler",null,[239]);var Zc=b(277),Rb=b(170),fd=b(387),wd=b(23);Kb.addAppPLTEventToLog=function(Zb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Zb)}catch(Nc){}};Kb.setIsPageLoadForFirstTime=
function(Zb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Zb)}catch(Nc){}};Object(Fa.a)(Kb,"VersionHistoryLogConnector",null,[]);var Ad=b(961),Ne=b(1247),Ve=b(148),Kd=b(92),Ud=b(27),te=b(1),oe=b(41),Ke=b(245),cc=b(1132),sd=b(255),zc=b(244),nd=b(11);jc.prototype.Qg=function(){sd.a(this.yw.$).aN(this.$d)||sd.a(this.yw.$).Qg(this)};jc.prototype.V7=function(){sd.a(this.yw.$).aN(this.$d)&&sd.a(this.yw.$).Cz(this)};jc.prototype.Yf=function(Zb){return nd.DOMElementExtensions.Pe(this.Kb,
Zb)};jc.prototype.fi=function(){this.yw.$.frame.Te.dk(this.yw.$.frame.Te.xE)};jc.prototype.Ph=function(){};jc.prototype.Oe=function(Zb,Nc){Nc||this.yw.YMb.then(function(cd){cd.enterHeaderFocusTrapZone();return null});return!Nc};Qk.Object.defineProperties(jc.prototype,{$d:{configurable:!0,enumerable:!0,get:function(){return zc.a.hgg}},Kb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});
Object(Fa.a)(jc,"VersionHistoryHeader",null,[117]);Ub.prototype.Qg=function(){sd.a(this.yw.$).aN(this.$d)||sd.a(this.yw.$).Qg(this)};Ub.prototype.V7=function(){sd.a(this.yw.$).aN(this.$d)&&sd.a(this.yw.$).Cz(this)};Ub.prototype.Yf=function(Zb){return nd.DOMElementExtensions.Pe(this.Kb,Zb)};Ub.prototype.fi=function(){this.yw.$.frame.Te.dk(this.yw.$.frame.Te.xE)};Ub.prototype.Ph=function(){};Ub.prototype.Oe=function(Zb,Nc){Nc||this.yw.YMb.then(function(cd){cd.enterFocusTrapZone();return null});return!Nc};
Qk.Object.defineProperties(Ub.prototype,{$d:{configurable:!0,enumerable:!0,get:function(){return zc.a.igg}},Kb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Fa.a)(Ub,"VersionHistoryPane",null,[117]);qb.prototype.Qg=function(){sd.a(this.yw.$).aN(this.$d)||sd.a(this.yw.$).Qg(this)};qb.prototype.V7=function(){sd.a(this.yw.$).aN(this.$d)&&sd.a(this.yw.$).Cz(this)};
qb.prototype.Yf=function(Zb){return nd.DOMElementExtensions.Pe(this.Kb,Zb)};qb.prototype.fi=function(){this.yw.$.frame.Te.dk(this.yw.$.frame.Te.xE)};qb.prototype.Ph=function(){};qb.prototype.Oe=function(Zb,Nc){Nc||this.yw.YMb.then(function(cd){cd.enterViewerFocusTrapZone();return null});return!Nc};Qk.Object.defineProperties(qb.prototype,{$d:{configurable:!0,enumerable:!0,get:function(){return zc.a.jgg}},Kb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Fa.a)(qb,"VersionHistoryViewer",null,[117]);var rb=b(136),Zd=b(247),qc=b(65),pd=b(417),ne=b(889);Object(Fa.a)(Oa,"AppBootSettings",null,[]);Object(Fa.a)(lc,"AppVersionControllerFactoryParameters",null,[]);Object(Fa.a)(Wb,"OnVersionSelectedParams",null,[]);Object(Fa.a)($b,"AppSettings",null,[]);Object(Fa.a)(rd,"ControllerFactoryParameters",null,[]);sc.prototype.dispose=function(){this.Sye()};sc.prototype.R_i=function(){var Zb=
this;this.$.da.Za(15,function(Nc){Zb.ewaAccessibilityManager=Nc;Zb.ewaAccessibilityManager.mode=2})};sc.prototype.fah=function(){this.CZd=new Ub(this);this.BZd=new jc(this);this.DZd=new qb(this)};sc.prototype.oDj=function(){var Zb=this;mb.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");cb.AFrameworkApplication.AK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");cb.AFrameworkApplication.AK("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");
cb.AFrameworkApplication.AK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.pD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.pD.startTimer(sc.Z9f);if(!this.mm&&(pd.a(function(){Zb.mm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new rd,{ulsLogger:new fd.a,docId:cb.AFrameworkApplication.lj,appSettings:Object.assign(new $b,{appName:120,userSessionId:cb.AFrameworkApplication.userSessionId,
wdEnableSaveACopy:te.EwaSettings.la(365),wdEnableDownloadTokens:te.EwaSettings.la(360),wacCluster:cb.AFrameworkApplication.Kd.GS,uiLocale:cb.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:te.EwaSettings.la(331)&&Zb.$.isEditMode,wdEnableIterator:te.EwaSettings.la(328)&&te.EwaSettings.la(329),useXhr:wd.a.mN,wdEnableHiddenButtonsUntilVersionLoadComplete:te.EwaSettings.la(436),disableSaveACopy:Zb.q2f(),wdEnableShowVersionChanges:te.EwaSettings.la(328)&&te.EwaSettings.la(330),disabledChangeGates:Zb.$.ya.VHSDisabledChangeGates,
wdEnableSaveACopyOverFlowMenu:te.EwaSettings.la(566),isRtl:cb.AFrameworkApplication.isRtl}),perfTelemetryInfos:Zb.perfTelemetryInfos}))}),!this.mm))return mb.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Ab.c(429638140,!1),!1;this.pDj();this.pD.endTimer(sc.Z9f);this.pD.startTimer(sc.b$f);mb.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");Ab.c(429638140,
!0);return!0};sc.prototype.pDj=function(){this.al();if(!document.getElementById(this.w8b)){var Zb=document.createElement("div");Zb.id=this.w8b;Zb.style.width="100%";Zb.style.height="100%";Zb.style.zIndex="998";Zb.style.display="block";Zb.style.position="absolute";this.$.ar.insertBefore(Zb,this.$.ar.firstChild);this.YMb=this.mm.createVersionHistoryDialog(Zb)}document.getElementById(this.w8b).style.display="block";this.NHd();this.pD.startTimer(sc.qVd);this.mm.getVersions("")};sc.prototype.NHd=function(){te.EwaSettings.la(397)&&
(this.CZd.Qg(),this.BZd.Qg(),this.DZd.Qg(),this.R_i())};sc.prototype.sXd=function(){te.EwaSettings.la(397)&&(this.CZd.V7(),this.BZd.V7(),this.DZd.V7(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};sc.prototype.al=function(){this.mm.getVersionsReadyEvent().addListener(this.lFf);this.mm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.mm.getCloseSelectedEvent().addListener(this.dwf);this.mm.getFullAppErrorEvent().addListener(this.tyf);this.mm.getIteratorSelectedEvent().addListener(this.Lzf);
this.mm.getShowVersionChangesToggledEvent().addListener(this.DBd);te.EwaSettings.la(360)&&(this.mm.getDownloadTokenReadyEvent().addListener(this.dxf),this.VHd=!0);te.EwaSettings.la(365)&&(this.mm.getSaveACopySelectedEvent().addListener(this.QCf),this.mm.getDownloadVersionSelectedEvent().addListener(this.exf));te.EwaSettings.la(331)&&this.$.isEditMode&&(this.mm.getRestoreVersionSelectedEvent().addListener(this.zCf),this.WHd=!0);this.Joa&&this.Joa.getAppErrorEvent().addListener(this.Huf)};sc.prototype.tn=
function(){this.mm.getVersionsReadyEvent().removeListener(this.lFf);this.mm.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.mm.getCloseSelectedEvent().removeListener(this.dwf);this.mm.getFullAppErrorEvent().removeListener(this.tyf);this.mm.getIteratorSelectedEvent().removeListener(this.Lzf);this.mm.getShowVersionChangesToggledEvent().removeListener(this.DBd);te.EwaSettings.la(365)&&(this.mm.getSaveACopySelectedEvent().removeListener(this.QCf),this.mm.getDownloadVersionSelectedEvent().removeListener(this.exf));
this.VHd&&(this.mm.getDownloadTokenReadyEvent().removeListener(this.dxf),this.VHd=!1);this.WHd&&(this.mm.getRestoreVersionSelectedEvent().removeListener(this.zCf),this.WHd=!1);this.Joa&&this.Joa.getAppErrorEvent().removeListener(this.Huf)};sc.prototype.Vzj=function(){var Zb=!0;if(te.EwaSettings.la(633)&&!this.$.dR)return mb.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!te.EwaSettings.la(327)){this.Jui();
this.mm.setCoauthRestoreError();Zb=!1;var Nc=new Kd.a(-729359593,0,this.$.hd,0,null);this.$.Ka.Yb(Nc)}this.$.dR&&(mb.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),Zb&&(Zb=!1,this.nDj()));return Zb};sc.prototype.nDj=function(){var Zb=Ud.a.jd(1,0,1851,1850,0,-1603358883,"RestoreVersionUnsavedChangesError");Zb=this.dialog||new Ve.ErrorDialog(this.$,Zb);Zb.initialize();Zb.mf()};sc.prototype.yWj=function(){mb.ULS.sendTraceTag(537150343,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?sc.$E(this.baseVersionInfo):"");if(sc.$E(this.y3)===this.JUe)return mb.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(te.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.Esf)return mb.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),
!0;if(!this.baseVersionInfo)return mb.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var Zb=sc.dPh(this.baseVersionInfo);mb.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",Zb?Zb.length:0);return Zb?!0:(mb.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};sc.prototype.q2f=function(){return!this.$.Bka};sc.prototype.QZg=function(){document.getElementById(this.w8b).style.display=
"none";var Zb=new Kd.a(-1423792966,0,this.$.hd,0,null);this.$.Ka.Yb(Zb);this.Sye()};sc.prototype.Sye=function(){this.pD&&(this.pD.endTimer(sc.b$f),this.jxe(this.pD),this.pD=null);this.tn();this.sXd();this.perfTelemetryInfos&&(mb.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.EB&&(this.EB.voa(Rb.a.$Ta),this.EB.voa(Rb.a.aUa),this.EB.voa(cc.a.setCurrentChangeCount),this.EB.voa(cc.a.setTotalChangesCount),te.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.EB.voa(cc.a.ROa),this.EB.dispose(),this.EB=null)};sc.prototype.ehj=function(Zb){var Nc=this;try{this.Joa?Kb.setIsPageLoadForFirstTime(!1):(Kb.setIsPageLoadForFirstTime(!0),pd.a(function(){var cd=new Oa;cd.ulsLogger=new fd.a;cd.actionUrl=Nc.$.ya.VersionHistoryActionUrl;cd.hideEmbedFooter=!0;cd.useFetch=te.EwaSettings.la(428)&&!wd.a.Vu;Nc.Joa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object.assign(new lc,{appBootSettings:cd,rootDiv:Zb}))}))}catch(cd){mb.ULS.sendTraceTag(41239239,
0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",cd)}};sc.prototype.cNd=function(Zb){mb.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",sc.$E(Zb),this.AAb);if(Zb)if(sc.$E(Zb).length){var Nc=(new Date).getTime();if(sc.$E(Zb)===this.AAb&&1E3>Nc-this.Csd)mb.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{sc.$E(Zb)!==this.AAb&&(mb.ULS.sendTraceTag(537150294,
0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.mm.setTotalChangesCount(-1),this.mm.setCurrentChangeCount(-1));var cd=excelVersionHistory.FactoryGlobal.getTelemetryCollector();cd.addEvent("SelectVersion",sc.$E(Zb));try{this.iZj(cd);this.Csd=Nc;this.AAb=sc.$E(Zb);var Xd=new Wb;Xd.selectedVersionInfo=this.y3;Xd.baseVersionInfo=this.baseVersionInfo;Xd.telemetryCollector=cd;this.Joa.onVersionSelectedWithParams(Xd);this.mm&&te.EwaSettings.la(365)&&this.mm.setDisableSaveACopy(this.q2f());
var Le=document.getElementById(sc.bzh);Le&&!this.EB&&(mb.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.EB=new cc.a(Le.contentWindow,Nb.a.Oaa(this.$.ya.VersionHistoryActionUrl)||ne.a.T9),this.EB.Jl(Rb.a.$Ta,this.jGb),this.EB.Jl(Rb.a.aUa,this.jGb),this.EB.Xn(cc.a.setCurrentChangeCount),this.EB.Xn(cc.a.setTotalChangesCount),te.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.EB.Xn(cc.a.ROa),
this.EB.Jl(cc.a.setCurrentChangeCount,this.jGb),this.EB.Jl(cc.a.setTotalChangesCount,this.jGb),te.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.EB.Jl(cc.a.ROa,this.jGb))}catch(le){this.Csd=0,this.AAb="",cd.addEvent("Exception",le.toString()),mb.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",le)}finally{mb.ULS.sendTraceTag(537150292,0,50,cd?cd.getJsonForLogging():"")}}}else mb.ULS.sendTraceTag(537150296,
0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else mb.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};sc.prototype.iZj=function(Zb){for(var Nc=yl(this.perfTelemetryInfos),cd=Nc.next();!cd.done;cd=Nc.next()){var Xd=cd.value;cd=Xd.TelemetryEventKey?Xd.TelemetryEventKey:Xd.telemetryEventKey?Xd.telemetryEventKey:"";Xd=Xd.TelemetryEventData?Xd.TelemetryEventData:Xd.telemetryEventData?Xd.telemetryEventData:"";cd&&Xd&&Zb.addEvent(cd,
Xd)}Array.clear(this.perfTelemetryInfos)};sc.prototype.jxe=function(Zb){mb.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",Zb?Zb.getJsonForLogging():"")};sc.prototype.Jui=function(){for(var Zb=this.$.ea.jm,Nc={},cd=null,Xd=yl(Zb),Le=Xd.next();!Le.done;Le=Xd.next())Le=Le.value,Le.UserEmail&&(Nc[Le.UserEmail]=Le.UserEmail in Nc?Nc[Le.UserEmail]+1:1),Le.User.UserID===this.$.ea.clientId&&(cd=Le.UserEmail);mb.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",
Zb.length,cd?Nc[cd]:-1)};sc.prototype.zNd=function(Zb,Nc){mb.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",Zb);if(this.EB){Zb=new Ad.a(Zb);Zb.Values[Ne.a.V4c]=this.$.ya.UserSessionId;if(Nc)for(var cd in Nc)Zb.Values[cd]=Nc[cd];this.EB.send(Zb)}else mb.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};sc.$E=function(Zb){return Zb?Zb.RevisionID?Zb.RevisionID:Zb.revisionID?
Zb.revisionID:"":""};sc.dPh=function(Zb){return Zb?Zb.DownloadUrl?Zb.DownloadUrl:Zb.downloadUrl?Zb.downloadUrl:"":""};sc.czh="_excelVersionHistoryOverlay";sc.bzh="vhs_frame";sc.Z9f="TimeTakenShowVersionHistoryDialogAction";sc.b$f="TimeTillVersionHistoryDialogWasOpenMs";sc.qVd="TimeTakenGetVersionsToOnVersionsReady";sc.b4g="CountOnVersionSelectedCalledinOneVHSession";sc.c4g="CountOnVersionsReadyCalledinOneVHSession";sc.a4g="CountOnDownloadTokenReadyCalledinOneVHSession";sc.$9f="TimeTakenVersionRestore";
Object(Fa.a)(sc,"VersionHistoryPaneActor",null,[2]);var be=b(335),td=sa.a;vm(nb,td);nb.prototype.Pd=function(){var Zb=this,Nc=this.Uti(),cd=Va.GetServiceTaskFactory.Wa(this.$.da,21,137,this.ub);Xb.TaskExtensions.Ba(Xb.TaskExtensions.we([Nc,cd],this.ma,3),function(){var Xd=cd.result,Le=Nb.a.Oaa(Zb.$.ya.VersionHistoryActionUrl);Le!==ne.a.T9&&Xd.qFa(Le);Xd=new sc(Zb.$);Zb.Gd([new dc(Zb.$,Xd)])},this.ma,3)};nb.prototype.Uti=function(){var Zb=Va.GetServiceTaskFactory.vbc(this.$.da,283,284,this.ub).then(function(Nc){return Nc.Sn.loadScript("excelVersionHistory")},
function(Nc){mb.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",Nc);return Promise.reject(Nc)});return be.c(Zb)};nb.ka=function(Zb){sa.a.he(304,new nb(Zb))};Object(Fa.a)(nb,"VersionHistoryCommandHandlerFactory",sa.a,[]);var Qe=b(1250),Qf=Wa.a;vm($a,Qf);$a.prototype.create=function(){var Zb=this,Nc=Va.GetServiceTaskFactory.Wa(this.$.da,211,212,this.ub),cd=Va.GetServiceTaskFactory.Wa(this.$.da,21,137,this.ub);Xb.TaskExtensions.Ba(Xb.TaskExtensions.we([Nc,
cd],this.$.ma),function(){Zb.Gb(Zb.$.da.Aa(305)||new Qe.a(Zb.$,!0,cd.result,Nc.result))},this.$.ma,3)};$a.ka=function(Zb){Zb.da.Ha(306,new $a(Zb))};Object(Fa.a)($a,"VersionHistoryHighlightManagerFactory",Wa.a,[]);var pf=b(516),$d=b(4),je=b(153),md=b(14),ee=kc.a;vm(fc,ee);fc.prototype.execute=function(Zb){this.lineageManager.lineageHidePreviousHistory();return ee.prototype.execute.call(this,Zb)};Object(Fa.a)(fc,"LineageClearHistoryConfirmedActivity",kc.a,[]);var qf=b(15),Fc=b(133);ub.prototype.Zc=
function(){return!1};ub.prototype.executeCommand=function(Zb,Nc,cd){Zb=!1;switch(Nc.command){case 1834994092:9===Nc.df&&this.IIj();this.IAj(Nc,cd);Zb=!0;break;case -409942531:this.KAj(),Zb=!0}return Zb?ld.Task.Ta(!0):mc.a(Nc.command)};ub.prototype.Kc=function(Zb,Nc){return 1834994092===Nc.command||-409942531===Nc.command};ub.prototype.gd=function(){return!1};ub.prototype.IAj=function(Zb,Nc){mb.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",Nc.MenuItemId||
Zb.df);this.lineageManager.m4f(19===Zb.df&&!!Nc.MenuItemId,Nc.MenuItemId,Zb.df)};ub.prototype.IIj=function(){var Zb=$d.a.Tqc;Zb!==je.a(this.$).Hm.Co&&je.a(this.$).Hm.activateRibbonTab(Zb)};ub.prototype.KAj=function(){var Zb=this;oe.a(this.$).jt(new Ke.a(Sa.a.jtd,5,function(){var Nc=qc.a(Zb.$).rd,cd=Ud.a.jd(3,1,2172,2173,2174,1038647878,"LineageConfirmClearHistory");cd.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";cd.HelpDescription=md.a.instance.fa(1276);Nc.zt([cd])}))};Object(Fa.a)(ub,"LineageActivityCommandHandler",
null,[239]);var Ed=sa.a;vm(Za,Ed);Za.prototype.Pd=function(){var Zb=this;Xb.TaskExtensions.Ba(Va.GetServiceTaskFactory.Wa(this.$.da,366,367,this.ub),function(Nc){Zb.Gd([new ub(Zb.$,Nc.result)])},this.ma,3)};Za.ka=function(Zb){sa.a.he(363,new Za(Zb))};Object(Fa.a)(Za,"LineageActivityCommandHandlerFactory",sa.a,[]);Gb.prototype.q6a=function(){return!this.mdb};Gb.Xcf=function(){return Gb.Pcf()&&te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};Gb.Pcf=function(){return te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(Fa.a)(Gb,"LineageCatchUpExperimentManager",null,[835]);var Sd=Wa.a;vm(vb,Sd);vb.prototype.create=function(){var Zb=this;Gb.Xcf()?Xb.TaskExtensions.Ba(Va.GetServiceTaskFactory.Wa(this.$.da,456,457,this.ub),function(Nc){Xb.TaskExtensions.Ba(Nc.result.lzj(),function(cd){Zb.SDe(cd.result)},Zb.$.ma,3)},this.$.ma,3):this.SDe(!0)};vb.prototype.SDe=function(Zb){this.Gb(this.$.da.Aa(458)||
this.$.da.Ha(458,new Gb(Zb)))};vb.ka=function(Zb){Zb.da.Ha(459,new vb(Zb))};Object(Fa.a)(vb,"LineageCatchUpExperimentManagerFactory",Wa.a,[]);var qd=b(412),ke=b(39),Se=b(87),of=b(151),vc=b(116);Object(Fa.a)(kb,"LineageClientParams",null,[]);Object(Fa.a)(wb,"LineageFilter",null,[]);var id=b(61),Ac=b(77),Yd=b(126),Cd=b(43),wf=b(521),Vb=b(164),wc=b(114),yb=b(106),oc=b(303),Wc=b(272),Qd=b(105),Sc=b(19),Yc=b(127),pc=b(81),Be=b(48),Ce=b(337);Object(Fa.a)(db,"LineageActivitiesResponseDTO",null,[]);vm(Ga,
db);Object(Fa.a)(Ga,"LineageActivitiesUpdateResponseDTO",db,[]);Object(Fa.a)(ya,"LineageAppCallbacks",null,[]);Object(Fa.a)(xa,"LineageAuthorDTO",null,[]);Object(Fa.a)(fb,"LineageControllerFactoryParams",null,[]);Object(Fa.a)(Db,"LineageSharedRangeDTO",null,[]);Object(Fa.a)(pb,"LineageSheetMultiRangeDTO",null,[]);Object(Fa.a)(Ta,"LineageUserActivityDTO",null,[]);Object(Fa.a)(Ja,"LineageValueChangeDTO",null,[]);ma.prototype.dispose=function(){this.Caj();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.hO(this.onPaneClosed),
this.lineageTaskPane.lD(this.yz),this.lineageTaskPane=null);this.HKb=this.wqc=this.mtb=this.itd=this.tF=null};ma.prototype.m4f=function(Zb,Nc,cd){if(this.lineageTaskPane.isVisible){if(9===cd){mb.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!Zb&&16!==cd&&18!==cd){this.lineageTaskPane.b1c();return}}ke.a.Ld(this.$)||(this.HKb.start(),this.t7&&(Be.b().WB(this.HKb.id,this.t7.id,"actions","actions"),this.t7.stop(),this.t7=
null));this.lineageTaskPane.zgc||mb.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",Zb?Nc:cd);this.WD=this.$.ea.uf;this.mtb=null;Zb&&(Zb=Cd.r(this.gridView.ha.va.selectedRanges,this.$),this.mtb=Object.assign(new pb,{rangeList:Nc.toString()===$d.a.G3f?this.Cvb(Zb.Ranges):null,sheetName:Zb.SheetName}));ke.a.Ld(this.$)&&this.lineageTaskPane.zgc?this.lineageTaskPane.Bsj(this.yDb):this.tF.createLineagePane(this.itd,this.mtb);this.lineageTaskPane.Nf(!0);
this.$.ye(-71295319,-1,0,null)};ma.prototype.lineageHidePreviousHistory=function(){function Zb(Xd,Le,le){var zf=Nc.$.na.ta,bf=zf.Na(1,null);return pc.i(zf,"LineageHidePreviousHistory",bf,Xd,Le,le,null,0)}var Nc=this,cd={};cd=(cd.paneVisible=this.lineageTaskPane.isVisible,cd);of.a.sendTelemetryEvent(Object.assign(new Ce.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:vc.a.Qk(cd)}));te.EwaSettings.tc()?this.$.userOperationManager.ic(new Vb.a(1018,0,Zb,64),null):this.$.userOperationManager.ic(new wf.a(1018,
0,Zb,0),null);this.lineageTaskPane.isVisible||this.m4f(!1,null,4)};ma.prototype.Kbi=function(){var Zb=this,Nc=Object.assign(new ya,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});pd.a(function(){Zb.tF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object.assign(new fb,{clientBatchSize:Zb.batchSize,filterableSheetList:Zb.i4a(),uiCulture:Zb.$.ya.UICultureTag,dataCulture:Zb.$.ya.DataCultureTag,logger:new fd.a,lineageAppCallbacks:Nc}))})};ma.prototype.wfd=function(Zb){var Nc=this;return function(cd){if(cd=oc.a(cd)?null:cd.Result){var Xd=
{};Xd=(Xd.CountOfActivities=cd.ActivityList.length,Xd);Xd.WebRequestName=Zb;Yc.b(Nc.$).fe(Yd.a.HMi,Xd);cd=Object.assign(new db,{activityList:Nc.mFd(cd.ActivityList),latestActivityId:cd.LastSearchedActivityId,oldestActivityId:cd.FirstSearchedActivityId,serverMessageCode:cd.LineageResponseCode,lastSearchedActivityTimestamp:new Date(cd.EcmaLastSearchedDate),serverFirstActivityId:cd.ServerFirstActivityId,serverLastActivityId:cd.ServerLastActivityId,showLoadPrevious:cd.ShowLoadPrevious,eolCorrelationId:cd.EolCorrelationId,
eolDateHideHistory:new Date(cd.EolDateHideHistory),eolPersonHideHistory:Nc.vvb(cd.EolPersonHideHistory)});Nc.tF.onLineageActivitiesResponse(cd)}else mb.ULS.shipAssertTag(537155477,0,!!cd,"LineageManager."+Zb+" returned null response.")}};ma.prototype.dNj=function(Zb){return yb.e(Zb.Ranges)&&!Zb.SheetName?null:Object.assign(new pb,{rangeList:this.Cvb(Zb.Ranges),sheetName:Zb.SheetName})};ma.prototype.Cvb=function(Zb){var Nc=[];Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next())cd=cd.value,cd=Object.assign(new Db,
{firstCol:cd.FirstColumn,firstRow:cd.FirstRow,lastRow:cd.LastRow,lastCol:cd.LastColumn}),Nc.push(cd);return Nc};ma.prototype.nNj=function(Zb){if(!Zb)return null;var Nc={};Nc.Ranges=this.vgd(Zb.rangeList);Nc.SheetName=Zb.sheetName;return Nc};ma.prototype.vgd=function(Zb){var Nc=[];if(yb.e(Zb))return Nc;Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next()){cd=cd.value;var Xd={};Xd.FirstColumn=cd.firstCol;Xd.FirstRow=cd.firstRow;Xd.LastRow=cd.lastRow;Xd.LastColumn=cd.lastCol;Nc.push(Xd)}return Nc};ma.prototype.j8h=
function(Zb){(Zb=this.$.xa.getItemByName(Zb))&&Zb.visible&&Zb.activate(!0)};ma.prototype.A9e=function(Zb,Nc){var cd=[];Nc=yl(Nc);for(var Xd=Nc.next();!Xd.done;Xd=Nc.next()){Xd=Xd.value;var Le={};Le.FirstColumn=Xd.firstCol;Le.FirstRow=Xd.firstRow;Le.LastRow=Xd.lastRow;Le.LastColumn=Xd.lastCol;cd.push(Cd.D(Le))}Nc=cd.length-1;Xd=cd[Nc].topLeft;Sc.g(this.$).sV(cd,Nc,Zb,null,Xd,null,null,3,Qd.a.Ysi,void 0,void 0,void 0,!0)};ma.prototype.I8i=function(){this.tF&&this.lineageTaskPane.isVisible&&(this.WD=
this.$.ea.uf,this.tF.onRefreshRequired())};ma.prototype.gBg=function(){this.lineageTaskPane.qM(this.onPaneClosed);this.lineageTaskPane.XB(this.yz);this.$.ea.Bt(this.Mf);this.$.ea.Tj(this.dd);this.$.ea.MP(this.Gq);var Zb=this.$.xa;Zb.sY(this.XC);Zb.Vga(this.foc);Zb.zFa(this.Gya);Zb.BYa(this.foc)};ma.prototype.Caj=function(){this.$.ea.Dw(this.Mf);this.gridView.ha.lda(this.od);this.$.ea.kk(this.dd);this.$.ea.LW(this.Gq);var Zb=this.$.xa;Zb.X6(this.XC);Zb.Oma(this.foc);Zb.nQa(this.Gya);Zb.fHb(this.foc)};
ma.prototype.onStaleActivitiesDetected=function(){this.tF.onStaleActivitiesDetected()};ma.prototype.i4a=function(){for(var Zb=[],Nc=yl(this.$.xa.items),cd=Nc.next();!cd.done;cd=Nc.next())cd=cd.value,cd.visible&&!id.e(cd)&&Zb.push(cd.sheetName);return Zb};ma.prototype.cDj=function(){if(te.EwaSettings.la(639)){var Zb=this.$.da.Aa(403);Zb&&Zb.disable();Zb=new Kd.a(-847286761,Ac.a.dc,this.$.hd,0,$d.a.d0);var Nc={};Nc=(Nc.InputMethod=Ac.a.dc,Nc);Nc.CalloutName=5;this.$.Ka.Yb(Zb,Nc)}};ma.prototype.mFd=
function(Zb){var Nc=[];Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next())cd=cd.value,cd=Object.assign(new Ta,{activityId:Number.parseLocale(cd.UserActivity.Id),activityGuid:cd.Uid,activityType:cd.UserActivity.Type,author:this.vvb(cd.UserActivity.Person),sheetName:cd.SheetName,displayTimestamp:new Date(cd.UserActivity.DisplayTimestamp),gridLocation:cd.DisplayLocation,valueChanges:this.Z2i(cd.LineageValueChangeList),isBulkEditOverflow:cd.IsBulkEditOverFlow,rangeHighlightLocation:this.N2i(cd.UserActivity.LocationList,
cd.UserActivity.Type),nestedActivityList:this.G2i(cd.NestedActivityList),degradedCardTypeBits:cd.DegradedCardTypeBits}),Nc.push(cd);return Nc};ma.prototype.N2i=function(Zb,Nc){if(!Zb)return mb.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!Zb.length)return mb.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var cd=[],Xd=[],Le="";21===Nc?Xd.push(Zb[0]):Xd=Zb;Zb=yl(Xd);for(Xd=
Zb.next();!Xd.done;Xd=Zb.next())switch(Xd=Xd.value,Xd.Type){case 1:break;case 2:Le=Xd.SheetName;break;case 0:if(!Xd.RangeList){mb.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Le=Xd.RangeList[0].SheetName;var le=[];21===Nc?le.push(Xd.RangeList[0]):le=Xd.RangeList;Xd=yl(le);for(le=Xd.next();!le.done;le=Xd.next())le=le.value,le=Object.assign(new Db,{firstCol:le.FirstColumn,firstRow:le.FirstRow,lastRow:le.LastRow,lastCol:le.LastColumn}),
cd.push(le);break;default:mb.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Xd.Type)}return Object.assign(new pb,{sheetName:Le,rangeList:cd})};ma.prototype.Z2i=function(Zb){var Nc=[];Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next())cd=cd.value,cd=Object.assign(new Ja,{hasNewValue:cd.HasNewValue,hasOldValue:cd.HasOldValue,newValue:cd.HasNewValue?cd.NewValue:null,oldValue:cd.HasOldValue?cd.OldValue:null,cellLocation:cd.CellLocation}),
Nc.push(cd);return Nc};ma.prototype.G2i=function(Zb){return Zb?this.mFd(Zb):null};ma.prototype.vvb=function(Zb){if(!Zb)return null;var Nc=null;te.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&cb.AFrameworkApplication.ga.ra("IsUserProfilePictureResolutionEnabled")&&(Nc=this.wqc.EHa(Zb.Email,Zb.Provider,cb.AFrameworkApplication.lj,0));return Object.assign(new xa,{id:Zb.Id,provider:Zb.Provider,displayName:Zb.DisplayName,email:Zb.Email,imageUrl:Nc})};
Object(Fa.a)(ma,"LineageManager",null,[836,2]);var Xe=Wa.a;vm(hc,Xe);hc.prototype.Eti=function(Zb){var Nc=this;Xb.TaskExtensions.Ba(Zb,function(){Nc.Gb(Nc.$.da.Aa(366)||new ma(Nc.$,Nc.$.da,Nc.lineageTaskPane,Nc.t7))},this.$.ma,3)};hc.prototype.create=function(){var Zb=this;this.t7=this.$.Wb.Ic("UserAction","LineagePaneSeenStopwatch");this.t7.start();var Nc=Va.GetServiceTaskFactory.Wa(this.$.da,365,364,this.ub),cd=qd.a(this.$),Xd=Va.GetServiceTaskFactory.Wa(this.$.da,283,284,this.ub);Xb.TaskExtensions.Ba(Xb.TaskExtensions.we([Nc,
cd,Xd],this.$.ma),function(){Zb.lineageTaskPane=Nc.result;ke.a.Ld(Zb.$)||cd.result.bR(Zb.lineageTaskPane);Zb.Eti(be.c(Xd.result.Sn.loadScript("cellLineage")))},this.$.ma,3)};hc.ka=function(Zb){Zb.da.Ha(367,new hc(Zb))};Object(Fa.a)(hc,"LineageManagerFactory",Wa.a,[]);var ob=b(923),Ic=b(275),Cc=b(12),Uc=b(117),Tc=b(274),ce=b(91),ye=b(230),Kf=b(16),yf=b(826),Pf=b(63),ec=$d.a.ozc+"LineageActivityPaneTitle",Qc=$d.a.Odb+"LineageActivityCloseButton",Dd=ye.a;vm(lb,Dd);lb.prototype.KG=function(Zb){this.get_events().addHandler("LineageTaskPaneRemove",
Zb)};lb.prototype.nI=function(Zb){this.get_events().removeHandler("LineageTaskPaneRemove",Zb)};lb.prototype.XB=function(Zb){this.addHandler("LineageTaskPaneVisibilityChanged",Zb)};lb.prototype.lD=function(Zb){this.removeHandler("LineageTaskPaneVisibilityChanged",Zb)};lb.prototype.qM=function(Zb){this.get_events().addHandler("LineageTaskPaneClose",Zb)};lb.prototype.hO=function(Zb){this.get_events().removeHandler("LineageTaskPaneClose",Zb)};lb.prototype.kw=function(){};lb.prototype.pC=function(){};
lb.prototype.hn=function(){return this.vp};lb.prototype.Vp=function(){return this.vp};lb.prototype.GF=function(){};lb.prototype.wH=function(){return!1};lb.prototype.fi=function(){};lb.prototype.Ph=function(){};lb.prototype.dispose=function(){this.$&&(this.$.rn(this.qd),sd.a(this.$).Cz(this));this.pe&&(Ic.a.instance.za(Cc.a.click,this.pe,this.$j),Uc.KeyInputManager.instance.vv(this.pe,this.Sze));this.pe=this.taskPaneManager=this.$=null;Dd.prototype.dispose.call(this)};lb.prototype.Oe=function(Zb,Nc){if(!Nc){Zb=
nd.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!Zb)return!1;nd.DOMElementExtensions.setFocus(Zb)}return!Nc};lb.prototype.Yf=function(Zb){return nd.DOMElementExtensions.Pe(this.Kb,Zb)};lb.prototype.Nf=function(Zb){this.vp=Zb;var Nc=this.taskPaneManager;if(this.isVisible=Zb)this.$.frame.Te.Qj("LineagePane"),this.ypd=!1;if(ke.a.Ld(this.$))Zb?Nc.WR("LineageTaskPane",this.EI):Nc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.qp();var cd=!!this.taskPaneManager.Bg&&
15===this.taskPaneManager.Bg.taskPane.wg;Zb&&0<Nc.Kz.length&&(!cd||Nc.isCollapsed)&&Nc.mD(this,!0)}this.$.If()};lb.prototype.HM=function(){var Zb=this.$.Jb;Zb=ke.a.Ld(this.$)?this.domElement:document.getElementById(Zb+$d.a.mtd);var Nc=this.WG();Zb.appendChild(Nc);Nc=yf.b("div","LineagePaneBodyId","LineageActivityBody");Zb.appendChild(Nc);this.Csj();return Nc};lb.prototype.b1c=function(){this.$.frame.Te.Qj(this.$.frame.Te.xE||Tc.AFrame.ZT);this.ypd=!0;this.Nf(!1);this.raiseEvent("LineageTaskPaneClose")};
lb.prototype.Bsj=function(Zb){this.yDb=Zb};lb.prototype.Csj=function(){this.$.frame.Te.dk("LineagePane");var Zb=this.$.frame.Te.Ai("LineagePane");Zb.parent=Tc.AFrame.ZT;Zb.tR=!0};lb.prototype.WG=function(){var Zb=yf.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),Nc=yf.b("h1","LineagePaneTitleId",ec);Nc.innerText=this.titleText;this.pe=ob.a.Bb("LineagePaneCloseButtonId",Qc,md.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.pe.classList.add(cb.AFrameworkApplication.isRtl?$d.a.yaa:$d.a.zaa);
Ic.a.instance.qa(Cc.a.click,this.pe,this.$j);this.Sze=Uc.KeyInputManager.instance.ns(this.pe,this.$j,ce.a.Zh);Zb.appendChild(Nc);Zb.appendChild(this.pe);return Zb};lb.ka=function(Zb,Nc){var cd=Zb.Jb,Xd=document.getElementById(cd+$d.a.mtd);Xd||(Xd=document.createElement("div"),Xd.id=Zb.Jb+$d.a.mtd,Xd.classList.add("LineageActivityPane"),ke.a.Ld(Zb)||document.getElementById(cd+$d.a.JR).appendChild(Xd));return Zb.da.Aa(365)||Zb.da.Ha(365,new lb(Xd,Zb,Nc))};Qk.Object.defineProperties(lb.prototype,{isVisible:{configurable:!0,
enumerable:!0,get:function(){return Object(Pf.a)(lb.prototype,this,"isVisible")},set:function(Zb){Object(Pf.a)(lb.prototype,this,"isVisible")!==Zb&&(Object(Pf.b)(lb.prototype,this,"isVisible",Zb),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},zgc:{configurable:!0,enumerable:!0,get:function(){return this.ypd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},wg:{configurable:!0,enumerable:!0,get:function(){return 15}},$d:{configurable:!0,enumerable:!0,get:function(){return zc.a.Zsi}},
Mj:{configurable:!0,enumerable:!0,get:function(){return Kf.a.pwh}},IC:{configurable:!0,enumerable:!0,get:function(){return md.a.instance.fa(1030)}},Gl:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.BL.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return md.a.instance.fa(1251)}},
EI:{configurable:!0,enumerable:!0,get:function(){var Zb=this;return this.taskPaneManager.Rua(this.Kb,this.titleText,this.Gl,this.isResizable,function(){Zb.isVisible=!0;Zb.yDb?Zb.yDb():mb.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){Zb.isVisible=!1},function(){Zb.isVisible=!0},function(){Zb.isVisible=!1},this.Gl)}}});Object(Fa.a)(lb,"LineageTaskPane",ye.a,[834,2,249,117]);var Jd=Wa.a;vm(Ia,Jd);Ia.prototype.create=function(){var Zb=this,Nc=Va.GetServiceTaskFactory.create(this.$.da,
203,this.ma,this.ub),cd=Va.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub);Xb.TaskExtensions.Ba(Xb.TaskExtensions.ts(Xb.TaskExtensions.we([Nc,cd],this.ma),function(){return Zb.aD},this.ma),function(){Zb.Gb(Zb.eh)},this.ma,3)};Ia.prototype.dispose=function(){this.eh=this.wi=this.$=null;Jd.prototype.dispose.call(this)};Ia.ka=function(Zb){Zb.da.Ha(364,new Ia(Zb))};Qk.Object.defineProperties(Ia.prototype,{aD:{configurable:!0,enumerable:!0,get:function(){var Zb=this;this.wi||(this.wi=Xb.TaskExtensions.Ba(qd.a(this.$),
function(Nc){Zb.eh=lb.ka(Zb.$,Nc.result)},this.ma,3));return this.wi}}});Object(Fa.a)(Ia,"LineageTaskPaneFactory",Wa.a,[]);eb.prototype.dispose=function(){this.zId();this.$=null;mb.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};eb.prototype.disable=function(){eb.Awb||(eb.Awb=!0,mb.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.zId()};eb.prototype.$Wj=function(){var Zb=this;te.EwaSettings.la(635)&&
!this.$.isAnonymousUser()&&pc.l(this.$.na.ta,function(Nc){Zb.$?(Nc=Nc.Result,mb.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",Nc),eb.N7e=!0,Nc&&Zb.kag(0)):mb.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){mb.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};eb.prototype.UWj=function(){te.EwaSettings.la(634)&&
!this.vag()&&(this.$.ea.Bt(this.Mf),this.Xpd=!0)};eb.prototype.vag=function(){return this.$.ea&&this.$.ea.Cm&&this.$.ea.Cm.ShouldTriggerLineageCalloutOnMerge?(mb.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.kag(1),!0):!1};eb.prototype.kag=function(Zb){if(eb.Awb)mb.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(eb.Awb=!0,mb.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",Zb),this.zId(),te.EwaSettings.la(501)){Zb=new Kd.a(-847286761,Ac.a.dc,this.$.hd,0,$d.a.d0);var Nc={};Nc=(Nc.CalloutName=4,Nc);this.$.Ka.Yb(Zb,Nc)}};eb.prototype.zId=function(){this.Xpd&&(this.Xpd=!1,this.$.ea.Dw(this.Mf))};eb.Awb=!1;eb.N7e=!1;Object(Fa.a)(eb,"LineageTeachingCalloutTriggerManager",null,[751,2]);var ze=Wa.a;vm(Na,ze);Na.prototype.create=function(){var Zb=this;Xb.TaskExtensions.Ba(Va.GetServiceTaskFactory.Wa(this.$.da,
458,459,this.ub),function(Nc){Nc=new eb(Zb.$,Nc.result);Zb.Gb(Nc)},this.$.ma,3)};Na.ka=function(Zb){Zb.da.Ha(402,new Na(Zb))};Object(Fa.a)(Na,"LineageTeachingCalloutTriggerManagerFactory",Wa.a,[]);var ie=b(1020),jf=b(71);Ya.prototype.bX=function(Zb,Nc,cd,Xd){var Le=this;return this.shh(Zb,void 0===Xd?null:Xd,function(le){return Le.Sg.wYb(le,2,cd,Nc,void 0,void 0,void 0,void 0,void 0,"2")})};Ya.prototype.shh=function(Zb,Nc,cd){var Xd=this,Le=!!Nc&&""!==Nc,le=Zb;Le&&(le=Nb.a.NT(Zb,"perfTag",Nc));var zf=
new Date;return ie.a.then(cd(le),function(bf){var Lf=+new Date-+zf;if(!bf||!bf.Zg||!bf.Zg.data)return bf;Le&&bf.Zg.data.request&&Xd.Eoj(bf.Zg.data.request.getResolvedUrl(),Nc,Lf);return bf})};Ya.prototype.Eoj=function(Zb,Nc,cd){Zb=this.wu.NXh(Zb);if(Zb.count&&(Zb=jf.last(Zb))){var Xd={Message:"Request durations for activities calls."};Xd.PerfTag=Nc;Xd.CustomDuration=cd;Xd.PerformanceDuration=Zb.duration;mb.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Xd))}};Object(Fa.a)(Ya,"CatchUpNetworkingWrapper",
null,[168]);var mf=b(242),vf=mf.a;vm(Ha,vf);Ha.prototype.rja=function(){return 6};Object(Fa.a)(Ha,"GetActivityFeedRequest",mf.a,[]);var rg=b(388);Pa.prototype.getActivityFeed=function(Zb){return this.DJh(Zb)};Pa.prototype.DJh=function(Zb){var Nc=this;return ie.a.then(this.ZUa.execute(new Ha(this.JUa(),null),function(cd,Xd,Le){return Nc.Vsg.bX(cd,Xd,Le,"ActivityFeed")},Zb),function(cd){if(!cd)return mb.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!cd.Zg)return mb.ULS.sendTraceTag(572846938,
3012,10,"GetActivityFeed: Response.Args is null"),null;if(!cd.Zg.data)return mb.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!cd.Zg.data.je)return mb.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;cd=rg.a.dIa(cd.Zg.data.je);return cd?cd:(mb.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})};Object(Fa.a)(Pa,"CatchUpRequestHandler",null,[169]);var he=b(476);pa.prototype.Hui=
function(){this.rvi()};pa.prototype.rvi=function(){var Zb=this;this.yXa?this.yXa.execute(function(Nc){window.setTimeout(function(){Zb.Eae.contains("CatchUpChangesFeedback")||(Zb.Eae.add("CatchUpChangesFeedback"),Nc.logActivity("CatchUpChangesFeedback",null))},2E4)}):mb.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(Fa.a)(pa,"FloodgateEventLogger",null,[]);var eg=b(185);Qk.Object.defineProperties(qa.prototype,{duration:{configurable:!0,
enumerable:!0,get:function(){return this.Qtg.duration}}});Object(Fa.a)(qa,"PerformanceResourceTimingWrapper",null,[]);ea.prototype.NXh=function(Zb){var Nc=new eg.a;if(!this.wu)return Nc;Zb=this.wu.getEntriesByName(Zb,"resource");if(!Zb)return Nc;Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next())Nc.add(new qa(cd.value));return Nc};Object(Fa.a)(ea,"PerformanceWrapper",null,[]);var tg=b(273);ia.prototype.ii=function(Zb){var Nc=this;this.tb=Zb;this.tb.register(Ya,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").Cc().Mc(function(){return new Ya(cb.AFrameworkApplication.Kd,
new ea(window.performance))});this.tb.register(Pa,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").Cc().Mc(function(){return new Pa(Nc.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return cb.AFrameworkApplication.lj},new rg.a)});this.tb.register(pa,"Common.App.CatchUpActivity.FloodgateEventLogger").Cc().Mc(function(){return new pa(Nc.tb.pc("Common.ISystemInitiatedFeedback"))})};ia.prototype.init=function(){this.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.tb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ia.prototype.dispose=function(){};ia.main=function(){tg.a.instance.rj(new ia)};Qk.Object.defineProperties(ia.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(Fa.a)(ia,"CatchUpActivityPackage",null,[4,5]);ca.prototype.Zc=function(Zb,Nc){return this.catchUpActivityManager?-876699925===Nc?!this.catchUpActivityManager.Ocf:!1:!0};ca.prototype.executeCommand=function(Zb,Nc){Zb=
!1;switch(Nc.command){case -876699925:Zb=this.catchUpActivityManager.FUi()}return Zb?ld.Task.Ta(!0):mc.a(Nc.command)};ca.prototype.Kc=function(Zb,Nc){return te.EwaSettings.la(452)&&-876699925===Nc.command?!0:!1};ca.prototype.gd=function(){return!1};Object(Fa.a)(ca,"CatchUpActivityCommandHandler",null,[239]);var Wd=sa.a;vm(W,Wd);W.prototype.Pd=function(){var Zb=this;this.$.da.Za(286,function(Nc){Zb.Gd([new ca(Zb.$,Nc)])})};W.ka=function(Zb){sa.a.he(285,new W(Zb))};Object(Fa.a)(W,"CatchUpActivityCommandHandlerFactory",
sa.a,[]);var Mf=b(309),Rd=b(525),Ze=b(88),Xf=b(84),bg=b(30);fa.prototype.doesContentExist=function(Zb){if(!Zb)return mb.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(Zb.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Zb.navigationId)return mb.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var Nc={};Nc.NavigationId=atob(Zb.navigationId);return 32===this.Fi.De(bg.a.vIa,2,
Nc);default:return!1}};Object(Fa.a)(fa,"CatchUpActivityContentManager",null,[744]);var mg=b(962),xf=b(1245);da.prototype.dispose=function(){this.Su.vQf(this.uDb);this.gN=null};da.prototype.bsj=function(Zb){this.gN.push(Zb)};da.prototype.QYg=function(){Array.clear(this.gN)};da.prototype.y4f=function(Zb){for(var Nc=yl(this.gN),cd=Nc.next();!cd.done;cd=Nc.next())cd=cd.value,cd.className=mg.a.HVg,cd=document.getElementById(String.format("{0}-{1}",cd.id,$d.a.oxe)),nd.DOMElementExtensions.setVisible(cd,
Zb)};da.prototype.RKb=function(Zb){for(var Nc=yl(this.gN),cd=Nc.next();!cd.done;cd=Nc.next())if(cd=cd.value)Zb?cd.className=2===this.Su.model.state?mg.a.H5i:mg.a.I5i:this.y4f(!1)};Qk.Object.defineProperties(da.prototype,{Su:{configurable:!0,enumerable:!0,get:function(){return this.gqg}}});Object(Fa.a)(da,"RangeCatchUpActivityView",null,[784,2]);var ig=b(20),wh=xf.a;vm(K,wh);K.prototype.dispose=function(){this.gridView=null;wh.prototype.dispose.call(this)};K.prototype.DDg=function(Zb){var Nc=this.rfb[0];
Nc?Nc.bsj(Zb):mb.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Fma.activityId)};K.prototype.Shj=function(){var Zb=this.rfb[0];Zb&&Zb.QYg()};K.prototype.RBg=function(Zb){this.Fma.addRange(Zb)};K.prototype.XMh=function(){if(3!==this.Fma.activityType)return null;mb.ULS.shipAssertTag(537168003,0,1===this.Fma.pLb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");
return Cd.D(this.Fma.pLb[0])};K.prototype.KIb=function(Zb){if(Zb){if(!this.Fma)return;this.gxd(this.Yij())}wh.prototype.KIb.call(this,Zb)};K.prototype.F4c=function(){var Zb=this.k4c();Array.add(this.rfb,Zb)};K.prototype.k4c=function(){return new da(this)};K.prototype.gxd=function(Zb){Zb?Zb.SheetName?(this.gridView.ha.Pa.$G(null),this.gridView.focus(),this.gridView.H5e(Zb,3,!1,Qd.a.G5i)):mb.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):
mb.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};K.prototype.Yij=function(){if(yb.e(this.Fma.pLb))return mb.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var Zb=this.$.xa.pa;mb.ULS.shipAssertTag(537167970,0,!!Zb,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");
Zb=this.gOj(Zb.sheetName,this.Fma.pLb);if(!Zb&&(Zb=this.o1h(this.Fma.pLb),!Zb))return null;var Nc={};Nc.SheetName=Zb.SheetName;Nc.FirstColumn=Zb.FirstColumn;Nc.FirstRow=Zb.FirstRow;Nc.LastColumn=Zb.FirstColumn;Nc.LastRow=Zb.FirstRow;return Nc};K.prototype.o1h=function(Zb){if(yb.e(Zb))return null;for(var Nc=null,cd=0;cd<Zb.length;cd++){var Xd=Zb[cd].SheetName;if(!ig.a.equals(Xd,Nc,!1)&&(Nc=Xd,Xd=this.$.xa.getItemByName(Xd),null===Xd||void 0===Xd?0:Xd.visible))return Zb[cd]}return null};K.prototype.gOj=
function(Zb,Nc){if(Nc){Nc=yl(Nc);for(var cd=Nc.next();!cd.done;cd=Nc.next())if(cd=cd.value,ig.a.equals(cd.SheetName,Zb,!1))return cd}return null};Object(Fa.a)(K,"RangeCatchUpActivityHighlightController",xf.a,[]);var La=b(74),Eb=La.a;vm(T,Eb);T.prototype.dispose=function(){this.k1d=null;Eb.prototype.dispose.call(this)};Qk.Object.defineProperties(T.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.UB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.k1d}},
activityType:{configurable:!0,enumerable:!0,get:function(){return this.Ckg}}});Object(Fa.a)(T,"CatchUpActivityHighlightModelBase",La.a,[]);vm(H,T);H.prototype.addRange=function(Zb){Zb=yl(Zb);for(var Nc=Zb.next();!Nc.done;Nc=Zb.next())this.ranges.push(Nc.value)};H.prototype.dispose=function(){this.ranges=null;T.prototype.dispose.call(this)};H.G2b=function(Zb,Nc){if(!Zb.SheetName||!Nc.SheetName)return mb.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),
0;var cd=Zb.SheetName.localeCompare(Nc.SheetName);return cd?cd:Zb.FirstColumn<Nc.FirstColumn||Zb.FirstColumn===Nc.FirstColumn&&Zb.FirstRow<Nc.FirstRow?-1:Zb.FirstColumn===Nc.FirstColumn&&Zb.FirstRow===Nc.FirstRow?0:1};Qk.Object.defineProperties(H.prototype,{pLb:{configurable:!0,enumerable:!0,get:function(){this.a7a||(this.ranges.sort(H.G2b),this.a7a=!0);return this.ranges}}});Object(Fa.a)(H,"RangeCatchUpActivityHighlightModel",T,[]);var uc=b(336);S.prototype.dispose=function(){this.Vke=this.eKb=this.Z1c=
null};S.prototype.Pej=function(Zb){Sc.g(Zb).Ob.xs([24])};S.prototype.L5g=function(Zb,Nc,cd){var Xd={};Nc=yl(Nc);for(var Le=Nc.next();!Le.done;Le=Nc.next())if((Le=Le.value)&&!yb.e(Le.LocationList)){for(var le=[],zf={},bf=[],Lf=yl(Le.LocationList),hf=Lf.next();!hf.done;hf=Lf.next()){hf=hf.value;if(!hf){mb.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+Le.Id);break}switch(hf.Type){case 0:var pg=hf;"0"in zf?
(hf=zf["0"],hf.RBg(pg.RangeList)):(hf=new K(Zb,new H(Zb,Le.Id,Le.Type,0,pg.RangeList),cd),le.push(hf),zf["0"]=hf);pg=yl(pg.RangeList);for(var df=pg.next();!df.done;df=pg.next()){df=df.value;df=new uc.a(Cd.D(df),id.d(Zb.xa.getItemByName(df.SheetName)));if(this.ywc(df)in this.eKb)this.eKb[this.ywc(df)].push(hf);else{var Uf=[];Uf.push(hf);this.eKb[this.ywc(df)]=Uf}bf.push(df);this.Z1c.push(df)}break;default:mb.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}mb.ULS.shipAssertTag(537168011,
0,!(Le.Id in Xd),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Le.Id);this.Vke[Le.Id]=bf;Xd[Le.Id]=le}this.f7g(Zb,this.Z1c,this.eKb);return Xd};S.prototype.JYg=function(Zb){for(var Nc in Zb)for(var cd=yl(Zb[Nc]),Xd=cd.next();!Xd.done;Xd=cd.next())Xd.value.Shj()};S.prototype.ywc=function(Zb){return String.format("{0}-{1}",Zb.range,Zb.sheetId)};S.prototype.f7g=function(Zb,Nc,cd){var Xd=this;this.JYg(cd);Sc.g(Zb).Ob.qy(Nc,[24],!0,function(Le,
le){var zf=new uc.a(Le.range,Le.sheetId);zf=Xd.ywc(zf);var bf=cd[zf];if(bf)for(zf=yl(bf),bf=zf.next();!bf.done;bf=zf.next())bf=bf.value,bf.DDg(le),Le.metadata=bf;else mb.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+zf)})};Object(Fa.a)(S,"CatchUpHighlightControllersCreator",null,[]);Object(Fa.a)(ba,"CreateIndicatorTooltipParameters",null,[]);Object(Fa.a)(la,"DismissIndicatorTooltipParameters",null,
[]);Object(Fa.a)(Q,"UpdateIndicatorTooltipParameters",null,[]);U.prototype.dispose=function(){this.ha.psc(this.Zk);this.ha.UF(this.od);this.gridView.SF(this.kp);this.Ya.nl(this.ej);this.HHe();this.rbd=this.eka=this.Fdc=this.cRa=this.Ya=this.ha=this.gridView=null};U.prototype.Npj=function(){var Zb=[];this.HHe();if(!yb.e(Zb)){mb.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.T4=this.p3b.L5g(this.$,Zb,this)){Zb=this.T4;for(var Nc in Zb)for(var cd=
yl(Zb[Nc]),Xd=cd.next();!Xd.done;Xd=cd.next())this.eMg(Xd.value)}this.p3b.Pej(this.$)}};U.prototype.wxc=function(Zb){if(Zb&&this.bkd)mb.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(Zb||this.Jrb(),this.T4){var Nc=this.T4,cd;for(cd in Nc)for(var Xd=yl(Nc[cd]),Le=Xd.next();!Le.done;Le=Xd.next())Le.value.kCj(Zb)}};U.prototype.i8h=function(Zb){this.eka&&this.e6b(!0);this.o6c();if(Zb=this.T4[Zb.activityId]){Zb=
yl(Zb);for(var Nc=Zb.next();!Nc.done;Nc=Zb.next())Nc.value.KIb(!0)}else mb.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};U.prototype.HHe=function(){if(this.T4){var Zb=this.T4,Nc;for(Nc in Zb)for(var cd=yl(Zb[Nc]),Xd=cd.next();!Xd.done;Xd=cd.next())Xd=Xd.value,this.Daj(Xd),Xd.dispose()}this.T4={};this.p3b.dispose();this.p3b=null};U.prototype.LAj=function(){if(this.excelCommentManager){var Zb=this.T4[this.cRa];Zb&&0<Zb.length&&
3===Zb[0].model.activityType&&((Zb=Zb[0])?this.excelCommentManager.nBj(Zb.XMh()):mb.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};U.prototype.A7h=function(){this.excelCommentManager&&this.excelCommentManager.Gsb()};U.prototype.o6c=function(){if(this.cRa){var Zb=this.T4[this.cRa];if(Zb){Zb=yl(Zb);for(var Nc=Zb.next();!Nc.done;Nc=Zb.next())Nc.value.KIb(!1);this.cRa=null}else mb.ULS.sendTraceTag(537168028,
0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};U.prototype.Jrb=function(){this.o6c();this.e6b(!0)};U.prototype.tOj=function(Zb){if(!Zb)return mb.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Zb=String.format("{0}-{1}",Zb.id,$d.a.FVg);var Nc=this.rbd[Zb];if(!Nc){if(!this.gridView.domElement)return mb.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),
null;Nc=document.createElement("Div");Nc.className=mg.a.GVg;Nc.id=Zb;this.gridView.domElement.appendChild(Nc);this.rbd[Zb]=Nc}return Nc};U.prototype.e6b=function(Zb){this.Yea&&(this.Yea.dismissActivityIndicatorTooltips(Object.assign(new la,{clearSticky:Zb})),this.Fdc=null,Zb&&(this.eka=null),this.egc&&!this.eka&&(this.gridView.view.Mq(this.RAc),this.gridView.ot(this.RAc),this.egc=!1))};U.prototype.eMg=function(Zb){Zb.hne(this.uDb);Zb.iEg(this.w3f);Zb.hEg(this.BIe)};U.prototype.Daj=function(Zb){Zb.vQf(this.uDb);
Zb.Kbj(this.w3f);Zb.Jbj(this.BIe)};Qk.Object.defineProperties(U.prototype,{aAg:{configurable:!0,enumerable:!0,get:function(){return this.Yea},set:function(Zb){this.Yea=Zb}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.cDa||(this.cDa=this.$.da.Aa(65));return this.cDa}},p3b:{configurable:!0,enumerable:!0,get:function(){this.q3b||(this.q3b=new S);return this.q3b},set:function(Zb){this.q3b=Zb}}});Object(Fa.a)(U,"CatchUpActivityHighlightManager",null,[765,2]);V.prototype.navigateToActivity=
function(Zb){if(Zb.fromSummaryString){var Nc=new Kd.a(1834994092,Ac.a.dc,this.$.hd,18,null);this.$.Ka.Yb(Nc);return this.gUa(1)}Zb=Zb.activity;if(!this.tfi(Zb))return this.gUa(4);if(!this.hoi(Zb))return this.gUa(7);var cd={};try{Nc=window.self.atob(Zb.navigationId);if(!Nc)return this.gUa(5);cd.NavigationId=Nc}catch(Xd){return mb.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Xd),this.gUa(5)}if(8===this.Fi.De(bg.a.vIa,2,cd))return this.Fi.processAction(bg.a.U8a,
2),this.gUa(2);Nc=32===this.Fi.De(bg.a.a0a,2,cd)?1:6;return this.gUa(Nc)};V.prototype.tfi=function(Zb){return Zb&&Zb.navigationId?!0:!1};V.prototype.hoi=function(Zb){switch(Zb.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};V.prototype.gUa=function(Zb){return Promise.resolve(Zb)};Object(Fa.a)(V,"CatchUpActivityNavigationManager",null,[745]);var Vc=b(444);Object(Fa.a)(D,"GetRelevantActivitiesDataRequest",null,[]);Object(Fa.a)(r,"Activity",null,[]);Object(Fa.a)(B,"ActivityFeedItem",
null,[]);Object(Fa.a)(u,"ActivityFeedPayload",null,[]);Object(Fa.a)(x,"ActivityRequestPayload",null,[]);Object(Fa.a)(A,"Person",null,[]);vm(t,r);Object(Fa.a)(t,"TaskActivity",r,[]);w.prototype.requestWYWAActivities=function(){var Zb=this;return this.q6a?new Promise(function(Nc,cd){z(Zb.$.na.ta,function(Xd){Xd=oc.a(Xd)?null:Xd.Result;Xd=Object.assign(new x,{activities:[],actors:Xd?Zb.hgd(Xd.WywaAuthors):null,hasMore:!1,highWaterline:w.a1a,lowWaterline:w.a1a,wywaWaterline:w.a1a});Nc(Xd)},function(){mb.ULS.sendTraceTag(537168022,
0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");cd(null)},null,null)}):Promise.resolve(w.v5b)};w.prototype.requestActivities=function(){return Promise.resolve(w.v5b)};w.prototype.requestRelevantActivities=function(){var Zb=this;if(!this.$.ea.rc||this.$.ea.O4a)return mb.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.ea.rc,this.$.ea.O4a),
Promise.resolve(w.v5b);var Nc=Object.assign(new D,{SetDaysBack:cb.AFrameworkApplication.ga.Bd("AppWaterlineOverrideDaysValue",0),SetTimestamp:cb.AFrameworkApplication.ga.Bd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(cd,Xd){I(Zb.$.na.ta,Nc,function(Le){var le=w.v5b;Le?oc.a(Le)?mb.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Ud.a.Uc(Le.Errors)):le=Zb.vXh(Le.Result):mb.ULS.sendTraceTag(537168020,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");cd(le)},function(Le){Le=wc.a.og(Le.data);mb.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",Ud.a.Uc(Le));Xd(null)},null,null)})};w.prototype.requestActivityFeed=function(){var Zb=this;return be.b(this.getActivityFeed()).then(function(Nc){return Object.assign(new u,{activityFeedItems:Zb.bNj(Nc)})})};w.prototype.getActivityFeed=
function(){return this.rxe?ie.a.lVd(this.rxe,function(Zb){return Zb.getActivityFeed(null)}):ld.Task.Ta([])};w.prototype.vXh=function(Zb){if(!Zb)return mb.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object.assign(new x,{activities:[]});var Nc=this.fag(Zb.NewActivities,2);Zb=this.fag(Zb.OutstandingActivities,3);Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next())Nc.push(cd.value);return Object.assign(new x,{activities:Nc})};
w.prototype.fag=function(Zb,Nc){Nc=void 0===Nc?1:Nc;var cd=[];if(!Zb||!Zb.length)return cd;Zb=yl(Zb);for(var Xd=Zb.next();!Xd.done;Xd=Zb.next())if(Xd=Xd.value){var Le=w.iNj(Xd.Type);6===Le||7===Le||9===Le||8===Le?cd.push(Object.assign(new t,{activityId:Xd.Id,type:Le,displayTimestamp:new Date(Xd.DisplayTimestamp),navigationId:Xd.NavigationId,actors:this.hgd(Xd.People),relevancy:Nc,relationship:this.hNj(Xd.Relationship)})):cd.push(Object.assign(new r,{activityId:Xd.Id,type:Le,displayTimestamp:new Date(Xd.DisplayTimestamp),
navigationId:Xd.NavigationId,actors:this.hgd(Xd.People),relevancy:Nc}))}else mb.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return cd};w.prototype.hNj=function(Zb){switch(Zb){case 1:return 1;case 2:return 2;case 3:return 3}mb.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};w.prototype.bNj=function(Zb){var Nc=[];Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next())cd=cd.value,cd=Object.assign(new B,
{id:cd.id,type:cd.type,collectionId:cd.collectionId,activityState:cd.activityState,activityFeedItemPayload:cd.activityFeedItemPayload,timestamp:cd.timestamp}),Nc.push(cd);return Nc};w.prototype.hgd=function(Zb){var Nc=[];if(!Zb||!Zb.length)return Nc;Zb=yl(Zb);for(var cd=Zb.next();!cd.done;cd=Zb.next())(cd=cd.value)&&Nc.push(this.vvb(cd));return Nc};w.prototype.vvb=function(Zb){return Object.assign(new A,{id:Zb.Id,provider:Zb.Provider,displayName:Zb.DisplayName,email:Zb.Email,imageUrl:this.wqc.EHa(Zb.Email,
Zb.Provider,cb.AFrameworkApplication.lj,0),color:this.$Eb.Fhd(new Vc.a(null,void 0,Zb.DisplayName),6)})};w.iNj=function(Zb){switch(Zb){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return mb.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};w.a1a="<WywaWaterline>DefaultWaterline</WywaWaterline>";w.v5b=Object.assign(new x,{activities:[],
actors:[],hasMore:!1,highWaterline:w.a1a,lowWaterline:w.a1a,wywaWaterline:w.a1a});Object(Fa.a)(w,"CatchUpActivityRequestManager",null,[746]);v.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.R7a)return!1;if(!te.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var Zb=this.$.da.Aa(365);return!Zb||!Zb.isVisible}return!0};v.prototype.onButtonClick=function(){var Zb={};Zb=(Zb.InputMethod=Ac.a.dc,Zb);this.$.Ka.Yb(new Kd.a(1834994092,Ac.a.dc,this.$.hd,
16,null),Zb)};v.prototype.getExplanationText=function(){var Zb=this.$.da.Aa(365);return md.a.instance.Va(Zb&&Zb.isVisible?644:643)};v.prototype.getCommandName=function(){return md.a.instance.fa(436)};Object(Fa.a)(v,"CatchUpEmptyExperienceBehaviorManager",null,[747]);m.prototype.dispose=function(){sd.a(this.$).Cz(this)};m.prototype.Oe=function(Zb,Nc){if(Nc)return!1;Zb=document.getElementById("flyoutItem0");if(!Zb)return mb.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),
!1;Zb.focus();this.Zfh(Zb);return!0};m.prototype.Yf=function(Zb){return this.Kb?nd.DOMElementExtensions.Pe(this.Kb,Zb):!1};m.prototype.fi=function(){this.hasFocus=!0};m.prototype.Ph=function(){this.hasFocus=!1};m.prototype.Zfh=function(Zb){if(Sys.Browser.agent===Sys.Browser.Firefox){var Nc=document.createEvent("KeyboardEvent");Nc.initKeyEvent(Cc.a.Tb,!0,!0,window.self,!1,!1,!1,!1,ce.a.gCc,0);Zb.dispatchEvent(Nc)}else Nc=document.createEvent("Events"),Nc.initEvent(Cc.a.Tb,!0,!0),Nc.keyCode=ce.a.gCc,
Nc.which=ce.a.gCc,Zb.dispatchEvent(Nc)};Qk.Object.defineProperties(m.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.vef&&!this.hasFocus}},$d:{configurable:!0,enumerable:!0,get:function(){return zc.a.q_c}}});Object(Fa.a)(m,"FlyoutFocus",null,[117,2]);var xd=b(376);n.prototype.dispose=function(){this.Yib=this.Cyb=!1};n.prototype.registerButtonClickedEvent=
function(Zb){this.buttonClickedCallback&&mb.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=Zb.buttonClickedCallback};n.prototype.onFlyoutInitialized=function(){this.Cyb&&mb.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var Zb=(new Date).getTime()-this.MEh.getTime();mb.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",
Zb);Ab.c(bg.a.JVg,!0,Ab.e,0,0,Zb);this.Cyb=!0;xd.a.Hy&&xd.a.Hy.updateCommandUI(!0)};n.prototype.logFlightTriggers=function(){};n.prototype.toggleCatchUpFlyout=function(){this.Cyb?this.buttonClickedCallback?this.buttonClickedCallback():mb.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):mb.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};n.prototype.onFlyoutVisibilityChanged=
function(Zb){this.Yib!==Zb.flyoutIsVisible&&(this.Yib=Zb.flyoutIsVisible,xd.a.Hy&&xd.a.Hy.updateCommandUI(!0),this.Yib||this.TUe&&this.TUe.Hui())};Qk.Object.defineProperties(n.prototype,{vef:{configurable:!0,enumerable:!0,get:function(){return this.Yib}}});Object(Fa.a)(n,"FlyoutRibbonButton",null,[764]);var Od=b(529);Object(Fa.a)(l,"CatchUpConfiguration",null,[]);Object(Fa.a)(d,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.JGa&&this.JGa.getWywaEvent().removeListener(this.EFf);
this.JGa=this.$=null;Ze.a.Fa(this.t_a);this.flyoutRibbonButton=this.flyoutFocus=this.U2d=this.pxe=this.qxe=this.t_a=null};c.prototype.FUi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.lvi=function(){mb.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.qcf()&&mb.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")};c.prototype.pti=function(Zb,Nc){f("ScriptDownload");Xb.TaskExtensions.Ba(Va.GetServiceTaskFactory.Wa(this.$.da,
283,284,Nc),function(cd){Zb(be.c(cd.result.Sn.loadScript("catchUpActivity")))},this.$.da.ma,3)};c.prototype.q6a=function(){return!!this.plf&&this.plf.q6a()&&this.$.ea.R7a};c.prototype.qcf=function(){return te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)};c.prototype.jIi=function(Zb){var Nc=this;Xb.TaskExtensions.Ba(Zb,function(){pd.a(function(){Nc.JGa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object.assign(new d,{activityContentManager:Object(Xf.a)(744,
Nc.U2d),activityNavigationManager:Object(Xf.a)(745,Nc.pxe),activityRequestManager:Object(Xf.a)(746,Nc.qxe),dataCulture:Nc.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Xf.a)(n,Nc.flyoutRibbonButton),uiCulture:Nc.$.ya.UICultureTag,ulsLogger:new fd.a,emptyCatchUpBehaviorManager:Object(Xf.a)(747,Nc.emptyCatchUpBehaviorManager)}))});Nc.t_a.aAg=Nc.JGa.getActivityIndicatorTooltipManager();Od.a(Nc.$);Nc.JGa.getWywaEvent().addListener(Nc.EFf);f("InitializeCatchUpApp");Nc.JGa.initialize(Object.assign(new l,
{featuredActivityGroupsEnabled:!1,summaryStringEnabled:Nc.q6a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:te.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:Nc.qcf()}))},this.$.ma,3)};Qk.Object.defineProperties(c.prototype,{Ocf:{configurable:!0,enumerable:!0,get:function(){var Zb=this.flyoutRibbonButton.Cyb;Zb&&!this.L7e&&(mb.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.L7e=!0);
return Zb}},Agi:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.vef}}});Object(Fa.a)(c,"CatchUpActivityManager",null,[748,2]);var re=Wa.a;vm(a,re);a.prototype.create=function(){var Zb=this;Xb.TaskExtensions.Ba(Va.GetServiceTaskFactory.Wa(this.$.da,458,459,this.ub),function(Nc){Nc=Nc.result;Zb.Gb(Zb.$.da.Aa(286)||new c(Zb.$,Zb.ub,null,Nc))},this.$.ma,3)};a.ka=function(Zb){Zb.da.Ha(287,new a(Zb))};Object(Fa.a)(a,"CatchUpActivityManagerFactory",Wa.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");ta.a.Ga(nb.ka);ta.a.Ga($a.ka);ta.a.Ga(Qb.ka);ta.a.Ga(Ba.ka);pf.a.Zi('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){ta.a.Ga(function(Zb){Ia.ka(Zb);hc.ka(Zb);vb.ka(Zb);Na.ka(Zb);Za.ka(Zb)})})();Type.registerNamespace("Common.App.CatchUpActivity");ia.main();(function(){ta.a.Ga(function(Zb){f("Begin");a.ka(Zb);W.ka(Zb)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/8682e0149926d66c32af7dfd4f855d4e/EwaDS.catchup.js.map