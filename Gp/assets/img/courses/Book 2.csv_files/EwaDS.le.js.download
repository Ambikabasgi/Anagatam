(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1244:function(y,F,b){function a(Ha,Ya,Na,eb){var Ia=Pa.call(this)||this;Ia.isMac=m.a.isMac;Ia.fYa=-1;Ia.F4b=null;Ia.mta=-1;Ia.jte=!1;Ia.j_=!1;Ia.gSd=!1;Ia.yic=!1;Ia.sN=!1;Ia.$T=null;Ia.Xh=function(){Ia.uwa&&Ia.gridView&&Ia.fX()};Ia.qd=function(){Ia.Lx()};Ia.$c=function(){Ia.qHa();H.g(Ia.$).Oe(!0,!1)};Ia.tya=function(hc,ma){ma?(Ia.Rcg(Ia.F4b),Ia.kdb()):(hc=[29],Ia.gridView.Ob.kl(hc),Ia.gridView.Ob.Ml(null,hc),Ia.$T&&Ia.$T.b9e())};
Ia.dj=function(){Ia.w6a()&&Ia.Th.hide();1===Ia.gridView.ha.We&&Ia.fX()};Ia.LR=function(){var hc=Ia.gridView.ha.We;Ia.gridView.ha.va.activeCell&&1===hc&&Ia.fX()};Ia.onKeyUp=function(hc){return Ia.HAb?Ia.j_?!1:17===hc.Ea.keyCode&&Ia.gSd?(Ia.sN?(Ia.kdb(),Ia.uda()):Ia.EJb(),!0):!1:Ia.j_=!1};Ia.onKeyDown=function(hc){if(!Ia.HAb)return Ia.j_=!1;Ia.gSd=!1;Ia.j_=hc.ctrlKey;switch(hc.Ea.keyCode){case 27:return Ia.sN?(Ia.tya(null,!1),Ia.uda()):Ia.$T&&(Ia.$T.b9e(),Ia.EJb()),!0;case 13:if(Ia.sN)return Ia.sN=
!1,Ia.qHa(),!0;break;case 17:return Ia.gSd=!0}return!1};var lb=b(1324).AutoDetectActionButton;Ia.$=Ha;Ia.wob=la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);Ya||n.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");Ia.convertToLinkedEntityManager=eb;eb.G$a();Ia.Th=new lb(Ha,Ya,Ia.$c,Na,"");Ia.ZMg=new c(Ia.$,eb);Ia.gridView=H.g(Ia.$);Ia.gridView.ha.E2(Ia.Xh);Ia.gridView.zc.xYa(Ia.Xh);Ia.gridView.$q(Ia.LR);
Ha.ul(Ia.qd);Ha.mA(Ia.dj);Ia.gridBlockManager=Object(w.a)(542,Ia.gridView.Ca);Ia.pr=Ha.frame.qt;Ia.fX();return Ia}function c(Ha,Ya){var Na=K.call(this)||this;Na.$=Ha;Na.gridView=H.g(Ha);Na.convertToLinkedEntityManager=Ya;Na.z1c=new T.a;return Na}function d(Ha,Ya){var Na=Q.call(this)||this;Na.$c=function(eb){if(eb.Ub.id===Na.wIa.firstChild.id){eb=Na.ite;var Ia={};Ia.Id=eb.vob;Na.convertToLinkedEntityManager.M2c(Ia,!0,eb);Na.wIa.removeChild(Na.wIa.firstChild);return!0}return!1};Na.ite=Ha;Na.convertToLinkedEntityManager=
Ya;Na.wIa=document.createElement("div");Na.wIa.className="clip16x16";Na.lwa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.Lf("autodetectid"+Na.ite.left),V.a.V9c,U.a.Fe(11));Na.wIa.innerHTML=Na.lwa;Ha=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");D.a.instance.qa(v.a.click,Ha,Na.$c);return Na}function l(Ha,Ya){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=
this.cardViewManager=null;this.$=Ya;this.parentElement=Ha}y=b(0);var n=b(13),m=b(23),f=b(88),v=b(12),w=b(84),t=b(411),A=b(74),x=b(9),u=b(64),B=b(461);l.prototype.Z4g=function(){var Ha=this,Ya=this.$4g();B.a(this.$,243,242,0,function(Na){Ha.cardViewManager=Na;Na.Q3f(Ha.parentElement,2,Ya)})};l.prototype.b9e=function(){this.cardViewManager&&this.cardViewManager.$Ka(-1,-1,this.parentElement)};l.prototype.$4g=function(){var Ha={layoutId:"AutoDetectTooltip"};Ha.description=this.longDescription;Ha.convertToDomainName=
this.convertToDomainName;Ha.longDescription=this.longDescription;Ha.urlValue=this.urlValue;Ha.imageAltText=this.imageAltText;Ha.helpText=this.helpText;Ha.helpId=this.helpId;return Ha};Object(y.a)(l,"AutoDetectCardManager",null,[]);var r=b(28),I=b(203),z=b(29),D=b(275),V=b(16),U=b(53),Q=A.a;vm(d,Q);d.prototype.dispose=function(){if(this.wIa){var Ha=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");D.a.instance.za(v.a.click,Ha,this.$c)}Q.prototype.dispose.call(this)};Qk.Object.defineProperties(d.prototype,
{domElement:{configurable:!0,enumerable:!0,get:function(){return this.wIa}}});Qk.Object.defineProperties(d,{CSg:{configurable:!0,enumerable:!0,get:function(){return"clip16x16"}}});Object(y.a)(d,"AutoDetectColumnHeaderButton",A.a,[]);var la=b(1),ba=b(1186),S=b(8),H=b(19),T=b(123),K=A.a;vm(c,K);c.prototype.dispose=function(){K.prototype.dispose.call(this)};c.prototype.cgh=function(Ha){for(var Ya=yl(this.gridView.h3),Na=Ya.next();!Na.done;Na=Ya.next()){Na=yl(Na.value);for(var eb=Na.next();!eb.done;eb=
Na.next()){eb=eb.value;var Ia=eb.En,lb=ba.a(eb.P4);this.OAg(Ha,lb,Ia);eb.BOd(lb)}}};c.prototype.OAg=function(Ha,Ya,Na){if(Ya.length){var eb=Na.length;Na[eb-1]<Ha.left||(Na=S.HelperMethods.mx(new I.a(Na),0,eb,Ha.left,S.HelperMethods.UC),0>Na||!(Ya=Ya[Na]))||(this.gridView.rtl?Ya.classList.add(r.a.Gwh):Ya.classList.add(r.a.Fwh),this.z1c.xb(Ha.left)||this.z1c.add(Ha.left,new d(Ha,this.convertToLinkedEntityManager)),Ha=this.z1c.oa(Ha.left).domElement,!Ya.getElementsByClassName(d.CSg).length&&this.cFj(Ya)&&
Ya.appendChild(Ha))}};c.prototype.cFj=function(Ha){var Ya=parseInt(Ha.style.width,10),Na=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";Na=c.J6g(Na);Ha=gridRenderer.CanvasRendererGlobals.measureTextWidth(Ha.firstChild.innerHTML,Na,!0,la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<Ya-(Ya/2+Ha/2)?!0:!1};c.J6g=function(Ha){return String.format("{0} {1} {2} {3}/{4} {5}","normal","normal",Ha,"10pt","normal",'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif')};
Object(y.a)(c,"AutoDetectColumnHeaderManager",A.a,[]);var da=b(430),fa=b(24),W=b(61),ca=b(141),ia=b(11),ea=b(14),qa=b(176),pa=b(75);b.d(F,"a",function(){return a});var Pa=A.a;vm(a,Pa);a.prototype.dispose=function(){this.gridView&&this.gridView.ha.lda(this.Xh);if(this.$){var Ha=this.$;Ha.rn(this.qd);Ha.kD(this.dj);H.g(Ha).ot(this.LR)}f.a.Fa(this.Th);this.pr=this.$=this.gridView=this.Th=null;Pa.prototype.dispose.call(this)};a.prototype.Lx=function(){this.tya(null,!1);this.fYa=-1;this.Th.hide();this.OPj();
this.sN=!1};a.prototype.uda=function(){this.Th.getButton(a.Cea).sbb();this.sN=!1};a.prototype.EJb=function(){this.Th.getButton(a.Cea).hFb();this.Rcg(this.F4b);this.sN=!0;this.$.da.Za(211,function(Ha){Ha.QPa(ea.a.instance.fa(1701))})};a.prototype.onAutoDetectUIShown=function(){if(this.uwa&&-1!==this.fYa)this.convertToLinkedEntityManager.onAutoDetectUIShown()};a.prototype.$Mg=function(Ha){var Ya=new fa.Range(1===Ha.top?1:Ha.top-1,Ha.left,Ha.bottom,Ha.right,!0,!1);Ya=this.gridView.getRangeInformation(Ya);
Ya=yl(Ya);for(var Na=Ya.next();!Na.done;Na=Ya.next())if(Na=Na.value,Object(t.a)(da.AutoDetectRange,Na)&&this.rfc(Ha,!1,Na))return!0;return!1};a.prototype.qHa=function(){if(this.uwa&&-1!==this.fYa){this.Th.getButton(a.Cea).hFb();var Ha={};Ha.Id=this.mta;Ha.StringId=null;this.convertToLinkedEntityManager.M2c(Ha,!0,this.F4b);n.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");Ha=[Object.assign(new pa.a,{name:"Domain",int64:this.mta})];qa.a("AssistedAutoConvertMenuConvertClicked",
void 0,void 0,Ha);this.mta=-1}};a.prototype.vLh=function(){var Ha=ea.a.instance.fa(1697);if(-1!==this.mta){Ha+=" ";try{Ha+=this.convertToLinkedEntityManager.cAb(this.mta.toString())}catch(Ya){n.ULS.sendTraceTag(537166982,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.mta)}}Ha+=" ";return Ha=this.wob?Ha+ea.a.instance.fa(1700):Ha+ea.a.instance.fa(this.isMac?1699:1698)};a.prototype.kdb=function(){this.wob&&(this.$T||(this.$T=new l(this.Kb,this.$),this.$T.convertToDomainName=
ea.a.instance.fa(1702),this.$T.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.$T.imageAltText=ea.a.instance.fa(1704),this.$T.helpId="HID_DataTypes_Wolfram",this.$T.helpText=ea.a.instance.fa(1703)),this.$T.longDescription=this.convertToLinkedEntityManager.WVd(this.fYa.toString()),this.$T.Z4g())};a.prototype.rfc=function(Ha,Ya,Na){if((new fa.Range(Na.top,Na.left,Na.bottom===x.a.Kh?Na.bottom:Na.bottom+1,Na.right,!0,!1)).Rd(Ha)){if(Ya){if(Na&&Na.vob!==
this.fYa){this.fYa=Na.vob;Ha=Na.vob.toString();Ya=this.wob?"":this.convertToLinkedEntityManager.WVd(Ha);var eb=this.convertToLinkedEntityManager.V8h(Ha);this.Th.afb(this.convertToLinkedEntityManager.cAb(Ha),Ya,eb,a.Cea)}this.mta=Na.vob;this.F4b=Na}return!0}return!1};a.prototype.fX=function(){if(this.convertToLinkedEntityManager){var Ha=this.gridView.ha.We;if(this.gridBlockManager&&this.gridBlockManager.djd){var Ya=this.gridView.ha.va.activeCell,Na=!this.gridBlockManager.ds(Ya),eb=this.gridView.getRangeInformation(this.gridView.Jh);
eb=yl(eb);for(var Ia=eb.next();!Ia.done;Ia=eb.next())if(Ia=Ia.value,Object(t.a)(da.AutoDetectRange,Ia))switch(Ia.SXg){case 3:if(this.rfc(Ya,!0,Ia)){if(1!==Ha||Na){this.Lx();return}n.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.MHd();this.Th.DAa(Ya,this.tya);this.jte||(this.jte=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(la.EwaSettings.la(492)||la.EwaSettings.la(493))&&this.ZMg.cgh(Ia);break;default:n.ULS.sendTraceTag(537166980,
0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Lx()}};a.prototype.Rcg=function(Ha){var Ya=[29];this.gridView.Ob.Ml(Ha,Ya);this.gridView.Ob.xs(Ya)};a.prototype.w6a=function(){return this.$.ea.isNamedObjectViewMode&&W.f(this.$.pa)};a.prototype.MHd=function(){this.wob&&!this.yic&&this.pr&&(this.pr.nt(v.a.Tb,this.$.domElement,this.onKeyDown,!0),this.pr.nt(v.a.Xd,this.$.domElement,this.onKeyUp,!0),this.yic=!0)};a.prototype.OPj=function(){this.wob&&this.yic&&
this.pr&&(this.pr.tt(v.a.Tb,this.$.domElement,this.onKeyDown,!0),this.pr.tt(v.a.Xd,this.$.domElement,this.onKeyUp,!0),this.yic=!1)};a.ANh=function(Ha){return ea.a.instance.fa(1758)+u.a.space+Ha};Qk.Object.defineProperties(a.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return this.Th.domElement(1)}},HAb:{configurable:!0,enumerable:!0,get:function(){var Ha=this.Th.domElement(a.Cea);return Ha?ia.DOMElementExtensions.isVisible(Ha):!1}},uwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&
la.EwaSettings.la(136)&&la.EwaSettings.la(139)&&(new ca.a(this.$.xa)).Nj?!1:-1!==this.mta}}});Qk.Object.defineProperties(a,{Cea:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(y.a)(a,"AutoDetectManager",A.a,[])},1324:function(y,F,b){function a(f,v,w,t,A){var x=m.call(this)||this;x.$=f;x.Ip=t.k4b(f,v,w,"",d.a.Fe(11),A,"AutoDetectPointerDown",l.a.instance.fa(1758)+"...");return x}b.r(F);b.d(F,"AutoDetectActionButton",function(){return a});y=b(0);F=b(74);var c=b(1244),d=b(53),l=b(14),
n=b(19),m=F.a;vm(a,m);a.prototype.dispose=function(){this.Ip.dispose();this.$=null;m.prototype.dispose.call(this)};a.prototype.domElement=function(f){return this.Ip.domElement(f)};a.prototype.getButton=function(f){return this.Ip.getButton(f,!1)};a.prototype.afb=function(f,v,w,t){this.Ip.DTa(c.a.ANh(f),v,t);this.Ip.Odg(w,v,t)};a.prototype.DAa=function(f,v){var w=n.g(this.$),t=w.$a.nj(f);f=w.pg(f,t);var A=w.Sf(t).nn;if(f&&0<=f.x&&0<=f.y&&A.width>f.width+160){var x=f.bottomRight.x+this.iz,u=f.topLeft.y+
this.iz,B=!1;x+160>A.bottomRight.x&&(x=f.topLeft.x-this.iz,B=!0);if(u<A.topLeft.y+this.iz){if(w.$a.gTa){this.hide();return}u=A.topLeft.y+this.iz}this.Ip.p7b(v,t);this.Do(x,u,w.rtl,t,B)}else this.hide()};a.prototype.Do=function(f,v,w,t,A){this.Ip.Do(f,v,w,t,!1,A)};a.prototype.hide=function(){this.Ip.hide()};Qk.Object.defineProperties(a.prototype,{iz:{configurable:!0,enumerable:!0,get:function(){return this.Ip.iz}}});Object(y.a)(a,"AutoDetectActionButton",F.a,[])},1402:function(y,F,b){function a(ea){var qa=
ca.call(this)||this;qa.wi=null;qa.eh=null;qa.$=ea;qa.fc();return qa}function c(ea,qa,pa){var Pa=W.call(this,ea)||this;Pa.Dr=0;Pa.vp=!1;Pa.qd=function(){Pa.Nf(!1)};Pa.$=qa;Pa.taskPaneManager=pa;la.a(qa).Qg(Pa);Pa.$.ul(Pa.qd);ba.a.Ld(Pa.$)&&(Pa.isVisible=!1);return Pa}function d(ea){var qa=U.call(this)||this;qa.$=ea;qa.fc();return qa}function l(ea){return I.call(this,ea)||this}function n(ea,qa){this.$=qa;this.convertToLinkedEntityManager=ea}b.r(F);y=b(0);var m=b(817),f=b(13),v=b(4),w=b(77),t=b(35),
A=b(1),x=b(175),u=b(19),B=b(176);n.prototype.Zc=function(ea,qa){switch(qa){case -1203788282:case 48568533:case -1662108744:return ea=u.g(this.$),qa=this.convertToLinkedEntityManager.pAi||7E3,(null===ea||void 0===ea?0:ea.ha)&&ea.ha.va.Td.kU>qa?!0:!1;default:return!1}};n.prototype.executeCommand=function(ea,qa,pa){ea=t.TaskExtensions.nm();qa=qa.command;switch(qa){case -1203788282:this.convertToLinkedEntityManager.x3g(pa[w.a.nd].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();
break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(pa[w.a.nd].toString());break;case 1266950951:this.convertToLinkedEntityManager.Mri();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:A.EwaSettings.la(680)&&this.convertToLinkedEntityManager.tLe();
break;case 1702917262:A.EwaSettings.la(680)&&this.convertToLinkedEntityManager.showHelpArticle(v.a.eRj);break;case -90814711:A.EwaSettings.la(680)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===qa||pa[w.a.$kf]&&"ConvertToLinkedEntityGallery"===pa[w.a.$kf].toString())f.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),B.a("ExpandDataTypeGallery");
break;default:ea=x.a(qa)}return ea};n.prototype.Kc=function(ea,qa){switch(qa.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return A.EwaSettings.la(131);case -1081442996:case 1702917262:case -90814711:return A.EwaSettings.la(680);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}};n.prototype.gd=function(ea,qa,pa){return"PopulateConvertToLinkedEntityMenu"===qa&&A.EwaSettings.la(131)?this.convertToLinkedEntityManager.gd(ea,
qa,pa):!1};Object(y.a)(n,"ConvertToLinkedEntityCommandHandler",null,[239]);var r=b(461),I=m.a;vm(l,I);l.prototype.Pd=function(){var ea=this;r.a(this.$,271,272,this.ub,function(qa){ea.Gd([new n(qa,ea.$)])})};l.ka=function(ea){m.a.he(273,new l(ea))};Object(y.a)(l,"ConvertToLinkedEntityCommandHandlerFactory",m.a,[]);F=b(214);var z=b(887),D=b(56),V=b(412),U=F.a;vm(d,U);d.prototype.create=function(){var ea=this,qa=D.GetServiceTaskFactory.create(this.$.da,102,this.$.ma,this.ub),pa=D.GetServiceTaskFactory.Wa(this.$.da,
5,4,this.ub),Pa=D.GetServiceTaskFactory.Wa(this.$.da,388,387,this.ub);if(this.$.Yj)t.TaskExtensions.Ba(t.TaskExtensions.we([qa,pa,Pa],this.ma),function(){ea.Gb(ea.$.da.Aa(271)||new z.ConvertToLinkedEntityManager(ea.$,qa.result,Pa.result,null,null,pa.result))},this.$.ma,3);else{var Ha=D.GetServiceTaskFactory.Wa(this.$.da,257,258,this.ub),Ya=V.a(this.$);t.TaskExtensions.Ba(t.TaskExtensions.we([qa,Ha,Ya,pa,Pa],this.ma),function(){ea.Gb(ea.$.da.Aa(271)||new z.ConvertToLinkedEntityManager(ea.$,qa.result,
Pa.result,Ha.result,Ya.result,pa.result))},this.$.ma,3)}};d.ka=function(ea){ea.da.Ha(272,new d(ea))};Object(y.a)(d,"ConvertToLinkedEntityManagerFactory",F.a,[]);var Q=b(230),la=b(255),ba=b(39),S=b(244),H=b(11),T=b(826),K=b(16),da=b(63),fa=K.a.fwh,W=Q.a;vm(c,W);c.prototype.KG=function(ea){this.get_events().addHandler("EnrichmentTaskPaneRemoved",ea)};c.prototype.nI=function(ea){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",ea)};c.prototype.XB=function(ea){this.addHandler("EnrichmentTaskPaneVilibilityChanged",
ea)};c.prototype.lD=function(ea){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",ea)};c.prototype.hGg=function(ea){this.addHandler("EnrichmentTaskPaneOnFocus",ea)};c.prototype.qdj=function(ea){this.removeHandler("EnrichmentTaskPaneOnFocus",ea)};c.prototype.kw=function(){};c.prototype.pC=function(){};c.prototype.hn=function(){return this.vp};c.prototype.Vp=function(){return this.vp};c.prototype.GF=function(){};c.prototype.dispose=function(){this.$&&this.$.rn(this.qd);this.taskPaneManager=
this.$=null;W.prototype.dispose.call(this)};c.prototype.Oe=function(ea,qa){qa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!qa};c.prototype.Yf=function(ea){return H.DOMElementExtensions.Pe(this.Kb,ea)};c.prototype.fi=function(){};c.prototype.Ph=function(){};c.prototype.Nf=function(ea){this.vp=ea;var qa=this.taskPaneManager;this.isVisible=ea;ba.a.Ld(this.$)?ea?this.taskPaneManager.WR("EnrichmentTaskPane",this.EI):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(ea&&0<qa.Kz.length&&(!qa.Bg||
10!==qa.Bg.taskPane.wg||qa.isCollapsed)&&qa.mD(this,!0),qa.qp());ea||(u.g(this.$).Oe(!0,!1),this.$.If())};c.prototype.wH=function(){return!1};c.ka=function(ea,qa){var pa=ea.Jb,Pa=document.getElementById(pa+v.a.SLe);Pa||(Pa=T.a("div",ea.Jb+v.a.SLe,"cui-taskpane"),ba.a.Ld(ea)||(pa=document.getElementById(pa+v.a.JR),void 0!==pa&&null!==pa?pa.appendChild(Pa):f.ULS.sendTraceTag(537166720,0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",ea.hF)));pa=ea.da;return pa.Aa(257)||
pa.Ha(257,new c(Pa,ea,qa))};Qk.Object.defineProperties(c.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(da.a)(c.prototype,this,"isVisible")},set:function(ea){Object(da.b)(c.prototype,this,"isVisible",ea);this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},$d:{configurable:!0,enumerable:!0,get:function(){return S.a.ylh}},wg:{configurable:!0,enumerable:!0,get:function(){return 10}},
Mj:{configurable:!0,enumerable:!0,get:function(){return fa}},IC:{configurable:!0,enumerable:!0,get:function(){return this.titleText}},titleText:{configurable:!0,enumerable:!0,get:function(){return"Enrichment"}},Gl:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.BL.offsetHeight}},
EI:{configurable:!0,enumerable:!0,get:function(){var ea=this;return this.taskPaneManager.Rua(this.Kb,this.titleText,this.Gl,this.isResizable,function(){ea.isVisible=!0},function(){ea.isVisible=!1},function(){ea.isVisible=!0},function(){ea.isVisible=!1},this.Gl)}}});Object(y.a)(c,"EnrichmentTaskPane",Q.a,[541,2,249,117]);var ca=F.a;vm(a,ca);a.prototype.create=function(){var ea=this,qa=D.GetServiceTaskFactory.create(this.$.da,203,this.ma,this.ub),pa=D.GetServiceTaskFactory.create(this.$.da,155,this.ma,
this.ub);t.TaskExtensions.Ba(t.TaskExtensions.ts(t.TaskExtensions.we([qa,pa],this.ma),function(){return ea.aD},this.ma),function(){ea.Gb(ea.eh)},this.ma,3)};a.prototype.dispose=function(){this.eh=this.wi=this.$=null;ca.prototype.dispose.call(this)};a.ka=function(ea){ea.da.Ha(258,new a(ea))};Qk.Object.defineProperties(a.prototype,{aD:{configurable:!0,enumerable:!0,get:function(){var ea=this;this.wi||(this.wi=t.TaskExtensions.Ba(V.a(this.$),function(qa){ea.eh=c.ka(ea.$,qa.result)},this.ma,3));return this.wi}}});
Object(y.a)(a,"EnrichmentTaskPaneFactory",F.a,[]);var ia=b(10);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(function(){ia.a.Ga(function(ea){a.ka(ea);d.ka(ea);l.ka(ea)})})()},887:function(y,F,b){function a(Wa,mb,kc,Ab,Tb,ib){var Sa=cb.call(this)||this;Sa.lub=!1;Sa.yLb=!1;Sa.Lmd=null;Sa.uMa=null;Sa.Hpd=null;Sa.Ipd=null;Sa.kic=null;Sa.Qhc=null;Sa.Pqd=null;Sa.F4a=0;Sa.wCb=0;Sa.mwb=0;Sa.Qba=null;Sa.Umd=!1;Sa.MLd=null;Sa.Zm=null;Sa.scd=null;Sa.qr=0;Sa.wM=null;Sa.L_j=null;
Sa.LKa=8;Sa.aPa=!1;Sa.mef=!1;Sa.tlf=!1;Sa.JZc=!1;Sa.w2a=null;Sa.e3a=null;Sa.Yya=null;Sa.CXc=0;Sa.nNg=5;Sa.P_b=3E4;Sa.hag=!1;Sa.c$=null;Sa.K0b=null;Sa.zia=Array(5);Sa.EXd=!1;Sa.Hcg=!1;Sa.ptd=0;Sa.LUf=0;Sa.bbe=null;Sa.dd=function(Mb,Jc){Jc.rc&&!Jc.Ihc&&Sa.showUntrustedImageBusinessBarIfNecessary()};Sa.gNi=function(Mb){if(Mb.Result){var Jc=Mb.Result;if(Jc&&Jc.length){I.ULS.sendTraceTag(537166922,0,50,"OnGetRichDataClassificationLabelsSuccess: Received {0} labels",Jc.length);var Ib=jc.GetServiceTaskFactory.Wa(Sa.$.da,
274,275,0);dc.TaskExtensions.Ba(Ib,function(){Ib.result.uXc(Jc,2)||I.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},Sa.$.ma,3)}}else I.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};Sa.Mf=function(){Sa.Uyb&&(Sa.kOj(),Sa.v4h(Sa.$.ea.Cm.LinkedEntityAsyncRefreshStateId));Sa.M6a?Sa.r5h(Sa.$.ea.Cm.RichDataClassificationLabelStateId):Sa.$5a&&Sa.RWd(!0)};Sa.PKi=function(){Sa.EXd=!0;Sa.Zm&&
Sa.Zm.A8i()};Sa.BMi=function(Mb){if(Mb&&!Ba.a(Mb))try{Mb.Result.HasUntrustedImageUrl&&(Sa.businessBar.ig(57,null),Sa.Hcg=!0)}catch(Jc){I.ULS.sendTraceTag(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",Jc)}};Sa.Vkf=function(){if(!Sa.tlf&&Sa.lyb()&&!Sa.Knd())if(lc.a("DataTabActive"),Ub.a.Rf.nR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Mb=Sa.R3b();if(Mb){var Jc={};
Jc.InputMethod=Ga.a.dc;Jc.CalloutName=8;Jc.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";Sa.$.Ka.Yb(Mb,Jc);Sa.tlf=!0}else I.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else I.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else I.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};
Sa.LJi=function(Mb){Gb.a.lh(Mb.Errors)||(Sa.M6a||Sa.RWd(!1),Sa.raiseEvent("LinkedEntityConverted"))};Sa.QTi=function(){Sa.$.da.Za(211,function(Mb){Mb.readText(xa.a.instance.fa(1763))})};Sa.ud=function(Mb,Jc){I.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Jc.oR?I.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(Sa.$.isEditMode?Sa.pye():Sa.vhj(),Za.EwaSettings.la(680)&&Sa.EXd&&Sa.tLe())};
Sa.Nyf=function(Mb){Sa.S1b();if(Mb.Result){if(Sa.bxa){Mb=Mb.Result;var Jc=Mb.DomainDataArray;Sa.Qba=Mb.Ribbon;if(Sa.dxa&&Sa.Qba){var Ib={};Ib.Name=xa.a.instance.fa(1753);Ib.DomainIds=Sa.yK;Array.insert(Sa.Qba.Categories,a.S7a,Ib)}0<Mb.MaximumCellsToConvert&&(Sa.bbe=Mb.MaximumCellsToConvert)}else Jc=Mb.Result;Sa.qr=2;Mb=!1;if(Jc){I.ULS.sendTraceTag(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",Jc.length);Sa.yxa||(Sa.yxa=[]);Ib=xa.a.instance.fa(1750);var Nb=xa.a.instance.fa(1752);
Jc=yl(Jc);for(var sa=Jc.next();!sa.done;sa=Jc.next())if(sa=sa.value,sa.DomainId)if(Sa.yxa.push(sa),sa.DomainBlocked){var Va=!!sa.DomainId.StringId;I.ULS.sendTraceTag(537166861,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",Va?sa.DomainId.Id.toString():sa.Name,Va)}else Sa.KM.ia(a.v1a(sa.DomainId),sa),sa.Name===Ib||268435456===sa.DomainId.Id?Sa.w2a=sa.DomainId.Id.toString():sa.Name===Nb||536870912===sa.DomainId.Id?Sa.e3a=sa.DomainId.Id.toString():268435712===sa.DomainId.Id&&
sa.ShowInRibbon&&(Sa.JZc=!0),Mb=!0;else I.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Mb||(Sa.yxa=null);Sa.udg();Sa.Vpd&&Sa.MLd.mXh();Sa.hag||(Sa.hOj(),Sa.hag=!0)}else Sa.yxa=null,Sa.qr=3,-1<Sa.LKa&&window.setTimeout(function(){Sa.G$a()},100*(8-Sa.LKa)),I.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");Sa.rrc();Sa.kEe();Sa.JZc&&Sa.yff&&Kb.b(Sa.Vkf,Sa.$.ma,500);Sa.$5a&&!Sa.M6a&&Sa.RWd(!0)};Sa.Myf=function(Mb){Mb=
Wb.a.og(Mb.data);I.ULS.sendTraceTag(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",Gb.a.Uc(Mb));Sa.yxa=null;Sa.qr=3;Sa.aPa=!0;Sa.rrc()};Sa.onContentReady=function(){Sa.rbg()&&Sa.gridView.ot(Sa.onContentReady)};Sa.dj=function(){Sa.S1b()};Sa.jPi=function(Mb){if(Ba.a(Mb)){var Jc=jc.GetServiceTaskFactory.Wa(Sa.$.da,5,4,0);dc.TaskExtensions.Ba(Jc,function(){var Nb=null;if(null===Mb||void 0===Mb?0:Mb.Errors)Nb=Mb.Errors[0];Jc.result.K4f(Nb,null)},Sa.$.ma,3);I.ULS.sendTraceTag(537166800,
0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",Gb.a.Uc(Mb.Errors));var Ib=Gb.a.QF(Mb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");Sa.$.ea.lp(Ib)}};Sa.zZc=function(){I.ULS.sendTraceTag(537166796,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",Sa.P_b);Sa.$bf("Periodic auto-refresh check",Sa.bIi,
Sa.aIi)};Sa.bIi=function(Mb){Ba.a(Mb)?(I.ULS.sendTraceTag(537166795,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",Gb.a.Uc(Mb.Errors)),++Sa.CXc):Sa.CXc=0;z.a.Fa(Sa.Yya);Sa.CXc>=Sa.nNg?(I.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),Sa.Yya=null):(I.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),
Sa.Yya=Qb.a.instance.create(Sa.zZc,Sa.P_b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};Sa.aIi=function(Mb){Mb=Wb.a.og(Mb.data);D.a.ni(Mb)?I.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):I.ULS.sendTraceTag(537166792,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",Gb.a.Uc(Mb));z.a.Fa(Sa.Yya);Sa.Yya=Qb.a.instance.create(Sa.zZc,Sa.P_b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};
Sa.qQi=function(Mb){Mb=!!Mb.Result&&Mb.Result;I.ULS.sendTraceTag(537166790,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",Mb.toString());Mb?(I.ULS.sendTraceTag(537166789,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",O.a.Ra.ie.m-Sa.F4a,Sa.wCb),Sa.G$a()):Sa.tLb()};Sa.pQi=function(){I.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");Sa.tLb()};Sa.CRi=function(Mb){Mb=!!Mb.Result&&Mb.Result;I.ULS.sendTraceTag(537166731,
0,50,"OnRefreshHandshakeSuccess- operationSucceeded? = {0}",Mb.toString());Mb?(I.ULS.sendTraceTag(537166730,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = {0} ms, retry count = {1}",O.a.Ra.ie.m-Sa.F4a,Sa.mwb),Sa.G$a()):Sa.iOf()};Sa.BRi=function(){I.ULS.sendTraceTag(570769947,0,15,"OnRefreshHandshakeFailed");Sa.iOf()};Sa.lMi=function(Mb){Mb.Result?(Mb=Mb.Result)?(Sa.IId(),Sa.businessBar.K4f(null,Mb)):I.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):
I.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};Sa.$=Wa;Sa.businessBar=ib;Sa.svgIconProvider=kc;Sa.yxa=[];Sa.yK=[];Sa.gridView=fc.g(Sa.$);Sa.Wcc=-1;Sa.bxa=Za.EwaSettings.la(459);Sa.yki=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");Sa.$5a=Sa.$.la(457)&&Sa.$.la(296);Sa.M6a=Sa.$.la(704);Sa.Uyb=Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);
Sa.dxa=Sa.$.la(703)&&Sa.bxa;Sa.Vpd=Sa.dxa&&Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);Sa.yff=Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);Sa.bMa=Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CheckExtraPowerBILicenses",!1);Sa.KM=new Fa.a;Sa.PNa=new d(Wa,mb,Sa);Ab&&(Sa.Zm=new l(Wa,Ab,Tb,Sa,Sa));Sa.$.Pk(Sa.ud);fa.a(Sa.$)&&fa.a(Sa.$).Eqj(Sa);Sa.pye();(Sa.Uyb||Sa.$5a||
Sa.M6a)&&Sa.$.ea.Bt(Sa.Mf);Za.EwaSettings.la(131)&&Za.EwaSettings.la(139)&&(Sa.rbg()||Sa.gridView.$q(Sa.onContentReady));Sa.bxa&&Sa.$.mA(Sa.dj);Za.EwaSettings.la(680)&&(Sa.$.ea.Tj(Sa.dd),Sa.showUntrustedImageBusinessBarIfNecessary());Sa.Vpd&&(Sa.MLd=new c(Sa.$,Sa));return Sa}function c(Wa,mb){var kc=this;this.sjd=this.ujd=!1;this.sRi=function(Ab){I.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");kc.ujd=!0;if(Gb.a.lh(Ab.Errors))I.ULS.sendTraceTag(537166679,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",
Gb.a.Uc(Ab.Errors));else{var Tb=0,ib=[],Sa=!1;try{if(!Ab.Result)return;var Mb=Ab.Result;if(!Mb){I.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}ib=kc.oYi(Mb);if(!ib||!ib.length)return;Tb=ib.length;kc.UAi(ib);kc.Uza.BTf();I.ULS.sendTraceTag(537166677,0,50,"OnReadRoamingStringSuccess MruCount:{0}",kc.Uza.mGb.length);if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var Jc=yl(kc.Uza.mGb),Ib=Jc.next();!Ib.done;Ib=
Jc.next())if(1===(Ib.value.Id&1048320)>>8){Sa=!0;break}I.ULS.sendTraceTag(537166676,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:{0}",Sa)}}finally{I.ULS.sendTraceTag(537166675,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",Tb),Ab=[],Ab.push(Object.assign(new Oa.a,{name:"MruCount",int64:Tb})),Ab.push(Object.assign(new Oa.a,{name:"MruWolframAvailable",bool:Sa})),lc.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Ab)}kc.sjd&&(kc.vhg(kc.Uza.mGb),kc.sjd=!1)}};this.SVi=function(Ab){I.ULS.sendTraceTag(537166674,
0,50,"OnWriteRoamingStringSuccess called.");Gb.a.lh(Ab.Errors)?I.ULS.sendTraceTag(537166673,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",Gb.a.Uc(Ab.Errors)):Ab.Result&&(Ab.Result||I.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.OCf=function(Ab,Tb,ib){Ab=Wb.a.og(Ab.data);I.ULS.sendTraceTag(537166671,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",ib,Gb.a.Uc(Ab))};this.$=Wa;this.Uza=
mb}function d(Wa,mb,kc){this.rtd=2;this.qtd="Size64by48";this.$=Wa;this.Sa=mb;this.convertToLinkedEntityManager=kc;this.dxa=Za.EwaSettings.la(703)&&Za.EwaSettings.la(459)}function l(Wa,mb,kc,Ab,Tb){var ib=this;this.Gta=this.yIe=!1;this.Zbb=this.Hwa=!0;this.xEb=this.vKb=!1;this.rdb=null;this.$oc=0;this.LR=function(){(ib.Zbb||ib.Gta)&&2!==ib.$oc&&(ib.xEb||ib.Ssd(!1))};this.dd=function(){I.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.Xh=function(){(ib.Zbb||
ib.Gta)&&ib.Ssd(!1)};this.Umc=function(Sa,Mb){Gb.a.lh(Sa.Errors)?I.ULS.sendTraceTag(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",Gb.a.Uc(Sa.Errors)):Sa.Result&&(Sa=Sa.Result,Sa.DisambiguationJson?(ib.vKb=!1,ib.$_f(Mb),ib.rdb=Sa.SkydanceFeatureBitmask,Mb=Sa.DisambiguationJson,I.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),ib.xEb=!1,ib.Ykf(Mb)):
I.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.hMi=function(Sa,Mb){Gb.a.lh(Sa.Errors)?I.ULS.sendTraceTag(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",Gb.a.Uc(Sa.Errors)):Sa.Result&&(Sa=Sa.Result,Sa.DisambiguationJson?(ib.$_f(Mb),ib.rdb=Sa.SkydanceFeatureBitmask,Mb=Sa.DisambiguationJson,I.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
ib.xEb=!0,ib.Ykf(Mb)):I.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.QPi=function(Sa){Gb.a.lh(Sa.Errors)?(I.ULS.sendTraceTag(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",Gb.a.Uc(Sa.Errors)),ib.Zbb=!0):Sa.Result&&(Sa=Sa.Result,ib.rdb=Sa.SkydanceFeatureBitmask,ib.Lwd(Sa),ib.vKb=!0)};this.KSi=function(Sa){Gb.a.lh(Sa.Errors)&&I.ULS.sendTraceTag(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",
Gb.a.Uc(Sa.Errors));Sa.Result?(ib.Lwd(Sa.Result),ib.vKb=!0):ib.Jsa()};this.gDf=function(Sa){Gb.a.lh(Sa.Errors)?I.ULS.sendTraceTag(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",Gb.a.Uc(Sa.Errors)):Sa.Result?ib.B7b.kBc(Sa.Result,null):(I.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),ib.Jsa())};this.sOi=function(Sa){Gb.a.lh(Sa.Errors)?I.ULS.sendTraceTag(537166926,
0,15,"Failed to insert starter data table. Error id names: {0}",Gb.a.Uc(Sa.Errors)):ib.Jsa()};this.$=Wa;this.gridView=fc.g(this.$);this.gridView.ha.E2(this.Xh);this.gridView.$q(this.LR);this.sMe=Ab;this.convertToLinkedEntityManager=Tb;kb.a.Ld(this.$)||kc.bR(mb);Wa=new w(mb);this.B7b=new f(Wa);ba.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Sa){Sa.isFeatureEnabled("mso_sendASmile",!0).then(function(Mb){ib.Hwa=Mb;return null})})}function n(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}function m(Wa){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Wa;this.commentQuestion=xa.a.instance.Cb(189);this.isZeroBased=!1;this.aditionalDataRequested=
["EmailAddress"];this.ratingQuestion=xa.a.instance.Cb(185);this.ratingValuesAscending=[xa.a.instance.Cb(186),xa.a.instance.Cb(187),xa.a.instance.Cb(188)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=xa.a.instance.Cb(184)}function f(Wa){return v.call(this,Wa)||this}function v(Wa){this.By=null;this.ufa=Wa}function w(Wa){var mb=t.call(this,V.AFrameworkApplication.sa.uy,V.AFrameworkApplication.sa.qt,V.AFrameworkApplication.sa.oea,V.AFrameworkApplication.sa.Te,V.AFrameworkApplication.Hb)||
this;mb.taskPane=Wa;mb.taskPane.hGg(Object(S.a)(mb,mb.$Zf,"setFocusOnIFrame"));return mb}function t(Wa,mb,kc,Ab,Tb){this.Uq=this.ai=this.n8d=this.m8d=this.Ev=this.uu=null;this.Vw=!1;this.Ei=Wa;this.ke=mb;this.qP=kc;this.nc=Ab;this.La=Tb;this.Opa=hc.KeyInputManager.gm(lb.a.HBa,0)}function A(Wa,mb,kc){Wa=x.call(this,Wa,mb)||this;Wa.telemetryJson=null;Wa.telemetryJson=kc;return Wa}function x(Wa,mb){Wa=u.call(this,Wa)||this;Wa.messageContent=null;Wa.messageContent=mb;return Wa}function u(Wa){this.messageType=
0;this.messageType=Wa}function B(){}function r(Wa,mb,kc,Ab,Tb,ib,Sa,Mb,Jc,Ib,Nb){Nb=Wa.Na(1,void 0===Nb?null:Nb);Nb.selectedRanges=mb;Nb.isChangeObject=kc;Nb.isFloodgateEnabled=Ab;Nb.isStarterData=Tb;Nb.starterDataDomainId=ib;return pa.i(Wa,"GetDataSelectorPaneData",Nb,Sa,Mb,Jc,Ib,4)}b.r(F);y=b(0);var I=b(13),z=b(88),D=b(309),V=b(5),U=b(29),Q=b(947),la=b(144),ba=b(87),S=b(80),H=b(84),T=b(36),K=b(16),da=b(4),fa=b(153),W=b(1244),ca=b(1257),ia=b(177),ea=b(579),qa=b(340),pa=b(81),Pa=b(826),Ha=b(923);
B.R8h="EnrichmentContentFrame";B.width=320;Object(y.a)(B,"EnrichmentConstants",null,[]);Object(y.a)(u,"EnrichmentResponseMessage",null,[]);vm(x,u);Object(y.a)(x,"EnrichmentResponseMessageWithContent",u,[]);vm(A,x);Object(y.a)(A,"EnrichmentResponseMessageWithContentAndTelemetryData",x,[]);var Ya=b(274),Na=b(12),eb=b(99),Ia=b(38),lb=b(91),hc=b(117),ma=b(40),Ja=b(78),Ta=b(23),pb=b(104),Db=b(818),fb=b(30);t.prototype.dispose=function(){this.mKb&&this.Uq&&(this.Ei.za(Na.a.click,this.Uq,Object(S.a)(this,
this.$j,"onClosePaneClick")),this.ke.za(Na.a.Xd,this.Uq,Object(S.a)(this,this.Pzf,"onKeyHide")));this.Uq=null;this.Ev&&(this.uQj(),this.Ev.parentNode.removeChild(this.Ev),this.Ev=null);this.nc.Ai("EnrichmentPaneId").Ok(this.Opa)};t.prototype.show=function(Wa,mb,kc){this.uu=Wa;this.Vw||(this.ai=this.v0a(),this.MQa.appendChild(this.ai),this.L9i(),this.La.hc(fb.a.Oze,pb.a.frame,Object(S.a)(this,this.M3h,"handleEscapeKeyAction")),this.IRa(),this.Vw=!0);this.Ev.src=this.N1a&&this.N1a.length?this.N1a+"?culture="+
mb.market+"&appName="+mb.applicationName+"&themeId="+mb.themeId+"&featuresBitMask="+mb.featuresBitMask:t.vtf;this.m8d=mb;this.n8d=kc;this.fdb()};t.prototype.kBc=function(Wa,mb){Wa=new A(2,Wa,mb);this.Qpc(Wa)};t.prototype.IRa=function(){var Wa=this.nc.Ai("EnrichmentPaneId");Wa.parent=Ya.AFrame.LNa;this.Ei.Xmb("EnrichmentPaneId",this.ai);Wa.bindAction(this.Opa,fb.a.Oze)};t.prototype.$Zf=function(){if(this.Ev){eb.FocusManager.qoa(this.Ev.contentWindow);var Wa=new A(4,null,null);this.Qpc(Wa)}};t.prototype.$j=
function(){this.j2b();return!0};t.prototype.Pzf=function(Wa){Wa=Wa.Ea.keyCode;return Wa===Sys.UI.Key.enter||Wa===Sys.UI.Key.space?(this.j2b(),!0):!1};t.prototype.j2b=function(){this.hide();if(this.uu)this.uu.onPaneClosed()};t.prototype.v0a=function(){var Wa=Pa.a("div","EnrichmentPaneId","EnrichmentPane");this.mKb&&Wa.appendChild(this.L3c());this.Abi(Wa);return Wa};t.prototype.L3c=function(){var Wa=Pa.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),mb=Pa.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");
mb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;mb.title=CommonUIStrings.l_EnrichmentPaneTitle;var kc=Ha.a.Bb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Ei.qa(Na.a.click,kc,Object(S.a)(this,this.$j,"onClosePaneClick"));this.ke.qa(Na.a.Xd,kc,Object(S.a)(this,this.Pzf,"onKeyHide"));Wa.appendChild(mb);Wa.appendChild(kc);this.Uq=kc;return Wa};t.prototype.Abi=function(Wa){this.Ev=Pa.b("iframe","","EnrichmentFrame");Wa.appendChild(this.Ev);
this.Ev.id=B.R8h;this.Ev.setAttribute("role","presentation")};t.prototype.L9i=function(){Ia.a.addHandler(this.Ev,"load",Object(S.a)(this,this.rzf,"onIFrameLoad"));Ia.a.addHandler(this.Ev,"error",Object(S.a)(this,this.bnc,"onIFrameError"));$addHandler(window,"message",Object(S.a)(this,this.szf,"onIFrameMessage"))};t.prototype.uQj=function(){Ia.a.removeHandler(this.Ev,"load",Object(S.a)(this,this.rzf,"onIFrameLoad"));Ia.a.removeHandler(this.Ev,"error",Object(S.a)(this,this.bnc,"onIFrameError"));$removeHandler(window,
"message",Object(S.a)(this,this.szf,"onIFrameMessage"))};t.prototype.$bh=function(){this.Ev.src=t.vtf};t.prototype.hide=function(){this.ydc();this.$bh()};t.prototype.M3h=function(Wa,mb,kc){if(1!==kc&&(this.hide(),this.uu))this.uu.onPaneClosed();return 32};t.prototype.rzf=function(){};t.prototype.bnc=function(){};t.prototype.szf=function(Wa){Wa=Wa.rawEvent;if(!this.Ev||-1!==this.Ev.src.indexOf(Wa.origin)){try{var mb=ma.a(Wa.data)}catch(kc){return}if(!Db.c(mb.messageType)){Wa=window.g_badCastCallback;
window.g_badCastCallback=null;switch(mb.messageType){case 2:this.Qpc(new A(1,ma.c(this.m8d),this.n8d));break;case 1:this.Qpc(new x(0,this.$Jh()));break;case 3:this.uu&&this.uu.selectEntity(mb.messageContent);break;case 5:this.uu&&this.uu.YBb(mb.messageContent);break;case 8:this.uu&&(mb=ma.a(mb.messageContent),0<mb.DomainId?this.uu.MMd(mb.Query,mb.TelemetryJson,mb.DomainId,mb.DomainIdString):this.uu.searchEntity(mb.Query,mb.TelemetryJson));break;case 6:this.uu&&this.uu.cancelSearch();break;case 11:mb=
ma.a(mb.messageContent);mb=t.g4b("keydown","f6",lb.a.ODc,!0,!1,mb,!0,!1);this.Ev&&this.Ev.dispatchEvent(mb);break;case 12:if(ma.a(mb.messageContent).keyCode===lb.a.LL&&(mb=t.g4b("keydown","esc",lb.a.LL,!0,!1,!1,!1,!1),this.Ev&&(this.Ev.dispatchEvent(mb),this.hide(),this.uu)))this.uu.onPaneClosed();break;case 13:this.uu&&this.uu.selectDataType(mb.messageContent);break;case 14:this.uu&&this.uu.showHelpArticle(mb.messageContent);break;case 15:this.uu&&this.uu.showSurveyDialog(mb.messageContent);break;
case 16:this.uu&&(mb=ma.a(mb.messageContent),this.uu.insertTable(mb.DomainId,mb.DomainIdString))}window.g_badCastCallback=Wa}}};t.prototype.$Jh=function(){return ma.c([2,1,3,5,8,6])};t.prototype.Qpc=function(Wa){Wa=ma.c(Wa);this.Ev.contentWindow.postMessage(Wa,Ja.a.Oaa(this.N1a))};t.g4b=function(Wa,mb,kc,Ab,Tb,ib,Sa,Mb){Ta.a.Vu?(ib=String.format("{0} {1} {2}",ib?"Shift":"",Sa?"Control":"",Mb?"Alt":""),ib.trim(),kc=document.createEvent("KeyboardEvent"),kc.initKeyboardEvent(Wa,Ab,Tb,window.self,mb,
0,ib,!1,"en-US")):(mb={},mb.keyCode=kc,mb.ctrlKey=Sa,mb.shiftKey=ib,mb.altKey=Mb,mb.bubbles=Ab,mb.cancelable=Tb,kc=new KeyboardEvent(Wa,mb));return kc};Qk.Object.defineProperties(t.prototype,{mKb:{configurable:!0,enumerable:!0,get:function(){return!0}},N1a:{configurable:!0,enumerable:!0,get:function(){return V.AFrameworkApplication.ga.Ua("EnrichmentPaneUrl")}}});t.vtf="about:blank";Object(y.a)(t,"EnrichmentPane",null,[682,2]);vm(w,t);w.prototype.fdb=function(){this.taskPane.isVisible||this.taskPane.Nf(!0)};
w.prototype.ydc=function(){this.taskPane.Nf(!1)};w.prototype.dispose=function(){this.taskPane&&(this.taskPane.qdj(Object(S.a)(this,this.$Zf,"setFocusOnIFrame")),this.taskPane=null);t.prototype.dispose.call(this)};Qk.Object.defineProperties(w.prototype,{MQa:{configurable:!0,enumerable:!0,get:function(){return this.taskPane.Kb},set:function(Wa){this.taskPane.Kb.innerHTML=Wa.innerHTML}}});Object(y.a)(w,"EnrichmentTaskPaneWrapper",t,[]);v.prototype.Pri=function(Wa,mb){this.By=Wa;this.ufa&&this.ufa.show(this,
mb,null)};v.prototype.kBc=function(Wa,mb){this.ufa&&this.ufa.kBc(Wa,mb)};v.prototype.Vwb=function(){this.ufa&&this.ufa.hide()};v.prototype.dispose=function(){this.ufa&&(this.ufa.dispose(),this.ufa=null)};v.prototype.selectEntity=function(Wa){return this.By?this.By.selectEntity(Wa):!1};v.prototype.searchEntity=function(Wa,mb){this.By&&this.By.searchEntity(Wa,mb)};v.prototype.MMd=function(Wa,mb,kc,Ab){this.By&&this.By.MMd(Wa,mb,kc,Ab)};v.prototype.YBb=function(Wa){return this.By?this.By.YBb(Wa):!1};
v.prototype.onPaneClosed=function(){if(this.By)this.By.onPaneClosed()};v.prototype.cancelSearch=function(){this.By&&this.By.cancelSearch()};v.prototype.selectDataType=function(Wa){this.By&&this.By.selectDataType(Wa)};v.prototype.showHelpArticle=function(Wa){this.By&&this.By.showHelpArticle(Wa)};v.prototype.showSurveyDialog=function(Wa){this.By&&this.By.showSurveyDialog(Wa)};v.prototype.insertTable=function(Wa,mb){this.By&&this.By.insertTable(Wa,mb)};Object(y.a)(v,"EnrichmentManager",null,[681,2]);
vm(f,v);f.prototype.dispose=function(){v.prototype.dispose.call(this)};Object(y.a)(f,"ExcelEnrichmentManager",v,[]);var xa=b(14);Object(y.a)(m,"FloodgateSurvey",null,[]);var ya=b(24),Ga=b(77),db=b(414),Ob=b(43),Ec=b(369),wb=b(164),kb=b(39),vb=b(92),Gb=b(27),Za=b(1),ub=b(272),fc=b(19);Object(y.a)(n,"EnrichmentMessageContentAppProperties",null,[]);l.prototype.dispose=function(){this.$&&(this.gridView.ha.lda(this.Xh),this.gridView.ot(this.LR))};l.prototype.selectEntity=function(Wa){function mb(){return new db.a}
var kc=this,Ab=Ob.o(this.gridView.ha.va.activeCell,this.$);Ec.a(this.$.userOperationManager,function(Tb,ib,Sa){var Mb=kc.$.na.ta;Tb=ub.b(Tb,kc.KSi);var Jc=Mb.Na(9,null);Jc.activeCell=Ab;Jc.selectionIndex=Wa;return pa.i(Mb,"SelectLinkedEntityForDisambiguation",Jc,Tb,ib,Sa,null,4)},function(Tb){return new wb.a(109,0,Tb,void 0,mb)},null);return!0};l.prototype.searchEntity=function(Wa,mb,kc,Ab,Tb){var ib=this;kc=void 0===kc?!1:kc;Ab=void 0===Ab?0:Ab;Tb=void 0===Tb?null:Tb;I.ULS.sendTraceTag(38846755,
0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",mb);var Sa=Ob.o(this.gridView.ha.va.activeCell,this.$);Ec.a(this.$.userOperationManager,function(Mb,Jc,Ib){var Nb=ib.$.na.ta,sa=ib.Hwa,Va=kc,Xb=Ab,mc=Tb;Mb=ub.b(Mb,ib.gDf);var od=Nb.Na(1,null);od.searchCell=Sa;od.searchQuery=Wa;od.isFloodgateEnabled=sa;od.isStarterData=Va;od.starterDataDomainId=Xb;od.starterDataDomainIdString=mc;return pa.i(Nb,"LinkedEntitySearch",od,Mb,Jc,Ib,null,4)},function(Mb){return new wb.a(110,
0,Mb,16)},null)};l.prototype.YBb=function(Wa){var mb=this,kc=Ob.o(this.gridView.ha.va.activeCell,this.$);this.Zbb=!1;Ec.a(this.$.userOperationManager,function(Ab,Tb,ib){var Sa=mb.$.na.ta;Ab=ub.b(Ab,mb.QPi);var Mb=Sa.Na(1,null);Mb.activeCell=kc;Mb.isBackward=Wa;return pa.i(Sa,"MoveToNextAmbiguousLinkedEntity",Mb,Ab,Tb,ib,null,4)},function(Ab){return new wb.a(111,0,Ab,16)},null);return!0};l.prototype.onPaneClosed=function(){this.Gta=!1;this.yIe=!0;this.$oc=0;this.xEb=!1};l.prototype.cancelSearch=function(){var Wa=
this,mb=this.fNd();mb&&Ec.a(this.$.userOperationManager,function(kc,Ab,Tb){var ib=Wa.$.na.ta;kc=ub.b(kc,Wa.gDf);var Sa=ib.Na(9,null);Sa.activeCell=mb;return pa.i(ib,"CancelSearchLinkedEntity",Sa,kc,Ab,Tb,null,4)},function(kc){return new wb.a(112,0,kc,16)},null)};l.prototype.selectDataType=function(Wa){I.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Jsa();if(Wa&&Wa.length)if(Wa=JSON.parse(Wa))if(null==Wa.domainId)I.ULS.sendTraceTag(537166946,
0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var mb={};mb.Id=Wa.domainId;mb.StringId=Wa.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(mb)}else I.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else I.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")};l.prototype.showHelpArticle=function(Wa){var mb=new vb.a(-859308420,Ga.a.dc,this.$.hd,
9,null),kc={};Wa=(kc[Ga.a.Tg]="HelpID="+Wa,kc.InputMethod=Ga.a.dc,kc.ShouldCanvasTakeFocus=!0,kc[Ga.a.nd]=da.a.JZ,kc);this.$.Ka.Yb(mb,Wa)};l.prototype.showSurveyDialog=function(Wa){ca.a.YKb(new m(Wa))};l.prototype.insertTable=function(Wa,mb){var kc=this,Ab=this.fNd();Ab&&Ec.a(this.$.userOperationManager,function(Tb,ib,Sa){var Mb=kc.$.na.ta;Tb=ub.b(Tb,kc.sOi);var Jc=Mb.Na(1,null);Jc.cell=Ab;Jc.starterDataDomainId=Wa;Jc.starterDataDomainIdString=mb;return pa.i(Mb,"InsertStarterDataTable",Jc,Tb,ib,Sa,
null,4)},function(Tb){return new wb.a(259,0,Tb,1)},null)};l.prototype.Ssd=function(Wa){this.launchOrCloseDisambiguationPane(Wa)};l.prototype.launchDisambiguationPaneForSearch=function(){var Wa=this;I.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");var mb=this.vnj();mb&&Ec.a(this.$.userOperationManager,function(kc,Ab,Tb){return r(Wa.$.na.ta,mb,!0,Wa.Hwa,!1,null,ub.b(kc,Wa.hMi),Ab,Tb,1)},function(kc){return new wb.a(114,
0,kc,16)},null)};l.prototype.launchLinkedEntityDataTypeSelectorPane=function(Wa,mb){var kc=this;Ec.a(this.$.userOperationManager,function(Ab,Tb,ib){var Sa=kc.$.na.ta;Ab=ub.b(Ab,kc.Umc);var Mb=Sa.Na(1,null);Mb.selectedRanges=Wa;Mb.letyDomainId=mb;return pa.i(Sa,"GetDataTypeSelectorData",Mb,Ab,Tb,ib,2,4)},function(Ab){return new wb.a(233,0,Ab,16)},null)};l.prototype.Jri=function(Wa,mb){var kc=this;Wa&&Ec.a(this.$.userOperationManager,function(Ab,Tb,ib){return r(kc.$.na.ta,Wa,!1,!1,!0,mb,ub.b(Ab,kc.Umc),
Tb,ib,2)},function(Ab){return new wb.a(257,0,Ab,16)},null)};l.prototype.KJi=function(Wa){Gb.a.lh(Wa.Errors)?(Wa=Gb.a.Uc(Wa.Errors),Wa.includes("OperationSucceededWithAlert")?I.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):I.ULS.sendTraceTag(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",Wa)):Wa.Result&&(this.$.ea.kk(this.dd),this.$.ea.Tj(this.dd),Wa=Wa.Result,this.rdb=Wa.SkydanceFeatureBitmask,this.Lwd(Wa),this.vKb=!0)};l.prototype.$_f=function(Wa){Wa&&
(this.$oc=Wa)};l.prototype.Ykf=function(Wa){if(Za.EwaSettings.la(680)){var mb=new vb.a(-90814711,Ga.a.dc,0,10,null);this.$.Ka.Yb(mb,null)}this.Gta?this.B7b.kBc(Wa,null):(mb=3,null!=this.rdb?mb=this.rdb:I.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Wa=this.DPh(Wa,mb))||I.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.sMe||I.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.B7b.Pri(this.sMe,
Wa),this.Gta=!0)};l.prototype.Jsa=function(){this.Gta&&(I.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.B7b.Vwb(),this.Gta=!1,this.$oc=0,this.xEb=!1)};l.prototype.Lwd=function(Wa){var mb=Wa.Row+1;Wa=Wa.Column+1;0>mb||0>Wa?(I.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Jsa(),this.$.ea.kk(this.dd)):(mb=new ya.Range(mb,Wa,mb,Wa,!0,!1),this.gridView.ha.updateSelection(mb,
mb,60),this.Zbb=!0)};l.prototype.DPh=function(Wa,mb){var kc=new n;kc.applicationVersion=V.AFrameworkApplication.buildVersion;kc.applicationName="ExcelWac";kc.anid="00000000-0000-0000-0000-000000000000";kc.sessionId=V.AFrameworkApplication.userSessionId;kc.appCorrelationId=ia.a.create().toString();var Ab=ea.a.$J(V.AFrameworkApplication.lcid);Ab=Ab?Ab.name:null;kc.uiLanguage=Ab;kc.market=this.sac(Ab);kc.themeId=0;kc.disambiguationJson=Wa;mb<=qa.a.PS?kc.featuresBitMask=mb:I.ULS.sendTraceTag(537166932,
0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return kc};l.prototype.sac=function(Wa){Wa=Wa.split("-");return Wa[Wa.length-1]};l.prototype.launchOrCloseDisambiguationPane=function(Wa){var mb=this,kc=this.gridView.ha.va.activeCell;if(this.fNd()&&kc)if(this.gridView.Sb.cfc(kc)){if((!this.yIe||Wa||this.vKb)&&!this.gridView.isEditing){Wa&&(this.Zbb=!0);var Ab=Ob.q(kc,this.$);Ec.a(this.$.userOperationManager,function(Tb,ib,Sa){return r(mb.$.na.ta,Ab,!1,mb.Hwa,!1,
null,ub.b(Tb,mb.Umc),ib,Sa,1)},function(Tb){return new wb.a(114,0,Tb,16)},null)}}else this.Jsa();else this.Jsa()};l.prototype.A8i=function(){var Wa=this;if(this.Gta){var mb=this.gridView.ha.va.activeCell;if(mb){var kc=Ob.q(mb,this.$);Ec.a(this.$.userOperationManager,function(Ab,Tb,ib){return r(Wa.$.na.ta,kc,!1,Wa.Hwa,!1,null,ub.b(Ab,Wa.Umc),Tb,ib,1)},function(Ab){return new wb.a(114,0,Ab,16)},null)}else this.Jsa()}};l.prototype.fNd=function(){var Wa=this.gridView.ha.va;return Wa.exa()?Ob.o(Wa.activeCell,
this.$):null};l.prototype.vnj=function(){var Wa=this.gridView.ha.va;return Wa.exa()?Ob.q(Wa.activeCell,this.$):null};Object(y.a)(l,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var $a=b(844),nb=b(1364),sc=b(53),rd=b(835);d.prototype.$Hh=function(Wa,mb){return this.ZHh(Wa,mb).$B()};d.prototype.ZHh=function(Wa,mb){mb=this.Sa.Kp(mb);if(Wa&&0<Wa.length){var kc=this.Sa.Nc();mb.Ac.push(kc);var Ab=this.Sa.EA("ConvertToLinkedEntitySeeMore",this.rtd,this.qtd);Wa=yl(Wa);for(var Tb=Wa.next();!Tb.done;Tb=
Wa.next())if(Tb=Tb.value,!Tb.DomainId.StringId&&!Tb.DomainBlocked&&Tb.ShowInRibbon){var ib=Tb.DomainId.Id.toString();Ab.gmd(0,"Data.ConvertToLinkedEntityMenuItem_"+ib,-1203788282,"QueryLinkedEntityGalleryIcon",Tb.Description,ib,this.X8h(Tb.Name))}Array.add(kc.buttons,Ab)}mb.Ac.length||I.ULS.sendTraceTag(537166722,0,15,"No domain data available");return mb};d.prototype.aIh=function(Wa,mb){var kc=b(887).ConvertToLinkedEntityManager;this.OSj();mb=this.Sa.Kp(mb).$B();for(var Ab=0,Tb=0,ib=!1,Sa=yl(Wa.Categories),
Mb=Sa.next();!Mb.done;Mb=Sa.next()){if(Mb=this.EIh(Mb.value,Ab))this.dxa&&Tb===kc.S7a&&(ib=!0),Array.add(mb.MenuSectionList,Mb),++Ab;++Tb}this.dxa&&ib&&Ab<=kc.ulf&&Array.removeAt(mb.MenuSectionList,kc.S7a);kc=this.Sa.Nc().u0b();Ab=sc.a.Fe(11);Wa=yl(Wa.LongButtons);for(Tb=Wa.next();!Tb.done;Tb=Wa.next())Tb=Tb.value,this.convertToLinkedEntityManager.Azj(Tb)&&this.ICg(kc,Tb,Ab);0<kc.ControlList.length&&Array.add(mb.MenuSectionList,kc);return mb};d.prototype.ICg=function(Wa,mb,kc){if(mb){var Ab="Data.ConvertToLinkedEntityMenuItem_"+
mb.Name,Tb=this.convertToLinkedEntityManager.CQ(mb.DomainId);Tb&&(mb=Object.assign(new $a.a,{Id:Ab,ExternalId:Ab,Command:"-1662108744",LabelText:mb.Name,Alt:mb.SuperTip,Visible:!0,MenuItemId:b(887).ConvertToLinkedEntityManager.v1a(mb.DomainId),Image16by16:kc,Image16by16Class:this.A9h(Tb.FontLocator)}),Array.add(Wa.ControlList,mb))}};d.prototype.yIh=function(Wa,mb){var kc={};kc=(kc.width=24,kc["min-width"]=24,kc.height=24,kc);var Ab={};return Object.assign(new nb.a,{Id:b(887).ConvertToLinkedEntityManager.nKe+
Wa.toString(),ExternalId:b(887).ConvertToLinkedEntityManager.nKe+Wa.toString(),MenuItemId:b(887).ConvertToLinkedEntityManager.E7c+Wa.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.q$e(mb.FontLocator),LabelText:mb.Name,PreviewIconStyle:(Ab.root=kc,Ab),Alt:this.ded(mb)})};d.prototype.aNg=function(Wa){switch(Wa){case "Animal":return rd.a.xJg;case "Apple":return rd.a.vKg;case "Atom":return rd.a.VLg;case "Beaker":return rd.a.XNg;case "Bridge":return rd.a.wPg;
case "Cat":return rd.a.DVg;case "City":return rd.a.PXg;case "Constellation":return rd.a.L1g;case "Dog":return rd.a.Khh;case "Finance":return rd.a.MNg;case "GradCap":return rd.a.v2h;case "HumanAnatomy":return rd.a.M8h;case "LocationPointer":return rd.a.kui;case "Map":return rd.a.sWi;case "MedicineNeedle":return rd.a.tAi;case "Mountain":return rd.a.bCi;case "Movie":return rd.a.vCi;case "Music":return rd.a.JCi;case "OuterSpace":return rd.a.ZWi;case "Planet":return rd.a.WZi;case "Satellite":return rd.a.Okj;
case "WolframGeneric":return rd.a.Ljj;default:return rd.a.w3g}};d.prototype.A9h=function(Wa){if("PowerBIRibbon"!==Wa)return K.a.V9c;switch(Wa){case "AnimalRibbon":return K.a.nvh;case "AppleRibbon":return K.a.ovh;case "AtomRibbon":return K.a.pvh;case "BeakerRibbon":return K.a.qvh;case "BridgeRibbon":return K.a.rvh;case "CenterMapRibbon":return K.a.svh;case "CityRibbon":return K.a.tvh;case "CurrencyRibbon":return K.a.uvh;case "ExerciseRibbon":return K.a.vvh;case "FinanceRibbon":return K.a.LQe;case "FirstAidRibbon":return K.a.wvh;
case "GlobeLightningRibbon":return K.a.xvh;case "GradCapRibbon":return K.a.yvh;case "HumanAnatomyRibbon":return K.a.zvh;case "LeafRibbon":return K.a.Avh;case "LocationPointerRibbon":return K.a.Cvh;case "MapRibbon":return K.a.JQe;case "MountainRibbon":return K.a.Dvh;case "MovieRibbon":return K.a.Evh;case "MusicRibbon":return K.a.Fvh;case "NotablePeopleRibbon":return K.a.Gvh;case "OuterSpaceRibbon":return K.a.Hvh;case "PartlySunnyWeatherRibbon":return K.a.Ivh;case "PowerBIRibbon":return K.a.KQe;case "SatelliteRibbon":return K.a.Jvh;
case "WolframGenericRibbon":return K.a.Bvh;case "YogaRibbon":return K.a.Lvh;default:return K.a.IQe}};d.prototype.q$e=function(Wa){switch(Wa){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";
case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";
case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";
case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}};d.prototype.EIh=function(Wa,mb){mb=this.Sa.EA("ConvertToLinkedEntitySection_"+mb,this.rtd,this.qtd);for(var kc=!1,Ab=yl(Wa.DomainIds),Tb=Ab.next();!Tb.done;Tb=Ab.next()){var ib=Tb.value;(Tb=this.convertToLinkedEntityManager.CQ(ib))&&!Tb.DomainBlocked&&Tb.ShowInRibbon&&(kc=Tb.Name,ib=b(887).ConvertToLinkedEntityManager.v1a(ib),mb.At("Data.ConvertToLinkedEntityMenuItem_"+ib,-1203788282,"QueryLinkedEntityGalleryIcon",
void 0,ib,this.q$e(Tb.FontLocator),void 0,void 0,this.ded(Tb),kc),kc=!0)}if(!kc)return null;mb=mb.r0b(!0);Ab=this.Sa.Nc();Ab.title=Wa.Name;Wa=Ab.u0b();Array.add(Wa.ControlList,mb);return Wa};d.prototype.X8h=function(Wa){return"Stocks"===Wa?"Bank_32":"Geography"===Wa?"OpenMap_32":"ConvertToEntity_32"};d.prototype.OSj=function(){this.rtd=5;this.qtd="Size112by64"};d.prototype.ded=function(Wa){return Wa.RibbonTooltipHeader?Wa.RibbonTooltipHeader+"\n\n"+Wa.RibbonTooltip:Wa.RibbonTooltip};Object(y.a)(d,
"ConvertToLinkedEntityMenuRenderer",null,[655]);var $b=b(54),Wb=b(114),lc=b(176),Oa=b(75);c.prototype.mXh=function(){this.ujd||(I.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),pa.T(this.$.na.ta,0,this.sRi,this.OCf,null,null))};c.prototype.vhg=function(Wa){Wa&&Wa.length?this.ujd?(Wa=this.kpj(Wa))?(I.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
pa.pb(this.$.na.ta,0,Wa,this.SVi,this.OCf,null,null)):I.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.sjd=!0:I.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")};c.prototype.kpj=function(Wa){if(!Wa||!Wa.length)return I.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var mb=
[];Wa=yl(Wa);for(var kc=Wa.next();!kc.done;kc=Wa.next()){kc=kc.value;var Ab={};Ab.Id=kc.Id;kc.StringId&&(Ab.StringId=kc.StringId);mb.push(Ab)}mb="<DataTypes>"+$b.a.Lc(mb)+"</DataTypes>";return 1906<mb.length?(I.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):mb};c.prototype.oYi=function(Wa){if(!Wa)return I.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),
null;if(!Wa.startsWith("<DataTypes>")||!Wa.endsWith("</DataTypes>"))return I.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Wa=Wa.substring(11,Wa.length-12);if(!Wa)return I.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;var mb=[];try{mb=$b.a.oi(Wa)}catch(kc){return I.ULS.sendTraceTag(537166682,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",
kc.message),null}I.ULS.sendTraceTag(537166681,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",mb.length);return mb};c.prototype.UAi=function(Wa){var mb=this.Uza.mGb,kc=this.Uza.D7i;if(mb.length!==kc){for(var Ab=0;Ab<Wa.length&&mb.length<kc;++Ab){var Tb=Wa[Ab];this.Uza.CQ(Tb)&&!Array.contains(mb,Tb)&&mb.push(Tb)}this.Uza.mGb=mb}};Object(y.a)(c,"LinkedDataTypeRoamingHandler",null,[]);var qb=b(521),Ub=b(57),jc=b(56),Kb=b(249),dc=b(35),Qb=b(44),O=b(26),Ba=b(303),ra=b(8),ta=b(20),Fa=b(100);
b.d(F,"ConvertToLinkedEntityManager",function(){return a});var cb=T.a;vm(a,cb);a.prototype.dispose=function(){(this.Uyb||this.$5a||this.M6a)&&this.$.ea.Dw(this.Mf);Za.EwaSettings.la(680)&&this.$.ea.kk(this.dd);!this.c$&&Za.EwaSettings.la(131)&&Za.EwaSettings.la(139)&&this.gridView.ot(this.onContentReady);this.Zm&&this.Zm.dispose();this.bxa&&this.$.kD(this.dj);this.$.ol(this.ud);this.$5a&&(this.Lmd=null);z.a.Fa(this.Yya)};a.prototype.LFg=function(Wa){this.addHandler("LinkedEntityConverted",Wa)};a.prototype.Ycj=
function(Wa){this.removeHandler("LinkedEntityConverted",Wa)};a.prototype.selectEntity=function(Wa){return this.Zm?this.Zm.selectEntity(Wa):!1};a.prototype.searchEntity=function(Wa,mb){this.Zm&&this.Zm.searchEntity(Wa,mb)};a.prototype.MMd=function(Wa,mb,kc,Ab){this.Zm&&this.Zm.searchEntity(Wa,mb,!0,kc,Ab)};a.prototype.YBb=function(Wa){return this.Zm?this.Zm.YBb(Wa):!1};a.prototype.onPaneClosed=function(){if(this.Zm)this.Zm.onPaneClosed()};a.prototype.cancelSearch=function(){this.Zm&&this.Zm.cancelSearch()};
a.prototype.selectDataType=function(Wa){this.Zm&&this.Zm.selectDataType(Wa)};a.prototype.showHelpArticle=function(Wa){this.Zm&&this.Zm.showHelpArticle(Wa)};a.prototype.showSurveyDialog=function(Wa){this.Zm&&this.Zm.showSurveyDialog(Wa)};a.prototype.insertTable=function(Wa,mb){this.Zm&&this.Zm.insertTable(Wa,mb)};a.prototype.r5h=function(Wa){if(this.$.isEditMode&&this.LUf!==Wa&&V.AFrameworkApplication.ga.ra("SupportsPolicies")){this.LUf=Wa;I.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");
Wa=this.$.na.ta;var mb=this.gNi,kc=Wa.Na(1,null);pa.i(Wa,"GetRichDataClassificationLabels",kc,mb,null,null,null,4)}};a.prototype.tLe=function(){function Wa(kc,Ab,Tb){var ib=mb.$.na.ta;kc=ub.b(kc,mb.PKi);var Sa=ib.Na(1,null);return pa.i(ib,"LinkedEntitiesEnableUntrustedImages",Sa,kc,Ab,Tb,null,0)}var mb=this;Za.EwaSettings.tc()?this.$.userOperationManager.ic(new wb.a(589,0,Wa,80),null):this.$.userOperationManager.ic(new qb.a(589,0,Wa,16),null)};a.prototype.showUntrustedImageBusinessBarIfNecessary=
function(){this.EXd||this.Hcg||!this.$.ea.rc||this.qoj()};a.prototype.qoj=function(){function Wa(kc,Ab,Tb){var ib=mb.$.na.ta;kc=ub.b(kc,mb.BMi);var Sa=ib.Na(1,null);return pa.i(ib,"GetHasUntrustedImageUrls",Sa,kc,Ab,Tb,null,4)}var mb=this;Za.EwaSettings.tc()?this.$.userOperationManager.ic(new wb.a(588,0,Wa,80),null):this.$.userOperationManager.ic(new qb.a(588,0,Wa,16),null)};a.prototype.RWd=function(Wa){var mb=this;if(this.$5a&&null==this.Lmd&&!this.M6a&&V.AFrameworkApplication.ga.ra("SupportsPolicies")&&
null!=this.uMa&&this.uMa&&(!Wa||this.$.workbookContext.Options&262144)){var kc=jc.GetServiceTaskFactory.Wa(this.$.da,274,275,0);dc.TaskExtensions.Ba(kc,function(){mb.Lmd=kc.result.zOf(2)},this.$.ma,3)}};a.prototype.x3g=function(Wa){(Wa=this.Ohh(Wa))?this.convertToLinkedEntity(Wa):I.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")};a.prototype.convertToLinkedEntity=function(Wa){I.ULS.sendTraceTag(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",
Wa.Id);if(this.gridView){var mb=this.gridView.ha.va.Td,kc=mb.zf(this.gridView.lH);this.dxa&&this.Umd&&this.tDg(Wa);if(kc){kc=this.gridView.Sb.ohc(kc);if(!this.R7e(Wa)&&this.xgf(Wa.Id)){I.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Ub.a.Rf.nR){mb=this.ydd();if(!mb){I.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}kc=this.R3b();if(!kc){I.ULS.sendTraceTag(537166916,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}var Ab={};Ab=(Ab.InputMethod=Ga.a.dc,Ab);Ab.CalloutName=3;Ab.Target=mb;Ab.RibbonButtonLabel=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.BUf(Wa):this.cAb(Wa.Id.toString());Ab.ExampleEntities=this.GRe(Wa);this.$.Ka.Yb(kc,Ab);return}I.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.xgf(Wa.Id)&&
!Wa.StringId)this.launchLinkedEntityDataTypeSelectorPane(a.v1a(Wa));else{if(kc){I.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.qIj(Wa)){mb=Ob.r(this.gridView.ha.va.selectedRanges,this.$);this.Zm.Jri(mb,Wa);return}if(Ub.a.Rf.nR){mb=this.ydd();if(!mb){I.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}kc=this.R3b();if(!kc){I.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}Ab={};Ab=(Ab.InputMethod=Ga.a.dc,Ab);Ab.CalloutName=2;Ab.Target=mb;Ab.RibbonButtonLabel=this.BUf(Wa);Ab.ExampleEntities=this.GRe(Wa);Ab.BlankCellResourceId=this.zOg(Wa);Ab.HasBlankCellWalkthrough=this.e6h(Wa);Ab.ServiceDomain=Wa.Id;this.$.Ka.Yb(kc,Ab);return}I.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.M2c(Wa,
!1,mb)}}}else I.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")};a.prototype.convertToLinkedEntityFromAutoDetect=function(){this.c$&&this.c$.qHa()};a.prototype.onAutoDetectUIShown=function(){function Wa(kc,Ab,Tb){var ib=mb.$.na.ta,Sa=ib.Na(1,null);return pa.i(ib,"OnAutoDetectUIShown",Sa,kc,Ab,Tb,null,4)}var mb=this;Za.EwaSettings.tc()?Ec.a(this.$.userOperationManager,Wa,function(kc){return new wb.a(230,0,kc,80)},null):Ec.a(this.$.userOperationManager,Wa,function(kc){return new qb.a(230,
0,kc,16)},null)};a.prototype.M2c=function(Wa,mb,kc){function Ab(){return new db.a}var Tb=this,ib=Ob.q(kc,this.$);Ec.a(this.$.userOperationManager,function(Sa,Mb,Jc){var Ib=Tb.$.na.ta;Sa=ub.b(Sa,Tb.LJi,Tb.QTi,Object(S.a)(Tb.Zm,Tb.Zm.KJi,"onConvertToLinkedEntitySucceeded"));var Nb=Ib.Na(1,null);Nb.selectedRanges=ib;Nb.domainId=Wa;Nb.autodetect=mb;return pa.i(Ib,"ConvertToLinkedEntity",Nb,Sa,Mb,Jc,null,4)},function(Sa){return new wb.a(115,0,Sa,void 0,Ab)},null)};a.prototype.tDg=function(Wa){if(this.dxa&&
this.Umd){var mb={};mb.Id=Wa.Id;Wa.StringId&&(mb.StringId=Wa.StringId);if(!(0<this.yK.length&&this.yK[0].Id===mb.Id&&this.yK[0].StringId===mb.StringId)){Wa=!1;Array.insert(this.yK,0,mb);for(var kc=1;kc<this.yK.length;++kc)if(this.yK[kc].Id===mb.Id&&this.yK[kc].StringId===mb.StringId){Array.removeAt(this.yK,kc);Wa=!0;break}for(;5<this.yK.length;)Array.removeAt(this.yK,this.yK.length-1);this.Qba.Categories[a.S7a].DomainIds=this.yK;this.BTf();this.Vpd&&!Wa&&this.MLd.vhg(this.yK)}}};a.prototype.convertLinkedEntityToText=
function(){var Wa=this;I.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var mb=Ob.q(this.gridView.ha.va.Td,this.$);Ec.a(this.$.userOperationManager,function(kc,Ab,Tb){var ib=Wa.$.na.ta,Sa=ib.Na(1,null);Sa.selectedRanges=mb;return pa.i(ib,"ConvertLinkedEntityToText",Sa,kc,Ab,Tb,null,4)},function(kc){return new wb.a(116,0,kc)},null)}else I.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")};a.prototype.refreshLinkedEntitiesInRange=
function(){var Wa=this;I.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(fc.g(this.$)){this.$.isEditMode||I.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.IId();var mb=Ob.r(this.gridView.ha.va.selectedRanges,this.$);Ec.a(this.$.userOperationManager,function(kc,Ab,Tb){var ib=Wa.$.na.ta,Sa=ib.Na(1,null);Sa.selectedRanges=mb;return pa.i(ib,
"RefreshLinkedEntitiesInRange",Sa,kc,Ab,Tb,null,4)},function(kc){return new wb.a(248,0,kc)},null)}else I.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")};a.prototype.pyj=function(){return this.C2f(this.w2a)};a.prototype.oyj=function(){return this.C2f(this.e3a)};a.prototype.C2f=function(Wa){try{if(2===this.qr&&Wa){var mb=this.g7c(parseInt(Wa,10));return!mb||!mb.ShowInRibbon}}catch(kc){I.ULS.sendTraceTag(537166875,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+
Wa)}return!0};a.prototype.Azj=function(Wa){Wa=this.CQ(Wa.DomainId);if(!Wa||Wa.DomainBlocked||Za.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!Wa.HasCuratedData)return!1;if(this.yki){for(var mb=yl(this.KM),kc=mb.next();!kc.done;kc=mb.next())if(kc=kc.value,kc.value.DomainId.Id===Wa.DomainId.Id&&kc.value.ShowInRibbon)return!0;return!1}return Wa.ShowInRibbon};a.prototype.lyj=function(Wa){return 2!==this.qr||!this.zia[Wa]};a.prototype.nyj=function(){if(this.bxa)return I.ULS.sendTraceTag(537166874,
0,10,"Unexpectedly calling ShouldHideFlyout for new gallery design"),!1;if(!this.KM)return!0;if(null!=this.K0b)return this.K0b;for(var Wa=0,mb=yl(this.KM),kc=mb.next();!kc.done;kc=mb.next())kc.value.value.DomainBlocked||++Wa;return this.K0b=2>=Wa};a.prototype.launchDisambiguationPaneForSearch=function(){this.Zm&&this.Zm.launchDisambiguationPaneForSearch()};a.prototype.gd=function(Wa,mb,kc){if("PopulateConvertToLinkedEntityMenu"!==mb)return!1;this.scd=kc.MenuId;if(0===this.qr||3===this.qr)return this.v_i(),
!0;if(this.bxa)if(this.Qba){if(this.KM)return this.wM=this.wM||this.PNa.aIh(this.Qba,kc.MenuId),kc.MenuItems=this.wM,this.Umd=!0;I.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection")}else I.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info");this.wM=this.wM||this.PNa.$Hh(this.yxa,kc.MenuId);kc.MenuItems=this.wM;return!0};a.prototype.v_i=function(){var Wa=this;-1===this.Wcc&&(this.G$a(),this.Wcc=window.setInterval(function(){Wa.G$a()},
2E3))};a.prototype.G$a=function(){if(this.$.ea.rc&&2!==this.qr)if(this.LKa--,I.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.qr=1,this.bxa){var Wa=this.$.na.ta,mb=this.Nyf,kc=this.Myf,Ab=Wa.Na(1,null);pa.i(Wa,"GetLinkedEntityMetadata",Ab,mb,kc,null,null,4)}else Wa=this.$.na.ta,mb=this.Nyf,kc=this.Myf,Ab=Wa.Na(1,null),pa.i(Wa,"GetLinkedEntityServiceDomains",Ab,mb,kc,null,null,4)};a.prototype.Knd=function(){return this.$.isEditMode&&
2!==this.qr&&(0<=this.LKa||!this.aPa)};a.prototype.pYd=function(Wa){V.AFrameworkApplication.Hg?I.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):fa.a(this.$)?(this.hYd(),Wa&&this.$.If()):I.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")};a.prototype.vhj=function(){this.mwb=this.wCb=0;this.LKa=8;this.aPa=!1;this.qr=this.Wcc=0;this.yxa=this.Qba=null;this.S1b();for(var Wa=0;Wa<this.NNa;++Wa)this.zia[Wa]=
null;kb.a.Vyb()&&this.lyb()&&this.pYd(!0)};a.prototype.S1b=function(){this.wM=null};a.prototype.lyb=function(){var Wa=da.a.eGb,mb=fa.a(this.$);return!!mb&&mb.Hm.Co===Wa};a.prototype.udg=function(){if(this.Qba){var Wa=0;if(this.dxa){var mb=-1,kc=-1,Ab=0,Tb=0,ib=0,Sa=0,Mb=[null,null,null,null,null],Jc=yl(this.Qba.Categories);for(sa=Jc.next();!sa.done;sa=Jc.next()){var Ib=!1;sa=yl(sa.value.DomainIds);for(Va=sa.next();!Va.done;Va=sa.next()){Va=Va.value;var Nb=this.CQ(Va);Nb&&!Nb.DomainBlocked&&Nb.ShowInRibbon&&
(Wa<this.NNa?(this.zia[Wa]=Va,Tb===a.S7a&&(-1===mb&&(mb=Wa),kc=Wa,Sa=kc-mb+1),++Wa):Wa===this.NNa&&Ab<Sa&&Tb!==a.S7a&&(Mb[Ab]=Va,++Ab),Ib=!0)}Ib&&++ib;++Tb}if(-1<mb&&ib<=a.ulf){for(;kc>=mb;--kc)Array.removeAt(this.zia,kc);for(mb=0;mb<Sa;++mb)Array.insert(this.zia,Wa+mb,Mb[mb])}}else{Sa=yl(this.Qba.Categories);for(var sa=Sa.next();!sa.done;sa=Sa.next()){Mb=yl(sa.value.DomainIds);for(var Va=Mb.next();!Va.done&&!(mb=Va.value,(kc=this.CQ(mb))&&!kc.DomainBlocked&&kc.ShowInRibbon&&(this.zia[Wa]=mb,++Wa,
Wa>=this.NNa));Va=Mb.next());if(Wa>=this.NNa)break}}for(;Wa<this.NNa;)this.zia[Wa]=null,++Wa}};a.prototype.rbg=function(){var Wa=Object(H.a)(542,fc.g(this.$).Ca),mb=this.gridView.ha.We;return Wa&&Wa.djd&&1===mb&&this.gridView.ha.va.activeCell?(Wa=jc.GetServiceTaskFactory.Wa(this.$.da,12,477,1),this.c$=new W.a(this.$,this.svgIconProvider,Wa.result,this),!0):!1};a.prototype.Mri=function(){this.Zm&&this.Zm.Ssd(!0)};a.prototype.launchLinkedEntityDataTypeSelectorPane=function(Wa){if(this.Zm)if(Wa=this.h7c(Wa))if(Wa.DomainId.StringId)I.ULS.sendTraceTag(537166855,
0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var mb=Ob.r(this.gridView.ha.va.selectedRanges,this.$);this.Zm.launchLinkedEntityDataTypeSelectorPane(mb,Wa.DomainId.Id)}else I.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")};a.prototype.Q1g=function(){return this.q2c(this.w2a)};a.prototype.P1g=function(){return this.q2c(this.e3a)};a.prototype.q2c=function(Wa){var mb=this.z9h(Wa),kc=U.a.Lf(this.cAb(Wa));Wa=U.a.Lf(this.WVd(Wa));
return a.EHh(mb,sc.a.Fe(11),kc,Wa)};a.prototype.WVd=function(Wa){try{return this.g7c(parseInt(Wa,10)).Description}catch(mb){}return xa.a.instance.fa(1747)};a.prototype.cAb=function(Wa){try{return this.g7c(parseInt(Wa,10)).Name}catch(mb){}return xa.a.instance.fa(1733)};a.prototype.BUf=function(Wa){try{return this.CQ(Wa).Name}catch(mb){}return this.cAb(Wa.Id.toString())};a.prototype.zOg=function(Wa){try{return this.CQ(Wa).BlankCellResourceId}catch(mb){}return null};a.prototype.e6h=function(Wa){try{return this.CQ(Wa).HasBlankCellWalkthrough}catch(mb){}return!1};
a.prototype.R7e=function(Wa){try{var mb=a.v1a(Wa);if(this.KM.xb(mb))return this.KM.oa(mb).HasCuratedData}catch(kc){}return!1};a.prototype.qIj=function(Wa){try{return this.CQ(Wa).SupportsStarterData}catch(mb){}return!1};a.prototype.xgf=function(Wa){return 268435968===Wa};a.prototype.ydd=function(){return 2===fa.a(this.$).XW?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"};a.prototype.R3b=function(){return new vb.a(-847286761,Ga.a.dc,this.$.hd,0,da.a.d0)};a.prototype.kEe=function(){if(this.lyb()&&
!this.Knd()&&!this.mef&&Za.EwaSettings.la(457)&&this.R7e({Id:268435968,StringId:null}))if(I.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),Ub.a.Rf.nR){var Wa=this.ydd();if(Wa){var mb=this.R3b();if(mb){var kc={};kc=(kc.InputMethod=Ga.a.dc,kc);kc.CalloutName=6;kc.Target=Wa;kc.ShouldCanvasTakeFocus=!0;this.$.Ka.Yb(mb,kc);this.mef=!0}else I.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else I.ULS.sendTraceTag(537166818,
0,10,"CalloutAnchorElement is null for firstOrgData")}else I.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")};a.prototype.V8h=function(Wa){Wa=this.h7c(Wa);return Wa?this.PNa.aNg(Wa.SubdomainFontLocator):(I.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)};a.prototype.rfc=
function(Wa){return this.c$?this.c$.$Mg(Wa):!1};a.prototype.EKh=function(){return this.c$?this.c$.vLh():""};a.prototype.Ufi=function(){return this.c$?this.c$.HAb:!1};a.prototype.mPh=function(Wa,mb){var kc=this.caf(Wa);if(0>kc)I.ULS.sendTraceTag(537166813,0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",Wa);else if(Wa=(Wa=this.zJe(Wa))?this.CQ(Wa):null)mb[Q.a.GalleryButtonProps]=this.PNa.yIh(kc,Wa),mb[Q.a.Alt]=this.PNa.ded(Wa)};a.prototype.BTf=function(){this.udg();kb.a.Vyb()&&
this.lyb()&&this.pYd(!0);this.S1b()};a.prototype.z9h=function(Wa){return Wa===this.w2a?K.a.LQe:Wa===this.e3a?K.a.JQe:K.a.IQe};a.prototype.GRe=function(Wa){try{return this.CQ(Wa).ExampleEntities}catch(mb){}return xa.a.instance.fa(1755)};a.prototype.rrc=function(){(0>this.LKa||this.aPa)&&I.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.qr||0>this.LKa||this.aPa)&&window.clearInterval(this.Wcc);kb.a.Vyb()&&!this.Knd()?this.pYd(this.lyb()):
this.scd&&this.$.frame.Ow(this.scd)};a.prototype.Xb=function(Wa){return this.$.Jb+Wa};a.prototype.hYd=function(){if(this.bxa){var Wa=!0,mb=Array(this.NNa),kc=fa.a(this.$)?fa.a(this.$).Hm:null;if(kc){for(var Ab=0;Ab<mb.length;++Ab)this.lyj(Ab)?mb[Ab]=!0:Wa=mb[Ab]=!1;kc.MJb(["ConvertToLinkedEntityGallery"],Wa);if(!Wa)for(Wa=0;Wa<mb.length;++Wa)mb[Wa]&&kc.MJb([this.lPh(Wa)],!0)}else I.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}else mb=
this.pyj(),kc=this.oyj(),Wa=mb&&kc,this.lub||this.yLb||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToLinkedEntityGallery",Wa?!0:!1)),Wa?this.lub=this.yLb=!0:(mb?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToStockLinkedEntity",!0)),this.yLb=!0):kc&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToGeographyLinkedEntity",!0)),this.lub=!0),this.nyj()&&ra.HelperMethods.Jjd("ConvertToLinkedEntityGallery-previewExpandButton"))};
a.prototype.CQ=function(Wa){var mb=a.v1a(Wa);if(this.KM.xb(mb))return this.KM.oa(mb);I.ULS.sendTraceTag(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",Wa.Id,!!Wa.StringId);return null};a.prototype.lPh=function(Wa){return"ConvertToLinkedEntityPreview"+Wa.toString()};a.prototype.iYd=function(){var Wa=this;la.a.get_instance().jl(10,function(){Wa.kEe();Wa.JZc&&Wa.yff&&Kb.b(Wa.Vkf,Wa.$.ma,500)});kb.a.Vyb()||la.a.get_instance().jl(10,function(){Wa.hYd()})};a.prototype.Kcc=function(Wa,
mb){switch(Wa){case "QueryLinkedEntityGalleryButtons":if(!mb[Q.a.InnerHTML]){kb.a.Vyb()||this.hYd();Wa=mb[Ga.a.nd].toString();var kc=ta.a.equals(Wa,xa.a.instance.fa(1750),!0)||ta.a.equals(Wa,xa.a.instance.fa(1751),!0),Ab=ta.a.equals(Wa,xa.a.instance.fa(1752),!0);Za.EwaSettings.la(459)?kc||Ab||this.mPh(Wa,mb):!this.yLb&&kc?(this.yLb=!0,mb[Q.a.InnerHTML]=this.Q1g()):!this.lub&&Ab&&(this.lub=!0,mb[Q.a.InnerHTML]=this.P1g())}break;case "QueryLinkedEntityMenuGalleryButtons":mb[Q.a.InnerHTML]||(mb[Q.a.InnerHTML]=
this.q2c(mb[Ga.a.nd]))}return mb};a.prototype.Ohh=function(Wa){var mb;if(Za.EwaSettings.la(459)&&(mb=this.zJe(Wa)))return mb;if(mb=this.h7c(Wa))return mb.DomainId;if(Za.EwaSettings.la(459))return I.ULS.sendTraceTag(537166805,0,10,"Could not convert key into domain: {0}",Wa),null;mb=this.qTh(Wa);return mb?mb={Id:mb,StringId:null}:(I.ULS.sendTraceTag(537166804,0,10,"Could not convert key into domain using fallback logic, Key: {0}",Wa),null)};a.prototype.qTh=function(Wa){var mb=parseInt(Wa,10);if(0<
mb)return mb;I.ULS.sendTraceTag(537166803,0,50,"Checking for specific domains, Key: {0}",Wa);var kc=xa.a.instance.fa(1751),Ab=xa.a.instance.fa(1752);return Wa===this.e3a||Wa===this.w2a?parseInt(Wa,10):this.Iff(Wa,kc,"Stock")?parseInt(this.w2a,10):this.Iff(Wa,Ab,"Geography")?parseInt(this.e3a,10):mb};a.prototype.g7c=function(Wa){var mb={};mb.Id=Wa;return this.CQ(mb)};a.prototype.h7c=function(Wa){return this.KM.xb(Wa)?this.KM.oa(Wa):null};a.prototype.caf=function(Wa){if(!Wa.startsWith(a.E7c))return-1;
var mb=parseInt(Wa.substr(a.E7c.length),10);return isNaN(mb)?(I.ULS.sendTraceTag(537166802,0,10,"Unexpected index in preview gallery button key: {0}",Wa),-1):mb};a.prototype.zJe=function(Wa){Wa=this.caf(Wa);return 0>Wa?null:this.zia[Wa]};a.prototype.$bf=function(Wa,mb,kc){if(this.Uyb&&this.KM&&this.KM.count){I.ULS.sendTraceTag(537166801,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",Wa);var Ab=this.$.na.ta.$b();this.$.ea.rc&&(Wa=this.$.na.ta,mb=ub.b(this.jPi,mb),Ab=Wa.Na(1,
void 0===Ab?null:Ab),pa.i(Wa,"LinkedEntityTryAutoRefresh",Ab,mb,kc,null,null,0))}};a.prototype.hOj=function(){this.$bf("Auto-refresh on load",null,null)};a.prototype.kOj=function(){this.Uyb&&this.KM&&this.KM.count&&(this.Yya?I.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Cm.HasAutoRefreshableLinkedEntityDomainsEver?(I.ULS.sendTraceTag(537166797,
0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Yya=Qb.a.instance.create(this.zZc,this.P_b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):I.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))};a.prototype.Iff=function(Wa,
mb,kc){return ta.a.contains(Wa,mb,!0)||ta.a.contains(Wa,kc,!0)};a.prototype.tLb=function(){if((!this.bMa||null!=this.Hpd&&null!=this.Ipd)&&this.$.ea.rc&&null!=this.uMa&&null!=this.kic&&null!=this.Qhc)if(++this.wCb,12>=this.wCb){1===this.wCb&&(this.F4a=O.a.Ra.ie.m,I.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var Wa=this.$.na.ta.$b();pa.O(this.$.na.ta,this.ilf,this.jlf(),this.qQi,this.pQi,null,Wa)}else I.ULS.sendTraceTag(537166751,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",
O.a.Ra.ie.m-this.F4a),this.aPa=!0,this.rrc()};a.prototype.pye=function(){var Wa=this;if(this.$.isEditMode)if(null!=this.uMa)this.tLb();else{var mb=O.a.Ra.ie.m,kc=[];ba.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ab){Ab.isFeatureEnabled("ExcelPowerBiPro",!1).then(function(Tb){I.ULS.sendTraceTag(537166747,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",O.a.Ra.ie.m-mb);I.ULS.sendTraceTag(537166746,0,
50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",Tb);return Wa.uMa=Tb}).then(function(){kc.push(Ab.isFeatureEnabled("ExcelWolframAlpha",!1).then(function(Tb){I.ULS.sendTraceTag(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",O.a.Ra.ie.m-mb);I.ULS.sendTraceTag(537166743,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",Tb);return Wa.kic=
Tb}))}).then(function(){kc.push(Ab.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(function(Tb){I.ULS.sendTraceTag(537166741,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelDisableStockGeographyDataTypes",O.a.Ra.ie.m-mb);I.ULS.sendTraceTag(537166740,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelDisableStockGeographyDataTypes",Tb);var ib,Sa=[(ib=new Oa.a,ib.name="IsRestrictedByLicense",ib.bool=Tb,ib)];lc.a("SatoriStockGeographyLicensingRestrictions",
void 0,void 0,Sa);Wa.Pqd=Tb&&Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Tb}))}).then(function(){kc.push(Ab.isFeatureEnabled("StockHistory",!1).then(function(Tb){I.ULS.sendTraceTag(537166739,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",O.a.Ra.ie.m-mb);I.ULS.sendTraceTag(537166738,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","StockHistory",Tb);Wa.Qhc=Tb;Wa.bMa||
Wa.tLb();return Tb}))}).then(function(){Wa.bMa&&kc.push(Ab.isFeatureEnabled("ExcelPowerBiFree",!1).then(function(Tb){I.ULS.sendTraceTag(537166736,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiFree",O.a.Ra.ie.m-mb);I.ULS.sendTraceTag(537166735,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiFree",Tb);return Wa.Hpd=Tb}))}).then(function(){Wa.bMa&&kc.push(Ab.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(function(Tb){I.ULS.sendTraceTag(537166734,
0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPremiumPerUser",O.a.Ra.ie.m-mb);I.ULS.sendTraceTag(537166733,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPremiumPerUser",Tb);return Wa.Ipd=Tb}))}).then(function(){Wa.bMa&&Promise.all(kc).then(function(){Wa.tLb()})})})}};a.prototype.iOf=function(){++this.mwb;if(12>=this.mwb){1===this.mwb&&(this.F4a=O.a.Ra.ie.m,I.ULS.sendTraceTag(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh."));
var Wa=this.$.na.ta,mb=this.ilf,kc=this.jlf(),Ab=this.CRi,Tb=this.BRi,ib=Wa.Na(1,null);ib.featureNames=mb;ib.isEnabledValues=kc;pa.i(Wa,"RefreshLinkedEntityWebServiceHandshake",ib,Ab,Tb,null,null,4)}else I.ULS.sendTraceTag(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration {0} ms",O.a.Ra.ie.m-this.F4a),this.aPa=!0,this.rrc()};a.prototype.jlf=function(){return this.bMa?[this.uMa,this.kic,this.Qhc,this.Hpd,this.Ipd,this.Pqd]:[this.uMa,this.kic,
this.Qhc,this.Pqd]};a.prototype.IId=function(){this.businessBar&&this.businessBar.cMa(56)&&this.businessBar.removeEntry(56)};a.prototype.v4h=function(Wa){if(this.ptd!==Wa&&this.businessBar)if(this.ptd=Wa){Wa=this.$.na.ta;var mb=this.lMi,kc=Wa.Na(1,null);pa.i(Wa,"GetErrorMessageForLinkedDataTypeRefresh",kc,mb,null,null,null,4)}else this.IId()};a.EHh=function(Wa,mb,kc,Ab){Wa=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Wa,
mb,Ab);kc=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',kc);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Wa,kc)};a.v1a=function(Wa){return Wa.StringId?Wa.Id.toString()+"."+Wa.StringId:Wa.Id.toString()};Qk.Object.defineProperties(a.prototype,{D7i:{configurable:!0,enumerable:!0,get:function(){return 5}},mGb:{configurable:!0,enumerable:!0,get:function(){return this.yK},
set:function(Wa){this.yK=Wa}},NNa:{configurable:!0,enumerable:!0,get:function(){return this.zia.length}},pAi:{configurable:!0,enumerable:!0,get:function(){return this.bbe}},ilf:{configurable:!0,enumerable:!0,get:function(){return this.bMa?"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" "):["ExcelPowerBiPro","ExcelWolframAlpha","StockHistory","ExcelDisableStockGeographyDataTypes"]}}});a.nKe="ConvertToLinkedEntityPreview";
a.E7c="PreviewGalleryButtonIndex.";a.S7a=0;a.ulf=2;Object(y.a)(a,"ConvertToLinkedEntityManager",T.a,[543,544,2,545])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.le.js.map/a7c76dda8e56df7833929e75506824ba/EwaDS.le.js.map