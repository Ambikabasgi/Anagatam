(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1390:function(y,F,b){function a(Sa){return ib.call(this,Sa)||this}function c(Sa){this.Fi=Sa}function d(Sa){var Mb=Tb.call(this)||this;Mb.renameFileManager=null;Mb.WY=null;Mb.$=Sa;Mb.fc();return Mb}function l(Sa,Mb){var Jc=kc.call(this)||this;Jc.R5c=null;Jc.IRf=null;Jc.JJd=null;Jc.Zca=null;Jc.$ja=function(){var Ib=Jc.$.ea.Cm;if(Ib&&Ib.WorkbookFileName){var Nb=Ya.a.kr(Ib.WorkbookFileName),sa=!!Fa.a.compare(Jc.$.workbookContext.WorkbookFileName,
Ib.WorkbookFileName,!1),Va=ta.EwaSettings.la(564)&&!!Ib.BreadcrumbFolderUrl&&!!Fa.a.compare(Jc.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,Ib.BreadcrumbFolderUrl,!1);if(sa||Va)Jc.Zca={},Jc.Zca.NewFileName=Nb,Jc.Zca.EditDocInClientUrl=Ib.EditDocInClientUrl,Jc.Zca.DirectInvokeDAVUrl=Ib.DirectInvokeDAVUrl,Jc.Zca.DownloadACopyUrl=Ib.DownloadACopyUrl,ta.EwaSettings.la(564)&&Ib.BreadcrumbFolderUrl&&(Jc.Zca.BreadcrumbFolderName=Ib.BreadcrumbFolderName,Jc.Zca.BreadcrumbFolderUrl=Ib.BreadcrumbFolderUrl),
Ib=Ha.AFrameworkApplication.Hb.De(eb.a.fileNameUpdate,2,Nb),Jc.Zca=null,ia.ULS.shipAssertTag(537154064,0,32===Ib,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};Jc.$Ki=function(Ib,Nb,sa){Jc.IRf=Nb;Jc.JJd=sa;Nb={};Jc.$.Ka.Yb(new Ba.a(1897077126,dc.a.dc,2,3,null),(Nb.newFileName=Ib,Nb))};Jc.ZKi=function(Ib){Jc.Zca&&Ib(Jc.F2e(Jc.Zca),Jc.fs)};Jc.UDb=function(Ib){ra.a(Ib)||!Ib.Result?(Ib=l.CIh(Ib),mb.a(Jc.$).rd.XD([-414480287,650565124,-782844485,1223808266,-62451516,
1636785843]),Jc.JJd(Ib)):Jc.IRf(Jc.F2e(Ib.Result),Jc.fs)};Jc.GRi=function(){Jc.JJd(5)};Jc.$=Sa;Jc.fs=Mb;Jc.$.ea.Bt(Jc.$ja);return Jc}function n(Sa){this.$=Sa}function m(Sa){return lc.call(this,Sa)||this}function f(Sa){this.renameFileManager=Sa}function v(){this.wb=this.tb=null}function w(Sa,Mb,Jc,Ib,Nb,sa,Va,Xb,mc,od){var ld=A.call(this,Sa,Jc,Ib,Nb,sa,mc)||this;ld.fXb=null;ld.Zkb=null;ld.Utg=Mb;ld.La=Va;ld.oe=Xb;od&&od.execute(function(Zc){ld.M$i(Zc)});return ld}function t(Sa,Mb,Jc,Ib,Nb,sa,Va,Xb){Sa=
A.call(this,Sa,Mb,Jc,Ib,Nb,sa)||this;Sa.See=Nb;Sa.Oug=Va;Sa.lqg=Xb;return Sa}function A(Sa,Mb,Jc,Ib,Nb,sa){this.sl=!1;this.eMc=new Za.a;this.sVa=Mb;this.$L=Jc;this.Bmg=Ib;this.wb=Nb;this.Jhe=sa}function x(Sa,Mb,Jc,Ib,Nb){this.gGc=Nb;this.R9d=Jc;this.Q9d=Ib;this.Ayg=Sa;this.hqa=Mb}function u(Sa){this.La=Sa}function B(Sa){this.C8=null;this.Vpa=0;this.La=Sa;this._initialized=!1}function r(Sa,Mb,Jc){var Ib=vb.call(this)||this;Ib.La=Sa;Ib.Bv=Mb;Ib.Vpa=Jc;Ib.Ve="RenameDialog";Ib.eg=I.eg;return Ib}function I(){}
function z(Sa,Mb,Jc){this.dialog=null;this.La=Sa;this.Bv=Mb;this.Vpa=Jc}function D(Sa,Mb){this.La=Sa;this.mVa=Mb}function V(){}function U(Sa,Mb,Jc,Ib,Nb,sa,Va,Xb,mc,od,ld,Zc){this.Q9d=Sa;this.La=Mb;this.gGc=Jc;this.Bv=Ib;this.RDa=Nb;this.wyg=sa;this.wra=Va;this.eje=Xb;this.Qug=mc;this.hqa=od;this.wb=ld;this.Pug=Zc}function Q(){this.QDi=this.MDi=this.Mah=null}function la(){}function ba(Sa,Mb,Jc,Ib,Nb,sa,Va,Xb,mc,od,ld,Zc){this._initialized=!1;this._element=null;this.YDa=0;this.kQc=this.PJc=!1;this.La=
Sa;this.eFc=Mb;this.ke=Jc;this.fA=Ib;this.C8=Nb;this.Zfe=sa;this.xVb=Va;this.XFc=Xb;this.O8=mc;this.E9d=od;this.gWa=ld;this.GKc=Zc}function S(Sa,Mb){this.YDa=0;this.La=Sa;this.C8=Mb}function H(Sa,Mb,Jc,Ib,Nb){var sa=Pa.call(this)||this;sa.N1=new fa(Sa,Mb,Jc);sa.wra=Ib;sa.hqa=Nb;sa.Ve="RenameDisabledDialog";sa.kc=0;sa.Gc(1,CommonUIStrings.l_DialogClose);sa.eg=T.eg;sa.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);sa.cX("RenameRow");return sa}function T(){}function K(Sa,Mb,Jc,Ib,Nb){return da.call(this,
Sa,Mb,Jc,Ib,Nb)||this}function da(Sa,Mb,Jc,Ib,Nb){var sa=qa.call(this)||this;sa.eVd=[];sa.N1=new fa(Sa,Mb,Jc);sa.wra=Ib;sa.hqa=Nb;sa.Ve="RenameDisabledDialog";sa.kc=0;sa.Gc(1,CommonUIStrings.l_DialogClose);sa.Puj();sa.Tej();return sa}function fa(Sa,Mb,Jc){this.JRd=this.KRd=this.LRd=!1;this.cSd=!Sa&&!Mb;this.dSd=!Sa&&!Jc;this.cSd||this.dSd||(this.LRd=!Sa,this.KRd=!Mb,this.JRd=!Jc)}b.r(F);y=b(0);var W=b(80),ca=b(685),ia=b(13),ea=b(128);Object(y.a)(fa,"RenameDisabledDialogInfo",null,[]);var qa=ea.StandardDialog;
vm(da,qa);da.prototype.Puj=function(){this.N1.cSd?this.VKb(this.wra?this.hqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.N1.dSd?this.VKb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.IBg();this.Fra(this.eVd)};da.prototype.VKb=function(Sa){Array.add(this.eVd,Sa)};da.prototype.IBg=function(){var Sa=[];this.N1.LRd||Array.add(Sa,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.N1.KRd||Array.add(Sa,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.N1.JRd||Array.add(Sa,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Sa.length&&Array.add(this.eVd,Sa)};Object(y.a)(da,"ReactRenameDisabledDialogBase",ea.StandardDialog,[]);vm(K,da);K.prototype.Tej=function(){this.QBb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)};Object(y.a)(K,"ReactRenameDisabledDialog",da,[]);var pa=b(140);Qk.Object.defineProperties(T,{eg:{configurable:!0,enumerable:!0,
get:function(){return pa.a.Bn(T.Uj,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}});T.Uj="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(y.a)(T,"RenameDisabledDialogHtml",null,[]);var Pa=pa.a;vm(H,Pa);H.prototype.r9a=function(){if(this.N1.cSd){var Sa=this.wra?this.hqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;H.VKb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Sa)}else this.N1.dSd?H.VKb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),
CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.X7h()};H.prototype.X7h=function(){this.N1.LRd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.N1.KRd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.N1.JRd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")};H.VKb=function(Sa,Mb,Jc){Sa.style.display="none";Mb.innerText=Jc};Object(y.a)(H,"RenameDisabledDialog",pa.a,[]);
var Ha=b(5),Ya=b(29),Na=b(104),eb=b(30);S.prototype.initialize=function(Sa){if(!this.La||!this.C8)return!1;this.YDa=Sa;this.Pg();return!0};S.prototype.Pg=function(){this.La.hc(eb.a.Yha,Na.a.frame,Object(W.a)(this,this.Yha,"commitNewDocumentTitle"))};S.prototype.Yha=function(Sa,Mb,Jc,Ib,Nb){if(1===Jc)return this.La.processAction(eb.a.renameFile,1);Sa=Ya.a.kr(this.C8.yn);Nb=(0,Nb.getNewDocumentTitle)();Nb.length>this.YDa&&(Nb=Nb.substr(0,this.YDa));if(32!==this.La.De(eb.a.renameFile,2,Nb))return this.wX(Sa),
8;this.wX(Nb);return 32};S.prototype.wX=function(Sa){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Sa))};S.pfd=function(){return new S(Ha.AFrameworkApplication.Hb,Ha.AFrameworkApplication.am)};Object(y.a)(S,"ReactRenameUIHandler",null,[325]);var Ia=b(833),lb=b(920),hc=b(576),ma=b(12),Ja=b(117),Ta=b(169),pb=b(89),Db=b(47),fb=b(23),xa=b(87);ba.prototype.initialize=function(Sa,Mb,Jc){if(!(this.La&&this.C8&&this.Zfe&&this.xVb&&this.XFc&&Mb)||0>=Sa)return!1;this._element=Mb;this._element.title=
Jc;this._element.setAttribute(pb.a.Ud,pb.a.Pr);this._element.setAttribute("Unselectable","on");this.YDa=Sa;this.hv();return this._initialized=!0};ba.prototype.hv=function(){this.eFc&&(this.eFc.qa(ma.a.blur,this._element,Object(W.a)(this,this.onBlur,"onBlur")),this.eFc.qa(ma.a.paste,this._element,Object(W.a)(this,this.onPaste,"onPaste")));this.ke.qa(ma.a.Tb,this._element,Object(W.a)(this,this.onKeyDown,"onKeyDown"));this.fA.qa(ma.a.pointerDown,this._element,Object(W.a)(this,this.onPointerDown,"onPointerDown"));
this.fA.qa(ma.a.Zd,this._element,Object(W.a)(this,this.Ng,"onPointerUp"))};ba.prototype.onBlur=function(){this.isActive&&!this.PJc&&(this.E9d||this.XFc(this._element),this.$Ae(),this.J5c(!1));return this.PJc=!1};ba.prototype.onPaste=function(){ia.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0};ba.prototype.onKeyDown=function(Sa){return this.isActive?this.POi(Sa):this.QOi(Sa)};ba.prototype.POi=function(Sa){var Mb=!1;switch(Sa.Ea.keyCode){case Sys.UI.Key.enter:this.$Ae();
this.J5c(this.gWa||this.GKc);Mb=!0;break;case Sys.UI.Key.tab:this.E9d&&this.XFc(this._element);break;case Sys.UI.Key.esc:this.mLd(),this.J5c(this.gWa||this.GKc),Mb=!0}return Mb};ba.prototype.QOi=function(Sa){var Mb=!1;switch(Sa.Ea.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Fag(this.GKc),this.isActive&&this.xVb(this._element),Mb=!0}return Mb};ba.prototype.onPointerDown=function(){this.isActive||(this.Fag(!1),this.isActive&&(this._element.focus(),this.xVb(this._element),this.kQc=!0));
return!1};ba.prototype.Ng=function(){return this.kQc?(this.xVb(this._element),this.kQc=!1,!0):!1};ba.prototype.J6a=function(){return 32===this.La.processAction(eb.a.renameFile,1)};ba.prototype.$Ae=function(){var Sa=Ya.a.kr(this.C8.yn),Mb=this._element.innerText.trim();Mb.length>this.YDa&&(Mb=Mb.substr(0,this.YDa));Mb!==Sa&&""!==Mb?32!==this.La.De(eb.a.renameFile,2,Mb)?this.mLd():this.wX(Mb):this.mLd()};ba.prototype.mLd=function(){this.wX(Ya.a.kr(this.C8.yn))};ba.prototype.wX=function(Sa){this._initialized&&
(this._element.innerText=Sa,this.Zfe())};ba.prototype.Fag=function(Sa){this.J6a()?this.isActive||(Sa&&(this.PJc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(pb.a.Ud,pb.a.YWc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Ia.CuiHelper.uKe),this.O8&&this.O8.execute(function(Mb){Mb.$Lf(!0)}),Sa&&this._element.focus(),ia.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):
this.La.processAction(eb.a.jdb,2)};ba.prototype.J5c=function(Sa){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(pb.a.Ud,pb.a.Pr);Sys.UI.DomElement.removeCssClass(this._element,Ia.CuiHelper.uKe);this.O8&&this.O8.execute(function(Mb){Mb.$Lf(!1)});Sa&&(this._element.blur(),this._element.focus())};ba.my=function(){lb.a.my(Ha.AFrameworkApplication.isRtl)};ba.pfd=function(){return new ba(Ha.AFrameworkApplication.Hb,hc.a.instance,
Ja.KeyInputManager.instance,Ta.a.instance,Ha.AFrameworkApplication.am,ba.my,Db.a.enj,Db.a.MYg,xa.a.instance.pc("Common.App.Header.HeaderEventSource"),fb.a.MH,fb.a.ah,fb.a.Df)};Qk.Object.defineProperties(ba.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return"true"===this._element.getAttribute("contentEditable")}}});Object(y.a)(ba,"RenameUIHandler",null,[325]);Qk.Object.defineProperties(la,{instance:{configurable:!0,enumerable:!0,get:function(){return Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled?
la.Oa||(la.Oa=S.pfd()):la.Oa||(la.Oa=ba.pfd())}}});la.Oa=null;Object(y.a)(la,"RenameUIHandlerFactory",null,[]);var ya=b(95),Ga=b(129);Object(y.a)(Q,"RenameMruEntryProperties",null,[]);var db=b(373),Ob=b(170),Ec=b(689),wb;(function(Sa){Sa[Sa.unknown=-1]="unknown";Sa[Sa.success=0]="success";Sa[Sa.renameInvalidFileName=1]="renameInvalidFileName";Sa[Sa.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Sa[Sa.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Sa[Sa.permissionDenied=
4]="permissionDenied";Sa[Sa.serverCommunicationFailure=5]="serverCommunicationFailure";Sa[Sa.fileNameTooLong=6]="fileNameTooLong"})(wb||(wb={}));Object(y.b)("CommonOperationResult",wb);U.prototype.Pg=function(){Ha.AFrameworkApplication.sa&&Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled||this.Fi.hc(eb.a.Jxb,Na.a.frame,Object(W.a)(this,this.Jxb,"initializeRenameUIHandler"));this.Fi.hc(eb.a.jdb,Na.a.frame,Object(W.a)(this,this.jdb,"showRenameDisabledDialog"));this.Fi.hc(eb.a.renameFile,
Na.a.frame,Object(W.a)(this,this.renameFile,"renameFile"));this.Fi.ff(eb.a.fileNameUpdate,Na.a.frame,Object(W.a)(this,this.D8i,"refreshFilename"),64);this.Fi.ff(eb.a.ilc,Na.a.frame,Object(W.a)(this,this.ilc,"moveToFolderCompleteByHost"),64);this.Fi.hc(eb.a.ZNa,Na.a.frame,Object(W.a)(this,this.ZNa,"moveToFolder"));Ha.AFrameworkApplication.sa&&(Ha.AFrameworkApplication.ga.ra("PostMessageEmbedded")||Ha.AFrameworkApplication.ga.ra("IsJsApi"))&&Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0)&&Ha.AFrameworkApplication.rV().execute(function(Sa){Sa.Xn(Ob.a.urf);Sa.Jl(Ob.a.urf,U.A7i);Sa.Xn(Ob.a.Cad);Sa.Jl(Ob.a.Cad,U.y7i)})};U.prototype.J6a=function(){return 0===this.Pug.E2e()?32:8};U.prototype.FVj=function(){return this.Qy?this.wra?this.Qy.uJe:this.Qy.nub:!0};U.prototype.Jxb=function(){return la.instance.initialize(Ha.AFrameworkApplication.i9b,Ha.AFrameworkApplication.s1a,Ha.AFrameworkApplication.KJd||CommonUIStrings.l_RenameFileTooltip)?32:8};U.prototype.jdb=function(){var Sa=this.FVj(),
Mb=this.wyg();ia.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.RDa,Mb,Sa,this.wra);Ha.AFrameworkApplication.sa&&Ha.AFrameworkApplication.sa.Qa.qw&&Ha.AFrameworkApplication.ga.ra("ReactRenameDisabledDialogIsEnabled")?new K(this.RDa,!Mb,!Sa,this.wra,this.hqa()):new H(this.RDa,!Mb,!Sa,this.wra,this.hqa());return 32};U.prototype.renameFile=function(Sa,
Mb,Jc,Ib,Nb){if(1===Jc)return this.J6a();if(!Ha.AFrameworkApplication.A8b)return 8;if(8===this.J6a())return this.Fi.processAction(eb.a.jdb,2),8;ia.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Ha.AFrameworkApplication.A8b(Nb,Object(W.a)(this,this.UDb,"onRenameFileSuccess"),Object(W.a)(this,this.HRi,"onRenameFileFailure"));return 32};U.prototype.UDb=function(Sa,Mb){Sa?0!==Sa.OperationResult?this.A6e(Sa.OperationResult):(this.Aoj(Mb,Sa.NewName),this.nRj(Sa,Object(W.a)(Ha.AFrameworkApplication.sa.Qa,
Ha.AFrameworkApplication.sa.Qa.eeg,"updateOpenInClientDocumentUrl")),Ha.AFrameworkApplication.ga.ra("DocumentNameInJewelInfoMenuIsEnabled")&&Ha.AFrameworkApplication.sa.updateCommandUI(),this.Qug.Jcg()):this.A6e(5)};U.prototype.Aoj=function(Sa,Mb){var Jc={};Jc[db.a.wBh]=Mb;Sa.Rj(Ob.a.Cad,Jc)};U.prototype.nRj=function(Sa,Mb){this.yRj(Sa);Ha.AFrameworkApplication.Z5b=Sa.DirectInvokeDavUrl;Mb=Mb(Sa.EditDocInClientUrl);var Jc=new Q;Jc.QDi=this.Bv.yn;Jc.Mah=Mb;Jc.MDi=Sa.EditDocInClientUrl;this.Fi.De(eb.a.renameMostRecentlyUsedFileEntry,
2,Jc)};U.prototype.A6e=function(Sa){switch(Sa){case 1:Sa=new ea.StandardDialog,Sa.kc=0,Sa.iX(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.pUf()}};U.prototype.yRj=function(Sa){this.Bv.yn=U.eKg(this.Bv.yn,Sa.NewName);Sa.BreadcrumbFolderName&&(this.Bv.breadcrumbFolderName=Sa.BreadcrumbFolderName);Sa.BreadcrumbFolderUrl&&(this.Bv.breadcrumbFolderUrl=Sa.BreadcrumbFolderUrl);this.eje(Sa.NewName)};U.prototype.HRi=function(Sa){var Mb=new ea.StandardDialog;
Mb.kc=0;switch(Sa){case 1:ia.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Mb.FAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ia.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Mb.FAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:var Jc={};ia.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",(Jc.Result=Sa,Jc));Mb.FAa(CommonUIStrings.l_RenameFileGenericErrorTitle,
CommonUIStrings.l_RenameFileGenericError,null)}Ha.AFrameworkApplication.rV().execute(function(Ib){var Nb={};Ib.Rj(Ob.a.vBh,(Nb.FailureMessage=wb[Sa],Nb))});this.pUf()};U.prototype.D8i=function(Sa,Mb,Jc){if(1===Jc)return this.J6a();if(!Ha.AFrameworkApplication.aJa)return 8;Ha.AFrameworkApplication.aJa(Object(W.a)(this,this.Pnc,"onRefreshFilenameSuccess"),Object(W.a)(this,this.Onc,"onRefreshFilenameFailure"),!1);return 32};U.prototype.ZNa=function(Sa,Mb,Jc,Ib,Nb){if(1===Jc)return Ha.AFrameworkApplication.ga.ra("UiHostSupportsMoveToFolder")?
32:8;if(2===Jc){var sa={};Sa=Ha.AFrameworkApplication.Xka;Mb=Ha.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures");Sa=(!Sa||Sa&&Mb)&&Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);sa[db.a.gIj]=Sa;Nb&&Nb.MoveButtonClickedTime&&(sa[db.a.hCi]=Nb.MoveButtonClickedTime.getTime());Ha.AFrameworkApplication.rV().execute(function(Va){Va.Rj(Ob.a.ZNa,sa)});if(Nb&&Nb.MoveButtonClickedTime){if(Sa=Ga.a.Vr())Nb=(new Date).getTime()-Nb.MoveButtonClickedTime.getTime(),
Sa.set("MovePostDuration",Nb.toString());ya.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Sa)}return 32}return 8};U.prototype.ilc=function(Sa,Mb,Jc,Ib,Nb){if(1===Jc)return Ha.AFrameworkApplication.ga.ra("UiHostSupportsMoveToFolder")?this.J6a():8;if(2===Jc){if(!Ha.AFrameworkApplication.WXf)return ya.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Nb)return ya.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",
!1,!1,null),8;if(Nb[db.a.thi])if(Nb[db.a.afg])if(Sa=Nb[db.a.afg].toLowerCase(),Mb=Ha.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"),Jc=Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Mb&&Ha.AFrameworkApplication.Xka&&Jc){var sa={};sa[db.a.UPa]="1";sa[db.a.documentUrl]=Sa;sa[db.a.reason]=Ec.a.saveAs;ya.Health.instance.recordKpiSuccess("MoveToFolder",null);Ha.AFrameworkApplication.rV().execute(function(Va){Va.Rj(Ob.a.Lta,sa)})}else if(!Ha.AFrameworkApplication.Xka&&
Jc)ya.Health.instance.recordKpiSuccess("MoveToFolder",null),Db.a.vf(Sa,Db.a.zX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return ya.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else ya.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Ha.AFrameworkApplication.aJa(Object(W.a)(this,this.Pnc,"onRefreshFilenameSuccess"),Object(W.a)(this,this.Onc,"onRefreshFilenameFailure"),!1),Ha.AFrameworkApplication.WXf(),ya.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32};U.prototype.$zj=function(Sa,Mb){return Sa&&Mb?Sa!==this.Bv.breadcrumbFolderName||Mb!==this.Bv.breadcrumbFolderUrl:!1};U.prototype.Pnc=function(Sa,Mb){Sa&&(Sa.NewName!==Ya.a.kr(this.Bv.yn)||this.$zj(Sa.BreadcrumbFolderName,Sa.BreadcrumbFolderUrl))&&this.UDb(Sa,Mb)};U.prototype.Onc=function(){};U.prototype.pUf=function(){this.eje(Ya.a.kr(this.Bv.yn))};U.oub=function(){return new U(Ha.AFrameworkApplication.K6a,new ca.a(function(){return Ha.AFrameworkApplication.Hb}),new ca.a(function(){return Ha.AFrameworkApplication.Qy}),
Ha.AFrameworkApplication.am,Ha.AFrameworkApplication.limitedEdit,function(){return Ha.AFrameworkApplication.userCanRename},Ha.AFrameworkApplication.Osc,Object(W.a)(la.instance,la.instance.wX,"updateTitle"),xa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),function(){return Ha.AFrameworkApplication.isReadOnlyRecommended},Ha.AFrameworkApplication.ga,xa.a.instance.resolve("Common.IRenameProps"))};U.eKg=function(Sa,Mb){Sa=Ya.a.s4(Sa);return Mb+Sa};U.A7i=function(Sa){var Mb=Sa.Values[db.a.Ski];
ia.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Mb);Mb?Ha.AFrameworkApplication.Hb.De(eb.a.ilc,2,Sa.Values):ya.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)};U.y7i=function(Sa){Ha.AFrameworkApplication.Hb.De(eb.a.renameFile,2,Sa.Values.NewName)};Qk.Object.defineProperties(U.prototype,{Fi:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},Qy:{configurable:!0,enumerable:!0,get:function(){return this.gGc.value}}});
Qk.Object.defineProperties(U,{instance:{configurable:!0,enumerable:!0,get:function(){return U.Oa||(U.Oa=U.oub())}}});U.Oa=null;Object(y.a)(U,"RenameActor",null,[]);b(939);Object(y.a)(function(){},"ActivityEventName",null,[]);V.compatMode="CompatMode";V.noSelection="NoSelection";Object(y.a)(V,"ActivityEventReason",null,[]);var kb=b(688);D.prototype.Pg=function(){this.La.hc(eb.a.M4f,Na.a.frame,Object(W.a)(this,this.NCj,"showRenameDialogAction"))};D.prototype.NCj=function(Sa,Mb,Jc){Sa=32;if(1===Jc)return kb.SessionStatusManager.instance.swb||
Ha.AFrameworkApplication.n5?8:32;2===Jc&&(32!==this.La.processAction(eb.a.renameFile,1)?(this.La.processAction(eb.a.jdb,2),Sa=8):32===this.La.processAction(eb.a.YRd,1)?this.La.processAction(eb.a.YRd,2):this.mVa.value.create().ixc());return Sa};Object(y.a)(D,"RenameDialogActor",null,[312]);z.prototype.yXh=function(){var Sa={},Mb={};Sa.nameInputProps=(Mb.type="AppInputProps",Mb.id=z.r1a,Mb.label=CommonUIStrings.l_RenameDialogLabel,Mb.value=Ya.a.kr(this.Bv.yn),Mb.maxLength=this.Vpa,Mb);return Sa};z.prototype.ixc=
function(){var Sa=this.yXh(),Mb={};Sa=(Mb.id="RenameDialog",Mb.bodyControls=Sa,Mb);this.dialog=new pa.a(!1,!1,!0);this.dialog.kc=1;this.dialog.Ve="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(W.a)(this,this.IJd,"renameDialogHandler"),Sa)};z.prototype.IJd=function(Sa,Mb){Mb&&1===Sa&&Mb[z.r1a]&&(Sa=Ya.a.kr(this.Bv.yn),Mb=(Mb[z.r1a]||"").trim(),Mb!==Sa&&""!==Mb&&this.La.De(eb.a.renameFile,2,Mb))};z.r1a="txtDocumentName";Object(y.a)(z,"ReactRenameDialog",null,
[331]);Qk.Object.defineProperties(I,{eg:{configurable:!0,enumerable:!0,get:function(){return pa.a.Bn(I.Uj,CommonUIStrings.l_RenameDialogLabel)}}});I.Uj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(y.a)(I,"RenameDialogHtml",null,[]);var vb=pa.a;vm(r,vb);r.prototype.ixc=function(){var Sa={};Sa=(Sa.txtDocumentName=
Ya.a.kr(this.Bv.yn),Sa);this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(W.a)(this,this.IJd,"renameDialogHandler"),Sa);Sa=document.getElementById(r.r1a);0<this.Vpa&&(Sa.maxLength=this.Vpa);Sa.focus()};r.prototype.IJd=function(Sa,Mb){1===Sa&&(Sa=Ya.a.kr(this.Bv.yn),Mb=(Mb[r.r1a]||"").trim(),Mb!==Sa&&""!==Mb&&this.La.De(eb.a.renameFile,2,Mb))};r.r1a="txtDocumentName";Object(y.a)(r,"RenameDialog",pa.a,[331]);B.prototype.initialize=function(Sa,Mb){this.C8=Sa;this.Vpa=Mb;this._initialized=
!0};B.prototype.create=function(){return this._initialized?Ha.AFrameworkApplication.sa&&Ha.AFrameworkApplication.sa.Qa.qw&&Ha.AFrameworkApplication.ga.ra("ReactRenameDialogIsEnabled")?new z(this.La,this.C8,this.Vpa):new r(this.La,this.C8,this.Vpa):null};Object(y.a)(B,"RenameDialogFactory",null,[313]);var Gb=b(168);u.prototype.Pg=function(){this.La.hc(eb.a.YRd,Na.a.frame,Object(W.a)(this,this.OCj,"showRenameFlyoutAction"))};u.prototype.KUg=function(){return Gb.d("setDocumentTitleFlyoutOpened")&&Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled};
u.prototype.OCj=function(Sa,Mb,Jc){if(1===Jc)return this.KUg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32};Object(y.a)(u,"RenameFlyoutActor",null,[306]);x.prototype.E2e=function(){if(!this.Q9d())return 5;if(this.hqa())return 1;if(this.Qy){if(this.R9d&&!this.Qy.uJe)return 3;if(!this.R9d&&!this.Qy.nub)return 4}return this.Ayg()?0:2};Qk.Object.defineProperties(x.prototype,{Qy:{configurable:!0,enumerable:!0,get:function(){return this.gGc.value}}});Object(y.a)(x,
"RenameProps",null,[305]);b(185);var Za=b(100);A.prototype.enable=function(){this.sl||(this.Jcg(),this.wTd(),this.sl=!0)};A.prototype.generateKey=function(Sa,Mb,Jc){return String.format("{0}/{1}/{2}",Jc,Sa,Mb)};A.prototype.MSh=function(){var Sa=Ya.a.kr(this.sVa().yn);return this.generateKey(this.sVa().breadcrumbFolderName,this.sVa().breadcrumbFolderUrl,Sa)};A.prototype.NSh=function(Sa,Mb,Jc){return Sa&&Mb?this.generateKey(Sa,Mb,Jc):Jc};A.prototype.gfh=function(Sa,Mb,Jc){return Sa&&Sa!==this.sVa().breadcrumbFolderName||
Mb&&Mb!==this.sVa().breadcrumbFolderUrl?!0:Jc!==Ya.a.kr(this.sVa().yn)};A.prototype.Jcg=function(){var Sa=this.MSh();this.eMc.ia(Sa,new Date)};A.prototype.mDd=function(Sa){this.Iyj(Sa)&&this.nke(Sa)};A.prototype.Iyj=function(Sa){var Mb=this.Bmg();return Mb?this.Jhe&&this.Jhe.Tyb||!Mb.hef||!Ha.AFrameworkApplication.aJa?(this.j7f(Sa),this.sl=!1):!0:!1};A.prototype.hEf=function(Sa,Mb,Jc,Ib){var Nb=this.gfh(Sa,Mb,Jc);Sa=this.NSh(Sa,Mb,Jc);Mb=this.eMc.Hc(Sa).returnValue;Nb&&!Mb&&(this.B6e(Ib),ia.ULS.sendTraceTag(591734297,
203,50,"{0} forced FileNameUpdate",this.hud));Nb||this.eMc.ia(Sa,this.$L())};Object(y.a)(A,"ARenamedFileChecker",null,[272]);vm(t,A);t.prototype.wTd=function(){this.See.iVc(Object(W.a)(this,this.m7e,"handleSettingsRefresh"))};t.prototype.m7e=function(Sa,Mb){Mb&&Mb.lCb&&Mb.LGi&&(Mb.T6a("BreadcrumbDocName")||Mb.T6a("BreadcrumbFolderName")||Mb.T6a("BreadcrumbFolderUrl")||Mb.T6a("DirectInvokeDAVUrl")||Mb.T6a("EditDocInClientUrl"))&&(ia.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",
this.hud),this.mDd(Mb))};t.prototype.j7f=function(){this.See.wdj(Object(W.a)(this,this.m7e,"handleSettingsRefresh"))};t.prototype.nke=function(Sa){if(Sa&&Sa.lCb){var Mb=Sa.lCb;this.hEf(Mb.Ua("BreadcrumbFolderName"),Mb.Ua("BreadcrumbFolderUrl"),Mb.Ua("BreadcrumbDocName"),Sa)}};t.prototype.B6e=function(Sa){var Mb=this,Jc={OperationResult:0,classId:1};Sa=Sa.lCb;Jc.BreadcrumbFolderName=Sa.Ua("BreadcrumbFolderName");Jc.BreadcrumbFolderUrl=Sa.Ua("BreadcrumbFolderUrl");Jc.DirectInvokeDavUrl=Sa.Ua("DirectInvokeDAVUrl");
Jc.EditDocInClientUrl=Sa.Ua("EditDocInClientUrl");Sa=Sa.Ua("BreadcrumbDocName");Jc.NewName=Ha.AFrameworkApplication.uIa?Sa:Ya.a.kr(Sa);this.lqg.execute(function(Ib){Mb.Wei(Jc,Ib)})};t.prototype.Wei=function(Sa,Mb){this.Oug().UDb(Sa,Mb)};Qk.Object.defineProperties(t.prototype,{hud:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingSettingsRefresh"}}});Object(y.a)(t,"RenamedFileCheckerUsingSettingsRefresh",A,[]);var ub=b(108);vm(w,A);w.prototype.M$i=function(Sa){this.fXb=Sa;
this.fXb.BGg(Object(W.a)(this,this.$id,"handleVisibilityChange"))};w.prototype.$id=function(Sa,Mb){!this.sl||0!==Mb.newState&&1!==Mb.newState||this.Zkb||(this.wTd(),this.mDd(this.Zkb))};w.prototype.wTd=function(){this.Zkb=new ub.a(3,2,this.Utg(),Object(W.a)(this,this.mDd,"performRenameFileCheckTick"),89);this.oe.Yg(this.Zkb)};w.prototype.j7f=function(Sa){this.oe.Mp(Sa)};w.prototype.nke=function(Sa){this.fXb&&2===this.fXb.I_j?this.Kaj(Sa):Ha.AFrameworkApplication.aJa(Object(W.a)(this,this.Pnc,"onRefreshFilenameSuccess"),
Object(W.a)(this,this.Onc,"onRefreshFilenameFailure"),!0)};w.prototype.Kaj=function(Sa){this.oe.Mp(Sa);this.Zkb=null};w.prototype.Pnc=function(Sa){Sa&&this.hEf(Sa.BreadcrumbFolderName,Sa.BreadcrumbFolderUrl,Sa.NewName,null)};w.prototype.B6e=function(){this.La.processAction(eb.a.fileNameUpdate,2)};w.prototype.Onc=function(){};Qk.Object.defineProperties(w.prototype,{hud:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingTask"}}});Object(y.a)(w,"RenamedFileCheckerUsingTask",
A,[]);v.prototype.ii=function(Sa){var Mb=this;this.tb=Sa;this.wb=Ha.AFrameworkApplication.ga;this.tb.register(D,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Mc(function(){return new D(Ha.AFrameworkApplication.Hb,Mb.tb.gLd("Common.App.Rename.IRenameDialogFactory"))}).Cc();this.tb.register(B,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Mc(function(){return new B(Ha.AFrameworkApplication.Hb)}).Cc();this.tb.register(272,"Common.App.Rename.IRenamedFileChecker").Mc(function(){return Mb.v9g()}).Cc();
this.tb.register(u,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Mc(function(){return new u(Ha.AFrameworkApplication.Hb)}).Cc()};v.prototype.v9g=function(){var Sa=this;if(this.wb.ra("RenamedFileCheckerWithSettingsRefreshIsEnabled")){var Mb=this.tb.Nh("Common.IRefreshableAppSettings");if(Mb&&Mb.umi)return new t(function(){return Mb.Bd("RenamedFileCheckerMaxCachedAgeInMs",48E4)},function(){return Ha.AFrameworkApplication.am},function(){return new Date},function(){return Ha.AFrameworkApplication.Qy},
Mb,this.tb.Nh("Common.ISessionStatus"),function(){return U.instance},this.tb.pc("Postmessage.IHostPostmessenger"))}return new w(function(){return Sa.wb.Bd("RenamedFileCheckerMaxCachedAgeInMs",48E4)},function(){return Sa.wb.Bd("RenamedFileCheckerPingIntervalInMs",12E4)},function(){return Ha.AFrameworkApplication.am},function(){return new Date},function(){return Ha.AFrameworkApplication.Qy},Ha.AFrameworkApplication.ga,Ha.AFrameworkApplication.Hb,Ha.AFrameworkApplication.gj,this.tb.Nh("Common.ISessionStatus"),
this.tb.pc("Common.App.VisibilityManagement.IVisibilityManager"))};v.prototype.init=function(){this.wb.Tu(Object(W.a)(this,this.kB,"onFullAppSettingsReady"))};v.prototype.kB=function(){var Sa=Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled;Ha.AFrameworkApplication.K6a()&&la.instance.initialize(Ha.AFrameworkApplication.i9b,Sa?null:Ha.AFrameworkApplication.s1a,Sa?null:Ha.AFrameworkApplication.KJd||CommonUIStrings.l_RenameFileTooltip)&&(this.tb.register(x,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Mc(function(){return new x(function(){return Ha.AFrameworkApplication.userCanRename},
function(){return Ha.AFrameworkApplication.isReadOnlyRecommended},Ha.AFrameworkApplication.Osc,Ha.AFrameworkApplication.K6a,new ca.a(function(){return Ha.AFrameworkApplication.Qy}))}).Cc(),U.instance.Pg(),this.wb.ra("RenameDialogIsEnabled")&&(this.tb.resolve("Common.App.Rename.RenameDialogFactory").initialize(Ha.AFrameworkApplication.am,Ha.AFrameworkApplication.i9b),this.tb.resolve("Common.App.Rename.IRenameDialogActor").Pg()),this.tb.resolve("Common.App.Rename.IRenameFlyoutActor").Pg(),Ha.AFrameworkApplication.Osc&&
this.tb.resolve("Common.App.Rename.IRenamedFileChecker").enable())};v.prototype.dispose=function(){};Qk.Object.defineProperties(v.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.RenameFile"}}});Object(y.a)(v,"PackageManager",null,[4,5]);F=b(273);var fc=b(10),$a=b(817),nb=b(56),sc=b(35),rd=b(57),$b=b(175),Wb=b(52);f.prototype.executeCommand=function(Sa,Mb,Jc){switch(Mb.command){case eb.a.Yha:return rd.a.Rf.isReactSharedHeaderUxEnabled?2!==Ha.AFrameworkApplication.Hb.De(eb.a.Yha,
2,Jc)?Wb.Task.Ta(!0):$b.a(Mb.command):$b.a(Mb.command);case 1897077126:return this.renameFileManager.renameFile(Jc,Mb),Wb.Task.Ta(!0);default:return $b.a(Mb.command)}};f.prototype.Kc=function(Sa,Mb,Jc,Ib){switch(Mb.command){case eb.a.Yha:return rd.a.Rf.isReactSharedHeaderUxEnabled;case 1897077126:return!!Ib&&2===Ib.wA}return!1};f.prototype.gd=function(){return!1};f.prototype.Zc=function(){return!1};f.prototype.dispose=function(){this.renameFileManager=null};Object(y.a)(f,"RenameFileCommandHandler",
null,[239,2]);var lc=$a.a;vm(m,lc);m.prototype.Pd=function(){var Sa=this,Mb=nb.GetServiceTaskFactory.create(this.$.da,119,this.ma,this.ub);sc.TaskExtensions.Ba(Mb,function(){Sa.Gd([new f(Mb.result)])},this.ma,3)};m.ka=function(Sa){$a.a.he(118,new m(Sa))};Object(y.a)(m,"RenameFileCommandHandlerFactory",$a.a,[]);var Oa=b(88),qb=b(214),Ub=b(220),jc=b(74),Kb=b(379),dc=b(77),Qb=b(369),O=b(164),Ba=b(92),ra=b(303),ta=b(1),Fa=b(20),cb=b(272);Qk.Object.defineProperties(n.prototype,{hef:{configurable:!0,enumerable:!0,
get:function(){return this.$.workbookContext.FileCoauthorable}},Tyb:{configurable:!0,enumerable:!0,get:function(){return!1}},nub:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.amIAlone}},uJe:{configurable:!0,enumerable:!0,get:function(){if(this.nub)return!0;for(var Sa=yl(this.$.ea.jm),Mb=Sa.next();!Mb.done;Mb=Sa.next())if(!Mb.value.SupportsRename)return!1;return!0}}});Object(y.a)(n,"EwaCoauthManager",null,[315]);var Wa=b(81),mb=b(65),kc=jc.a;vm(l,kc);l.prototype.initialize=function(){Ha.AFrameworkApplication.A8b=
this.$Ki;Ha.AFrameworkApplication.aJa=this.ZKi;this.R5c=Ha.AFrameworkApplication.Qy;Ha.AFrameworkApplication.Qy=new n(this.$)};l.prototype.dispose=function(){Ha.AFrameworkApplication.A8b=null;Ha.AFrameworkApplication.aJa=null;this.$.ea.Dw(this.$ja);Ha.AFrameworkApplication.Qy=this.R5c;this.$=this.R5c=null;kc.prototype.dispose.call(this)};l.prototype.renameFile=function(Sa,Mb){var Jc=this,Ib=Sa.newFileName;if(Ib){var Nb=this.$.na.ta.$b();Qb.a(this.$.userOperationManager,function(sa,Va,Xb){var mc=Jc.$.na.ta;
sa=cb.b(sa,Jc.UDb);Va=cb.a(Va,Jc.GRi);var od=mc.Na(9,Nb);od.newFileName=Ib;return Wa.i(mc,"RenameFile",od,sa,Va,Xb,null,0)},function(sa){return new O.a(134,0,sa)},Mb)}};l.prototype.dhi=function(){return 32===Ha.AFrameworkApplication.Hb.processAction(eb.a.Yha,1)};l.prototype.F2e=function(Sa){var Mb=this.$.workbookContext;Ha.AFrameworkApplication.R3=Sa.DownloadACopyUrl;var Jc=ta.EwaSettings.la(564)&&!!Sa.BreadcrumbFolderUrl;Jc&&(Ha.AFrameworkApplication.am.breadcrumbFolderName=Sa.BreadcrumbFolderName,
Ha.AFrameworkApplication.am.breadcrumbFolderUrl=Sa.BreadcrumbFolderUrl,Mb.FullDocumentInfo.BreadcrumbFolderUrl=Sa.BreadcrumbFolderUrl,Mb.FullDocumentInfo.BreadcrumbFolderName=Sa.BreadcrumbFolderName);Mb.FullDocumentInfo.BreadcrumbDocName=Sa.NewFileName;Kb.d(Mb,Sa.NewFileName);Mb={};Mb.NewName=Sa.NewFileName;Mb.DirectInvokeDavUrl=Sa.DirectInvokeDAVUrl;Mb.EditDocInClientUrl=Sa.EditDocInClientUrl;Jc&&(Mb.BreadcrumbFolderName=Sa.BreadcrumbFolderName,Mb.BreadcrumbFolderUrl=Sa.BreadcrumbFolderUrl);Mb.OperationResult=
0;return Mb};l.CIh=function(Sa){switch(Sa.Errors[0].MessageId){case -414480287:Sa=2;break;case 650565124:Sa=1;break;case 1636785843:Sa=6;break;case -782844485:Sa=4;break;default:Sa=5}return Sa};Object(y.a)(l,"RenameFileManager",jc.a,[268,2]);var Ab=b(48),Tb=qb.a;vm(d,Tb);d.prototype.create=function(){var Sa=this;if(!this.WY){var Mb=Ub.a.D0a(Ab.b(),this.ma,"Task","IRenameFileManager");this.WY=Mb.task;var Jc=nb.GetServiceTaskFactory.create(this.$.da,137,this.ma,this.ub),Ib=nb.GetServiceTaskFactory.create(this.$.da,
155,this.ma,this.ub);sc.TaskExtensions.Ba(sc.TaskExtensions.we([Ib,Jc],this.ma),function(){var Nb=new l(Sa.$,Jc.result);Sa.$.da.Ha(120,Nb);Mb.setResult(Nb)},this.ma,3)}this.WY.continueWith(function(Nb){Sa.Gb(Nb.result)})};d.prototype.dispose=function(){Oa.a.Fa(this.renameFileManager);this.$=this.renameFileManager=null;Tb.prototype.dispose.call(this)};d.ka=function(Sa){Sa.da.Ha(119,new d(Sa))};Object(y.a)(d,"RenameFileManagerServiceFactory",qb.a,[]);c.prototype.Zc=function(){return!1};c.prototype.executeCommand=
function(Sa,Mb,Jc){return 2!==this.Fi.De(eb.a.M4f,2,Jc)?Wb.Task.Ta(!0):$b.a(Mb.command)};c.prototype.Kc=function(Sa,Mb){return 1204860550===Mb.command};c.prototype.gd=function(){return!1};Object(y.a)(c,"RenameFileDialogCommandHandler",null,[239]);var ib=$a.a;vm(a,ib);a.prototype.Pd=function(){var Sa=this;sc.TaskExtensions.Ba(nb.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){Sa.Gd([new c(Ha.AFrameworkApplication.Hb)])},this.ma,3)};a.ka=function(Sa){$a.a.he(131,new a(Sa))};Object(y.a)(a,
"RenameFileDialogCommandHandlerFactory",$a.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Rename");F.a.instance.rj(new v,7);(function(){fc.a.Ga(function(Sa){d.ka(Sa);m.ka(Sa)})})();fc.a.Ga(a.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rn.js.map/ba911f13c37a4f83bce87e2f30fb723a/EwaDS.rn.js.map