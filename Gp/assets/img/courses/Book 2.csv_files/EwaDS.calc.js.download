(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1067:function(y,F,b){function a(B){var r=this;this.$=B;(this.Cl=this.$.da.Aa(268))||d.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");var I=t.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?w.a.current.oo(53):w.a.current.oo(56);this.logger=new v.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);
this.Sba=new c(B,this.Cl);excelOnlineCalc.config.initCalc(this.logger,this.Cl?function(z){return r.Cl.isFeatureEnabled(z)}:function(){return!1},I);this.Wmg=excelOnlineCalc.config.calcConfig(this.Sba.localeInfo)}function c(B,r){B=b(1067).CalcHelper;r&&(r.Ke||d.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.jsg=B.nEe(r,B.aEe(r.nja));this.ksg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}b.r(F);y=b(0);var d=b(13),l=b(309),n;(function(B){B[B.paren=
0]="paren";B[B.lead=1]="lead";B[B.intern=2]="intern";B[B.trail=3]="trail";B[B.undefined=4]="undefined"})(n||(n={}));Object(y.b)("CurrencyFormatOption",n);var m;(function(B){B[B.none=-1]="none";B[B.mdy=0]="mdy";B[B.dmy=1]="dmy";B[B.ymd=2]="ymd";B[B.myd=3]="myd";B[B.dym=4]="dym";B[B.ydm=5]="ydm"})(m||(m={}));Object(y.b)("DateOrderOption",m);var f=b(9);c.prototype.formatNumber=function(B){return this.localeInfo.formatNumber(B)};Qk.Object.defineProperties(c.prototype,{localeInfo:{configurable:!0,enumerable:!0,
get:function(){return this.ksg}},localeData:{configurable:!0,enumerable:!0,get:function(){return this.jsg}}});Object(y.a)(c,"LocaleHolder",null,[]);var v=b(1127),w=b(53),t=b(1),A=b(20),x=b(14),u=b(192);b.d(F,"CalcHelper",function(){return a});a.prototype.Qah=function(){if(t.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.xa)return d.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;var B=this.$.xa.pa;return B?
B.index:(d.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.xa.pa.index};a.prototype.createParser=function(){var B={};B.config=this.config;return excelOnlineCalc.parse.createParser(B)};a.prototype.createNumberFormatter=function(){var B=this,r=t.EwaSettings.isChangeGateEnabled("OfficeVSO:5935278_numberFormatterGetTime")?function(I,z){return excelOnlineCalc.calc.getTime(B.config,I,z,"Estimation")}:function(){return excelOnlineCalc.util.failure(excelOnlineCalc.util.notImplemented(["getTime"]))};
r=excelOnlineCalc.numfmt.createFormatGlobals(this.config,r);return excelOnlineCalc.numfmt.createNumberFormatter(r)};a.prototype.a$g=function(B,r,I){r=excelOnlineCalc.location.gridCell(r,I);B=excelOnlineCalc.location.sheetIndex(this.documentLoc,B);return excelOnlineCalc.location.sheetGridCell(B,r)};a.prototype.Kmh=function(B,r){var I=excelOnlineCalc.calc.getEvalResultKind(B);switch(I){case 4:return{returnValue:B?this.Sba.localeInfo.trueName:this.Sba.localeInfo.falseName,kind:I};case 1:return{returnValue:t.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.hAc(this.Sba.formatNumber(B),r):this.Sba.formatNumber(B),kind:I};case 2:return{returnValue:t.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.hAc(B.toString(),r):B.toString(),kind:I};case 128:return{returnValue:"",kind:I};case 8:switch(B.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.Sba.localeInfo.errorNames[B.type],kind:I};default:return{returnValue:a.unknownError,kind:I}}case 32:return{returnValue:t.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.hAc(this.s$g(B,r),r):"##UNSUPPORTED: ARRAY",kind:I};default:return{returnValue:x.a.instance.fa(2153),kind:I}}};a.prototype.hAc=function(B,r){return B.length<=r?B:B.substring(0,r-3)+"..."};a.prototype.s$g=function(B,r){for(var I=this.Sba.localeInfo.leftBrace,z=0;z<B.rows;++z){for(var D=0;D<B.cols;++D)I+=B.opers[z][D],D<B.cols-1&&(I+=this.Sba.localeInfo.columnSeparator);z<B.rows-1&&(I+=this.Sba.localeInfo.rowSeparator)}return this.hAc(I,r-1)+this.Sba.localeInfo.rightBrace};a.nEe=function(B,r){r=
void 0===r?null:r;var I=a.Y3b(),z=B.Ke.TrueValueString,D=B.Ke.FalseValueString,V=B.Ke.DecimalSeparator.toString(),U=B.Ke.ListSeparator.toString(),Q=B.Ke.ColumnSeparator.toString(),la=B.Ke.RowSeparator.toString(),ba=B.Ke.ThousandsDataArray,S=B.Ke.ThousandSeparator.toString(),H=B.Ke.Lcid,T=B.Ke.Country,K=B.Ke.DigitsNumber,da=B.Ke.ExpSeparatedBySpace,fa=B.Ke.FractionSeparator.toString(),W=B.Ke.PercentSeparatedBySpace,ca=A.a.sVg(Enum.toString(n,B.Ke.CurrencyFormat)),ia=B.Ke.CurrencySymbolLead,ea=B.Ke.CurrencySeparatedBySpace,
qa=B.Ke.CurrencySymbolString,pa=B.Ke.DigitsCurrency,Pa=-1===B.Ke.DateOrder?"MDY":u.c(Enum.toString(m,B.Ke.DateOrder)),Ha=B.Ke.DateSeparator.toString(),Ya=B.Ke.DateAlternativeSeparator.toString(),Na=B.Ke.Year4Digits,eb=B.Ke.Month2Digits,Ia=B.Ke.Day2Digits,lb=B.Ke.LongDateFormat,hc=B.Ke.TimeSeparator.toString(),ma=null==B.Ke.TimeAltSeparator?null:B.Ke.TimeAltSeparator.toString(),Ja=B.Ke.Hour2Digits,Ta=B.Ke.Use24HourClock,pb=B.Ke.AmPmSeparatedBySpace,Db=[B.Ke.AmString,B.Ke.PmString],fb=B.Ke.DayNameShortArray,
xa=B.Ke.DayNameLongArray,ya=B.Ke.MonthNameShortArray,Ga=B.Ke.MonthNameLongArray,db=B.Ke.PictureSpecialArray,Ob=l.a.map(("\x00"+B.Ke.PictureSingleString).split(""),function(nb){return"\x00"===nb?null:nb}),Ec=B.Ke.PictureColorArray,wb=B.Ke.PictureDbnumArray,kb=B.Ke.RowLetter.toString(),vb=B.Ke.ColumnLetter.toString(),Gb=B.Ke.LeftBrace.toString(),Za=B.Ke.RightBrace.toString(),ub=B.Ke.LeftBracket.toString(),fc=B.Ke.RightBracket.toString(),$a=a.DZh(B.Ke);return excelOnlineCalc.calc.localeData(r,I,z,D,
kb,vb,Gb,Za,ub,fc,V,U,Q,la,ba,S,H,T,K,da,fa,W,ca,ia,ea,qa,pa,Pa,Ha,Ya,Na,eb,Ia,lb,hc,ma,Ja,Ta,pb,Db,fb,xa,ya,Ga,db,Ob,Ec,wb,$a,B.Ke.SysDateFormatString,B.Ke.SysTimeFormatString)};a.aEe=function(B){var r=[];if(!B)return r;B=yl(B);for(var I=B.next();!I.done;I=B.next()){I=I.value;var z=null;I.IsDynamicUdf||(z=excelOnlineCalc.calc.worksheetFunctionName(I.FunctionIndexInServer,I.NameUI));z&&Array.add(r,z)}return r};a.Y3b=function(){for(var B=[],r=Object.keys(f.a.errorNames),I=0;I<r.length;I++){var z=excelOnlineCalc.calc.errorTypeName(I+
1,r[I]);z&&Array.add(B,z)}return B};a.DZh=function(B){var r=Array(6);r[1]="#"+B.AllStructRefString;r[3]="#"+B.HeadersStructRefString;r[2]="#"+B.DataStructRefString;r[4]="#"+B.TotalsStructRefString;r[5]="#"+B.ThisRowStructRefString;return r};Qk.Object.defineProperties(a.prototype,{config:{configurable:!0,enumerable:!0,get:function(){return this.Wmg}}});a.unknownError="##ERR##";Object(y.a)(a,"CalcHelper",null,[])},1129:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.iti="literal";
a.operator="operator";a.func="function";a.namedRange="namedRange";a.range="range";a.glf="letName";a.all="*";a.QTd="structRefRange";Object(y.a)(a,"TraverseFormulaInterestTypes",null,[])},1130:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.cell="cell";a.range="range";a.row="row";a.column="col";Object(y.a)(a,"TraverseFormulaRefTypes",null,[])},1392:function(y,F,b){function a(O){var Ba=Qb.call(this)||this;Ba.$=O;Ba.fc();return Ba}function c(O){var Ba=Kb.call(this)||this;Ba.$=O;
Ba.fc();return Ba}function d(O,Ba){var ra=this;this.colors="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");this.s5a=this.w8f=!1;this.TCb=function(){ra.s5a=!1};this.Pc=O;this.gridView=eb.g(O);this.calcManager=Ba;this.wki=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5041666_ImplementLogRecorderOnEwaJS");this.dif=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5899330_SuspendResumeRichText");
this.scf=Pa.EwaSettings.la(719);this.gridView.zc.Lo(this.TCb)}function l(O,Ba,ra,ta){this.dKj=O;this.y9f=Ba;this.jhc=void 0===ta?!1:ta;ra?(this.G6a=ra.IsRangeRef,this.twa=ra.IsAbsoluteFirstRow,this.swa=ra.IsAbsoluteFirstColumn,this.DLa=ra.IsAbsoluteSecondRow,this.CLa=ra.IsAbsoluteSecondColumn):Q.ULS.shipAssertTag(537169941,0,!1,"MarqueeMetadata.Ctor: parseResultItem is null")}function n(O){var Ba=Wb.call(this)||this;Ba.$=O;Ba.fc();return Ba}function m(O){var Ba=this;this.vl=null;this.Hgg=!1;this.iLd=
this.instantaneousSupportInformationManager=this.SEb=null;this.Gtf={};this.Itf={};this.kce=null;this.onc=function(ra){Q.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");ra.mJd(Ba.onc);ra.nja.length?Ba.Tmc(ra,Sys.EventArgs.Empty):(Q.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ra.Gne(Ba.Tmc))};this.Tmc=function(ra){Q.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ra.aJd(Ba.Tmc);
Ba.DOj(ra)};this.onContentReady=function(){Ba.vl&&(Ba.instantaneousSupportInformationManager&&Ba.instantaneousSupportInformationManager.nmd||nb.Task.delay(0).CWCT(function(){Ba.vl.Oeb(1)},null,0,sc.a.current))};this.kvf=function(ra,ta){Ba.vl&&(Ba.instantaneousSupportInformationManager&&Ba.instantaneousSupportInformationManager.nmd||Ba.vl.uFe(ta.ed.block))};Q.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.Mcf=!1;this.vb=O;this.Cy=eb.g(O);this.EFc=null;this.gridView.$q(this.onContentReady);
this.gridView.Ca.KUc(this.kvf);this.$.da.Za(268,function(ra){ra.Ke?(Q.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),Ba.onc(ra,Sys.EventArgs.Empty)):(Q.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ra.aoe(Ba.onc))})}function f(){}function v(){}function w(){this.CLa=this.DLa=this.swa=this.twa=this.G6a=!1}function t(O){var Ba=this;this.QGd=null;this.Itd=this.PGd=this.TDb=!1;this.OEd=0;this.FEd=this.HEd=this.IEd=this.GEd=
-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.Jm=this.errorTypeNames=null;this.Yp=this.currentStateId=-1;this.nta="";this.O$=null;this.cBf=function(){Ba.setNumberFormats()};this.ud=function(){Q.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");Ba.Ze=new lb.a;Ba.Yp=-1;Ba.currentStateId=-1;Ba.nta="";Ba.prb=null;Ba.PGd=!1;Ba.Jm&&Ba.clearCache()};this.R5f=(this.Pc=O)?O.ya.CalcWebWorkerSmokeTestPingIntervalMS:this.R5f;this.Ze=
new lb.a;this.prb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Pc.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.roa()}function A(O){this.w3d=null;this.init(O)}function x(){}function u(O){this.Ena=O;this.Y5=new Db.a(fb.a.Gk());this.vlc=!1}function B(){this.sj=[];this.Icg=[];this.i_a={}}function r(O,Ba,ra,ta,Fa){this.type=O;this.fullName=Ba;this.range=ra;this.sheetId=ta;this.attributes=Fa;this.mE=null}function I(O,Ba){this.Rve=O;this.sheetName=Ba;this.cvc=!1}function z(O){var Ba=
ma.call(this)||this;Ba.$=O;Ba.fc();return Ba}function D(O,Ba){var ra=hc.call(this)||this;ra.cNa=T.a.Ue;ra.pZc=null;ra.Lic=!1;ra.tfb=!1;ra.ruf=function(){var ta=eb.g(ra.$);ta&&(ta=ta.wc(null))&&ra.Beb(ta.cell.Dm,!0)};ra.YLi=function(ta){ra.isActive()&&(pa.a.dr(ta.Errors)||!ta.Result?Q.ULS.sendTraceTag(537155726,0,50,"GetCategoryFromServer failed, ignoring - server errors: {0}",ta.Errors?ta.Errors.join(","):"None"):(ta=ta.Result,Q.ULS.sendTraceTag(537155725,0,50,"Updating number format category cache, format index = {0}, category = {1}",
ta.Index,ta.Category),ra.Tsj(ta.Index,ta.Category),ra.raiseEvent(D.r_c,new da.a(ta.Index,ta.Category),ra)))};ra.refresh=function(){Q.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");ra.e1b();if(ra.isActive()&&ra.ea.oc.allowEdits){if(ra.tfb||ra.ln&&!(ra.ea.FAb>ra.cNa))ra.ECc();else{Q.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information.");var ta=ra.$.na.ta;var Fa=ra.ln?ra.ln.Digest:
"",cb=ra.GMi,Wa=ra.FMi,mb=ta.Na(1,null);mb.previousResponseDigest=Fa;ta=W.i(ta,"GetInstantaneousSupportInformation",mb,cb,Wa,null,null,132);ra.qfd=ta}Q.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info.");ra.x_e()}};ra.Iyf=function(ta){Q.ULS.sendTraceTag(537155716,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = {0}, HTTP status = {1}.",ta.data.status,ta.data.httpStatus);ra.eKa=null};ra.PN=function(){ra.tfb=
!1;ra.ea.TF(ra.PN);ra.XQa(ra.Lic?D.kQd:D.Txd)};ra.dd=function(ta,Fa){Q.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");fa.a(Fa)&&ra.XQa(D.kQd)};ra.Mf=function(){Q.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==ra.$.workbookContext.CalcMode&&ra.eyd(0===ra.$.workbookContext.CalcMode)};ra.ud=function(){Q.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
ra.XQa(D.kQd);Pa.EwaSettings.la(306)&&3!==ra.$.workbookContext.CalcMode&&ra.eyd(0===ra.$.workbookContext.CalcMode)};ra.yMi=function(ta,Fa,cb){Q.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");ra.eKa=null;ra.isActive()?ta.StateId===T.a.Ue?(Q.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),ra.ECc()):!ta.Result||ra.UX&&ra.UX.length?ra.XQa(D.Txd):ra.oCf(ta,Fa,
cb):Q.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};ra.oCf=function(ta){ra.UX=ta.Result;Q.ULS.sendTraceTag(537155681,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned {0} functions.",ra.UX?ra.UX.length:-1);ta=!1;if(ra.UX){for(var Fa=yl(ra.UX),cb=Fa.next();!cb.done;cb=Fa.next())if(cb=cb.value)ra.fWe[cb.NameUI.toLocaleUpperCase()]=cb.FunctionIndex.toString(),
cb.NameUI!==cb.NameDataStrings&&(ra.fWe[cb.NameDataStrings.toLocaleUpperCase()]=cb.FunctionIndex.toString(),ta=!0),ra.LGh.ia(cb.FunctionIndex,cb.NameUI);ra.raiseEvent(D.wcd,Sys.EventArgs.Empty,ra)}ta&&Q.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};ra.GMi=function(ta){if(ra.isActive())if(Q.ULS.shipAssertTag(537155679,0,!!ra.$,"null ewaControl"),ra.Lic=!1,ra.cNa=ta.StateId,ra.cNa===T.a.Ue)ra.Lic=!0,ra.ECc();
else{if(ta.Result){var Fa=ra.ln;ra.ln=ta.Result;Q.ULS.sendTraceTag(537155678,0,50,"InstantaneousSupportInformation updated, new result digest: {0}.",ra.ln.Digest);ta=[];if(Fa)ta=D.bUh(Fa.NumberFormats,ra.ln.NumberFormats);else for(Fa=0;Fa<ra.ln.NumberFormats.length;Fa++)ra.Vlc.ia(Fa,ra.ln.NumberFormats[Fa].NumberFormatCategory);Fa=yl(ta);for(var cb=Fa.next();!cb.done;cb=Fa.next())cb=cb.value,ra.Vlc.ia(cb,ra.ln.NumberFormats[cb].NumberFormatCategory);ra.raiseEvent(D.Byd,new U(ta),ra);Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",
!1)&&ra.raiseEvent(D.emf)}ra.XQa(D.Txd)}};ra.FMi=function(ta){ra.isActive()&&(10===ta.data.status?Q.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(Q.ULS.sendTraceTag(21311555,0,10,"Failed to update instantaneous support information, status = {0}, HTTP status = {1}.",ta.data.status,ta.data.httpStatus),ra.Lic=!0,ra.ECc()))};Q.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");ra.ea=O;ra.$=Ba;ra.uGb=null;ra.qfd=null;ra.eKa=null;
ra.ln=null;ra.Vlc=new lb.a;ra.xub=new lb.a;ra.UX=[];ra.LGh=new lb.a;ra.fWe={};ra.ea.Tj(ra.dd);ra.$.Pk(ra.ud);eb.g(ra.$).ha.Jra(ra.ruf);Pa.EwaSettings.la(306)&&ra.ea.Bt(ra.Mf);ra.XQa(D.O$e);Q.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end");return ra}function V(O){this.data=O}function U(O){var Ba=ca.call(this)||this;Ba.y0j=O;return Ba}b.r(F);y=b(10);F=b(0);var Q=b(13),la=b(214),ba=b(88),S=b(5),H=b(185),T=b(9),K=b(36),da=b(1018),fa=b(217),W=b(81),ca=Sys.EventArgs;vm(U,
ca);Object(F.a)(U,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var ia=b(44),ea=b(42),qa=b(32),pa=b(27),Pa=b(1),Ha=b(659),Ya=b(20),Na=b(272),eb=b(19),Ia=b(193);Object(F.a)(V,"NumberFormatDataHolder",null,[]);var lb=b(123),hc=K.a;vm(D,hc);D.prototype.aoe=function(O){this.addHandler(D.Byd,O)};D.prototype.mJd=function(O){this.removeHandler(D.Byd,O)};D.prototype.jEg=function(O){this.addHandler(D.r_c,O)};D.prototype.Lbj=function(O){this.removeHandler(D.r_c,O)};D.prototype.Gne=function(O){this.addHandler(D.wcd,
O)};D.prototype.aJd=function(O){this.removeHandler(D.wcd,O)};D.prototype.OFg=function(O){this.addHandler(D.emf,O)};D.prototype.Beb=function(O,Ba){var ra=this.Vlc.Hc(O,0);var ta=ra.value;ra=ra.returnValue;!ra&&0<O&&this.$&&(Q.ULS.sendTraceTag(537155735,0,50,"InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache {0}",O),this.ULh(O),Ba&&(ta=this.TLh(O),ra=!0),Ha.a(O,this.$.OI)&&(ta=6));return{returnValue:ra,category:ta}};D.prototype.aji=
function(O){var Ba=this.Beb(O,!0);var ra=Ba.category;if(Ba.returnValue)return 6===ra;Q.ULS.sendTraceTag(537155733,0,50,"InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index {0}",O);return!1};D.prototype.iFh=function(O){Q.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.eKa=W.x(this.$.na.ta,{FilterType:0},Na.b(this.oCf,O),this.Iyf,null,null,null)};D.prototype.zVe=
function(){this.XQa(D.O$e)};D.prototype.eyd=function(O){this.pZc=O};D.prototype.ULh=function(O){if(this.xub&&this.$){var Ba=this.xub.Hc(O);var ra=Ba.value;if(!Ba.returnValue||ra.isCompleted){Q.ULS.sendTraceTag(537155728,0,50,"Getting number format category for format index: {0}",O);ra=this.$.na.ta;Ba=this.YLi;var ta=ra.Na(1,null);ta.ifmt=O;(ra=W.i(ra,"GetNumberFormatCategory",ta,Ba,null,null,null,4))&&this.xub.ia(O,ra)}}else Q.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")};
D.prototype.TLh=function(O){return 1<=O&&8>=O?1:9<=O&&12>=O?2:13===O||14===O?6:15===O?8:17===O|18===O?7:19===O?4:16===O||20<=O&&29>=O||31===O?11:30===O?9:32<=O&&35>=O?3:0};D.prototype.isActive=function(){var O=void 0===this.ea||null===this.ea,Ba=!O&&this.ea.rc;Q.ULS.sendTraceTag(537155727,0,50,"InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:{0} - sessionStateManager IsNullOrUndefined: {1}",Ba,O);return Ba};D.prototype.Tsj=function(O,Ba){this.Vlc.ia(O,
Ba)};D.prototype.dispose=function(){ba.a.Fa(this.uGb);this.uGb=null;this.e1b();for(var O=yl(this.xub),Ba=O.next();!Ba.done;Ba=O.next())(Ba=Ba.value.value)&&!Ba.isCompleted&&S.AFrameworkApplication.Kd.nu(Ba.Et);this.xub=null;this.ea&&(this.ea.kk(this.dd),this.tfb&&this.ea.TF(this.PN),this.tfb=!1,this.ea.Dw(this.Mf));this.ea=null;this.$&&eb.g(this.$)&&eb.g(this.$).ha&&(eb.g(this.$).ha.Gza(this.ruf),this.$.ol(this.ud));this.$=null;hc.prototype.dispose.call(this)};D.prototype.isFeatureEnabled=function(O){try{switch(O){case "LocaleLongDateFormat":return Pa.EwaSettings.la(197);
case "GetLocaleDayNames":return Pa.EwaSettings.la(198);case "CalculateTextWidthIgnoreLetterSpacing":return Pa.EwaSettings.la(287);case "OfficeVSO:3657744_CalcFixForDateFormat":return Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",
!1);case "CalcNewFunctions":return Pa.EwaSettings.la(248);case "CalcContractChecks":return Pa.EwaSettings.la(249);case "CalcSupportDynamicArrays":return Pa.EwaSettings.la(250);case "CalcFormatCalculations":return Pa.EwaSettings.la(251);case "CalcFormulaCacheAPIChanges":return Pa.EwaSettings.la(252);case "CalcStrictFormulaChecking":return Pa.EwaSettings.la(253);case "CalcSupportRowReference":return Pa.EwaSettings.la(264);case "CalcParserUsesPledges":return Pa.EwaSettings.la(311);case "CalcWebWorker":return!0;
case "CalcWebWorkerTest":return Pa.EwaSettings.la(310);case "CalcLookupFunctions":return Pa.EwaSettings.la(312);case "CalcLogStopWatch":return Pa.EwaSettings.la(380);case "CalcPreventSpillingHack":return Pa.EwaSettings.la(254);case "CalcDynamicArrayOperators":return Pa.EwaSettings.la(103);case "CalcDotOperator":return Pa.EwaSettings.la(609);case "CalcLetFunction":return Pa.EwaSettings.la(730);default:return O.startsWith("OfficeVSO:")?Pa.EwaSettings.isChangeGateEnabled(O):!1}}catch(Ba){return Q.ULS.sendTraceTag(537155724,
0,15,"InstantaneousSupportInformation.IsFeatureEnabled({0}): feature parsing failed, returning false. Exception: {1}.",O,Ba.toString()),!1}};D.prototype.XQa=function(O){this.isActive()&&this.ea.oc.allowEdits?(ba.a.Fa(this.uGb),this.uGb=null,this.uGb=ia.a.instance.create(this.refresh,O,ea.a.Fdi)):Q.ULS.sendTraceTag(537155723,0,50,"InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits {0}, IsEditMode {1}",void 0!==this.ea&&null!==this.ea&&void 0!==
this.ea.oc&&null!==this.ea.oc?this.ea.oc.allowEdits:!1,void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode)};D.prototype.x_e=function(){Q.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.eKa?Q.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.UX&&this.UX.length||(this.eKa=W.x(this.$.na.ta,{FilterType:0},this.yMi,this.Iyf,null,null,null)):Q.ULS.sendTraceTag(537155717,
0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")};D.prototype.ECc=function(){this.tfb||(this.tfb=!0,this.ea.JG(this.PN))};D.prototype.e1b=function(){this.nu(this.qfd);this.nu(this.eKa);this.eKa=this.qfd=null};D.prototype.nu=function(O){O&&!O.isCompleted&&this.$.na.ta.Aeb(O.Et)};D.bUh=function(O,Ba){if(!O||!O.length)return[];if(!Ba||!Ba.length){Ba=Array(O.length);for(var ra=0;ra<O.length;++ra)Ba[ra]=O[ra].IfmtIndex;return Ba}var ta=new lb.a;
O=yl(O);for(ra=O.next();!ra.done;ra=O.next())ra=ra.value,ta.ia(ra.IfmtIndex,new V(ra));O=new H.a;ra={};Ba=yl(Ba);for(var Fa=Ba.next();!Fa.done;ra={Sfb:ra.Sfb,YOb:ra.YOb},Fa=Ba.next())ra.Sfb=Fa.value,ra.YOb=void 0,function(cb){return function(){var Wa=ta.Hc(cb.Sfb.IfmtIndex);cb.YOb=Wa.value;return Wa}}(ra)().returnValue&&ra.YOb.data.FormatString===ra.Sfb.FormatString||O.add(ra.Sfb.IfmtIndex);return O.toArray()};Qk.Object.defineProperties(D.prototype,{Ke:{configurable:!0,enumerable:!0,get:function(){return this.ln?
this.ln.LocaleInformation:null}},hca:{configurable:!0,enumerable:!0,get:function(){return this.ln?this.ln.NumberFormats:[]}},nja:{configurable:!0,enumerable:!0,get:function(){this.UX&&this.UX.length||this.x_e();return this.UX}},Bdi:{configurable:!0,enumerable:!0,get:function(){return this.ln&&void 0!==this.ln.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.ln.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.ln.InstantaneousCalcWebWorkerPrecisionSamplingRate:D.xch}},Edi:{configurable:!0,
enumerable:!0,get:function(){return this.ln&&void 0!==this.ln.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.ln.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.ln.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:D.Bch}},Ddi:{configurable:!0,enumerable:!0,get:function(){return this.ln&&void 0!==this.ln.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.ln.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.ln.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:
D.Ach}},Cdi:{configurable:!0,enumerable:!0,get:function(){return this.ln&&void 0!==this.ln.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.ln.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.ln.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:D.zch}},ybf:{configurable:!0,enumerable:!0,get:function(){return this.ln?this.ln.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:D.ych}},nmd:{configurable:!0,enumerable:!0,get:function(){return null!==this.pZc?this.pZc:
this.ln?this.ln.InstantaneousCalcManualMode:!1}}});D.Byd="isim0";D.r_c="isim1";D.wcd="isim2";D.emf="isim3";D.O$e=100;D.kQd=1E3;D.Txd=3E5;D.xch=.001;D.Bch=.1;D.Ach=.2;D.zch=.001;D.ych=50;Object(F.a)(D,"InstantaneousSupportInformationManager",K.a,[710,2]);var ma=la.a;vm(z,ma);z.prototype.create=function(){this.$&&(Q.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script"),this.Gb(this.$.da.Aa(268)||new D(this.$.ea,this.$)))};z.ka=function(O){if(!O)throw Error.argumentNull("ewaControl");
O.da.Ha(246,new z(O))};Object(F.a)(z,"InstantaneousSupportInformationManagerFactory",la.a,[]);var Ja=b(80),Ta=b(109),pb=b(84);Object(F.a)(I,"CalcBlockInformation",null,[]);Object(F.a)(r,"CalcNamedObject",null,[]);Object(F.a)(B,"GridCache",null,[]);var Db=b(805),fb=b(574);Object(F.a)(u,"SheetInformation",null,[]);var xa=b(1067),ya;(function(O){O[O.initialization=0]="initialization";O[O.contentReady=1]="contentReady";O[O.cellEdit=2]="cellEdit"})(ya||(ya={}));Object(F.b)("UpdateDataTrigger",ya);var Ga=
b(61);x.local="Local";x.sKj="Thread";Object(F.a)(x,"RecalcServiceCreateMode",null,[]);var db=b(43),Ob=b(39),Ec=b(154);A.prototype.init=function(O){this.w3d=new lb.a;if(void 0!==O&&null!==O&&void 0!==O.HeadersList&&null!==O.HeadersList&&0<O.HeadersList.length){O=yl(O.HeadersList);for(var Ba=O.next();!Ba.done;Ba=O.next())Ba=Ba.value,this.u$.ia(Ba.Index,Ba.Name)}};Qk.Object.defineProperties(A.prototype,{u$:{configurable:!0,enumerable:!0,get:function(){return this.w3d}}});Object(F.a)(A,"ColHeadersListData",
null,[]);var wb=b(94);b(192);var kb=b(335);t.prototype.dispose=function(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.mJd(this.cBf);this.Pc&&this.Pc.ol(this.ud);this.close()};t.prototype.Oeb=function(O){if(!this.Jm)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Pc.da.Aa(268),!this.instantaneousSupportInformationManager))return Q.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),
!1;2!==O&&(this.currentStateId=this.Pc.ea.FAb,this.currentStateId===T.a.Ue&&(this.currentStateId=this.Pc.ea.uf));if(1===O&&this.currentStateId<this.Yp)return Q.ULS.sendTraceTag(537170197,0,50,"CalcAsyncEngine::UpdateData() currentStateId:{0} < lastUpdatedStateId:{1} - ignoring update",this.currentStateId,this.Yp),!1;this.Rqj();0!==O&&this.PGd||(this.jvj(),this.osj(),this.Zsj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.aoe(this.cBf),this.Pc.Pk(this.ud),this.PGd=!0);this.H7i();
var Ba=!1;0===O&&(Ba=this.rbi());if(0!==O||Ba)this.uuj()?(this.Zuj(O),this.Yuj(),this.Yp=this.currentStateId,this.XXg()):Q.ULS.sendTraceTag(537170196,0,15,"CalcAsyncEngine::UpdateData() for StateId:{0} failed - no Sheets information",this.currentStateId);2!==O&&this.resumeRecalc();return!0};t.prototype.evalFormula=function(O){if(!this.Jm)return Q.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});O=this.Jm.evalFormula(this.Pc.ea.uf,O,Ga.d(this.Pc.xa.pa));
this.resumeRecalc();return O};t.prototype.evalFormulaRange=function(O,Ba,ra){if(!this.Jm)return Q.ULS.sendTraceTag(537170194,0,15,"CalcAsyncEngine.EvalFormulaRange: recalc engine is null"),Promise.reject(null);Q.ULS.shipAssertTag(537170193,0,Ba.isSingle,"CalcAsyncEngine.EvalFormulaRange: originCell Range must be a single cell.");ra=db.j(ra);Ba=db.o(Ba,this.Pc);Ba=excelOnlineCalc.calc.cellLocation(Ba.FirstRow,Ba.FirstColumn);ra=t.wU("EvalFormulaRange",Ga.d(this.Pc.xa.pa),ra.FirstRow,ra.FirstColumn,
ra.LastRow,ra.LastColumn);Q.ULS.sendTraceTag(537170190,0,50,"CalcAsyncEngine.EvalFormulaRange: calling calc.ts's EvalFormulaRange API for state ID {0}",this.Yp);O=this.Jm.evalFormulaRange(this.Yp,O,Ba,ra,null);O.then(function(ta){if(excelOnlineCalc.util.isSuccess(ta)){var Fa=[];ta=yl(ta.value);for(var cb=ta.next();!cb.done;cb=ta.next())cb=cb.value,excelOnlineCalc.util.isSuccess(cb.value)||(cb=cb.value.reason.kind.toString(),Array.contains(Fa,cb)||Fa.push(cb));Q.ULS.sendTraceTag(537170191,0,50,"CalcAsyncEngine.EvalFormulaRange - Evaluation of range complete. FailureReasons: {0}",
Fa.length?Sys.Serialization.JavaScriptSerializer.serialize(Fa):"None")}else Q.ULS.sendTraceTag(537170192,0,15,"CalcAsyncEngine.EvalFormulaRange: Calc.EvalFormulaRange returned a failed object. failure reason: {0}",ta.reason.kind)}).catch(function(ta){Q.ULS.sendTraceTag(537170189,0,10,"CalcAsyncEngine.EvalFormulaRange - promise rejected: {0}",Sys.Serialization.JavaScriptSerializer.serialize(ta));return Promise.reject(ta)});this.resumeRecalc();return O};t.prototype.NTg=function(O,Ba,ra,ta){ta=void 0===
ta?null:ta;if(this.Jm&&O){var Fa=Ga.d(this.Pc.xa.pa),cb=O.cell.oK-1,Wa=O.cell.nK-1,mb=cb,kc=Wa,Ab=null;ta&&(Ab=excelOnlineCalc.calc.cellLocation(cb,Wa),cb=ta.top-1,Wa=ta.left-1,mb=ta.bottom-1,kc=ta.right-1);if(O.cell.Rt)if(ta=O.cell.Rt.kYc,ta===T.a.Ue)Q.ULS.sendTraceTag(537170187,0,15,"CalcAsyncEngine::CalculateFormula() BlockRevision unknown for block:{0}",O.cell.Rt.Yd);else if(ta<this.Yp)Q.ULS.sendTraceTag(537170185,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < lastUpdatedStateId:{3}",
cb,Wa,ta,this.Yp);else if(ta<this.currentStateId)Q.ULS.sendTraceTag(537170184,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < currentStateId:{3}",cb,Wa,ta,this.currentStateId);else if(this.TDb||(this.Jm.setOnRecalcResults(ra),this.TDb=!0),this.ucg()&&!this.Oeb(2))Q.ULS.sendTraceTag(537170183,0,15,"CalcAsyncEngine.CalculateFormula: UpdateData failed");else{kc=t.wU("CalculateFormula.cell",Fa,cb,Wa,mb,kc);ra=[];var Tb=eb.g(this.Pc);mb=Tb.Jh;eb.g(this.Pc).$a.$i&&
(mb=Tb.Sf(1).Jh,mb.tna(1,1),mb.tna(3,1));Tb=null;mb?Tb=t.wU("CalculateFormula.viewport",Fa,mb.top-1,mb.left-1,mb.bottom-1,mb.right-1):Q.ULS.sendTraceTag(537170182,0,50,"CalcAsyncEngine::CalculateFormula() viewportRange is null, calc will use entire sheet...");Ba=excelOnlineCalc.calc.inferredRangeFormulaEdit(kc,Ba,Ab,Tb);Array.add(ra,Ba);O=mb?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Fa,cb,Wa,Ya.a.OZb(O.cell.text),
ta,mb.top-1,mb.left-1,mb.bottom-1,mb.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Fa,cb,Wa,Ya.a.OZb(O.cell.text),ta,"","","","");Q.ULS.sendTraceTag(537170181,0,50,O);this.Jm.editRangeFormulas(ta,ra);this.resumeRecalc()}else Q.ULS.sendTraceTag(537170186,0,15,"CalcAsyncEngine::CalculateFormula() GridBlockModelProxy is null cell:({0},{1})",O.cell.oK,O.cell.nK)}else Q.ULS.sendTraceTag(537170188,0,15,"CalcAsyncEngine::CalculateFormula() recalc engine is null:{0}, modifiedCell is null:{1}",
!this.Jm,!O)};t.prototype.LTg=function(O,Ba,ra,ta){ta=void 0===ta?null:ta;var Fa=Ga.d(this.Pc.xa.pa),cb=O.cell.oK-1,Wa=O.cell.nK-1,mb=cb,kc=Wa,Ab=null;ta&&(Ab=excelOnlineCalc.calc.cellLocation(cb,Wa),cb=ta.top-1,Wa=ta.left-1,mb=ta.bottom-1,kc=ta.right-1);ra=this.nZd(O,ra,"SetCell");0>ra||(kc=t.wU("CalculateFormula.cell",Fa,cb,Wa,mb,kc),mb=[],ta=this.Mhd(Fa),Ba=excelOnlineCalc.calc.inferredRangeFormulaEdit(kc,Ba,Ab,ta),Array.add(mb,Ba),O=(Ba=this.Q4e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Fa,cb,Wa,Ya.a.OZb(O.cell.text),ra,Ba.top-1,Ba.left-1,Ba.bottom-1,Ba.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Fa,cb,Wa,Ya.a.OZb(O.cell.text),ra,"","","",""),Q.ULS.sendTraceTag(537170180,0,50,O),this.Jm.editRangeFormulas(ra,mb),this.resumeRecalc())};t.prototype.Qsb=function(O,Ba,ra,ta){if(!this.Jm)return Q.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),
Promise.reject("RecalcService is null");Q.ULS.shipAssertTag(537170178,0,ra.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");var Fa=Ga.d(this.Pc.xa.pa),cb=this.Mhd(Fa),Wa=null;if(O){Wa=[];O=yl(O);for(var mb=O.next();!mb.done;mb=O.next())if(mb=mb.value,mb.column!==ra.left){var kc=mb.row-1;var Ab=mb.column-1;kc=t.wU("EvalFormulaRangeOnClone.cell",Fa,kc,Ab,kc,Ab);Ab=mb.text;Array.add(Wa,excelOnlineCalc.calc.rangeWrite(kc,excelOnlineCalc.calc.valueCellData(Ab,Ab,mb.Dm,
null)))}}ra=excelOnlineCalc.calc.cellLocation(ra.top-1,ra.left-1);Ba=t.wU("EvalFormulaRangeOnClone.outputColumnRange",Fa,Ba.top-1,Ba.left-1,Ba.bottom-1,Ba.right-1);ta=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(Ba,ta,ra,cb)];Wa=this.Jm.evalOnClonedModel(Wa,ta);this.resumeRecalc();return Wa};t.prototype.uFe=function(O){var Ba=null;try{if(O)if(this.nta=eb.g(this.Pc).Ca.Xua(O),this.currentStateId=O.ISa,this.currentStateId<this.Yp||this.currentStateId===T.a.Ue)Q.ULS.sendTraceTag(537170176,0,50,
"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:{0} blockRevision:{1} < lastUpdatedStateId:{2}",this.nta,this.currentStateId,this.Yp);else{if(this.wbi(),!this.MOg()){var ra=String.format("CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:{0} StateId:{1}",this.nta,this.currentStateId);Ba=this.Pc.Wb.Ic("ModelUpdate",ra);this.prb=this.Kvb(O.pa.sheetName);if(!this.prb){var ta=!!(this.Pc.Jd&32);Q.ULS.sendTraceTag(537170147,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets {0}, scratchPad:{1}, sheetNameLength:{2} Hash:{3}",
this.Ze.xb(this.currentStateId)&&this.Ze.oa(this.currentStateId).sj?this.Ze.oa(this.currentStateId).sj.length:0,ta,O.pa.sheetName?O.pa.sheetName.length:-1,O.pa.hash)}else if(eb.g(this.Pc).Ca.Kl.t1a(O.Yd)){var Fa=O.Cf;if(Fa){var cb=Fa.getCalcBlockModel();if(!cb)Q.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.EOg(cb)){this.Ze.oa(this.currentStateId).i_a[this.nta]=new I(cb,O.pa.sheetName);var Wa=O.te;Wa?this.VBg(Wa.NamedObjects):
Q.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else Q.ULS.sendTraceTag(537170146,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:{0}",this.nta)}}}else Q.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{Ba&&Ba.stop()}};t.prototype.Qvb=function(O){if(!this.Ze.oa(this.currentStateId).sj||!this.Ze.oa(this.currentStateId).sj[0])return null;
var Ba=this.Ze.oa(this.currentStateId).sj[0].Y5;if(!Ba||!Ba.xb(O.name))return null;Ba=Ba.oa(O.name);if(!Ba||!Ba.mE)return null;O=new H.a;Ba=yl(Ba.mE.u$);for(var ra=Ba.next();!ra.done;ra=Ba.next())O.add(ra.value.value);return O};t.prototype.getNameLoc=function(O,Ba){return this.Lgc()?this.Ze.oa(this.currentStateId).sj[0].Y5.xb(Ba)?(O=excelOnlineCalc.location.nameLoc(O,Ba),excelOnlineCalc.util.success(O)):excelOnlineCalc.util.success(null):(O=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(O))};
t.prototype.getContainingTable=function(O){if(!this.Lgc())return O=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(O);var Ba=O.range.col,ra=O.range.row,ta=this.Ze.oa(this.currentStateId).sj[0].Y5,Fa=null;ta=yl(ta);for(var cb=ta.next();!cb.done;cb=ta.next())if(cb=cb.value.value,2===cb.type&&Ya.a.equals(O.sheet.index.toString(),cb.sheetId,!0)){var Wa=cb.range;Ba>=Wa.left-1&&Ba<=Wa.right-1&&ra<=Wa.bottom-1&&ra>=Wa.top-1&&(Fa=excelOnlineCalc.location.nameScope(this.documentLoc,cb.sheetId),
Fa=excelOnlineCalc.location.nameLoc(Fa,cb.fullName))}return Fa?excelOnlineCalc.util.success(Fa):excelOnlineCalc.util.success(null)};t.prototype.getStructRefColumn=function(O,Ba){if(!this.Lgc()){var ra=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(ra)}ra=O.name;var ta=this.Ze.oa(this.currentStateId).sj[0].Y5;if(ta.xb(ra)){ta=ta.oa(ra);var Fa=ta.range;if(2!==ta.type)return excelOnlineCalc.util.failure(this.U3c(5));var cb=ta.mE?ta.mE.u$:null;if(!cb)return excelOnlineCalc.util.success(null);
for(var Wa=yl(cb),mb=Wa.next();!mb.done;mb=Wa.next())if(mb=mb.value,Ya.a.equals(mb.value,Ba,!0))return O=excelOnlineCalc.location.documentLoc(O.scope.document.path,O.scope.document.name),O=excelOnlineCalc.location.sheetIndex(O,ta.sheetId),Fa=excelOnlineCalc.location.gridRange(Fa.top-1,mb.key,Fa.bottom-Fa.top+1,1),Fa=excelOnlineCalc.location.sheetGridRange(O,Fa),ra=excelOnlineCalc.location.structRefColumnLoc(ra,Fa,!!(ta.attributes&16),!!(ta.attributes&8)),excelOnlineCalc.util.success(ra);return Fa.right-
Fa.left+1!==cb.count?(ra=excelOnlineCalc.util.unavailable([17,O,Ba]),excelOnlineCalc.util.failure(ra)):excelOnlineCalc.util.failure(this.U3c(0))}return excelOnlineCalc.util.success(null)};t.prototype.getStructRefSpecialRef=function(O,Ba){if(!this.Lgc())return Ba=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ba);var ra=this.Ze.oa(this.currentStateId).sj[0].Y5;if(ra.xb(O.name)){var ta=ra.oa(O.name);if(2!==ta.type)return excelOnlineCalc.util.failure(this.U3c(5));ra=!!(ta.attributes&
16);var Fa=!!(ta.attributes&8),cb=ra?1:0,Wa=Fa?1:0;O=excelOnlineCalc.location.documentLoc(O.scope.document.path,O.scope.document.name);O=excelOnlineCalc.location.sheetIndex(O,ta.sheetId);ta=ta.range;var mb={};if(1===Ba)mb=excelOnlineCalc.location.gridRange(ta.top-cb-1,ta.left-1,ta.bottom+Wa-ta.top+cb+1,ta.right-ta.left+1);else if(2===Ba)mb=excelOnlineCalc.location.gridRange(ta.top-1,ta.left-1,ta.bottom-ta.top+1,ta.right-ta.left+1);else if(3===Ba)if(ra)mb=excelOnlineCalc.location.gridRange(ta.top-
2,ta.left-1,1,ta.right-ta.left+1);else return excelOnlineCalc.util.success(null);else if(4===Ba)if(Fa)mb=excelOnlineCalc.location.gridRange(ta.bottom,ta.left-1,1,ta.right-ta.left+1);else return excelOnlineCalc.util.success(null);Ba=excelOnlineCalc.location.sheetGridRange(O,mb);return excelOnlineCalc.util.success(Ba)}return excelOnlineCalc.util.success(null)};t.prototype.getDocumentLoc=function(O,Ba){if((Ya.a.equals(O,this.documentLoc.path,!0)||!O)&&Ya.a.equals(Ba,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
O=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(O,Ba)]);return excelOnlineCalc.util.failure(O)};t.prototype.getSheetIndex=function(O,Ba){if(!this.Ze.xb(this.currentStateId)||!this.Ze.oa(this.currentStateId).sj)return Ba=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ba);O=this.Ze.oa(this.currentStateId).sj;for(var ra=1;ra<O.length;ra++)if(Ya.a.equals(O[ra].Ena.sheetName,Ba,!0))return excelOnlineCalc.util.success(O[ra].Ena.sheetId);return excelOnlineCalc.util.success(null)};
t.prototype.getSheetName=function(O,Ba){if(!this.Ze.xb(this.currentStateId)||!this.Ze.oa(this.currentStateId).sj)return Ba=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ba);O=this.Ze.oa(this.currentStateId).sj;for(var ra=1;ra<O.length;ra++)if(Ya.a.equals(O[ra].Ena.sheetId,Ba,!0))return excelOnlineCalc.util.success(O[ra].Ena.sheetName);return excelOnlineCalc.util.success(null)};t.prototype.getUserDefinedFuncLoc=function(){return excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"])};
t.prototype.getSheetRangeIndexes=function(){return excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"])};t.prototype.MTg=function(O,Ba,ra){var ta=eb.g(this.Pc),Fa=ta.wc(Ba);Fa=this.nZd(Fa,null,"CopyPaste");ra=this.nZd(ta.wc(O),ra,"CopyPaste");if(0>Fa||0>ra||Fa!==ra)Q.ULS.sendTraceTag(537170143,0,15,"CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:{0}, targetRevision:{1}.",ra,Fa);else{ra=[];ta=Ga.d(this.Pc.xa.pa);
var cb=this.Mhd(ta);O=t.wU("CalculateFormulaForCopyPaste.srcRange",ta,O.top-1,O.left-1,O.bottom-1,O.right-1);Ba=t.wU("CalculateFormulaForCopyPaste.targetRange",ta,Ba.top-1,Ba.left-1,Ba.bottom-1,Ba.right-1);Ba=excelOnlineCalc.calc.copyPasteRangePasteEdit(Ba,O,cb);Array.add(ra,Ba);Ba=cb?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",ta,Fa,cb.row,cb.column,cb.lastRow,cb.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
ta,Fa,"","","","");Q.ULS.sendTraceTag(537170142,0,50,Ba);this.Jm.editRangePaste(Fa,ra);this.resumeRecalc()}};t.prototype.Mhd=function(O){var Ba=this.Q4e(),ra=null;Ba?ra=t.wU("GetViewport.viewport",O,Ba.top-1,Ba.left-1,Ba.bottom-1,Ba.right-1):Q.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return ra};t.prototype.Q4e=function(){var O=eb.g(this.Pc),Ba=O.Jh;if(eb.g(this.Pc).$a.$i){Ba=O.Sf(1).Jh;if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!Ba)return Q.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;Ba.tna(1,1);Ba.tna(3,1)}return Ba};t.prototype.nZd=function(O,Ba,ra){if(!this.Jm||!O)return Q.ULS.sendTraceTag(537170139,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:{0}, modifiedCell is null:{1}, operation:{2}",!this.Jm,!O,ra),-1;var ta=O.cell.oK-1,Fa=O.cell.nK-1;if(O.cell.Rt){var cb=O.cell.Rt.kYc;if(cb===T.a.Ue)return Q.ULS.sendTraceTag(537170138,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:{0}, operation:{1}",
O.cell.Rt.Yd,ra),-1}else return Q.ULS.sendTraceTag(537170137,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:({0},{1}), operation:{2}",O.cell.oK,O.cell.nK,ra),-1;if(cb<this.Yp)return Q.ULS.sendTraceTag(537170136,0,50,"CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < lastUpdatedStateId:{3}, operation:{4}",ta,Fa,cb,this.Yp,ra),-1;if(cb<this.currentStateId)return Q.ULS.sendTraceTag(537170135,0,50,"CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < currentStateId:{3}, operation:{4}",
ta,Fa,cb,this.currentStateId,ra),-1;Ba&&!this.TDb&&(this.Jm.setOnRecalcResults(Ba),this.TDb=!0);return this.ucg()&&!this.Oeb(2)?(Q.ULS.sendTraceTag(537170134,0,15,"CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:{0}",ra),-1):cb};t.prototype.getFormulaBarText=function(O,Ba,ra){return Ba&&Ba.startsWith("'")?Ba:O.cell.formulaBarText||ra.toString()};t.prototype.j9g=function(O,Ba,ra){var ta=null;if(this.vwe()&&this.Ze.oa(this.Yp).i_a){var Fa=this.Ze.oa(this.Yp).i_a[O];if(null===
Fa||void 0===Fa?0:Fa.cvc)ta=Fa.Rve}ra=this.egi(ta,Ba,ra);Ba=this.y0g(ta,Ba,ra);Q.ULS.sendTraceTag(50671754,0,50,"CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:{0} StateId:{1} number of formulas {2}",O,this.currentStateId,Ba)};t.prototype.egi=function(O,Ba,ra){var ta=!1,Fa=t.dYe(Ba);if(O){var cb=t.dYe(O);Ya.a.equals(cb,Fa,!1)&&(ta=!0)}ta?this.xCg(O,this.Yp,ra):this.zCg(Ba,ra);return ta};t.prototype.vwe=function(){var O=!1;this.Jm&&-1!==this.Yp&&(O=this.Jm.stateIdAvailable(this.Yp));
return O&&this.Ze.xb(this.Yp)&&this.Yp<this.currentStateId};t.prototype.y0g=function(O,Ba,ra){var ta=0;var Fa,cb;for(Ba.reset();Fa=Ba.getNextCell();)Ia.e(Fa.formula)&&ta++,(cb=ra?O.getCell(Fa.row,Fa.col):null)?this.u0g(Ba,Fa,cb):this.yCg(Ba,Fa);if(ra)for(O.reset();cb=O.getNextCell();)(Fa=Ba.getCell(cb.row,cb.col))||this.wme(O,cb);return ta};t.prototype.Zsj=function(){this.Jm.setOnUpdateRequest(function(){})};t.prototype.Ysj=function(){var O=this;this.Jm.setOnUnresponsive(function(Ba,ra,ta,Fa){O.QUi(Ba,
ra,ta,Fa)})};t.prototype.QUi=function(O,Ba,ra,ta){Q.ULS.sendTraceTag(537170126,0,15,"CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:{0}, waitTime:{1}, timeoutCount:{2}, hasBeenClosed:{3}.",O,Ba,ra,ta);ta&&(this.Thj(),this.roa())};t.prototype.Thj=function(){this.ud(null,null);this.Itd=this.TDb=!1;this.OEd=0;this.FEd=this.HEd=this.IEd=this.GEd=-1};t.prototype.close=function(){this.Jm.close()};t.prototype.clearCache=function(){this.Jm.clearCache()};t.prototype.resumeRecalc=function(){this.Jm.resumeRecalc()};
t.prototype.osj=function(){this.Jm.setA1ReferenceStyle(!0)};t.prototype.H7i=function(){if(this.instantaneousSupportInformationManager){var O=this.instantaneousSupportInformationManager.Bdi,Ba=this.instantaneousSupportInformationManager.Edi,ra=this.instantaneousSupportInformationManager.Ddi,ta=this.instantaneousSupportInformationManager.Cdi,Fa=!1;O!==this.GEd&&(Fa=!0,this.GEd=O);Ba!==this.IEd&&(Fa=!0,this.IEd=Ba);ra!==this.HEd&&(Fa=!0,this.HEd=ra);ta!==this.FEd&&(Fa=!0,this.FEd=ta);var cb=[];Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",
!1)&&(Fa=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),cb.push(Fa),Fa=!0);Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(Fa=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),cb.push(Fa),Fa=!0);Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(Fa=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),cb.push(Fa),Fa=!0);Fa&&(O=excelOnlineCalc.calc.recalcServiceConfig(null,O,
null,Ba,null,null,null,ra,cb,ta),this.Jm.reconfigure(O))}};t.prototype.Zuj=function(O){var Ba=this,ra=null;if(this.Ze.xb(this.currentStateId))try{this.O$=[];var ta=String.format("CalcAsyncEngine::SetUpdatedRanges() StateId:{0} UpdateTriggerData:{1}",this.currentStateId,ya[O]);ra=this.Pc.Wb.Ic("ModelUpdate",ta);Ta.a.forEach(this.Ze.oa(this.currentStateId).i_a,function(Fa,cb){cb.cvc||(Ba.j9g(Fa,cb.Rve,cb.sheetName),cb.cvc=!0)},null);this.Jm.updateRanges(this.currentStateId,this.O$)}finally{ra&&ra.stop()}else Q.ULS.sendTraceTag(537170122,
0,15,"CalcAsyncEngine::SetUpdatedRanges StateId:{0} does not exist in GridCache",this.currentStateId)};t.prototype.Yuj=function(){var O=[],Ba=this.vwe(),ra=Ba&&this.Ze.oa(this.Yp).sj&&this.Ze.oa(this.Yp).sj[0]&&this.Ze.oa(this.Yp).sj[0].vlc?this.Ze.oa(this.Yp).sj[0].Y5:null;this.kBe(ra,this.Ze.oa(this.currentStateId).sj[0].Y5,null,this.Yp,O);this.Ze.oa(this.currentStateId).sj[0].vlc=!0;for(var ta=1;ta<this.Ze.oa(this.currentStateId).sj.length;ta++)ra=-1,Ba&&this.Ze.oa(this.Yp).sj&&(ra=this.Ugd(this.Ze.oa(this.currentStateId).sj[ta].Ena.sheetName,
this.Yp)),ra=-1!==ra&&this.Ze.oa(this.Yp).sj[ra].vlc?this.Ze.oa(this.Yp).sj[ra].Y5:null,this.kBe(ra,this.Ze.oa(this.currentStateId).sj[ta].Y5,this.Ze.oa(this.currentStateId).sj[ta].Ena.sheetId,this.Yp,O),this.Ze.oa(this.currentStateId).sj[ta].vlc=!0;this.Jm.updateNamedObjects(this.currentStateId,O)};t.prototype.kBe=function(O,Ba,ra,ta,Fa){if(void 0!==ra&&null!==ra){var cb=excelOnlineCalc.calc.undefinedNamesWrite(ra);Array.add(Fa,cb)}if(O){var Wa=!1,mb=[];cb=[];if(Ba)for(var kc=yl(Ba),Ab=kc.next();!Ab.done;Ab=
kc.next()){Ab=Ab.value;var Tb=Ab.value;if(O.xb(Ab.key)){var ib=O.oa(Ab.key);t.eEi(ib,Tb)?Wa=!0:(ib=excelOnlineCalc.calc.namedObject(Ab.key,null),Array.add(mb,ib),t.lUc(Ab.key,Tb,cb))}else t.lUc(Ab.key,Tb,cb)}O=yl(O);for(Ab=O.next();!Ab.done;Ab=O.next())kc=Ab.value,Ba&&Ba.xb(kc.key)||(kc=excelOnlineCalc.calc.namedObject(kc.key,null),Array.add(mb,kc));Wa&&(Ba=excelOnlineCalc.calc.namedObjectsPromote(ra,ta),Array.add(Fa,Ba));0<mb.length&&(Ba=excelOnlineCalc.calc.namedObjectsWrite(ra,mb),Array.add(Fa,
Ba));0<cb.length&&(ra=excelOnlineCalc.calc.namedObjectsWrite(ra,cb),Array.add(Fa,ra))}else if(Ba){cb=[];Ba=yl(Ba);for(ta=Ba.next();!ta.done;ta=Ba.next())ta=ta.value,t.lUc(ta.key,ta.value,cb);0<cb.length&&(ra=excelOnlineCalc.calc.namedObjectsWrite(ra,cb),Array.add(Fa,ra))}};t.prototype.MOg=function(){return this.Ze.oa(this.currentStateId).i_a[this.nta]?(Q.ULS.sendTraceTag(537170121,0,50,"CalcAsyncEngine::BlockPreviouslyHandled Block Hash:{0} StateId:{1} previously handled",this.nta,this.currentStateId),
!0):!1};t.prototype.EOg=function(O){return 1===O.getColumnNumbers().length&&O.getColumnNumbers()[0]===t.Qvd+1?!1:!0};t.prototype.rbi=function(){var O=this,Ba=!1;eb.g(this.Pc).Ca.Obd(function(ra){ra.state&1&&O.Pc.ea.uf===ra.me.Revision&&(O.uFe(ra),Ba=!0)});return Ba};t.prototype.xDe=function(O,Ba){var ra=O.getRowNumbers(),ta=O.getColumnNumbers();O=ra[0]-1;ra=ra[ra.length-1]-1;var Fa=ta[0]-1;ta=ta[ta.length-1]-1;(Ba=this.Kvb(Ba))||Q.ULS.sendTraceTag(537170120,0,15,"CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets {0}",
this.Ze.xb(this.currentStateId)&&this.Ze.oa(this.currentStateId).sj?this.Ze.oa(this.currentStateId).sj.length:0);return t.wU("CreateBlockRangeLocation",Ba,O,Fa,ra,ta)};t.prototype.xCg=function(O,Ba,ra){if(ra=this.xDe(O,ra)){var ta=t.Z3b(O.getRowNumbers());O=t.Z3b(O.getColumnNumbers());Ba=excelOnlineCalc.calc.rangePromote(ra,Ba,ta,O);this.O$[this.O$.length]=Ba}};t.prototype.zCg=function(O,Ba){if(Ba=this.xDe(O,Ba)){var ra=t.Z3b(O.getRowNumbers());O=t.Z3b(O.getColumnNumbers());O=excelOnlineCalc.calc.rangeWrite(Ba,
null,ra,O);this.O$[this.O$.length]=O}};t.prototype.u0g=function(O,Ba,ra){var ta=null,Fa=0,cb=0;switch(Ba.valueType){case 2:ta=this.Khd(Ba);var Wa=this.Khd(ra);Wa=Ya.a.equals(Wa,ta,!1);break;case 1:null===Ba.value&&null===ra.value?Wa=!0:(Fa=parseFloat(Ba.value),Wa=parseFloat(ra.value)===Fa);break;default:null===Ba.value&&null===ra.value?Wa=!0:(cb=parseFloat(Ba.value),Wa=cb===parseFloat(ra.value))}Wa&&Ba.valueType===ra.valueType&&Ba.ifmt===ra.ifmt&&Ba.formulaType===ra.formulaType&&Ya.a.equals(ra.formula,
Ba.formula,!1)||(void 0!==Ba.formula&&null!==Ba.formula||void 0!==Ba.value&&null!==Ba.value||void 0!==Ba.text&&null!==Ba.text?this.sYb(O,Ba,ta,Fa,cb):this.wme(O,Ba))};t.prototype.VBg=function(O){if(this.Pc.zb&&this.Pc.zb.items)for(var Ba=0;Ba<this.Pc.zb.count;Ba++){var ra=this.Pc.zb.items[Ba];if(2===ra.type||3===ra.type){var ta=0,Fa=ra.name,cb=Fa.lastIndexOf("!");if(0<cb){ta=Fa.substr(0,cb);"'"===ta.charAt(0)&&(ta=ta.substr(1,ta.length-2));ta=this.Ugd(ta,this.currentStateId);if(-1===ta){Q.ULS.sendTraceTag(595096334,
0,15,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets {0}",this.Ze.xb(this.currentStateId)&&this.Ze.oa(this.currentStateId).sj?this.Ze.oa(this.currentStateId).sj.length:0);continue}Fa=Fa.substr(cb+1)}ta=this.Ze.oa(this.currentStateId).sj[ta].Y5;var Wa=ra.usedRange;2===ra.type&&(Wa=Ec.a(ra));if(ta.xb(Fa)){if(cb=ta.oa(Fa),Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5502630_AddNamedObjectsInBlock_updateRange")&&(cb.range=Wa,cb.attributes=ra.attributes),2===cb.type&&
(Fa=t.bUe(ra.name,O),ra=(ta=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?ra.LO:null===Fa||void 0===Fa?void 0:Fa.ColHeadersList,Fa||ta))if(!cb.mE)cb.mE=new A(ra);else if(ra)for(ra=yl(ra.HeadersList),Fa=ra.next();!Fa.done;Fa=ra.next())Fa=Fa.value,cb.mE.u$.ia(Fa.Index,Fa.Name)}else if(cb=this.Kvb(ra.sheetName)){cb=new r(ra.type,ra.name,Wa,cb,ra.attributes);if(2===cb.type)if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&ra.LO)cb.mE=
new A(ra.LO);else if(ra=t.bUe(ra.name,O))cb.mE=new A(ra.ColHeadersList);ta.ia(Fa,cb)}else Q.ULS.sendTraceTag(537170117,0,50,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets {0}",this.Ze.xb(this.currentStateId)&&this.Ze.oa(this.currentStateId).sj?this.Ze.oa(this.currentStateId).sj.length:0)}}};t.prototype.sYb=function(O,Ba,ra,ta,Fa){var cb=O.getRowNumbers()[Ba.row]-1;O=O.getColumnNumbers()[Ba.col]-1;cb=t.wU("AddRangeUpdateCommand",this.prb,cb,O,cb,O);O=null;var Wa=
Ba.formula||Ba.text,mb=excelOnlineCalc.calc.blankValue,kc=null;void 0!==Ba.text&&null!==Ba.text||void 0!==Ba.value&&null!==Ba.value||(ra="",kc="This cell contains blanks only",0===Ba.formulaType&&(Wa=""));switch(Ba.valueType){case 2:null!==ra&&(0===Ba.formulaType&&(O=excelOnlineCalc.calc.valueCellData(Wa,ra,Ba.ifmt,kc)),1===Ba.formulaType&&(O=excelOnlineCalc.calc.cellFormulaCellData(Wa,ra,Ba.ifmt,kc)),2===Ba.formulaType&&(O=excelOnlineCalc.calc.valueCellData("",mb,0,"This cell is a part of an array")));
break;case 1:isNaN(ta)?Q.ULS.sendTraceTag(537170116,0,50,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid numeric value",Ba.row,Ba.col):(0===Ba.formulaType&&(O=excelOnlineCalc.calc.valueCellData(Wa,ta,Ba.ifmt,null)),1===Ba.formulaType&&(O=excelOnlineCalc.calc.cellFormulaCellData(Wa,ta,Ba.ifmt,null)),2===Ba.formulaType&&(O=excelOnlineCalc.calc.valueCellData("",mb,0,"This cell is a part of an array")));break;case 3:isNaN(Fa)?Q.ULS.sendTraceTag(537170115,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid boolean value",
Ba.row,Ba.col):(ra=1===Fa?!0:!1,0===Ba.formulaType&&(O=excelOnlineCalc.calc.valueCellData(Wa,ra,Ba.ifmt,null)),1===Ba.formulaType&&(O=excelOnlineCalc.calc.cellFormulaCellData(Wa,ra,Ba.ifmt,null)),2===Ba.formulaType&&(O=excelOnlineCalc.calc.valueCellData("",mb,0,"This cell is a part of an array")));break;case 4:isNaN(Fa)?Q.ULS.sendTraceTag(537170114,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid error value",Ba.row,Ba.col):(ra=excelOnlineCalc.calc.errorValue(Fa),0===Ba.formulaType&&
(O=excelOnlineCalc.calc.valueCellData(Wa,ra,Ba.ifmt,null)),1===Ba.formulaType&&(O=excelOnlineCalc.calc.cellFormulaCellData(Wa,ra,Ba.ifmt,null)),2===Ba.formulaType&&(O=excelOnlineCalc.calc.valueCellData("",mb,0,"This cell is a part of an array")));break;default:O=excelOnlineCalc.calc.valueCellData("",mb,Ba.ifmt,null)}O&&(Ba=excelOnlineCalc.calc.rangeWrite(cb,O,null,null),this.O$[this.O$.length]=Ba)};t.prototype.yCg=function(O,Ba){switch(Ba.valueType){case 2:this.sYb(O,Ba,this.Khd(Ba),null,0);break;
case 1:this.sYb(O,Ba,null,parseFloat(Ba.value),0);break;default:this.sYb(O,Ba,null,null,parseFloat(Ba.value))}};t.prototype.wme=function(O,Ba){var ra=O.getRowNumbers()[Ba.row]-1;O=O.getColumnNumbers()[Ba.col]-1;ra=t.wU("AddRangeUpdateCommandEmptyCell",this.prb,ra,O,ra,O);Ba=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,Ba.ifmt,null);Ba=excelOnlineCalc.calc.rangeWrite(ra,Ba,null,null);this.O$[this.O$.length]=Ba};t.prototype.Kvb=function(O){O=this.Ugd(O,this.currentStateId);
return 0<O?this.Ze.oa(this.currentStateId).sj[O].Ena.sheetId:null};t.prototype.Ugd=function(O,Ba){if(!this.Ze.xb(Ba))return Q.ULS.sendTraceTag(537170113,0,15,"CalcAsyncEngine.GetSheetInternalIndex StateId:{0} does not exist in GridCache",Ba),-1;if(!this.Ze.oa(Ba).sj)return Q.ULS.sendTraceTag(537170112,0,15,"CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:{0}",Ba),-1;Ba=this.Ze.oa(Ba).sj;for(var ra=1;ra<Ba.length;ra++)if(Ya.a.equals(Ba[ra].Ena.sheetName,O,!1))return ra;
return-1};t.prototype.uuj=function(){if(!this.Ze.xb(this.currentStateId)||!this.Ze.oa(this.currentStateId).sj.length)return Q.ULS.sendTraceTag(537170083,0,15,"CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:{0} or StateId does not exist in GridCache",this.currentStateId),!1;for(var O=[],Ba=1;Ba<this.Ze.oa(this.currentStateId).sj.length;Ba++){var ra=this.Ze.oa(this.currentStateId).sj[Ba];ra&&Array.add(O,ra.Ena)}this.Jm.updateSheetNames(this.currentStateId,O);this.Jm.updateUnusedCells(this.currentStateId,
this.Ze.oa(this.currentStateId).Icg);return!0};t.prototype.setNumberFormats=function(){if(this.instantaneousSupportInformationManager){for(var O=[],Ba=yl(this.instantaneousSupportInformationManager.hca),ra=Ba.next();!ra.done;ra=Ba.next())ra=ra.value,ra=excelOnlineCalc.calc.numberFormat(ra.IfmtIndex,ra.FormatString,ra.Builtin),Array.add(O,ra);this.Jm.setNumberFormats(O,!0)}};t.prototype.Rqj=function(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Ke){var O=
this.ubi();if(!this.Itd||O)this.Y3b(),this.instantaneousSupportInformationManager.Ke.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Ke.TrueValueString),this.instantaneousSupportInformationManager.Ke.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Ke.FalseValueString),O=xa.CalcHelper.nEe(this.instantaneousSupportInformationManager,O),this.Jm.setLocale(O),this.Itd=!0}};t.prototype.jvj=function(){var O=null;if(void 0!==this.Pc.workbookContext.TimeZoneInformation&&
null!==this.Pc.workbookContext.TimeZoneInformation){O=null;this.Pc.workbookContext.TimeZoneInformation.StandardDate.Month&&(O=excelOnlineCalc.date.dateTime(this.Pc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Second,
this.Pc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));var Ba=null;this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(Ba=excelOnlineCalc.date.dateTime(this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Hour,
this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));O=excelOnlineCalc.date.tzData(this.Pc.workbookContext.TimeZoneInformation.Bias,O,this.Pc.workbookContext.TimeZoneInformation.StandardBias,Ba,this.Pc.workbookContext.TimeZoneInformation.DaylightBias)}else Q.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");O=excelOnlineCalc.calc.workbookProps(this.Pc.workbookContext.F1904,this.Pc.workbookContext.FDateCompatibility,O);this.Jm.setWorkbookProps(O)};t.prototype.roa=function(){var O=this;Pa.EwaSettings.la(310)&&kb.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.R5f,!0)).continueWith(function(ra){ra.exception?Q.ULS.sendTraceTag(537170079,0,15,"CalcAsyncEngine.TryInitialize: calc smoke test failed: {0}",ra.exception.toString()):Q.ULS.sendTraceTag(537170080,
0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});var Ba=Pa.EwaSettings.la(682)?x.local:x.sKj;this.QGd=kb.c(excelOnlineCalc.calc.createRecalcService(Ba,Ob.a.YZ()));this.QGd.continueWith(function(ra){ra.exception?Q.ULS.sendTraceTag(537170075,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker failed: {0}",ra.exception.toString()):(Q.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),O.Jm=O.QGd.result,O.Jm?
O.Oeb(0)?O.Ysj():Q.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):Q.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})};t.prototype.ubi=function(){var O=this.instantaneousSupportInformationManager.nja;if(!O||this.OEd===O.length)return null;this.OEd=O.length;return xa.CalcHelper.aEe(O)};t.prototype.Y3b=function(){this.errorTypeNames=xa.CalcHelper.Y3b()};t.prototype.wbi=function(){if(!(this.Ze.xb(this.currentStateId)&&
0<this.Ze.oa(this.currentStateId).sj.length)){this.Ze.ia(this.currentStateId,new B);this.Ze.oa(this.currentStateId).sj[0]=new u(null);for(var O=this.Pc.xa,Ba=0;Ba<O.count;Ba++){var ra=Object(pb.a)(wb.a,O.getItem(Ba));if(ra){void 0!==ra.sheetId&&null!==ra.sheetId&&void 0!==ra.name&&null!==ra.name&&ra.sheetId.length&&ra.sheetName.length||Q.ULS.sendTraceTag(537170074,0,15,"CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:{0} Id:{1} Hash:{2} NameLength:{3}",Ba,ra.sheetId,ra.hash,ra.name?
ra.name.length:-1);var ta=excelOnlineCalc.calc.sheetName(ra.sheetId,ra.name);this.Ze.oa(this.currentStateId).sj[Ba+1]=new u(ta);ta=ra.usedRange.HL();ta=excelOnlineCalc.calc.rangeLocation(0,0,ta.LastRow,ta.LastColumn);ra=excelOnlineCalc.calc.unusedCellsUpdate(ra.sheetId,ta);Array.add(this.Ze.oa(this.currentStateId).Icg,ra)}else Q.ULS.sendTraceTag(537170073,0,15,"CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:{0} sheet-index:{1}",this.currentStateId,Ba)}}};t.prototype.XXg=function(){for(var O=
yl(this.Ze),Ba=O.next();!Ba.done;Ba=O.next())Ba=Ba.value,Ba.key<this.Yp&&this.Ze.remove(Ba.key)};t.prototype.Khd=function(O){O=O.value||O.text;if(void 0===O||null===O)O="";return O};t.prototype.ucg=function(){if(!this.Ze.xb(this.currentStateId))return!1;var O=!1;Ta.a.forEach(this.Ze.oa(this.currentStateId).i_a,function(Ba,ra){ra.cvc||(O=!0)},null);return O};t.prototype.U3c=function(O){var Ba={};Ba.reason=O;Ba.kind=1;return Ba};t.prototype.Lgc=function(){return this.Ze.xb(this.currentStateId)&&this.Ze.oa(this.currentStateId).sj&&
this.Ze.oa(this.currentStateId).sj[0]&&this.Ze.oa(this.currentStateId).sj[0].Y5?!0:!1};t.r5g=function(O){var Ba=[];if(null===O||void 0===O?0:O.u$){O=yl(O.u$);for(var ra=O.next();!ra.done;ra=O.next())ra=ra.value,ra=excelOnlineCalc.calc.columnData(ra.key,ra.value),Array.add(Ba,ra)}return Ba};t.eEi=function(O,Ba){if(O.type!==Ba.type||O.attributes!==Ba.attributes||!Ya.a.equals(O.fullName,Ba.fullName,!1)||!O.range.equals(Ba.range))return!1;if(!O.mE&&!Ba.mE)return!0;if(!O.mE||!Ba.mE||O.mE.u$.count!==Ba.mE.u$.count)return!1;
var ra={};O=yl(O.mE.u$);for(var ta=O.next();!ta.done;ra={Ufb:ra.Ufb,agb:ra.agb},ta=O.next())if(ra.Ufb=ta.value,ra.agb=void 0,!(ra.Ufb.value&&function(Fa){return function(){var cb=Ba.mE.u$.Hc(Fa.Ufb.key);Fa.agb=cb.value;return cb}}(ra)().returnValue&&ra.agb&&Ya.a.equals(ra.Ufb.value,ra.agb,!1)))return!1;return!0};t.lUc=function(O,Ba,ra){var ta=t.wU("NamedObject",Ba.sheetId,Ba.range.top-1,Ba.range.left-1,Ba.range.bottom-1,Ba.range.right-1);if(2===Ba.type){var Fa=!!(Ba.attributes&16),cb=!!(Ba.attributes&
8);Ba=t.r5g(Ba.mE);ta=excelOnlineCalc.calc.namedTableData(ta,Fa,cb,Ba);O=excelOnlineCalc.calc.namedObject(O,ta)}else ta=excelOnlineCalc.calc.namedRangeData(ta),O=excelOnlineCalc.calc.namedObject(O,ta);Array.add(ra,O)};t.dYe=function(O){var Ba=Sys.Serialization.JavaScriptSerializer.serialize(O.getRowNumbers());O=Sys.Serialization.JavaScriptSerializer.serialize(O.getColumnNumbers());return Ba+O};t.Z3b=function(O){var Ba=null;if(1<O.length)for(var ra=1;ra<O.length;ra++)for(var ta=0;O[ra-1]+1+ta<O[ra];)Ba=
Ba||[],Array.add(Ba,O[ra-1]+ta),ta++;return Ba};t.bUe=function(O,Ba){if(!Ba)return null;for(var ra=0,ta=Ba.length;ra<ta;++ra)if(Ya.a.equals(O,Ba[ra].Name,!1))return Ba[ra];return null};t.wU=function(O,Ba,ra,ta,Fa,cb){function Wa(mb,kc,Ab,Tb){(0>Ab||Ab>=Tb)&&Q.ULS.sendTraceTag(537170072,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:{0} invalid {1}:{2}",mb,kc,Ab)}void 0!==Ba&&null!==Ba||Q.ULS.sendTraceTag(537170071,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:{0} sheetId is null",
O);Wa(O,"top",ra,t.eqf);Wa(O,"left",ta,t.Qvd);Wa(O,"bottom",Fa,t.eqf);Wa(O,"right",cb,t.Qvd);return excelOnlineCalc.calc.sheetRangeLocation(Ba,ra,ta,Fa,cb)};t.eqf=1048576;t.Qvd=16384;Object(F.a)(t,"CalcAsyncEngine",null,[2]);Object(F.a)(w,"AbsoluteRelativeReferenceInfo",null,[]);var vb=b(1128),Gb=b(24);v.GIf="#";Object(F.a)(v,"Operators",null,[]);var Za=b(1129);f.sheet="Sheet";f.sheetRange="SheetRange";f.document="Document";f.i9h="Ident";Object(F.a)(f,"TraverseFormulaQualifierTypes",null,[]);var ub=
b(1130),fc=b(1019),$a=b(924),nb=b(52),sc=b(59);m.prototype.dispose=function(){var O=this;Q.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.Za(268,function(Ba){Ba.mJd(O.onc);Ba.aJd(O.Tmc)});this.gridView&&(this.gridView.ot(this.onContentReady),this.gridView.Ca&&this.gridView.Ca.sQf(this.kvf),this.Cy=null);this.Itf=this.Gtf=this.EFc=null};m.prototype.OTg=function(O,Ba,ra,ta){ta=void 0===ta?null:ta;this.vl&&(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5470583_Calculate_Formula_Refactoring")?
this.vl.LTg(O,Ba,ra,ta):this.vl.NTg(O,Ba,ra,ta))};m.prototype.evalFormula=function(O){return this.vl?this.vl.evalFormula(O):Promise.reject("calc engine not initialized")};m.prototype.evalFormulaRange=function(O,Ba,ra){return this.vl?this.vl.evalFormulaRange(O,Ba,ra):Promise.reject("calc engine not initialized")};m.prototype.Qsb=function(O,Ba,ra,ta){return this.vl?this.vl.Qsb(O,Ba,ra,ta):Promise.reject("CalcEngine is null")};m.prototype.Qvb=function(O){return this.vl?(Q.ULS.shipAssertTag(537170059,
0,2===O.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.vl.Qvb(O)):null};m.prototype.bJg=function(O,Ba){if(!Ba||2!==O.type)return!1;O=Ec.a(O);return O.right-O.left+1===Ba.count};m.prototype.CSe=function(O){if(!this.SEb)return this.Hgg||Q.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var Ba=this.Zsa(Gb.Range.ld(1,1));Ba=this.SEb.parseFormula(excelOnlineCalc.parse.parseLocals(1,Ba.range),O);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(Ba))return Q.ULS.sendTraceTag(537170056,
0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{if(Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesHighlighting",!1)){var ra=this.gridView.ha.va.activeCell,ta=excelOnlineCalc.location.gridCell(ra.top-1,ra.left-1),Fa=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),cb=excelOnlineCalc.location.sheetIndex(Fa,this.$.xa.pa.sheetId),Wa=this.D9g(ta,cb);this.iLd||(this.iLd=excelOnlineCalc.util.createResolver(this.C9g()));
var mb=excelOnlineCalc.parse.parseResultHelper.extractReferences(Ba,this.Sr.config.localeInfo,Pa.EwaSettings.la(620),Wa,this.iLd)}else mb=excelOnlineCalc.parse.parseResultHelper.extractReferences(Ba,this.Sr.config.localeInfo,Pa.EwaSettings.la(620));Pa.EwaSettings.la(103)&&this.WTj(mb,O);return mb}catch(kc){return Q.ULS.sendTraceTag(537170055,0,10,"CalcManager.ExtractReferenceWrappers - exception: {0}",kc.message),null}};m.prototype.extractLetVariables=function(O,Ba){if(!this.SEb)return this.Hgg||
Q.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;var ra=this.Zsa(Gb.Range.ld(1,1));O=this.SEb.parseFormula(excelOnlineCalc.parse.parseLocals(1,ra.range),O);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(O))return Q.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(O,Ba,this.Sr.config.localeInfo)}catch(ta){return Q.ULS.sendTraceTag(537170052,
0,10,"CalcManager.ExtractLetVariables - exception: {0}",ta.message),null}};m.prototype.extractReferences=function(O,Ba,ra,ta){if(!Ba)return Q.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!ra)return Q.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;var Fa=this.CSe(O);if(!Fa)return Q.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.E8g(Fa,
Ba,ra,O,ta)}catch(cb){return Q.ULS.sendTraceTag(537170048,0,10,"CalcManager.ExtractReferences - exception: {0}",cb.message),null}};m.prototype.XZh=function(O,Ba,ra,ta){if(!O)return Q.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!Ba||0>=Ba.length)return Q.ULS.sendTraceTag(537170018,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;O=this.Zsa(O);if(!this.Sr||!O)return null;var Fa=
this.yub(O).returnValue;if(!Fa||Fa.Y5a)return null;ra=excelOnline.utils.getCharIndexInTextFromPoint(ra,ta,Pa.EwaSettings.la(620));return 0>ra?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.Sr.config,ra,Ba,O)};m.prototype.CTg=function(O,Ba,ra,ta){var Fa=this;if(!O)return Q.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),null;var cb=null;return this.evalFormula(Ba).then(function(Wa){var mb=Fa.Sr.Kmh(Wa,ra),kc=mb.returnValue;8!==
mb.kind||kc.length&&kc!==xa.CalcHelper.unknownError?Wa=0:(Q.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),Wa=excelOnlineCalc.calc.getEvalFailureReason(Wa),void 0!==Wa&&null!==Wa||Q.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),Wa=1);return cb=ta?new vb.a(kc,ta.start,ta.end,Wa):new vb.a(kc,-1,-1,Wa)},function(Wa){Q.ULS.sendTraceTag(537170014,0,10,"EvalSession.GetPartialResultValueForFormula - exception: {0}",
Wa);return Promise.resolve(cb)})};m.prototype.getSubExpressionSpan=function(O){return this.Sr&&O?excelOnlineCalc.runtime.getSubExpressionSpan(O):null};m.prototype.getFormulaSubExpressionObject=function(O,Ba,ra){return this.Sr&&O&&Ba&&ra?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.Sr.config,Ba,ra,this.Zsa(O)):null};m.prototype.$Zh=function(O,Ba,ra){return this.Sr&&O&&Ba?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.Sr.config,Ba,ra,this.Zsa(O)):null};m.prototype.YZh=
function(O,Ba,ra){return this.Sr&&O&&Ba?excelOnlineCalc.runtime.getSubExpressionSubspans(this.Sr.config.localeInfo,Ba,ra):null};m.prototype.tTh=function(){return this.Sr?this.Sr.config.localeInfo.listSeparator:null};m.prototype.isFormulaSubExpressionVolatile=function(O){return this.Sr?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.Sr.config.localeInfo,O):!1};m.prototype.Zsa=function(O){return O&&this.Sr?this.Sr.a$g(this.Sr.Qah(),O.top-1,O.left-1):null};m.prototype.cji=function(O,Ba){O=
this.Ofd(O);if(void 0===O||null===O)return null;O=this.aq.createFormat(O.FormatString,O.Builtin);if(!excelOnlineCalc.util.isSuccess(O))return null;Ba=this.aq.parseEdit(Ba,O.value);return excelOnlineCalc.util.isSuccess(Ba)?Ba.value.kind===fc.a.formula:null};m.prototype.Nfd=function(O){if(!O.isValid())return Q.ULS.sendTraceTag(537170013,0,50,"CalcManager.GetNumberFormat: invalid format was given! ifmt: {0}, format string: {1}, format obj: {2}",null!=O.QE?O.QE.toString():"null",O.formatString?Ya.a.yJ(O.formatString):
"null",O.numberFormat?"!null":"null"),null;var Ba=O.eSh();if("String"===Object.getType(Ba).getName())var ra=this.Itf;else if("Number"===Object.getType(Ba).getName())ra=this.Gtf;else return Q.ULS.sendTraceTag(537170012,0,10,"CalcManager.GetNumberFormat: key is of unknown type!"),null;Ba=Ba.toString();if(Ba in ra)return ra[Ba].numberFormat;ra[Ba]=O;return O.numberFormat};m.prototype.getWorksheetFuncId=function(O){return this.localeInfo.getWorksheetFuncId(O)};m.prototype.E8g=function(O,Ba,ra,ta,Fa){for(var cb=
{Items:[]},Wa=0;Wa<O.length;Wa++){var mb=O[Wa],kc={};kc.Start=mb.span.start;kc.End=mb.span.end;if(Fa||mb.kind!==Za.a.func)if(Fa||mb.kind!==Za.a.iti){if(this.Hhh(mb,Ba,ra)){var Ab=new w,Tb=this.ZWh(mb,Ba,Ab,ta);if(Pa.EwaSettings.la(620)){var ib=this.jTh(mb),Sa=this.iTh(mb);if(Tb||Sa&&0<=ib)kc={Span:kc,LetNumber:ib,LetName:Sa,Range:Tb},kc.IsRangeRef=Ab.G6a,kc.IsAbsoluteFirstRow=Ab.twa,kc.IsAbsoluteFirstColumn=Ab.swa,kc.IsAbsoluteSecondRow=Ab.DLa,kc.IsAbsoluteSecondColumn=Ab.CLa,kc.IsStructRef=mb.kind===
Za.a.QTd,Array.add(cb.Items,kc)}else Tb&&(kc={Span:kc,Range:Tb},kc.IsRangeRef=Ab.G6a,kc.IsAbsoluteFirstRow=Ab.twa,kc.IsAbsoluteFirstColumn=Ab.swa,kc.IsAbsoluteSecondRow=Ab.DLa,kc.IsAbsoluteSecondColumn=Ab.CLa,kc.IsStructRef=mb.kind===Za.a.QTd,Array.add(cb.Items,kc))}}else mb=mb.ref.value.oper.kind,Array.add(cb.Items,{Span:kc,IsString:2===mb,IsBoolean:4===mb,IsNumber:1===mb});else kc.End=mb.span.start+mb.ref.name.length,mb={Span:kc,IsFunction:!0},mb.FunctionId=this.getWorksheetFuncId(ta.substring(kc.Start,
kc.End)),Array.add(cb.Items,mb)}cb.Items.sort(function(Mb,Jc){return Mb.Span.Start-Jc.Span.Start});return cb};m.prototype.jTh=function(O){return O.kind===Za.a.glf?O.ref.number:-1};m.prototype.iTh=function(O){return O.kind===Za.a.glf?O.ref.name:null};m.prototype.ZWh=function(O,Ba,ra,ta){if(O.kind===Za.a.range)return ra.G6a=!0,this.wCe(O,Ba,ra,ta);if(O.kind===Za.a.namedRange){ra=O.ref;(O=this.$.zb.getItemByName(ra.name))||(O=this.$.zb.getItemByName(Ba+"!"+ra.name));if(!(O&&O.sheetName&&O.usedRange&&
Ya.a.equals(O.sheetName,Ba,!0)))return null;Ba=2===O.type?Ec.a(O):O.usedRange;return db.m(Ba,O)}if(O.kind===Za.a.QTd){var Fa=O.ref,cb;Fa.name?(cb=this.$.zb.getItemByName(Fa.name))||(cb=this.$.zb.getItemByName(Ba+"!"+Fa.name)):cb=this.gridView.Sb.Wj(this.gridView.ha.va.activeCell);if(!(cb&&cb.sheetName&&cb.usedRange&&Ya.a.equals(cb.sheetName,Ba,!0)))return null;ra.G6a=!1;return this.wCe(O,Ba,ra,ta)}return null};m.prototype.wCe=function(O,Ba,ra,ta){O=O.ref;if(O.type){if(O.type===ub.a.column){var Fa=
O.startIndex;O=O.endIndex;ra.swa=Fa.kind===$a.a.abs;ra.CLa=O.kind===$a.a.abs;return this.createRange(0,Fa.index,T.a.Kh,O.index,Ba)}if(O.type===ub.a.row)return Fa=O.endIndex,ra.twa=O.startIndex.kind===$a.a.abs,ra.DLa=Fa.kind===$a.a.abs,this.createRange(O.startIndex.index,0,O.endIndex.index,T.a.Wh,Ba);if(O.type===ub.a.cell){Fa=O.row;var cb=O.col;ra.twa=ra.DLa=Fa.kind===$a.a.abs;ra.swa=ra.CLa=cb.kind===$a.a.abs;return this.q1b(O.span.end,ta)&&(ra=Gb.Range.ld(Fa.index+1,cb.index+1),ra=this.gridView.Sb.G3e(ra))?
db.n(ra,Ba):this.createRange(Fa.index,cb.index,Fa.index,cb.index,Ba)}if(O.type===ub.a.range){Fa=O.top;cb=O.left;ta=O.bottom;O=O.right;var Wa=Math.min(Fa.index,ta.index),mb=Math.min(cb.index,O.index),kc=Math.max(Fa.index,ta.index),Ab=Math.max(cb.index,O.index);ra.twa=Fa.kind===$a.a.abs;ra.DLa=ta.kind===$a.a.abs;ra.swa=cb.kind===$a.a.abs;ra.CLa=O.kind===$a.a.abs;return this.createRange(Wa,mb,kc,Ab,Ba)}Q.ULS.sendTraceTag(537170010,0,10,"CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '{0}'",
O.type);return null}Q.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null};m.prototype.q1b=function(O,Ba){return Ba.length>=O&&0<O&&Ba.charAt(O-1)===v.GIf};m.prototype.ITg=function(O,Ba,ra){this.vl&&this.vl.MTg(O,Ba,ra)};m.prototype.Ofd=function(O){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.hca&&this.instantaneousSupportInformationManager.hca[O]&&this.aq?this.instantaneousSupportInformationManager.hca[O]:
null};m.prototype.toXLNumber=function(O){if(!this.aq)return null;O=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.aq,O);return excelOnlineCalc.util.isSuccess(O)?O.value:null};m.prototype.WTj=function(O,Ba){if(O){O=yl(O);for(var ra=O.next();!ra.done;ra=O.next())if(ra=ra.value,ra.ref.type&&ra.ref.type===ub.a.cell){var ta=ra.ref;m.r0i(ta,Ba)&&(ta.span.end+=1,ra.span.end+=1)}}};m.prototype.createRange=function(O,Ba,ra,ta,Fa){var cb={};cb.FirstRow=O;cb.FirstColumn=Ba;cb.LastRow=ra;cb.LastColumn=
ta;cb.SheetName=Fa;return cb};m.prototype.Hhh=function(O,Ba,ra){var ta=O.ref.qualifier;if(!ta)return!0;switch(O.ref.qualifier.type){case f.sheet:return O=ta.document,Ya.a.equals(ta.sheet,Ba,!0)&&(!O||Ya.a.equals(O.document,ra,!0));case f.sheetRange:return Ba=this.$.xa.getItemByName(Ba),ra=this.$.xa.getItemByName(ta.sheet1),ta=this.$.xa.getItemByName(ta.sheet2),!!Ba&&!!ra&&!!ta&&(ra.index<=Ba.index&&Ba.index<=ta.index||ta.index<=Ba.index&&Ba.index<=ra.index);case f.document:return Ya.a.equals(ta.document,
ra,!0);case f.i9h:return ta=ta.name,Ya.a.equals(ta,Ba,!0)||Ya.a.equals(ta,ra,!0);default:return Q.ULS.sendTraceTag(537170009,0,10,"CalcManager.GetQualifierData: Unsupported formula qualifier type '{0}'",ta.type),!1}};m.prototype.DOj=function(O){this.instantaneousSupportInformationManager=O;O.hca.length&&O.nja.length?(this.EFc=new xa.CalcHelper(this.gridView.$),this.SEb=this.Sr.createParser(),this.kce=this.Sr.createNumberFormatter(),this.Mcf=!0,Q.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),
this.vl||(Q.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.vl=new t(this.$))):Q.ULS.sendTraceTag(537170008,0,15,"CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = {0}, functions info count = {1}",O.hca.length,O.nja.length.toString())};m.prototype.yub=function(O){if(!O)return{returnValue:null,emptyCell:!1};var Ba=this.getSheetName(O.sheet.index);if(!Ba)return Q.ULS.sendTraceTag(537169998,
0,50,"CalcManager.GetCellFromBlockCache: No sheet index {0}",O.sheet.index),{returnValue:null,emptyCell:!1};var ra=m.convertToRange(O);Ba=this.gridView.yub(Ba,ra.top,ra.left);return Ba?Ba.Chh?{returnValue:Ba,emptyCell:!1}:(Q.ULS.sendTraceTag(537169996,0,50,"CalcManager.GetCellFromBlockCache: cell {0} {1} is empty",O.range.row,O.range.col),{returnValue:null,emptyCell:!0}):(Q.ULS.sendTraceTag(537169997,0,50,"CalcManager.GetCellFromBlockCache: cellProxy is null for cell {0} {1}",O.range.row,O.range.col),
{returnValue:null,emptyCell:!1})};m.prototype.getSheetName=function(O){var Ba=this.gridView.$.xa.getItem(O);return Ba?Ba.sheetName:(Q.ULS.sendTraceTag(537169995,0,50,"CalcManager.GetSheetName - no sheet in index {0}",O),null)};m.prototype.D9g=function(O,Ba){var ra={allowUnqualifiedCell:!0,wrapCellReferences:!0};ra.config=this.Sr.config;ra.originGridCell=excelOnlineCalc.util.success(O);ra.originSheet=excelOnlineCalc.util.success(Ba);return ra};m.prototype.C9g=function(){var O={};O.config=this.Sr.config;
O.getNameLoc=Object(Ja.a)(this.vl,this.vl.getNameLoc,"getNameLoc");O.getContainingTable=Object(Ja.a)(this.vl,this.vl.getContainingTable,"getContainingTable");O.getStructRefColumn=Object(Ja.a)(this.vl,this.vl.getStructRefColumn,"getStructRefColumn");O.getStructRefSpecialRef=Object(Ja.a)(this.vl,this.vl.getStructRefSpecialRef,"getStructRefSpecialRef");O.getDocumentLoc=Object(Ja.a)(this.vl,this.vl.getDocumentLoc,"getDocumentLoc");O.getSheetIndex=Object(Ja.a)(this.vl,this.vl.getSheetIndex,"getSheetIndex");
O.getSheetName=Object(Ja.a)(this.vl,this.vl.getSheetName,"getSheetName");O.getUserDefinedFuncLoc=Object(Ja.a)(this.vl,this.vl.getUserDefinedFuncLoc,"getUserDefinedFuncLoc");O.getSheetRangeIndexes=Object(Ja.a)(this.vl,this.vl.getSheetRangeIndexes,"getSheetRangeIndexes");return O};m.r0i=function(O,Ba){return Ba.length>O.span.end&&Ba.charAt(O.span.end)===v.GIf};m.convertToRange=function(O){return Gb.Range.ld(O.range.row+1,O.range.col+1)};Qk.Object.defineProperties(m.prototype,{Sr:{configurable:!0,enumerable:!0,
get:function(){return this.EFc}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.Cy}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},aq:{configurable:!0,enumerable:!0,get:function(){return this.kce}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return this.Sr?this.Sr.config.localeInfo:null}},config:{configurable:!0,enumerable:!0,get:function(){return this.Sr.config}}});Object(F.a)(m,"CalcManager",null,[731,2]);var rd=b(35),$b=b(53),Wb=la.a;vm(n,Wb);
n.prototype.create=function(){var O=this;if(this.$){Q.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var Ba=53;var ra="Current"}else Ba=56,ra="Stable";Q.ULS.sendTraceTag(537169992,0,50,"CalcManagerFactory.Create: Calc {0} JS was loaded",ra);rd.TaskExtensions.Ba($b.a.loadScript(Ba,4,this.ub,void 0,void 0,265),function(){Q.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");
var ta=O.$.da.Aa(266,!1);ta||(Q.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),ta=new m(O.$));O.Gb(ta)},this.ma,3)}else Q.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")};n.ka=function(O){O&&O.da&&O.da.Ha(265,new n(O))};Object(F.a)(n,"CalcManagerFactory",la.a,[]);var lc=b(4),Oa=b(319);Object(F.a)(l,"MarqueeMetadata",null,[]);var qb=b(131),Ub=b(647),jc=b(336);d.prototype.tX=
function(O,Ba){this.wki&&O.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.w8f||O.lN)return!1;var ra=void 0===Ba||null===Ba?O.text:Ba;if(this.calcManager&&1<ra.length&&Ia.e(ra)){var ta=this.bgd(),Fa=this.K1e(),cb=this.Pc.workbookContext.WorkbookFileName,Wa=!1,mb=.01>Math.random()?Object(pb.a)(qb.a,this.Pc.Wb.Ic("LoadingUIShown","ColoredReferencesManager")):null;try{var kc=this.calcManager.extractReferences(ra,Fa,cb,!this.scf);if(!kc)return Q.ULS.sendTraceTag(537169989,
0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),!1;Fa=[];cb=[];for(var Ab=[],Tb=[],ib=0,Sa=0,Mb=new qa.a(!1),Jc="",Ib=yl(kc.Items),Nb=Ib.next();!Nb.done;Nb=Ib.next()){var sa=Nb.value;Wa=sa.IsStructRef||Wa;if(sa.IsBoolean||sa.IsNumber||sa.IsString){var Va=sa.IsBoolean?d.YOg:sa.IsNumber?d.OFi:d.AHj;this.vFa(cb,ra,ib,sa.Span.Start,null);this.vFa(cb,ra,sa.Span.Start,sa.Span.End,Va);ib=sa.Span.End}else if(Pa.EwaSettings.la(620)){if(sa.Range||
sa.LetName&&0<=sa.LetNumber){kc=null;if(sa.Range){var Xb=db.D(sa.Range);kc=this.Eub(Xb,Mb,1);Array.add(Fa,new jc.a(Xb,ta))}else sa.LetName&&0<=sa.LetNumber&&(kc=Jc=this.GMh(sa.LetName,sa.LetNumber,Mb,Jc),Sa!==Mb.count&&O.colors.add(sa.Span.Start+"-"+sa.Span.End,this.colors[(Mb.count-1)%this.colors.length]));this.vFa(cb,ra,ib,sa.Span.Start,null);this.vFa(cb,ra,sa.Span.Start,sa.Span.End,kc);ib=sa.Span.End;Array.add(Ab,sa.Span);var mc=cb.length-1;Array.add(Tb,new l(mc,cb[mc].text,sa));Sa=Mb.count}}else if(sa.Range){var od=
db.D(sa.Range),ld=this.Eub(od,Mb,1);this.vFa(cb,ra,ib,sa.Span.Start,null);this.vFa(cb,ra,sa.Span.Start,sa.Span.End,ld);Array.add(Fa,new jc.a(od,ta));ib=sa.Span.End;Array.add(Ab,sa.Span);var Zc=cb.length-1;Array.add(Tb,new l(Zc,cb[Zc].text,sa))}}this.vFa(cb,ra,ib,ra.length,null);this.Quj(O,cb,!!Ba);var Rb=O.textBox.text;if(!Ya.a.equals(Rb,ra,!1)){Q.ULS.shipAssertTag(38114182,0,!1,"ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [{0}], originalTextLength [{1}]",
Rb.length,ra.length);var fd=O.textBox.caretPosition;O.textBox.text=ra;O.textBox.caretPosition=fd;return!0}this.Gdc(Fa,Mb,Tb);Pa.EwaSettings.la(620)&&0<Fa.length&&Q.ULS.sendTraceTag(537169988,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");Pa.EwaSettings.la(620)&&0<O.colors.count&&Q.ULS.sendTraceTag(537169987,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.s5a=!0}finally{mb&&mb.PAa(function(){Wa&&Q.ULS.sendTraceTag(537169986,
0,50,"ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in {0} ms",mb.Ec)})}}else return this.Gdc(null,null),this.s5a&&(this.s5a=!1,ta=O.textBox.caretPosition,O.textBox.setPlainText(ra),O.textBox.caretPosition=Math.min(ta,ra.length),Ba)?!0:!1};d.prototype.qrf=function(O,Ba,ra){if(!O||!Ba||!ra)return Q.ULS.shipAssertTag(537169985,0,!!O,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),Q.ULS.shipAssertTag(537169984,0,!!Ba,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),
Q.ULS.shipAssertTag(537169955,0,!!ra,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;var ta=Object(pb.a)(l,Ba.metadata);if(!ta)return Q.ULS.shipAssertTag(537169954,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),!1;var Fa=ta.dKj,cb=ta.y9f,Wa=this.gridView.Sb.Ldf(ra)?ra.Cac(ta.swa,ta.twa):ra.d4a(ta.swa,ta.twa,ta.CLa,ta.DLa);if(!Wa)return Q.ULS.shipAssertTag(537169953,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;var mb=cb.indexOf("!");
-1!==mb&&(Wa=cb.substring(0,mb+1)+Wa);if(!O.textBox.changeTextInExistingTextPart(Fa,cb,Wa))return Q.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;ta.y9f=Wa;Fa=!0;for(cb=1;4>=cb;cb++)(Wa=eb.g(this.Pc).Ob.XE(3,cb,Ba.v$))?(Wa.range=ra,Wa.metadata=ta):(Q.ULS.shipAssertTag(537169952,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),Fa=!1);this.gridView.Ob.update(!1,!1);this.gridView.qc.Cj&&(this.gridView.qc.textBox.text=
O.text);this.gridView.qc.TFb(new Oa.a({ryb:!0}));return Fa};d.prototype.Aki=function(O){if(3!==O.lr)return Q.ULS.shipAssertTag(537169951,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;O=Object(pb.a)(l,O.metadata);return O?O.G6a&&!O.jhc:(Q.ULS.shipAssertTag(537169950,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)};d.prototype.Kdb=function(O,Ba){Q.ULS.sendTraceTag(537169949,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+
(Ba?"suspending":"resuming")+" colored references");!Ba||this.dif&&!this.s5a||(this.dif&&(this.s5a=!1),this.Gdc(null,null),O.textBox.uYg());this.w8f=Ba};d.prototype.dispose=function(){this.gridView&&this.gridView.zc&&this.gridView.zc.Mn(this.TCb)};d.prototype.h8h=function(O){var Ba=this.bgd(),ra=this.K1e(),ta=this.Pc.workbookContext.WorkbookFileName,Fa=[],cb=new qa.a(!1),Wa=[];if(ra=this.calcManager.extractReferences(O,ra,ta,!this.scf)){ra=yl(ra.Items);for(ta=ra.next();!ta.done;ta=ra.next())if(ta=
ta.value,ta.Range){var mb=db.D(ta.Range);Array.add(Fa,new jc.a(mb,Ba));this.Eub(mb,cb,1);Array.add(Wa,new l(ta.Span.Start,O.substring(ta.Span.Start,ta.Span.End),ta,!0))}this.Gdc(Fa,cb,Wa)}};d.prototype.Eub=function(O,Ba,ra){var ta=Ba.getItem(O.toString());ta||(ta=this.colors[Ba.count%this.colors.length],Ba.add(O.toString(),ta));return String.format(ta,ra)};d.prototype.GMh=function(O,Ba,ra,ta){O="["+O+", "+Ba+"]";Ba=ra.getItem(O);Ba||(Ba=ra.count%this.colors.length,Ba=this.colors[Ba],ta===String.format(Ba,
1)&&(ra.add("skip-"+O,Ba),Ba=ra.count%this.colors.length,Ba=this.colors[Ba]),ra.add(O,Ba));return String.format(Ba,1)};d.prototype.vFa=function(O,Ba,ra,ta,Fa){Q.ULS.shipAssertTag(537169948,0,ra<=ta,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");ra<ta&&(Ba=Ba.substring(ra,ta),Array.add(O,Object.assign(new Ub.a,{text:Ba,color:Fa})))};d.prototype.Gdc=function(O,Ba,ra){var ta=this;ra=void 0===ra?null:ra;O&&O.length?(Q.ULS.sendTraceTag(537169947,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+
O.length),O.reverse(),ra.reverse(),this.gridView.Ob.qy(O,[3],!0,function(Fa,cb){if(Fa&&Fa.range&&cb){Q.ULS.shipAssertTag(537169943,0,Ba.xb(Fa.range.toString()),"ColoredReferencesManager.HighlightRanges: The range '{0}' doesn't exist in the range to color dictionary",Fa.range.toString());var Wa=ta.Eub(Fa.range,Ba,.1),mb=ta.Eub(Fa.range,Ba,1);ta.Pc.frame&&ta.Pc.frame.yH&&ta.Pc.frame.yH.Hka||(cb.style.background=Wa);cb.style.borderColor=mb;ra&&(cb.setAttribute(lc.a.wxb,Fa.v$.toString()),Fa.metadata=
ra[Fa.v$])}else Q.ULS.shipAssertTag(537169946,0,!!Fa,"ColoredReferencesManager.HighlightRanges: state is null"),Q.ULS.shipAssertTag(537169945,0,!!Fa.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),Q.ULS.shipAssertTag(537169944,0,!!cb,"ColoredReferencesManager.HighlightRanges: div is null")})):(O=this.Pc.Wb.Ic("UserAction","HideRangesHighlightsStopwatch"),this.gridView.Ob.kl([3]),this.gridView.Ob.GJb(new jc.a(null,this.bgd()),[3]),O.stop())};d.prototype.Quj=function(O,Ba,ra){var ta=
O.textBox;ta.mK=!0;var Fa=ta.selection,cb=Fa.index;Fa=cb+Fa.length;ta.setTextFromTextParts(Ba);Ba=ta.text.length;ta.selectRange(Math.min(cb,Ba),Math.min(Fa,Ba));ra&&O.TFb(new Oa.a);ta.mK=!1};d.prototype.bgd=function(){return this.J1e().sheetId};d.prototype.K1e=function(){return this.J1e().sheetName};d.prototype.J1e=function(){return this.gridView.mt&&this.gridView.mt.XK?this.gridView.mt.XK:this.Pc.pa};d.OFi="rgba(9, 134, 88, 1)";d.YOg="rgba(0, 0, 255, 1)";d.AHj="rgba(163, 21, 21, 1)";Object(F.a)(d,
"ColoredReferencesManager",null,[733,2]);var Kb=la.a;vm(c,Kb);c.prototype.create=function(){var O=this;this.$.da.Za(266,function(Ba){O.Gb(new d(O.$,Ba))})};c.ka=function(O){O.da.Ha(282,new c(O))};Object(F.a)(c,"ColoredReferencesManagerFactory",la.a,[]);var dc=b(935),Qb=la.a;vm(a,Qb);a.prototype.create=function(){var O=this;this.$.da.Za(266,function(Ba){O.Gb(new dc.RelativeAndAbsoluteReferencesManager(Ba))})};a.ka=function(O){O.da.Ha(295,new a(O))};Object(F.a)(a,"RelativeAndAbsoluteReferencesManagerFactory",
la.a,[]);Type.registerNamespace("_Ewa");y.a.Ga(z.ka);y.a.Ga(n.ka);y.a.Ga(c.ka);y.a.Ga(a.ka)},924:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.abs="Abs";a.rel="Rel";Object(y.a)(a,"PositionBaseType",null,[])},935:function(y,F,b){function a(D){this.calcManager=D}function c(){return w.call(this)||this}function d(){this.Duc=this.firstRow=null;return this}function l(){return w.call(this)||this}function n(){this.right=this.left=this.bottom=this.top=null;return this}function m(){return w.call(this)||
this}function f(){this.Cuc=this.firstColumn=null;return this}function v(){var D=w.call(this)||this;D.hhc=!1;return D}function w(){this.end=this.start=0;this.gv=null}function t(){this.column=this.row=null;return this}function A(){}b.r(F);y=b(0);var x=b(13);Object(y.a)(A,"Reference",null,[]);vm(t,A);Object(y.a)(t,"CellReference",A,[]);w.prototype.CKg=function(D,V){for(var U=0;U<this.gv.length;U++){var Q=this.a_b(D,this.gv[U]);V+=Q;U<this.gv.length-1&&(V+=":")}return V};Object(y.a)(w,"IReferenceSequence",
null,[]);var u=b(24),B=b(924);vm(v,w);v.prototype.rbc=function(){var D=b(935).RelativeAndAbsoluteReferencesManager,V=this.gv[0];return D.wsf(V.row.kind===B.a.abs,V.column.kind===B.a.abs)};v.prototype.a_b=function(D,V){V=u.Range.ld(V.row.index+1,V.column.index+1);return this.hhc?V.Cac(1===D||3===D,1===D||2===D):V.d4a(1===D||3===D,1===D||2===D,!0,!0)};Object(y.a)(v,"CellReferenceSequence",w,[]);vm(f,A);Object(y.a)(f,"ColumnReference",A,[]);vm(m,w);m.prototype.rbc=function(){var D=this.gv[0];return b(935).RelativeAndAbsoluteReferencesManager.Rqf(D.firstColumn,
D.Cuc).kind===B.a.abs?2:3};m.prototype.a_b=function(D,V){return u.Range.Ztb(V.firstColumn.index+1,V.Cuc.index+1).d4a(1===D||3===D,!0,1===D||3===D,!0)};Object(y.a)(m,"ColumnReferenceSequence",w,[]);vm(n,A);Object(y.a)(n,"RangeReference",A,[]);vm(l,w);l.prototype.rbc=function(){var D=b(935).RelativeAndAbsoluteReferencesManager,V=this.gv[0];return D.wsf(V.top.kind===B.a.abs,V.left.kind===B.a.abs)};l.prototype.a_b=function(D,V){V=new u.Range(V.top.index+1,V.left.index+1,V.bottom.index+1,V.right.index+
1,!1,!1);var U=1===D||3===D;D=1===D||2===D;return V.d4a(U,D,U,D)};Object(y.a)(l,"RangeReferenceSequence",w,[]);vm(d,A);Object(y.a)(d,"RowReference",A,[]);vm(c,w);c.prototype.rbc=function(){var D=this.gv[0];return b(935).RelativeAndAbsoluteReferencesManager.Rqf(D.firstRow,D.Duc).kind===B.a.abs?0:1};c.prototype.a_b=function(D,V){return u.Range.m$b(V.firstRow.index+1,V.Duc.index+1).d4a(!0,1===D||2===D,!0,1===D||2===D)};Object(y.a)(c,"RowReferenceSequence",w,[]);var r=b(1129),I=b(1130),z=b(193);b.d(F,
"RelativeAndAbsoluteReferencesManager",function(){return a});a.prototype.T0a=function(D,V,U){var Q=V;var la=U;if(!D||!z.e(D))return{returnValue:D,Fxd:Q,Exd:la};var ba=this.calcManager.CSe(D);if(!ba)return x.ULS.sendTraceTag(537169940,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),{returnValue:null,Fxd:Q,Exd:la};ba=this.JYh(ba,D,V,U);for(var S=0,H="",T=0,K=0;K<ba.length;K++)if(this.xJe(ba[K],V,U)){S=ba[K].rbc();
Q=ba[K].start;break}for(;K<ba.length&&this.xJe(ba[K],V,U);K++)H+=D.substring(T,ba[K].start),H=ba[K].CKg(S,H),T=ba[K].end;T&&(la=H.length);H+=D.substring(T,D.length);return{returnValue:H,Fxd:Q,Exd:la}};a.prototype.JYh=function(D,V,U,Q){for(var la=[],ba=0;ba<D.length;ba++){var S=D[ba];if(S.kind===r.a.range)if(S=S.ref,S.type===I.a.cell){var H=S;S=Object.assign(new v,{start:S.span.start,end:S.span.end,gv:[Object.assign(new t,{column:H.col,row:H.row})],hhc:this.calcManager.q1b(S.span.end,V)});la.push(S)}else if(S.type===
I.a.range)this.yJe(S.topLeftSpan,U,Q)&&this.yJe(S.bottomRightSpan,U,Q)?(H=new n,S.top.index<=S.bottom.index?(H.top=S.top,H.bottom=S.bottom):(H.bottom=S.top,H.top=S.bottom),S.left.index<=S.right.index?(H.left=S.left,H.right=S.right):(H.right=S.left,H.left=S.right),S=Object.assign(new l,{start:S.topLeftSpan.start,end:S.bottomRightSpan.end,gv:[H]}),la.push(S)):(H=Object.assign(new v,{start:S.topLeftSpan.start,end:S.topLeftSpan.end,gv:[Object.assign(new t,{column:S.left,row:S.top})],hhc:this.calcManager.q1b(S.topLeftSpan.end,
V)}),S=Object.assign(new v,{start:S.bottomRightSpan.start,end:S.bottomRightSpan.end,gv:[Object.assign(new t,{column:S.right,row:S.bottom})],hhc:this.calcManager.q1b(S.topLeftSpan.end,V)}),la.push(H),la.push(S));else if(S.type===I.a.column){H=S;for(S=Object.assign(new m,{start:S.span.start,end:S.span.end,gv:[Object.assign(new f,{firstColumn:H.startIndex,Cuc:H.endIndex})]});S.end<V.length-1&&":"===V.charAt(S.end)&&ba<D.length-1;)if(H=D[ba+1].ref,H.type===I.a.column&&H.span.start===S.end+1){var T=H;
S.gv.push(Object.assign(new f,{firstColumn:T.startIndex,Cuc:T.endIndex}));S.end=H.span.end;ba++}else break;la.push(S)}else if(S.type===I.a.row){H=S;for(S=Object.assign(new c,{start:S.span.start,end:S.span.end,gv:[Object.assign(new d,{firstRow:H.startIndex,Duc:H.endIndex})]});S.end<V.length-1&&":"===V.charAt(S.end)&&ba<D.length-1;)if(H=D[ba+1].ref,H.type===I.a.row&&H.span.start===S.end+1)T=H,S.gv.push(Object.assign(new d,{firstRow:T.startIndex,Duc:T.endIndex})),S.end=H.span.end,ba++;else break;la.push(S)}}return la};
a.prototype.xJe=function(D,V,U){return!(D.start>U||V>D.end)};a.prototype.yJe=function(D,V,U){return!(D.start>U||V>D.end)};a.Rqf=function(D,V){return D.index<=V.index?D:V};a.wsf=function(D,V){return V||D?V&&D?2:!V&&D?3:0:1};Object(y.a)(a,"RelativeAndAbsoluteReferencesManager",null,[732])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.calc.js.map/87b90f8284b38af35a89fc27a57482bc/EwaDS.calc.js.map