/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1011:function(y,F,b){function a(){this.tLa=0;this.Aha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Ddc=!1;this.A$e=this.via=null}b.d(F,"a",function(){return a});y=b(0);Object(y.a)(a,"AddInCommandsNotificationParameters",null,[])},1065:function(y,F,b){function a(){}function c(){}function d(T,K,da,fa,W,ca){T=l.call(this,T,K,da,fa,W,void 0===ca?null:ca)||this;T.RTb=null;return T}function l(T,
K,da,fa,W,ca){T=n.call(this,T,da,W.oX,void 0===ca?null:ca)||this;T.vbe=0;T.k1=T.ZTh(fa);T.KXa=K;T.gf=W;T.wLj=7;T.fl=T.KXa.ownerDocument.createElement("div");T.fl.className="ModalCalloutControlOverlay";T.fl.tabIndex=0;T.KXa.insertBefore(T.fl,T.KXa.firstChild);return T}function n(T,K,da,fa){var W=A.call(this,document.createElement("div"))||this;W.Lqa=null;W.npa=null;W.yG=null;W.tG=null;W.Rw=null;W.WS=null;W.XS=null;W.$pa=!1;W.Cib=!1;W.Cp=null;W.content=null;W.k1=0;W.Ete=null;W.cU=0;W.RDf=null;W.mie=
T;W.qde=K;W.vP=da;W.RGa=fa;W.zg=K.ownerDocument;W.Uib=!1;W.Ru=!1;W.vjd=!1;return W}y=b(0);var m=b(13),f=b(80),v=b(370),w=b(12),t=b(89),A=Sys.UI.Control;vm(n,A);n.prototype.show=function(){this.Uib||(this.j6g(),this.Kj(),this.qde.appendChild(this.oW),this.oW.style.display="Block",this.zuj(),this.Uib=!0,this.RDf&&this.RDf())};n.prototype.dismiss=function(){this.Uib&&(this.KU(),this.qde.removeChild(this.oW),this.Uib=!1,this.RGa&&this.RGa())};n.prototype.dispose=function(){this.dismiss();this.WS=this.Rw=
this.tG=this.npa=this.yG=this.Lqa=null;Sys.Component.prototype.dispose.call(this)};n.prototype.pi=function(T){return this.get_element().id+T};n.prototype.j6g=function(){this.yG=this.zg.createElement("div");this.yG.id=this.pi("WACCalloutHeader");this.yG.className="WACCalloutHeader";this.Ru&&this.Cle();this.vjd&&this.Pme();this.tG=this.zg.createElement("div");this.tG.id=this.pi("WACCalloutContent");this.tG.className="WACCalloutContent";this.tG.style.width=190<this.k1?this.k1-26+"px":"164px";this.tG.appendChild(this.content);
this.oW.appendChild(this.W_b);this.oW.appendChild(this.yG);this.oW.appendChild(this.tG)};n.prototype.Cle=function(){this.Rw=this.zg.createElement("a");this.Rw.className="WACCalloutCloseAnchor";this.Rw.id=this.pi("WACCalloutCloseAnchor");this.Rw.href="#";this.yG.appendChild(this.Rw);var T=v.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Rw.appendChild(T)};n.prototype.Pme=function(){this.WS=this.zg.createElement("div");this.WS.className=
"WACCalloutTitle UIFontBold";this.WS.style.width=190<this.k1?this.k1-30+"px":"160px";this.WS.id=this.pi("WACCalloutTitle");this.WS.innerText=this.title;this.yG.contains(this.Rw)?this.yG.insertBefore(this.WS,this.Rw):this.yG.appendChild(this.WS)};n.prototype.zuj=function(){var T=this.mie;if(1===this.cU){var K=this.Ete.y+16;var da=-16}else 2===this.cU||3===this.cU||0===this.cU?(K=T.y+T.height+15,da=-15):(K=T.y-this.oW.clientHeight-15-2,da=this.oW.clientHeight-1);this.oW.style.top=K+"px";this.W_b.style.top=
da+"px";1===this.cU?(T=this.Ete.x-16,this.oW.style.left="50%",this.oW.style.marginLeft=-this.k1/2+"px",K=Sys.UI.DomElement.getBounds(this.oW),this.W_b.style.left=T-K.x+"px"):(K=T.x+this.mie.width/2,2===this.cU||5===this.cU?(T=20,K-=36):0===this.cU||4===this.cU?(T=this.k1/2-16,K-=this.k1/2):(T=this.k1-20-32,K=K-this.k1+36),this.oW.style.left=K+"px",this.W_b.style.left=T+"px")};n.prototype.Kj=function(){this.Ru&&!this.XS&&(this.XS=Object(f.a)(this,this.t$,"closeHandler"),this.vP.qa(w.a.click,this.Rw,
this.XS,null))};n.prototype.KU=function(){this.Ru&&this.XS&&(this.vP.za(w.a.click,this.Rw,this.XS),this.XS=null)};n.prototype.t$=function(){this.dismiss();return!0};Qk.Object.defineProperties(n.prototype,{oW:{configurable:!0,enumerable:!0,get:function(){this.Lqa||(this.Lqa=this.zg.createElement("div"),this.Lqa.id=this.pi("WACCalloutOuter"),this.Lqa.className="WACCalloutOuter",this.Lqa.setAttribute(t.a.Ud,t.a.jZa),this.Lqa.style.width=this.k1+"px");return this.Lqa}},W_b:{configurable:!0,enumerable:!0,
get:function(){if(!this.npa){this.npa=this.zg.createElement("div");this.npa.id=this.pi("WACCalloutBeakContainer");this.npa.className="WACCalloutBeakContainer";var T="CalloutBeakTopFilled_32x16x32";if(5===this.cU||6===this.cU||4===this.cU)T="CalloutBeakBottomFilled_32x16x32";T=v.createClusteredImage(32,16,T,"WACCalloutBeak",!0,"");this.npa.appendChild(T)}return this.npa},set:function(T){this.npa=T}},ZLa:{configurable:!0,enumerable:!0,get:function(){return this.Uib}},title:{configurable:!0,enumerable:!0,
get:function(){return this.Cp},set:function(T){this.Cp!==T&&(this.Cp=T,this.WS&&(this.WS.innerText=this.Cp))}},Ru:{configurable:!0,enumerable:!0,get:function(){return this.$pa},set:function(T){this.$pa!==T&&(this.$pa=T,this.yG&&(this.yG.contains(this.Rw)&&!this.$pa?this.yG.removeChild(this.Rw):!this.yG.contains(this.Rw)&&this.$pa&&this.Cle()))}},vjd:{configurable:!0,enumerable:!0,get:function(){return this.Cib},set:function(T){this.Cib!==T&&(this.Cib=T,this.yG&&(this.yG.contains(this.WS)&&!this.Cib?
this.yG.removeChild(this.WS):!this.yG.contains(this.WS)&&this.Cib&&this.Pme()))}}});Object(y.a)(n,"Callout",Sys.UI.Control,[335]);vm(l,n);l.prototype.show=function(){this.ZLa||(this.gf.Zpc(),this.gf.XP(!1),this.fl.style.zIndex=String(this.gf.o2),n.prototype.show.call(this),this.al(),this.vbe=window.setTimeout(Object(f.a)(this,this.dismiss,"dismiss"),1E3*this.wLj))};l.prototype.dismiss=function(){this.ZLa&&(this.gf.PM(!1),this.tn(),this.KXa&&this.KXa.contains(this.fl)&&this.KXa.removeChild(this.fl),
n.prototype.dismiss.call(this),window.clearTimeout(this.vbe))};l.prototype.al=function(){this.gf.Kra(Object(f.a)(this,this.dismiss,"dismiss"));this.gf.uy.qa(w.a.click,this.fl,Object(f.a)(this,this.$c,"onClick"))};l.prototype.tn=function(){this.gf.Zab(Object(f.a)(this,this.dismiss,"dismiss"));this.gf.uy.za(w.a.click,this.fl,Object(f.a)(this,this.$c,"onClick"))};l.prototype.$c=function(){this.dismiss();return!0};l.prototype.ZTh=function(T){var K=0;switch(T){case 0:K=190;break;case 1:K=250;break;case 2:K=
300;break;case 3:K=360}return K};Object(y.a)(l,"ModalCallout",n,[]);var x=b(585),u=b(188);vm(d,l);d.prototype.show=function(){var T=this;if(!this.ZLa){var K=Object.assign(new x.a,{onShow:function(){l.prototype.show.call(T)}});u.UISurfaces.oV().then(function(da){var fa=da.externalNotification();T.RTb=da.addNotification(fa,K);return null},function(da){m.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",da);return null})}};d.prototype.dismiss=function(){var T=this;this.ZLa&&
this.RTb&&(u.UISurfaces.oV().then(function(K){K.removeNotification(T.RTb);return T.RTb=null},function(K){m.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null}),l.prototype.dismiss.call(this))};Object(y.a)(d,"ReactManagedModalCallout",l,[]);var B=b(5);c.S7g=function(T,K,da,fa){var W=void 0===W?null:W;return B.AFrameworkApplication.sa.Qa.nR?new d(T,K,da,fa,B.AFrameworkApplication.sa,W):new l(T,K,da,fa,B.AFrameworkApplication.sa,W)};Object(y.a)(c,"ModalCalloutControlFactory",
null,[]);var r=b(49),I=b(999),z=b(599),D=b(1E3),V=b(128),U=b(85),Q=b(47),la=b(87),ba=b(858),S=b(941),H=b(818);b.d(F,"a",function(){return a});a.i3c=function(T,K,da,fa,W,ca){a.lJ&&a.lJ.ZLa&&a.lJ.dismiss();a.lJ=c.S7g(K,T,T,W);a.lJ.content=da;H.b(fa)||(a.lJ.title=fa,a.lJ.vjd=!0);T=new Sys.UI.Bounds(0,0,U.a.n4a(),U.a.dcc());a.lJ.cU=a.OLh(T,K,a.lJ.k1,ca);a.lJ.show();a.s_b&&a.s_b.sendNotification(da.innerText,!0)};a.k3c=function(T,K,da,fa){fa=void 0===fa?null:fa;u.UISurfaces.oV().then(function(W){var ca=
null;a.Rkb&&(W.removeNotification(a.Rkb),a.Rkb=null);var ia=W.callout(Object.assign(new I.a,{target:T,title:K,content:da,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new D.a,{onDismiss:function(){W.removeNotification(ca)},directionalHint:null!=fa?fa:null})})),ea=Object.assign(new x.a,{expirationOptions:Object.assign(new z.a,{displayTimeoutSeconds:7,onExpire:function(){W.removeNotification(a.Rkb)}})});ca=a.Rkb=W.addNotification(ia,ea);return null},
function(W){m.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",W);return null})};a.jRd=function(T,K){K=void 0===K?null:K;a.lJ&&a.lJ.ZLa&&a.lJ.dismiss();var da=new V.StandardDialog;da.dSa=!1;da.kc=0;da.Iz(r.a.Dri,CommonUIStrings.l_DialogError,H.b(T)?a.tZe():T,K)};a.lRd=function(T){a.lJ&&a.lJ.ZLa&&a.lJ.dismiss();m.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",T.errorCode));var K=H.b(T.description)?a.tZe():T.description,da=
new V.StandardDialog,fa=null;T.Aha?(da.kc=1,da.Gc(1,T.buttonText),da.sna(1)):da.kc=0;fa=function(W){1===W?T.Aha():T.via&&T.via()};da.dSa=!1;0===T.tLa?da.Iz(T.errorCode,T.title?T.title:CommonUIStrings.l_DialogError,K,fa):1===T.tLa?da.iX(T.title?T.title:CommonUIStrings.l_DialogWarning,K,fa):da.FAa(T.title?T.title:CommonUIStrings.l_DialogInfo,K,fa)};a.OLh=function(T,K,da,fa){var W=0===fa?0:4,ca=T.x+T.width-K.x-K.width;K.x-T.x+K.width/2<=da/2?W=0===fa?2:5:ca+K.width/2<=da/2&&(W=0===fa?3:6);return W};
a.CAj=function(T,K,da,fa,W,ca){ca=void 0===ca?!1:ca;var ia=B.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1),ea=B.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SkipTeachingCalloutEnabled",!1);if(a.UYd)(K=S.a.eub(fa))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(K,function(Pa){Pa&&(ia&&ea&&ca||a.k3c(Pa,W,da,5))});else if(T)if(fa&&fa.tabs.count){fa=
fa.tabs.oa(0);var qa=fa.MSa[ba.a.id],pa=fa.gK.oa(0).Gva[ba.a.id];T.bNd(qa)&&(T=fa.isOfficeTab?T.CRh(qa,pa):T.p_h(qa))&&(T.x+T.width/2>U.a.n4a()&&(T=new Sys.UI.Bounds(U.a.n4a(),T.y+T.height,0,0)),ia&&ea&&ca||a.i3c(K,T,a.hve(da),W,2,0))}else m.ULS.sendTraceTag(17326355,220,50,"There is no tab or group added to ribbon !");else m.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.DAj=function(T,K,da,fa,W){W=void 0===W?!1:
W;a.CAj(T,K,fa.startedNode?fa.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,da),fa,fa.startedNode?fa.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,da),W)};a.BAj=function(T,K,da,fa){if(a.UYd)T=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,da,fa,CommonUIStrings.l_InsertionDialogRefresh)),a.k3c(K,T,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{K=Q.a.Cn(K);
var W=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),ca=document.createElement("span");ca.innerText=W[0];var ia=document.createElement("span");ia.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,da,fa,CommonUIStrings.l_InsertionDialogRefresh);ia.className="UIFontBold";da=document.createElement("span");da.innerText=W[1];fa=document.createElement("div");Sys.UI.DomElement.addCssClass(fa,"ModalCalloutControl");fa.appendChild(ca);fa.appendChild(ia);fa.appendChild(da);
a.i3c(T,K,fa,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.YBj=function(T,K){var da=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,fa=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.UYd?a.k3c(K,da,fa):(K=Q.a.Cn(K),a.i3c(T,K,a.hve(fa),da,3,1))};a.hve=function(T){var K=document.createElement("div");Sys.UI.DomElement.addCssClass(K,"ModalCalloutControl");K.innerText=T;return K};a.tZe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};
Qk.Object.defineProperties(a,{s_b:{configurable:!0,enumerable:!0,get:function(){return a.bfa||(a.bfa=la.a.instance.Nh("Common.Utils.IAriaNotifier"))}},UYd:{configurable:!0,enumerable:!0,get:function(){return B.AFrameworkApplication.sa.Qa.Ni&&B.AFrameworkApplication.sa.Qa.nR}}});a.lJ=null;a.Rkb=null;a.bfa=null;Object(y.a)(a,"AddInCommandsNotificationFactory",null,[])},1074:function(y,F,b){function a(u,B,r,I,z){this.Hs=u;this.eJ=r;this.B1=I;this.Od=z;this.ihb=this.eJ.Ii;this.Ay=this.ihb.getOsfControl(B);
this.ysg=this.Ay.getManifest()}function c(u,B,r,I){this._id=u;this.Hs=B;this.B1=r;this.Od=I}function d(u,B,r,I){this.Zz=!1;this._id=u;this.Hs=B;this.B1=r;this.Od=I}b.r(F);y=b(0);var l=b(13),n=b(1413),m=b(151),f=b(116),v=b(845),w=b(860),t=b(337);d.prototype.setEnabled=function(){};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};d.prototype.invokePropertyGet=function(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};d.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};d.prototype.invokePropertySet=function(u,B){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};d.prototype.invokePropertySetAsync=function(u,B){this.invokePropertySet(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
d.prototype.invokeMethod=function(u,B){switch(u){case 5:return this.krj(B);case 1:return this.hCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};d.prototype.invokeMethodAsync=function(u,B){u=this.invokeMethod(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};d.prototype.krj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setEnabled(u);return null};d.prototype.hCa=function(){this._OnAccess();return null};
Qk.Object.defineProperties(d.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.Zz},set:function(u){var B=b(1074).DynamicRibbon,r=this.Od.OwnerAddinStoreType,I=this.Od.PrimaryMarketplace.MarketplaceRef,z={};z=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,I,this.Hs),z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,I,this.Od.OwnerAddinAssetId),z.ownerAddinStoreType=r,z.ribbonControlType="Button",z.toggle=u,z);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:B.uzc+
"ControlUpdate",dataFields:f.a.Qk(z)}));this.Zz=u;u={};r=(u.DynamicAddinCommandsMethodDispatchId=1,u.SolutionId=this.Hs,u.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,I,this.Hs),u.SourceControlId=this.id,u.MethodData=this.Zz,u);this.B1.hK(-1014260128,r)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(y.a)(d,"RibbonButton",null,[]);c.prototype.setVisibility=function(u){var B=b(1074).DynamicRibbon,
r=this.Od.OwnerAddinStoreType,I=this.Od.PrimaryMarketplace.MarketplaceRef,z={};z=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,I,this.Hs),z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,I,this.Od.OwnerAddinAssetId),z.ownerAddinStoreType=r,z.ribbonControlType="Tab",z.toggle=u,z);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:B.uzc+"ControlUpdate",dataFields:f.a.Qk(z)}));B={};u=(B.DynamicAddinCommandsMethodDispatchId=2,B.SolutionId=this.Hs,B.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,
I,this.Hs),B.StoreType=r,B.SourceControlId=this.id,B.MethodData=u,B);this.B1.hK(-1014260128,u)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=function(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};
c.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokePropertySetAsync=function(u,B){this.invokePropertySet(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(u,B){switch(u){case 3:return this.cvj(B);case 1:return this.hCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokeMethodAsync=function(u,B){u=this.invokeMethod(u,
B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};c.prototype.cvj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);return null};c.prototype.hCa=function(){this._OnAccess();return null};Qk.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(y.a)(c,"RibbonTab",null,[]);var A=b(1118),x=b(157);b.d(F,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=
function(u){try{var B={},r=(B.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Od.OwnerAddinStoreType,this.Od.PrimaryMarketplace.MarketplaceRef,this.Hs),B.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Od.OwnerAddinStoreType,this.Od.PrimaryMarketplace.MarketplaceRef,this.Od.OwnerAddinAssetId),B.ownerAddinStoreType=this.Od.OwnerAddinStoreType,B.ribbonControlType="Ribbon",B);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:a.uzc+"ExecuteRequestCreate",dataFields:f.a.Qk(r)}));var I=x.a.oi(u);
u={};B={};B[v.a.AIa]=this.Ay;B[v.a.BIa]=I;B[v.a.B7c]=this.Od;u[v.a.psb]=3;u[v.a.V3]=this.Hs;u[v.a.b7b]=Telemetry.PrivacyRules.GetAssetId(this.Od.OwnerAddinStoreType,this.Od.PrimaryMarketplace.MarketplaceRef,this.Hs);u[v.a.U3]=B;this.B1.hK(-1014260128,u);var z=a.z$b("ExecuteRequestCreate",!0,"");l.ULS.sendTraceTag(538572826,0,50,z)}catch(D){I=a.z$b("ExecuteRequestCreate",!1,D.toString()),l.ULS.sendTraceTag(538572825,0,50,I)}return null};a.prototype.executeRequestUpdate=function(u){try{var B=null,r=
null;B=this.Od.OwnerAddinStoreType;r=this.Od.PrimaryMarketplace.MarketplaceRef;var I={},z=(I.addinAssetId=Telemetry.PrivacyRules.GetAssetId(B,r,this.Hs),I.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(B,r,this.Od.OwnerAddinAssetId),I.ownerAddinStoreType=this.Od.OwnerAddinStoreType,I.ribbonControlType="Ribbon",I);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:a.uzc+"ExecuteRequestUpdate",dataFields:f.a.Qk(z)}));var D=x.a.oi(u);u={};I={};I[v.a.AIa]=this.Ay;I[v.a.BIa]=D;I[v.a.B7c]=this.Od;
u[v.a.psb]=3;u[v.a.V3]=this.Hs;u[v.a.b7b]=Telemetry.PrivacyRules.GetAssetId(B,r,this.Hs);u[v.a.U3]=I;this.B1.hK(-1014260128,u);var V=a.z$b("ExecuteRequestUpdate",!0,"");l.ULS.sendTraceTag(538572824,0,50,V)}catch(U){B=a.z$b("ExecuteRequestUpdate",!1,U.toString()),l.ULS.sendTraceTag(538572823,0,50,B)}return null};a.prototype.getButton=function(u){var B=null;if(!this.Mdf())return this.pDe();if(u&&0<u.length){if(!this.zye(u))return this.HDe(u);B=new d(u,this.Hs,this.B1,this.Od)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)};
a.prototype.getTab=function(u){var B=null;if(!this.Mdf())return this.pDe();if(this.Ay.getOwnerAddinControlRecreated())return this.h7g();if(u&&0<u.length){if(!this.zye(u))return this.HDe(u);B=new c(u,this.Hs,this.B1,this.Od)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)};a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};a.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};a.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};a.prototype.invokePropertySetAsync=function(u,B){this.invokePropertySet(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(u){switch(u){case 1:return this.hCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};a.prototype.invokeMethodAsync=function(u,B){switch(u){case 7:return this.uzh(B);case 6:return this.vzh(B);case 3:return this.wLh(B);case 5:return this.o_h(B)}u=this.invokeMethod(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};a.prototype.uzh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestCreate(u)};a.prototype.vzh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)};
a.prototype.wLh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)};a.prototype.o_h=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getTab(u)};a.prototype.hCa=function(){this._OnAccess();return null};a.prototype.HDe=function(u){return A.a(w.a.P2g,x.a.fa(1721)+u)};a.prototype.pDe=function(){return A.a(w.a.kjj,x.a.fa(1717))};a.prototype.h7g=function(){return A.a(w.a.hostRestartNeeded,x.a.fa(1722))};
a.prototype.Mdf=function(){var u=this.Ay.getSharedRuntimeId();u=!!u&&0<u.length;l.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u};a.prototype.zye=function(u){var B=this.ysg.getRibbonExtensionControlMap();return u in B||this.cXg(u)};a.prototype.cXg=function(u){var B=this.dDh();if(B){B=yl(B.oKe.tabs);for(var r=B.next();!r.done;r=B.next()){r=r.value;if(r.id===u)return!0;r=yl(r.groups);for(var I=r.next();!I.done;I=r.next()){I=yl(I.value.controls);
for(var z=I.next();!z.done;z=I.next()){z=z.value;if(z.id===u)return!0;if("Menu"===z.type){z=yl(z.items);for(var D=z.next();!D.done;D=z.next())if(D.value.id===u)return!0}}}}}return!1};a.prototype.dDh=function(){return n.a.getInstance().Yia(this.Od.PrimaryMarketplace.MarketplaceType,this.Od.PrimaryMarketplace.SolutionId,1)};a.z$b=function(u,B,r){var I={};I.methodName="DynamicRibbon."+u;I.result=B?"Succeeded":"Failed";I.message=r;return x.a.Lc(I)};Qk.Object.defineProperties(a.prototype,{buttons:{configurable:!0,
enumerable:!0,get:function(){return null}}});a.uzc="Office.Online.Extensibility.Ribbon.";Object(y.a)(a,"DynamicRibbon",null,[])},1095:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.I8b="extId";a.uBe="ComponentType";a.eHa="ComponentId";a.rkd="HostProps";a.Oya="OptionalProps";Object(y.a)(a,"ActionPropertyNames",null,[])},1115:function(y,F,b){function a(c,d){var l=!1;c&&(c=d.osfControl,(d=c.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&
(l=!0));return l}b.d(F,"a",function(){return a})},1117:function(y,F,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.mha=this.aTa=this.ffd=this.vhd=this.Svb=this.YUd=null}b.d(F,"a",function(){return a});y=b(0);Object(y.a)(a,"AppsForOfficeOauthResult",null,[])},1118:function(y,F,b){function a(c,d){return OfficeExtension.WacRuntime.Utility.createPromise(function(l,n){n(OfficeExtension.WacRuntime.Utility.createRichApiException(c,d))})}b.d(F,"a",function(){return a})},1232:function(y,
F,b){function a(ma,Ja,Ta){this.Iwa=!1;this.fF={};this.$=ma;this.xh=Ja;this.kmd().cna();this.indexedDB=Ta;this.indexedDB.rg()&&(this.Iwa=!0,this.indexedDB.initialize(a.mld,a.nld))}function c(ma,Ja){this.wQc=ma;this._message=Ja}function d(){}function l(){}function n(ma){switch(ma){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function m(ma,Ja){x(b(1232).CustomFunctionsInstaller.x0e("CustomFunctionsRuntimeLogging"),function(Ta){if(Ta.result&&window.console)switch(Ta=
n(ma.severity)+" "+ma.message+Ja,ma.severity){case 2:window.console.log&&window.console.log(Ta);break;case 0:window.console.info&&window.console.info(Ta);break;case 1:window.console.error&&window.console.error(Ta)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function f(ma,Ja,Ta,pb,Db){Ta=ma.CWCT(function(){Ja(ma)},Ta,3,pb);Ta.continueWith(function(){V.ULS.sendTraceTag(537163459,0,10,Db)},4);return Ta}function v(ma,Ja,Ta){return f(ma,Ja,
ia.a.none,ea.a.current,Ta)}function w(ma,Ja,Ta,pb,Db){Ta=ma.CWRCT(function(){return Ja(ma)},Ta,3,pb);Ta.continueWith(function(){V.ULS.sendTraceTag(537163460,0,10,Db)},4);return da.TaskExtensions.QAc(Ta)}function t(ma,Ja,Ta){return w(ma,Ja,ia.a.none,ea.a.current,Ta)}function A(ma,Ja,Ta,pb,Db){Ta=ma.CWRCT(function(){return Ja(ma)},Ta,3,pb);Ta.continueWith(function(){V.ULS.sendTraceTag(537163461,0,10,Db)},4);return Ta}function x(ma,Ja,Ta){return A(ma,Ja,ia.a.none,ea.a.current,Ta)}function u(ma,Ja,Ta,
pb,Db){Ta=ma.CWRCT(function(){return Ja(ma)},Ta,3,pb);Ta.continueWith(function(){V.ULS.sendTraceTag(537163462,0,10,Db)},4);return da.TaskExtensions.QAc(Ta)}function B(ma,Ja,Ta){return u(ma,Ja,ia.a.none,ea.a.current,Ta)}function r(ma,Ja,Ta,pb,Db){Ta=ma.CWCT(function(){Ja(ma)},Ta,3,pb);Ta.continueWith(function(){V.ULS.sendTraceTag(537163463,0,10,Db)},4);return Ta}function I(ma,Ja,Ta){return r(ma,Ja,ia.a.none,ea.a.current,Ta)}function z(){}function D(ma){ma=ma.split("|");this.Hs=ma[1];this.bRc=ma[2];
this.OTd=ma[3]}b.r(F);y=b(0);var V=b(13),U=b(5),Q=b(139),la=b(185),ba=b(84),S=b(521),H=b(164),T=b(81),K=b(56),da=b(35),fa=b(220),W=b(114),ca=b(555);Qk.Object.defineProperties(D.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Hs}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.bRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.OTd===OSF.StoreTypeEnum.Registry.toString()}}});Object(y.a)(D,"AddinStoreInfo",
null,[]);Object(y.a)(z,"CustomFunctionRegistrationInfos",null,[]);var ia=b(199),ea=b(59),qa=b(1115);Object(y.a)(l,"InstallationInfo",null,[]);Object(y.a)(d,"UninstallationInfo",null,[]);var pa=b(26),Pa=b(92),Ha=b(32),Ya=b(27),Na=b(1),eb=b(20),Ia=b(272),lb=b(913),hc=b(52);Qk.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.wQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(y.a)(c,"CustomFunctionLog",null,
[]);b.d(F,"CustomFunctionsInstaller",function(){return a});a.prototype.ubf=function(ma,Ja,Ta,pb){var Db=this;if(pb.invariantNamespace)for(var fb=0;fb<pb.invariantNamespace.length;++fb){var xa=pb.invariantNamespace.charAt(fb);if("."!==xa&&"_"!==xa&&"a">xa&&"z"<xa&&"A">xa&&"Z"<xa&&"0">xa&&"9"<xa)throw V.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",xa,fb),Error.create("InvariantNamespace validation failed");
}return B(this.sTg(Ta,pb.manifest),function(){return B(Db.EGd(ma),function(ya){var Ga=ya.result;return(null===Ga||void 0===Ga?0:Ga.isDynamicMetadata)?Db.IHd(ma,Ja,Ga,!1,!1,!1):B(Db.lZj(ma,Ja,pb),function(db){var Ob;Ga=(Ob=new l,Ob.addinId=Ta,Ob.locale=pb.locale,Ob.addinInvariantNamespace=pb.invariantNamespace,Ob.addinNamespace=pb.namespace,Ob.addinTitle=pb.title,Ob.isXllCompatible=pb.isXllCompatible,Ob.metadataContent=JSON.stringify(JSON.parse(db.result)),Ob);return Db.IHd(ma,Ja,Ga,!1,a.uAh(pb.osfControl.getStoreType()),
qa.a(Db.$,pb))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.wbf=function(ma,Ja,Ta,pb){var Db=this;if(!a.nrd(Ta))throw V.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return B(this.EGd(ma),
function(fb){fb=fb.result;if(!fb&&(fb=Ha.a.Hc(Db.GV,ma),!fb))throw V.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetAssetId(Ja,null,ma))),Error.create("Customfunctions dynamic registration failed");fb.metadataContent=JSON.stringify(JSON.parse(Ta));fb.isDynamicMetadata=!0;return Db.IHd(ma,Ja,fb,!0,!0,pb)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};
a.prototype.Sbg=function(ma,Ja){var Ta=this;this.xh.Gia();var pb=Object.assign(new d,{solutionId:ma}),Db=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(Ja,null,ma));return B(this.uId(ma),function(){return B(Ta.BId(ma),function(){return Ta.pXd(Ta.xh,ma,Ja,pb)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},Db)};a.prototype.lZj=function(ma,Ja,Ta){var pb=new Q.a;OSF.OUtil.xhrGet(Ta.metadataUrl,
function(Db){Db?pb.setResult(Db):pb.setException(Error.create("Invalid manifest"))},function(Db){V.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetAssetId(Ja,null,ma),Db);pb.setException(Error.create("Failed to download manifest"))});return pb.task};a.prototype.kmd=function(){var ma=this;return B(this.Xqc(),function(Ja){var Ta=Ja.result;if(!Ta.length)return hc.Task.Ta(!0);
V.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Ja=new la.a;for(var pb=[],Db={},fb=0;fb<Ta.length;Db={gPb:Db.gPb},fb++)Db.gPb=Object(ba.a)(String,Ta[fb]),Ja.add(x(ma.EGd(Db.gPb),function(xa){return function(ya){if(ya=ya.result){var Ga=Ha.a.Hc(ma.fF,ya.addinId);Ga&&Ga===ya.metadataContent||(ma.fF[ya.addinId]=ya.metadataContent,ma.GV[xa.gPb]=ya,Array.add(pb,ya))}return!0}}(Db),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));
return t(hc.Task.WAE(Ja),function(){if(pb.length){var xa,ya=(xa=new z,xa.registrationInfos=pb,xa);return ma.V_b(ma.xh,Ta,ya)}V.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return hc.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.xbf=function(){var ma=this,Ja=new Q.a;new la.a;var Ta=
[],pb=[];Object.keys(this.GV).forEach(function(Db){Db=Object(ba.a)(String,Db);var fb=Ha.a.Hc(ma.GV,Db);Array.add(Ta,fb);Array.add(pb,Db)});if(!pb.length)return Ja.setResult(!0),Ja.task;Ja=Object.assign(new z,{registrationInfos:Ta});return this.V_b(this.xh,pb,Ja)};a.prototype.Xqc=function(){return x(this.yfd(ca.a.MYa),function(ma){ma=ma.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(ma||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(ma||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.whg=function(ma){return this.IOd(ca.a.MYa,Sys.Serialization.JavaScriptSerializer.serialize(ma))};a.prototype.EGd=function(ma){return B(this.yfd(ca.a.Q3a(ma)),function(Ja){Ja=Ja.result||"";return 0<Ja.length?hc.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(Ja,!0)):hc.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.eZj=function(ma,Ja){var Ta=this;return B(this.WLe(ma),function(){return B(Ta.IOd(ca.a.Q3a(ma),
Sys.Serialization.JavaScriptSerializer.serialize(Ja)),function(){return a.JOd(ca.a.kjd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.uId=function(ma){var Ja=this;return B(this.vPf(ma),function(){return B(Ja.OPf(ca.a.Q3a(ma)),function(){return B(Ja.Xqc(),function(Ta){return Ta.result.length?hc.Task.Ta(!0):a.JOd(ca.a.kjd,
"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.cNf=function(ma){return this.yfd(ca.a.P3a(ma))};a.prototype.thg=function(ma,Ja){var Ta=this;return B(this.WLe(ma),function(){return Ta.IOd(ca.a.P3a(ma),
Ja)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.BId=function(ma){var Ja=this;return B(this.vPf(ma),function(){return Ja.OPf(ca.a.P3a(ma))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.WLe=function(ma){var Ja=this;return B(this.Xqc(),function(Ta){Ta=Ta.result;var pb=ma.toLowerCase();if(Array.contains(Ta,pb))return hc.Task.Ta(!0);Ta.push(pb);return Ja.whg(Ta)},
"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.vPf=function(ma){var Ja=this;return B(this.Xqc(),function(Ta){Ta=Ta.result;var pb=ma.toLowerCase();return Array.contains(Ta,pb)?(Ta.splice(Array.indexOf(Ta,pb),1),Ja.whg(Ta)):hc.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.sTg=function(ma,Ja){if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ma=
new OSF.AddinIdInfo(ma),ma.needToRestoreManifest()?this.thg(ma.getSolutionId(),Ja):hc.Task.Ta(!0);ma=new D(ma);return ma.needToRestoreManifest?this.thg(ma.solutionId,Ja):hc.Task.Ta(!0)};a.prototype.Jij=function(ma){var Ja=this;if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var Ta=new OSF.AddinIdInfo(ma);return Ta.needToRestoreManifest()?x(this.cNf(Ta.getSolutionId()),function(Db){(Db=Db.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ta.getSolutionId(),
Ta.getSolutionVersion(),Db,Ja.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):hc.Task.Ta(!0)}var pb=new D(ma);return pb.needToRestoreManifest?x(this.cNf(pb.solutionId),function(Db){(Db=Db.result)&&OSF.OsfManifestManager.cacheManifestFromXml(pb.solutionId,pb.solutionVersion,Db,Ja.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):hc.Task.Ta(!0)};a.prototype.OPf=function(ma){return this.Iwa?
this.indexedDB.k6c(ma):a.Taj(ma)};a.prototype.IOd=function(ma,Ja){return this.Iwa?this.indexedDB.Qbb(new lb.a(ma,Ja)):a.JOd(ma,Ja)};a.prototype.yfd=function(ma){return this.Iwa?this.indexedDB.cKa(ma):a.x0e(ma)};a.prototype.IHd=function(ma,Ja,Ta,pb,Db,fb){var xa=this,ya=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(Ja,null,ma));return da.TaskExtensions.QAc(x(this.JHd(this.xh,ma,Ja,Ta,!1,pb,fb),
function(){return Db?xa.eZj(ma,Ta):hc.Task.Ta(!0)},ya))};a.prototype.JHd=function(ma,Ja,Ta,pb,Db,fb,xa){var ya=this;if(!fb&&(fb=Ha.a.Hc(this.fF,pb.addinId))&&fb===pb.metadataContent)return hc.Task.Ta(!0);this.fF[pb.addinId]=pb.metadataContent;this.GV[Ja]=pb;xa||ma.KGb(Ja);ma.Gia();return B(this.x9i(Ja,Ta,pb),function(){return ya.pFd(pb.addinId,Db)},"Failed to register functions for customfunction addin")};a.prototype.x9i=function(ma,Ja,Ta){var pb=this,Db=new Q.a,fb=this.Zob(Ta);return this.Oia(function(xa){Na.EwaSettings.la(258)&&
m(a.vrb,ma);(xa=xa.Result)&&204===xa.ResponseStatusCode?Db.setResult(!0):(delete pb.fF[Ta.addinId],delete pb.GV[ma],I(pb.uId(ma),function(){I(pb.BId(ma),function(){pb.P3f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ma,xa?xa.ResponseStatusCode.toString():"Unknown")),Db.setResult(!1))},function(xa){xa=W.a.og(xa.data);V.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",
Telemetry.PrivacyRules.GetAssetId(Ja,null,ma),Ya.a.Uc(xa));Na.EwaSettings.la(258)&&m(a.urb,ma);delete pb.fF[Ta.addinId];delete pb.GV[ma];Db.setResult(!1)},fb,Db,!0)};a.prototype.V_b=function(ma,Ja,Ta){var pb=this,Db=new Q.a,fb=pa.a.Ra.ie.m;Ja.forEach(function(ya){ya=Object(ba.a)(String,ya);ma.dye(ya)});ma.Gia();var xa=this.GYc(Ta);return this.Oia(function(ya){Na.EwaSettings.la(258)&&m(a.vrb,Sys.Serialization.JavaScriptSerializer.serialize(Ja));ya=ya.Result;var Ga=!0,db=Sys.Serialization.JavaScriptSerializer.deserialize(ya.ResponseBody.toString());
db=Array.isArray(db.value)?db.value:null;for(var Ob=new la.a,Ec={Sea:0};Ec.Sea<db.length;Ec={Sea:Ec.Sea},Ec.Sea++)if(!db[Ec.Sea]){Ga=!1;var wb=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",ya.ResponseStatusCode);Ob.add(B(pb.uId(Ja[Ec.Sea]),function(kb){return function(){delete pb.fF[Ta.registrationInfos[kb.Sea].addinId];delete pb.GV[Ja[kb.Sea]];return pb.BId(Ja[kb.Sea])}}(Ec),wb))}v(hc.Task.WAE(Ob),function(){I(pb.pFd("",
!1),function(){V.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",pa.a.Ra.ie.m-fb);Ga?Db.setResult(Ga):v(pb.P3f(),function(){Db.setResult(Ga)},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(ya){ya=
W.a.og(ya.data);V.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Ya.a.Uc(ya));Na.EwaSettings.la(258)&&m(a.urb,Sys.Serialization.JavaScriptSerializer.serialize(Ja));for(ya=0;ya<Ta.registrationInfos.length;ya++)delete pb.fF[Ta.registrationInfos[ya].addinId],delete pb.GV[Ja[ya]];Db.setResult(!1)},xa,Db,!0)};a.prototype.pXd=function(ma,Ja,Ta,pb){var Db=this;return B(this.qQj(ma,Ja,Ta,pb),function(){return Db.pFd(pb.solutionId,
!1)},"Failed to unregister functions for customfunction addin")};a.prototype.qQj=function(ma,Ja,Ta,pb){var Db=new Q.a;ma.KGb(Ja);(ma=Ha.a.Hc(this.GV,Ja))&&delete this.fF[ma.addinId];delete this.GV[Ja];pb=this.RYc(pb);return this.Oia(function(){Na.EwaSettings.la(258)&&m(a.h5c,Ja);Db.setResult(!0)},function(fb){fb=W.a.og(fb.data);V.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(Ta,
Ta,Ja),Ya.a.Uc(fb));Na.EwaSettings.la(258)&&m(a.g5c,Ja);Db.setResult(!1)},pb,Db,!1)};a.prototype.Oia=function(ma,Ja,Ta,pb,Db){function fb(){function Ec(vb,Gb,Za){Na.EwaSettings.la(258)&&m(Db?a.f5c:a.i5c,wb.RequestBody);return T.i(ya.ta,"ExecuteRichApiRequest",Ta,Ia.b(vb,ma),Ia.a(Gb,Ja),Za,null,0)}if(xa.kHa()||0<ya.ta.g4||0<ya.Ck.g4)return!1;Ga&&xa.jv(Ga);db&&ya.xr(db);Ob&&ya.Dz(Ob);var wb=Ta.request,kb=0;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?wb.RequestFlags&
1&&256!==(wb.RequestFlags&256)||(kb=16):kb=wb.RequestFlags&1?0:16;Na.EwaSettings.tc()?xa.Mt(new H.a(507,0,Ec,kb|64)):xa.Mt(new S.a(507,0,Ec,kb));return!0}var xa=this.$.userOperationManager,ya=this.$.na,Ga=null,db=null,Ob=null;fb()||(Ga=function(){fb()},db=function(){fb()},Ob=function(){fb()},xa.kx(Ga),ya.tq(db),ya.Jy(Ob));return pb.task};a.prototype.Zob=function(ma){var Ja={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ja.RequestBody=JSON.stringify(ma);Ja.RequestFlags=
1;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ja.RequestFlags|=256);ma=this.$.na.ta.Na(1);ma.request=Ja;return ma};a.prototype.GYc=function(ma){var Ja={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Ja.RequestBody=JSON.stringify(ma);Ja.RequestFlags=1;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ja.RequestFlags|=256);ma=this.$.na.ta.Na(1);ma.request=Ja;return ma};a.prototype.RYc=
function(ma){var Ja={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ja.RequestBody=JSON.stringify(ma);Ja.RequestFlags=1;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ja.RequestFlags|=256);ma=this.$.na.ta.Na(1);ma.request=Ja;return ma};a.prototype.pFd=function(ma,Ja){var Ta=this,pb=K.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);return u(pb,function(){pb.result.GKd();return ma&&Ja?Ta.Jij(ma):hc.Task.Ta(!0)},this.$.ma,
fa.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.P3f=function(){var ma=new Pa.a(1949669462,0,this.$.hd,0,null);return this.$.Ka.Yb(ma)};a.x0e=function(ma){try{return hc.Task.Ta(localStorage.getItem(ma))}catch(Ja){return V.ULS.sendTraceTag(537163537,0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",Ja.message||"Unknown"),hc.Task.Ta(null)}};a.JOd=function(ma,
Ja){try{return localStorage.setItem(ma,Ja),hc.Task.Ta(!0)}catch(Ta){return V.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",Ta.message||"Unknown"),hc.Task.Ta(!1)}};a.Taj=function(ma){try{return localStorage.removeItem(ma),hc.Task.Ta(!0)}catch(Ja){return V.ULS.sendTraceTag(537163535,0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",Ja.message||
"Unknown"),hc.Task.Ta(!1)}};a.uAh=function(ma){return eb.a.equals(ma,"registry",!0)||eb.a.equals(ma,"uploadfiledevcatalog",!0)||U.AFrameworkApplication.userNameUnknown||U.AFrameworkApplication.limitedEdit};a.nrd=function(ma){if(!ma)return!1;try{JSON.parse(ma)}catch(Ja){return!1}return!0};Qk.Object.defineProperties(a.prototype,{GV:{configurable:!0,enumerable:!0,get:function(){return this.xh.GV}}});a.mld="CustomFunctionCache";a.nld="CustomFunction";a.f5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");
a.vrb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.urb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.i5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.h5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.g5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,"CustomFunctionsInstaller",null,[720])},1234:function(y,F,b){function a(fa){this.fF={};this.$=fa;this.kmd().cna()}
function c(fa,W){this.wQc=fa;this._message=W}function d(){}function l(){}function n(fa){switch(fa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function m(fa,W){if(b(1234).CustomFunctionsLegacyInstaller.kvb("CustomFunctionsRuntimeLogging")&&window.console)switch(W=n(fa.severity)+" "+fa.message+W,fa.severity){case 2:window.console.log&&window.console.log(W);break;case 0:window.console.info&&window.console.info(W);break;case 1:window.console.error&&window.console.error(W)}}
function f(){}function v(fa){fa=fa.split("|");this.Hs=fa[1];this.bRc=fa[2];this.OTd=fa[3]}b.r(F);y=b(0);var w=b(13),t=b(1065),A=b(139),x=b(84),u=b(521),B=b(164),r=b(81),I=b(56),z=b(35),D=b(114),V=b(555),U=b(1115);Qk.Object.defineProperties(v.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Hs}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.bRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.OTd===OSF.StoreTypeEnum.Registry.toString()}}});
Object(y.a)(v,"AddinStoreInfo",null,[]);Object(y.a)(f,"CustomFunctionRegistrationInfos",null,[]);Object(y.a)(l,"InstallationInfo",null,[]);Object(y.a)(d,"UninstallationInfo",null,[]);var Q=b(147),la=b(32),ba=b(27),S=b(1),H=b(14),T=b(272),K=b(1011),da=b(52);Qk.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.wQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(y.a)(c,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsLegacyInstaller",
function(){return a});a.prototype.ubf=function(fa,W,ca,ia){var ea=this,qa=new A.a;if(ia.invariantNamespace)for(W=0;W<ia.invariantNamespace.length;++W){var pa=ia.invariantNamespace.charAt(W);if("."!==pa&&"_"!==pa&&"a">pa&&"z"<pa&&"A">pa&&"Z"<pa&&"0">pa&&"9"<pa)return w.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",pa,W),qa.setResult(!1),qa.task}a.cacheManifest(ca,ia.manifest);var Pa=a.FGd(fa);(null===
Pa||void 0===Pa?0:Pa.isDynamicMetadata)?this.HHd(fa,Pa,qa,!1,!1):OSF.OUtil.xhrGet(ia.metadataUrl,function(Ha){Pa=Object.assign(new l,{addinId:ca,locale:ia.locale,addinInvariantNamespace:ia.invariantNamespace,addinNamespace:ia.namespace,addinTitle:ia.title,isXllCompatible:ia.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Ha))});ea.HHd(fa,Pa,qa,!1,U.a(ea.$,ia))},function(Ha){w.ULS.sendTraceTag(537163528,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",
fa,Ha);qa.setResult(!1)});return qa.task};a.prototype.wbf=function(fa,W,ca,ia){W=new A.a;if(!a.nrd(ca))return w.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),W.setResult(!1),W.task;var ea=a.FGd(fa);if(!ea)return w.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),W.setResult(!1),W.task;ea.metadataContent=JSON.stringify(JSON.parse(ca));
ea.isDynamicMetadata=!0;this.HHd(fa,ea,W,!0,ia);return W.task};a.prototype.Sbg=function(fa){var W=this,ca=new A.a,ia=I.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);z.TaskExtensions.Ba(ia,function(){var ea=ia.result;ea.Gia();var qa=Object.assign(new d,{solutionId:fa});a.vId(fa);a.CId(fa);z.TaskExtensions.Ba(W.pXd(ea,fa,qa),function(pa){Q.b(pa)?ca.setResult(pa.result):(pa.kg?w.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
fa):pa.Hh&&w.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",fa),ca.setResult(!1))},W.$.ma,0)},this.$.ma,3);return ca.task};a.prototype.kmd=function(){var fa=this,W=new A.a,ca=a.JGd();0<ca.length&&w.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var ia=[];ca.forEach(function(qa){qa=Object(x.a)(String,qa);if(qa=a.FGd(qa)){var pa=
la.a.Hc(fa.fF,qa.addinId);pa&&pa===qa.metadataContent||(fa.fF[qa.addinId]=qa.metadataContent,Array.add(ia,qa))}});if(!ia.length)return W.setResult(!0),w.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),W.task;var ea=I.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);z.TaskExtensions.Ba(ea,function(){var qa=ea.result,pa=Object.assign(new f,{registrationInfos:ia});z.TaskExtensions.Ba(fa.V_b(qa,ca,pa),function(Pa){Q.b(Pa)?
W.setResult(Pa.result):(Pa.kg?w.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):Pa.Hh&&w.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),W.setResult(!1))},fa.$.ma,0)},this.$.ma,3);return W.task};a.prototype.Iij=function(fa){fa=new v(fa);if(fa.needToRestoreManifest){var W=a.Q6i(fa.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(fa.solutionId,
fa.solutionVersion,W,this.$.ya.UICultureTag)}};a.prototype.HHd=function(fa,W,ca,ia,ea){var qa=this,pa=I.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);z.TaskExtensions.Ba(pa,function(){z.TaskExtensions.Ba(qa.JHd(pa.result,fa,W,!1,ia,ea),function(Pa){Q.b(Pa)?((Pa=Pa.result)&&a.fZj(fa,W),ca.setResult(Pa)):(Pa.kg?w.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",fa):Pa.Hh&&w.ULS.sendTraceTag(537163487,0,10,
"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",fa),ca.setResult(!1))},qa.$.ma,0)},this.$.ma,3)};a.prototype.JHd=function(fa,W,ca,ia,ea,qa){var pa=this;if(!ea&&(ea=la.a.Hc(this.fF,ca.addinId))&&ea===ca.metadataContent)return da.Task.Ta(!0);this.fF[ca.addinId]=ca.metadataContent;var Pa=new A.a;qa||fa.KGb(W);fa.Gia();fa=this.Zob(ca);return this.Oia(function(Ha){S.EwaSettings.la(258)&&m(a.vrb,W);var Ya=Ha.Result;204===Ya.ResponseStatusCode?z.TaskExtensions.Ba(pa.oFd(Pa,
ca.addinId,ia),function(Na){Na.kg?W?w.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",W):w.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",ca.addinId):Na.Hh&&(W?w.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
W):w.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ca.addinId));Pa.setResult(!1)},pa.$.ma,4):(Ha=function(){delete pa.fF[ca.addinId];a.vId(W);a.CId(W);w.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",W,Ya.ResponseStatusCode);Pa.setResult(!1)},Ha=Object.assign(new K.a,{tLa:OSF.InfoType.Error,
title:ca.addinTitle,description:String.format(H.a.instance.Cb(152),H.a.instance.fa(1840)),buttonText:H.a.instance.fa(4),Aha:Ha,Ddc:!1,via:Ha,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),t.a.lRd(Ha))},function(Ha){Ha=D.a.og(Ha.data);w.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",W,ba.a.Uc(Ha));S.EwaSettings.la(258)&&m(a.urb,W);delete pa.fF[ca.addinId];Pa.setResult(!1)},
fa,Pa,!0)};a.prototype.V_b=function(fa,W,ca){var ia=this,ea=new A.a;W.forEach(function(pa){pa=Object(x.a)(String,pa);fa.dye(pa)});fa.Gia();var qa=this.GYc(ca);return this.Oia(function(pa){S.EwaSettings.la(258)&&m(a.vrb,Sys.Serialization.JavaScriptSerializer.serialize(W));pa=pa.Result;var Pa=!0,Ha=Sys.Serialization.JavaScriptSerializer.deserialize(pa.ResponseBody.toString());Ha=Array.isArray(Ha.value)?Ha.value:null;for(var Ya=0;Ya<Ha.length;Ya++)Ha[Ya]||(Pa=!1,delete ia.fF[ca.registrationInfos[Ya].addinId],
a.vId(W[Ya]),a.CId(W[Ya]),w.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",W[Ya],pa.ResponseStatusCode));z.TaskExtensions.Ba(ia.oFd(ea,"",!1),function(Na){Na.kg?w.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):Na.Hh&&w.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
ea.setResult(!1)},ia.$.ma,4);ea.setResult(Pa)},function(pa){pa=D.a.og(pa.data);w.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(W),ba.a.Uc(pa));S.EwaSettings.la(258)&&m(a.urb,Sys.Serialization.JavaScriptSerializer.serialize(W));pa=yl(ca.registrationInfos);for(var Pa=pa.next();!Pa.done;Pa=pa.next())delete ia.fF[Pa.value.addinId];
ea.setResult(!1)},qa,ea,!0)};a.prototype.pXd=function(fa,W,ca){var ia=this,ea=new A.a;fa.KGb(W);fa=this.RYc(ca);return this.Oia(function(){S.EwaSettings.la(258)&&m(a.h5c,W);z.TaskExtensions.Ba(ia.oFd(ea,ca.solutionId,!1),function(qa){qa.kg?W&&w.ULS.sendTraceTag(537163473,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",W):qa.Hh&&W&&w.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",
W);ea.setResult(!1)},ia.$.ma,4)},function(qa){qa=D.a.og(qa.data);w.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",W,ba.a.Uc(qa));S.EwaSettings.la(258)&&m(a.g5c,W);ea.setResult(!1)},fa,ea,!1)};a.prototype.Oia=function(fa,W,ca,ia,ea){function qa(){function eb(hc,ma,Ja){S.EwaSettings.la(258)&&m(ea?a.f5c:a.i5c,Ia.RequestBody);return r.i(Pa.ta,"ExecuteRichApiRequest",ca,T.b(hc,fa),T.a(ma,
W),Ja,null,0)}if(pa.kHa()||0<Pa.ta.g4||0<Pa.Ck.g4)return!1;Ha&&pa.jv(Ha);Ya&&Pa.xr(Ya);Na&&Pa.Dz(Na);var Ia=ca.request,lb=Ia.RequestFlags&1?0:16;S.EwaSettings.tc()?pa.Mt(new B.a(507,0,eb,lb|64)):pa.Mt(new u.a(507,0,eb,lb));return!0}var pa=this.$.userOperationManager,Pa=this.$.na,Ha=null,Ya=null,Na=null;qa()||(Ha=function(){qa()},Ya=function(){qa()},Na=function(){qa()},pa.kx(Ha),Pa.tq(Ya),Pa.Jy(Na));return ia.task};a.prototype.Zob=function(fa){var W={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};W.RequestBody=JSON.stringify(fa);W.RequestFlags=1;fa=this.$.na.ta.Na(1);fa.request=W;return fa};a.prototype.GYc=function(fa){var W={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};W.RequestBody=JSON.stringify(fa);W.RequestFlags=1;fa=this.$.na.ta.Na(1);fa.request=W;return fa};a.prototype.RYc=function(fa){var W={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};W.RequestBody=JSON.stringify(fa);W.RequestFlags=1;fa=
this.$.na.ta.Na(1);fa.request=W;return fa};a.prototype.oFd=function(fa,W,ca){var ia=this,ea=I.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);z.TaskExtensions.Ba(ea,function(){ea.result.GKd();W&&ca&&ia.Iij(W);fa.setResult(!0)},this.$.ma,3);return ea};a.prototype.xbf=function(){return da.Task.Ta(!0)};a.JGd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.kvb(V.a.MYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.kvb(V.a.MYa)||"[]"):null)||
[]};a.xhg=function(fa){a.KOd(V.a.MYa,Sys.Serialization.JavaScriptSerializer.serialize(fa))};a.FGd=function(fa){fa=a.kvb(V.a.Q3a(fa))||"";return 0<fa.length?Sys.Serialization.JavaScriptSerializer.deserialize(fa,!0):null};a.fZj=function(fa,W){a.VLe(fa);a.KOd(V.a.Q3a(fa),Sys.Serialization.JavaScriptSerializer.serialize(W))};a.vId=function(fa){a.uPf(fa);a.PPf(V.a.Q3a(fa))};a.Q6i=function(fa){return a.kvb(V.a.P3a(fa))};a.gZj=function(fa,W){a.VLe(fa);a.KOd(V.a.P3a(fa),W)};a.CId=function(fa){a.uPf(fa);a.PPf(V.a.P3a(fa))};
a.VLe=function(fa){var W=a.JGd();fa=fa.toLowerCase();Array.contains(W,fa)||(W.push(fa),a.xhg(W))};a.uPf=function(fa){var W=a.JGd();fa=fa.toLowerCase();Array.contains(W,fa)&&(W.splice(Array.indexOf(W,fa),1),a.xhg(W))};a.cacheManifest=function(fa,W){fa=new v(fa);fa.needToRestoreManifest&&a.gZj(fa.solutionId,W)};a.kvb=function(fa){try{return localStorage.getItem(fa)}catch(W){return w.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",
W.message||"Unknown"),null}};a.KOd=function(fa,W){try{localStorage.setItem(fa,W)}catch(ca){w.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ca.message||"Unknown")}};a.PPf=function(fa){try{localStorage.removeItem(fa)}catch(W){w.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",W.message||"Unknown")}};a.nrd=function(fa){if(!fa)return!1;
try{JSON.parse(fa)}catch(W){return!1}return!0};a.f5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.vrb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.urb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.i5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.h5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.g5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,
"CustomFunctionsLegacyInstaller",null,[720])},1243:function(y,F,b){function a(ba,S,H,T,K){this.Ma=null;this.BVc="AddinActivated";this.$=ba;this.Xe=S;this.ownerAddinInfo=H;this.de=void 0===K?null:K;this.HQa=(void 0===T?null:T)||Q.Task.Ta(!0);this.Ma=new t.a;return this}function c(ba){var S=U.call(this)||this;S.PCa="AddInCommandsDialog";S.Ve=S.PCa;S.kc=5;S.dialogWidth=695;S.dialogHeight=438;S.d2g="100%";S.a2g="408px";S.b2g="15px";S.c2g="0";S.ntg=ba;return S}function d(ba,S,H,T,K,da){var fa=ba.Na(9);
fa.sharedInfo=S;return x.i(ba,"InsertAgaveTaskpane",fa,H,T,K,da,0)}function l(){}y=b(0);var n=b(199),m=b(13),f=b(5);Object(y.a)(l,"AddinCommandsHost",null,[]);var v=b(1294),w=b(1365),t=b(36),A=b(949),x=b(81),u=b(521),B=b(369),r=b(164),I=b(35),z=b(1),D=b(272),V=b(140),U=V.a;vm(c,U);c.prototype.eD=function(){U.prototype.eD.call(this);this.xp.style.width=this.d2g;this.xp.style.height=this.a2g;this.xp.style.marginTop=this.b2g;this.xp.style.padding=this.c2g};c.prototype.DO=function(){U.prototype.DO.call(this);
this.Mb.style.width=String.format("{0}px",this.dialogWidth);this.Mb.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){U.prototype.dispose.call(this);this.ntg()};Qk.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.xp}}});Object(y.a)(c,"AddInCommandsDialog",V.a,[]);var Q=b(52),la=b(59);V=b(100);b.d(F,"a",function(){return a});vm(a,l);a.prototype.MDg=function(ba){this.Ma.addHandler(this.BVc,ba)};a.prototype.KPa=
function(){f.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1)&&(m.ULS.sendTraceTag(526235527,220,50,"survey addin {0} is used.",Telemetry.PrivacyRules.GetAssetId(this.ownerAddinInfo.storeType,this.ownerAddinInfo.storeId,this.ownerAddinInfo.solutionId)),this.Ma.raiseEvent(this.BVc,this.ownerAddinInfo.solutionId))};a.prototype.W1g=function(){var ba=this.HQa;this.HQa=Q.Task.Ta(!0);return ba};a.prototype.disposeHost=function(ba){this.Xe.jQa(ba)};
a.prototype.setOwnerAddinEToken=function(ba){this.ownerAddinInfo.eToken=ba};a.prototype.showTaskpane=function(ba,S,H){var T=this;m.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var K=null,da=!1,fa=(new v.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new A.a,!0)).dGe(ba.solutionId.substr(this.ownerAddinInfo.solutionId.length));K=S.getSharedRuntimeForTaskpane("Workbook",fa);da=!!K&&1===K.LifeTime;this.Xe.gye(da?this.ownerAddinInfo.solutionId:ba.solutionId,da?K:null,
null)?this.KPa():(this.pnf(da,!0),this.HQa=this.imd(ba,K,function(W,ca){W?(da&&(W.PrimaryMarketplace.SolutionId=T.ownerAddinInfo.solutionId,W.SharedRuntime=K),W.WebExtensionOsfControlType=3,T.Xe.y0a(W),H(W.InstanceId,ca),T.KPa(),T.pnf(da,!1),z.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&m.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(m.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),H(null,ca),
T.KPa())}))};a.prototype.getSettings=function(ba,S){var H=this.Xe.uaa(ba.solutionId);H?S(this.Xe.pZ(H).OsfPropertyBag):this.HQa=this.imd(ba,null,function(T){T?S(T.OsfPropertyBag):m.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(ba,S,H){function T(ca,ia,ea){return d(fa,W,D.b(ca,K),ia,ea,null)}function K(ca){var ia=ca.Result,ea=ia?ia.AgaveData:null;ea?(da.Xe.ZEe(ea,function(){var qa=new c(function(){da.disposeHost(ea.InstanceId)});qa.initializeAndShow("",
null,null);da.KPa();return qa.containerDiv}),H(ea.InstanceId,0),da.KPa()):(m.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),H(null,ca.Errors?ca.Errors[0].ErrorCause:5001))}var da=this;m.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var fa=this.$.na.ta,W=a.grb(ba,this.ownerAddinInfo);z.EwaSettings.tc()?this.HQa=B.a(this.$.userOperationManager,T,function(ca){return new r.a(500,0,ca,64)},this.de):this.HQa=B.a(this.$.userOperationManager,T,function(ca){return new u.a(500,
0,ca)},this.de)};a.prototype.createUILessSandbox=function(ba,S,H){var T=this;m.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var K=S.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),da=!!K&&1===K.LifeTime;(S=this.Xe.hDh(da?this.ownerAddinInfo.solutionId:ba.solutionId,da?K:null))?(H(S,0),this.KPa()):this.HQa=this.imd(ba,K,function(fa,W){fa?(da?(fa.PrimaryMarketplace.SolutionId=T.ownerAddinInfo.solutionId,fa.SharedRuntime=K,fa.TaskpaneVisible=!1,fa.WebExtensionOsfControlType=3,T.Xe.y0a(fa)):
(fa.WebExtensionOsfControlType=4,T.Xe.ZEe(fa,function(){a.Feb.ia(fa.InstanceId,new w.a);return a.Feb.oa(fa.InstanceId).j1a})),H(fa.InstanceId,W),T.KPa()):(m.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),H(null,W))})};a.prototype.imd=function(ba,S,H){function T(pa,Pa,Ha){return d(W,ca,D.b(pa,K),Pa,Ha,null)}function K(pa){var Pa=pa.Result;(fa=Pa?Pa.AgaveData:null)||H(null,pa.Errors?pa.Errors[0].ErrorCause:5001)}var da=this,fa=null,W=this.$.na.ta,ca=a.grb(ba,this.ownerAddinInfo);
S&&(m.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),ca.SharedRuntimeId=S.Resid);var ia=500,ea=0;void 0===ca.IsToBePersisted||null===ca.IsToBePersisted||ca.IsToBePersisted||(ia=538,T=function(pa,Pa,Ha){m.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",ca.CurrentStoreType,ca.StoreId,Telemetry.PrivacyRules.GetAssetId(ca.CurrentStoreType,ca.StoreId,ca.AssetId));pa=D.b(pa,K);var Ya=W.Na(9,null);Ya.sharedInfo=
ca;return x.i(W,"ShowAgaveTaskpane",Ya,pa,Pa,Ha,null,0)},ea=16);if(z.EwaSettings.tc()){ea|=64;var qa=B.a(this.$.userOperationManager,T,function(pa){return new r.a(ia,0,pa,ea)},this.de)}else qa=B.a(this.$.userOperationManager,T,function(pa){return new u.a(ia,0,pa,ea)},this.de);return I.TaskExtensions.ts(qa,function(){return fa?da.Dtd(W,fa.InstanceId,function(pa,Pa){if(pa){S||(fa.PrimaryMarketplace.MarketplaceType=ba.storeType);fa.OwnerAddinSolutionId=da.ownerAddinInfo.solutionId;fa.OwnerAddinAssetId=
da.ownerAddinInfo.assetId;fa.OwnerAddinStoreType=da.ownerAddinInfo.storeType;fa.OsfPropertyBag=[];for(Pa=0;Pa<pa.Settings.length;Pa++){var Ha=[];Ha[0]=pa.Settings[Pa].Name;Ha[1]=pa.Settings[Pa].Value;fa.OsfPropertyBag[Pa]=Ha}H(fa,0)}else H(null,Pa.Errors?Pa.Errors[0].ErrorCause:5001)}):Q.Task.Ta(!1)},n.a.none,3,la.a.current)};a.prototype.Dtd=function(ba,S,H){function T(da,fa,W){da=D.b(da,K);var ca=ba.Na(1);ca.controlId=S;return x.i(ba,"DdaLoadSettings",ca,da,fa,W,null,0)}function K(da){H(da.Result,
da)}return z.EwaSettings.tc()?B.a(this.$.userOperationManager,T,function(da){return new r.a(501,0,da,80)},this.de):B.a(this.$.userOperationManager,T,function(da){return new u.a(501,0,da,16)},this.de)};a.prototype.pnf=function(ba,S){var H;ba&&(null===(H=window.performance)||void 0===H?0:H.memory)&&m.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",S,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,
window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(ba){a.Feb.xb(ba)&&a.Feb.oa(ba).initializeAndShowWithTitle()};a.hideUILessDialog=function(ba){a.Feb.xb(ba)&&a.Feb.oa(ba).hide()};a.grb=function(ba,S){var H={};H.SolutionId=ba.solutionId;H.Version=ba.version;H.StoreType=S.storeType;H.StoreId=ba.storeId;H.AssetId=ba.solutionId;H.AssetStoreId="omex";H.TargetType=1;H.Width=350;H.OwnerAddinSolutionId=S.solutionId;H.OwnerAddinStoreType=S.storeType;H.SharedRuntimeId=null;H.Preload=!1;
H.Id=ba.solutionId;H.AppVersion=ba.version;H.CurrentStoreType=S.storeType;H.OwnerAddinAssetId=S.assetId;return H};a.Feb=new V.a;Object(y.a)(a,"WACExcelAddinCommandsHost",l,[])},1280:function(y,F,b){function a(c,d,l,n){this._id=c;this.Xwg=d;this.Ohe=l;this.FUa=n}b.d(F,"a",function(){return a});y=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.Xwg};a.prototype.getStoreType=function(){return this.Ohe};Object(y.a)(a,"ExtensionIdentity",null,[46])},1281:function(y,
F,b){function a(c,d,l){this.xae=l}b.d(F,"a",function(){return a});y=b(0);Object(y.a)(a,"HostProperties",null,[])},1282:function(y,F,b){function a(){this.ri={};this.hr={}}b.d(F,"a",function(){return a});y=b(0);Object(y.a)(a,"ExtensionLaunchProperties",null,[])},1283:function(y,F,b){function a(){this.La=f.AFrameworkApplication.Hb}b.d(F,"a",function(){return a});y=b(0);var c=b(1280),d=b(1282),l=b(1095),n=b(1285),m=b(1281),f=b(5),v=b(592),w=b(30);a.prototype.iNa=function(t,A,x,u,B){this.Rri(t,A,x,u,B)};
a.prototype.Rri=function(t,A,x,u,B){var r=b(1284).ExtensionComponentInstance,I={};I[l.a.I8b]=t;I[l.a.uBe]=A;I[l.a.eHa]=x;I[l.a.rkd]=u;I[l.a.Oya]=B;u=8;f.AFrameworkApplication.hni(t.getId())&&(u=A===n.a.action?this.La.De(w.a.ORe,2,I):this.La.De(w.a.X3f,2,I));32===u?(u=v.a.create().toString(),B.ri.InstanceToken&&(u=B.ri.InstanceToken),t=new r(t,A,x,u),a.Fv[u]=t):t=new r(t,A,x,null);t.Mpj(I)};a.prototype.Qri=function(t){var A=t.ExtId,x=t.ComponentType,u=t.ComponentId,B=t.HostProps;t=t.OptionalProps;
A=new c.a(A.Id,A.StoreId,A.StoreType,A.AppVersion);B=new m.a(B.HostType,B.FormFactor,B.Locale);var r=new d.a;r.ri=t.OptionalProperties;r.hr=t.DevProperties;a.instance.iNa(A,x,u,B,r)};a.prototype.getInstance=function(t){return a.Fv[t]};a.prototype.Paj=function(t){delete a.Fv[t]};Qk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.PHc||(a.PHc=new a);return a.PHc}}});a.PHc=null;a.Fv={};Object(y.a)(a,"ExtensionLifeCycleManager",null,[40])},1284:function(y,F,b){function a(n,
m,f,v){this.FUa=this.pG=null;this._id=n;this.Vmg=f;this.Kqg=v;this.La=d.AFrameworkApplication.Hb?d.AFrameworkApplication.Hb:null}b.r(F);b.d(F,"ExtensionComponentInstance",function(){return a});y=b(0);var c=b(1283),d=b(5),l=b(30);a.prototype.Qdd=function(){return this.Vmg};a.prototype.Mpj=function(n){this.pG=n};a.prototype.stop=function(){var n=this.La.De(l.a.DZg,2,this.pG);c.a.instance.Paj(this.Kqg);return 32===n};a.prototype.Atc=function(){this.La.De(l.a.jUf,2,this.pG)};Qk.Object.defineProperties(a.prototype,
{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.FUa}}});Object(y.a)(a,"ExtensionComponentInstance",null,[62])},1285:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.taskpane="Taskpane";a.action="Action";Object(y.a)(a,"ComponentTypeNames",null,[])},1286:function(y,F,b){(function(a){function c(U,Q,la){var ba=V.call(this)||this;ba.L$e=f.a.getTypeName();ba.de=null;ba.rU=null;ba.mxb=null;ba.imageWidth=0;ba.imageHeight=0;ba.tableData=null;ba.errorMessage=null;
ba.pLa=null;ba.fTc=!1;ba.lGe=function(S){if(S){var H={};if(function(){var ca=z.d(ba.jch(S.data));H=ca.Iu;return ca}().returnValue){var T=Object(m.a)(Object,H);if("."===T.DataFromPictureWildcard)if(T.SessionId!==ba.pLa)l.ULS.sendTraceTag(537163345,0,10,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(l.ULS.sendTraceTag(537163344,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
T.CmdType){case "ACK":ba.fTc=!0;ba.toj();0<ba.errorMessage.length?ba.VXf():0<ba.tableData.length&&ba.lYf();break;case "insert_html":var K=ba.$.na.ta,da={},fa=I.g(ba.$).ha.va.Td.clone();da.PasteId=n.a.create().toString();da.DestinationRanges=t.s(t.v(fa,ba.$));da.SourceHtml=T.Parameters;da.CopyOperationId=null;var W=K.Na(1,K.$b());W.pasteHtmlParameters=da;A.a(ba.$.userOperationManager,function(ca,ia,ea){return u.i(K,"pasteHtmlContent",W,ca,ia,ea,null,64)},function(ca){return new x.a(204,0,ca,1)},null)}}}};
ba.E9h=function(S,H){if(S=H.NP)if(!H.parentPath||1>=H.parentPath.length||H.parentPath[1]!==ba.pLa)l.ULS.sendTraceTag(537163335,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{H=S.errorCode;switch(H){case null:case -1:ba.errorMessage=r.a.instance.fa(2203);break;case 1:ba.errorMessage=r.a.instance.fa(2204);break;case 2:ba.errorMessage=r.a.instance.fa(2205)}0<ba.errorMessage.length&&l.ULS.sendTraceTag(537163334,
0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - ErrorCode:{0}.",H?H.toString():"null");ba.tableData=S.html;ba.fTc&&(0<ba.errorMessage.length?ba.VXf():0<ba.tableData.length&&ba.lYf())}else l.ULS.sendTraceTag(537163336,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - Received annotation is null.")};ba.$=U;ba.augmentationLoopManager=Q;ba.uploaderCreator=la;ba.initialize();return ba}b.d(F,"a",function(){return c});var d=b(0),l=b(13),n=b(177),m=b(84),
f=b(1291),v=b(36),w=b(232),t=b(43),A=b(369),x=b(164),u=b(81),B=b(92),r=b(14),I=b(19),z=b(40),D=b(1292),V=v.a;vm(c,V);c.prototype.dispose=function(){window.removeEventListener("message",this.lGe,!1);V.prototype.dispose.call(this)};c.prototype.STi=function(U,Q){var la=this;l.ULS.sendTraceTag(526399129,0,50,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Start function.");var ba=new Image;ba.onload=function(){var S=document.createElement("canvas");S.width=ba.width;S.height=ba.height;var H=
S.getContext("2d");try{H.drawImage(ba,0,0,ba.width,ba.height)}catch(da){l.ULS.sendTraceTag(526399128,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",da.message);return}try{var T=S.toDataURL("image/jpeg")}catch(da){l.ULS.sendTraceTag(526399127,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",da.message);return}S=T.split(",");if(2>S.length)l.ULS.sendTraceTag(526399126,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{S=S[1];try{var K=window.self.atob(S)}catch(da){l.ULS.sendTraceTag(526399125,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",da.message);return}28E5<K.length?(l.ULS.sendTraceTag(526399124,0,15,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Image exceeds max size limit."),Q.hBj()):(la.vkj(la.de,la.rU,S,ba.width,ba.height),URL.revokeObjectURL(ba.src),ba=null,l.ULS.sendTraceTag(526399123,0,50,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - End function."))}};
ba.src=U};c.prototype.b1i=function(U,Q,la,ba){this.de=U;this.rU=ba;this.uploaderCreator.fbi(this.$,Q,la,ba,this)};c.prototype.vkj=function(U,Q,la,ba,S){this.pLa=n.a.create().toString();this.mxb=la;this.imageWidth=ba;this.imageHeight=S;this.errorMessage=this.tableData="";this.fTc=!1;this.AWi(U,Q);this.mVj()};c.prototype.mVj=function(){if(this.mxb.length){var U=window.self.atob(this.mxb);for(var Q=new Uint8Array(U.length),la=0;la<U.length;la++)Q[la]=U.charCodeAt(la);this.augmentationLoopManager.lVj(Q,
this.pLa,this.imageWidth,this.imageHeight)}else l.ULS.sendTraceTag(537163343,0,10,"DataFromPicturePaneCommandManager:UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.AWi=function(U,Q){Q.SessionID=this.pLa;Q.DataFromPictureAssetId="FA000000050";Q.LoadDataFromPictureTaskpane=!0;U=new B.a(-859308420,U.method,U.mode,U.df,U.tabName);this.$.Ka.Yb(U,Q)};c.prototype.e8c=function(U){try{var Q=a.from(U,"utf16le").toString("base64");return D.a.qHa(this.pLa,Q)}catch(la){return l.ULS.sendTraceTag(524888215,
0,10,"DataFromPicturePaneCommandManager.encodeAndEncrypt - Buffer can't encode message.",la.message),""}};c.prototype.jch=function(U){try{var Q=D.a.qHa(this.pLa,U);return a.from(Q,"base64").toString("utf16le")}catch(la){return l.ULS.sendTraceTag(524888214,0,50,"DataFromPicturePaneCommandManager.decryptAndDecode - Buffer can't decode message.",la.message),""}};c.prototype.toj=function(){if(this.mxb.length){var U=w.a(this.$).uaa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=".",Q);Q.imageData=this.e8c(this.mxb);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(U,"onCustomMessage",Q,function(la){la&&l.ULS.sendTraceTag(537163341,0,10,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else l.ULS.sendTraceTag(537163342,0,10,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.lYf=function(){if(this.tableData.length){var U=w.a(this.$).uaa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=
".",Q);Q.tableHtml=this.e8c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(U,"onCustomMessage",Q,function(la){la&&l.ULS.sendTraceTag(537163339,0,10,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else l.ULS.sendTraceTag(537163340,0,10,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.VXf=function(){if(this.errorMessage.length){var U=
w.a(this.$).uaa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=".",Q);Q.errorMessage=this.e8c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(U,"onCustomMessage",Q,function(la){la&&l.ULS.sendTraceTag(537163337,0,10,"DataFromPicturePaneCommandManager:sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else l.ULS.sendTraceTag(537163338,0,10,"DataFromPicturePaneCommandManager:sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
c.prototype.initialize=function(){window.addEventListener("message",this.lGe,!1);this.augmentationLoopManager.activateAnnotation(this.L$e);this.augmentationLoopManager.HT(this.L$e,this.E9h)};Object(d.a)(c,"DataFromPicturePaneCommandManager",v.a,[754])}).call(this,b(1287).iig)},1287:function(y,F,b){(function(a){function c(){try{var S=new Uint8Array(1);S.__proto__={__proto__:Uint8Array.prototype,Nbd:function(){return 42}};return 42===S.Nbd()&&"function"===typeof S.subarray&&0===S.subarray(1,1).byteLength}catch(H){return!1}}
function d(S,H){if((l.gP?2147483647:1073741823)<H)throw new RangeError("Invalid typed array length");l.gP?(S=new Uint8Array(H),S.__proto__=l.prototype):(null===S&&(S=new l(H)),S.length=H);return S}function l(S,H,T){if(!(l.gP||this instanceof l))return new l(S,H,T);if("number"===typeof S){if("string"===typeof H)throw Error("If encoding is specified then the first argument must be a string");return f(this,S)}return n(this,S,H,T)}function n(S,H,T,K){if("number"===typeof H)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&H instanceof ArrayBuffer){H.byteLength;if(0>T||H.byteLength<T)throw new RangeError("'offset' is out of bounds");if(H.byteLength<T+(K||0))throw new RangeError("'length' is out of bounds");H=void 0===T&&void 0===K?new Uint8Array(H):void 0===K?new Uint8Array(H,T):new Uint8Array(H,T,K);l.gP?(S=H,S.__proto__=l.prototype):S=v(S,H);H=S}else if("string"===typeof H){K=S;S=T;if("string"!==typeof S||""===S)S="utf8";if(!l.Rdf(S))throw new TypeError('"encoding" must be a valid string encoding');
T=A(H,S)|0;K=d(K,T);H=K.write(H,S);H!==T&&(K=K.slice(0,H));H=K}else H=w(S,H);return H}function m(S){if("number"!==typeof S)throw new TypeError('"size" argument must be a number');if(0>S)throw new RangeError('"size" argument must not be negative');}function f(S,H){m(H);S=d(S,0>H?0:t(H)|0);if(!l.gP)for(var T=0;T<H;++T)S[T]=0;return S}function v(S,H){var T=0>H.length?0:t(H.length)|0;S=d(S,T);for(var K=0;K<T;K+=1)S[K]=H[K]&255;return S}function w(S,H){if(l.isBuffer(H)){var T=t(H.length)|0;S=d(S,T);if(0===
S.length)return S;H.copy(S,0,0,T);return S}if(H){if("undefined"!==typeof ArrayBuffer&&H.buffer instanceof ArrayBuffer||"length"in H)return(T="number"!==typeof H.length)||(T=H.length,T=T!==T),T?d(S,0):v(S,H);if("Buffer"===H.type&&Q(H.data))return v(S,H.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function t(S){if(S>=(l.gP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(l.gP?2147483647:
1073741823).toString(16)+" bytes");return S|0}function A(S,H){if(l.isBuffer(S))return S.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(S)||S instanceof ArrayBuffer))return S.byteLength;"string"!==typeof S&&(S=""+S);var T=S.length;if(0===T)return 0;for(var K=!1;;)switch(H){case "ascii":case "latin1":case "binary":return T;case "utf8":case "utf-8":case void 0:return I(S).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
T;case "hex":return T>>>1;case "base64":return D(S).length;default:if(K)return I(S).length;H=(""+H).toLowerCase();K=!0}}function x(S,H,T){var K=!1;if(void 0===H||0>H)H=0;if(H>this.length)return"";if(void 0===T||T>this.length)T=this.length;if(0>=T)return"";T>>>=0;H>>>=0;if(T<=H)return"";for(S||(S="utf8");;)switch(S){case "hex":S=H;H=T;T=this.length;if(!S||0>S)S=0;if(!H||0>H||H>T)H=T;K="";for(T=S;T<H;++T)S=K,K=this[T],K=16>K?"0"+K.toString(16):K.toString(16),K=S+K;return K;case "utf8":case "utf-8":return r(this,
H,T);case "ascii":S="";for(T=Math.min(this.length,T);H<T;++H)S+=String.fromCharCode(this[H]&127);return S;case "latin1":case "binary":S="";for(T=Math.min(this.length,T);H<T;++H)S+=String.fromCharCode(this[H]);return S;case "base64":return 0===H&&T===this.length?U.YVe(this):U.YVe(this.slice(H,T));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":H=this.slice(H,T);T="";for(S=0;S<H.length;S+=2)T+=String.fromCharCode(H[S]+256*H[S+1]);return T;default:if(K)throw new TypeError("Unknown encoding: "+
S);S=(S+"").toLowerCase();K=!0}}function u(S,H,T,K,da){if(0===S.length)return-1;"string"===typeof T?(K=T,T=0):2147483647<T?T=2147483647:-2147483648>T&&(T=-2147483648);T=+T;isNaN(T)&&(T=da?0:S.length-1);0>T&&(T=S.length+T);if(T>=S.length){if(da)return-1;T=S.length-1}else if(0>T)if(da)T=0;else return-1;"string"===typeof H&&(H=l.from(H,K));if(l.isBuffer(H))return 0===H.length?-1:B(S,H,T,K,da);if("number"===typeof H)return H&=255,l.gP&&"function"===typeof Uint8Array.prototype.indexOf?da?Uint8Array.prototype.indexOf.call(S,
H,T):Uint8Array.prototype.lastIndexOf.call(S,H,T):B(S,[H],T,K,da);throw new TypeError("val must be string, number or Buffer");}function B(S,H,T,K,da){function fa(ea,qa){return 1===W?ea[qa]:ea.b7i(qa*W)}var W=1,ca=S.length,ia=H.length;if(void 0!==K&&(K=String(K).toLowerCase(),"ucs2"===K||"ucs-2"===K||"utf16le"===K||"utf-16le"===K)){if(2>S.length||2>H.length)return-1;W=2;ca/=2;ia/=2;T/=2}if(da)for(K=-1;T<ca;T++)if(fa(S,T)===fa(H,-1===K?0:T-K)){if(-1===K&&(K=T),T-K+1===ia)return K*W}else-1!==K&&(T-=
T-K),K=-1;else for(T+ia>ca&&(T=ca-ia);0<=T;T--){ca=!0;for(K=0;K<ia;K++)if(fa(S,T+K)!==fa(H,K)){ca=!1;break}if(ca)return T}return-1}function r(S,H,T){T=Math.min(S.length,T);for(var K=[];H<T;){var da=S[H],fa=null,W=239<da?4:223<da?3:191<da?2:1;if(H+W<=T)switch(W){case 1:128>da&&(fa=da);break;case 2:var ca=S[H+1];128===(ca&192)&&(da=(da&31)<<6|ca&63,127<da&&(fa=da));break;case 3:ca=S[H+1];var ia=S[H+2];128===(ca&192)&&128===(ia&192)&&(da=(da&15)<<12|(ca&63)<<6|ia&63,2047<da&&(55296>da||57343<da)&&(fa=
da));break;case 4:ca=S[H+1];ia=S[H+2];var ea=S[H+3];128===(ca&192)&&128===(ia&192)&&128===(ea&192)&&(da=(da&15)<<18|(ca&63)<<12|(ia&63)<<6|ea&63,65535<da&&1114112>da&&(fa=da))}null===fa?(fa=65533,W=1):65535<fa&&(fa-=65536,K.push(fa>>>10&1023|55296),fa=56320|fa&1023);K.push(fa);H+=W}S=K.length;if(S<=la)K=String.fromCharCode.apply(String,K);else{T="";for(H=0;H<S;)T+=String.fromCharCode.apply(String,K.slice(H,H+=la));K=T}return K}function I(S,H){H=H||Infinity;for(var T,K=S.length,da=null,fa=[],W=0;W<
K;++W){T=S.charCodeAt(W);if(55295<T&&57344>T){if(!da){if(56319<T){-1<(H-=3)&&fa.push(239,191,189);continue}else if(W+1===K){-1<(H-=3)&&fa.push(239,191,189);continue}da=T;continue}if(56320>T){-1<(H-=3)&&fa.push(239,191,189);da=T;continue}T=(da-55296<<10|T-56320)+65536}else da&&-1<(H-=3)&&fa.push(239,191,189);da=null;if(128>T){if(0>--H)break;fa.push(T)}else if(2048>T){if(0>(H-=2))break;fa.push(T>>6|192,T&63|128)}else if(65536>T){if(0>(H-=3))break;fa.push(T>>12|224,T>>6&63|128,T&63|128)}else if(1114112>
T){if(0>(H-=4))break;fa.push(T>>18|240,T>>12&63|128,T>>6&63|128,T&63|128)}else throw Error("Invalid code point");}return fa}function z(S){for(var H=[],T=0;T<S.length;++T)H.push(S.charCodeAt(T)&255);return H}function D(S){var H=U,T=H.ELj;S=(S.trim?S.trim():S.replace(/^\s+|\s+$/g,"")).replace(ba,"");if(2>S.length)S="";else for(;0!==S.length%4;)S+="=";return T.call(H,S)}function V(S,H,T,K){for(var da=0;da<K&&!(da+T>=H.length||da>=S.length);++da)H[da+T]=S[da];return da}var U=b(1288);b(1289);var Q=b(1290);
F.iig=l;F.$Zj=function(S){+S!=S&&(S=0);return l.Gpe(+S)};F.PZj=50;l.gP=void 0!==a.gP?a.gP:c();F.n0j=l.gP?2147483647:1073741823;l.from=function(S,H,T){return n(null,S,H,T)};l.gP&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0}));l.Gpe=function(S){m(S);return d(null,S)};l.dJg=function(S){return f(null,S)};l.isBuffer=function(S){return!(null==S||!S.Uqg)};
l.compare=function(S,H){if(!l.isBuffer(S)||!l.isBuffer(H))throw new TypeError("Arguments must be Buffers");if(S===H)return 0;for(var T=S.length,K=H.length,da=0,fa=Math.min(T,K);da<fa;++da)if(S[da]!==H[da]){T=S[da];K=H[da];break}return T<K?-1:K<T?1:0};l.Rdf=function(S){switch(String(S).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};l.concat=function(S,H){if(!Q(S))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===S.length)return l.Gpe(0);var T;if(void 0===H)for(T=H=0;T<S.length;++T)H+=S[T].length;H=l.dJg(H);var K=0;for(T=0;T<S.length;++T){var da=S[T];if(!l.isBuffer(da))throw new TypeError('"list" argument must be an Array of Buffers');da.copy(H,K);K+=da.length}return H};l.byteLength=A;l.prototype.Uqg=!0;l.prototype.toString=function(){var S=this.length|0;return 0===S?"":0===arguments.length?r(this,0,S):x.apply(this,arguments)};l.prototype.equals=function(S){if(!l.isBuffer(S))throw new TypeError("Argument must be a Buffer");
return this===S?!0:0===l.compare(this,S)};l.prototype.compare=function(S,H,T,K,da){if(!l.isBuffer(S))throw new TypeError("Argument must be a Buffer");void 0===H&&(H=0);void 0===T&&(T=S?S.length:0);void 0===K&&(K=0);void 0===da&&(da=this.length);if(0>H||T>S.length||0>K||da>this.length)throw new RangeError("out of range index");if(K>=da&&H>=T)return 0;if(K>=da)return-1;if(H>=T)return 1;H>>>=0;T>>>=0;K>>>=0;da>>>=0;if(this===S)return 0;var fa=da-K,W=T-H,ca=Math.min(fa,W);K=this.slice(K,da);S=S.slice(H,
T);for(H=0;H<ca;++H)if(K[H]!==S[H]){fa=K[H];W=S[H];break}return fa<W?-1:W<fa?1:0};l.prototype.includes=function(S,H,T){return-1!==this.indexOf(S,H,T)};l.prototype.indexOf=function(S,H,T){return u(this,S,H,T,!0)};l.prototype.lastIndexOf=function(S,H,T){return u(this,S,H,T,!1)};l.prototype.write=function(S,H,T,K){if(void 0===H)K="utf8",T=this.length,H=0;else if(void 0===T&&"string"===typeof H)K=H,T=this.length,H=0;else if(isFinite(H))H|=0,isFinite(T)?(T|=0,void 0===K&&(K="utf8")):(K=T,T=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var da=this.length-H;if(void 0===T||T>da)T=da;if(0<S.length&&(0>T||0>H)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");K||(K="utf8");for(da=!1;;)switch(K){case "hex":H=Number(H)||0;K=this.length-H;T?(T=Number(T),T>K&&(T=K)):T=K;K=S.length;if(0!==K%2)throw new TypeError("Invalid hex string");T>K/2&&(T=K/2);for(K=0;K<T;++K){da=parseInt(S.substr(2*K,2),16);if(isNaN(da))break;this[H+K]=da}return K;case "utf8":case "utf-8":return V(I(S,this.length-H),this,H,T);case "ascii":return V(z(S),
this,H,T);case "latin1":case "binary":return V(z(S),this,H,T);case "base64":return V(D(S),this,H,T);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":K=S;da=this.length-H;for(var fa=[],W=0;W<K.length&&!(0>(da-=2));++W){var ca=K.charCodeAt(W);S=ca>>8;ca%=256;fa.push(ca);fa.push(S)}return V(fa,this,H,T);default:if(da)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase();da=!0}};l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.d_j||this,0)}};
var la=4096;l.prototype.slice=function(S,H){var T=this.length;S=~~S;H=void 0===H?T:~~H;0>S?(S+=T,0>S&&(S=0)):S>T&&(S=T);0>H?(H+=T,0>H&&(H=0)):H>T&&(H=T);H<S&&(H=S);if(l.gP)H=this.subarray(S,H),H.__proto__=l.prototype;else{T=H-S;H=new l(T,void 0);for(var K=0;K<T;++K)H[K]=this[K+S]}return H};l.prototype.b7i=function(S){if(0!==S%1||0>S)throw new RangeError("offset is not uint");if(S+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[S]<<8|this[S+1]};l.prototype.copy=
function(S,H,T,K){T||(T=0);K||0===K||(K=this.length);H>=S.length&&(H=S.length);H||(H=0);0<K&&K<T&&(K=T);if(K===T||0===S.length||0===this.length)return 0;if(0>H)throw new RangeError("targetStart out of bounds");if(0>T||T>=this.length)throw new RangeError("sourceStart out of bounds");if(0>K)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length);S.length-H<K-T&&(K=S.length-H+T);var da=K-T;if(this===S&&T<H&&H<K)for(K=da-1;0<=K;--K)S[K+H]=this[K+T];else if(1E3>da||!l.gP)for(K=0;K<
da;++K)S[K+H]=this[K+T];else Uint8Array.prototype.set.call(S,this.subarray(T,T+da),H);return da};l.prototype.fill=function(S,H,T,K){if("string"===typeof S){"string"===typeof H?(K=H,H=0,T=this.length):"string"===typeof T&&(K=T,T=this.length);if(1===S.length){var da=S.charCodeAt(0);256>da&&(S=da)}if(void 0!==K&&"string"!==typeof K)throw new TypeError("encoding must be a string");if("string"===typeof K&&!l.Rdf(K))throw new TypeError("Unknown encoding: "+K);}else"number"===typeof S&&(S&=255);if(0>H||
this.length<H||this.length<T)throw new RangeError("Out of range index");if(T<=H)return this;H>>>=0;T=void 0===T?this.length:T>>>0;S||(S=0);if("number"===typeof S)for(K=H;K<T;++K)this[K]=S;else for(S=l.isBuffer(S)?S:I((new l(S,K)).toString()),da=S.length,K=0;K<T-H;++K)this[K+H]=S[K%da];return this};var ba=/[^+\/0-9A-Za-z-_]/g}).call(this,b(692))},1288:function(y,F){function b(l){var n=l.length;if(0<n%4)throw Error("Invalid string. Length must be a multiple of 4");l=l.indexOf("=");-1===l&&(l=n);return[l,
l===n?0:4-l%4]}F.byteLength=function(l){l=b(l);var n=l[1];return 3*(l[0]+n)/4-n};F.ELj=function(l){var n=b(l);var m=n[0];n=n[1];var f=new d(3*(m+n)/4-n),v=0,w=0<n?m-4:m,t;for(t=0;t<w;t+=4)m=c[l.charCodeAt(t)]<<18|c[l.charCodeAt(t+1)]<<12|c[l.charCodeAt(t+2)]<<6|c[l.charCodeAt(t+3)],f[v++]=m>>16&255,f[v++]=m>>8&255,f[v++]=m&255;2===n&&(m=c[l.charCodeAt(t)]<<2|c[l.charCodeAt(t+1)]>>4,f[v++]=m&255);1===n&&(m=c[l.charCodeAt(t)]<<10|c[l.charCodeAt(t+1)]<<4|c[l.charCodeAt(t+2)]>>2,f[v++]=m>>8&255,f[v++]=
m&255);return f};F.YVe=function(l){for(var n=l.length,m=n%3,f=[],v=0,w=n-m;v<w;v+=16383){for(var t=f,A=t.push,x,u=l,B=v+16383>w?w:v+16383,r=[],I=v;I<B;I+=3)x=(u[I]<<16&16711680)+(u[I+1]<<8&65280)+(u[I+2]&255),r.push(a[x>>18&63]+a[x>>12&63]+a[x>>6&63]+a[x&63]);x=r.join("");A.call(t,x)}1===m?(l=l[n-1],f.push(a[l>>2]+a[l<<4&63]+"==")):2===m&&(l=(l[n-2]<<8)+l[n-1],f.push(a[l>>10]+a[l>>4&63]+a[l<<2&63]+"="));return f.join("")};var a=[],c=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array;for(y=0;64>
y;++y)a[y]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[y],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(y)]=y;c[45]=62;c[95]=63},1289:function(y,F){F.read=function(b,a,c,d,l){var n=8*l-d-1;var m=(1<<n)-1,f=m>>1,v=-7;l=c?l-1:0;var w=c?-1:1,t=b[a+l];l+=w;c=t&(1<<-v)-1;t>>=-v;for(v+=n;0<v;c=256*c+b[a+l],l+=w,v-=8);n=c&(1<<-v)-1;c>>=-v;for(v+=d;0<v;n=256*n+b[a+l],l+=w,v-=8);if(0===c)c=1-f;else{if(c===m)return n?NaN:Infinity*(t?-1:1);n+=Math.pow(2,
d);c-=f}return(t?-1:1)*n*Math.pow(2,c-d)};F.write=function(b,a,c,d,l,n){var m,f=8*n-l-1,v=(1<<f)-1,w=v>>1,t=23===l?Math.pow(2,-24)-Math.pow(2,-77):0;n=d?0:n-1;var A=d?1:-1,x=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,d=v):(d=Math.floor(Math.log(a)/Math.LN2),1>a*(m=Math.pow(2,-d))&&(d--,m*=2),a=1<=d+w?a+t/m:a+t*Math.pow(2,1-w),2<=a*m&&(d++,m/=2),d+w>=v?(a=0,d=v):1<=d+w?(a=(a*m-1)*Math.pow(2,l),d+=w):(a=a*Math.pow(2,w-1)*Math.pow(2,l),d=0));for(;8<=l;b[c+n]=a&255,n+=
A,a/=256,l-=8);d=d<<l|a;for(f+=l;0<f;b[c+n]=d&255,n+=A,d/=256,f-=8);b[c+n-A]|=128*x}},1290:function(y){var F={}.toString;y.exports=Array.isArray||function(b){return"[object Array]"==F.call(b)}},1291:function(y,F,b){function a(){var l=d.call(this)||this;l.errorCode=null;l.errorDescription=null;l.html=null;l.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.se()});return l}b.d(F,"a",function(){return a});y=b(0);F=b(847);var c=b(821),d=F.a;vm(a,d);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};
a.se=function(){return["AugLoop_Core_Annotation"]};Object(y.a)(a,"DetectedHtmlTableAnnotation",F.a,[])},1292:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.qHa=function(c,d){if(!(c&&d&&c.length&&d.length)||256<c.length)return"";var l=Array(256),n=Array(256),m,f=0,v=0,w="";for(m=0;256>m;m++)l[m]=m;for(m=0;256>m;m++){var t=c.charCodeAt(m%c.length);if(256<=t)return"";f=(f+l[m]+t)%256;t=l[m];l[m]=l[f];l[f]=t}for(m=0;256>m;m++)n[m]=l[256-m-1];for(c=f=m=0;c<d.length;c++){m=(m+1)%
256;f=(f+l[m])%256;t=l[m];l[m]=l[f];l[f]=t;t=d.charCodeAt(c);if(256<=t)return"";var A=t^l[(l[m]+l[f])%256];v=(v+n[m])%256;t=n[m];n[m]=n[v];n[v]=t;w+=String.fromCharCode(A^l[(n[m]+n[v])%256])}return w};Object(y.a)(a,"RC4A",null,[])},1294:function(y,F,b){function a(l,n,m,f){this.CRc=this.nkb=this.ERc=null;this.hEa=l;d.AFrameworkApplication.ga.ra("AddInCommandsMissingTabIsEnabled")?(this.ERc=m.UTh(),this.nkb=m.d$a,this.CRc=m.EBi):(this.ERc=m.bzc,this.CRc=this.nkb=null);this.SEc=this.Hs=n;this.ewg=f}
b.d(F,"a",function(){return a});y=b(0);var c=b(13),d=b(5);a.prototype.cva=function(l){l=this.cOa+this.solutionId+l;return this.JQd?(l in a.mZb||(a.mZb[l]="AddinControl"+a.THg++),a.mZb[l]):l};a.prototype.dGe=function(l){if(this.JQd){var n=a.mZb,m;for(m in n){var f=m;if(l===n[m])return f.substr(this.cOa.length+this.solutionId.length)}}return l};a.prototype.ihd=function(l){l=this.cOa+this.solutionId+l;return this.JQd?(l in a.GVc||(a.GVc[l]="AddinTab"+a.aIg++),a.GVc[l]):l};a.prototype.cVh=function(l){return l.toLowerCase()in
this.bzc?(c.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",l.toLowerCase()),this.cOa+this.bzc[l.toLowerCase()]):null};a.prototype.pVh=function(){if(!this.d$a)return null;for(var l=[],n=yl(this.d$a),m=n.next();!m.done;m=n.next())l.push(this.cOa+m.value);return l};a.prototype.RSh=function(l){l=this.KXe(l);return null===l?null:l[1]};a.prototype.PSh=function(l){l=this.KXe(l);return null===l?null:l[2]};a.prototype.KXe=function(l){return this.CUd&&l.toLowerCase()in this.CUd?(c.ULS.sendTraceTag(21017039,
220,50,"Get attributes for Tab id: {0}.",l.toLowerCase()),this.CUd[l.toLowerCase()]):null};Qk.Object.defineProperties(a.prototype,{cOa:{configurable:!0,enumerable:!0,get:function(){return this.hEa}},bzc:{configurable:!0,enumerable:!0,get:function(){return this.ERc}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Hs}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.SEc}},d$a:{configurable:!0,enumerable:!0,get:function(){return this.nkb}},CUd:{configurable:!0,
enumerable:!0,get:function(){return this.CRc}},JQd:{configurable:!0,enumerable:!0,get:function(){return this.ewg}}});a.mZb={};a.GVc={};a.aIg=0;a.THg=0;Object(y.a)(a,"DefaultRibbonNamingProvider",null,[802])},1342:function(y,F,b){function a(x){var u=this;this.GA=null;this.R$f={};this.T$f={};this.abd={};this.Yxd={};this.Wid=function(B,r){B=u.$.Wb.Ic("Task","DdaEventDispatch.HandleServerEvent");r=r.rYf;for(var I=0;I<r.length;I++)switch(r[I].EventType){case 2:var z=r[I],D={};D.Name=z.Name;D.BindingType=
z.BindingType;D.ColCount=z.ColCount;D.RowCount=z.RowCount;u.Jva(z.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,D,null);break;case 4:u.Jva(r[I].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(z=r[I],z.InstanceId){D=Array(z.Entries.length);for(var V=0;V<z.Entries.length;V++)D[V]=a.Gbc(z.Entries[V],z.IsRemoteOverride);0<z.Entries.length&&1===z.Entries[0].Category?u.w2i(z.InstanceId,D):z.InstanceId&&u.Jva(z.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,D)}else{u.abd={};u.Yxd={};for(D=0;D<z.Entries.length;D++)u.OIe(z.Entries[D],z.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",u.abd,u.Yxd,u.R$f,u.T$f)}}B.stop()};this.RIb=function(B,r){u.Jva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)};this.$=x;this.fvc=this.Wid}b.r(F);y=b(0);var c=b(13),d=b(84),l;(function(x){x[x.none=0]="none";x[x.testEvent=1]=
"testEvent";x[x.test1Event=2]="test1Event";x[x.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";x[x.worksheetActivatedEvent=11]="worksheetActivatedEvent";x[x.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";x[x.worksheetAddedEvent=13]="worksheetAddedEvent";x[x.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";x[x.worksheetDeletedEvent=15]="worksheetDeletedEvent";x[x.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";x[x.worksheetFilteredEvent=17]="worksheetFilteredEvent";
x[x.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";x[x.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";x[x.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";x[x.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";x[x.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";x[x.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";x[x.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";x[x.worksheetNameChangedEvent=25]=
"worksheetNameChangedEvent";x[x.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";x[x.worksheetMovedEvent=27]="worksheetMovedEvent";x[x.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";x[x.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";x[x.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";x[x.chartAddedEvent=50]="chartAddedEvent";x[x.chartActivatedEvent=51]="chartActivatedEvent";x[x.chartDeactivatedEvent=
52]="chartDeactivatedEvent";x[x.chartDeletedEvent=53]="chartDeletedEvent";x[x.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";x[x.tableDataChangedEvent=101]="tableDataChangedEvent";x[x.tableAddedEvent=102]="tableAddedEvent";x[x.tableDeletedEvent=103]="tableDeletedEvent";x[x.tableFilteredEvent=104]="tableFilteredEvent";x[x.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";x[x.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";x[x.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";x[x.commentAddedEvent=250]="commentAddedEvent";x[x.commentDeletedEvent=251]="commentDeletedEvent";x[x.commentChangedEvent=252]="commentChangedEvent";x[x.invocationMessage=1E3]="invocationMessage";x[x.cancellationMessage=1001]="cancellationMessage";x[x.metadataMessage=1002]="metadataMessage";x[x.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";x[x.visualChangeEvent=2001]="visualChangeEvent";x[x.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
x[x.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";x[x.shapeActivatedEvent=2101]="shapeActivatedEvent";x[x.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";x[x.shapeAddedEvent=2103]="shapeAddedEvent";x[x.shapeDeletedEvent=2104]="shapeDeletedEvent";x[x.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";x[x.wacOperationEvent=2201]="wacOperationEvent";x[x.recordingStateChangedEvent=2202]="recordingStateChangedEvent";x[x.workbookActivatedEvent=2203]="workbookActivatedEvent";
x[x.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";x[x.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";x[x.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";x[x.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";x[x.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";x[x.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
x[x.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";x[x.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";x[x.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";x[x.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";x[x.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";x[x.pivotTableAddedEvent=2900]="pivotTableAddedEvent";x[x.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
x[x.namedItemAddedEvent=3E3]="namedItemAddedEvent";x[x.namedItemDeletedEvent=3001]="namedItemDeletedEvent";x[x.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";x[x.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";x[x.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(l||(l={}));Object(y.b)("MessageType",l);var n=b(894),m=b(232),f=b(862),v=b(54),w=b(35),t=b(147),A=b(1);b.d(F,"DdaEventDispatch",function(){return a});
a.prototype.RYb=function(x){x&&(this.Gia(),Array.add(this.GA,x))};a.prototype.zsc=function(x){this.GA&&(Array.remove(this.GA,x),this.GA.length||(this.$.wantServerEvents=!1,this.$.fej(this.fvc),this.GA=null))};a.prototype.w2i=function(x,u){var B=this,r=Object(d.a)(f.DdaFacade,m.a(this.$));w.TaskExtensions.Ba(r.mVh(x),function(I){if(t.b(I)){var z=I.result;I=r.an(z);if(z)if(I.upd)B.Jva(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u);else if(I.e5c)for(z=0;z<u.length;z++)Array.add(I.e5c,u[z]);
else I.e5c=u}else I.kg?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):I.Hh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ma,0)};a.prototype.S2i=function(x,u){var B=Object(d.a)(f.DdaFacade,m.a(this.$)),r=B.HJh(x);r?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(r,u,this.RIb):B.m4g(x,u)};a.prototype.OIe=function(x,
u){var B=!1,r=parseInt(x.Type,10),I=x.Target,z=Object(d.a)(f.DdaFacade,m.a(this.$));if((I=z.fj.sVh(r,I))&&0<Object.keys(I).length){B=!0;for(var D in I)if(I=D,z.fj.k_b(I)){var V=Array(1);V[0]=a.Gbc(x,u);if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var U=V[0][3];if(void 0!==U&&null!==U&&(U=Object(d.a)(Object,v.a.oi(U)))&&void 0!==U.triggerControlId&&null!==U.triggerControlId&&void 0!==U.triggerSource&&null!==U.triggerSource){var Q=!1;u?(U.triggerSource="Unknown",
Q=!0):z.bhh(U.triggerControlId,I)&&(U.triggerSource="ThisLocalAddin",Q=!0);Q&&(V[0][3]=v.a.Lc(U))}}this.Jva(I,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,V)}}B?(this.oec(l[r],this.abd),this.oec(l[r],this.R$f)):(this.oec(l[r],this.Yxd),this.oec(l[r],this.T$f))};a.prototype.Gia=function(){this.GA||(this.GA=[],this.$.Boe(this.fvc),this.$.wantServerEvents=!0)};a.prototype.oec=function(x,u){x in u||(u[x]=0);u[x]+=1};a.prototype.UM=function(x,u,B){var r={};r.Target=u;r.Category=65536;r.Type=x;r.Message=
B;r.Id=-1;this.OIe(r,!1)};a.prototype.wDh=function(x,u){var B={Target:"",Category:2,Type:1E3};B.Message=u;B.Id=0;u=Array(1);u[0]=a.Gbc(B,!1);this.S2i(x,u)};a.prototype.C9b=function(x,u,B,r){var I={};I.Target=B;I.Category=65536;I.Type=u;I.Message=r;I.Id=-1;u=Array(1);u[0]=a.Gbc(I,!1);this.Jva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};a.prototype.vDh=function(x,u){this.Jva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};a.prototype.Jva=function(x,u,B,r){if(this.GA){var I=Object(d.a)(f.DdaFacade,
m.a(this.$));if(!I||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||I.fj.k_b(x))for(x=new n.a(u,x,B,r),u=0,B=this.GA.length;u<B;u++)(r=this.GA[u])&&r(x)}};a.Gbc=function(x,u){var B=Array(6);B[0]=x.Category;B[1]=x.Type;B[2]=x.Target;B[3]=x.Message;B[4]=x.Id;B[5]=u;return B};Object(y.a)(a,"DdaEventDispatch",null,[])},1365:function(y,F,b){function a(){var l=d.call(this,void 0,void 0,void 0,!0)||this;l.PCa="AddinCommandsUILessDialog";l.dSc="WACDialogTitleText";
l.bVa="0";l.SCa=380;l.Hhb=190;l.Ve=l.PCa;l.kc=5;l.bng=String.format("{0}px",l.SCa);l.aVa=String.format("{0}px",l.Hhb);l.Ru=!1;l.M7e=!1;l.eD();return l}b.d(F,"a",function(){return a});y=b(0);F=b(140);var c=b(89),d=F.a;vm(a,d);a.prototype.eD=function(){d.prototype.eD.call(this);this.xp.style.width=this.bng;this.xp.style.height=this.aVa;this.xp.style.padding=this.bVa};a.prototype.mv=function(l){this.DO();document.getElementById(this.pi(this.dSc)).innerText=l};a.prototype.DO=function(){d.prototype.DO.call(this);
this.Mb.style.width=String.format("{0}px",this.SCa);this.Mb.style.height=String.format("{0}px",this.Hhb);this.Mb.removeAttribute(c.a.Ud);this.Mb.removeAttribute(c.a.dE)};a.prototype.hide=function(){this.Xwb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Qk.Object.defineProperties(a.prototype,{j1a:{configurable:!0,enumerable:!0,get:function(){return this.xp}}});Object(y.a)(a,"AddinCommandsUILessDialog",F.a,[800])},1371:function(y,
F,b){function a(G){return Pk.call(this,G)||this}function c(G,ka,Ua){this.rangePicker=null;this.$=G;this.Xe=ka;this.Ae=new K(G.ea);this.Qz=new U(G,this.Ae);this.nsf=Ua;this.S8b=new Map}function d(G,ka,Ua,e,C){this.ISc=null;this.RPb=G;this.eA=ka;this.eJ=Ua;this.vb=e;this.Qyg=C}function l(){}function n(){this.qga=null}function m(G){if(!G)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.uvd=G}function f(G,ka,Ua){return function(e){return function(C,
J){Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.create(ka.da,279,ka.ma,1),function(ja){ja=ja.result;var Aa=!1,gb=Ua.Ii.getOsfControl(G),bc=null;gb&&(bc=gb.getStoreType(),(gb=gb.getManifest())&&gb.getSharedRuntimeForCustomFunctions("Workbook")&&(Aa=!0));Fh.TaskExtensions.Ba(ja.wbf(G,bc,e,Aa),function(Mc){pl.b(Mc)?Mc.result?C(null):J(OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.invalidArgument,gf.a.instance.fa(1719))):J(OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.generalException,
gf.a.instance.fa(1715)))},ka.ma,3)},ka.ma,3)}}}function v(G,ka){this.iP=oi.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.eA=G;this.eJ=ka;this.ztg=this.eJ.Ii.getOsfControl(this.eA)}function w(G,ka,Ua,e){this.G2d="";this.JRb=0;this.iP=G;this._id=ka;this.eA=Ua;this.eJ=e}function t(G,ka,Ua){this.Oqg=G;this.Pqg=ka;this.Kug=Ua}function A(){this.Phe=this.Pbe=this.Zz=!1}function x(G,ka,Ua,e){this.Hs=G;this.B1=Ua;this.Ay=e.Ii.getOsfControl(ka)}function u(G,ka){this.eJ=
ka;this.eA=G}function B(G){this.eA=G}function r(G){this.tIa={};this.Rzi=G}function I(G,ka){var Ua=this;Ua.Ohf=function(e,C){e=I.d3g(e,C);if(!kl.a(Ua.$,e))return!0;e=Ua.$.shortcutKeyManager.y3e(e);return!!e&&0<e.length};Ua.addinId=G;Ua.$=ka;return Ua}function z(){}function D(){}function V(G,ka,Ua,e){this.mBh=G;this.fileSize=ka;this.WDj=e}function U(G,ka){var Ua=this;this.jI=function(e,C){Ua.IQ.JJa(ae.a.internalError,C)};this.$=G;this.IQ=ka}function Q(G,ka,Ua,e){Ua=el.call(this,576,0,Ua,e)||this;Ua.LLd=
new ba("576",G,ka);return Ua}function la(G,ka,Ua,e,C,J,ja,Aa){ka=Vk.call(this,10,0,ka,Aa)||this;ka.Nlb=Ua;ka.bib=e;ka.C3=C;ka.$Ea=J;ka.request=ja;ka.LLd=new ba("10",G,ja);return ka}function ba(G,ka,Ua){this.parentName=G;this.$=ka;this.request=Ua}function S(G,ka){this.source=G;this.eventId=ka}function H(G,ka,Ua,e,C,J){var ja=G.Na(1);ja.request=ka;return hj.i(G,"ExecuteRichApiRequest",ja,Ua,e,C,J,0)}function T(G,ka,Ua){this.$=G;this.IQ=ka;this.Qz=Ua}function K(G){this.ea=G}function da(G,ka,Ua,e){G=
Pj.call(this,G,"Select Data")||this;G.Iob=null;G.vGe=ka;G.H5c=Ua;G.callback=e;return G}function fa(G){this.vb=G}function W(G){G.add("InternalTest","PreviewExecutionMethod",ca)}function ca(G,ka){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof G+", objectId="+G+", value="+ka);return null}function ia(G,ka){this.zsg=G;this.Xsg=ka}function ea(G){var ka=G.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",
3,0);var Ua=ka.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ua.addParameter("shortcuts","String[]",1,null,0);ka.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Ua=ka.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ua.addParameter("shortcuts","Object",1,null,0);ka=G.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ua=ka.addMethod("GetSharedFilePickerResponse",1,"Object",
1,1,"SharedFilePickerResponse",0);Ua.addParameter("pickerCustomizationJsonString","String",1,null,0);ka=G.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Ua=ka.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Ua.addParameter("base64File","String",1,null,0);ka=G.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ka.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);Ua=ka.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Ua.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ka=G.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);ka.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Ua=ka.addMethod("Register",1,"Void",0,0,"Register",0);Ua.addParameter("metadata",
"String",1,null,0);Ua.addParameter("javascript","String",1,null,0);ka=G.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ka.addProperty("Enabled",1,"Boolean",1,!1,null,0);ka.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);ka.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);ka=G.addEnumType("Microsoft.Authentication.IdentityType");ka.addEnumField("OrganizationAccount",0);ka.addEnumField("MicrosoftAccount",1);ka=G.addEnumType("Microsoft.Authentication.AuthorityType");
ka.addEnumField("External",0);ka.addEnumField("Msa",1);ka.addEnumField("Aad",2);ka=G.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);ka.addProperty("DisplayName",4,"String",1,!1,null,0);ka.addProperty("Email",3,"String",1,!1,null,0);ka.addProperty("FederationProvider",2,"String",1,!1,null,0);ka.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);ka=G.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);ka.addProperty("AppId",4,"String",1,!1,null,0);ka.addProperty("Authority",2,"String",1,!1,null,0);ka.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);ka.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);ka.addProperty("TenantId",6,"String",1,!1,null,0);ka.addProperty("Upn",1,"String",1,!1,null,0);ka=G.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);ka.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Ua=ka.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Ua.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);ka.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);ka.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);ka=G.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);ka.addProperty("AuthChallenge",3,"String",1,!1,null,0);ka.addProperty("CorrelationId",7,"String",1,!1,null,0);ka.addProperty("Policy",4,"String",1,!1,null,0);ka.addProperty("Resource",2,"String",1,!1,null,0);ka.addProperty("Scope",5,"String",1,!1,null,0);ka.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);ka=G.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ka.addProperty("AccessToken",2,"String",1,!1,null,0);ka.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);ka=G.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);ka.addProperty("Id",1,"String",1,!0,null,0);ka.addProperty("Value",2,"Object",1,!1,null,0);ka=G.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);Ua=ka.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Ua.addParameter("id","String",1,null,0);Ua=ka.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Ua.addParameter("id","String",1,null,0);ka=G.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ka.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);Ua=ka.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ua.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ka=G.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ka.addEnumField("Inactive",0);ka.addEnumField("Background",1);ka.addEnumField("Visible",2);ka=G.addEnumType("Microsoft.AppRuntime.Visibility");ka.addEnumField("Hidden",1);ka.addEnumField("Visible",2);ka=G.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ka.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ua=ka.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ua.addParameter("jsonCreate","String",1,null,0);Ua=ka.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ua.addParameter("jsonUpdate","String",1,null,0);Ua=ka.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ua.addParameter("id","String",
1,null,0);Ua=ka.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ua.addParameter("id","String",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka=G.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ka.addProperty("Id",2,"String",1,!0,null,0);Ua=ka.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Ua.addParameter("visibility","Boolean",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka=G.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ka.addProperty("Enabled",3,"Boolean",1,!1,null,0);ka.addProperty("Id",2,"String",1,!0,null,0);ka.addProperty("Label",4,"String",1,!0,null,0);Ua=ka.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ua.addParameter("enabled","Boolean",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka=G.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ka.addMethod("GetCount",3,"Int32",1,1,"Count",
0);Ua=ka.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ua.addParameter("key","String",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);ka=G.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ka.addEnumField("Unknown",0);ka.addEnumField("Basic",1);ka.addEnumField("Premium",2);ka=G.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);Ua=ka.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ua.addParameter("feature","String",1,null,0);Ua.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ua=ka.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ua.addParameter("feature","String",1,null,0);Ua=ka.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ua.addParameter("feature","String",
1,null,0);Ua.addParameter("fallbackValue","Boolean",1,null,0);ka.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ua=ka.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ua.addParameter("experienceId","String",1,null,0);Ua=ka.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Ua.addParameter("feature","String",1,null,0);ka=G.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);ka.addProperty("Id",5,"String",1,!0,null,0);ka.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ka.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ka=G.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ka.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ka=G.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);ka.addMethod("Disable",3,"Void",0,1,"Disable",0);ka.addMethod("Enable",2,"Void",0,1,"Enable",0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function qa(G,ka,Ua,e){this.menuItemId=G;this.AI=ka;this.zHj=Ua;this.xBh=e}function pa(G){this.jyi=G}function Pa(G){this.Kxa=G;this.jog=Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function Ha(){}function Ya(){}
function Na(){}function eb(G,ka){this.ihb=ka;this.eA=G}function Ia(){this.R1d=null;this.cge=this.cVb=this.FD="";this.qhe=!0;this.options=null}function lb(G,ka){this.fgb=G;this.Lib=ka}function hc(){}function ma(){this.p6d=this.G5d=this.ofa=null;this.Lib=0}function Ja(G){var ka=jl.call(this)||this;ka.$=G;ka.fc();return ka}function Ta(G,ka,Ua){this.dlg=null;this.flg=0;this.wb=G;this.Sg=ka;this.n3d=Ua}function pb(){}function Db(G,ka,Ua,e,C){var J=dl.call(this)||this;J.Fcb={};J.ebd={};J.mwa=null;J.L$a=
null;J.A5h=function(ja,Aa,gb,bc,Mc){if(2!==gb)return 32;ja=Mc[Sj.a.I8b];gb=Mc[Sj.a.eHa];Mc=Mc[Sj.a.Oya];Aa=new Dj.a;Aa.ydi=Mc.ri.InstanceToken;Aa.cl=Mc.ri[ye.cl];Aa.vS=Mc.ri[ye.vS];ye.taskPaneWidth in Mc.ri&&(Aa.taskPaneWidth=Mc.ri[ye.taskPaneWidth]);Aa.sourceLocationOverrideResourceId=Mc.ri[ye.sourceLocationOverrideResourceId];Aa.eI=Mc.hr;Aa.onTaskPaneClose=Mc.ri[ye.onTaskPaneClose];Aa.eHa=gb;gb=new Wf.a(-859308420,0,2,0,"");bc=ja.getStoreType()===OSF.StoreType.Sdx;var Hc=new oc;Hc.Yaa=Mc.ri.HeaderCssClass||
af.a.e2a;Hc.xMb=Mc.ri.TitleCssClass;J.G0(gb,ja.getId(),Aa,bc,Hc);return 32};J.l5h=function(ja,Aa,gb,bc,Mc){if(2!==gb)return 32;ja=Mc[Sj.a.I8b].getId();Mc=Mc[Sj.a.Oya].ri[ye.sourceLocationOverrideResourceId];return ja?(J.Xe.Ii.refreshOsfControl(ja,Mc),32):8};J.j0i=function(ja){ja=ja.Result;if(ja=null===ja?null:ja.SolutionId)J.Xe.Ile(ja),yk.a(J.$).jna(3,ja)};J.CIf=function(ja,Aa){var gb=(ja=ja.Result)?ja.AgaveData:null;if(gb){Te.ULS.shipAssertTag(537170434,0,gb.TaskpaneWidth===Db.Pch,"Taskpane width is {0}, assetId is {1}.",
gb.TaskpaneWidth,gb.PrimaryMarketplace.SolutionId);var bc=J.ebd[gb.PrimaryMarketplace.SolutionId];bc&&(bc.szc&&(gb.TaskpaneTitle=bc.szc),bc.qzc&&(gb.TaskpaneIconId=bc.qzc),bc.UUd&&(gb.TaskpaneButtonTooltip=bc.UUd),0<bc.Dr&&(gb.TaskpaneWidth=bc.Dr));Aa&&(gb.FocusOnIframeWhenLoaded=Aa.focusOnIframeWhenLoaded,Aa.width&&(gb.TaskpaneWidth=Aa.width),gb.TaskpaneIconCssClass=Aa.Mj,gb.TaskpaneHeaderCssClass=Aa.Yaa,gb.TaskpaneTitleCssClass=Aa.xMb,gb.IsFirstPartyOptOutAppContextOptmization=Aa.isFirstPartyOptOutAppContextOptmization);
J.Fcb[gb.PrimaryMarketplace.SolutionId]&&(gb.OsfPropertyBag=J.jwd(gb.OsfPropertyBag,gb.PrimaryMarketplace.SolutionId));lk.a(gb)||(gb.WebExtensionOsfControlType=1);gb&&(J.Xe.Ile(ja.SolutionId),J.Xe.y0a(gb))}else Te.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};J.IAh=function(ja){ja&&(J.had.zjf(ja),J.ixe())};J.EIf=function(ja){ja=ja.toDataURL("image/jpeg");var Aa=J.Xe.uaa(Db.X8e+"."+Db.t5e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Aa,
"onScreenshot",{screenshot:ja},function(){})};J.P3h=function(ja,Aa,gb,bc,Mc){if(2!==gb)return 32;if(Lj.a.ni(Mc)||Mc[Sj.a.uBe]!==Vj.a.action)return 8;Aa=Mc[Sj.a.Oya];return Aa?(ja=(ja=J.rVh(Mc))?J.Xe.uaa(ja):null)?(Mc=J.Xe.j4g(Mc[Sj.a.eHa],Aa.ri[ye.gTc]),dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(gb=J.Xe.pZ(ja),gb.TaskpaneTitle!==Aa.ri[ye.cl]&&(gb.TaskpaneTitle=Aa.ri[ye.cl],gb.TaskpaneIconCssClass=Aa.ri.IconCssClass,gb.TaskpaneIconUrl=Aa.ri.TaskPaneIconUrl,
gb.TaskpaneIconId=Aa.ri.TaskPaneIconId,dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Aa=J.Xe.Ii,Aa.changeIframeTitle(ja,gb.TaskpaneTitle),gb=Aa.getOsfControl(ja),Aa.raiseOsfControlStatusChange(gb)):(Aa=J.Xe.Ii.getOsfControl(ja),J.Xe.Ii.raiseOsfControlStatusChange(Aa)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ja,Mc,J.RIb),32):8:8};J.RIb=function(ja,Aa){J.Xe.rDh(ja,Aa)};J.$=G;J.viewBlockContainerHelpers=Ua;J.Xe=ka;J.had=e;J.Fi=C;J.Fi.hc(se.a.X3f,
bk.a.frame,J.A5h);J.Fi.hc(se.a.jUf,bk.a.frame,J.l5h);J.Fi.hc(se.a.ORe,bk.a.frame,J.P3h);return J}function fb(){var G=Ok.call(this)||this;G.aVa="calc(100% - 46px)";G.DQb="15px";G.bVa="0";G.Wng="WACDialogPanel";G.SCa=695;G.Xng=462;G.Hhb="80%";G.Nlg=350;G.i2d="100%";G.kc=5;G.Ve="AppsForOfficeInsertionDialog";G.DHc=!!Bf.AFrameworkApplication.ga&&Bf.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return G}function xa(){var G=ya.call(this)||this;G.isTable=!1;G.isPivotTable=
!1;G.hasTableHeaders=!1;G.tableName=null;G.userSelectedPivotTable=!1;return G}function ya(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function Ga(){this.UUd=this.szc=null;this.Dr=0;this.qzc=null}function db(){var G=this;this.Xe=null;this.dab=function(ka,Ua,e,C,J){if(2===e){ka=J?J:{};Ua=ka.callback;if(!Ua)return 16;G.Xe.KFd(Ua,ka.refresh?ka.refresh:!1)}return 32};this.a$i=
function(ka,Ua,e,C,J){2===e&&(ka=J?J.callback:null)&&G.Xe.BEg(ka);return 32}}function Ob(G,ka){this.i9=ka}function Ec(G){return Th.call(this,G)||this}function wb(G){var ka=Sh.call(this)||this;ka.$=G;ka.isFirstLaunch=!1;return ka}function kb(G){Te.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Nof=Bf.AFrameworkApplication.ga.ra("IsTellMeUpSellEnterpriseEnabled");this.Dxi=Bf.AFrameworkApplication.ga.Ua("SmartLookupApprovedOriginPattern");this.l8a=Bf.AFrameworkApplication.ga.Ua("SmartLookupShredderServiceEndpoint");
this.hyi=wa.a.YM(Bf.AFrameworkApplication.ga.Ua("AppCatalogUrl")||"");this.k8a=new Za;this.k8a.EnableAllTabV2=!0;this.k8a.EnableIntentService=!0;this.k8a.EnableInDocumentSearch=Bf.AFrameworkApplication.ga.ra("SmartLookupEnableInDocumentSearch");this.k8a.EnableLocalSearch=Bf.AFrameworkApplication.ga.ra("SmartLookupEnableLocalSearch");this.k8a.IntentServiceEndpoint=vb.OYh();this.cyi=new Gb(G,this.l8a)}function vb(){}function Gb(G,ka,Ua){this.cMj=9E5;this.fMj=3E5;this.Zud=null;this.gof="";this.Wud=0;
this.sGe=Date.now;this.Kxa=G;this.l8a=ka;(void 0===Ua||Ua)&&this.kdd()}function Za(){}function ub(){}function fc(){}function $a(){}function nb(){}function sc(G,ka,Ua,e,C,J){this.$=G;this.agaveCommandManager=J}function rd(G){var ka=Ai.call(this)||this;ka.ddaFacade=null;ka.jNf=null;ka.$=G;G.da.Ha(106,ka);ka.fc();return ka}function $b(){}function Wb(){}function lc(G){this.eFa=G}function Oa(G,ka,Ua){this.iframe=G;this.onSuccess=ka;this.onError=Ua;$addHandler(window,"message",Object(Pi.a)(this,this.h7e,
"handleResponse"))}function qb(G,ka){return Df.a.Ctd(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},Bf.AFrameworkApplication.ga.Bd("MaxRetriesForLoadingScript",0),G,ka)}function Ub(G){var ka=Ej.call(this)||this;ka.$=G;ka.fc();return ka}function jc(G,ka){var Ua=this;this.RPa=this.SPa=null;this.uag=function(e,C){var J=null,ja=null,Aa=null;C?(Object(vh.a)(222,C)?(J=C.RFa,Aa=C.instanceId):Object(vh.a)(387,C)&&(J=C.get_element(),Aa=C.instanceId),J)?(ja=Object(Ci.a)(711,
e),ja)?Ua.kNf(Aa,J,ja)||Aa in Ua.RPa||(Ua.SPa[Aa]=0,Ua.RPa[Aa]=Ri.a.instance.mC(function(){10<=Ua.SPa[Aa]||Ua.kNf(Aa,J,ja)?(delete Ua.SPa[Aa],Ua.RPa[Aa].dispose(),delete Ua.RPa[Aa]):Ua.SPa[Aa]+=1},500,Si.a.KIg,!0,!1)):Te.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Te.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):Te.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};
this.ariaLiveNotifier=G;this.$=ka;this.qXc=!1;this.$.da.Ha(224,this)}function Kb(G){var ka=$g.call(this)||this;ka.$=G;ka.fc();return ka}function dc(G){var ka=Ki.call(this,G)||this;ka.handler=null;ka.Lzg=function(){Te.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",ka.$.isEditMode,!!(ka.$.Jd&16384));var Ua=new Nj.a;ka.$.da.Za(53,function(Mc){Te.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Ua.setResult(Mc)});var e=Ua.task,C=new Ac,J=Tk.a.getInstance(),ja=new Ed(ka.$,J),Aa=aj.GetServiceTaskFactory.create(ka.$.da,203,ka.ma,ka.ub),gb=ka.a9i(C),bc=aj.GetServiceTaskFactory.Wa(ka.$.da,349,350,ka.ub);return Fh.TaskExtensions.Ba(Fh.TaskExtensions.we([e,Aa,gb,bc],ka.ma),function(){Te.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.create(ka.$.da,106,ka.ma,ka.ub),function(Mc){ka.handler=
new O(ka.$,Mc.result,C,new Se,J,ja,oi.a.instance.Nh("Common.IExternalUICommandDefinitionMapping"));Te.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");ka.Gd([ka.handler]);ka.$.da.Ha(198,ka.handler)},ka.ma,3)},ka.ma,3)};ka.Ybh=function(){void 0!==ka.handler&&null!==ka.handler?(ka.$.Ka.Mab(ka.handler),ka.$.da.JU(198),ka.handler=null):Te.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
ka.$.da.JU(204);Oi.a(Ni.a,21,ka.$.da,198)};return ka}function Qb(G,ka,Ua,e){this.mQd=void 0===G?null:G;this.mTc=void 0===ka?null:ka;this.I5c=void 0===Ua?null:Ua;this.V8b=void 0===e?0:e}function O(G,ka,Ua,e,C,J,ja){var Aa=this;ja=void 0===ja?null:ja;this.disposed=!1;this.Ma=new gk.a;this.zIj=3E5;this.YQd=!0;this.BVc="addinActivated";this.GHi=function(gb,bc){if(bc)if(bc)if(gb=bc.gi){bc=bc.Ao;var Mc=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(gb.assetId in Mc)bc=Mc[gb.assetId];
else if(bc=Aa.tNh(bc),void 0===bc||null===bc){Te.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Mc=new Wf.a(se.a.x2,0,0,2,null);var Hc={};Aa.executeCommand(0,Mc,(Hc.SourceControlId=bc,Hc),null);gb.isAutoLaunched=!0}else Te.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else Te.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else Te.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.ZOi=function(gb,bc){gb=null;
bc&&(gb=bc);(null===gb||void 0===gb?0:gb.Ao)&&Aa.Ktj(gb.Ao);Aa.$.If();dg.EwaSettings.la(88)&&gb&&gb.gi&&Aa.pNg(gb.gi)};this.$=G;Te.ULS.shipAssertTag(537170659,0,!(void 0===ka||null===ka),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",Ii.a.r3());this.Xe=ka;this.gCe=Ua;this.iZb=e;this.$ga=C;this.znb=J;this.$n=new lg.a;this.Zga=new Fc;this.U$c=ja;Hk.a.axb=Hk.a.KRe;this.S5c=new sh.a;this.o1a=new sh.a}function Ba(G){var ka=this;this.HFa=this.LFa=this.gi=this.Ao=
null;this.Urc=0;this.YOi=function(){if(ka.gi&&ka.HFa){var Ua=new Wf.a(se.a.x2,0,0,2,null),e={};ka.addinUICommandHandler.executeCommand(0,Ua,(e.SourceControlId=ka.HFa,e),null);Te.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.EAj=function(Ua,e){Ua=null;if(e)if(Ua=e,ka.gi=Ua.gi,ka.Ao=Ua.Ao,ka.Ao&&ka.Ao.mW&&ka.Ao.mW.Mr&&(ka.LFa=ka.Ao.mW.Mr.oa(0)),ka.LFa&&ka.LFa.id)if(ka.LFa.isOfficeTab)if(e=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),
ka.gi.assetId in e?ka.HFa=e[ka.gi.assetId]:(Te.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(ka.gi.storeType,ka.gi.storeId,ka.gi.assetId)),ka.HFa=ka.MJh(ka.Ao)),ka.HFa)if(Hj.a.contains(ka.LFa.id,Fi.a.FW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Rc.a.eub(ka.Ao),function(){ka.Z4f(ka.rgd(ka.HFa))});else{if(e=ka.$.Ka)e.Loe(ka.tEf),Te.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Te.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),e={},e=(e.AppTeachingUICalloutAction="NoEnabledButtonFound",e["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ka.gi.storeType,ka.gi.storeId,ka.gi.assetId),e.AppTeachingUICalloutGoal="NewAdminDeployment",e["SDX.AppInstallOrigin"]="Organization",e),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(e)}));else ka.a5f(ka.rgd(ka.LFa.id),0);else Te.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
e={},e=(e.AppTeachingUICalloutAction="NoTabFound",e["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ka.gi.storeType,ka.gi.storeId,ka.gi.assetId),e.AppTeachingUICalloutGoal="NewAdminDeployment",e["SDX.AppInstallOrigin"]="Organization",e),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(e)}))};this.tEf=function(){if(Hj.a.contains(ka.LFa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ua=ka.$.Ka;Ua&&Ua.CRf(ka.tEf);ka.Z4f(ka.rgd(ka.HFa))}};
this.$=G.$;this.addinUICommandHandler=G;this.$n=new lg.a}function ra(G,ka){this.hEa=G;this.Vea=new Jc;this.efa=new Mb(ka)}function ta(G,ka,Ua,e,C,J){G=cb.call(this,G,ka)||this;G.z8=null;G.hfa=null;G.kfa=null;G.efa=Ua;G.Spg=e;G.SEc=C;G.hpa=J;return G}function Fa(G){this.$fe=null;if(vi.c(G))throw Te.ULS.sendTraceTag(9041813,220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");this.Evg=G}function cb(G,ka){this.fie=new sh.a;
this.Sw=this.Av=null;this.$jb=G;this.Vea=ka}function Wa(G){this.age=this.j7d=this.bie=null;this.isOfficeTab=!1;this.X5e=this.CWf=null;this._id=G;this.MSa[Pc.a.id]=this._id}function mb(G){this.$3d=this.i7d=this.Tlb=null;if(vi.c(G))throw Te.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),Error.create("GroupDefinition id should not be null or undefined");this._id=G;this.Gva[Pc.a.id]=this._id}function kc(G,ka,Ua,e,C,J){this.DPb=new sh.a;this.z8=this.Sw=this.Av=null;
this.$jb=G;this.Vea=ka;this.efa=Ua;this.Hs=e;this.hpa=C;this.d6d=J}function Ab(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Tb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function ib(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function Sa(){this.iconLocation=this.title=this.id=null;this.enabled=!1;
this.controlType=0;this.attributes=this.menuItems=null}function Mb(G){this.ECa=G}function Jc(){}function Ib(G,ka){this.Tlb=new Nb(G,ka)}function Nb(G,ka){this.Hxg=G;this.lng=ka}function sa(G){this.hEa=G}function Va(G,ka,Ua){this.dJ=this.jVa=null;this.$jb=G;this.efa=ka;this.Vea=Ua;this.Fsg=new sh.a}function Xb(G){this.y8=null;if(vi.c(G))throw Te.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");
this._id=G}function mc(G){this.ZMc=null;if(vi.c(G))throw Te.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=G;this.CR[Pc.a.id]=this._id}function od(G,ka){this.Qfa=this.Z3d=null;if(vi.c(G)||vi.c(ka))throw Te.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.a4d=ka;this._id=G;this.zA[Pc.a.id]=this._id}function ld(G,ka,Ua,e,C,J,ja,Aa){Aa=void 0===Aa?null:Aa;this.rb=new Wj.a;this.zUa=G;this.Y3d=ka;this.Om=Ua;this.OWb=e;this.Zqa=C;this.Fkg=J;this.hpa=ja;this.Dce=Aa;this.EDa=Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1);this.cWa=Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1);this.$qg=Bf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}
function Zc(G,ka,Ua,e,C,J,ja){this.CSa=new Cj.a;this.hs=G;this.Ii=ka;this.$n=Ua;this.ribbonManager=e;this.contextMenuManager=C;this.XF=J;this.Zga=ja;this.IO=Bf.AFrameworkApplication.sa.vD}function Rb(G,ka,Ua){this.p1d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=G;this.eventBuilder=ka;this.contextMenuBuilder=Ua}function fd(G){this.pog=G.entitlement}function wd(G,ka,Ua,e,C){ka=void 0===ka?null:ka;Ua=void 0===Ua?null:Ua;
e=void 0===e?null:e;C=void 0===C?0:C;if(vi.c(G)&&vi.c(ka))throw Te.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");this.iY=G;this.rtg=ka;this.Pwg=Ua;this.nkb=e;this.rpg=C}function Ad(G){this.yce=null;if(vi.c(G))throw Te.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),
Error.create("The agave key should not be null or undefined");this.Nkg=G}function Ne(){}function Ve(){}function Kd(G){this.x$d=null;this.s8d=G}function Ud(G,ka,Ua){this.rb=G;this.S8=ka;this.ngb=Ua}function te(G,ka,Ua,e,C,J,ja){this.hs=G;this.gi=ka;this.o0=Ua;this.VVe=e;this.cGh=C;this.displayName=J;this.Ujf=ja}function oe(){var G=ed.call(this)||this;G.gi=null;G.Ao=null;return G}function Ke(){new cc(dd.a.instance)}function cc(G){this.TDa=G}function sd(){this.Ver=1}function zc(){}function nd(G){this.ytg=
G}function rb(G,ka,Ua){this.Ma=new Wj.a;this.context=new qf;this.bXc=this.Yga=this.yda=this.GPb=null;this.contextActivationMgr=G;this.UHg=ka;this.jZb=Ua;this.appName=Bf.AFrameworkApplication.ga.Ua("WebAppShortName")}function Zd(G){var ka=Gc.call(this)||this;ka.solutionId=G.solutionId;ka.assetId=G.assetId;ka.storeType=G.storeType;ka.storeId=G.storeId;ka.assetStoreId=G.assetStoreId;ka.targetType=G.targetType;ka.width=G.width;ka.height=G.height;ka.displayName=G.displayName;ka.version=G.version;return ka}
function qc(){this.addinId=null;this.targetType=0;this.assetId=null}function pd(G,ka,Ua,e){this.ZHb=Bf.AFrameworkApplication.ga.Ua("RoamingServiceHandlerWebServiceBase");this.appName=G;this.xib=ka;this.tib=Ua;this.Hkb=void 0===e?null:e}function ne(G){var ka=Yb.call(this)||this;ka.properties=G;return ka}function be(){this.jA=this.iq=null;this._count=0}function td(G,ka,Ua){this.next=Ua;this.previous=ka;this.data=G}function Qe(G){this.Jr=null;this.bA=G}function Qf(G){var ka=-1;switch(G.toLowerCase()){case "omex":ka=
0;break;case "spcatalog":ka=1;break;case "spapp":ka=2;break;case "filesystem":ka=3;break;case "exchange":ka=4;break;case "registry":ka=6;break;case "inmemory":ka=7;break;case "uploadfiledevcatalog":ka=8;break;case "hardcodedpreinstall":ka=9;break;case "excatalog":ka=10;break;case "wopicatalog":ka=16}return ka}function pf(G){var ka=null;switch(G){case 0:ka="omex";break;case 1:ka="spcatalog";break;case 2:ka="spapp";break;case 3:ka="filesystem";break;case 4:ka="exchange";break;case 6:ka="registry";break;
case 7:ka="inmemory";break;case 8:ka="uploadfiledevcatalog";break;case 9:ka="hardcodedpreinstall";break;case 10:ka="excatalog";break;case 16:ka="wopicatalog"}return ka}function $d(G){var ka={};ka.solutionId=G.solutionId;ka.version=G.version;ka.storeType=G.storeType;ka.storeId=G.storeId;ka.assetId=G.assetId;ka.assetStoreId=G.storeType;ka.targetType=G.targetType;ka.requireConsent=G.requireConsent||!1;ka.isAddinCommands=!0;ka.id=G.solutionId;ka.appVersion=G.version;ka.currentStoreType=G.storeType;return ka}
function je(){return wa.a.u4(window.location.href.toLowerCase(),"wdtpl")}function md(){var G=wa.a.u4(window.location.href.toLowerCase(),"wdomexsrctype");return!!G&&"4"===G}function ee(){}function qf(){this.hs=this.X_=0;this.CVc=null;this.vqc=this.bAc=0;this.n0a=this.kja=this.N9=null}function Fc(){this.JYa=null}function Ed(G,ka){var Ua=kk.call(this)||this;Ua.statusBarManager=null;Ua.agaveCommandManager=null;Ua.fze=function(){Ua.XF&&Ua.XF.Oye()};Ua.a6e=function(){Ua.raiseEvent("LAC")};Ua.dd=function(e,
C){!e.rc&&zk.b(C)&&Ua.statusBarManager&&(Ua.statusBarManager.PF(Ua),Ua.statusBarManager=null)};Ua.XF=ka;Ua.$=G;Ua.VGj=G.Jb+"OfficeAddinLabel-Medium14";Ua.$.da.Za(29,function(e){Ua.statusBarManager=e;e.vJ(Ua)});Ua.$.ea.Tj(Ua.dd);Ua.XF.RDg(Ua.a6e);Ua.$.da.Za(206,function(e){Ua.agaveCommandManager=e;e.vFg(Ua.fze)});return Ua}function Sd(){}function qd(){this.Di=null;this.visible=!1}function ke(G,ka){this.Sa=G;this.s2g=ka}function Se(){this.U1d=this.XDc=null}function of(G){this.rfe=new vc(G)}function vc(G){this.p9=
G;this.mVb=this.p9.ribbonBuilder}function id(){var G=Jj.call(this)||this;G.$ld=null;G.Gld=null;G.ribbon=null;return G}function Ac(){this.hmg=new sh.a}function Yd(){}function Cd(G){return Dk.call(this,G)||this}function wf(G,ka,Ua){this.yrb=null;this.$=G;ka?(Te.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.yrb=new cl.a(G,ka,Ua)):Te.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}
function Vb(G){var ka=hl.call(this)||this;ka.$=G;ka.fc();return ka}function wc(G,ka){var Ua=Tc.call(this)||this;Ua.$=G;Ua.Mta=new DOMParser;Ua.cache=new $i.a;Ua.indexedDB=ka;ka.rg()&&Ua.indexedDB.initialize("Scripts","OfficeScriptingCache");Ua.O4=!1;Ua.Gm=new Dd([],function(e){Tc.W5f(e)});Ua.hg=new Dd([],function(e){Tc.nLb(e)});Ua.yr=new Dd([],function(e){Tc.nLb(e)});Ua.Jk=new Dd([],function(){});return Ua}function yb(G,ka,Ua,e){var C=this;this.V6a=!1;this.d9a=function(){C.N2f()?(C.KIf(),Qi.g(C.$).Ca.QId(C.d9a)):
C.V6a&&Qi.g(C.$).Ca.QId(C.d9a)};this.GJi=function(J,ja){Object.getType(ja)===String&&ja.toString().endsWith($c.a.zvb(C.$))&&(C.V6a=!1)};this.$=G;this.gsa=ka;this.Ov=Ua;this.businessBarManager=e;this.fwj()}function oc(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.xMb=this.Yaa=this.Mj=null;this.isFirstPartyOptOutAppContextOptmization=!1}function Wc(G,ka,Ua,e,C,J,ja,Aa,gb){var bc=this;this.nA=null;this.cache=new $i.a;this.t7d=this.Jee=this.Lee=this.Iee=this.Kee=this.Hee=this.Iwa=!1;this.fee=this.Sfe=
this.Oce=this.pee=null;this.QFa={};this.$=G;this.EPc=Ua;this.indexedDB=e;this.zob=C;this.Ov=J;this.gsa=ja;this.Le=Aa;this.SP=$c.a.Iq?gb:new ce(G,this);this.tNg=new Jd(this,G);this.Cqg=zh.a.Ra.Lb;this.n7f="";this.O4=!1;this.Lvj(new Dd([],function(Mc){Tc.W5f(Mc)}));this.Kvj(new Dd([],function(Mc){Tc.nLb(Mc)}));this.Ovj(new Dd([],function(Mc){Tc.nLb(Mc)}));this.Mvj(new Dd([],function(){}));e.rg()&&(this.Iwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));G=!0;if(dj.a.Kue){this.cache.rg()&&
(ka=this.wdd($c.a.S$b(this.$)),ka.isSuccess&&(G=ni.getElapsedSeconds(ka.timeStamp,zh.a.Ra.Lb),this.Ov.Ux=new yf(!0,!0),this.nA=new yf(ka.value,!0),G=this.nA.value?604800<G:86400<G,this.zwb=this.EKb(!0)));this.bpi=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery");this.RJh();if("undefined"!==typeof makerstorage&&this.Pif)if(this.n7f=Xe(this.$),Cc(this.$))ob(this.$,"localstorageToken"),this.Ov.Ux=new yf(!0,!0),this.nA=new yf(!0,!0),this.zwb=this.EKb(!0);
else if((ka=$c.a.F0e())&&makerstorage.setStorageEnvironmentOverride(ka),G)try{this.zwb=this.Ov.xye().then(function(){return bc.gsa.gbc()}).then(function(Mc){return bc.c6h(Mc)}).then(function(){return bc.EKb(!1)}).catch(function(){return bc.EKb(!1)})}catch(Mc){Te.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",Mc.message),this.zwb=Promise.resolve(!1)}dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&
this.zwb?this.zwb.then(function(Mc){return bc.bKd(Mc)}):this.bKd(!1)}else Te.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.bKd(!1)}function Qd(G,ka,Ua,e,C,J){this.actionName=G;this.shapeId=ka;this.scriptLink=Ua;this.clickId=e;this.Bba=C;this.buttonText=J}function Sc(G,ka,Ua,e){this.rkd=G;this.Qzh=ka;this.Oya=Ua;this.eHa=e}function Yc(G){return yi.a.Ld(G)?af.a.LOe:af.a.KOe}function pc(G){return yi.a.Ld(G)?
G.isChromeRtl?af.a.Psh:af.a.Osh:af.a.e2a}function Be(G){G=G.na.ta.Na(1);G.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return G}function Ce(G,ka,Ua,e,C){function J(){function Hc(yd,we,$e){return hj.i(Aa.ta,"ExecuteRichApiRequest",e,Rh.b(yd,ka),Rh.a(we,Ua),$e,null,0)}if(ja.kHa()||0<Aa.ta.g4||0<Aa.Ck.g4)return!1;gb&&ja.jv(gb);bc&&
Aa.xr(bc);Mc&&Aa.Dz(Mc);dg.EwaSettings.tc()?ja.Mt(new ok.a(507,0,Hc,80)):ja.Mt(new nk.a(507,0,Hc,16));return!0}var ja=G.userOperationManager,Aa=G.na,gb=null,bc=null,Mc=null;J()||(gb=function(){J()},bc=function(){J()},Mc=function(){J()},ja.kx(gb),Aa.tq(bc),Aa.Jy(Mc));return C.task}function Xe(G){if(Cc(G))return dg.EwaSettings.getBooleanFeatureGate($c.a.BBb,!1)?"makerservicelocal":"localstorage";G=$c.a.F0e();return $c.a.OZh(G)}function ob(G,ka){Cc(G)&&(dg.EwaSettings.getBooleanFeatureGate($c.a.BBb,
!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(G.ya.UserSessionId);makerstorage.setUserAccessInfo(new Uc(ka,null));dg.EwaSettings.getBooleanFeatureGate($c.a.nfg,!1)&&makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function Ic(G,ka){ka.WacTaskPaneInfra=yi.a.Ld(G);ka.UseV1ServiceURLs=dg.EwaSettings.getBooleanFeatureGate($c.a.nfg,!1);ka.TaskpanelessRFB=dg.EwaSettings.getBooleanFeatureGate($c.a.c9f,!1);ka.OfficeScriptsAutomateTask=
$c.a.Nyd}function Cc(G){return"TestHost"===G.ya.DocumentHostInfo.HostTier}function Uc(G,ka){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=G;this.currentUserMlapiToken=ka}function Tc(){this.Jk=null;this.O4=this.R6=this.kt=this.Q6=this.vza=this.rab=this.GGd=this.Tca=this.Ova=!1;this.yr=this.hg=this.Gm=null}function ce(G,ka){this.jy=null;this.$=G;this.automateCommandManager=ka;return this}function ye(){}function Kf(){this.Ux=null;return this}function yf(G,ka,Ua,e,C){this.value=
G;this.isSuccess=ka;this.timeStamp=void 0===Ua?null:Ua;this.errorCode=void 0===e?"":e;this.errorMessage=void 0===C?"":C}function Pf(){this.Ux=null}function ec(G,ka){this.jy=null;this.$=G;this.Le=ka;return this}function Qc(G){this.H$=Kg.b(G)||{};this.shareId=this.shareId||null}function Dd(G,ka){this.scripts=G;this.V5f=ka}function Jd(G,ka){this.automateCommandManager=G;this.$=ka}function ze(){this.jy=null}function ie(G,ka,Ua){this.$=G;this.oAuthManager=ka;this.Ov=Ua;this.uob=new jf;this.ete=this.oAuthManager&&
null==this.oAuthManager.LLa()?!1:this.oAuthManager.LLa()}function jf(){this.token=null;this.timeStamp=0}function mf(G){return jk.call(this,G)||this}function vf(G,ka){this.automateCommandManager=G;this.$=ka}function rg(G){var ka=gj.call(this)||this;ka.$=G;ka.fc();return ka}function he(G){this.Fb=null;this.$=G}function eg(){return R.call(this)||this}function tg(){return R.call(this)||this}function Wd(){return R.call(this)||this}function Mf(){return R.call(this)||this}function Rd(){return R.call(this)||
this}function Ze(){return R.call(this)||this}function Xf(){return R.call(this)||this}function bg(){return R.call(this)||this}function mg(){return R.call(this)||this}function xf(){return R.call(this)||this}function ig(){return R.call(this)||this}function wh(){return R.call(this)||this}function La(){return R.call(this)||this}function Eb(){return R.call(this)||this}function uc(){return R.call(this)||this}function Vc(){return R.call(this)||this}function xd(){return R.call(this)||this}function Od(){return R.call(this)||
this}function re(){return R.call(this)||this}function Zb(){return R.call(this)||this}function Nc(){return R.call(this)||this}function cd(){return R.call(this)||this}function Xd(){return R.call(this)||this}function Le(){return R.call(this)||this}function le(){return R.call(this)||this}function zf(){return R.call(this)||this}function bf(){return R.call(this)||this}function Lf(){return R.call(this)||this}function hf(){return R.call(this)||this}function pg(){return R.call(this)||this}function df(){return R.call(this)||
this}function Uf(){return R.call(this)||this}function Re(){return R.call(this)||this}function Je(){return R.call(this)||this}function qg(){return R.call(this)||this}function Xg(){return R.call(this)||this}function Lh(){return R.call(this)||this}function cg(){return R.call(this)||this}function Lg(){return R.call(this)||this}function Da(){return R.call(this)||this}function Fb(){return R.call(this)||this}function Oc(){return R.call(this)||this}function kd(){return R.call(this)||this}function Ld(){return R.call(this)||
this}function De(){return R.call(this)||this}function Ge(){return R.call(this)||this}function lf(){return R.call(this)||this}function Ka(){return R.call(this)||this}function bb(){return R.call(this)||this}function ac(){return R.call(this)||this}function Bc(){return R.call(this)||this}function Lc(){return R.call(this)||this}function Cb(){return R.call(this)||this}function nc(){return R.call(this)||this}function Td(){return R.call(this)||this}function Me(){return R.call(this)||this}function ge(){return R.call(this)||
this}function Ef(){return If.call(this,195,16)||this}function He(){return If.call(this,194,8)||this}function Of(){return R.call(this)||this}function Md(){return If.call(this,198,2)||this}function cf(){return If.call(this,197,1)||this}function Gd(){return If.call(this,196,32)||this}function pe(){return R.call(this)||this}function jg(){return If.call(this,193,4)||this}function If(G,ka){var Ua=R.call(this)||this;Ua.vfa=G;Ua.jZd=ka;return Ua}function ud(){return R.call(this)||this}function uf(){return R.call(this)||
this}function Hh(){return R.call(this)||this}function Sf(){return R.call(this)||this}function Zg(){return R.call(this)||this}function Pd(){return R.call(this)||this}function jh(){return tb.call(this,11,16)||this}function ci(){return tb.call(this,10,128)||this}function dh(){return R.call(this)||this}function xe(){return R.call(this)||this}function Ag(){return R.call(this)||this}function Jf(){return R.call(this)||this}function Oe(){return R.call(this)||this}function $h(){return R.call(this)||this}function kh(){return R.call(this)||
this}function Tf(){return R.call(this)||this}function ki(){return R.call(this)||this}function Mh(){return tb.call(this,9,2)||this}function Nh(){return tb.call(this,8,1)||this}function ph(){return tb.call(this,7,8)||this}function gh(){return tb.call(this,6,32)||this}function eh(){return R.call(this)||this}function Uh(){return R.call(this)||this}function xh(){return R.call(this)||this}function Wg(){return R.call(this)||this}function Og(){return R.call(this)||this}function di(){return R.call(this)||
this}function Ph(){return R.call(this)||this}function Fg(){return R.call(this)||this}function ei(){return R.call(this)||this}function Dh(){return R.call(this)||this}function Sg(){return R.call(this)||this}function wg(){return R.call(this)||this}function yh(){return R.call(this)||this}function bh(){return R.call(this)||this}function Cg(){return tb.call(this,4,64)||this}function uh(){return R.call(this)||this}function fg(){return R.call(this)||this}function Qh(){return R.call(this)||this}function ii(){return R.call(this)||
this}function kg(){return R.call(this)||this}function mi(){return R.call(this)||this}function Yh(){return R.call(this)||this}function og(){}function Ca(){return R.call(this)||this}function ua(){return tb.call(this,3,4)||this}function tb(G,ka){var Ua=R.call(this)||this;Ua.vfa=G;Ua.jZd=ka;return Ua}function Nd(){return R.call(this)||this}function me(){return R.call(this)||this}function sf(){return R.call(this)||this}function sg(){return R.call(this)||this}function Ff(){return E.call(this,185,18)||this}
function xg(){return R.call(this)||this}function yg(){return E.call(this,181,14)||this}function hh(){return E.call(this,169,2)||this}function nh(){return E.call(this,168,1)||this}function Ng(){return R.call(this)||this}function ue(){return E.call(this,182,15)||this}function Bg(){return R.call(this)||this}function ng(){return R.call(this)||this}function mh(){return E.call(this,180,13)||this}function gg(){return E.call(this,186,19)||this}function ai(){return E.call(this,175,8)||this}function ih(){return E.call(this,
176,9)||this}function rf(){return E.call(this,187,20)||this}function Rf(){return E.call(this,174,7)||this}function ch(){return E.call(this,179,12)||this}function vg(){return E.call(this,178,11)||this}function oh(){return E.call(this,177,10)||this}function h(){return R.call(this)||this}function Bb(){return E.call(this,170,3)||this}function tc(){return E.call(this,172,5)||this}function X(){return E.call(this,173,6)||this}function va(){return E.call(this,183,16)||this}function P(){return E.call(this,
184,17)||this}function k(){return E.call(this,171,4)||this}function E(G,ka){var Ua=R.call(this)||this;Ua.vfa=G;Ua.opType=ka;return Ua}function L(){return R.call(this)||this}function aa(){return R.call(this)||this}function na(){return R.call(this)||this}function sb(){return R.call(this)||this}function Lb(){return R.call(this)||this}function Kc(){return R.call(this)||this}function ad(){return R.call(this)||this}function ha(){return R.call(this)||this}function Qa(){return R.call(this)||this}function Pb(){return R.call(this)||
this}function rc(){return R.call(this)||this}function gd(){return R.call(this)||this}function hd(){return R.call(this)||this}function Bd(){return R.call(this)||this}function qe(){return R.call(this)||this}function ef(){return R.call(this)||this}function nf(){return R.call(this)||this}function kf(){return R.call(this)||this}function Af(){return R.call(this)||this}function Jg(){return R.call(this)||this}function fh(){return R.call(this)||this}function Oh(){return We.call(this)||this}function Qg(){return R.call(this)||
this}function fi(){return R.call(this)||this}function Dg(){return R.call(this)||this}function lh(){return R.call(this)||this}function zg(){return R.call(this)||this}function Ah(){return R.call(this)||this}function Ui(){return R.call(this)||this}function xi(){return R.call(this)||this}function Y(){return R.call(this)||this}function Ra(){return Cf.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,
-220,-129,-130,-131])||this}function zb(){return Cf.call(this,79,[0,1,2,-102])||this}function gc(){return Cf.call(this,75,[-101])||this}function bd(){return Cf.call(this,81,[100,101,102,103,104,105,106])||this}function Id(){return R.call(this)||this}function Vd(){return Cf.call(this,85,[328,329,330,331,332,333,334,335])||this}function ve(){return We.call(this)||this}function Pe(G,ka,Ua){this.response=this.request=this.eventId=this.source=null;G&&(this.source=G.source,this.eventId=G.eventId,this.request=
ka,this.response=Ua)}function We(){return R.call(this)||this}function Vf(){return Cf.call(this,83,[500,501,502])||this}function $f(){return Cf.call(this,76,[-100])||this}function Hg(){return Cf.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Tg(){return Cf.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function Bi(){return Cf.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Cf(G,ka){var Ua=R.call(this)||
this;Ua.vfa=G;Ua.kWj=ka;return Ua}function Ih(){return R.call(this)||this}function Eh(){return R.call(this)||this}function Gg(){return R.call(this)||this}function ti(){return R.call(this)||this}function R(){this.WHc=this.XHc=this.XNc=this.ASc=null}function za(G,ka,Ua){var e=this;this.A9b=null;this.nyi=function(C,J){e.O2f()&&e.Yad(J)};this.ppf=ka;this.opf=Ua;this.$=G;this.$.vba&&this.$.lGg(this.nyi);G.da.Ha(297,this)}function jb(){}function Jb(){}function Dc(){this.xgb=null}function ic(){this.tb=null}
function Hd(G){this._initialized=!1;this.f$a={};this.Byc={};this.IO=Bf.AFrameworkApplication.sa.vD;this.qkd=G}function fe(G,ka,Ua){this.expiration=this.authority=this.accessToken=null;this.accessToken=G;this.authority=ka;this.expiration=Ua}function tf(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function hg(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}function Yf(){}function qh(G,ka){this.requestCallback=this.requestParameters=null;this.requestParameters=G;this.requestCallback=ka}function gi(){}b.r(F);var Vi=b(516),dk=b(1088),de=b(0),Te=b(13),Pi=b(80),Mj;(function(G){G[G.generalException=0]="generalException";G[G.invalidArgument=1]="invalidArgument";G[G.notAllowed=2]="notAllowed";G[G.apiNotAvailable=3]="apiNotAvailable";G[G.unresolvedPendingRequest=
4]="unresolvedPendingRequest";G[G.timeout=5]="timeout";G[G.adalTimeout=6]="adalTimeout";G[G.userNotSignedIn=7]="userNotSignedIn";G[G.userAborted=8]="userAborted";G[G.silentSignInFailed=9]="silentSignInFailed";G[G.invalidResourceUrl=10]="invalidResourceUrl";G[G.invalidGrant=11]="invalidGrant";G[G.connectionLost=12]="connectionLost";G[G.clientError=13]="clientError";G[G.serverError=14]="serverError"})(Mj||(Mj={}));Object(de.b)("ErrorCodes",Mj);gi.GFf="OneDriveWOPI";Object(de.a)(gi,"HostApplicationType",
null,[]);Object(de.a)(qh,"OutstandingRequest",null,[]);Yf.mEi="AADSTS50058";Yf.invalidResourceUrl="AADSTS50001";Yf.gEi="AADSTS65001";Yf.yEi="AADSTS70011";Yf.userAborted="13002";Yf.Y_i="Popup Window is null";Yf.X_i="Popup Window closed";Yf.adalTimeout="Token renewal operation failed due to timeout";Yf.gMj="tokenRevoked";Object(de.a)(Yf,"WopiHostErrorType",null,[]);var Bf=b(5),wj=b(857),Bh=b(592),Vh=b(40);hg.DKh=function(G){switch(G){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};
Object(de.a)(hg,"WopiAuthContext",null,[131]);Object(de.a)(tf,"WopiIdentityInfo",null,[130]);Object(de.a)(fe,"WopiIdentityToken",null,[129]);var dj=b(23),Zh=b(151),Wi=b(373),Tj=b(170),Ue=b(75),qi=b(337);Hd.prototype.R1a=function(G){this._initialized||(G.Xn(Tj.a.yIf),G.Jl(Tj.a.yIf,Object(Pi.a)(this,this.xRi,"onReceivedAccessToken")),this._initialized=!0)};Hd.prototype.getAccessToken=function(G,ka,Ua){var e=this;Ua=void 0===Ua?null:Ua;this.CNa(G,ka);return new Promise(function(C,J){if(e.Imd(ka))if(ka in
e.f$a)J("unresolvedPendingRequest");else{var ja=window.setTimeout(function(){var gb={};Te.ULS.sendTraceTag(37856032,344,10,Vh.c((gb.error="Request timeout.",gb.callerId=ka,gb)));J("timeout")},12E4);e.Ucd(G,ka,Ua,function(gb,bc){window.clearTimeout(ja);gb?C(gb):(gb={},Te.ULS.sendTraceTag(37856033,369,15,Vh.c((gb.error=Mj[bc],gb))),J(bc))})}else{var Aa={};Te.ULS.sendTraceTag(37856034,344,10,Vh.c((Aa.error="Caller is not allowed.",Aa)));J("notAllowed")}})};Hd.prototype.getPrimaryIdentityInfo=function(G){var ka=
this;return new Promise(function(Ua,e){if(ka.Imd(G))ka.rWh(function(J,ja){J?Ua(J):(J={},Te.ULS.sendTraceTag(37856064,369,10,Vh.c((J.error=ja.toString(),J))),e(ja))});else{var C={};Te.ULS.sendTraceTag(37856065,344,10,Vh.c((C.error="Caller is not allowed.",C)));e("notAllowed")}})};Hd.prototype.getAuthContext=function(G){var ka=this;return new Promise(function(Ua,e){var C=ka.getAuthContextSync(G);C?Ua(C):e("notAllowed")})};Hd.prototype.getAuthContextSync=function(G){if(this.Imd(G)){var ka=new hg;ka.upn=
Bf.AFrameworkApplication.ga.Ua("UserPrincipalName");ka.userId=Bf.AFrameworkApplication.ga.Ua("LoggableUserId");ka.authority=Bf.AFrameworkApplication.ga.Ua("HostAuthAuthority");ka.tenantId=Bf.AFrameworkApplication.ga.Ua("TenantId");ka.isAnonymous=Bf.AFrameworkApplication.ga.ra("IsAnonymousUser");ka.supportsAuthToken=this.E8h(G);G=Bf.AFrameworkApplication.ga.Ua("HostAuthType");ka.authorityType="aad"===G.toLowerCase()?2:"msa"===G.toLowerCase()?1:0;return ka}ka={};Te.ULS.sendTraceTag(40751647,344,10,
Vh.c((ka.error="Caller is not allowed.",ka)));return null};Hd.prototype.E8h=function(G){var ka=wj.a.bxb;return dj.a.Wka?ka&&wj.a.h9f?Array.contains(wj.a.h9f,G.toLowerCase()):!1:ka};Hd.prototype.Ucd=function(G,ka,Ua,e){var C=this,J=[];Array.add(J,Object.assign(new Ue.a,{name:"CallerId",string:ka}));Array.add(J,Object.assign(new Ue.a,{name:Wi.a.aTd,string:G.correlationId}));Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:J}));
J=Bh.a.create().toString();var ja="getAccessToken_"+J,Aa=this.IO.Ic("ComponentAttach",ja);this.Byc[ja]=Aa;var gb={};gb[Wi.a.bTd]=J;gb[Wi.a.IFj]=G.resource;gb[Wi.a.JFj]=G.scope;gb[Wi.a.l6f]=Bf.AFrameworkApplication.ga.Ua("HostAuthType");gb[Wi.a.MFj]=Bf.AFrameworkApplication.ga.Ua("UserPrincipalName");gb[Wi.a.KFj]=G.silentLogin;gb[Wi.a.FFj]=G.options;gb[Wi.a.aTd]=G.correlationId;gb[Wi.a.GFj]=ka;Ua&&(gb[Wi.a.addinName]=Ua.AddinName,gb[Wi.a.EFj]=Ua.AddinTrustId);this.qkd.execute(function(bc){C.R1a(bc);
bc.Rj(Tj.a.getAuthToken,gb)});this.f$a[J]=new qh(G,e)};Hd.prototype.rWh=function(G){var ka=Bf.AFrameworkApplication.ga.Ua("UserName"),Ua=Bf.AFrameworkApplication.ga.Ua("UserPrincipalName"),e=Bf.AFrameworkApplication.ga.Ua("LoggableUserIdSpace"),C=new tf;C.email=Ua;C.displayName=ka;switch(e){case "OrgIdPuid":C.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":C.authority="MicrosoftAccount";break;default:C.authority=e}G(C,null)};Hd.prototype.xRi=function(G){var ka=null;try{var Ua=
G.Values[Wi.a.bTd],e=G.Values[Wi.a.DFj],C=G.Values[Wi.a.l6f],J=G.Values[Wi.a.LFj],ja=null,Aa=null,gb=this.f$a[Ua];if("undefined"!==typeof gb&&gb){var bc=[];Array.add(bc,Object.assign(new Ue.a,{name:Wi.a.aTd,string:gb.requestParameters.correlationId}));Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:bc}));ka=gb.requestCallback;delete this.f$a[Ua];"undefined"!==typeof e&&e&&e.length?Aa=new fe(e,C,J):ja=Mj[this.fzi(G)];
Ua="getAccessToken_"+Ua;Ua in this.Byc&&(this.Byc[Ua].stop(),delete this.Byc[Ua]);ka(Aa,ja)}else ja={},Te.ULS.sendTraceTag(37856066,344,10,Vh.c((ja.error="No matching outstanding request for request ID.",ja.requestId=Ua,ja)))}catch(Mc){G=G.Values[Wi.a.bTd],G in this.f$a&&delete this.f$a[G],this.Gjc(),G={},Te.ULS.sendTraceTag(37856067,344,10,Vh.c((G.error=Mc.message,G.stack=Mc.stack,G))),ka&&ka(null,"generalException")}};Hd.prototype.Imd=function(G){var ka=Bf.AFrameworkApplication.c2h();G=G.toLowerCase();
ka=yl(ka);for(var Ua=ka.next();!Ua.done;Ua=ka.next())if(G===Ua.value.toLowerCase())return!0;ka=wj.a.nWc;for(var e in ka)if(G===ka[e].toLowerCase())return!0;return!1};Hd.prototype.fzi=function(G){G=G.Values[Wi.a.HFj];this.Gjc();var ka={};Te.ULS.sendTraceTag(39068821,344,15,Vh.c((ka.error=G,ka)));return G?-1<G.indexOf(Yf.mEi)?9:-1<G.indexOf(Yf.Y_i)||-1<G.indexOf(Yf.X_i)?12:-1<G.indexOf(Yf.invalidResourceUrl)?10:-1<G.indexOf(Yf.userAborted)?8:-1<G.indexOf(Yf.yEi)||-1<G.indexOf(Yf.gEi)||G===Yf.gMj?11:
-1<G.indexOf(Yf.adalTimeout)?6:0:13};Hd.prototype.CNa=function(G,ka){G=this.r8i(G.resource);var Ua={};Te.ULS.sendTraceTag(39921882,344,50,Vh.c((Ua.callerId=ka,Ua.resource=G,Ua)))};Hd.prototype.Gjc=function(){var G={};Te.ULS.sendTraceTag(39068822,344,50,Vh.c((G.userAgent=window.navigator.userAgent,G)))};Hd.prototype.r8i=function(G){return(G?G:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Object(de.a)(Hd,"WopiIdentityManager",null,[41]);var ej=b(273);ic.prototype.ii=
function(G){this.tb=G;G.register(Hd,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Cc().Mc(function(){return new Hd(G.pc("Postmessage.IHostPostmessenger"))})};ic.prototype.init=function(){Bf.AFrameworkApplication.ga&&Bf.AFrameworkApplication.ga.Tu(Object(Pi.a)(this,this.kB,"onFullAppSettingsReady"))};ic.prototype.kB=function(){try{this.tb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(G){Te.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+
G)}};ic.prototype.dispose=function(){};ic.main=function(){ej.a.instance.rj(new ic)};Qk.Object.defineProperties(ic.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});Object(de.a)(ic,"WopiIdentityPackage",null,[4,5]);var Yg=b(10),Ug=b(214),sh=b(185),xj=b(604);Dc.prototype.Yfi=function(G){return this.VNg.contains(G.operation)};Dc.prototype.FPj=function(G){for(var ka=[],Ua=yl(G.payload.batchedOperations),e=Ua.next();!e.done;e=Ua.next())ka.push(new xj.a(G.operation,
e.value));return ka};Qk.Object.defineProperties(Dc.prototype,{VNg:{configurable:!0,enumerable:!0,get:function(){this.xgb||(this.xgb=new sh.a,this.xgb.add(12),this.xgb.add(11));return this.xgb}}});Object(de.a)(Dc,"MacroRecorderBatchedEventList",null,[]);var fj=b(54),Uj=b(121),Qj=b(686);Jb.prototype.equals=function(G,ka){return G===ka};Jb.prototype.getHashCode=function(G){return G};Jb.prototype.zja=function(G){return G};Object(de.a)(Jb,"UserOperationNameComparer",null,[29,30]);jb.a2h=function(){jb.Qc||
(jb.Qc=new Qj.a(new Jb),jb.Qc.add(507),jb.Qc.add(10),jb.Qc.add(576),jb.Qc.add(563),jb.Qc.add(564),jb.Qc.add(565),jb.Qc.add(566),jb.Qc.add(567),jb.Qc.add(568),jb.Qc.add(569),jb.Qc.add(570),jb.Qc.add(571),jb.Qc.add(572),jb.Qc.add(573),jb.Qc.add(574),jb.Qc.add(575),jb.Qc.add(501),jb.Qc.add(520),jb.Qc.add(1),jb.Qc.add(1002),jb.Qc.add(129),jb.Qc.add(198),jb.Qc.add(500),jb.Qc.add(519),jb.Qc.add(538),jb.Qc.add(1E3),jb.Qc.add(1003),jb.Qc.add(144),jb.Qc.add(502),jb.Qc.add(505),jb.Qc.add(179),jb.Qc.add(205),
jb.Qc.add(134),jb.Qc.add(230),jb.Qc.add(103),jb.Qc.add(110),jb.Qc.add(112),jb.Qc.add(113),jb.Qc.add(124),jb.Qc.add(133),jb.Qc.add(154),jb.Qc.add(162),jb.Qc.add(168),jb.Qc.add(172),jb.Qc.add(201),jb.Qc.add(222),jb.Qc.add(227),jb.Qc.add(513),jb.Qc.add(534),jb.Qc.add(539),jb.Qc.add(545),jb.Qc.add(600),jb.Qc.add(547),jb.Qc.add(555),jb.Qc.add(558),jb.Qc.add(562),jb.Qc.add(585),jb.Qc.add(1001),jb.Qc.add(1005),jb.Qc.add(1008),jb.Qc.add(1010),jb.Qc.add(1011),jb.Qc.add(1012),jb.Qc.add(1018),jb.Qc.add(252),
jb.Qc.add(253),jb.Qc.add(258),jb.Qc.add(101),jb.Qc.add(102),jb.Qc.add(108),jb.Qc.add(118),jb.Qc.add(257),jb.Qc.add(119),jb.Qc.add(120),jb.Qc.add(123),jb.Qc.add(126),jb.Qc.add(127),jb.Qc.add(130),jb.Qc.add(140),jb.Qc.add(159),jb.Qc.add(160),jb.Qc.add(165),jb.Qc.add(166),jb.Qc.add(167),jb.Qc.add(169),jb.Qc.add(189),jb.Qc.add(223),jb.Qc.add(214),jb.Qc.add(228),jb.Qc.add(233),jb.Qc.add(247),jb.Qc.add(504),jb.Qc.add(511),jb.Qc.add(512),jb.Qc.add(525),jb.Qc.add(533),jb.Qc.add(537),jb.Qc.add(542),jb.Qc.add(544),
jb.Qc.add(548),jb.Qc.add(550),jb.Qc.add(551),jb.Qc.add(552),jb.Qc.add(554),jb.Qc.add(577),jb.Qc.add(584),jb.Qc.add(586),jb.Qc.add(587),jb.Qc.add(588),jb.Qc.add(592),jb.Qc.add(1009),jb.Qc.add(1016),jb.Qc.add(1017));return jb.Qc};jb.Qc=null;Object(de.a)(jb,"MacroRecorderUnrecognizedEventList",null,[]);za.prototype.init=function(G){this.$.vba&&(G?this.A9b=G:Te.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};za.prototype.Yad=function(G){if(this.O2f())try{if(this.opf.Yfi(G))for(var ka=
this.opf.FPj(G),Ua=yl(ka),e=Ua.next();!e.done;e=Ua.next())this.tUe(e.value);else this.tUe(G)}catch(C){G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",Uj.a(G.operation),C.stack),Te.ULS.sendTraceTag(537155423,0,10,G)}};za.prototype.tUe=function(G){var ka=this.ppf.D0e(G,!0);ka?(this.A9b(ka.eventId,fj.a.Lc(G.payload)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",ka.eventId),Te.ULS.sendTraceTag(537155422,0,50,G)):(ka=this.ppf.D0e(G,
!1))?(G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",ka.eventId),Te.ULS.sendTraceTag(537155421,0,50,G)):jb.a2h().contains(G.operation)||(this.A9b(0,fj.a.Lc(G.operation)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",Uj.a(G.operation)),Te.ULS.sendTraceTag(537155420,0,50,G))};za.prototype.O2f=function(){return this.$.Lka&&this.A9b&&this.$.rba?!0:!1};Object(de.a)(za,"MacroRecorderEventHandler",null,
[721]);var dg=b(1);R.prototype.qg=function(){};R.prototype.kwa=function(){};R.prototype.Ad=function(G){this.kCc.add(G)};R.prototype.Vb=function(G){this.operations.contains(G)||this.operations.add(G)};R.prototype.Vmb=function(){this.featureGates.add(702)};R.prototype.Sle=function(G){this.PSe.add(G)};Qk.Object.defineProperties(R.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.XNc||(this.XNc=new sh.a,this.jc());return this.XNc}},kCc:{configurable:!0,enumerable:!0,get:function(){this.ASc||
(this.ASc=new sh.a,this.qg());return this.ASc}},PSe:{configurable:!0,enumerable:!0,get:function(){this.WHc||(this.WHc=new sh.a);return this.WHc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.XHc||(this.XHc=new sh.a,this.kwa());return this.XHc}}});Object(de.a)(R,"MacroRecorderEventBase",null,[]);vm(ti,R);ti.prototype.jc=function(){this.Vb(100)};Qk.Object.defineProperties(ti.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(de.a)(ti,"AccessibilityCheckRunEvent",
R,[]);vm(Gg,R);Gg.prototype.jc=function(){this.Vb(241)};Gg.prototype.qg=function(){this.Ad(function(G){return G.addToPrintArea})};Qk.Object.defineProperties(Gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(de.a)(Gg,"AddedToPrintAreaEvent",R,[]);vm(Eh,R);Eh.prototype.jc=function(){this.Vb(516)};Qk.Object.defineProperties(Eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 65}}});Object(de.a)(Eh,"AutoFilterToggledEvent",R,[]);vm(Ih,R);
Ih.prototype.jc=function(){this.Vb(502)};Ih.prototype.qg=function(){this.Ad(function(G){return!(G.g4a().FirstColumn===G.g4a().LastColumn&&G.g4a().FirstRow===G.g4a().LastRow)})};Qk.Object.defineProperties(Ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(de.a)(Ih,"AutoSumEvent",R,[]);vm(Cf,R);Cf.prototype.jc=function(){this.Vb(529);this.Vb(594)};Cf.prototype.qg=function(){var G=this;this.Ad(function(ka){return Array.contains(G.kWj,ka.Vfd())})};Qk.Object.defineProperties(Cf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}}});Object(de.a)(Cf,"ChartPropertyAppliedEventBase",R,[]);vm(Bi,Cf);Object(de.a)(Bi,"ChartAxisChangedEvent",Cf,[]);vm(Tg,Cf);Object(de.a)(Tg,"ChartAxisTitleChangedEvent",Cf,[]);vm(Hg,Cf);Object(de.a)(Hg,"ChartDataLabelsChangedEvent",Cf,[]);vm($f,Cf);Object(de.a)($f,"ChartDataSelectedEvent",Cf,[]);vm(Vf,Cf);Object(de.a)(Vf,"ChartDataTableChangedEvent",Cf,[]);var ui=b(574),vh=b(411),Ci=b(84);vm(We,R);Object(de.a)(We,"RichApiRequestExecutedEventBase",
R,[]);Qk.Object.defineProperties(Pe.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(de.a)(Pe,"MacroRecorderRichApiRequestExecutedPayload",null,[106]);vm(ve,We);ve.prototype.mF=function(G){ve.V6||(ve.V6=new Qj.a(ui.a.Gk()),ve.V6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ve.V6.add("fa000000014"));return!!G&&ve.V6.contains(G.toLowerCase())};ve.prototype.jc=function(){this.Vb(507);
this.Vb(10);this.Vb(576)};ve.prototype.qg=function(){var G=this;this.Ad(function(ka){return Object(vh.a)(Pe,ka)&&(ka=Object(Ci.a)(Pe,ka),ka.isValid&&G.mF(ka.source))?(Te.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",ka.eventId),!0):!1})};Qk.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 117}}});ve.V6=null;Object(de.a)(ve,"ChartFormatRichApiRequestExecutedEvent",We,[]);vm(Vd,
Cf);Object(de.a)(Vd,"ChartGridlinesChangedEvent",Cf,[]);vm(Id,R);Id.prototype.jc=function(){this.Vb(528)};Qk.Object.defineProperties(Id.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(de.a)(Id,"ChartInsertedEvent",R,[]);vm(bd,Cf);Object(de.a)(bd,"ChartLegendChangedEvent",Cf,[]);vm(gc,Cf);Object(de.a)(gc,"ChartRowColumnSwitchedEvent",Cf,[]);vm(zb,Cf);Object(de.a)(zb,"ChartTitleChangedEvent",Cf,[]);vm(Ra,Cf);Object(de.a)(Ra,"ChartTypeChangedEvent",Cf,[]);vm(Y,R);
Y.prototype.jc=function(){this.Vb(521)};Qk.Object.defineProperties(Y.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(de.a)(Y,"ConnectorFloatingObjectResizedEvent",R,[]);vm(xi,R);xi.prototype.jc=function(){this.Vb(109)};Qk.Object.defineProperties(xi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(de.a)(xi,"EntitySelectedEvent",R,[]);vm(Ui,R);Ui.prototype.jc=function(){this.Vb(149);this.Vb(147)};Qk.Object.defineProperties(Ui.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(de.a)(Ui,"FindCellEvent",R,[]);vm(Ah,R);Ah.prototype.jc=function(){this.Vb(122)};Qk.Object.defineProperties(Ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(de.a)(Ah,"FloatingObjectAltTextAppliedEvent",R,[]);vm(zg,R);zg.prototype.jc=function(){this.Vb(522)};Qk.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(de.a)(zg,"FloatingObjectDeletedEvent",
R,[]);vm(lh,R);lh.prototype.jc=function(){this.Vb(524)};Qk.Object.defineProperties(lh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(de.a)(lh,"FloatingObjectMovedAndResizedEvent",R,[]);vm(Dg,R);Dg.prototype.jc=function(){this.Vb(523)};Qk.Object.defineProperties(Dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});Object(de.a)(Dg,"FloatingObjectRotatedEvent",R,[]);vm(fi,R);fi.prototype.jc=function(){this.Vb(543)};Qk.Object.defineProperties(fi.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(de.a)(fi,"GroupDetailsShownOrHiddenEvent",R,[]);vm(Qg,R);Qg.prototype.jc=function(){this.Vb(125)};Qk.Object.defineProperties(Qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(de.a)(Qg,"HyperlinksRemovedFromRangeEvent",R,[]);vm(Oh,We);Oh.prototype.mF=function(G){Oh.V6||(Oh.V6=new Qj.a(ui.a.Gk()),Oh.V6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Oh.V6.add("fa000000005"));return!!G&&Oh.V6.contains(G.toLowerCase())};
Oh.prototype.jc=function(){this.Vb(507);this.Vb(10);this.Vb(576)};Oh.prototype.qg=function(){var G=this;this.Ad(function(ka){return Object(vh.a)(Pe,ka)?(ka=Object(Ci.a)(Pe,ka),ka.isValid&&G.mF(ka.source)):!1})};Qk.Object.defineProperties(Oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});Oh.V6=null;Object(de.a)(Oh,"IdeasRichApiRequestExecutedEvent",We,[]);vm(fh,R);fh.prototype.jc=function(){this.Vb(115)};Qk.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 136}}});Object(de.a)(fh,"LinkedEntityConvertedEvent",R,[]);vm(Jg,R);Jg.prototype.jc=function(){this.Vb(114)};Qk.Object.defineProperties(Jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(de.a)(Jg,"LinkedEntityDisambiguationPaneToggledEvent",R,[]);vm(Af,R);Af.prototype.jc=function(){this.Vb(119)};Qk.Object.defineProperties(Af.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(de.a)(Af,"MovedToEdgeEvent",
R,[]);vm(kf,R);kf.prototype.jc=function(){this.Vb(191)};kf.prototype.kwa=function(){this.Vmb()};Qk.Object.defineProperties(kf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(de.a)(kf,"NamedSheetViewCreatedEvent",R,[]);vm(nf,R);nf.prototype.jc=function(){this.Vb(200)};nf.prototype.kwa=function(){this.Vmb()};Qk.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(de.a)(nf,"NamedSheetViewDeletedEvent",
R,[]);vm(ef,R);ef.prototype.jc=function(){this.Vb(192)};ef.prototype.kwa=function(){this.Vmb()};Qk.Object.defineProperties(ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(de.a)(ef,"NamedSheetViewExitedEvent",R,[]);vm(qe,R);qe.prototype.jc=function(){this.Vb(199)};qe.prototype.kwa=function(){this.Vmb()};Qk.Object.defineProperties(qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(de.a)(qe,"NamedSheetViewRenamedEvent",
R,[]);vm(Bd,R);Bd.prototype.jc=function(){this.Vb(195)};Bd.prototype.kwa=function(){this.Vmb()};Qk.Object.defineProperties(Bd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(de.a)(Bd,"NamedSheetViewSwitchedEvent",R,[]);vm(hd,R);hd.prototype.jc=function(){this.Vb(174)};Qk.Object.defineProperties(hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(de.a)(hd,"OutlineLevelSetEvent",R,[]);vm(gd,R);gd.prototype.jc=function(){this.Vb(244)};
Qk.Object.defineProperties(gd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(de.a)(gd,"PageBreakInsertedEvent",R,[]);vm(rc,R);rc.prototype.jc=function(){this.Vb(245)};Qk.Object.defineProperties(rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(de.a)(rc,"PageBreakRemovedEvent",R,[]);vm(Pb,R);Pb.prototype.jc=function(){this.Vb(246)};Qk.Object.defineProperties(Pb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});
Object(de.a)(Pb,"PageBreaksAllResetEvent",R,[]);vm(Qa,R);Qa.prototype.jc=function(){this.Vb(503)};Qa.prototype.qg=function(){this.Ad(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&2===G.pasteParameters.CopyPasteTargetType&&!G.isFromCurrentSession})};Qk.Object.defineProperties(Qa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(de.a)(Qa,"PasteArtOtherWorkbookEvent",R,[]);vm(ha,R);ha.prototype.jc=function(){this.Vb(503)};ha.prototype.qg=
function(){this.Ad(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&2===G.pasteParameters.CopyPasteTargetType&&G.isFromCurrentSession})};Qk.Object.defineProperties(ha.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(de.a)(ha,"PasteArtSameWorkbookEvent",R,[]);vm(ad,R);ad.prototype.jc=function(){this.Vb(204)};Qk.Object.defineProperties(ad.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(de.a)(ad,"PasteHtmlEvent",
R,[]);vm(Kc,R);Kc.prototype.jc=function(){this.Vb(506)};Qk.Object.defineProperties(Kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(de.a)(Kc,"PasteRangeEvent",R,[]);vm(Lb,R);Lb.prototype.jc=function(){this.Vb(503)};Lb.prototype.qg=function(){this.Ad(function(G){return 1===G.pasteParameters.CopyPasteTargetType})};Qk.Object.defineProperties(Lb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(de.a)(Lb,"PasteShadowWorkbookRangeEvent",
R,[]);vm(sb,R);sb.prototype.jc=function(){this.Vb(180)};Qk.Object.defineProperties(sb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(de.a)(sb,"PasteStringEvent",R,[]);vm(na,R);na.prototype.jc=function(){this.Vb(220)};Qk.Object.defineProperties(na.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 134}}});Object(de.a)(na,"PendingMergeEvent",R,[]);vm(aa,R);aa.prototype.jc=function(){this.Vb(510)};Qk.Object.defineProperties(aa.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 122}}});Object(de.a)(aa,"PictureInsertedEvent",R,[]);vm(L,R);L.prototype.jc=function(){this.Vb(161)};Qk.Object.defineProperties(L.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(de.a)(L,"PivotDrillToggledEvent",R,[]);vm(E,R);E.prototype.jc=function(){this.Vb(225)};E.prototype.qg=function(){var G=this;this.Ad(function(ka){return ka.opType===G.opType})};Qk.Object.defineProperties(E.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return this.vfa}}});Object(de.a)(E,"PivotTableSettingsChangedEventBase",R,[]);vm(k,E);Object(de.a)(k,"PivotTableAllItemLabelsRepeatedEvent",E,[]);vm(P,E);Object(de.a)(P,"PivotTableAltTextDescriptionChangedEvent",E,[]);vm(va,E);Object(de.a)(va,"PivotTableAltTextTitleChangedEvent",E,[]);vm(X,E);Object(de.a)(X,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",E,[]);vm(tc,E);Object(de.a)(tc,"PivotTableBlankLineAfterEachItemToggledEvent",E,[]);vm(Bb,E);Object(de.a)(Bb,"PivotTableColumnGrandTotalShownEvent",
E,[]);vm(h,R);h.prototype.jc=function(){this.Vb(132)};Qk.Object.defineProperties(h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(de.a)(h,"PivotTableCreatedEvent",R,[]);vm(oh,E);Object(de.a)(oh,"PivotTableDisplayErrorStringToggledEvent",E,[]);vm(vg,E);Object(de.a)(vg,"PivotTableDisplayNullStringToggledEvent",E,[]);vm(ch,E);Object(de.a)(ch,"PivotTableErrorStringChangedEvent",E,[]);vm(Rf,E);Object(de.a)(Rf,"PivotTableExpandCollapseButtonsShownEvent",E,[]);vm(rf,
E);Object(de.a)(rf,"PivotTableIndentChangedEvent",E,[]);vm(ih,E);Object(de.a)(ih,"PivotTableItemsWithNoDataOnColumnsShownEvent",E,[]);vm(ai,E);Object(de.a)(ai,"PivotTableItemsWithNoDataOnRowsShownEvent",E,[]);vm(gg,E);Object(de.a)(gg,"PivotTableLayoutTypeSetEvent",E,[]);vm(mh,E);Object(de.a)(mh,"PivotTableNullStringChangedEvent",E,[]);vm(ng,R);ng.prototype.jc=function(){this.Vb(219)};Qk.Object.defineProperties(ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(de.a)(ng,
"PivotTablePivotLocationChangedEvent",R,[]);vm(Bg,R);Bg.prototype.jc=function(){this.Vb(145)};Qk.Object.defineProperties(Bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(de.a)(Bg,"PivotTablePivotedEvent",R,[]);vm(ue,E);Object(de.a)(ue,"PivotTableRefreshDataOnLoadToggledEvent",E,[]);vm(Ng,R);Ng.prototype.jc=function(){this.Vb(50)};Ng.prototype.qg=function(){this.Ad(function(G){return!!G.pivotTableId&&!!G.pivotTableName})};Qk.Object.defineProperties(Ng.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(de.a)(Ng,"PivotTableRefreshedEvent",R,[]);vm(nh,E);Object(de.a)(nh,"PivotTableRenamedEvent",E,[]);vm(hh,E);Object(de.a)(hh,"PivotTableRowGrandTotalShownEvent",E,[]);vm(yg,E);Object(de.a)(yg,"PivotTableSaveSourceDataWithFileToggledEvent",E,[]);var Zi=b(652);vm(xg,R);xg.prototype.jc=function(){this.Vb(131)};xg.prototype.qg=function(){this.Ad(function(G){G=Object(Ci.a)(Zi.a,G);return!!G&&!!G.aKa()&&!!G.hierarchyName})};Qk.Object.defineProperties(xg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(de.a)(xg,"PivotTableSortedEvent",R,[]);vm(Ff,E);Object(de.a)(Ff,"PivotTableSubTotalsVisibilitySettingSetEvent",E,[]);vm(sg,R);sg.prototype.jc=function(){this.Vb(560)};Qk.Object.defineProperties(sg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(de.a)(sg,"PivotValueFieldSettingAppliedEvent",R,[]);vm(sf,R);sf.prototype.jc=function(){this.Vb(243)};Qk.Object.defineProperties(sf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(de.a)(sf,"PrintAreaClearedEvent",R,[]);vm(me,R);me.prototype.jc=function(){this.Vb(241)};me.prototype.qg=function(){this.Ad(function(G){return!G.addToPrintArea})};Qk.Object.defineProperties(me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(de.a)(me,"PrintAreaSetEvent",R,[]);vm(Nd,R);Nd.prototype.jc=function(){this.Vb(517)};Qk.Object.defineProperties(Nd.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 57}}});Object(de.a)(Nd,"RangeAutoFilterClearedEvent",R,[]);vm(tb,R);tb.prototype.jc=function(){this.Vb(11)};tb.prototype.qg=function(){var G=this;this.Ad(function(ka){return 16===ka.cellFormat.ValidMembers});this.Ad(function(ka){return ka.cellFormat.Font.ValidMembers===G.jZd})};Qk.Object.defineProperties(tb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}}});Object(de.a)(tb,"RangeFontFormattedEventBase",R,[]);vm(ua,tb);Object(de.a)(ua,
"RangeBoldedEvent",tb,[]);vm(Ca,R);Ca.prototype.jc=function(){this.Vb(11)};Ca.prototype.qg=function(){this.Ad(function(G){return 128===G.cellFormat.ValidMembers})};Qk.Object.defineProperties(Ca.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});Object(de.a)(Ca,"RangeBorderedEvent",R,[]);og.b$a="Table";og.Doc="Sheet";Object(de.a)(og,"MacroRecorderEventConstants",null,[]);vm(Yh,R);Yh.prototype.jc=function(){this.Vb(208)};Yh.prototype.qg=function(){this.Ad(function(G){return G.getParameters().FilterType===
og.Doc})};Qk.Object.defineProperties(Yh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(de.a)(Yh,"RangeCheckedItemsFilteredEvent",R,[]);vm(mi,R);mi.prototype.jc=function(){this.Vb(106);this.Vb(105)};Qk.Object.defineProperties(mi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(de.a)(mi,"RangeConditionalFormattingChangedEvent",R,[]);vm(kg,R);kg.prototype.jc=function(){this.Vb(221)};Qk.Object.defineProperties(kg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(de.a)(kg,"RangeConditionalFormattingRuleDeletedEvent",R,[]);vm(ii,R);ii.prototype.jc=function(){this.Vb(508)};ii.prototype.qg=function(){this.Ad(function(G){return 3===G.Pt()||1===G.Pt()||4===G.Pt()})};Qk.Object.defineProperties(ii.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(de.a)(ii,"RangeContentClearedEvent",R,[]);vm(Qh,R);Qh.prototype.jc=function(){this.Vb(104)};Qk.Object.defineProperties(Qh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(de.a)(Qh,"RangeCopiedCutCellsInsertedEvent",R,[]);vm(fg,R);fg.prototype.jc=function(){this.Vb(209)};fg.prototype.qg=function(){this.Ad(function(G){return G.getParameters().FilterType===og.Doc})};Qk.Object.defineProperties(fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(de.a)(fg,"RangeCustomFilteredEvent",R,[]);vm(uh,R);uh.prototype.jc=function(){this.Vb(121)};Qk.Object.defineProperties(uh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(de.a)(uh,"RangeDataValidationChangedEvent",R,[]);vm(Cg,tb);Object(de.a)(Cg,"RangeDoubleUnderlinedEvent",tb,[]);vm(bh,R);bh.prototype.jc=function(){this.Vb(190)};Qk.Object.defineProperties(bh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(de.a)(bh,"RangeDuplicatesRemovedEvent",R,[]);vm(yh,R);yh.prototype.jc=function(){this.Vb(527);this.Vb(12)};Qk.Object.defineProperties(yh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(de.a)(yh,"RangeEditedEvent",R,[]);vm(wg,R);wg.prototype.jc=function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Vb(255):this.Vb(232)};wg.prototype.qg=function(){this.Ad(function(G){return 4===G.actionType})};Qk.Object.defineProperties(wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(de.a)(wg,"RangeExternalLinksBrokeAllLinksEvent",
R,[]);vm(Sg,R);Sg.prototype.jc=function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Vb(255):this.Vb(232)};Sg.prototype.qg=function(){this.Ad(function(G){return 3===G.actionType})};Qk.Object.defineProperties(Sg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(de.a)(Sg,"RangeExternalLinksBrokeLinkEvent",R,[]);vm(Dh,R);Dh.prototype.jc=function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Vb(256):this.Vb(249)};Dh.prototype.kwa=function(){this.Sle("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};Qk.Object.defineProperties(Dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(de.a)(Dh,"RangeExternalLinksChangeSourceEvent",R,[]);vm(ei,R);ei.prototype.jc=function(){this.Vb(553)};ei.prototype.qg=function(){this.Ad(function(G){return 1===G.actionType})};Qk.Object.defineProperties(ei.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 163}}});Object(de.a)(ei,"RangeExternalLinksRefreshedAllEvent",R,[]);vm(Fg,R);Fg.prototype.jc=function(){this.Vb(553)};Fg.prototype.qg=function(){this.Ad(function(G){return 0===G.actionType})};Qk.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(de.a)(Fg,"RangeExternalLinksRefreshedEvent",R,[]);vm(Ph,R);Ph.prototype.jc=function(){this.Vb(224)};Qk.Object.defineProperties(Ph.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 165}}});Object(de.a)(Ph,"RangeExternalLinksSetAutoRefreshEvent",R,[]);vm(di,R);di.prototype.jc=function(){this.Vb(11)};di.prototype.qg=function(){this.Ad(function(G){return 64===G.cellFormat.ValidMembers})};Qk.Object.defineProperties(di.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(de.a)(di,"RangeFillColoredEvent",R,[]);vm(Og,R);Og.prototype.jc=function(){this.Vb(155)};Qk.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 59}}});Object(de.a)(Og,"RangeFilledEvent",R,[]);vm(Wg,R);Wg.prototype.jc=function(){this.Vb(176)};Wg.prototype.qg=function(){this.Ad(function(G){return G.fV().AutoFilterType===og.Doc&&!!G.fV().CriteriaType})};Qk.Object.defineProperties(Wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(de.a)(Wg,"RangeFilterAppliedEvent",R,[]);vm(xh,R);xh.prototype.jc=function(){this.Vb(176)};xh.prototype.qg=function(){this.Ad(function(G){return G.fV().AutoFilterType===
og.Doc&&!G.fV().CriteriaType})};Qk.Object.defineProperties(xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(de.a)(xh,"RangeFilterClearedEvent",R,[]);vm(Uh,R);Uh.prototype.jc=function(){this.Vb(518)};Qk.Object.defineProperties(Uh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(de.a)(Uh,"RangeFilterReappliedEvent",R,[]);vm(eh,R);eh.prototype.jc=function(){this.Vb(150)};Qk.Object.defineProperties(eh.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 86}}});Object(de.a)(eh,"RangeFlashFilledEvent",R,[]);vm(gh,tb);Object(de.a)(gh,"RangeFontColoredEvent",tb,[]);vm(ph,tb);Object(de.a)(ph,"RangeFontItalicizedEvent",tb,[]);vm(Nh,tb);Object(de.a)(Nh,"RangeFontNamedEvent",tb,[]);vm(Mh,tb);Object(de.a)(Mh,"RangeFontSizedEvent",tb,[]);vm(ki,R);ki.prototype.jc=function(){this.Vb(215)};Qk.Object.defineProperties(ki.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(de.a)(ki,"RangeFormattedAsTableEvent",
R,[]);vm(Tf,R);Tf.prototype.jc=function(){this.Vb(188)};Qk.Object.defineProperties(Tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object(de.a)(Tf,"RangeGroupedOrUngroupedEvent",R,[]);vm(kh,R);kh.prototype.jc=function(){this.Vb(11)};kh.prototype.qg=function(){this.Ad(function(G){return 2===G.cellFormat.ValidMembers})};Qk.Object.defineProperties(kh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(de.a)(kh,"RangeHorizontallyAlignedEvent",
R,[]);vm($h,R);$h.prototype.jc=function(){this.Vb(526)};Qk.Object.defineProperties($h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object(de.a)($h,"RangeHyperlinkAppliedEvent",R,[]);vm(Oe,R);Oe.prototype.jc=function(){this.Vb(11)};Oe.prototype.qg=function(){this.Ad(function(G){return 256===G.cellFormat.ValidMembers})};Qk.Object.defineProperties(Oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(de.a)(Oe,"RangeIndentChangedEvent",
R,[]);vm(Jf,R);Jf.prototype.jc=function(){this.Vb(156)};Jf.prototype.qg=function(){this.Ad(function(G){return 2===G.Pt()||5===G.Pt()||6===G.Pt()||7===G.Pt()})};Qk.Object.defineProperties(Jf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(de.a)(Jf,"RangeMergedEvent",R,[]);vm(Ag,R);Ag.prototype.jc=function(){this.Vb(216)};Qk.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(de.a)(Ag,"RangeNamedCellStyleAppliedEvent",
R,[]);vm(xe,R);xe.prototype.jc=function(){this.Vb(11)};xe.prototype.qg=function(){this.Ad(function(G){return 32===G.cellFormat.ValidMembers})};Qk.Object.defineProperties(xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(de.a)(xe,"RangeNumberFormattedEvent",R,[]);var rk=b(1089);vm(dh,R);dh.prototype.jc=function(){this.Vb(141)};dh.prototype.qg=function(){this.Ad(function(G){return Object(vh.a)(rk.a,G)})};Qk.Object.defineProperties(dh.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 108}}});Object(de.a)(dh,"RangeSortedEvent",R,[]);vm(ci,tb);Object(de.a)(ci,"RangeStrikedThroughEvent",tb,[]);vm(jh,tb);Object(de.a)(jh,"RangeUnderlinedEvent",tb,[]);vm(Pd,R);Pd.prototype.jc=function(){this.Vb(11)};Pd.prototype.qg=function(){this.Ad(function(G){return 1===G.cellFormat.ValidMembers})};Qk.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(de.a)(Pd,"RangeVerticallyAlignedEvent",R,[]);vm(Zg,
R);Zg.prototype.jc=function(){this.Vb(11)};Zg.prototype.qg=function(){this.Ad(function(G){return 8===G.cellFormat.ValidMembers})};Qk.Object.defineProperties(Zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(de.a)(Zg,"RangeWrapTextToggledEvent",R,[]);vm(Sf,R);Sf.prototype.jc=function(){this.Vb(51)};Qk.Object.defineProperties(Sf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(de.a)(Sf,"RefreshedAllEvent",R,[]);vm(Hh,R);Hh.prototype.jc=
function(){this.Vb(148)};Qk.Object.defineProperties(Hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object(de.a)(Hh,"ReplaceAllEvent",R,[]);vm(uf,R);uf.prototype.jc=function(){this.Vb(532)};uf.prototype.qg=function(){this.Ad(function(G){return 95!==G.getShapeType()&&96!==G.getShapeType()&&97!==G.getShapeType()&&98!==G.getShapeType()&&100!==G.getShapeType()&&102!==G.getShapeType()&&103!==G.getShapeType()})};Qk.Object.defineProperties(uf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 91}}});Object(de.a)(uf,"ShapeInsertedEvent",R,[]);vm(ud,R);ud.prototype.jc=function(){this.Vb(531)};Qk.Object.defineProperties(ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(de.a)(ud,"ShapeStyleSetEvent",R,[]);var ik=b(945);vm(If,R);If.prototype.jc=function(){this.Vb(581)};If.prototype.qg=function(){var G=this;this.Ad(function(ka){return Object(vh.a)(ik.a,ka)&&4===ka.getShapeTextFormat().ValidMembers});this.Ad(function(ka){return Object(vh.a)(ik.a,
ka)&&ka.getShapeTextFormat().Font.ValidMembers===G.jZd})};Qk.Object.defineProperties(If.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}}});Object(de.a)(If,"ShapeTextFontFormattedEventBase",R,[]);vm(jg,If);Object(de.a)(jg,"ShapeTextBoldedEvent",If,[]);var mk=b(1091);vm(pe,R);pe.prototype.jc=function(){this.Vb(581)};pe.prototype.qg=function(){this.Ad(function(G){return Object(vh.a)(mk.a,G)})};Qk.Object.defineProperties(pe.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 191}}});Object(de.a)(pe,"ShapeTextChangedEvent",R,[]);vm(Gd,If);Object(de.a)(Gd,"ShapeTextFontColorChangedEvent",If,[]);vm(cf,If);Object(de.a)(cf,"ShapeTextFontNameChangedEvent",If,[]);vm(Md,If);Object(de.a)(Md,"ShapeTextFontSizeChangedEvent",If,[]);vm(Of,R);Of.prototype.jc=function(){this.Vb(581)};Of.prototype.qg=function(){this.Ad(function(G){return Object(vh.a)(ik.a,G)&&2===G.getShapeTextFormat().ValidMembers})};Qk.Object.defineProperties(Of.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 199}}});Object(de.a)(Of,"ShapeTextHorizontallyAlignedEvent",R,[]);vm(He,If);Object(de.a)(He,"ShapeTextItalicizedEvent",If,[]);vm(Ef,If);Object(de.a)(Ef,"ShapeTextUnderlinedEvent",If,[]);vm(ge,R);ge.prototype.jc=function(){this.Vb(581)};ge.prototype.qg=function(){this.Ad(function(G){return Object(vh.a)(ik.a,G)&&1===G.getShapeTextFormat().ValidMembers})};Qk.Object.defineProperties(ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});
Object(de.a)(ge,"ShapeTextVerticallyAlignedEvent",R,[]);vm(Me,R);Me.prototype.jc=function(){this.Vb(138)};Qk.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 13}}});Object(de.a)(Me,"SheetAddedEvent",R,[]);var lj=b(9);vm(Td,R);Td.prototype.jc=function(){this.Vb(237)};Td.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){G=
G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==lj.a.qz)||!G.DeltaColumn&&0>G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==lj.a.tw)})};Qk.Object.defineProperties(Td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(de.a)(Td,"SheetCellsDeletedEvent",R,[]);vm(nc,R);nc.prototype.jc=function(){this.Vb(237)};nc.prototype.qg=
function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==lj.a.qz)||!G.DeltaColumn&&0<G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==lj.a.tw)})};Qk.Object.defineProperties(nc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 143}}});Object(de.a)(nc,"SheetCellsInsertedEvent",R,[]);vm(Cb,R);Cb.prototype.jc=function(){this.Vb(237)};Cb.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===lj.a.qz})};Qk.Object.defineProperties(Cb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(de.a)(Cb,"SheetColumnDeletedEvent",R,[]);vm(Lc,R);Lc.prototype.jc=function(){this.Vb(237)};Lc.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});
this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
lj.a.qz})};Qk.Object.defineProperties(Lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(de.a)(Lc,"SheetColumnInsertedEvent",R,[]);vm(Bc,R);Bc.prototype.jc=function(){this.Vb(137)};Qk.Object.defineProperties(Bc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 14}}});Object(de.a)(Bc,"SheetDeletedEvent",R,[]);vm(ac,R);ac.prototype.jc=function(){this.Vb(185)};Qk.Object.defineProperties(ac.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 137}}});Object(de.a)(ac,"SheetDirectionChangedEvent",R,[]);vm(bb,R);bb.prototype.jc=function(){this.Vb(139)};Qk.Object.defineProperties(bb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(de.a)(bb,"SheetDuplicatedEvent",R,[]);vm(Ka,R);Ka.prototype.jc=function(){this.Vb(207)};Qk.Object.defineProperties(Ka.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(de.a)(Ka,"SheetNameEditedEvent",R,[]);vm(lf,R);lf.prototype.jc=
function(){this.Vb(151)};Qk.Object.defineProperties(lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(de.a)(lf,"SheetPaneFrozenEvent",R,[]);vm(Ge,R);Ge.prototype.jc=function(){this.Vb(226)};Qk.Object.defineProperties(Ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(de.a)(Ge,"SheetPrintSettingsSavedEvent",R,[]);var ri=b(994);vm(De,R);De.prototype.jc=function(){this.Vb(507)};De.prototype.kwa=function(){this.Sle("Microsoft.Office.Excel.SheetProtectionMacroRecording")};
De.prototype.qg=function(){this.Ad(function(G){return Object.getType(G)===ri.a})};Qk.Object.defineProperties(De.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(de.a)(De,"SheetProtectionPausedResumedEvent",R,[]);vm(Ld,R);Ld.prototype.jc=function(){this.Vb(557)};Qk.Object.defineProperties(Ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(de.a)(Ld,"SheetReorderedEvent",R,[]);vm(kd,R);kd.prototype.jc=function(){this.Vb(237)};
kd.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===
lj.a.tw})};Qk.Object.defineProperties(kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(de.a)(kd,"SheetRowDeletedEvent",R,[]);vm(Oc,R);Oc.prototype.jc=function(){this.Vb(237)};Oc.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return 0<
G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===lj.a.tw})};Qk.Object.defineProperties(Oc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(de.a)(Oc,"SheetRowInsertedEvent",R,[]);vm(Fb,R);Fb.prototype.jc=
function(){this.Vb(135)};Qk.Object.defineProperties(Fb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(de.a)(Fb,"SheetRowsColumnsAutoFitEvent",R,[]);vm(Da,R);Da.prototype.jc=function(){this.Vb(136)};Qk.Object.defineProperties(Da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(de.a)(Da,"SheetRowsColumnsResizedEvent",R,[]);vm(Lg,R);Lg.prototype.jc=function(){this.Vb(183)};Qk.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 68}}});Object(de.a)(Lg,"SheetShowGridlinesToggledEvent",R,[]);vm(cg,R);cg.prototype.jc=function(){this.Vb(184)};Qk.Object.defineProperties(cg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(de.a)(cg,"SheetShowHeadingsToggledEvent",R,[]);vm(Lh,R);Lh.prototype.jc=function(){this.Vb(213)};Qk.Object.defineProperties(Lh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(de.a)(Lh,"SheetSpellCheckedEvent",
R,[]);vm(Xg,R);Xg.prototype.jc=function(){this.Vb(515)};Qk.Object.defineProperties(Xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(de.a)(Xg,"SheetTabColoredEvent",R,[]);vm(qg,R);qg.prototype.jc=function(){this.Vb(157)};Qk.Object.defineProperties(qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(de.a)(qg,"SheetVisibilityChangedEvent",R,[]);vm(Je,R);Je.prototype.jc=function(){this.Vb(239)};Qk.Object.defineProperties(Je.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(de.a)(Je,"SheetsVisibilityChangedEvent",R,[]);vm(Re,R);Re.prototype.jc=function(){this.Vb(203)};Qk.Object.defineProperties(Re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(de.a)(Re,"SlicerInsertedEvent",R,[]);vm(Uf,R);Uf.prototype.jc=function(){this.Vb(173)};Uf.prototype.qg=function(){this.Ad(function(G){return!G.clearFilter})};Qk.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 189}}});Object(de.a)(Uf,"SlicerSelectionAppliedEvent",R,[]);vm(df,R);df.prototype.jc=function(){this.Vb(173)};df.prototype.qg=function(){this.Ad(function(G){return G.clearFilter})};Qk.Object.defineProperties(df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(de.a)(df,"SlicerSelectionClearedEvent",R,[]);vm(pg,R);pg.prototype.jc=function(){this.Vb(208)};pg.prototype.qg=function(){this.Ad(function(G){return G.getParameters().FilterType===
og.b$a})};Qk.Object.defineProperties(pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(de.a)(pg,"TableCheckedItemsFilteredEvent",R,[]);vm(hf,R);hf.prototype.jc=function(){this.Vb(237)};hf.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Qk.Object.defineProperties(hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 144}}});Object(de.a)(hf,"TableColumnDeletedEvent",R,[]);vm(Lf,R);Lf.prototype.jc=function(){this.Vb(237)};Lf.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Qk.Object.defineProperties(Lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(de.a)(Lf,"TableColumnInsertedEvent",R,[]);var Zj=b(1090);vm(bf,R);bf.prototype.jc=function(){this.Vb(141)};bf.prototype.qg=function(){this.Ad(function(G){return Object(vh.a)(Zj.a,G)})};Qk.Object.defineProperties(bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(de.a)(bf,"TableColumnSortedEvent",R,[]);vm(zf,R);zf.prototype.jc=function(){this.Vb(193)};
Qk.Object.defineProperties(zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(de.a)(zf,"TableConvertedToRangeEvent",R,[]);vm(le,R);le.prototype.jc=function(){this.Vb(206)};Qk.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(de.a)(le,"TableCreatedEvent",R,[]);vm(Le,R);Le.prototype.jc=function(){this.Vb(209)};Le.prototype.qg=function(){this.Ad(function(G){return G.getParameters().FilterType===og.b$a})};
Qk.Object.defineProperties(Le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(de.a)(Le,"TableCustomFilteredEvent",R,[]);vm(Xd,R);Xd.prototype.jc=function(){this.Vb(187)};Xd.prototype.qg=function(){this.Ad(function(G){return 1===G.options.OperationType})};Qk.Object.defineProperties(Xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(de.a)(Xd,"TableCustomSortedEvent",R,[]);vm(cd,R);cd.prototype.jc=function(){this.Vb(176)};cd.prototype.qg=
function(){this.Ad(function(G){return G.fV().AutoFilterType===og.b$a});this.Ad(function(G){return 0===G.fV().CriteriaType})};Qk.Object.defineProperties(cd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(de.a)(cd,"TableFilterClearedEvent",R,[]);vm(Nc,R);Nc.prototype.jc=function(){this.Vb(176)};Nc.prototype.qg=function(){this.Ad(function(G){return G.fV().AutoFilterType===og.b$a});this.Ad(function(G){var ka=new sh.a;ka.add(1);ka.add(2);ka.add(8);ka.add(9);ka.add(10);
ka.add(11);ka.add(12);ka.add(13);ka.add(14);ka.add(15);ka.add(16);ka.add(17);ka.add(18);ka.add(19);ka.add(20);ka.add(21);ka.add(22);ka.add(23);ka.add(24);ka.add(25);ka.add(26);ka.add(27);ka.add(28);ka.add(29);ka.add(30);ka.add(31);ka.add(32);ka.add(33);ka.add(34);ka.add(35);ka.add(36);ka.add(37);ka.add(38);ka.add(39);return ka.contains(G.fV().CriteriaType)})};Qk.Object.defineProperties(Nc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(de.a)(Nc,"TableItemFilteredEvent",
R,[]);vm(Zb,R);Zb.prototype.jc=function(){this.Vb(217)};Qk.Object.defineProperties(Zb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(de.a)(Zb,"TableRenamedEvent",R,[]);vm(re,R);re.prototype.jc=function(){this.Vb(211)};Qk.Object.defineProperties(re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(de.a)(re,"TableResizedEvent",R,[]);vm(Od,R);Od.prototype.jc=function(){this.Vb(514)};Qk.Object.defineProperties(Od.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 44}}});Object(de.a)(Od,"TableRowColumnRearrangedEvent",R,[]);vm(xd,R);xd.prototype.jc=function(){this.Vb(237)};xd.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Qk.Object.defineProperties(xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(de.a)(xd,"TableRowDeletedEvent",R,[]);vm(Vc,R);Vc.prototype.jc=function(){this.Vb(237)};Vc.prototype.qg=function(){this.Ad(function(G){return!!G.insertDeleteMultiRangeParameters});this.Ad(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Ad(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Ad(function(G){return 0<
G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Qk.Object.defineProperties(Vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(de.a)(Vc,"TableRowInsertedEvent",R,[]);vm(uc,R);uc.prototype.jc=function(){this.Vb(177)};uc.prototype.qg=function(){this.Ad(function(G){return G.fV().AutoFilterType===og.b$a})};Qk.Object.defineProperties(uc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(de.a)(uc,"TableSortedEvent",
R,[]);vm(Eb,R);Eb.prototype.jc=function(){this.Vb(212)};Qk.Object.defineProperties(Eb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(de.a)(Eb,"TableStyleAppliedEvent",R,[]);vm(La,R);La.prototype.jc=function(){this.Vb(196)};Qk.Object.defineProperties(La.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(de.a)(La,"TableStyleOptionToggledEvent",R,[]);vm(wh,R);wh.prototype.jc=function(){this.Vb(210)};wh.prototype.qg=function(){this.Ad(function(G){return G.getParameters().FilterType===
og.b$a})};Qk.Object.defineProperties(wh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(de.a)(wh,"TableTop10FilteredEvent",R,[]);vm(ig,R);ig.prototype.jc=function(){this.Vb(238)};Qk.Object.defineProperties(ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(de.a)(ig,"TextToColumnsEvent",R,[]);vm(xf,R);xf.prototype.jc=function(){this.Vb(559)};Qk.Object.defineProperties(xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 128}}});
Object(de.a)(xf,"ValuesSortedEvent",R,[]);vm(mg,R);mg.prototype.jc=function(){this.Vb(197)};Qk.Object.defineProperties(mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(de.a)(mg,"WorkbookCalculationModeSetEvent",R,[]);vm(bg,R);bg.prototype.jc=function(){this.Vb(181)};bg.prototype.qg=function(){this.Ad(function(G){return!!G.parentCommentId})};Qk.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});Object(de.a)(bg,
"WorkbookCommentRepliedEvent",R,[]);vm(Xf,R);Xf.prototype.jc=function(){this.Vb(181)};Xf.prototype.qg=function(){this.Ad(function(G){return!G.parentCommentId})};Qk.Object.defineProperties(Xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(de.a)(Xf,"WorkbookCommentedEvent",R,[]);vm(Ze,R);Ze.prototype.jc=function(){this.Vb(128)};Qk.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(de.a)(Ze,"WorkbookRecalculatedEvent",
R,[]);vm(Rd,R);Rd.prototype.jc=function(){this.Vb(171)};Qk.Object.defineProperties(Rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(de.a)(Rd,"WorkbookRedoEvent",R,[]);vm(Mf,R);Mf.prototype.jc=function(){this.Vb(170)};Qk.Object.defineProperties(Mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(de.a)(Mf,"WorkbookUndoEvent",R,[]);vm(Wd,R);Wd.prototype.jc=function(){this.Vb(507);this.Vb(576);this.Vb(10)};Wd.prototype.qg=function(){this.Ad(function(G){if(Object(vh.a)(Pe,
G)&&(G=Object(Ci.a)(Pe,G),void 0!==G.source&&null!==G.source&&void 0!==G.eventId&&null!==G.eventId))return Te.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",G.source,G.eventId),!0;Te.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Qk.Object.defineProperties(Wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 116}}});Object(de.a)(Wd,"DefaultRichApiRequestExecutedEvent",
R,[]);vm(tg,R);tg.prototype.jc=function(){this.Vb(1022)};Qk.Object.defineProperties(tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(de.a)(tg,"TablelAltTextEditedEvent",R,[]);vm(eg,R);eg.prototype.jc=function(){this.Vb(263)};Qk.Object.defineProperties(eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(de.a)(eg,"FloatingObjectZOrderChangedEvent",R,[]);he.prototype.D0e=function(G,ka){var Ua=this.E0e(G,this.macroRecorderEvents,
ka);Ua||(Ua=this.E0e(G,he.W1h(),ka),!Ua&&this.Fff(G,he.ZGe,ka)&&(Ua=he.ZGe));return Ua};he.prototype.E0e=function(G,ka,Ua){var e=new sh.a;ka=yl(ka);for(var C=ka.next();!C.done;C=ka.next())C=C.value,this.Fff(G,C,Ua)&&e.add(C);return 1===e.count?e.oa(0):1<e.count?he.SKh(e):null};he.prototype.Fff=function(G,ka,Ua){var e=he.GWi(G,ka);return Ua?e&&he.PWj(G,ka):e};he.prototype.waj=function(){for(var G=new sh.a,ka=yl(this.Fb),Ua=ka.next();!Ua.done;Ua=ka.next()){Ua=Ua.value;for(var e=!1,C=yl(Ua.featureGates),
J=C.next();!J.done;J=C.next())if(!dg.EwaSettings.la(J.value)){G.add(Ua);e=!0;break}if(!e)for(e=yl(Ua.PSe),C=e.next();!C.done;C=e.next())if(!dg.EwaSettings.getBooleanFeatureGate(C.value,!1)){G.add(Ua);break}}G=yl(G);for(ka=G.next();!ka.done;ka=G.next())this.Fb.remove(ka.value)};he.W1h=function(){he.yBb||(he.yBb=new sh.a,he.yBb.add(new ve),he.yBb.add(new Oh));return he.yBb};he.GWi=function(G,ka){return ka.operations.contains(G.operation)};he.PWj=function(G,ka){var Ua=ka.kCc;if(!Ua.count)return!0;ka=
!0;Ua=yl(Ua);for(var e=Ua.next();!e.done;e=Ua.next())if(e=e.value,!e(G.payload)){ka=!1;break}return ka};he.SKh=function(G){var ka=G.oa(0);G=yl(G);for(var Ua=G.next();!Ua.done;Ua=G.next())Ua=Ua.value,Ua.kCc.count>ka.kCc.count&&(ka=Ua);return ka};Qk.Object.defineProperties(he.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Fb||(this.Fb=new sh.a,this.Fb.add(new yh),this.Fb.add(new Ca),this.Fb.add(new ua),this.Fb.add(new Cg),this.Fb.add(new di),this.Fb.add(new gh),this.Fb.add(new ph),
this.Fb.add(new Nh),this.Fb.add(new Mh),this.Fb.add(new ci),this.Fb.add(new jh),this.Fb.add(new xe),this.Fb.add(new Me),this.Fb.add(new Bc),this.Fb.add(new Ka),this.Fb.add(new le),this.Fb.add(new hf),this.Fb.add(new Lf),this.Fb.add(new xd),this.Fb.add(new Vc),this.Fb.add(new Lc),this.Fb.add(new Cb),this.Fb.add(new Oc),this.Fb.add(new kd),this.Fb.add(new Xd),this.Fb.add(new uc),this.Fb.add(new pg),this.Fb.add(new cd),this.Fb.add(new ii),this.Fb.add(new Le),this.Fb.add(new wh),this.Fb.add(new Nc),this.Fb.add(new Xf),
this.Fb.add(new bg),this.Fb.add(new Kc),this.Fb.add(new Da),this.Fb.add(new Td),this.Fb.add(new nc),this.Fb.add(new Fb),this.Fb.add(new Qh),this.Fb.add(new Uh),this.Fb.add(new $h),this.Fb.add(new sb),this.Fb.add(new Od),this.Fb.add(new Rd),this.Fb.add(new Mf),this.Fb.add(new Hh),this.Fb.add(new Ui),this.Fb.add(new ha),this.Fb.add(new Jf),this.Fb.add(new bb),this.Fb.add(new mg),this.Fb.add(new Ze),this.Fb.add(new Nd),this.Fb.add(new xh),this.Fb.add(new Og),this.Fb.add(new kh),this.Fb.add(new Pd),this.Fb.add(new Zg),
this.Fb.add(new Oe),this.Fb.add(new Ld),this.Fb.add(new Eh),this.Fb.add(new Id),this.Fb.add(new cg),this.Fb.add(new Lg),this.Fb.add(new bh),this.Fb.add(new qg),this.Fb.add(new Xg),this.Fb.add(new re),this.Fb.add(new ki),this.Fb.add(new gc),this.Fb.add(new $f),this.Fb.add(new Fg),this.Fb.add(new Ra),this.Fb.add(new zb),this.Fb.add(new Tg),this.Fb.add(new bd),this.Fb.add(new Hg),this.Fb.add(new Vf),this.Fb.add(new Bi),this.Fb.add(new Vd),this.Fb.add(new eh),this.Fb.add(new Eb),this.Fb.add(new La),this.Fb.add(new Lh),
this.Fb.add(new lf),this.Fb.add(new uf),this.Fb.add(new ud),this.Fb.add(new zg),this.Fb.add(new lh),this.Fb.add(new Dg),this.Fb.add(new Ah),this.Fb.add(new Tf),this.Fb.add(new h),this.Fb.add(new hd),this.Fb.add(new fi),this.Fb.add(new Zb),this.Fb.add(new Bg),this.Fb.add(new Sf),this.Fb.add(new Ng),this.Fb.add(new zf),this.Fb.add(new uh),this.Fb.add(new Ag),this.Fb.add(new dh),this.Fb.add(new mi),this.Fb.add(new ad),this.Fb.add(new Lb),this.Fb.add(new Qa),this.Fb.add(new Yh),this.Fb.add(new fg),this.Fb.add(new Wg),
this.Fb.add(new Ih),this.Fb.add(new aa),this.Fb.add(new Sg),this.Fb.add(new Ge),this.Fb.add(new bf),this.Fb.add(new kg),this.Fb.add(new Je),this.Fb.add(new Af),this.Fb.add(new xf),this.Fb.add(new xi),this.Fb.add(new ti),this.Fb.add(new Y),this.Fb.add(new ef),this.Fb.add(new na),this.Fb.add(new kf),this.Fb.add(new fh),this.Fb.add(new ac),this.Fb.add(new Jg),this.Fb.add(new ng),this.Fb.add(new L),this.Fb.add(new Qg),this.Fb.add(new xg),this.Fb.add(new gd),this.Fb.add(new rc),this.Fb.add(new Pb),this.Fb.add(new me),
this.Fb.add(new Gg),this.Fb.add(new sf),this.Fb.add(new qe),this.Fb.add(new ei),this.Fb.add(new wg),this.Fb.add(new Ph),this.Fb.add(new nf),this.Fb.add(new Bd),this.Fb.add(new nh),this.Fb.add(new hh),this.Fb.add(new Bb),this.Fb.add(new k),this.Fb.add(new tc),this.Fb.add(new X),this.Fb.add(new Rf),this.Fb.add(new ai),this.Fb.add(new ih),this.Fb.add(new oh),this.Fb.add(new vg),this.Fb.add(new ch),this.Fb.add(new mh),this.Fb.add(new yg),this.Fb.add(new ue),this.Fb.add(new va),this.Fb.add(new P),this.Fb.add(new Ff),
this.Fb.add(new gg),this.Fb.add(new rf),this.Fb.add(new Re),this.Fb.add(new Uf),this.Fb.add(new df),this.Fb.add(new pe),this.Fb.add(new jg),this.Fb.add(new He),this.Fb.add(new Ef),this.Fb.add(new Gd),this.Fb.add(new cf),this.Fb.add(new Md),this.Fb.add(new Of),this.Fb.add(new ge),this.Fb.add(new Dh),this.Fb.add(new sg),this.Fb.add(new ig),this.Fb.add(new De),this.Fb.add(new tg),this.Fb.add(new eg),dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.waj());return this.Fb}}});
he.yBb=null;he.ZGe=new Wd;Object(de.a)(he,"MacroRecorderEventList",null,[]);var gj=Ug.a;vm(rg,gj);rg.prototype.create=function(){this.Gb(this.$.da.Aa(297)||new za(this.$,new he(this.$),new Dc))};rg.ka=function(G){G.da.Ha(298,new rg(G))};Object(de.a)(rg,"MacroRecorderEventHandlerFactory",Ug.a,[]);var Aj=b(817),yj=b(77),Fh=b(35);vf.prototype.Zc=function(){return!1};vf.prototype.executeCommand=function(G,ka,Ua){G=Fh.TaskExtensions.nm();ka=ka.command;switch(ka){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.ye(2045014907,
-1,0,null),this.automateCommandManager.isi(ka,1904816141===ka?Ua[yj.a.nd].toString():null)}return G};vf.prototype.Kc=function(G,ka){G=!1;switch(ka.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1606046412:G=this.$.vba}return G};vf.prototype.gd=function(G,ka,Ua){return"PopulateAutomateGalleryMenu"===ka&&this.$.vba?(this.automateCommandManager.gd(ka,Ua),!0):!1};Object(de.a)(vf,"AutomateCommandHandler",null,[239]);var ek=b(461),jk=Aj.a;vm(mf,jk);mf.prototype.Pd=
function(){var G=this;ek.a(this.$,374,375,this.ub,function(){var ka=G.$.da.Aa(352);ka?G.Gd([new vf(ka,G.$)]):Te.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};mf.ka=function(G){G.da.Ha(308,new mf(G))};Object(de.a)(mf,"AutomateCommandHandlerFactory",Aj.a,[]);Object(de.a)(jf,"AuthContext",null,[]);var $c=b(577),Ee=b(126),ni=b(107),zh=b(26),N=b(946),Ea=b(176);ie.prototype.getAuthContext=function(){return this.uob};ie.prototype.gbc=
function(){function G(J,ja){return(new Promise(function(Aa){window.setTimeout(function(){Aa(J)},ja)})).then(function(Aa){e.push(Object.assign(new Ue.a,{name:"Error"+C,string:Aa.ErrorMessage}));e.push(Object.assign(new Ue.a,{name:"ErrorCode"+C,string:Aa.ErrorCode}));C++;return ka.Uag()})}var ka=this,Ua=zh.a.Ra.Lb,e=[];if(this.oAuthManager)e.push(Object.assign(new Ue.a,{name:"IsAuthSupported",bool:this.ete}));else return this.Q8b(e,Ua,"need_OAuthManager","No OAuthManager");if(!this.Ov.Ux||!this.Ov.Ux.value)return this.Q8b(e,
Ua,"need_license","No License");if(Bf.AFrameworkApplication.ga.ra("IsAnonymousUser"))return this.Q8b(e,Ua,"need_user","Anonymous User");if(33E5>Date.now()-this.uob.timeStamp)return e.push(Object.assign(new Ue.a,{name:"UsedCachedToken",bool:!0})),Ea.a(Ee.a.Myd,!0,0,e),Promise.resolve(Object.assign(new N.a,{IsSuccess:!0,Token:this.uob.token}));e.push(Object.assign(new Ue.a,{name:"UsedCachedToken",bool:!1}));var C=1;return this.Uag().catch(function(J){return G(J,200)}).catch(function(J){return G(J,400)}).then(function(J){J.IsSuccess?
(ka.uob.token=J.Token,ka.uob.timeStamp=Date.now()):(e.push(Object.assign(new Ue.a,{name:"Error"+C,string:J.ErrorMessage})),e.push(Object.assign(new Ue.a,{name:"ErrorCode"+C,string:J.ErrorCode})));e.push(Object.assign(new Ue.a,{name:"Attempts",int64:C}));e.push(Object.assign(new Ue.a,{name:"Error",string:J.ErrorMessage}));e.push(Object.assign(new Ue.a,{name:"ErrorCode",string:J.ErrorCode}));Ea.a(Ee.a.Myd,J.IsSuccess,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);return Promise.resolve(J)}).catch(function(J){e.push(Object.assign(new Ue.a,
{name:"Error"+C,string:J.ErrorMessage}));e.push(Object.assign(new Ue.a,{name:"ErrorCode"+C,string:J.ErrorCode}));e.push(Object.assign(new Ue.a,{name:"Attempts",int64:C}));return ka.Q8b(e,Ua,J.ErrorCode,J.ErrorMessage)})};ie.prototype.Q8b=function(G,ka,Ua,e){G.push(Object.assign(new Ue.a,{name:"Error",string:e}));G.push(Object.assign(new Ue.a,{name:"ErrorCode",string:Ua}));Ea.a(Ee.a.Myd,!1,ni.getElapsedMilliseconds(ka,zh.a.Ra.Lb),G);return Promise.resolve(Object.assign(new N.a,{IsSuccess:!1,ErrorMessage:e,
ErrorCode:Ua}))};ie.prototype.Uag=function(){var G=this,ka=$c.a.X_h(),Ua=0;ka=this.oAuthManager.yS("Maker",ka).then(function(e){if(e)return!e.IsSuccess&&G.azj(e)?Promise.reject(e):Promise.resolve(e);e=Object.assign(new N.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(e)}).catch(function(e){var C=new N.a;Object.getType(e)===Object.getType(C)?C=e:(C.ErrorMessage=e.toString(),C.ErrorCode="exception");return Promise.reject(C)});return Promise.race([ka,
new Promise(function(e,C){Ua=window.setTimeout(function(){C(Object.assign(new N.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(e){window.clearTimeout(Ua);return e})};ie.prototype.azj=function(G){return"interaction_required"===G.ErrorCode||"InitFailed"===G.ErrorCode||"invalid_resource"===G.ErrorCode||"login_required"===G.ErrorCode&&G.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(de.a)(ie,"AutomateCommandAuth",null,[788]);var Hb=
b(947);Object(de.a)(ze,"AutomateCommandGalleryBase",null,[]);var yc=b(844),Xc=b(29),Ae=b(865),Fe=b(1364),af=b(16),Df=b(53),gf=b(14),Rg=b(823),Ig=b(996);Jd.prototype.GIh=function(G){var ka=this.automateCommandManager.Sa.Kp().$B(),Ua=Jd.vU(G,gf.a.instance.fa(2079));this.xUc(Ua,$c.a.qUi,this.automateCommandManager.hg,$c.a.LFi,gf.a.instance.fa(2075),this.automateCommandManager.Sa);Array.add(ka.MenuSectionList,Ua);Ua=Jd.vU(G,gf.a.instance.fa(2080));this.xUc(Ua,$c.a.LCi,$c.a.LK?this.automateCommandManager.Jk.kUe(this.automateCommandManager.hg):
this.automateCommandManager.Gm.kUe(this.automateCommandManager.hg),$c.a.Btf,gf.a.instance.fa(2076),this.automateCommandManager.Sa);Array.add(ka.MenuSectionList,Ua);Ua=Jd.vU(G,gf.a.instance.fa(2081));this.xUc(Ua,$c.a.Lkj,this.automateCommandManager.yr,$c.a.Btf,"",this.automateCommandManager.Sa);Array.add(ka.MenuSectionList,Ua);Ua=Object.assign(new yc.a,{Id:$c.a.Bpe,ExternalId:$c.a.Bpe,Command:"1606046412",LabelText:gf.a.instance.fa(2072),Alt:gf.a.instance.fa(2073),Image16by16:Df.a.Fe(16),Image16by16Class:af.a.gPe,
Visible:!0});G=Jd.vU(G,null);G.ControlsId="myScriptsSection.Controls";Array.add(G.ControlList,Ua);Array.add(ka.MenuSectionList,G);return ka};Jd.prototype.xUc=function(G,ka,Ua,e,C,J){if(Ua&&0<Ua.length){ka=J.EA(ka,1,"Size150by20").r0b();C={};J={};J.root=Jd.ita(320,30);J.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};J.label={margin:"0px 3px"};C.galleryButtonInExpanded=J;ka.GalleryStyle=C;for(C=0;C<Ua.length&&C<e;C++)J=Ua.eK(C),
Array.add(ka.GalleryItems,Jd.c4b(J.id,J,!1));Array.add(G.ControlList,ka)}else Ua=Object.assign(new Ig.a,{Id:ka,ExternalId:ka,LabelText:C}),G.ControlsId=Ua.Id+".Controls",Array.add(G.ControlList,Ua)};Jd.KWe=function(G){if(G){var ka=String.format($c.a.Uci,G.isShared?$c.a.pag:$c.a.VWf,Df.a.Fe(16));G=String.format($c.a.Vci,Xc.a.Lf(G.name));return String.format($c.a.Tci,ka,G)}return""};Jd.vU=function(G,ka){return Object.assign(new Ae.a,{Id:G,Title:ka,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,
ShowMenuSectionTitleIcon:!0,ControlList:[]})};Jd.c4b=function(G,ka,Ua){var e=Ua?$c.a.xNj:$c.a.wNj,C=Ua?$c.a.dmj:$c.a.cmj,J=Ua?$c.a.pag:$c.a.yNj,ja=Ua?$c.a.VWf:$c.a.emj;return ka?Jd.cEe(ka.shareId||ka.id,ka.name,Ua,ka.isShared?e:C,G,G,ka.isShared?J:ja):Jd.cEe("","",Ua,"",G,G)};Jd.cEe=function(G,ka,Ua,e,C,J,ja){C=void 0===C?null:C;J=void 0===J?null:J;ja=void 0===ja?null:ja;var Aa=void 0===Aa?null:Aa;var gb={},bc={};Ua?(gb.root=Jd.ita(32,32),bc.root=Jd.ita(32,32)):(gb.root=Jd.ita(20,20),bc.root=Jd.ita(20,
20));return Object.assign(new Fe.a,{Id:G,ExternalId:C||G,MenuItemId:J||G,Command:"1904816141",Icon:e,Image:Df.a.Fe(16),ImageClass:ja,LabelText:ka,FullIconStyle:gb,PreviewIconStyle:bc,Alt:Aa||ka})};Jd.ita=function(G,ka){var Ua={};Ua.width=G;Ua["min-width"]=G;Ua.height=ka;return Ua};Object(de.a)(Jd,"AutomateCommandRenderer",null,[]);Dd.prototype.uKa=function(G){for(var ka=0;ka<this.scripts.length;ka++)if(this.scripts[ka].id===G||this.scripts[ka].shareId===G)return ka;return-1};Dd.prototype.sort=function(){this.V5f(this.scripts)};
Dd.prototype.Yn=function(G){return-1===this.uKa(G.id)?(this.scripts.push(G),!0):!1};Dd.prototype.qYa=function(G){return-1===this.uKa(G.id)?(this.scripts=[G].concat(this.scripts),!0):!1};Dd.prototype.trf=function(G){G=this.uKa(G.id);if(-1!==G){for(var ka=this.scripts[G].Qha();0<G;)this.scripts[G]=this.scripts[G-1],G--;this.scripts[0]=ka}};Dd.prototype.Bea=function(G){var ka=this.uKa(G.id);if(-1!==ka){var Ua=this.scripts[ka].shareId;this.scripts[ka]=G;this.scripts[ka].shareId=Ua}};Dd.prototype.Kgc=
function(G){var ka=this.uKa(G.id);return-1!==ka?G.name===this.scripts[ka].name:!1};Dd.prototype.sia=function(G){G=this.uKa(G);return-1!==G?(this.scripts.splice(G,1),!0):!1};Dd.prototype.clear=function(){this.scripts=[]};Dd.prototype.getScripts=function(){return this.scripts};Dd.prototype.hz=function(G){G=this.uKa(G);return-1!==G?this.scripts[G]:null};Dd.prototype.eK=function(G){return 0<=G&&this.length>G?this.scripts[G]:null};Dd.prototype.kUe=function(G){for(var ka=new Dd([],this.V5f),Ua=0;Ua<this.scripts.length;Ua++){var e=
this.scripts[Ua];G.hz(e.id)||ka.Yn(e)}return ka};Dd.prototype.ceb=function(){for(var G=[],ka=yl(this.scripts),Ua=ka.next();!Ua.done;Ua=ka.next())G.push(Ua.value.GVd());return G};Qk.Object.defineProperties(Dd.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(de.a)(Dd,"ScriptCollection",null,[]);var Kg=b(181);Qc.prototype.Qha=function(){return new Qc(this.H$)};Qc.prototype.GVd=function(){return this.H$};Qk.Object.defineProperties(Qc.prototype,{id:{configurable:!0,
enumerable:!0,get:function(){return this.H$.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.H$.shareId},set:function(G){this.H$.shareId=G||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.H$.name}},rGe:{configurable:!0,enumerable:!0,get:function(){return this.H$.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.H$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.H$.description}},ndf:{configurable:!0,
enumerable:!0,get:function(){return this.H$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&0<this.shareId.length}}});Object(de.a)(Qc,"ScriptCore",null,[]);var bi=b(57),yi=b(39);vm(ec,ze);ec.prototype.Lbc=function(G){switch(G){case "1":case "2":case "3":return this.jy.eK(parseInt(G,10)-1);default:return this.Le.Jk.hz(G)||this.Le.Gm.hz(G)||this.Le.hg.hz(G)||this.Le.yr.hz(G)}};ec.prototype.Pac=function(G,ka,Ua){var e=null;if(this.Le.Nva)switch(G){case "1":case "2":case "3":e=
this.jy.eK(parseInt(G,10)-1);break;default:e=this.jy.hz(G)}yi.a.isReactRibbonEnabled()?(Ua=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?2===Ua:!bi.a.Rf.NC,ka[Hb.a.GalleryButtonProps]=Jd.c4b(G,e,Ua)):ka[Hb.a.InnerHTML]=Jd.KWe(e);ka[Hb.a.Alt]=e?e.name:""};ec.prototype.qB=function(G){this.jy=this.iGb();this.$.If();var ka=[];ka.push(Object.assign(new Ue.a,{name:"Operation",string:G}));ka.push(Object.assign(new Ue.a,{name:"HasReadRecentCachedScripts",
bool:this.Le.Ova}));ka.push(Object.assign(new Ue.a,{name:"ReadScriptsDone",bool:this.Le.RKa}));ka.push(Object.assign(new Ue.a,{name:"ReadSamplesScriptsDone",bool:this.Le.R6}));ka.push(Object.assign(new Ue.a,{name:"SamplesScriptCount",int64:this.Le.yr.length}));ka.push(Object.assign(new Ue.a,{name:"ReadRecentScriptsDone",bool:this.Le.Tca}));ka.push(Object.assign(new Ue.a,{name:"RecentScriptCount",int64:this.Le.Jk.length}));ka.push(Object.assign(new Ue.a,{name:"ReadWorkbookScriptsDone",bool:this.Le.kt}));
ka.push(Object.assign(new Ue.a,{name:"WorkbookScriptCount",int64:this.Le.hg.length}));Ea.a(Ee.a.Lyd,!0,0,ka)};ec.prototype.Pcc=function(G){var ka=!1,Ua="",e=new Qc(G.scriptMetadata),C={Operation:"HandleRefreshRibbonGallery"};C.RefreshOperation=G.operationName;switch(G.operationName){case $c.a.sHd:G=this.iwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.qHd:G=this.gwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.pHd:G=this.fwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.rHd:G=this.hwb(e);
Ua=G.message;ka=G.returnValue;break;case $c.a.oOf:G=this.Vid(e),Ua=G.message,ka=G.returnValue}(C.GalleryUpdated=ka)?(Te.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",Ua),this.qB("RefreshGallery")):Te.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Ua);C.Message=Ua;Te.ULS.sendTraceTag(537170320,0,50,Vh.c(C))};ec.prototype.iGb=function(){for(var G=new Dd([],
function(){}),ka=this.Le.hg?this.Le.hg.length:0,Ua=this.Le.Jk?this.Le.Jk.length:0,e=this.Le.yr?this.Le.yr.length:0,C=0,J=0;J<$c.a.AEd;J++)if(J<ka)G.Yn(this.Le.hg.eK(J));else if(J-ka+C<Ua){var ja=this.Le.Jk.eK(J-ka+C);this.Le.hg.hz(ja.id)?(C++,J--):G.Yn(ja)}else J-ka-Ua+C<e&&G.Yn(this.Le.yr.eK(J-ka+C-Ua));return G};ec.prototype.iwb=function(G){if(this.Le.Jk.qYa(G))var ka="";else{ka="";var Ua=G.Qha();this.Le.hg.Bea(Ua);this.Le.hg.sort();this.Le.Jk.Bea(G)}return{returnValue:!0,message:ka}};ec.prototype.gwb=
function(G){this.Le.hg.sia(G.id);return this.Le.Jk.sia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};ec.prototype.fwb=function(G){var ka=G.Qha();ka.shareId=null;this.Le.Jk.qYa(ka);return this.Le.hg.Yn(G)?(this.Le.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};ec.prototype.hwb=function(G){return this.Le.hg.sia(G.id)?{returnValue:!0,message:""}:
{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};ec.prototype.Vid=function(G){var ka=G.Qha(),Ua=!1;this.Le.hg.Kgc(ka)&&(this.Le.hg.Bea(ka),this.Le.hg.sort(),Ua=!0);this.Le.Jk.qYa(G)?Ua=!0:this.Le.Jk.Kgc(G)&&(this.Le.Jk.Bea(G),this.Le.Jk.trf(G),Ua=!0);return{returnValue:Ua,message:""}};Object(de.a)(ec,"AutomateCommandGallery",ze,[]);var oi=b(87);Object(de.a)(Pf,"AutomateCommandLicensingBase",null,[]);Object(de.a)(yf,"BoolResultWrapper",null,[]);vm(Kf,
Pf);Kf.prototype.xye=function(){var G=this,ka=zh.a.Ra.Lb,Ua=[];return new Promise(function(e){oi.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(C){C.isFeatureEnabled("ExcelOfficeScripting",!1).then(function(J){Ua.push(Object.assign(new Ue.a,{name:"IsLicensed",bool:J}));Ea.a(Ee.a.buf,!0,ni.getElapsedMilliseconds(ka,zh.a.Ra.Lb),Ua);G.Ux=new yf(J,!0);e(J)}).catch(function(J){Ua.push(Object.assign(new Ue.a,{name:"IsLicensed",bool:!1}));Ua.push(Object.assign(new Ue.a,
{name:"Error",string:J.toString()}));Ua.push(Object.assign(new Ue.a,{name:"ErrorCode",string:"exception"}));Ea.a(Ee.a.buf,!1,ni.getElapsedMilliseconds(ka,zh.a.Ra.Lb),Ua);G.Ux=new yf(!1,!1,void 0,"exception",J.toString());e(!1)})})})};Object(de.a)(Kf,"AutomateCommandLicensing",Pf,[]);var rj=b(1283),pj=b(1281),mj=b(1280),Eg=b(1282);ye.taskPaneWidth="TaskPaneWidth";ye.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";ye.cl="TaskPaneTitle";ye.Mj="IconCssClass";ye.PUd="TaskPaneIconUrl";
ye.vS="TaskPaneIconId";ye.eI="NonPersistedSettings";ye.onTaskPaneClose="OnTaskPaneClose";ye.gTc="ActionArgs";Object(de.a)(ye,"PropertyNames",null,[]);var Nj=b(139),Kj=b(177),$i=b(305),Fi=b(4);vm(ce,ze);ce.prototype.Lbc=function(G){switch(G){case "1":case "2":case "3":return this.jy.eK(parseInt(G,10)-1);default:return this.automateCommandManager.Jk.hz(G)||this.automateCommandManager.hg.hz(G)||this.automateCommandManager.yr.hz(G)}};ce.prototype.Pac=function(G,ka,Ua){var e=null;if(this.automateCommandManager.Nva)switch(G){case "1":case "2":case "3":e=
this.jy.eK(parseInt(G,10)-1);break;default:e=this.jy.hz(G)}yi.a.isReactRibbonEnabled()?(Ua=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?2===Ua:!bi.a.Rf.NC,ka[Hb.a.GalleryButtonProps]=Jd.c4b(G,e,Ua)):ka[Hb.a.InnerHTML]=Jd.KWe(e);ka[Hb.a.Alt]=e?e.name:""};ce.prototype.qB=function(G){this.jy=this.iGb();this.$.If();var ka=[];ka.push(Object.assign(new Ue.a,{name:"Operation",string:G}));ka.push(Object.assign(new Ue.a,{name:"HasReadRecentCachedScripts",
bool:this.automateCommandManager.Ova}));ka.push(Object.assign(new Ue.a,{name:"ReadScriptsDone",bool:this.automateCommandManager.RKa}));ka.push(Object.assign(new Ue.a,{name:"ReadSamplesScriptsDone",bool:this.automateCommandManager.R6}));ka.push(Object.assign(new Ue.a,{name:"SamplesScriptCount",int64:this.automateCommandManager.yr.length}));ka.push(Object.assign(new Ue.a,{name:"ReadRecentScriptsDone",bool:this.automateCommandManager.Tca}));ka.push(Object.assign(new Ue.a,{name:"RecentScriptCount",int64:this.automateCommandManager.Jk.length}));
ka.push(Object.assign(new Ue.a,{name:"ReadWorkbookScriptsDone",bool:this.automateCommandManager.kt}));ka.push(Object.assign(new Ue.a,{name:"WorkbookScriptCount",int64:this.automateCommandManager.hg.length}));Ea.a(Ee.a.Lyd,!0,0,ka)};ce.prototype.Pcc=function(G){var ka=!1,Ua="",e=new Qc(G.scriptMetadata),C={Operation:"HandleRefreshRibbonGallery"};C.RefreshOperation=G.operationName;switch(G.operationName){case $c.a.sHd:G=this.iwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.qHd:G=this.gwb(e);Ua=
G.message;ka=G.returnValue;break;case $c.a.pHd:G=this.fwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.rHd:G=this.hwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.oOf:G=this.Vid(e),Ua=G.message,ka=G.returnValue}(C.GalleryUpdated=ka)?(Te.ULS.sendTraceTag(537170319,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Ua),this.qB("RefreshGallery")):Te.ULS.sendTraceTag(537170318,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",
Ua);C.Message=Ua;Te.ULS.sendTraceTag(537170317,0,50,Vh.c(C))};ce.prototype.iGb=function(){for(var G=new Dd([],function(){}),ka=this.automateCommandManager.hg?this.automateCommandManager.hg.length:0,Ua=this.automateCommandManager.Jk?this.automateCommandManager.Jk.length:0,e=this.automateCommandManager.yr?this.automateCommandManager.yr.length:0,C=0,J=0;J<$c.a.AEd;J++)if(J<ka)G.Yn(this.automateCommandManager.hg.eK(J));else if(J-ka+C<Ua){var ja=this.automateCommandManager.Jk.eK(J-ka+C);this.automateCommandManager.hg.hz(ja.id)?
(C++,J--):G.Yn(ja)}else J-ka-Ua+C<e&&G.Yn(this.automateCommandManager.yr.eK(J-ka+C-Ua));return G};ce.prototype.iwb=function(G){if(this.automateCommandManager.Jk.qYa(G))var ka="";else{ka="";var Ua=G.Qha();this.automateCommandManager.hg.Bea(Ua);this.automateCommandManager.hg.sort();this.automateCommandManager.Jk.Bea(G)}return{returnValue:!0,message:ka}};ce.prototype.gwb=function(G){this.automateCommandManager.hg.sia(G.id);return this.automateCommandManager.Jk.sia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,
message:"Deleting a script but script could not be found in recent script collection."}};ce.prototype.fwb=function(G){var ka=G.Qha();ka.shareId=null;this.automateCommandManager.Jk.qYa(ka);return this.automateCommandManager.hg.Yn(G)?(this.automateCommandManager.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};ce.prototype.hwb=function(G){return this.automateCommandManager.hg.sia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,
message:"Detaching a script but the script could not be found in the collection."}};ce.prototype.Vid=function(G){var ka=G.Qha(),Ua=!1;this.automateCommandManager.hg.Kgc(ka)&&(this.automateCommandManager.hg.Bea(ka),this.automateCommandManager.hg.sort(),Ua=!0);this.automateCommandManager.Jk.qYa(G)?Ua=!0:this.automateCommandManager.Jk.Kgc(G)&&(this.automateCommandManager.Jk.Bea(G),this.automateCommandManager.Jk.trf(G),Ua=!0);return{returnValue:Ua,message:""}};Object(de.a)(ce,"AutomateCommandGalleryOld",
ze,[]);var Hj=b(20);Tc.W5f=function(G){G.sort(function(ka,Ua){return Ua.rGe-ka.rGe})};Tc.nLb=function(G){G.sort(function(ka,Ua){return Hj.a.compare(ka.name,Ua.name,!0)})};Tc.L3e=function(G){var ka;var Ua=ka=null;if(G){var e=G.indexOf(":");if(-1!==e)return ka=G.substr(0,e),Ua=G.substr(e+1),{returnValue:!0,KTd:ka,shareId:Ua}}return{returnValue:!1,KTd:ka,shareId:Ua}};Tc.MYh=function(G,ka){var Ua={};Ua[$c.a.phg]=encodeURIComponent(G.workbookContext.WorkbookFileName);Ua[$c.a.YWf]=ka.ceb();return Vh.c(Ua)};
Tc.gNf=function(G,ka){return Fh.TaskExtensions.F$(ka.cKa($c.a.yfb),function(Ua){Ua=Ua.result;if(""!==Ua){Ua=Vh.b(Ua);var e=Ua[$c.a.YWf];if(Ua[$c.a.phg]===encodeURIComponent(G.workbookContext.WorkbookFileName)){Ua=new Dd([],function(J){Tc.nLb(J)});e=yl(e);for(var C=e.next();!C.done;C=e.next())Ua.Yn(new Qc(C.value));Ua.sort();return Ua}}},G.ma,3)};Qk.Object.defineProperties(Tc.prototype,{Nva:{configurable:!0,enumerable:!0,get:function(){var G=$c.a.LK?this.Ova:this.O4;return this.R6||G||this.RKa}},RKa:{configurable:!0,
enumerable:!0,get:function(){return($c.a.LK?this.Tca:this.Q6)&&this.kt&&this.R6}}});Object(de.a)(Tc,"AutomateCommandStorageBase",null,[]);Object(de.a)(Uc,"UserInfo",null,[]);var nk=b(521),ok=b(164),hj=b(81),Rh=b(272);Object(de.a)(Sc,"LaunchSDXParams",null,[]);Object(de.a)(Qd,"RunfromButtonParameters",null,[]);var Ck=b(153),fk=b(114),al=b(27),Rk=b(913),bl=b(48),Cj=b(100),xk=b(46),Lk=b(168);Wc.prototype.Lvj=function(G){$c.a.Iq?this.Le.Gm=G:this.pee=G};Wc.prototype.Kvj=function(G){$c.a.Iq?this.Le.hg=
G:this.Oce=G};Wc.prototype.Ovj=function(G){$c.a.Iq?this.Le.yr=G:this.Sfe=G};Wc.prototype.Mvj=function(G){this.Le.Jk=G};Wc.prototype.EKb=function(G){var ka=Bf.AFrameworkApplication.ga.ra("IsO365CommercialHost"),Ua="",e="",C=!1;var J=!(this.Ov.Ux&&this.Ov.Ux.isSuccess&&this.Ov.Ux.value&&(!this.nA||!this.nA.isSuccess));this.Ov.Ux&&!this.Ov.Ux.isSuccess?(e=this.Ov.Ux.errorCode,Ua=this.Ov.Ux.errorMessage):this.nA&&!this.nA.isSuccess&&(e=this.nA.errorCode,Ua=this.nA.errorMessage);var ja=[];ja.push(Object.assign(new Ue.a,
{name:"IsScriptingEnabled",bool:this.Bba}));ja.push(Object.assign(new Ue.a,{name:"IsValidHost",bool:ka}));ja.push(Object.assign(new Ue.a,{name:"IsUserLicensed",bool:this.Ov.Ux?this.Ov.Ux.value:!1}));ja.push(Object.assign(new Ue.a,{name:"IsAdminSwitchOn",bool:this.nA?this.nA.value:!1}));ja.push(Object.assign(new Ue.a,{name:"ShowTab",bool:this.Bba}));ja.push(Object.assign(new Ue.a,{name:"ServiceChecked",bool:!G}));this.Bba&&yi.a.Xwa(this.$)&&(G=Ck.a(this.$),(null===G||void 0===G?0:G.Hm)?(ja.push(Object.assign(new Ue.a,
{name:"RibbonType",string:"React"})),G.Hm.PCj(Fi.a.dGb),ka=["AutomateRecorder","AutomateNewScript","AutomateGallery","AutomateAllScripts"],dg.EwaSettings.getBooleanFeatureGate($c.a.Jsf,!1)?G.Hm.MJb(["AutomateAutomateTask"],!$c.a.Nyd):(G.Hm.MJb(ka,!1),$c.a.Nyd&&G.Hm.MJb(["AutomateAutomateTask"],!1)),dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(C=!0)):(e="ribbon_manager_error",
Ua="The RibbonManager or RibbonUser is null"));ja.push(Object.assign(new Ue.a,{name:"Error",string:Ua}));ja.push(Object.assign(new Ue.a,{name:"ErrorCode",string:e}));Ea.a(Ee.a.zGi,J,ni.getElapsedMilliseconds(this.initTime,zh.a.Ra.Lb),ja);return Promise.resolve(C)};Wc.prototype.gd=function(G,ka){if(!ka)return!1;ka.MenuItems=this.tNg.GIh(ka.MenuId);return!0};Wc.prototype.eIf=function(){var G=this;if(this.Iwa)if($c.a.LK)this.Le.dNf(this.SP).continueWith(function(e){e.result&&G.SP.qB($c.a.WPa)});else if($c.a.Iq)this.Le.Z6i(this.SP);
else{var ka=zh.a.Ra.Lb,Ua=[];Fh.TaskExtensions.Ba(this.indexedDB.cKa($c.a.GPa),function(e){var C=!G.Q6||!G.Gm.length;e=e.result;Ua.push(Object.assign(new Ue.a,{name:"ExistingScriptCount",int64:G.Gm.length}));if(""!==e)if(e=Vh.b(e),Ua.push(Object.assign(new Ue.a,{name:"CachedScriptCount",int64:e.length})),C){for(var J=yl(e),ja=J.next();!ja.done;ja=J.next())G.Gm.Yn(new Qc(ja.value));G.Gm.sort();G.O4=!0;G.rab=0<e.length;Ea.a(Ee.a.LCb,C,ni.getElapsedMilliseconds(ka,zh.a.Ra.Lb),Ua);G.qB("CachedScripts")}else Ea.a(Ee.a.LCb,
C,ni.getElapsedMilliseconds(ka,zh.a.Ra.Lb),Ua);else Ea.a(Ee.a.LCb,C,ni.getElapsedMilliseconds(ka,zh.a.Ra.Lb),Ua)},this.$.ma,3)}Cc(this.$)?this.W2e(Object.assign(new N.a,{IsSuccess:!0,Token:"FakeToken"})):this.gsa.gbc().then(function(e){G.W2e(e)})};Wc.prototype.Pac=function(G,ka,Ua){if($c.a.LK)this.SP.Pac(G,ka,Ua);else{var e=null;if(this.Nva)switch(G){case "1":case "2":case "3":e=this.jy.eK(parseInt(G,10)-1);break;default:e=this.jy.hz(G)}ka[Hb.a.GalleryButtonProps]=Jd.c4b(G,e,this.bpi?2===Ua:!bi.a.Rf.NC);
ka[Hb.a.Alt]=e?e.name:""}};Wc.prototype.Pcc=function(G){if($c.a.LK)this.SP.Pcc(G);else{var ka=!1,Ua="",e=new Qc(G.scriptMetadata),C={Operation:"HandleRefreshRibbonGallery"};C.RefreshOperation=G.operationName;switch(G.operationName){case $c.a.sHd:G=this.iwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.qHd:G=this.gwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.pHd:G=this.fwb(e);Ua=G.message;ka=G.returnValue;break;case $c.a.rHd:G=this.hwb(e),Ua=G.message,ka=G.returnValue}(C.GalleryUpdated=ka)?
(Te.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Ua),this.qB("RefreshGallery")):Te.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Ua);C.Message=Ua;Te.ULS.sendTraceTag(537170311,0,50,Vh.c(C))}};Wc.prototype.x5h=function(G,ka,Ua,e){this.$.Ms(null,!1,1023)&&(G=new Qd($c.a.vVf,G,ka,Ua,this.Bba,e),this.zob.jwb(G))};Wc.prototype.n7e=function(G,ka,Ua){G=new Qd($c.a.tXj,
G,ka,Ua,this.Bba);this.zob.jwb(G)};Wc.prototype.n3h=function(G){this.zob.wid($c.a.bDj,G)};Wc.prototype.m3h=function(G){this.zob.wid($c.a.X1g,G)};Wc.prototype.o3h=function(G){this.zob.wid($c.a.iHj,G)};Wc.prototype.isi=function(G,ka){var Ua=bl.b().ti(G),e=[];e.push(Object.assign(new Ue.a,{name:"SessionId",string:this.$.ya.UserSessionId}));e.push(Object.assign(new Ue.a,{name:"MenuItemId",string:ka}));e.push(Object.assign(new Ue.a,{name:"WorkbookScriptCount",int64:this.hg.length}));e.push(Object.assign(new Ue.a,
{name:"PublishedScriptCount",int64:this.Gm.length}));e.push(Object.assign(new Ue.a,{name:"RecentScriptCount",int64:this.Jk.length}));e.push(Object.assign(new Ue.a,{name:"Command",string:Ua}));ka=ka?this.Lbc(ka):null;if(Ua=this.bTh(G,Ua,ka))e.push(Object.assign(new Ue.a,{name:$c.a.r$,string:Ua.Oya.hr[$c.a.r$]})),rj.a.instance.iNa(Ua.Qzh,"Taskpane",Ua.eHa,Ua.rkd,Ua.Oya),1904816141===G&&(e.push(Object.assign(new Ue.a,{name:"ScriptId",string:ka.id})),e.push(Object.assign(new Ue.a,{name:"ShareId",string:ka.shareId})),
e.push(Object.assign(new Ue.a,{name:"IsPreviewGallery",bool:$c.a.LK?!!this.SP.jy.hz(ka.id):!!this.jy.hz(ka.id)})),e.push(Object.assign(new Ue.a,{name:"IsOwner",bool:ka.ndf||!!this.Gm.hz(ka.id)})),this.$.If());Ea.a(Ee.a.wGi,void 0,void 0,e)};Wc.prototype.bTh=function(G,ka,Ua){var e=null,C=$c.a.Dr,J=new pj.a($c.a.P9e,$c.a.DVe,$c.a.locale),ja=new mj.a($c.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,$c.a.zuc),Aa=new Eg.a;Aa.hr.AdminPolicyForFeedback=Vh.c(this.QFa);Aa.hr.DocumentHostInfo=fj.a.Lc(this.$.ya.DocumentHostInfo);
Aa.hr.CodeEditorUrl=$c.a.Nub(this.$);Aa.hr.MakerTestService=dg.EwaSettings.getBooleanFeatureGate($c.a.BBb,!1);Aa.hr[$c.a.OUf]=$c.a.i3a(this.$);Aa.hr.StorageModePreference=this.n7f||"";Aa.hr.Source="Ribbon";Aa.hr.IsTeams=dj.a.Wka;Aa.hr[$c.a.b9f]=fj.a.Lc(C);Aa.hr[$c.a.Yte]=this.$.auf?"true":"false";Aa.hr[$c.a.r$]=Kj.a.create().toString();var gb=pc(this.$),bc=Yc(this.$);Aa.ri.HeaderCssClass=gb;Aa.ri.TitleCssClass=bc;Aa.hr[$c.a.L8e]=gb;Aa.hr[$c.a.i$f]=bc;gb={};gb.ribbonCommand=ka;gb[$c.a.m7f]=this.gsa.getAuthContext();
gb[$c.a.GPa]=this.rab?this.Gm.ceb():null;gb[$c.a.yfb]=this.vza?this.hg.ceb():null;$c.a.LK&&(gb[$c.a.WPa]=this.Le.GGd?this.Jk.ceb():null);Aa.hr[$c.a.Sbf]=fj.a.Lc(gb);ka={};Ic(this.$,ka);Aa.hr[$c.a.NUe]=fj.a.Lc(ka);switch(G){case -45542983:Aa.hr.Script="";Aa.hr.Destination="Editor";Aa.hr.IsOwner=!0;Aa.ri[ye.cl]=gf.a.instance.fa(2068);Aa.ri[ye.taskPaneWidth]=C;Aa.ri[ye.sourceLocationOverrideResourceId]=$c.a.Nub(this.$);e=$c.a.k1c;break;case -1342227603:Aa.ri[ye.cl]=gf.a.instance.fa(2070);Aa.ri[ye.taskPaneWidth]=
C;Aa.ri[ye.sourceLocationOverrideResourceId]=$c.a.i2e(this.$);break;case 971811139:case 1606046412:Aa.hr.Script="";Aa.hr.Destination="BackStage";Aa.hr.IsOwner=!0;Aa.ri[ye.cl]=gf.a.instance.fa(2068);Aa.ri[ye.taskPaneWidth]=C;Aa.ri[ye.sourceLocationOverrideResourceId]=$c.a.Nub(this.$);e=$c.a.k1c;break;case 1845457202:Aa.ri[ye.cl]=gf.a.instance.fa(2069);Aa.ri[ye.taskPaneWidth]=C;Aa.ri[ye.sourceLocationOverrideResourceId]=$c.a.z2e(this.$);e=$c.a.jmj;break;case 1904816141:if(Ua)Aa.hr.Script=fj.a.Lc(Ua.GVd()),
Aa.hr.Destination="Details",Aa.hr.IsOwner=Ua.ndf||!!this.Gm.hz(Ua.id),Aa.ri[ye.cl]=gf.a.instance.fa(2068),Aa.ri[ye.taskPaneWidth]=C,Aa.ri[ye.sourceLocationOverrideResourceId]=$c.a.Nub(this.$),e=$c.a.k1c;else return null;break;default:return null}return new Sc(J,ja,Aa,e)};Wc.prototype.RJh=function(){var G=this;oi.a.instance.pc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(ka){G.QFa.FeedbackEnabled=!0;G.QFa.ScreenshotEnabled=!0;G.QFa.EmailEnabled=!0;ka.XJ("Enabled").then(function(Ua){G.QFa.FeedbackEnabled=
Ua},function(){});ka.XJ("IncludeScreenshot").then(function(Ua){G.QFa.ScreenshotEnabled=Ua},function(){});ka.XJ("IncludeEmail").then(function(Ua){G.QFa.EmailEnabled=Ua},function(){})})};Wc.prototype.c6h=function(G){var ka=this,Ua=zh.a.Ra.Lb,e=[];if(!G||!G.IsSuccess){var C=G?G.ErrorCode:"need_token";G=G?G.ErrorMessage:"No Access Token";e.push(Object.assign(new Ue.a,{name:"ServiceChecked",bool:!1}));e.push(Object.assign(new Ue.a,{name:"Error",string:G}));e.push(Object.assign(new Ue.a,{name:"ErrorCode",
string:C}));Ea.a(Ee.a.Jyd,!1,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);this.nA=new yf(!1,!1,void 0,C,G);return Promise.resolve(!1)}e.push(Object.assign(new Ue.a,{name:"ServiceChecked",bool:!0}));ob(this.$,G.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(J){ka.nA=new yf(J.OfficeScriptingEnabled,!0);ka.hZc($c.a.S$b(ka.$),J.OfficeScriptingEnabled);e.push(Object.assign(new Ue.a,{name:"IsEnabled",bool:ka.nA.value}));Ea.a(Ee.a.Jyd,!0,ni.getElapsedMilliseconds(Ua,
zh.a.Ra.Lb),e);return Promise.resolve(ka.nA.value)}).catch(function(J){Object.getType(J)===makerstorage.StorageServiceError?(e.push(Object.assign(new Ue.a,{name:"Error",string:J.message})),e.push(Object.assign(new Ue.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",J.errorCode.toString(),J.status.toString())}))):(e.push(Object.assign(new Ue.a,{name:"Error",string:J.toString()})),e.push(Object.assign(new Ue.a,{name:"ErrorCode",string:"exception"})));Ea.a(Ee.a.Jyd,!1,ni.getElapsedMilliseconds(Ua,
zh.a.Ra.Lb),e);ka.nA=new yf(!1,!1,void 0,"exception",J.toString());return Promise.resolve(!1)})};Wc.prototype.HGd=function(G){var ka=this;if($c.a.Iq)return this.Le.HGd(G,this.SP);var Ua=new Nj.a,e=Be(this.$);return Ce(this.$,function(C){if((C=C.Result)&&200===C.ResponseStatusCode)C=C.ResponseBody.join(""),C=JSON.parse(C),G(ka.SCd(C.value)),Ua.setResult(!0);else{C=C?"RichApi_"+C.ResponseStatusCode:"RichApiError";var J=[];J.push(Object.assign(new Ue.a,{name:"Error",string:"Failed to read shared script ids from document"}));
J.push(Object.assign(new Ue.a,{name:"ErrorCode",string:C}));ka.kt=!0;ka.nU(zh.a.Ra.Lb,0,J);Ua.setResult(!1)}},function(C){C=fk.a.og(C.data);Te.ULS.sendTraceTag(537170310,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",al.a.Uc(C));var J=[];J.push(Object.assign(new Ue.a,{name:"Error",string:"Failure using rich api: "+C}));J.push(Object.assign(new Ue.a,{name:"ErrorCode",string:"RichApiFailure"}));ka.kt=!0;ka.nU(zh.a.Ra.Lb,0,J);Ua.setResult(!1)},e,Ua)};Wc.prototype.W2e=function(G){var ka=
this;this.Dgd();$c.a.LK?this.Le.lXh(G,this.SP,this.cache):this.JWh(G);this.HGd(function(Ua){ka.Qgd(Ua,G)})};Wc.prototype.Dgd=function(){if($c.a.Iq)this.Le.Dgd(this.SP);else{var G={id:"samples-2"};G.name=gf.a.instance.fa(2082);this.yr.Yn(new Qc(G));G.id="samples-4";G.name=gf.a.instance.fa(2083);this.yr.Yn(new Qc(G));G.id="samples-5";G.name=gf.a.instance.fa(2084);this.yr.Yn(new Qc(G));this.R6=!0;this.qB("SampleScripts")}};Wc.prototype.JWh=function(G){var ka=this,Ua=zh.a.Ra.Lb,e=[];if(G&&G.IsSuccess){ob(this.$,
G.Token);var C=Bh.a.create().toString();e.push(Object.assign(new Ue.a,{name:"CorrelationId",string:C}));makerstorage.getScripts(C).then(function(J){e.push(Object.assign(new Ue.a,{name:"HasReadCachedScripts",bool:ka.O4}));ka.Gm.clear();J=yl(J);for(var ja=J.next();!ja.done;ja=J.next())ka.Gm.Yn(new Qc(ja.value));ka.Gm.sort();ka.rab=!0;ka.Q6=!0;ka.Iwa&&(J=fj.a.Lc(ka.Gm.ceb()),ka.indexedDB.Qbb(new Rk.a($c.a.GPa,J)));e.push(Object.assign(new Ue.a,{name:"ScriptCount",int64:ka.Gm.length}));Ea.a(Ee.a.MCb,
!0,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);ka.qB($c.a.GPa)}).catch(function(J){Object.getType(J)===makerstorage.StorageServiceError?(e.push(Object.assign(new Ue.a,{name:"Error",string:J.message})),e.push(Object.assign(new Ue.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",J.errorCode.toString(),J.status.toString())})),17===J.errorCode&&ka.cache.wId($c.a.S$b(ka.$))):(e.push(Object.assign(new Ue.a,{name:"Error",string:J.toString()})),e.push(Object.assign(new Ue.a,{name:"ErrorCode",
string:"exception"})));Ea.a(Ee.a.MCb,!1,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);ka.Q6=!0;ka.qB($c.a.GPa)})}else C=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",e.push(Object.assign(new Ue.a,{name:"ServiceChecked",bool:!1})),e.push(Object.assign(new Ue.a,{name:"Error",string:G})),e.push(Object.assign(new Ue.a,{name:"ErrorCode",string:C})),Ea.a(Ee.a.MCb,!1,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e),this.Q6=!0,this.qB($c.a.GPa)};Wc.prototype.Qgd=function(G,ka){var Ua=this;if($c.a.Iq)this.Le.Qgd(G,
ka,this.SP);else{var e=zh.a.Ra.Lb,C=0,J=0;this.kt=C===G.count;var ja=[];ja.push(Object.assign(new Ue.a,{name:"ScriptIds",int64:G.count}));if(G.count)if(ka&&ka.IsSuccess){ob(this.$,ka.Token);var Aa={};ka=yl(G);for(var gb=ka.next();!gb.done;Aa={Jfb:Aa.Jfb},gb=ka.next())gb=gb.value,Aa.Jfb=Bh.a.create().toString(),makerstorage.getSharedScript(gb.value,Aa.Jfb).then(function(bc){return function(Mc){var Hc=[];Hc.push(Object.assign(new Ue.a,{name:"BodySize",int64:Mc.body.length}));Hc.push(Object.assign(new Ue.a,
{name:"CorrelationId",string:bc.Jfb}));Ea.a(Ee.a.bmc,!0,ni.getElapsedMilliseconds(e,zh.a.Ra.Lb),Hc);C++;Mc=new Qc(Mc);Mc.shareId=G.oa(Mc.id);Ua.hg.Yn(Mc);Ua.kt=C===G.count;Ua.vza=!0;Ua.nU(e,J,ja)}}(Aa)).catch(function(bc){return function(Mc){var Hc=[];Object.getType(Mc)===makerstorage.StorageServiceError?(ja.push(Object.assign(new Ue.a,{name:"Error",string:Mc.message})),ja.push(Object.assign(new Ue.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Mc.errorCode.toString(),Mc.status.toString())}))):
(Hc.push(Object.assign(new Ue.a,{name:"Error",string:Mc.toString()})),Hc.push(Object.assign(new Ue.a,{name:"ErrorCode",string:"exception"})));Hc.push(Object.assign(new Ue.a,{name:"CorrelationId",string:bc.Jfb}));Ea.a(Ee.a.bmc,!1,ni.getElapsedMilliseconds(e,zh.a.Ra.Lb),Hc);C++;J++;Ua.kt=C===G.count;Ua.nU(e,J,ja)}}(Aa))}else Aa=ka?ka.ErrorCode:"need_token",ka=ka?ka.ErrorMessage:"No Access Token",ja.push(Object.assign(new Ue.a,{name:"Error",string:ka})),ja.push(Object.assign(new Ue.a,{name:"ErrorCode",
string:Aa})),this.kt=!0,this.nU(e,J,ja);else this.kt=this.vza=!0,this.nU(e,J,ja)}};Wc.prototype.nU=function(G,ka,Ua){this.kt&&(Ua.push(Object.assign(new Ue.a,{name:"ScriptCount",int64:this.hg.length})),Ua.push(Object.assign(new Ue.a,{name:"ScriptErrorCount",int64:ka})),Ea.a(Ee.a.duf,!ka,ni.getElapsedMilliseconds(G,zh.a.Ra.Lb),Ua),this.hg.sort(),this.qB($c.a.yfb))};Wc.prototype.SCd=function(G){var ka=new Cj.a;if(G=Wc.Mta.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");
for(var Ua={},e=0;e<G.length;Ua={lPb:Ua.lPb,iPb:Ua.iPb,cPb:Ua.cPb},e++)Ua.lPb=G[e].getAttribute("id"),Ua.lPb&&(Ua.iPb=void 0,Ua.cPb=void 0,function(C){return function(){var J=Tc.L3e(C.lPb);C.iPb=J.KTd;C.cPb=J.shareId;return J}}(Ua)().returnValue&&ka.ia(Ua.iPb,Ua.cPb))}return ka};Wc.prototype.Lbc=function(G){if($c.a.LK)return this.SP.Lbc(G);switch(G){case "1":case "2":case "3":return this.jy.eK(parseInt(G,10)-1);default:return this.Gm.hz(G)||this.hg.hz(G)||this.yr.hz(G)}};Wc.prototype.iwb=function(G){if(this.Gm.Yn(G)){this.Gm.sort();
var ka=""}else{ka="";var Ua=G.Qha();this.hg.Bea(Ua);this.hg.sort();this.Gm.Bea(G);this.Gm.sort()}return{returnValue:!0,message:ka}};Wc.prototype.gwb=function(G){this.hg.sia(G.id);return this.Gm.sia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};Wc.prototype.fwb=function(G){var ka=G.Qha();ka.shareId=null;this.Gm.Yn(ka)&&this.Gm.sort();return this.hg.Yn(G)?(this.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,
message:"Could not attach a script that is already attached."}};Wc.prototype.hwb=function(G){return this.hg.sia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};Wc.prototype.qB=function(G){if($c.a.LK)this.SP.qB(G);else{this.iGb();this.$.If();var ka=[];ka.push(Object.assign(new Ue.a,{name:"Operation",string:G}));ka.push(Object.assign(new Ue.a,{name:"HasReadCachedScripts",bool:this.O4}));ka.push(Object.assign(new Ue.a,
{name:"ReadScriptsDone",bool:this.RKa}));ka.push(Object.assign(new Ue.a,{name:"ReadSamplesScriptsDone",bool:this.R6}));ka.push(Object.assign(new Ue.a,{name:"SamplesScriptCount",int64:this.yr.length}));ka.push(Object.assign(new Ue.a,{name:"ReadPublishedScriptsDone",bool:this.Q6}));ka.push(Object.assign(new Ue.a,{name:"PublishedScriptCount",int64:this.Gm.length}));ka.push(Object.assign(new Ue.a,{name:"ReadWorkbookScriptsDone",bool:this.kt}));ka.push(Object.assign(new Ue.a,{name:"WorkbookScriptCount",
int64:this.hg.length}));Ea.a(Ee.a.Lyd,!0,0,ka)}};Wc.prototype.iGb=function(){this.jy=new Dd([],function(){});for(var G=this.hg?this.hg.length:0,ka=this.Gm?this.Gm.length:0,Ua=this.yr?this.yr.length:0,e=0,C=0;C<$c.a.AEd;C++)if(C<G)this.jy.Yn(this.hg.eK(C));else if(C-G+e<ka){var J=this.Gm.eK(C-G+e);this.hg.hz(J.id)?(e++,C--):this.jy.Yn(J)}else C-G-ka+e<Ua&&this.jy.Yn(this.yr.eK(C-G+e-ka))};Wc.prototype.hZc=function(G,ka){if($c.a.Iq)this.Le.hZc(G,ka);else if(this.cache.rg()){var Ua={};Ua.TimeStamp=zh.a.Ra.Lb;
Ua.IsEnabled=ka;this.cache.Uvc(G,fj.a.Lc(Ua))}};Wc.prototype.wdd=function(G){if($c.a.Iq)return this.Le.wdd(G);var ka=!1,Ua=!1,e=null;this.cache.rg()&&(G=Vh.b(this.cache.N3a(G)))&&(Ua=G.IsEnabled,e=new Date(G.TimeStamp),ka=!0);return new yf(Ua,ka,e)};Wc.prototype.bKd=function(G){dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(G?(xk.PageLoadTrackingInfo.instance.Y6(Fi.a.kO,
["automateTab"]),xk.PageLoadTrackingInfo.instance.k0(Fi.a.kO,["automateTab"]),xk.PageLoadTrackingInfo.instance.PW(Fi.a.kO,["automateTab"])):(xk.PageLoadTrackingInfo.instance.uQa(Fi.a.kO,["automateTab"]),dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&Lk.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(Fi.a.dGb))))};Qk.Object.defineProperties(Wc.prototype,{Gm:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.Gm:this.pee}},
hg:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.hg:this.Oce}},yr:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.yr:this.Sfe}},Jk:{configurable:!0,enumerable:!0,get:function(){return this.Le.Jk}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.EPc}},R6:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.R6:this.Jee},set:function(G){$c.a.Iq?this.Le.R6=G:this.Jee=G}},kt:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?
this.Le.kt:this.Lee},set:function(G){$c.a.Iq?this.Le.kt=G:this.Lee=G}},Tca:{configurable:!0,enumerable:!0,get:function(){return this.Le.Tca}},Ova:{configurable:!0,enumerable:!0,get:function(){return this.Le.Ova}},RKa:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.RKa:($c.a.LK?this.Tca:this.Q6)&&this.kt&&this.R6}},Nva:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.Nva:($c.a.LK?this.Ova:this.O4)||this.RKa}},jy:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq||
$c.a.LK?this.SP.jy:this.fee},set:function(G){$c.a.Iq||$c.a.LK?this.SP.jy=G:this.fee=G}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.Cqg}},Bba:{configurable:!0,enumerable:!0,get:function(){var G=!!this.Ov.Ux&&this.Ov.Ux.isSuccess&&this.Ov.Ux.value,ka=!!this.nA&&!this.nA.isSuccess,Ua=!!this.nA&&this.Ov.Ux.isSuccess&&this.nA.value;return this.Pif&&G&&(Ua||ka&&!dj.a.Ska(11))}},rab:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.rab:this.Hee},set:function(G){$c.a.Iq?
this.Le.rab=G:this.Hee=G}},vza:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.vza:this.Kee},set:function(G){$c.a.Iq?this.Le.vza=G:this.Kee=G}},O4:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.O4:this.t7d},set:function(G){$c.a.Iq?this.Le.O4=G:this.t7d=G}},Q6:{configurable:!0,enumerable:!0,get:function(){return $c.a.Iq?this.Le.Q6:this.Iee},set:function(G){$c.a.Iq?this.Le.Q6=G:this.Iee=G}},Pif:{configurable:!0,enumerable:!0,get:function(){var G="TestHost"===
this.$.ya.DocumentHostInfo.HostTier,ka=Bf.AFrameworkApplication.ga.Ua("UserPrincipalName");ka=!Bf.AFrameworkApplication.ga.ra("IsAnonymousUser")&&!!ka&&!ka.includes("ext#")&&!ka.includes("guest#");return!dj.a.Pwa&&(G||this.gsa.ete&&ka)}}});Wc.Mta=new DOMParser;Object(de.a)(Wc,"AutomateCommandManager",null,[787]);var Dj=b(1339),Vj=b(1285),Ij=b(232);oc.key="InsertAgaveClientSideParametersKey";Object(de.a)(oc,"InsertAgaveClientSideParameters",null,[]);var aj=b(56),yk=b(102),Qi=b(19),sk=b(1096);yb.prototype.jwb=
function(G){if(G.Bba){var ka=[];ka.push(Object.assign(new Ue.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.V6a}));ka.push(Object.assign(new Ue.a,{name:"actionName",string:G.actionName}));ka.push(Object.assign(new Ue.a,{name:$c.a.r$,string:G.clickId.toString()}));this.V6a?this.QXf(G):this.W3h(G);Ea.a(Ee.a.xGi,void 0,void 0,ka)}};yb.prototype.wid=function(G,ka){var Ua={};Ua[$c.a.r$]=ka;this.vNd(G,Ua)};yb.prototype.fwj=function(){this.N2f()?this.KIf():Qi.g(this.$).Ca.fne(this.d9a)};yb.prototype.N2f=
function(){if(this.V6a||Cc(this.$))return!1;var G=yk.a(this.$);return Qi.g(this.$).Ca.HZb&&G.Nfi()};yb.prototype.KIf=function(){var G=this;this.Ov.Ux?this.Ov.Ux.value&&this.gsa.gbc():this.Ov.xye().then(function(ka){ka&&G.gsa.gbc()});Ea.a(Ee.a.tGi)};yb.prototype.voj=function(){var G=Kj.a.create().toString(),ka={};Ic(this.$,ka);var Ua={};Ua[$c.a.m7f]=this.gsa.getAuthContext();var e={};e[$c.a.NUe]=fj.a.Lc(ka);e[$c.a.Sbf]=fj.a.Lc(Ua);e[$c.a.yhh]=fj.a.Lc(this.$.ya.DocumentHostInfo);e[$c.a.pHj]=Xe(this.$);
e[$c.a.b9f]=fj.a.Lc($c.a.Dr);e[$c.a.Yte]=this.$.auf?"true":"false";e[$c.a.OUf]=$c.a.i3a(this.$);e[$c.a.L8e]=pc(this.$);e[$c.a.i$f]=Yc(this.$);e[$c.a.r$]=G;ka=[];ka.push(Object.assign(new Ue.a,{name:$c.a.r$,string:G}));Ea.a(Ee.a.vGi,void 0,void 0,ka);this.vNd($c.a.Cai,e)};yb.prototype.W3h=function(G){var ka=this;this.yAj(G);Cc(this.$)&&ob(this.$,"localstorage");Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.Wa(this.$.da,374,375,1),function(Ua){ka.Nti(Ua.result).continueWith(function(){ka.uoj(G)});ka.V6a=
!0},this.$.ma,3)};yb.prototype.Nti=function(G){var ka={};ka.SolutionId=$c.a.solutionId;ka.Version=$c.a.zuc;ka.StoreType=OSF.StoreType.Sdx;ka.StoreId=OSF.StoreType.Sdx;ka.AssetId=$c.a.solutionId;ka.AssetStoreId=OSF.StoreType.Sdx;ka.TargetType=1;ka.SharedRuntimeId=$c.a.zvb(this.$);ka.SourceLocationOverrideResourceId=$c.a.zvb(this.$);ka.IsToBePersisted=!1;ka.Id=$c.a.solutionId;ka.AppVersion=$c.a.zuc;ka.CurrentStoreType=OSF.StoreType.Sdx;var Ua=new Dj.a;Ua.cl=gf.a.instance.fa(2088);Ua.taskPaneWidth=$c.a.Dr;
var e=new oc;e.xMb=Yc(this.$);e.Yaa=pc(this.$);return G.wMd(ka,Ua,void 0,void 0,e)};yb.prototype.uoj=function(G){this.voj();Ij.a(this.$)&&Ij.a(this.$).sne(this.GJi);this.QXf(G)};yb.prototype.QXf=function(G){var ka={};ka[$c.a.zkj]=G.shapeId;ka[$c.a.ykj]=G.scriptLink;ka[$c.a.r$]=G.clickId.toString();ka[$c.a.xkj]=G.buttonText;this.vNd(G.actionName,ka)};yb.prototype.vNd=function(G,ka){var Ua=new mj.a($c.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,$c.a.zuc),e=new pj.a($c.a.P9e,$c.a.DVe,this.$.ya.UICultureTag),
C=new Eg.a;C.ri[ye.cl]=gf.a.instance.fa(2088);C.ri[ye.sourceLocationOverrideResourceId]=$c.a.zvb(this.$);C.ri[ye.gTc]=ka;C.ri[ye.taskPaneWidth]=$c.a.Dr;rj.a.instance.iNa(Ua,Vj.a.action,G,e,C)};yb.prototype.yAj=function(G){dg.EwaSettings.getBooleanFeatureGate($c.a.c9f,!1)&&G.actionName===$c.a.vVf&&(G=new sk.a(G.scriptLink,"initializing",G.clickId.toString(),G.buttonText),this.businessBarManager.nme(63,G))};Object(de.a)(yb,"AutomateCommandRunFromButton",null,[727]);vm(wc,Tc);wc.prototype.hZc=function(G,
ka){if(this.cache.rg()){var Ua={};Ua.TimeStamp=zh.a.Ra.Lb;Ua.IsEnabled=ka;this.cache.Uvc(G,fj.a.Lc(Ua))}};wc.prototype.wdd=function(G){var ka=!1,Ua=!1,e=null;this.cache.rg()&&(G=Vh.b(this.cache.N3a(G)))&&(Ua=G.IsEnabled,e=new Date(G.TimeStamp),ka=!0);return new yf(Ua,ka,e)};wc.prototype.dNf=function(G){var ka=this,Ua=zh.a.Ra.Lb,e=[];return Fh.TaskExtensions.F$(this.indexedDB.cKa($c.a.WPa),function(C){var J=!ka.Tca||!ka.Jk.length;C=C.result;e.push(Object.assign(new Ue.a,{name:"ExistingScriptCount",
int64:ka.Jk.length}));if(""!==C&&(C=Vh.b(C),e.push(Object.assign(new Ue.a,{name:"CachedScriptCount",int64:C.length})),J)){for(var ja=yl(C),Aa=ja.next();!Aa.done;Aa=ja.next())ka.Jk.Yn(new Qc(Aa.value));ka.Ova=!0;ka.GGd=0<C.length;Ea.a(Ee.a.cuf,J,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);ka.nHd(G);return!0}Ea.a(Ee.a.cuf,J,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);return!1},this.$.ma,3)};wc.prototype.Z6i=function(G){dg.EwaSettings.getBooleanFeatureGate($c.a.EXc,!1)&&this.d7i(G);$c.a.LK?this.dNf(G):
this.Y6i(G)};wc.prototype.lXh=function(G,ka,Ua){var e=this,C=zh.a.Ra.Lb,J=[];if(G&&G.IsSuccess){ob(this.$,G.Token);var ja=Bh.a.create().toString();J.push(Object.assign(new Ue.a,{name:"CorrelationId",string:ja}));makerstorage.getRecentScripts(ja).then(function(Aa){J.push(Object.assign(new Ue.a,{name:"HasReadCachedScripts",bool:e.Ova}));e.Jk.clear();Aa=yl(Aa);for(var gb=Aa.next();!gb.done;gb=Aa.next())e.Jk.Yn(new Qc(gb.value));e.GGd=!0;e.Tca=!0;e.indexedDB.rg()&&(Aa=fj.a.Lc(e.Jk.ceb()),e.indexedDB.Qbb(new Rk.a($c.a.WPa,
Aa)));J.push(Object.assign(new Ue.a,{name:"ScriptCount",int64:e.Jk.length}));Ea.a(Ee.a.MCb,!0,ni.getElapsedMilliseconds(C,zh.a.Ra.Lb),J);ka.qB($c.a.WPa)}).catch(function(Aa){Object.getType(Aa)===makerstorage.StorageServiceError?(J.push(Object.assign(new Ue.a,{name:"Error",string:Aa.message})),J.push(Object.assign(new Ue.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Aa.errorCode.toString(),Aa.status.toString())})),17===Aa.errorCode&&Ua.wId($c.a.S$b(e.$))):(J.push(Object.assign(new Ue.a,
{name:"Error",string:Aa.toString()})),J.push(Object.assign(new Ue.a,{name:"ErrorCode",string:"exception"})));Ea.a(Ee.a.uGi,!1,ni.getElapsedMilliseconds(C,zh.a.Ra.Lb),J);e.Tca=!0;ka.qB($c.a.WPa)})}else ja=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",J.push(Object.assign(new Ue.a,{name:"ServiceChecked",bool:!1})),J.push(Object.assign(new Ue.a,{name:"Error",string:G})),J.push(Object.assign(new Ue.a,{name:"ErrorCode",string:ja})),Ea.a(Ee.a.MCb,!1,ni.getElapsedMilliseconds(C,zh.a.Ra.Lb),
J),this.Tca=!0,ka.qB($c.a.WPa)};wc.prototype.HGd=function(G,ka){var Ua=this,e=new Nj.a,C=Be(this.$);return Ce(this.$,function(J){if((J=J.Result)&&200===J.ResponseStatusCode)J=J.ResponseBody.join(""),J=JSON.parse(J),G(Ua.SCd(J.value)),e.setResult(!0);else{J=J?"RichApi_"+J.ResponseStatusCode:"RichApiError";var ja=[];ja.push(Object.assign(new Ue.a,{name:"Error",string:"Failed to read shared script ids from document"}));ja.push(Object.assign(new Ue.a,{name:"ErrorCode",string:J}));Ua.kt=!0;Ua.nU(ka,zh.a.Ra.Lb,
0,ja);e.setResult(!1)}},function(J){J=fk.a.og(J.data);Te.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var ja=[];ja.push(Object.assign(new Ue.a,{name:"Error",string:"Failure using rich api: "+J}));ja.push(Object.assign(new Ue.a,{name:"ErrorCode",string:"RichApiFailure"}));Ua.kt=!0;Ua.nU(ka,zh.a.Ra.Lb,0,ja);e.setResult(!1)},C,e)};wc.prototype.Qgd=function(G,ka,Ua){var e=this,C=zh.a.Ra.Lb,J=0,ja=0;this.kt=J===G.count;var Aa=[];Aa.push(Object.assign(new Ue.a,
{name:"ScriptIds",int64:G.count}));if(G.count)if(ka&&ka.IsSuccess){ob(this.$,ka.Token);var gb={};ka=yl(G);for(var bc=ka.next();!bc.done;gb={Kfb:gb.Kfb},bc=ka.next())bc=bc.value,gb.Kfb=Bh.a.create().toString(),makerstorage.getSharedScript(bc.value,gb.Kfb).then(function(Mc){return function(Hc){var yd=[];yd.push(Object.assign(new Ue.a,{name:"BodySize",int64:Hc.body.length}));yd.push(Object.assign(new Ue.a,{name:"CorrelationId",string:Mc.Kfb}));Ea.a(Ee.a.bmc,!0,ni.getElapsedMilliseconds(C,zh.a.Ra.Lb),
yd);J++;Hc=new Qc(Hc);Hc.shareId=G.oa(Hc.id);e.hg.Yn(Hc);e.kt=J===G.count;e.vza=!0;e.nU(Ua,C,ja,Aa)}}(gb)).catch(function(Mc){return function(Hc){var yd=[];Object.getType(Hc)===makerstorage.StorageServiceError?(Aa.push(Object.assign(new Ue.a,{name:"Error",string:Hc.message})),Aa.push(Object.assign(new Ue.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Hc.errorCode.toString(),Hc.status.toString())}))):(yd.push(Object.assign(new Ue.a,{name:"Error",string:Hc.toString()})),yd.push(Object.assign(new Ue.a,
{name:"ErrorCode",string:"exception"})));yd.push(Object.assign(new Ue.a,{name:"CorrelationId",string:Mc.Kfb}));Ea.a(Ee.a.bmc,!1,ni.getElapsedMilliseconds(C,zh.a.Ra.Lb),yd);J++;ja++;e.kt=J===G.count;e.nU(Ua,C,ja,Aa)}}(gb)).finally(function(){if(dg.EwaSettings.getBooleanFeatureGate($c.a.EXc,!1)&&e.indexedDB.rg()&&e.kt){var Mc=Tc.MYh(e.$,e.hg);e.indexedDB.Qbb(new Rk.a($c.a.yfb,Mc))}})}else gb=ka?ka.ErrorCode:"need_token",ka=ka?ka.ErrorMessage:"No Access Token",Aa.push(Object.assign(new Ue.a,{name:"Error",
string:ka})),Aa.push(Object.assign(new Ue.a,{name:"ErrorCode",string:gb})),this.kt=!0,this.nU(Ua,C,ja,Aa);else this.kt=this.vza=!0,this.nU(Ua,C,ja,Aa),dg.EwaSettings.getBooleanFeatureGate($c.a.EXc,!1)&&Fh.TaskExtensions.F$(Tc.gNf(this.$,this.indexedDB),function(Mc){Mc.result&&(e.indexedDB.k6c($c.a.yfb),e.hg.clear(),Ua.qB("CachedScripts"))},this.$.ma,3)};wc.prototype.Dgd=function(G){var ka={id:"samples-6"};ka.name=gf.a.instance.fa(2085);this.yr.Yn(new Qc(ka));ka.id="samples-8";ka.name=gf.a.instance.fa(2086);
this.yr.Yn(new Qc(ka));ka.id="samples-2";ka.name=gf.a.instance.fa(2082);this.yr.Yn(new Qc(ka));ka.id="samples-4";ka.name=gf.a.instance.fa(2083);this.yr.Yn(new Qc(ka));ka.id="samples-5";ka.name=gf.a.instance.fa(2084);this.yr.Yn(new Qc(ka));this.R6=!0;G.qB("SampleScripts")};wc.prototype.SCd=function(G){var ka=new Cj.a;if(G=this.Mta.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");for(var Ua={},e=0;e<G.length;Ua={mPb:Ua.mPb,jPb:Ua.jPb,dPb:Ua.dPb},
e++)Ua.mPb=G[e].getAttribute("id"),Ua.mPb&&(Ua.jPb=void 0,Ua.dPb=void 0,function(C){return function(){var J=Tc.L3e(C.mPb);C.jPb=J.KTd;C.dPb=J.shareId;return J}}(Ua)().returnValue&&ka.ia(Ua.jPb,Ua.dPb))}return ka};wc.prototype.d7i=function(G){var ka=this,Ua=zh.a.Ra.Lb,e=[];Fh.TaskExtensions.F$(Tc.gNf(this.$,this.indexedDB),function(C){var J=C.result;e.push(Object.assign(new Ue.a,{name:"ExistingScriptCount",int64:ka.hg.length}));if(J){e.push(Object.assign(new Ue.a,{name:"CachedScriptCount",int64:J.length}));
if(C=!ka.kt||0===ka.hg.length){J=yl(J.getScripts());for(var ja=J.next();!ja.done;ja=J.next())ka.hg.Yn(ja.value);ka.hg.sort();Ea.a(Ee.a.Kyd,C,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);ka.nHd(G);return!0}Ea.a(Ee.a.Kyd,C,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e)}else Ea.a(Ee.a.Kyd,!1,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);return!1},this.$.ma,3)};wc.prototype.Y6i=function(G){var ka=this,Ua=zh.a.Ra.Lb,e=[];Fh.TaskExtensions.F$(this.indexedDB.cKa($c.a.GPa),function(C){var J=!ka.Q6||!ka.Gm.length;
C=C.result;e.push(Object.assign(new Ue.a,{name:"ExistingScriptCount",int64:ka.Gm.length}));if(""!==C&&(C=Vh.b(C),e.push(Object.assign(new Ue.a,{name:"CachedScriptCount",int64:C.length})),J)){C=yl(C);for(var ja=C.next();!ja.done;ja=C.next())ka.Gm.Yn(new Qc(ja.value));ka.Gm.sort();Ea.a(Ee.a.LCb,J,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);ka.nHd(G);return!0}Ea.a(Ee.a.LCb,J,ni.getElapsedMilliseconds(Ua,zh.a.Ra.Lb),e);return!1},this.$.ma,3)};wc.prototype.nU=function(G,ka,Ua,e){this.kt&&(e.push(Object.assign(new Ue.a,
{name:"ScriptCount",int64:this.hg.length})),e.push(Object.assign(new Ue.a,{name:"ScriptErrorCount",int64:Ua})),Ea.a(Ee.a.duf,!Ua,ni.getElapsedMilliseconds(ka,zh.a.Ra.Lb),e),this.hg.sort(),G.qB($c.a.yfb))};wc.prototype.nHd=function(G){this.O4=!0;G.qB("CachedScripts")};Object(de.a)(wc,"AutomateCommandStorage",Tc,[]);var hl=Ug.a;vm(Vb,hl);Vb.prototype.create=function(){var G=this,ka=aj.GetServiceTaskFactory.Wa(this.$.da,349,350,this.ub),Ua=Df.a.loadScript(109,4,this.ub,void 0,void 0,351),e=aj.GetServiceTaskFactory.create(this.$.da,
102,this.$.ma,this.ub),C=aj.GetServiceTaskFactory.create(this.$.da,396,this.$.ma,this.ub),J=aj.GetServiceTaskFactory.Wa(this.$.da,5,4,this.ub);Fh.TaskExtensions.Ba(Fh.TaskExtensions.we([ka,Ua,e,C,J],this.ma,3),function(){var ja=ka.result,Aa=C.result,gb=J.result,bc=new Kf,Mc=new ie(G.$,ja,bc),Hc=new wc(G.$,Aa),yd=new ec(G.$,Hc);gb=new yb(G.$,Mc,bc,gb);G.Gb(G.$.da.Aa(352)||new Wc(G.$,ja,e.result,Aa,gb,bc,Mc,Hc,yd))},this.ma,3)};Vb.ka=function(G){G&&G.da.Ha(351,new Vb(G))};Object(de.a)(Vb,"AutomateCommandManagerFactory",
Ug.a,[]);var Sk=b(98),cl=b(1286),Hi=b(175),ak=b(52);wf.prototype.Zc=function(){return!1};wf.prototype.executeCommand=function(G,ka,Ua){G=!1;switch(ka.command){case 73979048:this.yrb&&this.yrb.b1i(ka,Sk.a.instance,Bf.AFrameworkApplication.ga,Ua),G=!0}return G?ak.Task.Ta(!0):Hi.a(ka.command)};wf.prototype.Kc=function(G,ka){return 73979048===ka.command&&dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};wf.prototype.gd=function(){return!1};wf.prototype.dispose=function(){this.yrb&&
this.yrb.dispose()};Object(de.a)(wf,"DataFromPictureCommandHandler",null,[239,2]);var Dk=Aj.a;vm(Cd,Dk);Cd.prototype.Pd=function(){var G=this,ka=aj.GetServiceTaskFactory.Wa(this.$.da,328,327,1),Ua=aj.GetServiceTaskFactory.Wa(this.$.da,484,485,1);Fh.TaskExtensions.Ba(Fh.TaskExtensions.we([ka,Ua],this.$.ma),function(){G.Gd([new wf(G.$,ka.result,Ua.result)])},this.$.ma,3)};Cd.ka=function(G){Aj.a.he(452,new Cd(G))};Object(de.a)(Cd,"DataFromPictureCommandHandlerFactory",Aj.a,[]);var ug=b(845),tk=b(89),
vi=b(818);Yd.wD=function(G,ka,Ua){Ua?Yd.Tc(G,ka):Yd.ml(G,ka)};Yd.Tc=function(G,ka){if(!vi.c(G)){var Ua=G.className;if(vi.c(Ua)||-1===Ua.indexOf(ka))ka=Ua.trim()+" "+ka,ka=ka.trim(),G.className=ka}};Yd.ml=function(G,ka){if(!(vi.c(G)||vi.c(ka)||vi.c(G.className))){var Ua=G.className;Ua!==Ua.replace(ka,"")&&(G.className=Ua.replace(ka,""))}};Yd.m7=function(G,ka,Ua,e){Ua=void 0===Ua?!1:Ua;e=void 0===e?!1:e;vi.c(G)||Ua||(Yd.wD(G,"cui-disabled",!ka),ka=ka?tk.a.Oo:tk.a.uj,tk.a.Xg(G,tk.a.hha,ka),e&&tk.a.Xg(G,
tk.a.VWc,ka))};Object(de.a)(Yd,"Helper",null,[]);Ac.prototype.aVh=function(G){Te.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",G);for(var ka=new sh.a,Ua=yl(this.J0b),e=Ua.next();!e.done;e=Ua.next()){e=yl(e.value.ICb);for(var C=e.next();!C.done;C=e.next())C=C.value,C.id===G&&ka.add(C)}return ka};Ac.prototype.Fle=function(G){this.J0b.add(G)};Ac.prototype.saj=function(G){for(var ka=yl(this.J0b),Ua=ka.next();!Ua.done;Ua=ka.next())if(Ua=Ua.value,Ua.xpe===G.xpe){this.J0b.remove(Ua);break}};Ac.ufh=
function(G,ka,Ua){Ua=void 0===Ua?null:Ua;G=Ac.pNh(G);0<G.length&&(Ac.Hvc(G,!1),Ua&&Ua(ka,G))};Ac.pNh=function(G){var ka=[];if(G&&G.ICb&&0<G.ICb.count){G=yl(G.ICb);for(var Ua=G.next();!Ua.done;Ua=G.next())if(Ua=Ua.value,Ua.controls&&0<Ua.controls.count){Ua=yl(Ua.controls);for(var e=Ua.next();!e.done;e=Ua.next())if(e=e.value,e.menuItems&&0<e.menuItems.count){e=yl(e.menuItems);for(var C=e.next();!C.done;C=e.next())Array.add(ka,C.value.id)}}}return ka};Ac.Hvc=function(G,ka){if(G.length){G=yl(G);for(var Ua=
G.next();!Ua.done;Ua=G.next())Ua=document.querySelector('[id^="'+Ua.value+'"]'),Yd.m7(Ua,ka)}};Qk.Object.defineProperties(Ac.prototype,{J0b:{configurable:!0,enumerable:!0,get:function(){return this.hmg}}});Object(de.a)(Ac,"ContextMenuExtensibilityCache",null,[806,807]);var Tk=b(1413),uk=b(1011),Ek=b(885),Di=b(853),Fk=b(893),Jj=Fk.a;vm(id,Jj);id.prototype.clone=function(){var G=new id;G.$ld=this.$ld;G.Gld=this.Gld;G.ribbon=this.ribbon;return G};Object(de.a)(id,"RibbonBuildContext",Fk.a,[]);vc.prototype.Qga=
function(G,ka,Ua){ka=void 0===ka?null:ka;Ua=void 0===Ua?null:Ua;var e=Ek.Builder.v3b(G);if(vi.c(e))Ua&&Ua(!1);else if(G=new id,G.Gld=this.p9.homeTab.id,G.$ld=this.p9.homeTab,G.ribbon=this.p9,e=new Di.a(e),e=Di.a.lV(e.node,Di.a.H0d),vi.c(e))Ua&&Ua(!1);else{e=Di.a.Am(e);for(var C=0;C<e.length;C++){var J=e[C],ja=(new Di.a(J)).attributes[Di.a.id];if(this.p9.Gaa(ja))this.mVb.C_j(ja,J,G);else{var Aa=-1;ka&&(Aa=this.SCh(ja,ka));-1!==Aa?this.mVb.hDg(J,G,Aa):this.mVb.hDg(J,G)}}Ua&&Ua(!0)}};vc.prototype.SCh=
function(G,ka){G=Array.indexOf(ka,G);if(-1===G)return-1;--G;for(var Ua=-1;0<=G;){Ua=this.jSh(ka[G]);if(-1!==Ua)break;G--}return Ua+1};vc.prototype.jSh=function(G){for(var ka=0,Ua=!1,e=yl(this.p9.children),C=e.next();!C.done;C=e.next()){C=C.value;if(C.id===G){Ua=!0;break}C.visible&&ka++}return Ua?ka:-1};vc.prototype.Oab=function(G){G=Ek.Builder.v3b(G);if(!vi.c(G)&&(G=new Di.a(G),G=Di.a.lV(G.node,Di.a.H0d),!vi.c(G))){G=Di.a.Am(G);for(var ka=0;ka<G.length;ka++){var Ua=G[ka],e=(new Di.a(Ua)).attributes[Di.a.id];
Ua=Di.a.lV(Ua,Di.a.cgb);Ua=Di.a.Am(Ua);for(var C=0;C<Ua.length;C++){var J=Di.a.p1e(Ua[C],Di.a.id);vi.c(J)||this.mVb.V0j(e,J)}}}};Object(de.a)(vc,"RibbonExtensibilityBuilder",null,[]);var il=b(819);of.prototype.Qga=function(G,ka){ka=void 0===ka?null:ka;var Ua=G.dXe();this.rfe.Qga(Ua,G.d$a,ka)};of.prototype.Oab=function(G){G=G.dXe();this.rfe.Oab(G)};of.Dfh=function(G,ka,Ua){Ua=void 0===Ua?null:Ua;G=of.TXh(G);0<G.length&&(of.Hvc(G,!1),Ua&&Ua(ka,G))};of.TXh=function(G){var ka=[];if(G){var Ua=G.mW;if(!Ua){if(G.tabs&&
0<G.tabs.count)for(G=yl(G.tabs),Ua=G.next();!Ua.done;Ua=G.next())if(Ua=Ua.value,0<Ua.gK.count){var e=yl(Ua.gK);for(Ua=e.next();!Ua.done;Ua=e.next())if(Ua=Ua.value,0<Ua.dia.count){var C=yl(Ua.dia);for(Ua=C.next();!Ua.done;Ua=C.next())Array.add(ka,Ua.value.id)}}}else if(Ua.Mr&&0<Ua.Mr.count)for(G=yl(Ua.Mr),Ua=G.next();!Ua.done;Ua=G.next())if(Ua=Ua.value,Ua.groups&&0<Ua.groups.length)for(e=yl(Ua.groups),Ua=e.next();!Ua.done;Ua=e.next())if(Ua=Ua.value,Ua.controls&&0<Ua.controls.length)for(C=yl(Ua.controls),
Ua=C.next();!Ua.done;Ua=C.next())Array.add(ka,Ua.value.id)}return ka};of.Hvc=function(G,ka){if(G.length){G=yl(G);for(var Ua=G.next();!Ua.done;Ua=G.next())Ua=document.querySelector('[id^="'+Ua.value+'"]'),il.a.m7(Ua,ka)}};Object(de.a)(of,"RibbonExtensibilityManager",null,[831]);var pk=b(1065);Se.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(G,ka){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(G,ka)};Se.prototype.qid=function(G,ka,Ua,e,C,J,ja){J=void 0===
J?null:J;ja=void 0===ja?null:ja;Te.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",G);if((G=ka.Yia(C.ownerAddinInfo.storeType,C.ownerAddinInfo.solutionId))&&G.nB&&!G.nB.getIsUpgrading())if(ka=null,0<G.nB.getNotificationParams().length&&(ka=this.Yue(G.nB.getNotificationParams()[0]),Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1)&&ka&&2147758681===ka.errorCode&&(G.isUpgraded=!0),Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpgradeAddinUsageEnabled",
!1)&&ka&&2147758681===ka.errorCode&&Te.ULS.sendTraceTag(529278163,220,50,"Upgrade")),2!==G.nB.getStatus()&&(1!==G.nB.getStatus()||ka&&2147758681===ka.errorCode))ka&&this.x3f(G,ka,ja);else try{Ua.setOwnerAddinEToken(G.nB.getEToken()),C.action(Ua,e.nma),J&&J()}catch(Aa){Te.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Bf.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Aa.stack:Aa.message)),pk.a.jRd(CommonUIStrings.l_InternalError+
" "+CommonUIStrings.l_InternalError_Directive)}};Se.prototype.x3f=function(G,ka,Ua){var e=this;Ua=void 0===Ua?null:Ua;var C=G.nB;if(1===C.getNotificationParams().length||ka.Ddc){var J=ka.Aha,ja=ka.via;ka.Aha=function(){C.removeFirstNotification();if(0<C.getNotificationParams().length){var Aa=e.Yue(C.getNotificationParams()[0]);e.x3f(G,Aa)}2147758681===ka.errorCode&&(of.Dfh(G.Ao,C,Object(Pi.a)(e,e.Aaf,"initUpgradeStateDetectTask")),Ac.ufh(G.Eqb,C,Object(Pi.a)(e,e.Aaf,"initUpgradeStateDetectTask")));
J&&J()};ka.via=function(){ja&&ja();Ua&&Ua()};pk.a.lRd(ka)}};Se.prototype.Aaf=function(G,ka){var Ua=null;Ua=function(){G.getIsUpgrading()?window.setTimeout(Ua,1E3):G.getUpgradingFailed()?of.Hvc(ka,!0):Bf.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Ua,1E3)};Se.prototype.Yue=function(G){var ka=new uk.a;ka.tLa=G.infoType;ka.id=G.id;ka.title=G.title;ka.description=G.description;ka.buttonText=G.buttonTxt;ka.Aha=G.buttonCallback;ka.Ddc=G.highPriority;ka.via=G.dismissCallback;ka.errorCode=
G.errorCode;ka.A$e=G.iframeNotificationUrl;return ka};Qk.Object.defineProperties(Se.prototype,{qke:{configurable:!0,enumerable:!0,get:function(){return this.XDc||(this.XDc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(G){this.XDc=G}},qNg:{configurable:!0,enumerable:!0,get:function(){return this.U1d||(this.U1d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(de.a)(Se,"AddinCommandsActionHandler",null,[812]);ke.prototype.gIh=function(G){if(void 0!==
G&&null!==G&&G===Fi.a.hCe)G="ContextMenuCell";else return null;var ka=this.Sa.Nc();this.yHh(ka,G);return ka};ke.prototype.yHh=function(G,ka){ka=this.s2g.aVh(ka);ka=yl(ka);for(var Ua=ka.next();!Ua.done;Ua=ka.next()){Ua=yl(Ua.value.controls);for(var e=Ua.next();!e.done;e=Ua.next())this.lHh(G,e.value)}};ke.prototype.lHh=function(G,ka){var Ua=ka.zA[Di.a.id],e=ka.zA[Di.a.dCa],C=ka.zA[Di.a.gCa],J="Image16by16",ja=ka.zA[Di.a.sUa];vi.c(C)&&(J="None");0<ka.menuItems.count?(Ua=this.Sa.Wv(Ua,Ua,e,798637440),
Ua.uJb(J,C,null),this.eIh(Ua.menu,ka),Array.add(G.buttons,Ua)):Array.add(G.buttons,this.Sa.tHa(Ua,e,ja,C,J,null,!1))};ke.prototype.eIh=function(G,ka){var Ua,e=this.Sa.Nc();ka=yl(ka.menuItems);for(Ua=ka.next();!Ua.done;Ua=ka.next()){var C=Ua.value;Ua=C.CR[Di.a.id];var J=C.CR[Di.a.dCa],ja=C.CR[Di.a.gCa],Aa="Image16by16";C=C.CR[Di.a.sUa];vi.c(ja)&&(Aa="None");Ua=this.Sa.tHa(Ua,J,C,ja,Aa,null,!1);Array.add(e.buttons,Ua)}Array.add(G.Ac,e)};Object(de.a)(ke,"AddInCommandsContextMenuExtensibilityHandler",
null,[792]);var Gk=b(998);Object(de.a)(qd,"AddinStatusCommandValues",null,[]);Sd.L3i=function(G){var ka=new qd;ka.Di=G.LYa;ka.visible=ka.Di?!0:!1;return ka};Sd.vxc=function(G,ka,Ua,e,C){var J=document.getElementById(Ua);J?Sd.SBj(G,ka,J,e,C):Te.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Ua))};Sd.SBj=function(G,ka,Ua,e,C){Ua?G.LYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?pk.a.BAj(ka,Ua,e,C):G.LYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
pk.a.YBj(ka,Ua):Te.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(de.a)(Sd,"AddinCommandsStatusHandler",null,[]);var gk=b(36),zk=b(217),kk=gk.a;vm(Ed,kk);Ed.prototype.sq=function(G){this.addHandler("LAC",G)};Ed.prototype.Lq=function(G){this.removeHandler("LAC",G)};Ed.prototype.Zr=function(G,ka){var Ua=this;if("QueryAddinLabel"!==G)return!1;ka[Gk.a.LabelText]!==this.XF.LYa&&(G=Sd.L3i(this.XF),ka[Gk.a.LabelText]=G.Di,ka[Gk.a.Visible]=G.visible,
window.setTimeout(function(){Ua.vxc()},0));return!0};Ed.prototype.jn=function(){return!0};Ed.prototype.vxc=function(){this.$&&Sd.vxc(this.XF,this.$.domElement,this.VGj,gf.a.instance.fa(334),gf.a.instance.fa(335))};Ed.prototype.dispose=function(){this.$.ea.kk(this.dd);this.XF.ybj(this.a6e);this.agaveCommandManager&&(this.agaveCommandManager.Ncj(this.fze),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.XF=this.$=null;kk.prototype.dispose.call(this)};
Object(de.a)(Ed,"AddinCommandsStatusBarManager",gk.a,[245,210]);var Hk=b(1293),bj=b(116),Mk=b(144);Fc.prototype.setErrorMessageForAddin=function(G,ka){this.JYa||(this.JYa={});this.JYa[G]=ka};Fc.prototype.IPh=function(G){return this.JYa&&G in this.JYa?this.JYa[G]:null};Object(de.a)(Fc,"AddinCommandsErrorManager",null,[]);var si=b(326),Wj=b(93);Object(de.a)(qf,"AddinCommandsListLoaderContext",null,[]);var Z=b(950);Object(de.a)(ee,"AppsForOfficeEntitlementQueryInfo",null,[]);var wa=b(78),hb=b(804);Qe.prototype.get_current=
function(){if(!this.Jr)throw Error.argumentOutOfRange();return this.Jr.data};Qe.prototype.moveNext=function(){if(!this.Jr)return this.Jr=this.bA,!!this.bA;if(!this.Jr.next)return!1;this.Jr=this.Jr.next;return!0};Qe.prototype.hlc=function(){if(!this.Jr)return this.Jr=this.bA,!!this.bA;if(!this.Jr.previous)return!1;this.Jr=this.Jr.previous;return!0};Qe.prototype.reset=function(){this.Jr=this.bA};Object(de.a)(Qe,"ListEnumerator",null,[0]);Object(de.a)(td,"ListNode",null,[]);be.prototype.add=function(G){this.iq?
this.jA=this.jA.next=new td(G,this.jA,null):this.iq=this.jA=new td(G,null,null);this._count=this.count+1};be.prototype.insert=function(G,ka){if(G>this.count||0>G)throw Error.argumentOutOfRange("pos");if(G===this.count)this.add(ka);else{for(var Ua=this.iq;0!==G--;)Ua=Ua.next;G=new td(ka,Ua.previous,Ua);G.previous?G.previous.next=G:this.iq=G;G.next?G.next.previous=G:this.jA=G;this._count=this.count+1}};be.prototype.remove=function(G){for(var ka=this.iq;ka&&ka.data!==G;)ka=ka.next;if(!ka)return!1;ka.previous?
ka.previous.next=ka.next:this.iq=ka.next;ka.next?ka.next.previous=ka.previous:this.jA=ka.previous;this._count=this.count-1;return!0};be.prototype.clear=function(){var G=this.iq;for(this.jA=this.iq=null;G;){var ka=G.next;G.previous=null;G.next=null;G=ka}this._count=0};be.prototype.indexOf=function(G){for(var ka=this.iq,Ua=0;ka&&ka.data!==G;)ka=ka.next,Ua++;return ka?Ua:-1};be.prototype.oa=function(G){return this.at(G).data};be.prototype.getEnumerator=function(){return new Qe(this.iq)};be.prototype[Symbol.iterator]=
function(){return Object(hb.a)(this.getEnumerator())};be.prototype.Gac=function(G){G=this.at(G);return new Qe(G)};be.prototype.toArray=function(){for(var G=Array(this.count),ka=0,Ua=yl(this),e=Ua.next();!e.done;e=Ua.next())G[ka]=e.value,ka++;return G};be.prototype.at=function(G){for(var ka=this.iq,Ua=0;Ua!==G;){if(!ka)throw Error.argumentOutOfRange("pos");ka=ka.next;Ua++}return ka};Qk.Object.defineProperties(be.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}}});
Object(de.a)(be,"List",null,[1]);var Yb=Sys.EventArgs;vm(ne,Yb);Object(de.a)(ne,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);pd.prototype.z$c=function(G){var ka=new Sys.StringBuilder(this.ZHb);ka.append("RoamingServiceHandler.ashx?action=");ka.append("getAddinTeachingCalloutSettings");ka.append("&");ka.append(this.qgd(G));ka.append("&");ka.append(Bf.AFrameworkApplication.lj);Bf.AFrameworkApplication.Kd.Wl(ka.toString(),1,null,null,!0,2,Object(Pi.a)(this,this.sKa,"getRequestSuccessCallback"),
Object(Pi.a)(this,this.Lja,"getRequestFailureCallback"),null)};pd.prototype.A$c=function(G){var ka=new Sys.StringBuilder(this.ZHb);ka.append("RoamingServiceHandler.ashx?action=");ka.append("saveAddinTeachingCalloutSettings");ka.append("&");ka.append(Bf.AFrameworkApplication.lj);ka=ka.toString();G=Vh.c(G);Bf.AFrameworkApplication.Kd.Wl(ka,2,G,null,!0,4,null,Object(Pi.a)(this,this.uPa,"postRequestFailureCallback"),null)};pd.prototype.sKa=function(G){var ka=!1,Ua=null;try{if(0<G.data.je.length){var e=
Object(Ci.a)(Object,Vh.a(G.data.je)),C=e?e[this.appName]:null;C&&(Ua=Object(Ci.a)(Object,Vh.a(C.toString())))}ka=!0}catch(J){this.Lja(null)}ka&&this.xib&&this.xib(Ua)};pd.prototype.Lja=function(G){this.tib&&this.tib(G?G.data:null)};pd.prototype.uPa=function(G){this.Hkb&&this.Hkb(G?G.data:null)};pd.prototype.qgd=function(G){for(var ka=new Sys.StringBuilder("requestedsettings="),Ua=0;Ua<G.count;Ua++)ka.append(G.oa(Ua)),Ua<G.count-1&&ka.append(";");return ka.toString()};Object(de.a)(pd,"AddinTeachingUIRoamingRequestHandler",
null,[]);Object(de.a)(qc,"MiniAddinInfo",null,[]);var Gc=Sys.EventArgs;vm(Zd,Gc);Object(de.a)(Zd,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);rb.prototype.PDg=function(G){this.Ma.addHandler(ug.a.kZb,G)};rb.prototype.mHg=function(G){this.Ma.addHandler(ug.a.D3f,G)};rb.prototype.aPj=function(G){var ka=this;null!==G&&(this.context.X_=G[ug.a.G2],this.context.hs=G[ug.a.xJ],this.context.bAc=this.context.vqc=0,G=ug.a.JFa in G?G[ug.a.JFa]:0,-1!==this.context.X_&&0!==this.context.hs&&(this.context.N9=
new be,this.context.kja=new be,this.context.n0a=new be,this.context.CVc=this.UHg.createAddinDataProvider(pf(this.context.X_),this.contextActivationMgr),this.context.CVc?this.context.CVc.getEntitlementsAsync(this.contextActivationMgr.nma,!0,G,function(Ua){ka.mPi(Ua)}):Te.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.X_)))};rb.prototype.mPi=function(G){var ka=this;if(G&&0<G.length){this.context.bAc=G.length;for(var Ua=0;Ua<G.length;Ua++){var e=G[Ua];if(!e||1!==
e.targetType&&-1!==e.targetType)this.Zyd();else{var C={};C.marketplaceId=e.solutionId;C.marketplaceVersion=e.version;C.storeType=e.storeType;C.storeId=e.storeId;C.targetData=e;this.contextActivationMgr.isAddinCommandsAsync(C,function(J,ja,Aa){J?(ja&&ka.context.N9.add(Aa.targetData),10===ka.context.X_&&(J=Aa.targetData,ja=J.targetType,Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",!1)&&!vi.c(Aa.targetTypeForExp)&&(ja=
Aa.targetTypeForExp,J.targetType=ja),Bf.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&ka.context.kja.add(J),Bf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&0===ja&&ka.context.n0a.add(J))):Te.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(Aa.targetData.storeType,Aa.targetData.storeId,Aa.targetData.assetId),Aa.targetData.storeType);
ka.Zyd()})}}}else this.Zyd()};rb.prototype.Zyd=function(){var G;(G=this.context).vqc=G.vqc+1;this.context.vqc>=this.context.bAc&&(this.jZb.GYf(this.context.X_,!1),0<this.context.bAc&&10===this.context.X_&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(G=!1,Bf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&md()&&(G=this.cvi()),Bf.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&
this.rui(),Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!G?this.NJh(this.context.N9):this.mYb(this.context.N9)):this.mYb(this.context.N9))};rb.prototype.mYb=function(G){var ka=new sh.a;if(G){G=yl(this.context.N9);for(var Ua=G.next();!Ua.done;Ua=G.next())ka.add($d(Ua.value))}this.context.N9&&1>this.context.N9.count&&Z.a.WMb(ug.a.lZb,"false",this.context.X_);G={};ka=(G.ack2=ka,G);ka[ug.a.G2]=this.context.X_;ka[ug.a.xJ]=this.context.hs;
this.Ma.raiseEvent(ug.a.kZb,new ne(ka),this)};rb.prototype.NVf=function(G){if(this.appName){var ka={},Ua={};Ua.LastTeachingUIShowTime=(new Date).toUTCString();Ua.AddinHasShown=G;ka[this.appName]=Vh.c(Ua);this.GPb&&(this.GPb.A$c(ka),Te.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Te.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};rb.prototype.NJh=function(G){if(this.Yga=
G)G=new sh.a,G.add(this.appName),this.GPb=new pd(this.appName,Object(Pi.a)(this,this.sKa,"getRequestSuccessCallback"),Object(Pi.a)(this,this.Lja,"getRequestFailureCallback"),Object(Pi.a)(this,this.uPa,"postRequestFailureCallback")),this.GPb.z$c(G);else{G=new sh.a;var ka={};G=(ka.ack2=G,ka);G[ug.a.G2]=this.context.X_;G[ug.a.xJ]=this.context.hs;this.Ma.raiseEvent(ug.a.kZb,new ne(G),this)}};rb.prototype.sKa=function(G){G?this.Bzj(G)?(Te.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.yda=
"AddinHasShown"in G&&G.AddinHasShown?G.AddinHasShown.toString():null,this.vBe()):(Te.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.mYb(this.Yga)):(Te.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.yda=null,this.vBe())};rb.prototype.Lja=function(G){Te.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",G?G.httpStatus:-1);this.mYb(this.Yga)};rb.prototype.uPa=function(G){Te.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
G?G.httpStatus:-1)};rb.prototype.vBe=function(){if(Bf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")){var G=this.neh();0===G.targetType?(G.assetId?(this.bXc=G.assetId,this.H3i()):this.pmf("NoAssetId"),G.addinId&&this.NVf(this.yda?this.yda+","+G.addinId:G.addinId),this.iUc(null)):this.iUc(G.addinId);Te.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",G.addinId)}else G=this.meh(),this.iUc(G),Te.ULS.sendTraceTag(538248464,
306,50,"Show teaching callout for taskpane addin: {0}",G)};rb.prototype.H3i=function(){var G=this,ka=new ee;ka.callbackFunc=function(Ua){if(Ua.errorCode)G.pmf("FailToGetAppDetails");else if(Ua.value){Ua=yl(Ua.value);for(var e=Ua.next();!e.done;e=Ua.next()){e=e.value;var C=e[1];if(C===G.bXc){Ua={solutionId:C,assetId:C};Ua.storeType=e[6];Ua.storeId=e[11];Ua.assetStoreId=e[6];Ua.targetType=e[3];Ua.width=e[7];Ua.height=e[8];Ua.displayName=e[0];Ua.version=e[4];Ua=new Zd(Ua);G.Ma.raiseEvent(ug.a.D3f,Ua);
break}}}};ka.storeType=OSF.StoreTypeEnum.PrivateCatalog;ka.fromInsertDialog=!1;Bf.AFrameworkApplication.ga.isChangeGateEnabled("AvoidRefreshCacheEnabled")?ka.refresh=!1:ka.refresh=!0;this.contextActivationMgr.queryEntitlementDetails(ka)};rb.prototype.Bzj=function(G){if("LastTeachingUIShowTime"in G){if(G=+new Date-+new Date(G.LastTeachingUIShowTime.toString()),G<Bf.AFrameworkApplication.ga.VQ("AddinShowTeachingUIIntervalInMS",864E5))return Te.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
G),!1}else Te.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};rb.prototype.meh=function(){for(var G=new si.a("",0),ka=new si.a("",0),Ua=0,e=0,C=0,J=yl(this.Yga),ja=J.next();!ja.done;ja=J.next())if(ja=ja.value,!("excatalog"!==ja.storeType||vi.c(ja.installTimeInMS)||!ja.installTimeInMS||ja.installTimeInMS<=Bf.AFrameworkApplication.ga.VQ("DateTimeInMSForNewAddin",16409664E5))){var Aa=this.fdd(ja);if(this.yda){var gb=this.yda.split(",");if(0<gb.length&&Array.contains(gb,Aa)){C++;
Te.ULS.sendTraceTag(538817694,306,50,"This addin has shown teaching UI before");continue}}Aa.startsWith("private_")?(G.value<ja.installTimeInMS&&(G=new si.a(Aa,ja.installTimeInMS)),e++):(ka.value<ja.installTimeInMS&&(ka=new si.a(Aa,ja.installTimeInMS)),Ua++)}Te.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",e,Ua,C);return 0<ka.value?ka.key:0<G.value?G.key:null};rb.prototype.neh=function(){var G=new si.a(new qc,0),ka=
new si.a(new qc,0),Ua=0,e=0,C=0;if(Bf.AFrameworkApplication.ga.isChangeGateEnabled("FixAlertPeakEnabled")){var J=new be;if(0<this.context.N9.count)for(var ja=yl(this.context.N9),Aa=ja.next();!Aa.done;Aa=ja.next())J.add(Aa.value);if(0<this.context.n0a.count)for(ja=yl(this.context.n0a),Aa=ja.next();!Aa.done;Aa=ja.next())J.add(Aa.value)}else if(J=this.Yga,0<this.context.n0a.count)for(ja=yl(this.context.n0a),Aa=ja.next();!Aa.done;Aa=ja.next())J.add(Aa.value);J=yl(J);for(Aa=J.next();!Aa.done;Aa=J.next())if(Aa=
Aa.value,!("excatalog"!==Aa.storeType||vi.c(Aa.installTimeInMS)||!Aa.installTimeInMS||Aa.installTimeInMS<=Bf.AFrameworkApplication.ga.VQ("DateTimeInMSForNewAddin",16409664E5))){ja=this.fdd(Aa);if(this.yda){var gb=this.yda.split(",");if(0<gb.length&&Array.contains(gb,ja)){C++;Te.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}ja.startsWith("private_")?(G.value<Aa.installTimeInMS&&(G=new si.a(Object.assign(new qc,{addinId:ja,targetType:Aa.targetType,assetId:Aa.assetId}),
Aa.installTimeInMS)),e++):(ka.value<Aa.installTimeInMS&&(ka=new si.a(Object.assign(new qc,{addinId:ja,targetType:Aa.targetType,assetId:Aa.assetId}),Aa.installTimeInMS)),Ua++)}Te.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",e,Ua,C);return 0<ka.value?ka.key:0<G.value?G.key:Object.assign(new qc,{addinId:null,targetType:-1,assetId:null})};rb.prototype.iUc=function(G){for(var ka=new sh.a,Ua=yl(this.Yga),e=Ua.next();!e.done;e=
Ua.next()){var C=e.value;e=$d(C);G&&(C=this.fdd(C),G===C&&(e.showCallout=!0,this.NVf(this.yda?this.yda+","+G:G)));ka.add(e)}this.Yga&&1>this.Yga.count&&Z.a.WMb(ug.a.lZb,"false",this.context.X_);G={};ka=(G.ack2=ka,G);ka[ug.a.G2]=this.context.X_;ka[ug.a.xJ]=this.context.hs;this.Ma.raiseEvent(ug.a.kZb,new ne(ka),this)};rb.prototype.fdd=function(G){return Telemetry.PrivacyRules.IsPrivateAddin(G.storeType,G.storeId,G.assetId)?"private_"+G.installTimeInMS:G.assetId};rb.prototype.cvi=function(){var G=!1;
if(this.context.kja&&1>this.context.kja.count)return G;var ka=je();if(!ka)return G;for(var Ua=yl(this.context.kja),e=Ua.next();!e.done;e=Ua.next())if(e=e.value,e.storeId&&e.storeId.toLowerCase()===ka.toLowerCase()||e.assetId&&e.assetId.toLowerCase()===ka.toLowerCase()){G=Telemetry.PrivacyRules.GetAssetId(e.storeType,e.storeId,e.solutionId);var C={};e=(C.SDX_Id=G,C.SDX_TargetType=vi.c(e.targetType)?"":e.targetType.toString(),C);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:bj.a.Qk(e)}));G=!0}return G};rb.prototype.rui=function(){if(!(this.context.kja&&1>this.context.kja.count))if(this.jZb.tki()){var G=this.jZb.nWh();G?(G=this.cZe(this.context.kja,G),Te.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(G=this.cZe(this.context.kja,null),Te.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.jZb.utj(G)}else Te.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};rb.prototype.cZe=function(G,ka){var Ua={},e=!1;G=
yl(G);for(var C=G.next();!C.done;C=G.next()){C=C.value;var J=Telemetry.PrivacyRules.GetAssetId(C.storeType,C.storeId,C.assetId);J&&(!ka||J in ka||(this.Exa(C,J),Te.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===J.toLowerCase()?e||(e=!0,Ua[J]=null):Ua[J]=null)}return Ua};rb.prototype.Exa=function(G,ka){var Ua=G.installTimeInMS?(new Date(G.installTimeInMS)).toISOString():"";if(Bf.AFrameworkApplication.ga.isChangeGateEnabled("TargetTypeAndStoreIdFixEnabled")){var e=
{};Ua=(e["SDX.Id"]=ka,e["SDX.AppInstallOrigin"]="Organization",e["SDX.TargetType"]=vi.c(G.targetType)?"":G.targetType.toString(),e["SDX.AdminDeploymentTime"]=Ua,e)}else e={},Ua=(e["SDX.Id"]=ka,e["SDX.AppInstallOrigin"]="Organization",e["SDX.TargetType"]=G.targetType,e["SDX.AdminDeploymentTime"]=Ua,e);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bj.a.Qk(Ua)}));1===G.targetType&&(G={},ka=(G["SDX.Id"]=ka,G["SDX.AppInstallOrigin"]="Organization",
G["SDX.CommandPlacement"]="Ribbon",G),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:bj.a.Qk(ka)})))};rb.prototype.pmf=function(G){var ka={};G=(ka.AppTeachingUICalloutAction=G,ka["SDX.Id"]=this.bXc,ka.AppTeachingUICalloutGoal="NewAdminDeployment",ka["SDX.AppInstallOrigin"]="Organization",ka);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}))};Object(de.a)(rb,"AddInCommandsListLoader",
null,[]);nd.prototype.insertOsfControl=function(G){return this.nma.insertOsfControl(G)};nd.prototype.getManifestInvaildErrorString=function(){return this.nma.getManifestInvaildErrorString()};nd.prototype.isAddinCommandsAsync=function(G,ka){this.nma.isAddinCommandsAsync(G,ka)};nd.prototype.ownerAddinControlRecreated=function(G,ka){this.nma.ownerAddinControlRecreated(G,ka)};nd.prototype.queryEntitlementDetails=function(G){this.nma.queryEntitlementDetails(G)};Qk.Object.defineProperties(nd.prototype,
{nma:{configurable:!0,enumerable:!0,get:function(){return this.ytg}}});Object(de.a)(nd,"ContextActivationMgrWrapper",null,[801]);zc.prototype.createAddinDataProvider=function(G,ka){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(G,ka.nma)};Qk.Object.defineProperties(zc,{instance:{configurable:!0,enumerable:!0,get:function(){zc.Oa||(zc.Oa=new zc);return zc.Oa}}});zc.Oa=null;Object(de.a)(zc,"OSFAddinDataProviderFactory",null,[804]);Object(de.a)(sd,"CacheItem",null,[]);cc.prototype.Uk=
function(G){Te.ULS.sendTraceTag(526989510,220,15,"GetCacheItem");var ka=this.TDa.getItem(G);if(ka){var Ua=new sd;try{Ua=Sys.Serialization.JavaScriptSerializer.deserialize(ka,!0)}catch(e){return this.TDa.removeItem(G),null}return Ua.Data?Ua.Data:Ua.data}return null};cc.prototype.Fza=function(G){Te.ULS.sendTraceTag(526989512,220,15,"RemoveCacheItem");this.TDa.removeItem(G)};Object(de.a)(cc,"AppsDataCacheManager",null,[715]);var dd=b(951);Ke.prototype.GYf=function(G,ka){G=ug.a.i_e()+G;dd.a.instance.setItem(G,
ka.toString())};Ke.prototype.nWh=function(){var G=ug.a.m2e();Te.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",G);G=dd.a.instance.getItem(G);return Vh.a(G)};Ke.prototype.utj=function(G){var ka=ug.a.m2e();Te.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ka);dd.a.instance.setItem(ka,Vh.c(G))};Ke.prototype.tki=function(){return!!dd.a.instance.localStorage};Qk.Object.defineProperties(Ke,{instance:{configurable:!0,enumerable:!0,get:function(){Ke.Oa||(Ke.Oa=new Ke);return Ke.Oa}}});Ke.Oa=
null;Object(de.a)(Ke,"AddInCommandsCacheManager",null,[805]);var ed=Sys.EventArgs;vm(oe,ed);Object(de.a)(oe,"InsertionParamEventArgs",Sys.EventArgs,[]);Object(de.a)(te,"PostLaunchAddinCommandsParameters",null,[]);Ud.prototype.fBg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Pi.a)(this,this.$Oi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Pi.a)(this,this.pKi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(Pi.a)(this,this.UIi,"onCloseButtonClickedEventHandler"),!0)):Te.ULS.sendTraceTag(525112601,306,15,"AddEventListenerForTeachingCallout failed to get Window")};Ud.prototype.$Oi=function(){var G=this,ka={};ka=(ka.AppTeachingUICalloutAction="ClickOnLaunch",ka["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.S8.storeType,this.S8.storeId,this.S8.assetId),ka.AppTeachingUICalloutGoal="NewAdminDeployment",ka["SDX.AppInstallOrigin"]="Organization",ka);Bf.AFrameworkApplication.ga.isChangeGateEnabled("TeachingUIExtraLogForLaunch")&&
this.ngb&&this.ngb.tabs&&!this.ngb.tabs[0].isOfficeTab&&(ka["SDX.FeatureFlags"]="NonOfficeTab");Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(ka)}));this.ngb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.ngb,function(){var Ua=new oe;Ua.gi=G.S8;G.rb.raiseEvent(ug.a.Qkf,Ua)}):Te.ULS.sendTraceTag(525112602,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Ud.prototype.UIi=function(){var G=
{};G=(G.AppTeachingUICalloutAction="ClickOnClose",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.S8.storeType,this.S8.storeId,this.S8.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}))};Ud.prototype.pKi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.S8.storeType,
this.S8.storeId,this.S8.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}))};Object(de.a)(Ud,"PrivateCatalogTeachingCalloutHandler",null,[]);Kd.prototype.Qga=function(G,ka){this.s8d.Qga(G,void 0===ka?null:ka);this.x$d=G};Kd.prototype.Oab=function(G){this.s8d.Oab(G)};Qk.Object.defineProperties(Kd.prototype,{oxa:{configurable:!0,
enumerable:!0,get:function(){return this.x$d}}});Object(de.a)(Kd,"RibbonExtensibilityManagerWithChangeDetection",null,[831]);var Pc=b(858),Rc=b(941);Ve.prototype.Qga=function(G,ka){ka=void 0===ka?null:ka;if(G=Rc.a.eub(G)){appChrome.addInApi.dispatchActionsToInstallAddIn(G,ka);ka=yl(G.tabs);for(var Ua=ka.next();!Ua.done;Ua=ka.next())if(Ua.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(G,function(){});break}}};Ve.prototype.Oab=function(G){(G=Rc.a.eub(G))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(G)};
Object(de.a)(Ve,"OneLineRibbonExtensibilityManager",null,[831]);var zd=b(1010);Ne.S_e=function(G){var ka=new sh.a;if(Ne.iBe)for(var Ua=yl(Ne.iBe),e=Ua.next();!e.done;e=Ua.next())ka.add(e.value);e=null;switch(G){case "Workbook":e=Ne.RYj;break;case "Document":e=Ne.xhh;break;case "Presentation":e=Ne.z1i}if(e)for(G=yl(e),e=G.next();!e.done;e=G.next())ka.add(e.value);return ka};Ne.iBe=["PrimaryCommandSurface","ContextMenu"];Ne.RYj=null;Ne.xhh=null;Ne.z1i=null;Object(de.a)(Ne,"ExtensionPointType",null,
[]);Qk.Object.defineProperties(Ad.prototype,{ICb:{configurable:!0,enumerable:!0,get:function(){return this.yce||(this.yce=new sh.a)}},xpe:{configurable:!0,enumerable:!0,get:function(){return this.Nkg}}});Object(de.a)(Ad,"ContextMenuExtensibility",null,[810]);wd.prototype.dXe=function(){for(var G=new Sys.StringBuilder,ka=yl(this.iY),Ua=ka.next();!Ua.done;Ua=ka.next())G.append(Ua.value.N7());return this.HCg(G.toString())};wd.prototype.HCg=function(G){var ka=new Sys.StringBuilder;ka.append("<Ribbon><Tabs>");
ka.append(G);ka.append("</Tabs></Ribbon>");return ka.toString()};Qk.Object.defineProperties(wd.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.iY}},mW:{configurable:!0,enumerable:!0,get:function(){return this.rtg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.Pwg}},d$a:{configurable:!0,enumerable:!0,get:function(){return this.nkb}},bJh:{configurable:!0,enumerable:!0,get:function(){return this.rpg}}});Object(de.a)(wd,"RibbonExtensibility",null,[855]);
fd.prototype.createActionContext=function(G,ka){G={};G.ownerAddinInfo=this.entitlement;G.action=ka;return G};Qk.Object.defineProperties(fd.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.pog}}});Object(de.a)(fd,"AddInCommandsContextProvider",null,[]);Rb.prototype.I5g=function(G){return new fd(G)};Rb.prototype.createActionBuilder=function(G,ka){return OfficeExt.DefaultControlActionBinder.createActionBuilder(G,ka.entitlement,ka.manifest)};Rb.prototype.startApplyAddin=
function(G){this.p1d=G;var ka=this.I5g(G);this.actionBuilder=this.createActionBuilder(ka,G)};Rb.prototype.endApplyAddin=function(){};Rb.prototype.Pcd=function(G,ka,Ua){Ua=void 0===Ua?0:Ua;return this.ribbonBuilder.czc&&0<this.ribbonBuilder.czc.count||this.ribbonBuilder.Mr&&0<this.ribbonBuilder.Mr.count?new wd(this.ribbonBuilder.czc,this.qIh(G,ka),this.Voe.startedNode,this.ribbonBuilder.a6.pVh(),Ua):null};Rb.prototype.AWe=function(){var G=void 0===G?null:G;if(this.contextMenuBuilder.Pkc&&0<this.contextMenuBuilder.Pkc.count){G||
(G=this.Voe.entitlement.solutionId);G=new Ad(G);for(var ka=yl(this.contextMenuBuilder.Pkc),Ua=ka.next();!Ua.done;Ua=ka.next())G.ICb.add(Ua.value);return G}return null};Rb.prototype.qIh=function(G,ka){return this.ribbonBuilder.Mr&&0<this.ribbonBuilder.Mr.count?new Rc.a(this.ribbonBuilder.Mr,G,ka):null};Qk.Object.defineProperties(Rb.prototype,{Voe:{configurable:!0,enumerable:!0,get:function(){return this.p1d}}});Object(de.a)(Rb,"AddinCommandsBuilder",null,[]);Zc.prototype.hNa=function(G,ka,Ua,e,C,J,
ja){function Aa(yd,we,$e,Gf){C(yd,we,$e,Gf);yd=zd.a[gb.hs]+we.assetId;$e=gb.CSa.Hc(yd);we=$e.value;$e.returnValue&&(we.stop(),gb.CSa.remove(yd))}var gb=this;if(0!==this.hs&&G)for(Te.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",G.count),4===this.hs&&(Te.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",e)),this.aYg(G,e),J()),G=yl(G),e=G.next();!e.done;e=G.next())if(e=e.value,e.solutionId=e.solutionId||e.assetId,e.storeType=e.storeType||e.currentStoreType,
e.version=e.version||e.appVersion,Te.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.$n.lK,Telemetry.PrivacyRules.GetAssetId(e.storeType,e.storeId,e.solutionId))),this.bgg(e))if(ja&&e.requireConsent)ja(e,function(yd){try{if(gb.IO){var we=zd.a[gb.hs]+yd.solutionId,$e=gb.IO.Ic("ComponentAttach",we);gb.CSa.ia(we,$e)}var Gf=gb.XF.Yia(yd.storeType,yd.solutionId);6!==gb.hs&&(Gf&&(gb.Q1b(Gf),Gf.nB.purge(!1)),gb.Ii.insertOsfControl(gb.vFb(yd,ka,Ua,Aa)),Gf&&gb.Ii.ownerAddinControlRecreated(yd.solutionId,
yd.storeType))}catch(ag){Te.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",gb.$n.lK,Telemetry.PrivacyRules.GetAssetId(yd.storeType,yd.storeId,yd.solutionId),yd.version,yd.storeType,yd.storeId,ag.message)),Aa(!1,yd,null,null)}});else try{if(this.IO){var bc=zd.a[this.hs]+e.solutionId,Mc=this.IO.Ic("ComponentAttach",bc);this.CSa.ia(bc,Mc)}var Hc=this.XF.Yia(e.storeType,e.solutionId);6!==
this.hs&&(Hc&&(this.Q1b(Hc),Hc.nB.purge(!1)),this.Ii.insertOsfControl(this.vFb(e,ka,Ua,Aa)),Hc&&this.Ii.ownerAddinControlRecreated(e.solutionId,e.storeType))}catch(yd){Te.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.$n.lK,Telemetry.PrivacyRules.GetAssetId(e.storeType,e.storeId,e.solutionId),e.version,e.storeType,e.storeId,yd.message)),Aa(!1,e,null,null)}else Aa(!1,e,null,null)};
Zc.prototype.Nri=function(G,ka,Ua,e,C,J){function ja(Hc,yd,we,$e){J(Hc,yd,we,$e);Hc=zd.a[Aa.hs]+yd.solutionId;we=Aa.CSa.Hc(Hc);yd=we.value;we.returnValue&&(yd.stop(),Aa.CSa.remove(Hc))}var Aa=this;if(6===this.hs&&G)if(G.solutionId=G.solutionId||G.assetId,G.storeType=G.storeType||G.currentStoreType,G.version=G.version||G.appVersion,Te.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.$n.lK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId))),
this.bgg(G))try{if(this.IO){var gb=zd.a[this.hs]+G.solutionId,bc=this.IO.Ic("ComponentAttach",gb);this.CSa.ia(gb,bc)}var Mc=this.XF.Yia(G.storeType,G.solutionId);Mc||ja(!1,G,null,null);Bf.AFrameworkApplication.sa&&Bf.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.bXe(G,ka,e,C,Ua,function(Hc){ja(Hc,G,Ua,Mc.displayName)}):(this.bXe(G,ka,e,C,Ua),ja(!0,G,Ua,Mc.displayName))}catch(Hc){Te.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.$n.lK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId,Hc.message)),ja(!1,G,null,null)}else ja(!1,G,null,null)};Zc.prototype.$Gi=function(G,ka,Ua,e,C,J){if(J)if(J._isAddinCommandsManifest(this.$n.lK))try{Bf.AFrameworkApplication.sa&&Bf.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.aXe(G,ka,Ua,C,J,function(ja){e(ja,G,J,J.getDefaultDisplayName())}):(this.aXe(G,ka,Ua,C,J),e(!0,G,J,J.getDefaultDisplayName()))}catch(ja){Te.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.$n.lK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId,ja.message)),e(!1,G,J,J.getDefaultDisplayName())}else Te.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.$n.lK,
Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId)),e(!1,G,null,null);else Te.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.$n.lK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId)),e(!1,G,null,null)};Zc.prototype.vFb=function(G,ka,Ua,e){var C=this,J={},ja=document.createElement("div");ja.setAttribute("visible",
"false");J.div=ja;J.id=G.solutionId||G.id;J.solutionId=G.solutionId||G.id;J.version=G.version||G.appVersion;J.storeType=G.storeType||G.currentStoreType;J.storeId=G.storeId;J.assetId=G.assetId;J.assetStoreId=G.assetStoreId;J.isvirtualOsfControl=!0;J.virtualOsfControlActivationCallback=function(Aa,gb){var bc=C.XF.Yia(G.storeType||G.currentStoreType,G.solutionId||G.id);bc&&(bc.isUpgraded&&(G.isUpgraded=!0),C.Q1b(bc));C.$Gi(G,ka,Ua,e,Aa,gb)};J.reason=3===this.hs?Microsoft.Office.WebExtension.InitializationReason.Inserted:
Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;J.marketplaceID=G.id;J.marketplaceVersion=G.appVersion;J.store=G.storeId;return J};Zc.prototype.aXe=function(G,ka,Ua,e,C,J){J=void 0===J?null:J;var ja={};ja.solutionId=e.getSolutionId();ja.version=e.getVersion();ja.storeType=e.getStoreType();ja.storeId=e.getStoreId();ja.assetId=e.getSolutionId();ja.assetStoreId=e.getAssetStoreId();ja.targetType=e.getOsfControlType();ja.appVersion=e.getMarketplaceVersion();var Aa=null,gb=null;if(Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Aa=(new OfficeExt.Parser.AddinCommandsManifestParser(this.$n.lK,this.$n.formFactor)).parseExtensions(ja,C,this.Zga),gb=Ne.S_e(this.$n.lK);else try{Aa=(new OfficeExt.Parser.AddinCommandsManifestParser(this.$n.lK,this.$n.formFactor)).parseExtensions(ja,C,this.Zga),gb=Ne.S_e(this.$n.lK)}catch(Jh){throw Te.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Jh.message),Jh;}if(gb&&0<gb.count){if(Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var bc=ka(G);var Mc=Ua(G);Ua=!!Bf.AFrameworkApplication.ga&&Bf.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");bc=new Rb(bc,null,Mc);gb=yl(gb);for(Mc=gb.next();!Mc.done;Mc=gb.next())bc.commandSurface=Mc.value,Aa.apply(bc,this.Zga,Ua)}else try{var Hc=ka(G),yd=Ua(G),we=!!Bf.AFrameworkApplication.ga&&Bf.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");bc=new Rb(Hc,null,yd);var $e=yl(gb);for(Mc=$e.next();!Mc.done;Mc=$e.next())bc.commandSurface=Mc.value,
Aa.apply(bc,this.Zga,we)}catch(Jh){throw Te.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Jh.message),Jh;}if(OSF.OUtil.checkFlight(14))try{var Gf=bc.Pcd(G.solutionId||G.id,C.getDefaultDisplayName()),ag=bc.AWe();Gf&&this.ribbonManager.Qga(Gf,J);ag&&this.contextMenuManager.Fle(ag);this.XF.gme(e,Gf,ag,C.getDefaultDisplayName());Te.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",C.getDefaultDisplayName())}catch(Jh){throw OfficeExt.DevConsole.log(Jh),
Te.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Jh.message),Jh;}else try{var Nf=bc.Pcd(G.solutionId||G.id,C.getDefaultDisplayName()),Pg=bc.AWe();Nf&&this.ribbonManager.Qga(Nf);Pg&&this.contextMenuManager.Fle(Pg);this.XF.gme(e,Nf,Pg,C.getDefaultDisplayName());Te.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",C.getDefaultDisplayName())}catch(Jh){throw Te.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Jh.message),
Jh;}}};Zc.prototype.bXe=function(G,ka,Ua,e,C,J){J=void 0===J?null:J;var ja={};ja.solutionId=G.solutionId||G.assetId;ja.version=G.version||G.appVersion;ja.storeType=G.storeType||G.currentStoreType;ja.storeId=G.assetStoreId;ja.assetId=G.assetId;ja.assetStoreId=G.assetStoreId;ja.targetType=G.targetType;ja.appVersion=G.appVersion;var Aa=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.$n.lK,this.$n.formFactor);try{var gb=ka.getManifest(),bc=Aa.parse(ja,gb,C,this.Zga,ka.getSharedRuntimeId()),Mc=Ua(G),
Hc=e(G),yd=new Rb(Mc,null,Hc);yd.commandSurface="PrimaryCommandSurface";bc.apply(yd,this.Zga,!0);if(yd.ribbonBuilder.Mr&&0<yd.ribbonBuilder.Mr.count){var we=yd.Pcd(G.solutionId||G.id,ka.getManifest().getDefaultDisplayName(),1);Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.Qga(we,J):we&&this.ribbonManager.Qga(we,J);this.XF.XBg(ka,we,C,ka.getManifest().getDefaultDisplayName());Te.ULS.sendTraceTag(592290767,
220,100,"Add-in name: {0}.",ka.getManifest().getDefaultDisplayName())}}catch($e){Te.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ka.getManifest().getDefaultDisplayName(),$e.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log($e)}};Zc.prototype.Q1b=function(G){G.Ao&&this.ribbonManager.Oab(G.Ao);G.Eqb&&this.contextMenuManager.saj(G.Eqb);this.XF.aaj(G.nB.getStoreType(),G.nB.getSolutionId())};Zc.prototype.aYg=function(G,ka){ka=
pf(ka);for(var Ua=yl(this.XF.z5a),e=Ua.next();!e.done;e=Ua.next())if(e=e.value,e.nB.getStoreType()===ka){for(var C=!0,J=yl(G),ja=J.next();!ja.done;ja=J.next())if((ja=ja.value)&&e.rhf(ja.storeType||ja.currentStoreType,ja.solutionId||ja.id)){C=!1;break}C&&(this.Q1b(e),e.nB.purge(!1))}};Zc.prototype.bgg=function(G){G.solutionId!==G.assetId&&Te.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId");G.id!==G.assetId&&Te.ULS.sendTraceTag(540379093,220,50,"VerifyInsertAgaveParameter Id != AssetId");
return!!G&&!!G.solutionId&&!!G.version&&!!G.storeType&&!!G.storeId};Object(de.a)(Zc,"AddInCommandsIntegration",null,[]);var Fd=b(863);ld.prototype.QDg=function(G){this.rb.addHandler(ug.a.Uoe,G)};ld.prototype.JFg=function(G){this.rb.addHandler(ug.a.Qkf,G)};ld.prototype.lHg=function(G){this.rb.addHandler(ug.a.F3f,G)};ld.prototype.WDg=function(G){this.rb.addHandler(ug.a.BXc,G)};ld.prototype.hNa=function(G,ka,Ua){var e=this,C=Ua[ug.a.IFa],J=void 0===Ua[ug.a.xJ]?0:Ua[ug.a.xJ];if(C&&0!==J)if(0>=C.count&&
4!==J)this.Ppc(new te(J,null,null,G,ka,null,!0));else{var ja=C.count,Aa=new Kd(new of(G));Ua=void 0===Ua[ug.a.G2]?-1:Ua[ug.a.G2];(new Zc(J,this.Om,this.zUa,Aa,this.Y3d,this.Zqa,this.hpa)).hNa(C,function(gb){return e.OWb.ARg(gb.solutionId,e.hpa,e.zUa)},function(gb){return e.OWb.Oue(gb.solutionId)},Ua,function(gb,bc,Mc,Hc){ja--;Mc=new te(J,bc,Aa,G,ka,Hc,0>=ja);gb&&bc?e.Ppc(Mc):(e.cWa&&(3===J||bc&&bc.isUpgraded)&&(gb="",bc&&(gb=Telemetry.PrivacyRules.GetAssetId(bc.storeType,bc.storeId,bc.solutionId)),
bc={},bc=(bc.SDX_AppInstallOrigin="User",bc.SDX_IsAutoLaunchEnabled=e.EDa,bc.SDX_AppInstallErrorCode="onAddinCompleted.fail",bc.SDX_Id=gb,bc),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bj.a.Qk(bc)}))),e.Opc(Mc))},function(){e.Olc();0>=C.count&&4===J&&e.Zqa.Ivc()},this.Dce)}else this.cWa&&(Ua={},Ua=(Ua.SDX_AppInstallOrigin="User",Ua.SDX_IsAutoLaunchEnabled=this.EDa,Ua.SDX_AppInstallErrorCode="LaunchAddinCommands.fail",Ua.SDX_Id="",Ua),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:bj.a.Qk(Ua)}))),Te.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.zUa.lK)),this.Opc(new te(J,null,null,G,ka,null,!0))};ld.prototype.esi=function(G,ka,Ua){var e=this,C=Ua[ug.a.IFa],J=void 0===Ua[ug.a.xJ]?0:Ua[ug.a.xJ];if(C&&0!==J)if(0>=C.count&&4!==J)this.Ppc(new te(J,null,null,null,ka,null,!0));else{var ja=C.count,Aa=new Kd(new Ve),gb=void 0===Ua[ug.a.G2]?-1:Ua[ug.a.G2],bc=new Zc(J,
this.Om,this.zUa,Aa,this.Y3d,this.Zqa,this.hpa),Mc=function(Gf){return e.OWb.lRg(Gf.solutionId,e.hpa,e.zUa,G)},Hc=function(Gf){return e.OWb.Oue(Gf.solutionId)},yd=function(Gf,ag,Nf){ja--;Nf=new te(J,ag,Aa,null,ka,Nf,0>=ja);Gf&&ag?e.Ppc(Nf):(e.cWa&&(3===J||ag&&ag.isUpgraded)&&(Gf="",ag&&(Gf=Telemetry.PrivacyRules.GetAssetId(ag.storeType,ag.storeId,ag.solutionId)),ag={},ag=(ag.SDX_AppInstallOrigin="User",ag.SDX_IsAutoLaunchEnabled=e.EDa,ag.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",ag.SDX_Id=
Gf,ag),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bj.a.Qk(ag)}))),e.Opc(Nf));ja||Bf.AFrameworkApplication.sa.updateCommandUI()},we=function(Gf,ag,Nf,Pg){yd(Gf,ag,Pg)},$e=function(){e.Olc();0>=C.count&&4===J&&e.Zqa.Ivc()};6===J?(gb=Ua[ug.a.AIa],Ua=Ua[ug.a.BIa],bc.Nri(C.oa(0),gb,Ua,Mc,Hc,function(Gf,ag,Nf,Pg){yd(Gf,ag,Pg)})):bc.hNa(C,Mc,Hc,gb,we,$e,this.Dce)}else this.cWa&&(bc={},bc=(bc.SDX_AppInstallOrigin="User",bc.SDX_IsAutoLaunchEnabled=
this.EDa,bc.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",bc.SDX_Id="",bc),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bj.a.Qk(bc)}))),Te.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.zUa.lK)),this.Opc(new te(J,null,null,null,ka,null,!0))};ld.prototype.Opc=function(G){this.Olc(G);this.w4f(!1,G)};ld.prototype.Ppc=function(G){var ka=G.gi,Ua=null;null!==ka&&
(Ua=ka.storeType||ka.currentStoreType,Ua=Ua.toLowerCase());if(this.cWa&&ka&&"omex"===ka.storeType&&G&&(3===G.hs||ka.isUpgraded)){var e={};e=(e.SDX_AppInstallOrigin="User",e.SDX_IsAutoLaunchEnabled=this.EDa,e.SDX_AppInstallErrorCode="0",e.SDX_Id=Telemetry.PrivacyRules.GetAssetId(Ua,ka.storeId,ka.solutionId),e);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bj.a.Qk(e)}))}this.Olc(G);this.EDa&&ka&&"omex"===ka.storeType&&G.o0&&(3===G.hs&&"hardcodedpreinstall"!==
Ua||ka.isUpgraded)&&(e=new oe,e.gi=ka,e.Ao=G.o0.oxa,this.rb.raiseEvent(ug.a.BXc,e));if(this.$qg){e=md();var C=je();e&&ka&&"excatalog"===ka.storeType&&G.o0&&5===G.hs&&C&&(ka.storeId&&ka.storeId.toLowerCase()===C.toLowerCase()||ka.assetId&&ka.assetId.toLowerCase()===C.toLowerCase())&&(e=new oe,e.gi=ka,e.Ao=G.o0.oxa,this.rb.raiseEvent(ug.a.BXc,e),Te.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ka&&(Ke.instance.GYf(Qf(Ua),!0),"uploadfiledevcatalog"===Ua&&(e=this.Fkg.createAddinDataProvider(Ua,
this.Om))&&e.localCacheAddinCommands(this.Om.nma,ka.solutionId||ka.id,ka.version||ka.appVersion,ka.storeId),this.Glj(G.o0.oxa,Ua,G.hs,G.VVe),Z.a.WMb(ug.a.lZb,"true",Qf(Ua)));this.w4f(!0,G)};ld.prototype.w4f=function(G,ka){if(G)if(Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ka.o0&&5===ka.hs&&ka.o0.oxa&&void 0!==ka.gi.showCallout&&null!==ka.gi.showCallout&&ka.gi.showCallout)(new Ud(this.rb,ka.gi,Rc.a.eub(ka.o0.oxa))).fBg(),
G=new oe,G.Ao=ka.o0.oxa,G.gi=ka.gi,this.rb.raiseEvent(ug.a.F3f,G);else if(3!==ka.hs)ka.Ujf&&this.Zqa.Ivc();else{if(ka.o0&&ka.o0.oxa&&(G=Object(Ci.a)(Fd.Ribbon,ka.VVe),"hardcodedpreinstall"!==ka.gi.storeType)){var Ua=!1;this.EDa&&(Ua=ka.gi.isAutoLaunched);pk.a.DAj(G,ka.cGh,ka.displayName,ka.o0.oxa,Ua)}}else 3===ka.hs?ka.gi&&"uploadfiledevcatalog"===ka.gi.storeType.toLowerCase()?(ka=this.hpa.IPh(ka.gi.solutionId),pk.a.jRd(ka?ka:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.Zqa.MZf():ka.Ujf&&this.Zqa.Ivc()};ld.prototype.Olc=function(G){var ka=(G=void 0===G?null:G)?G.gi:null,Ua=new oe;if(Ua.gi=ka){var e;(e=this.Zqa.Yia(ka.storeType||ka.currentStoreType,ka.solutionId||ka.id,6===G.hs?1:0))&&e.Ao&&(Ua.Ao=e.Ao,this.cWa&&3===G.hs&&"hardcodedpreinstall"!==ka.storeType)&&(G="",e.Ao.mW&&e.Ao.mW.Mr&&(e=e.Ao.mW.Mr.oa(0))&&(G=e.id),e={},ka=(e.SDX_CommandPlacement=G,e.SDX_PinningAction="Pinning",e.SDX_PinningActionErrorCode="0",e.SDX_Id=Telemetry.PrivacyRules.GetAssetId(ka.storeType,
ka.storeId,ka.solutionId),e),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:bj.a.Qk(ka)})))}this.rb.raiseEvent(ug.a.Uoe,Ua)};ld.prototype.Glj=function(G,ka,Ua,e){e=Object(Ci.a)(Fd.Ribbon,e);G&&e&&(G=G.tabs.oa(0).MSa[Pc.a.id],3===Ua&&"hardcodedpreinstall"!==ka&&e.bNd(G),e.lni(G)&&e.Flj())};Object(de.a)(ld,"LaunchAddinCommandsHandler",null,[811]);b(914);b(892);od.prototype.N7=function(){return Rg.k(this.a4d,this.MAi(),this.zA)};od.prototype.MAi=
function(){var G=null;if(this.Qfa){G=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');for(var ka=yl(this.Qfa),Ua=ka.next();!Ua.done;Ua=ka.next())G.append(Ua.value.N7());G.append("</Controls></MenuSection></Menu>")}return G?G.toString():""};Qk.Object.defineProperties(od.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},zA:{configurable:!0,enumerable:!0,get:function(){return this.Z3d||(this.Z3d={})}},controlType:{configurable:!0,enumerable:!0,
get:function(){return this.a4d||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.Qfa||(this.Qfa=new sh.a)}}});Object(de.a)(od,"ControlDefinition",null,[809]);mc.prototype.N7=function(){return Rg.k(Pc.a.button,null,this.ZMc)};Qk.Object.defineProperties(mc.prototype,{CR:{configurable:!0,enumerable:!0,get:function(){return this.ZMc||(this.ZMc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(de.a)(mc,"MenuItemDefinition",null,[846]);Xb.prototype.N7=
function(){var G=null;if(this.y8){G=new Sys.StringBuilder;for(var ka=yl(this.y8),Ua=ka.next();!Ua.done;Ua=ka.next())G.append(Ua.value.N7())}return G?G.toString():""};Qk.Object.defineProperties(Xb.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.y8||(this.y8=new sh.a)}}});Object(de.a)(Xb,"OfficeMenuDefinition",null,[808]);var se=b(30);Va.prototype.addButton=function(G){Te.ULS.sendTraceTag(17085952,220,50,
"ContextMenu button actiontype: {0}.",G.actionType);this.dJ=new od(this.aQ(G.id),Pc.a.button);this.dJ.zA[Pc.a.egb]=G.label;this.dJ.zA[Pc.a.dCa]=G.label;this.dJ.zA[Pc.a.gCa]=G.icon["16"];this.isa(this.dJ.zA[Pc.a.id],G.action);this.t2(this.dJ.zA);this.jVa.controls.add(this.dJ);this.dJ=null};Va.prototype.startBuildMenu=function(G){if(vi.c(this.jVa))this.jVa=new Xb(G.id);else{var ka=this.aQ(G.id);this.dJ=new od(ka,Pc.a.tZ);this.uha(this.dJ.zA,G);this.dJ.zA[Pc.a.gCa]=G.icon["16"];this.dJ.zA[Pc.a.sUa]=
se.a.alwaysEnabled}};Va.prototype.addMenuItem=function(G){Te.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",G.actionType);var ka=new mc(this.aQ(G.id));this.uha(ka.CR,G);G.icon&&(ka.CR[Pc.a.gCa]=G.icon["16"]);this.isa(ka.CR[Pc.a.id],G.action);this.t2(ka.CR);this.dJ.menuItems.add(ka)};Va.prototype.endBuildMenu=function(){vi.c(this.dJ)?(this.Pkc.add(this.jVa),this.jVa=null):(this.jVa.controls.add(this.dJ),this.dJ=null)};Va.prototype.isa=function(G,ka){this.smb.bindAction(G,
ka)};Va.prototype.t2=function(G){this.YGa.t2(G)};Va.prototype.aQ=function(G){return this.a6.cva(G)};Va.prototype.uha=function(G,ka){G[Pc.a.egb]=ka.label;G[Pc.a.dCa]=ka.label};Qk.Object.defineProperties(Va.prototype,{a6:{configurable:!0,enumerable:!0,get:function(){return this.$jb}},YGa:{configurable:!0,enumerable:!0,get:function(){return this.efa}},smb:{configurable:!0,enumerable:!0,get:function(){return this.Vea}},Pkc:{configurable:!0,enumerable:!0,get:function(){return this.Fsg}}});Object(de.a)(Va,
"ContextMenuExtensibilityCreator",null,[856,828]);sa.prototype.cva=function(G){return this.cOa+G};Qk.Object.defineProperties(sa.prototype,{cOa:{configurable:!0,enumerable:!0,get:function(){return this.hEa}}});Object(de.a)(sa,"DefaultContextMenuNamingProvider",null,[858]);Nb.prototype.wNh=function(G){return this.Q2g+G};Qk.Object.defineProperties(Nb.prototype,{PJj:{configurable:!0,enumerable:!0,get:function(){return this.Hxg}},Q2g:{configurable:!0,enumerable:!0,get:function(){return this.lng}}});Object(de.a)(Nb,
"DefaultRibbonGroupTemplate",null,[865]);Qk.Object.defineProperties(Ib.prototype,{Vdb:{configurable:!0,enumerable:!0,get:function(){return this.Tlb}}});Object(de.a)(Ib,"DefaultRibbonGroupTemplateResolver",null,[857]);var Ye=b(1294);Jc.prototype.bindAction=function(G,ka){OfficeExt.DefaultControlActionBinder.bindAction(G,ka)};Object(de.a)(Jc,"DefaultUIControlActionBinder",null,[830]);Mb.prototype.t2=function(G){G[Pc.a.sUa]=this.command};Qk.Object.defineProperties(Mb.prototype,{command:{configurable:!0,
enumerable:!0,get:function(){return this.ECa}}});Object(de.a)(Mb,"DefaultUIControlCommandBinder",null,[829]);var ff=b(31);Object(de.a)(Sa,"AddInControl",null,[]);Object(de.a)(ib,"AddInGroup",null,[]);Object(de.a)(Tb,"AddInMenuItem",null,[]);Object(de.a)(Ab,"AddInTab",null,[]);kc.prototype.startBuildTab=function(G){var ka=G.isOfficeTab?G.id:this.a6.ihd(G.id),Ua=G.isOfficeTab?null:G.label;this.Av=Object.assign(new Ab,{id:ka,title:Ua,isOfficeTab:G.isOfficeTab,visible:G.visible,groups:[],tabType:G.tabType,
insertBefore:G.insertBefore,insertAfter:G.insertAfter,autoFocus:G.autoFocus})};kc.prototype.startBuildGroup=function(G){var ka=this.aQ(G.id);this.Sw=Object.assign(new ib,{id:ka,mlrId:G.mlrId,title:G.label,controls:[],groupType:0})};kc.prototype.addNativeGroup=function(G){this.Sw=Object.assign(new ib,{id:G.id,mlrId:G.mlrId,title:G.label,controls:[],groupType:1});this.Av.groups.push(this.Sw)};kc.prototype.addButton=function(G){var ka=this.aQ(G.id);ka&&(this.isa(ka,G.action),Te.ULS.sendTraceTag(24786640,
220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new Sa,{id:ka,title:G.label,iconLocation:this.gfd(G),enabled:G.enabled,controlType:0,attributes:this.uha()}),this.d6d.ule(new ff.a(ka,this.YGa.command.toString())),this.Sw.controls.push(G))};kc.prototype.addNativeControl=function(G){G.id&&(Te.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new Sa,{id:G.id,title:"",iconLocation:"",enabled:G.enabled,
controlType:2,attributes:this.uha()}),this.Sw.controls.push(G))};kc.prototype.startBuildMenu=function(G){var ka=this.aQ(G.id);ka&&(this.z8=Object.assign(new Sa,{id:ka,title:G.label,iconLocation:this.gfd(G),controlType:1,attributes:{},menuItems:[]}))};kc.prototype.addMenuItem=function(G){var ka=this.aQ(G.id);ka&&(this.isa(ka,G.action),Te.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",G.actionType),G=Object.assign(new Tb,{id:ka,title:G.label,iconLocation:this.gfd(G),
enabled:G.enabled,attributes:this.uha()}),this.d6d.ule(new ff.a(ka,this.YGa.command.toString())),this.z8.menuItems.push(G))};kc.prototype.endBuildMenu=function(){vi.c(this.z8.id)||this.Sw.controls.push(this.z8);this.z8=null};kc.prototype.endBuildGroup=function(){vi.c(this.Sw.id)||this.Av.groups.push(this.Sw);this.Sw=null};kc.prototype.endBuildTab=function(){vi.c(this.Av.id)||this.DPb.add(this.Av);this.Av=null};kc.prototype.uha=function(){var G={};this.t2(G);return G};kc.prototype.gfd=function(G){return G.icon["80"]?
G.icon["80"]:G.icon["32"]};kc.prototype.t2=function(G){this.YGa.t2(G)};kc.prototype.aQ=function(G){return this.a6.cva(G)};kc.prototype.isa=function(G,ka){this.smb.bindAction(G,ka)};Qk.Object.defineProperties(kc.prototype,{a6:{configurable:!0,enumerable:!0,get:function(){return this.$jb}},Mr:{configurable:!0,enumerable:!0,get:function(){return this.DPb}},czc:{configurable:!0,enumerable:!0,get:function(){return null}},smb:{configurable:!0,enumerable:!0,get:function(){return this.Vea}},YGa:{configurable:!0,
enumerable:!0,get:function(){return this.efa}}});Object(de.a)(kc,"OneLineRibbonExtensibilityCreator",null,[827,828]);mb.prototype.N7=function(){for(var G=new sh.a,ka=yl(this.dia),Ua=ka.next();!Ua.done;Ua=ka.next())G.add(Ua.value.N7());G=Rg.e.apply(null,[Pc.a.tUa,null].concat(G.toArray()));return Rg.e(Pc.a.GROUP,this.Gva,G)};Qk.Object.defineProperties(mb.prototype,{Vdb:{configurable:!0,enumerable:!0,get:function(){return this.Tlb},set:function(G){this.Tlb=G;this.Gva[Pc.a.I0d]=this.Tlb}},Gva:{configurable:!0,
enumerable:!0,get:function(){return this.i7d||(this.i7d={})}},dia:{configurable:!0,enumerable:!0,get:function(){return this.$3d||(this.$3d=new sh.a)}}});Object(de.a)(mb,"GroupDefinition",null,[]);Wa.prototype.N7=function(){for(var G=new sh.a,ka=new sh.a,Ua=yl(this.tMd),e=Ua.next();!e.done;e=Ua.next())G.add(e.value.N7());Ua=yl(this.gK);for(e=Ua.next();!e.done;e=Ua.next())ka.add(e.value.N7());ka=this.jve(Pc.a.cgb,this.X5e,ka.toArray());G=this.jve(Pc.a.KDc,this.CWf,G.toArray());return Rg.e(Pc.a.G0d,
this.MSa,G,ka)};Wa.prototype.jve=function(G,ka,Ua){var e={};e[Pc.a.id]=ka;return Rg.e.apply(null,[G,e].concat(Ua))};Qk.Object.defineProperties(Wa.prototype,{WAa:{configurable:!0,enumerable:!0,get:function(){return this._id}},MSa:{configurable:!0,enumerable:!0,get:function(){return this.bie||(this.bie={})}},gK:{configurable:!0,enumerable:!0,get:function(){return this.j7d||(this.j7d=new sh.a)}},tMd:{configurable:!0,enumerable:!0,get:function(){return this.age||(this.age=new sh.a)}}});Object(de.a)(Wa,
"TabDefinition",null,[]);cb.prototype.startBuildTab=function(G){G=G.isOfficeTab?this.a6.cVh(G.id):this.a6.ihd(G.id);this.Av=new Wa(G)};cb.prototype.startBuildGroup=function(G){G=this.aQ(G.id);this.Sw=new mb(G)};cb.prototype.addButton=function(G){var ka=this.aQ(G.id);this.isa(ka,G.action)};cb.prototype.startBuildMenu=function(){};cb.prototype.addMenuItem=function(G){var ka=this.aQ(G.id);this.isa(ka,G.action)};cb.prototype.endBuildMenu=function(){};cb.prototype.endBuildGroup=function(){this.Av.gK.add(this.Sw);
this.Sw=null};cb.prototype.endBuildTab=function(){vi.c(this.Av.WAa)||this.fie.add(this.Av);this.Av=null};cb.prototype.isa=function(G,ka){this.smb.bindAction(G,ka)};cb.prototype.aQ=function(G){return this.a6.cva(G)};Qk.Object.defineProperties(cb.prototype,{Mr:{configurable:!0,enumerable:!0,get:function(){return null}},a6:{configurable:!0,enumerable:!0,get:function(){return this.$jb}},smb:{configurable:!0,enumerable:!0,get:function(){return this.Vea}},czc:{configurable:!0,enumerable:!0,get:function(){return this.fie}}});
Object(de.a)(cb,"RibbonExtensibilityCreatorBase",null,[827,828]);Fa.prototype.N7=function(){return Rg.k(this.Evg,null,this.r0)};Qk.Object.defineProperties(Fa.prototype,{r0:{configurable:!0,enumerable:!0,get:function(){return this.$fe||(this.$fe={})}}});Object(de.a)(Fa,"ScalingDefinition",null,[]);vm(ta,cb);ta.prototype.startBuildTab=function(G){cb.prototype.startBuildTab.call(this,G);this.Av.isOfficeTab=G.isOfficeTab;if(!this.Av.isOfficeTab)this.Av.MSa[Pc.a.Uea]=this.u7b(G.label);else if(this.Av.WAa){var ka=
this.a6.RSh(G.id);ka&&(this.Av.MSa[Pc.a.Uea]=ka);(G=this.a6.PSh(G.id))&&(this.Av.MSa[Pc.a.y0d]=G)}G=this.Av.WAa;this.Av.CWf=G+"."+Pc.a.KDc;this.Av.X5e=G+"."+Pc.a.cgb};ta.prototype.startBuildGroup=function(G){cb.prototype.startBuildGroup.call(this,G);this.Sw.Gva[Pc.a.Uea]=this.u7b(G.label)};ta.prototype.addButton=function(G){cb.prototype.addButton.call(this,G);Te.ULS.sendTraceTag(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",G.actionType);var ka=this.fU(G,Pc.a.button);this.t2(ka.zA);
ka.zA[Pc.a.fCa]=G.enabled;this.Sw.dia.add(ka)};ta.prototype.startBuildMenu=function(G){this.z8=this.fU(G,Pc.a.tZ)};ta.prototype.addMenuItem=function(G){cb.prototype.addMenuItem.call(this,G);Te.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",G.actionType);var ka=this.aQ(G.id);ka=new mc(ka);this.uha(ka.CR,G);this.t2(ka.CR);ka.CR[Pc.a.fCa]=G.enabled;this.z8.menuItems.add(ka)};ta.prototype.endBuildMenu=function(){this.Sw.dia.add(this.z8);this.z8=null};ta.prototype.endBuildGroup=
function(){this.DRg();this.Av.tMd.add(this.hfa);this.kfa&&(this.Av.tMd.add(this.kfa),this.kfa=null);this.hfa=null;cb.prototype.endBuildGroup.call(this)};ta.prototype.t2=function(G){this.YGa.t2(G)};ta.prototype.fU=function(G,ka){var Ua=this.aQ(G.id);ka=new od(Ua,ka);this.uha(ka.zA,G);return ka};ta.prototype.uha=function(G,ka){G[Pc.a.egb]=this.u7b(ka.label);G[Pc.a.dCa]=this.u7b(ka.label);G[Pc.a.gCa]=ka.icon["16"];G[Pc.a.v0d]=ka.icon["32"]};ta.prototype.DRg=function(){var G=this.a3h.Vdb;this.Sw.Vdb=
G.PJj;var ka=this.Sw.dia.count;Te.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",ka);var Ua=this.Sw.Gva[Pc.a.id];this.hfa=new Fa(Pc.a.IDc);this.hfa.r0[Pc.a.id]=Ua+".Scaling."+Pc.a.IDc;this.hfa.r0[Pc.a.FDc]=this.Sw.Gva[Pc.a.id];2<ka&&(this.kfa=new Fa(Pc.a.JDc),this.kfa.r0[Pc.a.id]=Ua+".Scaling."+Pc.a.JDc,this.kfa.r0[Pc.a.FDc]=this.Sw.Gva[Pc.a.id]);this.$tj(ka,G)};ta.prototype.$tj=function(G,ka){var Ua=1;switch(G){case 1:case 2:this.hfa.r0[Pc.a.Voa]=Pc.a.LARGE;break;case 3:this.hfa.r0[Pc.a.Voa]=
Pc.a.LARGE;this.kfa.r0[Pc.a.Voa]=Pc.a.pPb;break;case 4:this.hfa.r0[Pc.a.Voa]=Pc.a.pPb+"TwoRow";this.kfa.r0[Pc.a.Voa]=Pc.a.SMALL+"TwoRow";break;case 5:case 6:this.hfa.r0[Pc.a.Voa]=Pc.a.pPb;this.kfa.r0[Pc.a.Voa]=Pc.a.SMALL;break;default:throw Te.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",G),this.hpa.setErrorMessageForAddin(this.SEc,CommonUIStrings.l_AddinManifestInvalid_Message),Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",
G));}for(var e=yl(this.Sw.dia),C=e.next();!C.done;C=e.next())C.value.zA[Pc.a.J0d]=ka.wNh(Ua),Ua+=3!==G?1:2};ta.prototype.u7b=function(G){return G?(G=Xc.a.replaceAll(G,"&","&amp;"),G=Xc.a.replaceAll(G,"'","&apos;"),G=Xc.a.replaceAll(G,'"',"&quot;"),G=Xc.a.replaceAll(G,">","&gt;"),G=Xc.a.replaceAll(G,"<","&lt;")):null};Qk.Object.defineProperties(ta.prototype,{a3h:{configurable:!0,enumerable:!0,get:function(){return this.Spg}},YGa:{configurable:!0,enumerable:!0,get:function(){return this.efa}}});Object(de.a)(ta,
"RibbonExtensibilityCreator",cb,[]);ra.prototype.Oue=function(G){G=new sa(G);return new Va(G,this.efa,this.Vea)};ra.prototype.ARg=function(G,ka,Ua){Ua=new Ye.a(this.hEa,G,Ua,!0);var e=new Ib(this.hEa+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new ta(Ua,this.Vea,this.efa,e,G,ka)};ra.prototype.lRg=function(G,ka,Ua,e){Ua=new Ye.a(this.hEa,G,Ua,!0);return new kc(Ua,this.Vea,this.efa,G,ka,e)};Object(de.a)(ra,"UIExtensibilityFactory",null,[803]);var Wf=b(92),lg=b(949);Ba.prototype.w$i=
function(G){this.Ro=G;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(Pi.a)(this,this.aPi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",Object(Pi.a)(this,this.qKi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(Pi.a)(this,this.VIi,"onCloseButtonClicked_ContentAddin"),!0))};Ba.prototype.rgd=function(G){return"[id="+G+"]"};Ba.prototype.a5f=function(G,ka){var Ua=this;ka>Bf.AFrameworkApplication.ga.Bd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)?(window.clearTimeout(this.Urc),this.$4f("[data-unique-id='pivotOverflowButton']"),Te.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+G)?this.$4f(G):this.Urc=window.setTimeout(function(){Ua.a5f(G,ka+1)},1E3)};Ba.prototype.Z4f=function(G){var ka=document.querySelector("button[data-unique-id='RightPaddle']");if(ka)G={},G=(G.AppTeachingUICalloutAction="RightPaddlePresent",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.gi.storeType,
this.gi.storeId,this.gi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}));else if(ka=document.querySelector("button"+G),!ka&&(ka=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ka)){ka={};ka=(ka.AppTeachingUICalloutAction="NoAnchor",ka["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.gi.storeType,this.gi.storeId,
this.gi.assetId),ka.AppTeachingUICalloutGoal="NewAdminDeployment",ka["SDX.AppInstallOrigin"]="Organization",ka);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(ka)}));Te.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");return}this.qag(ka,"ShowTeachingUIForAddinButton")};Ba.prototype.$4f=function(G){G=document.querySelector("button"+G);if(!G&&(G=document.querySelector("button[data-unique-id='pivotOverflowButton']"),
!G)){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.gi.storeType,this.gi.storeId,this.gi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}));Te.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");return}this.qag(G,"ShowTeachingUIForAddinTab")};
Ba.prototype.qag=function(G,ka){G.setAttribute("lpp-id","latestAddin");var Ua=oi.a.instance.pc("Common.ISystemInitiatedFeedback");Ua&&G?(Ua.execute(function(e){e.logActivity(ka,null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.gi.storeType,this.gi.storeId,this.gi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:bj.a.Qk(G)})),Te.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Te.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.gi.storeType,this.gi.storeId,this.gi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)})))};Ba.prototype.MJh=function(G){if(!G)return null;G=G.mW;if((null===G||void 0===G?0:G.Mr)&&0<G.Mr.count){G=yl(G.Mr);for(var ka=G.next();!ka.done;ka=G.next())if(ka=ka.value,ka.groups&&0<ka.groups.length){ka=yl(ka.groups);for(var Ua=ka.next();!Ua.done;Ua=ka.next())if(Ua=Ua.value,Ua.controls&&0<Ua.controls.length){Ua=yl(Ua.controls);for(var e=Ua.next();!e.done;e=Ua.next()){e=e.value;if(e.attributes&&0===e.controlType&&e.enabled)return e.id;
if(e.menuItems)for(var C=yl(e.menuItems),J=C.next();!J.done;J=C.next())if(J=J.value,J.attributes&&J.enabled)return e.id}}}}return null};Ba.prototype.dDj=function(){var G=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(null==G){G=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==G){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Ro.storeType,this.Ro.storeId,this.Ro.assetId),
G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}));Te.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}Te.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}else Te.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");var ka=oi.a.instance.pc("Common.ISystemInitiatedFeedback");
null==ka||null==G?(G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Ro.storeType,this.Ro.storeId,this.Ro.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)})),Te.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture")):(ka.execute(function(Ua){Ua.logActivity("ShowTeachingUIForContentAddin",
null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Ro.storeType,this.Ro.storeId,this.Ro.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)})),Te.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};Ba.prototype.aPi=function(){var G=
{};G=(G.AppTeachingUICalloutAction="ClickOnLaunch",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Ro.storeType,this.Ro.storeId,this.Ro.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}));var ka={};ka[yj.a.Tg]=this.Ro;G={};G.solutionId=this.Ro.solutionId;G.assetId=this.Ro.assetId;G.assetStoreId=this.Ro.assetStoreId;G.height=
0!=this.Ro.height?this.Ro.height:600;G.storeId=this.Ro.storeId;G.storeType=this.Ro.storeType;G.targetType=this.Ro.targetType;G.width=0!=this.Ro.width?this.Ro.width:600;G.displayName=this.Ro.displayName;G.version=this.Ro.version;G.isAddinCommands=!1;ka[ug.a.KYa]=G;var Ua=new Wf.a(-741808261,0,0,2,null);Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.Wa(this.$.da,374,375,1),function(e){e=e.result;null!=e&&e.insertAgave(ka,Ua)},this.$.ma,3)};Ba.prototype.VIi=function(){var G={};G=(G.AppTeachingUICalloutAction=
"ClickOnClose",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Ro.storeType,this.Ro.storeId,this.Ro.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}))};Ba.prototype.qKi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Ro.storeType,this.Ro.storeId,this.Ro.assetId),
G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(G)}))};Object(de.a)(Ba,"AddinTeachingCalloutHandler",null,[]);var rh=b(1243),Ch=b(376),th=b(8),Ii=b(37);O.prototype.dispose=function(){void 0!==this.znb&&null!==this.znb&&(this.znb.dispose(),this.znb=null);this.Xe=this.$=null;this.disposed=!0};O.prototype.oTi=function(G){var ka=this;if(void 0!==
G&&this.YQd&&isNullOrUndefined(this.Xyc)){var Ua=G.solutionId;Te.ULS.sendTraceTag(526509831,220,50,"Start monitor addin {0}.",Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,Ua));this.Xyc=Ua;this.Urc=window.setTimeout(function(){ka.YQd&&(oi.a.instance.pc("Common.ISystemInitiatedFeedback").execute(function(e){e.logActivity("Office_Excel_Addins_NoActivationFloodgate",null)}),Te.ULS.sendTraceTag(526254983,220,15,String.format("The addin {0} is not launched in 5 mins",Telemetry.PrivacyRules.GetAssetId(G.storeType,
G.storeId,ka.Xyc))),ka.YQd=!1)},this.zIj)}};O.prototype.kbj=function(G){Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1)&&this.Xyc===G&&(window.clearTimeout(this.Urc),this.Xyc=void 0)};O.prototype.Yxj=function(G,ka){switch(G){case se.a.x2:G=this.Kxj(ka);break;default:G=!1}return G};O.prototype.Zc=function(){return!1};O.prototype.executeCommand=function(G,ka,Ua){var e=this;G=Fh.TaskExtensions.nm();ka=ka.command;switch(ka){case 843847158:break;
case -2025863019:pk.a.jRd(Ua[ug.a.DVc].toString(),function(){Qi.g(e.$).focus()});break;case -1777565636:rh.a.showUILessDialog(Ua[ug.a.Anb].toString());this.Xe.SAj(Ua[ug.a.Anb].toString());break;case 1592314317:rh.a.hideUILessDialog(Ua[ug.a.Anb].toString());this.Xe.E7h(Ua[ug.a.Anb].toString());break;case se.a.x2:G=this.qid(Ua);break;case se.a.GAb:this.hNa(Ua);break;case se.a.Zma:this.Zma(Ua);break;case se.a.kRd:this.znb.vxc();break;case se.a.refreshAddinCommands:this.t8i();break;case 1949669462:this.$ga.MZf(!0);
break;case -1014260128:G=this.executeDynamicAddInCommandsAPI(Ua);break;default:G=Hi.a(ka)}return G};O.prototype.Kc=function(G,ka){G=!1;switch(ka.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case se.a.Zma:case se.a.kRd:case se.a.refreshAddinCommands:case 1949669462:case se.a.GAb:case -1014260128:G=!0;break;case se.a.x2:G=!Bf.AFrameworkApplication.protectedFile}return G};O.prototype.gd=function(){return!1};O.prototype.tNh=function(G){if(!G)return Te.ULS.sendTraceTag(528098432,
220,10,"Failed to get button id for addin"),null;if((G=G.mW)&&G.Mr&&0<G.Mr.count){G=yl(G.Mr);for(var ka=G.next();!ka.done;ka=G.next()){ka=ka.value;if(ka.groups&&1===ka.groups.length){var Ua=ka.groups[0];if(Ua.controls&&1===Ua.controls.length){var e=Ua.controls[0];if(e.attributes&&!e.controlType&&e.enabled)return e.id}Ua.controls&&Te.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ka.groups&&Te.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};O.prototype.t8i=function(){if(this.$ga.Gtd()){this.$ga.Oye();
var G=this.pdd();if(G&&0<G.count){G=yl(G);for(var ka=G.next();!ka.done;ka=G.next()){var Ua={};ka=(Ua[ug.a.G2]=ka.value,Ua[ug.a.xJ]=4,Ua[ug.a.JFa]=(new Date).getTime(),Ua);this.Zma(ka)}}}};O.prototype.Zma=function(G){var ka=this;Te.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",G[ug.a.xJ],G[ug.a.G2]);this.$ga.eqj();window.setTimeout(function(){if(void 0===ka.Xe||null===ka.Xe)Te.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",
Ii.a.r3()));else{var Ua=new rb(new nd(ka.Xe.Ii),zc.instance,Ke.instance);Ua.PDg(function(e,C){ka.hNa(C.properties)});Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Bf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Ua.mHg(function(e,C){null==C?(e={},e=(e.AppTeachingUICalloutAction="InvalidEventArgs",e.AppTeachingUICalloutGoal="NewAdminDeployment",e["SDX.AppInstallOrigin"]=
"Organization",e),Zh.a.sendTelemetryEvent(Object.assign(new qi.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bj.a.Qk(e)}))):(ka.d9f=new Ba(ka),ka.d9f.w$i(C),e=ka.$.Ka,null!=e&&(e.Loe(Object(Pi.a)(ka,ka.pbf,"onTabSwitched")),Te.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ua.aPj(G)}},0)};O.prototype.pbf=function(G,ka){"Insert"==ka.tabName&&(G=this.$.Ka,null!=G&&(G.CRf(Object(Pi.a)(this,this.pbf,"onTabSwitched")),Te.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),
this.d9f.dDj())};O.prototype.hNa=function(G){var ka=this;if(!this.disposed){Te.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",G[ug.a.xJ]);if(Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1))try{var Ua=G[ug.a.IFa],e=G[ug.a.xJ];if(Ua&&0<Ua.count&&3==e){var C=Ua.oa(0);C.storeType==OSF.StoreType.OMEX&&this.oTi(C)}}catch(Hc){Te.ULS.sendTraceTag(526509830,220,10,String.format("Monitor survey error message : {0}.",Hc.message))}try{if(dg.EwaSettings.la(187)){var J=
G[ug.a.IFa];if(J&&0<J.count){var ja=J.count;for(Ua=ja-1;0<=Ua;Ua--){var Aa=J.oa(Ua);dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Aa.currentStoreType)||J.remove(J.oa(Ua)):Aa.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&J.remove(J.oa(Ua))}if(J.count<ja){var gb=aj.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Fh.TaskExtensions.Ba(gb,function(){gb.result.ig(35,null)},this.$.ma,3)}if(!J.count)return}}if(void 0===
this.Xe||null===this.Xe)Te.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",Ii.a.r3()));else{var bc=null;bc=Bf.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled")?new ld(this.$n,this.gCe,new nd(this.Xe.Ii),new ra(this.$.Jb,se.a.x2),this.$ga,zc.instance,this.Zga,function(Hc,yd){var we={};we.InstanceId=Bh.a.create().toString();we.PrimaryMarketplace={};we.PrimaryMarketplace.MarketplaceRef=Hc.storeId;we.PrimaryMarketplace.MarketplaceType=
Hc.currentStoreType;we.PrimaryMarketplace.SolutionId=Hc.assetId;we.PrimaryMarketplace.SolutionVersion=Hc.appVersion;we.WebExtensionType=1;ka.Xe.kDj(we,function(){yd(Hc)})}):new ld(this.$n,this.gCe,new nd(this.Xe.Ii),new ra(this.$.Jb,se.a.x2),this.$ga,zc.instance,this.Zga);(Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinOnExcelWacEnabled",!1)||Bf.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled"))&&bc.WDg(this.GHi);
bc.QDg(this.ZOi);if(Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var Mc=new Ba(this);bc.JFg(Mc.YOi);bc.lHg(Mc.EAj)}this.$.da.Aa(53).Hm&&Mk.a.get_instance().jl(5,null).continueWith(function(){ka.disposed||bc.esi(ka.U$c,ka.$.domElement,G)})}}catch(Hc){Te.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",Hc.message))}}};O.prototype.qid=function(G){var ka=this,Ua=Fh.TaskExtensions.nm();
G=G[this.$n.eia];var e=this.iZb.qke(G),C=new rh.a(this.$,this.Xe,e.ownerAddinInfo,Ua);C.MDg(function(){ka.kbj(e.ownerAddinInfo.solutionId)});return this.$5e(Ua,G,e,C)};O.prototype.$5e=function(G,ka,Ua,e){var C=this;this.iZb.qid(ka,this.$ga,e,new nd(this.Xe.Ii),Ua,function(){G=e.W1g()},function(){Qi.g(C.$).focus()});return G};O.prototype.pNg=function(G){var ka=this,Ua=Fh.TaskExtensions.nm(),e=this.Xe.uaa(G.assetId);if(e){var C=this.Xe.pZ(e);if(th.HelperMethods.iw(C)&&0!==C.SharedRuntime.State)return}C=
this.iZb.qNg;var J=G.assetId in C?C[G.assetId]:null;if(J){var ja=this.iZb.qke(J),Aa=new rh.a(this.$,this.Xe,ja.ownerAddinInfo,Ua);C=function(bc){if(bc){var Mc={};bc=yl(bc);for(var Hc=bc.next();!Hc.done;Hc=bc.next())Hc=Hc.value,Mc[Hc[0]]=Hc[1];(Mc=ug.a.Toe in Mc?Mc[ug.a.Toe]:null)&&"true"===Mc.toLowerCase()&&(Te.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",G.currentStoreType,G.storeId,Telemetry.PrivacyRules.GetAssetId(null!==
ja.ownerAddinInfo?ja.ownerAddinInfo.storeType:G.currentStoreType,G.storeId,G.assetId)),ka.$5e(Ua,J,ja,Aa))}};Te.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",G.currentStoreType,G.storeId,Telemetry.PrivacyRules.GetAssetId(null!==ja.ownerAddinInfo?ja.ownerAddinInfo.storeType:G.currentStoreType,G.storeId,G.assetId));if(e)C(this.Xe.pZ(e).OsfPropertyBag);else if(e=this.$.ea.workbookContext.WebExtensions){e=yl(e);for(var gb=e.next();!gb.done;gb=
e.next())if(gb=gb.value,(1===gb.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===G.targetType&&gb.PrimaryMarketplace.MarketplaceType.toLowerCase()===G.currentStoreType.toLowerCase()&&gb.PrimaryMarketplace.MarketplaceRef.toLowerCase()===G.storeId.toLowerCase()&&gb.PrimaryMarketplace.SolutionId.toLowerCase()===G.assetId.toLowerCase()){C(gb.OsfPropertyBag);break}}}};O.prototype.RLb=function(G,ka,Ua){G&&(void 0===Ua||!Ua||ka||this.S5c.contains(G)||this.S5c.add(G),(Ua=this.o1a.contains(G))&&
ka&&this.o1a.remove(G),Ua||ka||this.o1a.add(G))};O.prototype.Ktj=function(G){var ka=G.mW;if(ka){if(ka.Mr)for(G=yl(ka.Mr),ka=G.next();!ka.done;ka=G.next())if(ka=ka.value,ka.groups){ka=yl(ka.groups);for(var Ua=ka.next();!Ua.done;Ua=ka.next())if(Ua=Ua.value,Ua.controls){var e=yl(Ua.controls);for(Ua=e.next();!Ua.done;Ua=e.next())if(Ua=Ua.value,this.RLb(Ua.id,Ua.enabled,!0),1===Ua.controlType&&Ua.menuItems){var C=yl(Ua.menuItems);for(Ua=C.next();!Ua.done;Ua=C.next())Ua=Ua.value,this.RLb(Ua.id,Ua.enabled,
!0)}}}}else if(G.tabs)for(G=yl(G.tabs),ka=G.next();!ka.done;ka=G.next())if(ka=ka.value,ka.gK)for(ka=yl(ka.gK),Ua=ka.next();!Ua.done;Ua=ka.next())if(Ua=Ua.value,Ua.dia)for(e=yl(Ua.dia),Ua=e.next();!Ua.done;Ua=e.next())if(Ua=Ua.value,this.RLb(Ua.id,Di.a.fCa in Ua.zA?Ua.zA[Di.a.fCa]:!0,!0),Ua.controlType===Di.a.tZ&&Ua.menuItems)for(C=yl(Ua.menuItems),Ua=C.next();!Ua.done;Ua=C.next())Ua=Ua.value,this.RLb(Ua.id,Di.a.fCa in Ua.CR?Ua.CR[Di.a.fCa]:!0,!0)};O.prototype.pdd=function(){var G=new sh.a;dg.EwaSettings.la(54)&&
(this.$.ea.oh.get(27)&&(G.add(0),G.add(16)),this.$.ea.oh.get(33)&&G.add(1),G.add(8));return G};O.prototype.executeDynamicAddInCommandsAPI=function(G){var ka=!0;if(void 0===G||null===G||void 0===G[ug.a.psb]||null===G[ug.a.psb])return ak.Task.Ta(!1);switch(G[ug.a.psb]){case 1:ka=this.ZRj(G);break;case 2:ka=this.Otj(G);break;case 4:this.o1a.clear();this.o1a.addRange(this.S5c);break;case 3:ka=this.installContextualTab(G);break;default:ka=!1}return ak.Task.Ta(ka)};O.prototype.Kxj=function(G){return G&&
this.$n.eia in G?(G=G[this.$n.eia])?this.o1a.contains(G):!1:!1};O.prototype.ZRj=function(G){var ka=null,Ua=null,e=null,C=!0;void 0!==G[ug.a.V3]&&null!==G[ug.a.V3]&&void 0!==G[this.$n.eia]&&null!==G[this.$n.eia]&&void 0!==G[ug.a.U3]&&null!==G[ug.a.U3]&&(ka=G[ug.a.V3],Ua=G[ug.a.b7b],e=G[this.$n.eia],C=G[ug.a.U3]);if(!ka||!e)return Te.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;G=(new Ye.a(this.$.Jb,ka,this.$n,!0)).cva(e);ka={DynamicAddinCommandsApiName:"UpdateControlEnableState"};
ka.AssetId=Ua;ka.MaskedTabId=G;ka.IsToEnable=C;Te.ULS.sendTraceTag(537170648,220,15,fj.a.Lc(ka));this.RLb(G,C);Ch.a.Hy.updateCommandUI();return!0};O.prototype.Otj=function(G){var ka,Ua,e=null,C=null,J=null,ja=null,Aa=!0;void 0!==G[ug.a.A7c]&&null!==G[ug.a.A7c]&&void 0!==G[ug.a.V3]&&null!==G[ug.a.V3]&&void 0!==G[this.$n.eia]&&null!==G[this.$n.eia]&&void 0!==G[ug.a.U3]&&null!==G[ug.a.U3]&&(e=G[ug.a.A7c],C=G[ug.a.V3],J=G[ug.a.b7b],ja=G[this.$n.eia],Aa=G[ug.a.U3]);if(!e||!C||!ja)return Te.ULS.sendTraceTag(537170647,
220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;G=(new Ye.a(this.$.Jb,C,this.$n,!0)).ihd(ja);ja={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};ja.StoreType=e;ja.AssetId=J;ja.MaskedTabId=G;ja.IsToShow=Aa;Te.ULS.sendTraceTag(537170646,220,15,fj.a.Lc(ja));C=this.$ga.Yia(e,C,1);e=!1;if(null===(Ua=null===(ka=null===C||void 0===C?void 0:C.Ao)||void 0===ka?void 0:ka.mW)||void 0===Ua?0:Ua.Mr)for(ka=yl(C.Ao.mW.Mr),Ua=ka.next();!Ua.done;Ua=ka.next())if(Ua.value.id===G){e=
!0;break}if(!e)return Te.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;ka=[];Aa?appChrome.selectors.getSelectedTabId()!==G&&ka.push(appChrome.actions.activateRibbonTab(G)):(appChrome.selectors.getSelectedTabId()===G&&ka.push(appChrome.actions.setCurrentTab(Fi.a.FW)),ka.push(appChrome.actions.deactivateRibbonTab(G)));appChrome.api.dispatch(ka);return!0};O.prototype.installContextualTab=function(G){var ka=null,Ua=null,e=null,C=null;if(void 0!==G[ug.a.V3]&&
null!==G[ug.a.V3]&&void 0!==G[ug.a.U3]&&null!==G[ug.a.U3]){var J=G[ug.a.U3];ka=G[ug.a.V3];void 0!==J[ug.a.AIa]&&null!==J[ug.a.AIa]&&void 0!==J[ug.a.BIa]&&null!==J[ug.a.BIa]&&(Ua=J[ug.a.AIa],e=J[ug.a.BIa],C=J[ug.a.B7c])}if(!(ka&&e&&Ua&&C))return Te.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;G=this.$ga.Yia(C.PrimaryMarketplace.MarketplaceType,C.PrimaryMarketplace.SolutionId,1);if(null===G||void 0===G?0:G.Ao)return Te.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),
!1;G={};G.solutionId=C.PrimaryMarketplace.SolutionId;G.version=C.PrimaryMarketplace.SolutionVersion;G.storeType=C.PrimaryMarketplace.MarketplaceType;G.storeId=C.PrimaryMarketplace.MarketplaceRef;G.assetId=C.PrimaryMarketplace.SolutionId;G.assetStoreId=C.PrimaryMarketplace.MarketplaceRef;G.targetType=C.WebExtensionOsfControlType;G.width=C.TaskpaneWidth;G.height=0;G.isAddinCommands=!0;G.id=G.assetId;G.appVersion=C.PrimaryMarketplace.SolutionVersion;G.currentStoreType=C.PrimaryMarketplace.MarketplaceType;
C=new sh.a;C.add(G);G={};G[ug.a.IFa]=C;G[ug.a.xJ]=6;G[ug.a.AIa]=Ua;G[ug.a.BIa]=e;this.hNa(G);return!0};Object(de.a)(O,"AddinUICommandHandler",null,[791,239,2]);var zi=b(72);Qb.prototype.jKb=function(){return this.mQd()};Qb.prototype.activate=function(){return this.mTc()};Qb.prototype.deactivate=function(){this.I5c()};Qb.prototype.dispose=function(){this.I5c=this.mTc=this.mQd=null};Object(de.a)(Qb,"FeatureActivator",null,[49,2]);var Ni=b(21),Oi=b(17),Ki=Aj.a;vm(dc,Ki);dc.prototype.Pd=function(){var G=
this;Te.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");zi.a(this.$).add(Object.assign(new Qb,{mQd:function(){var ka=G.$.ea.oF&&G.$.ea.rc&&!!(G.$.Jd&16384)&&G.$.isEditMode;G.$.ea.rc&&Te.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",ka,G.$.ea.oF,G.$.ea.rc,!!(G.$.Jd&16384),G.$.isEditMode);return ka},
mTc:this.Lzg,I5c:this.Ybh,V8b:2}))};dc.prototype.a9i=function(G){var ka=this,Ua=aj.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.ub);return Fh.TaskExtensions.Ba(Ua,function(){Te.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");ka.$.da.Ha(204,new ke(Ua.result,G))},this.ma,3)};dc.ka=function(G){Aj.a.he(199,new dc(G))};Object(de.a)(dc,"AddinUICommandHandlerFactory",Aj.a,[]);var Bj=b(1232),nj=b(1234),$g=
Ug.a;vm(Kb,$g);Kb.prototype.create=function(){var G=this,ka;if(dg.EwaSettings.la(413)){var Ua=aj.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,this.ub),e=aj.GetServiceTaskFactory.create(this.$.da,396,this.$.ma,this.ub);Fh.TaskExtensions.Ba(ak.Task.WAA(Ua,e),function(){G.Gb(G.$.da.Aa(278)||new Bj.CustomFunctionsInstaller(G.$,Ua.result,e.result))},this.$.ma,3)}else(ka=this.$.da.Aa(278))||(ka=this.$.da.Ha(278,new nj.CustomFunctionsLegacyInstaller(this.$))),this.Gb(ka)};Kb.ka=function(G){G.da.Ha(279,
new Kb(G))};Object(de.a)(Kb,"CustomFunctionsInstallerFactory",Ug.a,[]);var Wh=b(88),Ri=b(44),Si=b(42);jc.prototype.ka=function(G){this.qXc?Te.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.qXc=!0,this.RPa={},this.SPa={},G?G.CEg(this.uag):Te.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};jc.prototype.detach=function(G){if(G){G.bcj(this.uag);G=this.RPa;for(var ka in G)Wh.a.Fa(G[ka]);
this.SPa=this.RPa=null;this.qXc=!1}else Te.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};jc.prototype.kNf=function(G,ka,Ua){if(this.Cfi(Ua,G))return!1;G=ka.querySelector("iframe");if(!G)return Te.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;G=G.title;if(!G||!G.length)return Te.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),
!0;this.ariaLiveNotifier.readText(G);return!0};jc.prototype.Cfi=function(G,ka){return(G=G.Ii.getOsfControl(ka))?G.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(de.a)(jc,"AgaveOnSelectedReadoutHandler",null,[712]);var Ej=Ug.a;vm(Ub,Ej);Ub.prototype.create=function(){var G=this,ka=this.$.da;Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.Wa(ka,211,212,this.ub),function(Ua){Ua=ka.Aa(224)||new jc(Ua.result,G.$);G.Gb(Ua)},this.ma,3)};Ub.ka=function(G){G.da.Ha(225,new Ub(G))};Object(de.a)(Ub,
"AgaveOnSelectedReadoutHandlerFactory",Ug.a,[]);var li=b(862),Li=b(231);Oa.prototype.h7e=function(G){try{if(G&&G.rawEvent&&G.rawEvent.origin&&this.iframe&&this.iframe.id){var ka=this.VGf(G.rawEvent.origin),Ua=this.VGf(document.domain);if(ui.a.Gk().equals(Ua,ka))if(G.rawEvent.source&&G.rawEvent.source.frameElement&&G.rawEvent.source.frameElement.id&&ui.a.Gk().equals(G.rawEvent.source.frameElement.id,this.iframe.id)){ka=null;try{ka=JSON.parse(G.rawEvent.data)}catch(e){Te.ULS.sendTraceTag(39112971,344,
50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",e.message)}ka?(ka.statusCode!==Li.a.fP||void 0!==ka.error&&ka.error?(Te.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ka.statusCode,ka.error),this.onError()):(Te.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ka.authorizationCode?ka.authorizationCode:
ka.signInUrl)),$removeHandler(window,"message",Object(Pi.a)(this,this.h7e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):Te.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):Te.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Te.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Te.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else Te.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Te.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(e){Te.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",e.message)}};Oa.prototype.VGf=function(G){var ka="";try{G&&(ka=-1<G.indexOf("//")?G.split("/")[2]:G.split("/")[0])&&(ka=ka.split(":")[0],ka=ka.split("?")[0])}catch(Ua){Te.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Ua.message)}return ka};Oa.ka=function(G,ka,Ua){new Oa(G,ka,Ua)};Object(de.a)(Oa,"ResponseHandler",null,[]);var wi=b(277);lc.prototype.tryAuthenticate=function(G,ka){this.y$a(lc.qqg,function(){G()},ka)};lc.prototype.tryAuthorize=function(G,ka){this.y$a(lc.ylg,G,ka)};lc.prototype.getSignInUrl=function(G,ka){this.y$a(lc.ohe,G,ka)};lc.prototype.signOut=function(G,ka){this.y$a(lc.Awg,G,ka)};lc.prototype.y$a=function(G,ka,Ua){var e=new wi.QueryStringBuilder("AuthenticationProxyHandler.aspx");
e.Gi("responseType",G);Bf.AFrameworkApplication.Pmb(e);e=String.format("{0}{1}&{2}",this.eFa,e.toString(),Bf.AFrameworkApplication.lj);var C=document.createElement("iframe");C.setAttribute("id","privateCatalogIframe");C.setAttribute("name","privateCatalogIframe");C.setAttribute("style","display: none");ui.a.Gk().equals(G,lc.ohe)||C.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Oa.ka(C,ka,Ua);C.setAttribute("src",e);document.body.appendChild(C)};
lc.ylg="authcode";lc.qqg="identitytoken";lc.ohe="signinurl";lc.Awg="signout";Object(de.a)(lc,"AuthenticationProxy",null,[]);Wb.getUserId="getUserId";Wb.getLastStoreUpdate="laststoreupdate";Wb.getEntitlement="getEntitlements";Wb.getEToken="getEToken";Wb.getManifest="getManifest";Wb.getAppState="getAppState";Wb.getKilledApps="getRemovedAddins";Wb.getAppDetails="getAppDetails";Wb.removeApps="removeAddin";Wb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Wb.getPrivateCatalogAddIns="getAddIns";
Wb.getPrivateCatalogManifests="getAppManifests";Wb.isStoreDisabled="isStoreDisabled";Object(de.a)(Wb,"S2SWebRequestActions",null,[]);var Ji=b(596);$b.prototype.getUserId=function(G,ka){var Ua=new sh.a;Ua.add(new si.a("corr",G));this.bX(Wb.getUserId,Ua,1,ka)};$b.prototype.getLastStoreUpdate=function(G,ka,Ua){var e=new sh.a;e.add(new si.a("lc",G));e.add(new si.a("corr",ka));this.bX(Wb.getLastStoreUpdate,e,1,Ua)};$b.prototype.getEntitlement=function(G,ka,Ua,e){G=new sh.a;G.add(new si.a("av",ka));G.add(new si.a("corr",
Ua));this.bX(Wb.getEntitlement,G,1,e)};$b.prototype.getEToken=function(G,ka,Ua,e,C,J){var ja=new sh.a;ja.add(new si.a("cmu",G));ja.add(new si.a("cmf",ka));ja.add(new si.a("assetid",Ua));ja.add(new si.a("expver",e));ja.add(new si.a("corr",C));this.bX(Wb.getEToken,ja,1,J)};$b.prototype.getManifest=function(G,ka,Ua,e){var C=new sh.a;C.add(new si.a("cmu",G));C.add(new si.a("assetid",ka));C.add(new si.a("corr",Ua));this.bX(Wb.getManifest,C,1,e)};$b.prototype.getAppState=function(G,ka,Ua){var e=new sh.a;
e.add(new si.a("ma",G));e.add(new si.a("corr",ka));this.bX(Wb.getAppState,e,1,Ua)};$b.prototype.getKilledApps=function(G,ka){var Ua=new sh.a;Ua.add(new si.a("corr",G));this.bX(Wb.getKilledApps,Ua,1,ka)};$b.prototype.getAppDetails=function(G,ka,Ua,e){var C=new sh.a;C.add(new si.a("cmo",G));C.add(new si.a("corr",Ua));this.ccb(Wb.getAppDetails,C,ka,2,e,!1)};$b.prototype.removeApps=function(G,ka,Ua){var e=new sh.a;e.add(new si.a("corr",ka));this.ccb(Wb.removeApps,e,G,2,Ua,!1)};$b.prototype.getLastPrivateCatalogUpdate=
function(G,ka,Ua,e,C,J){var ja=new sh.a;ja.add(new si.a("catalog","privatecatalog"));ja.add(new si.a("clientCode",G));ja.add(new si.a("clientVersion",ka));ja.add(new si.a("corr",C));G=String.format("authorizationCode={0}&refreshToken={1}",Ua?Xc.a.pf(Ua):"",e?Xc.a.pf(e):"");this.ccb(Wb.getLastPrivateCatalogUpdate,ja,G,2,J,!0)};$b.prototype.getPrivateCatalogAddIns=function(G,ka,Ua,e,C,J){var ja=new sh.a;ja.add(new si.a("catalog","privatecatalog"));ja.add(new si.a("clientCode",G));ja.add(new si.a("clientVersion",
ka));ja.add(new si.a("corr",C));G=String.format("authorizationCode={0}&refreshToken={1}",Ua?Xc.a.pf(Ua):"",e?Xc.a.pf(e):"");this.ccb(Wb.getPrivateCatalogAddIns,ja,G,2,J,!0)};$b.prototype.getPrivateCatalogManifests=function(G,ka,Ua,e,C){var J=new sh.a;J.add(new si.a("catalog","privatecatalog"));J.add(new si.a("corr",e));G=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Xc.a.pf(G),ka?Xc.a.pf(ka):"",Ua?Xc.a.pf(Ua):"");this.ccb(Wb.getPrivateCatalogManifests,J,G,2,C,!0)};$b.prototype.isStoreDisabled=
function(G,ka){var Ua=new sh.a;Ua.add(new si.a("corr",G));this.bX(Wb.isStoreDisabled,Ua,2,ka)};$b.prototype.bX=function(G,ka,Ua,e){this.ccb(G,ka,null,Ua,e,!1)};$b.prototype.ccb=function(G,ka,Ua,e,C,J){var ja=new wi.QueryStringBuilder("AddinServiceHandler.ashx");ja.Gi("action",G);ja.Gi("app",Ji.a[Bf.AFrameworkApplication.sa.Qa.Oj]);ka=yl(ka);for(var Aa=ka.next();!Aa.done;Aa=ka.next())Aa=Aa.value,ja.Gi(Aa.key,Aa.value);ja=String.format("{0}{1}&{2}",Bf.AFrameworkApplication.sa.Qa.fW,ja.toString(),Bf.AFrameworkApplication.lj);
Bf.AFrameworkApplication.Kd.Wl(ja,e,Ua,null,!1,2,function(gb){var bc=null;gb&&gb.data&&(gb.data.responseHeaders["X-BlockedForMinor"]&&"1"===gb.data.responseHeaders["X-BlockedForMinor"].toString()&&(gb.data.httpStatus=451),bc=gb.data.je);C(gb.data.httpStatus,bc)},function(gb){var bc=null;J&&gb&&gb.data&&gb.data.je&&(bc=gb.data.je);C(gb.data.httpStatus,bc);if(Bf.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){bc={message:"AddinServiceHandler request failed"};
bc.code=gb.data.httpStatus;bc.action=G;if(gb.data.request||gb.data.request.get_headers())bc["X-UserSessionId"]=gb.data.request.get_headers()["X-UserSessionId"];408===gb.data.httpStatus||503===gb.data.httpStatus?Te.ULS.sendTraceTag(538784582,220,10,JSON.stringify(bc)):Te.ULS.sendTraceTag(18392345,220,50,JSON.stringify(bc))}else Te.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",gb.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+G)};Object(de.a)($b,"S2SWebRequestManager",
null,[]);var Ai=Ug.a;vm(rd,Ai);rd.prototype.create=function(){var G=this;Te.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Bf.AFrameworkApplication.disableWholeAppsForOfficeFeature?Te.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",Bf.AFrameworkApplication.disableWholeAppsForOfficeFeature):dg.EwaSettings.la(417)?oi.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ka){ka.isFeatureEnabled("mso_officeStore",
!0).then(function(Ua){li.DdaFacade.F2c=Ua;G.iEe();return null})}):this.iEe()};rd.prototype.iEe=function(){var G=this,ka=aj.GetServiceTaskFactory.Wa(this.$.da,224,225,this.ub),Ua=Df.a.Ctd(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.ma,this.ub,106),e=qb(this.ma,this.ub);Fh.TaskExtensions.Ba(Fh.TaskExtensions.we([ka,Ua,e],this.$.ma),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?Te.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
Ii.a.r3()):G.bai();Te.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");G.jNf=ka.result;G.Gb(G.Xe);Te.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ma,3)};rd.prototype.bai=function(){dg.EwaSettings.la(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new $b);this.$.jg.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new $b,new lc(Bf.AFrameworkApplication.ga.appSettings.WebServiceBase),dg.EwaSettings.la(72),
dg.EwaSettings.la(448))};rd.prototype.dispose=function(){Wh.a.Fa(this.ddaFacade);this.$=this.ddaFacade=null;Ai.prototype.dispose.call(this)};rd.ka=function(G){new rd(G)};Qk.Object.defineProperties(rd.prototype,{Xe:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new li.DdaFacade(this.$,this.jNf))}}});Object(de.a)(rd,"DdaFacadeServiceFactory",Ug.a,[]);sc.prototype.gd=function(){return!1};sc.prototype.Zc=function(){return!1};sc.prototype.Kc=function(G,ka,Ua,e){var C=
!1;switch(ka.command){case -684355545:C=!0;break;case -741808261:C=!!Ua;break;case -859308420:C=!!e&&1===e.wA;break;case 418618014:C=1===G&&!!e&&1===e.wA;break;case -515602470:ka=dg.EwaSettings.la(236)&&2===G;C=(1===G||ka)&&!!e&&1===e.wA;break;case 2086613372:C=dg.EwaSettings.la(236)&&2===G&&!!e&&1===e.wA;break;case -1336341324:C=dg.EwaSettings.la(500)&&1===G&&!!e&&1===e.wA;break;case -1444574190:case -336193495:C=1===G&&!!e&&1===e.wA;break;case 1296389134:C=1===G&&!!e&&1===e.wA;break;case 1221897806:C=
dg.EwaSettings.la(167)&&2===G;break;case 1172793074:case 1930653487:C=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===G;break;case -1753056834:C=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:C=!0;break;case 301511274:C=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:C=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!1)&&this.$.isEditMode;break;case 1723441034:C=this.$.isEditMode&&this.$.ea.dKb}return C};sc.prototype.executeCommand=function(G,ka,Ua){var e=Fh.TaskExtensions.nm(),C=ka.command;switch(ka.command){case 1296389134:this.agaveCommandManager.hGj(Ua.SourceControlId,Ua.LabelText);break;case -684355545:this.agaveCommandManager.PZc();break;case -741808261:e=this.agaveCommandManager.insertAgave(Ua,ka);break;case -1336341324:dg.EwaSettings.la(500)&&(e=this.agaveCommandManager.Iid(Ua,G,ka));break;case 1172793074:dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(e=this.agaveCommandManager.Iid(Ua,G,ka));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:e=this.agaveCommandManager.Iid(Ua,G,ka);break;default:e=Hi.a(C)}return e};Object(de.a)(sc,"AgaveCommandHandler",null,[239]);Object(de.a)(nb,"Selection",null,[]);Object(de.a)($a,"SmartLookupApplicationInterface",null,[]);Object(de.a)(fc,"ApplicationProperties",
null,[]);Object(de.a)(ub,"EnterpriseUserInfo",null,[]);Object(de.a)(Za,"FeatureGates",null,[]);Gb.prototype.oZh=function(){var G=void 0===G?!0:G;var ka=this.sGe();if(ka<this.Wud+this.cMj)return ka>this.Wud+this.fMj&&this.kdd(),this.gof;G&&this.kdd();return""};Gb.prototype.kdd=function(){var G=this;this.Zud=this.Zud||new Promise(function(ka){G.pZh().then(function(Ua){G.gof=Ua;G.Wud=G.sGe();G.Zud=null;ka(Ua)})})};Gb.prototype.pZh=function(){var G=this;return this.l8a&&this.l8a.length?new Promise(function(ka){G.Kxa.yS("SmartLookup",
G.l8a).then(function(Ua){Ua.IsSuccess?Ua.Token||(ka(""),Te.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Te.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Ua.ErrorCode+": "+Ua.ErrorMessage),ka(""));ka(Ua.Token)}).catch(function(Ua){Ua=Vh.c(Ua);Te.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ua);ka("")})}):(Te.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),
Promise.resolve(""))};Object(de.a)(Gb,"SmartLookupAuthenticationManager",null,[847]);vb.CPh=function(){switch(Object(Ci.a)(String,Bf.AFrameworkApplication.Zb.AudienceGroup)||""){case "Dogfood":if(Bf.AFrameworkApplication.ga){var G=Bf.AFrameworkApplication.ga.Ua("UserPrincipalName");G=Xc.a.Nl(G);var ka=Bf.AFrameworkApplication.ga.Sy("SmartLookupINTEnabledForSKITeam")?Bf.AFrameworkApplication.ga.fw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(ka,G)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};
vb.OYh=function(){switch(Bf.AFrameworkApplication.ga.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Bf.AFrameworkApplication.ga.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":Bf.AFrameworkApplication.ga.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":vb.CPh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};
Object(de.a)(vb,"Utils",null,[]);var ji=b(579);kb.prototype.oKh=function(){return Promise.resolve(this.pKh())};kb.prototype.pKh=function(){var G=new fc;G.anid="";G.applicationVersion=Bf.AFrameworkApplication.buildVersion;G.appCorrelationId=Kj.a.create().toString();G.themePlatform=kb.VXj;G.lcid=Bf.AFrameworkApplication.lcid;G.launchUtcTime=(new Date).toUTCString();G.featureGates=this.k8a;var ka=ji.a.$J(Bf.AFrameworkApplication.lcid);ka=ka?ka.name:null;G.market=this.sac(ka);G.uiLanguage=ka;G.sessionId=
Bf.AFrameworkApplication.userSessionId;G.themeId=0;G.parentalControl=kb.VXi;var Ua=new ub;Ua.CountryCode=this.sac(ka);Ua.ServiceEndpoint=this.l8a;Ua.IsGoLocal=!1;Ua.IsEnabled=this.Nof;Ua.IsEnterpriseEnabled=this.Nof;Ua.TenantRoot=this.hyi;G.enterpriseUserInfo=Ua;G.accessToken=this.cyi.oZh();return G};kb.prototype.sac=function(G){G=G.split("-");return G[G.length-1]};Qk.Object.defineProperties(kb.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.Dxi}}});kb.VXj=
"web";kb.VXi="yes";Object(de.a)(kb,"SmartLookupManager",null,[832]);var Sh=gk.a;vm(wb,Sh);wb.prototype.gd=function(){return!1};wb.prototype.Zc=function(){return!1};wb.prototype.Kc=function(G,ka){G=dg.EwaSettings.la(135);return-983891024===ka.command&&G};wb.prototype.executeCommand=function(G,ka){G=Fh.TaskExtensions.nm();-983891024===ka.command&&this.Ori();return G};wb.prototype.Ori=function(){var G=this,ka=new kb(null),Ua={},e=Qi.g(this.$).wc(null).originalText;e=Object.assign(new nb,{neighborhood:e,
mentionStart:0,mentionLength:e?e.length:0});var C=Object.assign(new $a,{selection:e,entryPoint:0});ka.oKh().then(function(ja){ja.applicationName=wb.appName;ja.isFirstLaunch=G.isFirstLaunch;ja.themeId=5;Ua[wb.smartLookupApplicationInterface]=JSON.stringify(C);Ua[wb.VJg]=JSON.stringify(ja);G.isFirstLaunch=!1});ka=new pj.a("ExcelOnline","Web","en-Us");e=new mj.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var J=new Eg.a;J.ri[ye.cl]=gf.a.instance.fa(1760);J.ri[ye.taskPaneWidth]=
350;J.ri[ye.sourceLocationOverrideResourceId]="WAC.PROD.URL";J.hr=Ua;rj.a.instance.iNa(e,"Taskpane","SmartLookupSDXTaskpane",ka,J)};wb.VJg="AppProperties";wb.appName="Excel";wb.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(de.a)(wb,"SmartLookupCommandHandler",gk.a,[239]);var Th=Aj.a;vm(Ec,Th);Ec.prototype.Pd=function(){var G=this;ek.a(this.$,374,375,this.ub,function(ka){G.Gd([new sc(G.$,null,null,null,null,ka),new wb(G.$)])})};Ec.ka=function(G){Aj.a.he(76,new Ec(G))};Object(de.a)(Ec,
"AgaveCommandHandlerFactory",Aj.a,[]);Object(de.a)(function(){},"AppInfoDetail",null,[]);b(1075);Object(de.a)(function(){},"AppsForOfficeUtils",null,[]);Object(de.a)(Ob,"AppsDataManager",null,[39]);var Mg=b(1296),bk=b(104);db.prototype.initialize=function(G){db.initialized||(this.Xe=G,this.Pg(),db.initialized=!0)};db.prototype.Pg=function(){Bf.AFrameworkApplication.Hb.ff(se.a.dab,bk.a.frame,this.dab,96);Bf.AFrameworkApplication.Hb.hc(se.a.R8i,bk.a.frame,this.a$i)};Qk.Object.defineProperties(db,{instance:{configurable:!0,
enumerable:!0,get:function(){db.Oa||(db.Oa=new db);return db.Oa}}});db.Oa=null;db.initialized=!1;Object(de.a)(db,"AgaveCommandActor",null,[]);var Lj=b(109),Nk=b(354),Uk=b(351),oj=b(1257),sj=b(340);Object(de.a)(Ga,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(de.a)(ya,"IdeasSelectionContext",null,[]);vm(xa,ya);Object(de.a)(xa,"IdeasTableSelectionContext",ya,[]);var tj=b(61),hi=b(43),uj=b(369),Rj=b(154),lk=b(587),Oj=b(127),Ak=b(140),Ik=b(172),Ok=Ak.a;vm(fb,Ok);fb.prototype.eD=function(){Ok.prototype.eD.call(this);
this.xp.style.width=this.i2d;this.xp.style.height=this.aVa;this.xp.style.marginTop=this.DQb;this.xp.style.padding=this.bVa};fb.prototype.NPa=function(){this.xp.style.width=this.i2d;this.xp.style.height=this.aVa;this.xp.style.marginTop=this.DQb;this.xp.style.padding=this.bVa;this.SCa>Ik.a.k$a?(this.Mb.style.width=String.format("{0}px",Ik.a.k$a),this.Mb.style.overflowX="scroll",Bf.AFrameworkApplication.isRtl?this.Mb.style.right="0":this.Mb.style.left="0"):(this.Mb.style.width=String.format("{0}px",
this.SCa),this.Mb.style.overflowX="hidden");this.Mb.offsetHeight>Ik.a.j$a||this.Xng+50>Ik.a.j$a?(this.Mb.style.height=String.format("{0}px",Ik.a.j$a),this.Mb.style.overflowY="scroll",this.Mb.style.top="0",Bf.AFrameworkApplication.isRtl?this.Mb.style.right="0":this.Mb.style.left="0",this.DHc||(this.Mb.style.marginTop="-48px"),this.xp.style.minHeight=String.format("{0}px",this.Nlg)):(this.Mb.style.overflowY="hidden",this.Mb.style.top="10%",this.Mb.style.height=this.Hhb);this.x_a()};fb.prototype.x_a=
function(){if(this.Mb){var G=this.Mb.style.zIndex;this.Mb.style.zIndex="-9999";if(this.SCa>Ik.a.k$a)Bf.AFrameworkApplication.isRtl?this.Mb.style.marginRight="0":this.Mb.style.marginLeft="0";else{var ka=String.format("{0}px",Math.floor(-this.Mb.offsetWidth/2));Bf.AFrameworkApplication.isRtl?this.Mb.style.marginRight=ka:this.Mb.style.marginLeft=ka;Bf.AFrameworkApplication.isRtl?this.Mb.style.right="50%":this.Mb.style.left="50%"}this.Mb.style.zIndex=String(G)}else Te.ULS.sendTraceTag(19976784,306,10,
"_divMessageBox is null in CenterDialog()")};fb.prototype.DO=function(){Ok.prototype.DO.call(this);var G=document.getElementById(this.pi(this.Wng));G.style.width=String.format("{0}px",this.SCa);G.style.height=this.Hhb};Qk.Object.defineProperties(fb.prototype,{j1a:{configurable:!0,enumerable:!0,get:function(){return this.xp}}});Object(de.a)(fb,"AppsForOfficeInsertionDialog",Ak.a,[199]);var Sj=b(1095),dl=gk.a;vm(Db,dl);Db.prototype.vFg=function(G){this.addHandler(Db.eCd,G)};Db.prototype.Ncj=function(G){this.removeHandler(Db.eCd,
G)};Db.prototype.dispose=function(){Wh.a.Fa(this.mwa);this.mwa=null;dl.prototype.dispose.call(this)};Db.prototype.PZc=function(){this.mwa.hide()};Db.prototype.hGj=function(G,ka){if(G){this.raiseEvent(Db.eCd);var Ua=G.split("|");this.Ovi(G,ka,Ua);this.mwa=new fb;this.mwa.initializeAndShow("",null,null);this.Xe.gsi(this.mwa.j1a,Ua)}};Db.prototype.Iid=function(G,ka,Ua){var e=Fh.TaskExtensions.nm();if(-515602470===Ua.command||-336193495===Ua.command||2086613372===Ua.command||-1444574190===Ua.command||
-1336341324===Ua.command)e=this.i4h(G,ka,Ua);418618014===Ua.command&&(ka=new Dj.a,ka.cl=gf.a.instance.fa(1771),e=this.G0(Ua,Db.p7h,ka,!0));if((Ua.tabName===this.$.Jb+Fi.a.FUf||Ua.tabName===Fi.a.d0)&&2===Ua.df||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),G[yj.a.nd])||G[yj.a.nd]===Fi.a.JZ)return this.O6e(G,Ua);if(7===Ua.df&&G.SourceControlId===this.$.Jb+Fi.a.qcc)return G.MenuItemId=Fi.a.LGd,this.O6e(G,Ua);1221897806===Ua.command&&(e=this.I3f(Ua,"Format"));if(1930653487===
Ua.command||1172793074===Ua.command)e=this.I3f(Ua,"Data");-1753056834===Ua.command&&(e=this.QBj(Ua));932597253===Ua.command&&(Te.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Ea.c(932597253,!0),ka=new Dj.a,ka.cl=gf.a.instance.fa(2099),ka.sourceLocationOverrideResourceId=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?Db.s0i:Db.u0i,ka.focusOnIframeWhenLoaded=!0,ka.taskPaneWidth=Db.w$e,e={},e.LaunchSource=Object(Ci.a)(String,G.SourceControlId),
e.LaunchMode="Default",ka.eI=e,e=this.G0(Ua,Db.t0i,ka,!0));301511274===Ua.command&&(e=this.aCj(Ua));515196233===Ua.command&&((ka=this.$.da.Aa(465))&&ka.c9e(),ka=new Dj.a,ka.cl=gf.a.instance.fa(2168),e={},e.SourceUILocation=Nk.a[Ua.df],ka.eI=e,e=new oc,e.Yaa=af.a.e2a,e=this.G0(Ua,Db.HWi,ka,!0,e,void 0,ka.cl));1723441034===Ua.command&&(ka=new Dj.a,ka.cl=gf.a.instance.fa(2180),ka.focusOnIframeWhenLoaded=!0,ka.taskPaneWidth=Db.p3i,e=new oc,e.Yaa=af.a.Dqh,e=this.G0(Ua,Db.o3i,ka,!0,e));dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&G.LoadDataFromPictureTaskpane&&(ka={},e=new Dj.a,e.cl=gf.a.instance.fa(2206),ka.SessionID=G.SessionID,e.eI=ka,e.focusOnIframeWhenLoaded=!0,e=this.G0(Ua,G.DataFromPictureAssetId,e,!0));return e};Db.prototype.insertAgave=function(G,ka){var Ua=this,e=Fh.TaskExtensions.nm(),C=this.$,J=G[ug.a.KYa];if("SourceControlId"in G){var ja={};var Aa=G.SourceControlId.split("|");if(8!==Aa.length||!(Aa[0]&&Aa[1]&&Aa[2]&&!isNaN(parseInt(Aa[2],10))&&Aa[3]&&!isNaN(parseInt(Aa[3],10))&&Aa[4]&&Aa[5]&&!isNaN(parseInt(Aa[5],
10))&&Aa[6]&&Aa[7]))return Fh.TaskExtensions.D4();J={};J.version=ja.Version=Aa[0];J.assetId=ja.AssetId=Aa[1];J.solutionId=ja.SolutionId=Aa[1];J.height=ja.Height=parseInt(Aa[2],10);J.width=ja.Width=parseInt(Aa[3],10);J.storeId=ja.StoreId=Aa[4];J.targetType=ja.TargetType=parseInt(Aa[5],10);J.assetStoreId=ja.AssetStoreId=Aa[6];J.storeType=ja.StoreType=Aa[7];J.appVersion=Aa[0];J.currentStoreType=Aa[7];J.id=Aa[1]}else ja=G[yj.a.Tg];Aa=null;oc.key in G&&(Aa=G[oc.key]);this.mwa&&this.mwa.hide();if(!ja||
!J)return Te.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),e;this.$.s5&&Fi.a.ZAa in G&&(ja.EnabledInViewMode=G[Fi.a.ZAa]);G=this.QMh(ka.command);if(!ja.EnabledInViewMode&&!C.Ms(null,!1,G))return e;var gb=void 0===ja.IsToBePersisted||null===ja.IsToBePersisted||ja.IsToBePersisted?0:16;if(1===ja.TargetType)e=this.udi(ja,J,ka,Aa,gb);else{J=Qi.g(C);e=this.viewBlockContainerHelpers.qfb(J);var bc=C.ea.isNamedObjectViewMode?C.pa.sheetName:C.pa.name;if(e){J=e.qf;var Mc=
J.Zf.top;var Hc=J.Zf.left;var yd=e.SI.x;var we=e.SI.y}else Mc=Hc=1,e=this.viewBlockContainerHelpers.AKa(J),yd=e.x,we=e.y;var $e=this.$.na.ta.$b();e=function(Gf,ag,Nf){var Pg=C.na.ta,Jh=ja,jj=Mc,Xi=Hc,vj=yd,qj=we;Gf=Rh.b(Gf,Ua.j0i);var Xj=Pg.Na(9,$e);Xj.sharedInfo=Jh;Xj.sheetName=bc;Xj.positionRow=jj;Xj.positionCol=Xi;Xj.positionOffsetX=vj;Xj.positionOffsetY=qj;return hj.i(Pg,"InsertWebExtension",Xj,Gf,ag,Nf,null,0)};dg.EwaSettings.tc()?(gb|=64,e=uj.a(this.$.userOperationManager,e,function(Gf){return new ok.a(534,
0,Gf,gb)},ka)):e=uj.a(this.$.userOperationManager,e,function(Gf){return new nk.a(534,0,Gf,gb)},ka)}return e};Db.prototype.O1g=function(){var G=oi.a.instance.pc("Common.App.ICustomerFeedbackUiWrapper"),ka=oi.a.instance.pc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.had?this.had.jjb?this.ixe():ka.instance.i7c(this.IAh):Te.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");ka={};Bf.AFrameworkApplication.ga.ame(ka);G=G.instance.getContext(ka);ka={};
"telemetryGroup"in G&&(ka=G.telemetryGroup);ka.processSessionId=G.sessionId;ka.officeBuild=G.build;G.telemetryGroup=ka;G.feedbackType=-1;G.userVoiceEnabled=!1;"disableIncludeScreenshot"in G||(G.disableIncludeScreenshot=!1);"screenshot"in G||(G.screenshot=!1);G.disableScreenshotPreview=!1;G.includeScreenshotSelectedDefault=!0;return G};Db.prototype.H0i=function(G){if(!this.L$a&&dg.EwaSettings.la(735)&&dg.EwaSettings.getBooleanFeatureGate(Db.h9h,!1)){var ka=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";ka=this.Sue(ka);var Ua=new oc;Ua.Mj=af.a.c$c;this.L$a=this.wMd(ka,null,!1,null,Ua);ka={};Oj.b(this.$).fe(Ee.a.I0i,(ka.Location=Nk.a[G.df],ka.InputMethod=Uk.a[G.method],ka),void 0,!0)}};Db.prototype.NZf=function(G){var ka=this.$.ea.oh.get(17);oi.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ua){Ua.isFeatureEnabled("mso_sendASmile",ka).then(function(e){G.FeedbackEnabled=ka&&e;return null})})};Db.prototype.I3f=
function(G,ka){var Ua=Qi.g(this.$),e=new Dj.a,C={};C.ActiveTab=ka;C.DatapaneFlighting=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);C.RangePickerFlighting=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);C.AceFlighting=!0;C.ChartNewSDXRecording=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);C.ThemeColorsFlighting=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)&&dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");C.UOMirror=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);this.NZf(C);C.startTimeMs=Date.now();C.UserSessionId=this.$.ya.UserSessionId;(ka=Ua.ha.Pa.Eo)&&(C.SubSelection=ka);Te.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",C.UserSessionId,void 0===G.df||null===G.df?"Null":Nk.a[G.df],ka||"ChartRoot");e.eI=C;e.cl=
gf.a.instance.fa(953);C=new oc;C.Yaa=af.a.e2a;return this.G0(G,Db.KWg,e,!0,C)};Db.prototype.QBj=function(G){var ka=new Dj.a;ka.eI={};ka.cl=gf.a.instance.fa(1759);ka.vS=Db.vlf;var Ua=new oc;Ua.Yaa=af.a.e2a;return this.G0(G,Db.vlf,ka,!0,Ua,void 0,ka.cl)};Db.prototype.aCj=function(G){var ka=new Dj.a;ka.eI={};ka.cl=gf.a.instance.fa(2123);var Ua=new oc;Ua.Yaa=af.a.Qsh;Ua.xMb=af.a.Vsh;return this.G0(G,Db.xDi,ka,!0,Ua)};Db.prototype.O6e=function(G,ka){var Ua=Db.X8e,e=G[yj.a.nd].toString(),C={},J=new Dj.a;
J.cl=gf.a.instance.fa(9);switch(e){case "A0":C.query=(G[yj.a.Tg]||"").split("|").slice(2,sj.a.PS).join("|");break;case "A1":C.query=G.CommandValueId;break;case "Help":C.gwdropdownflightinfo=dg.EwaSettings.la(241);C.query="";break;case Fi.a.LGd:dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(J.cl=gf.a.instance.fa(1725),J.sourceLocationOverrideResourceId=Db.t5e,C.feedback=this.O1g()):C.query=e;break;case "HelpArticle":C.query=G[yj.a.Tg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":C.query=
e;break;default:return ak.Task.Ta(!0)}J.eI=C;e=new oc;e.Yaa=af.a.e2a;return this.G0(ka,Ua,J,!1,e,G[Fi.a.ZAa]||!1)};Db.prototype.Sue=function(G){var ka={Version:"0.0.0.0"};ka.AssetId=Db.fwa;ka.SolutionId=Db.fwa;ka.AssetStoreId="";ka.StoreType=OSF.StoreType.Sdx;ka.Height=0;ka.Width=0;ka.StoreId=OSF.StoreType.Sdx;ka.TargetType=OSF.OsfControlTarget.TaskPane;ka.IsToBePersisted=!1;ka.SourceLocationOverrideResourceId=G;ka.SharedRuntimeId=G;ka.Id=Db.fwa;ka.CurrentStoreType=OSF.StoreType.Sdx;ka.AppVersion=
"0.0.0.0";return ka};Db.prototype.i4h=function(G,ka,Ua){var e=this,C=new Dj.a,J=new oc,ja={};this.NZf(ja);ja.LaunchSource="";ja.StartTimeMs=Date.now();ja.CorrelationId=Kj.a.create().toString();C.eI=ja;C.focusOnIframeWhenLoaded=!0;C.taskPaneWidth=Db.w$e;J.Yaa=af.a.Nsh;J.xMb=af.a.JOe;switch(Ua.command){case -1444574190:var Aa,gb;ja.LaunchMode="RecommendedPivotTables";ja.SelectionContext="";ja.LaunchSource="PivotTableHandRaise"===Object(Ci.a)(String,G.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";
if(this.$&&dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&G.SourceSelection){var bc=G.SourceSelection.split(",")[0];ka=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var yd=hi.Z(bc,e.$.xa);Aa=yd.sheetName;gb=yd.YFb;Mc=yd.range;return yd}().returnValue&&!Qi.g(this.$).Sb.Nka(Mc))G=this.$.xa.getItemByName(Aa),ja.SelectionContext=JSON.stringify(Object.assign(new ya,{address:gb,addressWithSheet:Aa+"!"+Mc.DC(!1),sheetId:tj.d(G),
sheetName:Aa,isSheetEmpty:!1,columnCount:Mc.width,rowCount:Mc.height,columnIndex:Mc.left+ka,rowIndex:Mc.top+ka,selectionType:"Continuous"}));else if((G=this.$.zb.getItemByName(Object(Ci.a)(String,G.SourceSelection)))&&tj.o(G)){var Mc=Rj.a(G,!0);var Hc=this.$.xa.getItemByName(G.sheetName);ja.SelectionContext=JSON.stringify(Object.assign(new xa,{tableName:G.name,hasTableHeaders:Rj.d(G),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Mc.DC(!1),addressWithSheet:Hc.name+"!"+Mc.DC(!1),sheetId:tj.d(Hc),
sheetName:Hc.name,isSheetEmpty:!1,columnCount:Mc.width,rowCount:Mc.height,columnIndex:Mc.left+ka,rowIndex:Mc.top+ka,selectionType:"Continuous"}))}}dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?C.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":C.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";C.cl=gf.a.instance.fa(1769);dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(C.vS=Db.MZi);C.Mj=af.a.bRe;J.Mj=af.a.bRe;
break;case -336193495:ja.LaunchMode="RecommendedCharts";dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?C.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":C.sourceLocationOverrideResourceId="RecommendCharts.Bundle";C.cl=gf.a.instance.fa(1768);dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(C.vS=Db.G7i);C.Mj=af.a.cRe;J.Mj=af.a.cRe;break;case -1336341324:if(!dg.EwaSettings.la(500))return ak.Task.Ta(!1);ja.LaunchMode="NL";dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&
(C.vS=Db.gWc);dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?C.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":C.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(dg.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:C.cl=gf.a.instance.fa(1773);ja.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:C.cl=gf.a.instance.fa(1774);ja.NLLaunchModeBrandingCandidatesIndex=2;break;default:C.cl=
gf.a.instance.fa(1772),ja.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!dg.EwaSettings.la(236))return ak.Task.Ta(!1);ja.LaunchMode="ChartDesigner";ja.LaunchSelectionMode=ka.toString();dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?C.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":C.sourceLocationOverrideResourceId="Insights.Https.Bundle";C.cl=gf.a.instance.fa(1775);dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&
(C.vS=Db.gWc);break;default:ja.LaunchMode="Default",dg.EwaSettings.la(236)&&(ja.LaunchSelectionMode=ka.toString()),dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?C.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":C.sourceLocationOverrideResourceId="Insights.Https.Bundle",C.cl=gf.a.instance.fa(1770),dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(C.vS=Db.gWc),C.Mj=af.a.c$c,J.Mj=af.a.c$c}return dg.EwaSettings.la(735)?(dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?C.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":C.sourceLocationOverrideResourceId="Insights.Https.Bundle",this.L$a?this.L$a.CWR(function(){return e.PXf(ja,C)}):this.Cbi(Ua,C,J,ja)):this.G0(Ua,Db.fwa,C,!0,J)};Db.prototype.Cbi=function(G,ka,Ua,e){var C=this;this.L$a=this.wMd(this.Sue(ka.sourceLocationOverrideResourceId),ka,!1,G,Ua,!1);return this.L$a.CWR(function(){return C.PXf(e,ka)})};Db.prototype.PXf=function(G,ka){var Ua=this.Xe.uaa(this.Xe.KJa(Db.fwa,ka.sourceLocationOverrideResourceId));
if(Ua){this.Fcb[Db.fwa]=G;var e=this.jwd(this.Xe.pZ(Ua).OsfPropertyBag,Db.fwa);this.Xe.pZ(Ua).OsfPropertyBag=e}this.iNa(Db.fwa,"LaunchIdeasAction",G,ka);return ak.Task.Ta(!0)};Db.prototype.G0=function(G,ka,Ua,e,C,J,ja){Ua=void 0===Ua?null:Ua;e=void 0===e?!1:e;C=void 0===C?null:C;J=void 0===J?!1:J;ja=void 0===ja?null:ja;Fh.TaskExtensions.nm();Ua||(Ua=new Dj.a);var Aa={Version:"0.0.0.0"};Aa.AssetId=ka;Aa.SolutionId=ka;Aa.AssetStoreId="";Aa.StoreType=e?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Aa.Height=
0;Aa.Width=0;Aa.StoreId=e?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Aa.TargetType=OSF.OsfControlTarget.TaskPane;Aa.IsToBePersisted=!1;Aa.SourceLocationOverrideResourceId=Ua.sourceLocationOverrideResourceId;Aa.AppVersion="0.0.0.0";Aa.Id=ka;Aa.CurrentStoreType=e?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;if(Ua.cl||ja)this.ebd[ka]=Object.assign(new Ga,{szc:Ua.cl,UUd:ja,qzc:Ua.vS});dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)?(Ua.eI||(Ua.eI={}),Ua.eI.ShowFeedback=this.$.isFeedbackEnabled,this.Fcb[ka]=Ua.eI):Ua.eI&&(this.Fcb[ka]=Ua.eI);ka={};ka[yj.a.Tg]=Aa;ja={};ja.id=Aa.Id;ja.solutionId=Aa.SolutionId;ja.version=Aa.Version;ja.storeType=Aa.StoreType;ja.storeId=Aa.StoreId;ja.assetId=Aa.AssetId;ja.assetStoreId=Aa.AssetStoreId;ja.height=Aa.Height;ja.targetType=Aa.TargetType;ja.width=Aa.Width;ja.isAddinCommands=!e;ja.appVersion=Aa.AppVersion;ja.currentStoreType=Aa.CurrentStoreType;ka[ug.a.KYa]=ja;C||(C=new oc);C.focusOnIframeWhenLoaded=
Ua.focusOnIframeWhenLoaded;C.width=Ua.taskPaneWidth;ka[oc.key]=C;ka[Fi.a.ZAa]=J;return this.insertAgave(ka,G)};Db.prototype.udi=function(G,ka,Ua,e,C){function J(Mc){Te.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(Mc.storeType,Mc.storeId,Mc.solutionId),Mc.storeType);var Hc={},yd=new sh.a;yd.add(Mc);Hc[ug.a.IFa]=yd;Hc[ug.a.xJ]=3;Mc=new Wf.a(se.a.GAb,0,Aa.$.hd,0,null);return Aa.$.Ka.Yb(Mc,Hc)}function ja(Mc,Hc){var yd=Mc.SolutionId;var we=
Mc.StoreType;dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(we)&&Mc.SourceLocationOverrideResourceId&&(yd=Aa.Xe.KJa(yd,Mc.SourceLocationOverrideResourceId)):we!==OSF.StoreType.FirstParty&&we!==OSF.StoreType.Sdx||!Mc.SourceLocationOverrideResourceId||(yd=Aa.Xe.KJa(yd,Mc.SourceLocationOverrideResourceId));var $e=Aa.Xe.gye(yd,null,Mc.SharedRuntimeId);if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?
OSF.OsfControl.isFirstPartyStoreString(we):we===OSF.StoreType.FirstParty||we===OSF.StoreType.Sdx)dg.EwaSettings.la(300)&&$e&&(we=Aa.Xe.uaa(yd))&&(yd=null,yd=Aa.jwd(Aa.Xe.pZ(we).OsfPropertyBag,Mc.SolutionId),(we=Aa.Xe.Ii.getOsfControl(we))&&we.setSettings(yd)),Mc.SharedRuntimeId&&$e||Aa.Xe.Ii.refreshOsfControl(Mc.SolutionId,Mc.SourceLocationOverrideResourceId);if(!$e){var Gf=Aa.$.na.ta.$b(),ag=519;$e=function(Nf,Pg,Jh){var jj=Aa.$.na.ta;Nf=Rh.b(Nf,Aa.CIf);var Xi=jj.Na(9,Gf);Xi.sharedInfo=Mc;return hj.i(jj,
"InsertAgaveTaskpane",Xi,Nf,Pg,Jh,e,0)};void 0===Mc.IsToBePersisted||null===Mc.IsToBePersisted||Mc.IsToBePersisted||(ag=538,$e=function(Nf,Pg,Jh){Te.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",Mc.StoreType,Mc.StoreId,Telemetry.PrivacyRules.GetAssetId(Mc.StoreType,Mc.StoreId,Mc.SolutionId));var jj=Aa.$.na.ta;Nf=Rh.b(Nf,Aa.CIf);var Xi=jj.Na(9,void 0===Gf?null:Gf);Xi.sharedInfo=Mc;return hj.i(jj,"ShowAgaveTaskpane",Xi,Nf,
Pg,Jh,e,0)});return dg.EwaSettings.tc()?(C|=64,uj.a(Aa.$.userOperationManager,$e,function(Nf){return new ok.a(ag,0,Nf,C)},Hc)):uj.a(Aa.$.userOperationManager,$e,function(Nf){return new nk.a(ag,0,Nf,C)},Hc)}return Fh.TaskExtensions.D4()}var Aa=this;if(!dg.EwaSettings.la(54)||G.StoreId===OSF.StoreType.FirstParty)return ja(G,Ua,e);if(ka.isAddinCommands)return J(ka);var gb=new Nj.a,bc={};bc.marketplaceId=G.SolutionId;bc.marketplaceVersion=G.Version;bc.storeType=G.StoreType;bc.storeId=G.StoreId;bc.targetData=
G;dg.EwaSettings.la(94)&&(bc.clearCache=!0);this.Xe.Ii.isAddinCommandsAsync(bc,function(Mc,Hc,yd){gb.setResult(Hc);Mc||(Mc=yd.targetData,Te.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(Mc.StoreType,Mc.StoreId,Mc.SolutionId),Mc.StoreType))});return Fh.TaskExtensions.ts(gb.task,function(Mc){return Mc.result?J(ka):ja(G,Ua,e)},this.$.ma)};Db.prototype.jwd=function(G,ka){if(!this.Fcb[ka])return G;var Ua={};if(G){G=
yl(G);for(var e=G.next();!e.done;e=G.next())e=e.value,Ua[e[0]]=e[1]}G=this.Fcb[ka];e=yl(Object.keys(G));for(ka=e.next();!ka.done;ka=e.next())ka=ka.value,ka===Db.KAh&&dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Ua[ka]=Sys.Serialization.JavaScriptSerializer.serialize(G[ka]):Ua[ka]=Sys.Serialization.JavaScriptSerializer.serialize(G[ka].toString());ka=Object.keys(Ua).length;G=Array(ka);e=0;var C=yl(Object.keys(Ua));for(ka=C.next();!ka.done;ka=C.next())ka=
ka.value,G[e]=[ka,Ua[ka].toString()],e++;return G};Db.prototype.Ovi=function(G,ka,Ua){var e=this.$.ya.UserSessionId,C=this.$.ya.UICultureTag,J=this.$.ya.UICultureTagLcid,ja=this.$.ya.WacHostId,Aa="",gb="";5<=Ua.length&&(Aa=Ua[3],gb=Ua[4]);this.Pvi(Aa,gb,G,ka,C,J,e,ja)};Db.prototype.Pvi=function(G,ka,Ua,e,C,J,ja,Aa){var gb={};gb.a=ja;gb.b=Ua;gb.c=e;gb.d=G;gb.e=ka;gb.f=C;gb.g=J;gb.h=Aa;bl.b().Qe(36,gb)};Db.prototype.ixe=function(){if(oj.a.Utf())Te.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");
else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.EIf);return}catch(G){Te.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(G?G.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.EIf)}catch(G){Te.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(G?G.toString():null))}}};Db.prototype.wMd=function(G,ka,Ua,e,C,J){ka=void 0===ka?null:ka;Ua=void 0===Ua?!1:Ua;e=void 0===e?null:e;C=void 0===C?null:C;J=void 0===
J?!0:J;var ja=G.SolutionId,Aa=ak.Task.Ta(!1);G&&ja&&G.SharedRuntimeId&&(e=e||new Wf.a(-859308420,0,2,0,""),ja={},ja.id=G.Id,ja.solutionId=G.SolutionId,ja.version=G.Version,ja.storeType=G.StoreType,ja.storeId=G.StoreId,ja.assetId=G.AssetId,ja.assetStoreId=G.AssetStoreId,ja.height=G.Height,ja.targetType=G.TargetType,ja.width=0,ja.isAddinCommands=!1,ja.sharedRuntimeId=G.SharedRuntimeId,G.Preload=J,ja.appVersion=G.AppVersion,ja.currentStoreType=G.CurrentStoreType,C=C?C:new oc,C.width=0,ka&&(C.focusOnIframeWhenLoaded=
ka.focusOnIframeWhenLoaded,J=new Ga,ka.cl&&(J.szc=ka.cl),0<ka.taskPaneWidth&&(J.Dr=ka.taskPaneWidth),ka.vS&&dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(J.qzc=ka.vS),this.ebd[G.SolutionId]=J),ka={},ka[yj.a.Tg]=G,ka[ug.a.KYa]=ja,ka[oc.key]=C,ka[Fi.a.ZAa]=Ua,Aa=this.insertAgave(ka,e));return Aa};Db.prototype.iNa=function(G,ka,Ua,e){e=void 0===e?null:e;if(G&&ka){G=new mj.a(G,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var C=new pj.a("ExcelOnline","Web",this.$.ya.UICultureTag),
J=new Eg.a;J.ri[ye.gTc]=Ua;e&&(Ua=e,Ua.sourceLocationOverrideResourceId&&(J.ri[ye.sourceLocationOverrideResourceId]=Ua.sourceLocationOverrideResourceId),Ua.cl&&(J.ri[ye.cl]=Ua.cl),Ua.Mj&&(J.ri.IconCssClass=Ua.Mj),Ua.PUd&&(J.ri.TaskPaneIconUrl=Ua.PUd),Ua.vS&&(J.ri.TaskPaneIconId=Ua.vS));rj.a.instance.iNa(G,Vj.a.action,ka,C,J)}};Db.prototype.rVh=function(G){if(!Lj.a.ni(G)){var ka=G[Sj.a.I8b];if(ka&&(ka=ka.getId(),G=G[Sj.a.Oya],ka&&G))return this.KJa(ka,G.ri[ye.sourceLocationOverrideResourceId])}return null};
Db.prototype.KJa=function(G,ka){ka=void 0===ka?null:ka;return G&&ka?String.format("{0}.{1}",G,ka):G};Db.prototype.QMh=function(G){switch(G){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return dg.EwaSettings.la(236)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Db.h9h="Microsoft.Office.Excel.IdeasXLOPreload";Db.eCd="IDS";Db.X8e="FA000000012";Db.fwa="FA000000005";Db.p7h="HelloWorld";Db.KWg="FA000000014";
Db.t5e="Help.GiveFeedback.Url";Db.KAh="feedback";Db.vlf="FA000000066";Db.u0i="PowerBi.Url";Db.s0i="PowerBi.DevUrl";Db.t0i="FA000000054";Db.xDi="FA000000064";Db.HWi="FA000000075";Db.o3i="FA000000080";Db.gWc="AnalyzeDataTaskPane";Db.G7i="RecommendedChartsTaskPane";Db.MZi="PivotTableTaskPane";Db.Pch=350;Db.w$e=320;Db.p3i=320;Object(de.a)(Db,"AgaveCommandManager",gk.a,[796,797]);Qk.Object.defineProperties(pb,{instance:{configurable:!0,enumerable:!0,get:function(){return pb.Oa}}});pb.Oa=new pb;Object(de.a)(pb,
"AppsDataManagerFactory",null,[]);Object(de.a)(function(G,ka){this.httpStatus=G;this.data=ka},"AppData",null,[]);Ta.prototype.Uxb=function(G){this.dlg(this.flg,G)};Ta.prototype.bX=function(G,ka,Ua,e){0===G?this.wb&&this.Sg&&ka?this.Sg.Wl(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",this.wb.appSettings.WebServiceBase,Bf.AFrameworkApplication.lcid,ka),1,"",null,!0,2,Ua,e,null):Te.ULS.sendTraceTag(6070476,344,10,"The request objects are not available"):
(ka={},Te.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(ka.dataType=G,ka)))};Object(de.a)(Ta,"AppsDataProvider",null,[795]);var jl=Ug.a;vm(Ja,jl);Ja.prototype.create=function(){var G=this,ka=this.$.da,Ua=aj.GetServiceTaskFactory.create(ka,106,this.ma,this.ub),e=aj.GetServiceTaskFactory.create(ka,104,this.ma,this.ub),C=Df.a.loadScript(36,0,this.ub,void 0,void 0,375);Fh.TaskExtensions.Ba(Fh.TaskExtensions.we([e,Ua,C],this.ma),function(){var J=new cc(dd.a.instance),ja=
new Ta(Bf.AFrameworkApplication.ga,Bf.AFrameworkApplication.Kd,"WAC_Excel");new Ob(J,ja,"PreinstalledAppsData_Excel");J=null;dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(J=oi.a.instance.pc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);db.instance.initialize(Ua.result);J=new Db(G.$,Ua.result,e.result,J,Bf.AFrameworkApplication.Hb);ka.Ha(206,J);G.Gb(ka.Aa(374)||ka.Ha(374,J))},this.ma,3);oi.a.instance.register(Mg.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Cc().Mc(function(){return new Mg.a(G.$.Vv)})};
Ja.ka=function(G){G.da.Ha(375,new Ja(G))};Object(de.a)(Ja,"AgaveCommandManagerFactory",Ug.a,[]);var M=b(860);ma.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};ma.prototype.invokePropertyGet=function(G){switch(G){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ma.prototype.invokePropertySet=function(G,ka){switch(G){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ma.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ma.P6g=
function(G){var ka=new ma;ka.displayName=G.displayName;ka.email=G.email;switch(G.authority){case gi.GFf:ka.identityType=1;break;default:ka.identityType=0}ka.federationProvider="";return ka};Qk.Object.defineProperties(ma.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.ofa},set:function(G){this.ofa=G}},email:{configurable:!0,enumerable:!0,get:function(){return this.G5d},set:function(G){this.G5d=G}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.p6d},
set:function(G){this.p6d=G}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Lib},set:function(G){this.Lib=G}}});Object(de.a)(ma,"OfficeIdentityInfo",null,[]);hc.Hac=function(G){return G in hc.AMe?hc.AMe[G].toString():G};Qk.Object.defineProperties(hc,{AMe:{configurable:!0,enumerable:!0,get:function(){return hc.tog}}});hc.map=null;var oa={};hc.tog=(oa.GeneralException=M.a.generalException,oa.AccessDenied=M.a.cTc,oa.ApiNotAvailable=M.a.apiNotAvailable,oa.UserNotSignedIn=M.a.userNotSignedIn,
oa.UserAborted=M.a.userAborted,oa.UnsupportedUserIdentity=M.a.dRj,oa.InvalidResourceUrl=M.a.invalidResourceUrl,oa.InvalidGrant=M.a.invalidGrant,oa.AddinIsAlreadyRequestingToken=M.a.WHg,oa.ResourceNotAllowed=M.a.tij,oa.ClientError=M.a.clientError,oa.ServerError=M.a.serverError,oa);Object(de.a)(hc,"SingleSignOnErrorCodeMap",null,[]);lb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};lb.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};lb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};lb.prototype.invokePropertySet=function(G,ka){switch(G){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};lb.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};lb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};lb.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Qk.Object.defineProperties(lb.prototype,
{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.fgb},set:function(G){this.fgb=G}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Lib},set:function(G){this.Lib=G}}});Object(de.a)(lb,"SingleSignOnToken",null,[]);Ia.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};Ia.prototype.invokePropertyGet=function(G){switch(G){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;
case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Ia.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Ia.prototype.invokePropertySet=function(G,ka){switch(G){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,
0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Ia.prototype.invokePropertySetAsync=
function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Ia.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Ia.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Qk.Object.defineProperties(Ia.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.R1d},set:function(G){this.R1d=
G}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.FD},set:function(G){this.FD=G}},policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.cVb},set:function(G){this.cVb=G}},scope:{configurable:!0,enumerable:!0,get:function(){return this.cge},set:function(G){this.cge=G}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.qhe},set:function(G){this.qhe=G}}});Object(de.a)(Ia,
"TokenParameters",null,[676]);eb.prototype.getAccessToken=function(G){var ka=this,Ua=this.ihb.getOsfControl(this.eA),e=Ua.getManifest(),C=e.getMarketplaceID();this.CNa(G,C);return OfficeExtension.WacRuntime.Utility.createPromise(function(J,ja){Ua.isFirstParty()&&ka.ihb._enableFirstPartySSO?ka.Tfi(e,G)?oi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(G,C).then(function(Aa){J(Aa)},function(Aa){ja(Aa)}):ja(M.a.cTc):ja(M.a.apiNotAvailable)}).then(function(J){switch(J.authority){case gi.GFf:var ja=
1;break;default:ja=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new lb(J.accessToken,ja))},function(J){ka.logErrorResponse(G,C,J);return J?OfficeExtension.WacRuntime.Utility.createPromise(function(ja,Aa){Aa(OfficeExtension.WacRuntime.Utility.createRichApiException(J,hc.Hac(J)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(ja,Aa){Aa(OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.generalException,hc.Hac(M.a.generalException)))})})};eb.prototype.getAuthContext=
function(){return null};eb.prototype.getPrimaryIdentityInfo=function(){var G=this.ihb.getOsfControl(this.eA);G.getManifest();var ka=G.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Ua,e){oi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ka).then(function(C){Ua(C)},function(C){e(C.toString())})}).then(function(Ua){Ua=ma.P6g(Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Ua)},function(Ua){return Ua?
OfficeExtension.WacRuntime.Utility.createPromise(function(e,C){C(OfficeExtension.WacRuntime.Utility.createRichApiException(Ua,hc.Hac(Ua)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(e,C){C(OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.generalException,hc.Hac(M.a.generalException)))})})};eb.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};eb.prototype.invokePropertyGet=function(G){switch(G){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};eb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};eb.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};eb.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};eb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};eb.prototype.invokeMethodAsync=function(G,ka){switch(G){case 1:return this.mJh(ka);case 3:return this.BKh();case 2:return this.qWh()}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};eb.prototype.mJh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,Ia);return this.getAccessToken(G)};eb.prototype.BKh=function(){return this.getAuthContext()};eb.prototype.qWh=function(){return this.getPrimaryIdentityInfo()};eb.prototype.Tfi=function(G,
ka){var Ua=!1,e=G.getWebApplicationAuthorizations();G=null;e=yl(e);for(var C=e.next();!C.done;C=e.next())if(C=C.value,C.getResource().toLowerCase()===ka.resource.toLowerCase()){G=C;Ua=!0;break}if(!Ua)return!1;ka=ka.scope.split(" ,+");ka=yl(ka);for(Ua=ka.next();!Ua.done;Ua=ka.next())if((Ua=Ua.value)&&Ua.length){e=!1;C=yl(G.getScopes());for(var J=C.next();!J.done;J=C.next())Ua.toLowerCase()===J.value.toLowerCase()&&(e=!0);if(!e)return!1}return!0};eb.prototype.CNa=function(G,ka){G=this.Ntf(G.resource);
var Ua={};Te.ULS.sendTraceTag(538572831,369,50,"{0}",(Ua.manifestId=ka,Ua.resource=G,Ua))};eb.prototype.logErrorResponse=function(G,ka,Ua){G=this.Ntf(G.resource);var e={};Te.ULS.sendTraceTag(538572830,369,10,"{0}",(e.manifestId=ka,e.resource=G,e.error=Ua,e))};eb.prototype.Ntf=function(G){return G.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Qk.Object.defineProperties(eb.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(de.a)(eb,
"AuthenticationService",null,[]);Na.prototype.create=function(G,ka){return new eb(G,ka)};Object(de.a)(Na,"AuthenticationServiceFactory",null,[]);var Xa=b(985),Sb=b(1117),xc=b(1078);Ya.generalException="generalException";Ya.invalidArgument="invalidArgument";Ya.notAllowed="notAllowed";Ya.apiNotAvailable="apiNotAvailable";Ya.unresolvedPendingRequest="unresolvedPendingRequest";Ya.timeout="timeout";Ya.adalTimeout="adalTimeout";Ya.userNotSignedIn="userNotSignedIn";Ya.userAborted="userAborted";Ya.silentSignInFailed=
"silentSignInFailed";Ya.invalidResourceUrl="invalidResourceUrl";Ya.invalidGrant="invalidGrant";Ya.connectionLost="connectionLost";Ya.clientError="clientError";Ya.serverError="serverError";Object(de.a)(Ya,"WopiHostErrorCodes",null,[]);Object(de.a)(Ha,"OAuthCallerMetadata",null,[]);Pa.prototype.wzg=function(G,ka,Ua,e,C,J){var ja=this;if(!this.Kxa)return e=new Sb.a,e.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(e);var Aa=new Ha;Aa.AddinName=C;Aa.AddinTrustId=J;var gb=
-1;J=null;if(e&&this.eff())J=this.Kxa.Zag(ug.a.Gzc,G,e,Pa.o2e(C),Aa);else{var bc=Date.now();J=this.Kxa.yS(ug.a.Gzc,G,Aa).then(function(Mc){gb=Date.now()-bc;var Hc=(ka||Ua)&&"login_required"===Mc.ErrorCode;return(ka&&("interaction_required"===Mc.ErrorCode||"consent_required"===Mc.ErrorCode||"invalid_grant"===Mc.ErrorCode)||Hc)&&ja.eff()?ja.Kxa.Zag(ug.a.Gzc,G,null,Pa.o2e(C),Aa):Promise.resolve(Mc)})}return J.then(function(Mc){var Hc=new Sb.a;Mc.IsSuccess?(Hc.token=Mc.Token,Mc.Telemetry&&(Hc.aTa=Mc.Telemetry.fromCache,
Hc.expiresOn=Mc.Telemetry.expiresOn)):(Hc.errorCode=ja.ezi(Mc),Hc.YUd=ja.XXi(Mc));return Hc}).catch(function(){var Mc=new Sb.a;Mc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Mc)}).then(function(Mc){Mc.mha="OauthManager";0<=gb&&(Mc.Svb=gb);return Mc})};Pa.prototype.iii=function(G){var ka=(Bf.AFrameworkApplication.ga.Ua(Bf.AFrameworkApplication.vea)||"").toLowerCase();return(dj.a.Wka||"teams"===ka&&wj.a.bxb)&&!Pa.Nhi(G)||!this.Kxa||!this.Kxa.LLa()?!1:!0};Pa.prototype.eff=
function(){return this.jog||1!==xc.a.M$b()};Pa.prototype.ezi=function(G){switch(G.ErrorCode){case "UserCancelled":case "interaction_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:G=G.ErrorCode===Ya.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:G.ErrorCode===Ya.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:G.ErrorCode===Ya.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:G.ErrorCode===Ya.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:G.ErrorCode===Ya.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return G};Pa.prototype.XXi=function(G){var ka="";(G=RegExp("AADSTS(\\d+)").exec(G.ErrorMessage))&&1<G.length&&(ka=G[1]);return ka};Pa.o2e=function(G){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,G)};Pa.Nhi=function(G){if(!G)return!1;G=G.toLowerCase();for(var ka=
yl(Xa.AppsForOfficeSingleSignOnManager.AUe),Ua=ka.next();!Ua.done;Ua=ka.next())if(Ua.value===G)return!0;return!1};Object(de.a)(Pa,"AppsforOfficeTokenFromOauthManager",null,[63]);pa.roa=function(){if(Bf.AFrameworkApplication.ga.ra("AppForOfficeSSOV2IsEnabled")){var G=null;try{G=oi.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ka){Te.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ka)}G=new Pa(G);pa.Oa=new pa(G)}};pa.getInstance=function(){pa.k8d||(pa.roa(),pa.k8d=
!0);return pa.Oa};pa.Oa=null;pa.k8d=!1;Object(de.a)(pa,"AppsForOfficeOauthManagerFactory",null,[38]);var jd=b(128);Object(de.a)(qa,"NewDocumentParameters",null,[]);var vd=b(157);ia.prototype.createAndOpenWorkbook=function(G){var ka=this;if(G&&G.length>this.zsg)throw Te.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",G.length),OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.invalidArgument,vd.a.fa(1719));var Ua=new qa("blank","agave",G?"streamBase64":"streamEmpty",
G),e=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(C,J){var ja=new jd.StandardDialog;ja.kc=4;ja.Ik(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Aa){2===Aa||0===Aa?J("Cancelled"):(e=window.open(""),ka.Xsg.create(C,J,Ua).x0a())})}).then(function(C){if(!C)throw OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.generalException,vd.a.fa(1715));try{e.top.location.href=C}catch(J){Te.ULS.sendTraceTag(538572820,0,
10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",dj.a.cp,J),Te.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),e.location.replace(C)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(C){if("Cancelled"===C)throw OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.hCd,vd.a.fa(1718));e.close();ka.DKj();return null})};
ia.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ia.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ia.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ia.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ia.prototype.invokePropertySetAsync=function(G,
ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ia.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ia.prototype.invokeMethodAsync=function(G,ka){switch(G){case 1:return this.C4g(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ia.prototype.C4g=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.createAndOpenWorkbook(G)};
ia.prototype.DKj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.generalException,vd.a.fa(1715));};Object(de.a)(ia,"WacWorkbook",null,[]);var ae=b(859),Ie=b(869);Qk.Object.defineProperties(fa.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(de.a)(fa,"RichApiPreviewExecutionContext",null,[]);var Zf=b(24),Vg=b(1012),Gh=b(200),pi=b(202),ij=b(112),Fj=b(11),Pj=pi.a;vm(da,Pj);da.prototype.start=function(G,ka){var Ua="<div class='"+ij.a.koh+
" "+af.a.Sk+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+ij.a.wC+"' /></div>";Ua=String.format(Ua,Xc.a.Lf(this.H5c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Pb.innerHTML=Ua;this.Iob=Fj.DOMElementExtensions.getElementById(this.Pb,"bindingText");G=ka?G.y2a(ka,this.H5c.DdaBindingsMethod.BindingId):null;(null===G||void 0===G?0:G.IsValidRef)?(ka=new Zf.Range(G.Reference.FirstRow+1,G.Reference.FirstColumn+1,G.Reference.LastRow+
1,G.Reference.LastColumn+1,!1,!1),this.Iob.value=G.Reference.SheetName+"!"+ka):(G=Qi.g(this.$).ha,this.Iob.value=tj.f(this.$.pa)||!G.va.qh?"":G.pia);this.initialize();this.mf()};da.prototype.lm=function(){this.k0c();this.addButton(0);this.addButton(1);Pj.prototype.lm.call(this)};da.prototype.setFocus=function(){Fj.DOMElementExtensions.setFocus(this.Iob)};da.prototype.validate=function(){return!0};da.prototype.commit=function(){var G=this.Iob.value.trim(),ka=G.indexOf("!");-1!==ka&&(G=this.hZh(G.substring(0,
ka))+G.substr(ka));this.vGe.addBinding(this.H5c,G,0,this.callback);return!0};da.prototype.EGa=function(){this.vGe.IQ.yf(ae.a.internalError,this.callback);Pj.prototype.EGa.call(this)};da.prototype.hZh=function(G){G=Hj.a.trimStart(G.trim(),"=");return G.length?G.startsWith("'")&&G.endsWith("'")?G:th.HelperMethods.P7b(G):""};Qk.Object.defineProperties(da.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(de.a)(da,"DdaBindingPrompt",pi.a,[]);K.prototype.yf=
function(G,ka){if(ka){var Ua={};Ua.Error=G;Ua.Version=this.ea.uf;ka(Ua)}};K.prototype.JJa=function(G,ka){this.yf(G,ka)};K.prototype.mH=function(G,ka){this.yf(ae.a.ZVe(G.Errors[0].MessageId),ka)};K.prototype.Nu=function(G){G&&G(this.oQ())};K.prototype.oQ=function(){var G={Error:0};G.Version=this.ea.uf;return G};Object(de.a)(K,"DdaErrorGenerator",null,[]);var Gi=b(303),kj=b(105);T.prototype.exd=function(G,ka){function Ua(Aa){var gb=e.$.xa.getItemByName(Aa.SheetName);(null===gb||void 0===gb?0:gb.visible)?
(Qi.g(e.$).Ug(Aa,null,null,null,3,kj.a.Ubh,void 0,void 0,void 0,void 0,!0),e.IQ.Nu(ka)):e.IQ.yf(ae.a.nVg,ka)}var e=this,C=G.DdaGoToByIdMethod.GoToType,J=G.DdaGoToByIdMethod.SelectionMode,ja=G.DdaGoToByIdMethod.Id.toString().trim();0===C?this.nDi(ja,J,G.DdaMethod.ControlId,Ua,ka):1===C?this.rDi(ja,J,Ua,ka):this.IQ.yf(ae.a.aRj,ka)};T.prototype.nDi=function(G,ka,Ua,e,C){var J=this;this.Qz.ddaGetBinding(Ua,G,function(ja){if(!Gi.a(ja)&&ja.Result&&ja.Result.Reference){ja=ja.Result;var Aa={};Aa.SheetName=
ja.Reference.SheetName;Aa.FirstRow=ja.Reference.FirstRow;Aa.FirstColumn=ja.Reference.FirstColumn;Aa.LastRow=ja.Reference.LastRow;Aa.LastColumn=ja.Reference.LastColumn;T.UVc(Aa,ka);1!==ja.BindingType?e(Aa):J.Qz.ddaGetBindingData(Ua,G,1,0,2,0,0,-1,-1,function(gb){Gi.a(gb)||!gb.Result?J.IQ.mH(gb,C):(gb=gb.Result,2!==ka&&(Aa.FirstRow-=gb.Headers.length,0>Aa.FirstRow&&(Aa.FirstRow=0)),e(Aa))},C)}else J.IQ.JJa(ae.a.c6f,C)},C)};T.prototype.rDi=function(G,ka,Ua,e){var C=this,J=hi.z(G);J?(J=hi.v(J,this.$),
T.UVc(J,ka),Ua(J)):this.$.ea.isNamedObjectViewMode&&this.$.zb.yj(G)?this.$.zb.pa=this.$.zb.getItemByName(G):(J=function(ja){Gi.a(ja)||!ja.Result?C.$.xa.contains(G)?(ja={},ja.SheetName=G,ja.FirstRow=0,ja.FirstColumn=0,ja.LastRow=0,ja.LastColumn=0,Ua(ja)):C.IQ.JJa(ae.a.c6f,e):(ja=ja.Result,T.UVc(ja,ka),Ua(ja))},this.$.xa.pa?this.Qz.parseRangeForGoto(G,this.$.xa.pa.name,J,e):this.Qz.parseRange(G,J,e))};T.UVc=function(G,ka){G.LastRow=2===ka?G.FirstRow:G.LastRow;G.LastColumn=2===ka?G.FirstColumn:G.LastColumn};
Object(de.a)(T,"DdaNavigator",null,[]);var hk=b(287),vk;(function(G){G[G.unsupported=0]="unsupported";G[G.surface=1]="surface";G[G.combo=2]="combo";G[G.column=3]="column";G[G.column3D=4]="column3D";G[G.bar=5]="bar";G[G.bar3D=6]="bar3D";G[G.line=7]="line";G[G.line3D=8]="line3D";G[G.pie=9]="pie";G[G.pie3D=10]="pie3D";G[G.scatter=11]="scatter";G[G.bubble=12]="bubble";G[G.area=13]="area";G[G.area3D=14]="area3D";G[G.doughnut=15]="doughnut";G[G.radar=16]="radar";G[G.stock=17]="stock";G[G.waterfall=18]=
"waterfall";G[G.funnel=19]="funnel";G[G.treemap=20]="treemap";G[G.sunburst=21]="sunburst";G[G.boxWhisker=22]="boxWhisker";G[G.histogram=23]="histogram";G[G.pareto=24]="pareto";G[G.regionMap=25]="regionMap";G[G.noVisibleSeries=26]="noVisibleSeries";G[G.complexDataSource=27]="complexDataSource";G[G.pivotChart=28]="pivotChart"})(vk||(vk={}));Object(de.b)("ChartCategory",vk);Object(de.a)(S,"MacroRecorderEventData",null,[]);ba.prototype.GXh=function(G){var ka;if(void 0===G||null===G||void 0===G.RequestBody||
null===G.RequestBody)return null;var Ua=JSON.parse(G.RequestBody);if(void 0!==G.ActiveChartId&&null!==G.ActiveChartId){Ua.ActiveChartId=G.ActiveChartId;var e=Qi.g(this.$).ha.Pa.mc;if(null===(ka=null===e||void 0===e?void 0:e.floatingObject)||void 0===ka?0:ka.Yc)Ua.ActiveChartType=vk[e.floatingObject.Yc.ChartCategory]}void 0!==G.SheetMultiRange&&null!==G.SheetMultiRange&&(Ua.SheetName=G.SheetMultiRange.SheetName);return Ua};ba.prototype.PXh=function(G){if(void 0===G||null===G||void 0===G.Result||null===
G.Result)return null;G=G.Result;return void 0===G.ResponseBody||null===G.ResponseBody||G.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(G.ResponseBody.join(""))};ba.prototype.qmi=function(G){return!!G&&!(void 0===G.eventId||null===G.eventId)&&0<G.eventId.length};ba.prototype.Yl=function(G){var ka=this;return function(){if(ka.$.rba){var Ua=ka.uRg(ka.request);if(ka.qmi(Ua)){var e=ka.GXh(ka.request),C=ka.PXh(G);if(e&&!Lj.a.isEmpty(e)&&C&&!Lj.a.isEmpty(C))return Te.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Pe(Ua,e,C);Ua=String.format("requestInfo: {0}; responseInfo: {1}",e?"(not null)":"(null)",C?"(not null)":"(null)");Te.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Ua)}}return new Pe(null,null,null)}};ba.prototype.uRg=function(G){var ka=this.rmi(G.SolutionId),Ua=ba.nXh(G);if(Ua&&ka)return ka={},Te.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(ka.recorderEventId=Ua,ka["request.SolutionId"]=G.SolutionId,ka)),new S(G.SolutionId,Ua);var e={};Te.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(e.recorderEventId=Ua,e.isRecorderAwareAddin=ka,e["request.SolutionId"]=G.SolutionId,e));return null};ba.prototype.rmi=function(G){if(!G)return!1;G=G.toLowerCase();return ba.Y1h().contains(G)};ba.Y1h=function(){ba.xza||(ba.xza=new Qj.a(ui.a.Gk()),ba.xza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ba.xza.add("fa000000005"),
ba.xza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ba.xza.add("fa000000014"),ba.xza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return ba.xza};ba.nXh=function(G){var ka=null,Ua=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Ua.test(G.RequestBody))ka=Ua.exec(G.RequestBody)[1];else{G=G.RequestHeaders;if(!G)return ka;Ua=lj.a.qGi.toLowerCase();for(var e=0;e<G.length;e++)if(G[e].Name.toLowerCase()===Ua){ka=G[e].Value;break}}return ka};ba.xza=null;Object(de.a)(ba,"DdaRichApiRequestRecorder",
null,[]);var Bk=b(63),Vk=hk.a;vm(la,Vk);la.prototype.S2=function(G){return Vk.prototype.S2.call(this,G)||this.jUg(G)};la.prototype.Yl=function(){return this.LLd.Yl(this.vd)};la.prototype.deb=function(){var G={OperationType:3};G.RichApiRequest=this.request;return G};la.prototype.jUg=function(G){var ka=this;return function(Ua,e,C){return H(G,ka.request,Rh.b(Ua,ka.Nlb),Rh.a(e,ka.bib),C,ka.C3)}};Qk.Object.defineProperties(la.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return dg.EwaSettings.tc()?
Object(Bk.a)(la.prototype,this,"operationWorkingState"):2}},YBc:{configurable:!0,enumerable:!0,get:function(){return this.$Ea}},Br:{configurable:!0,enumerable:!0,get:function(){return this.Nlb}},j4:{configurable:!0,enumerable:!0,get:function(){return this.bib}}});Object(de.a)(la,"DdaRichApiRequestBatchOperation",hk.a,[]);var el=ok.a;vm(Q,el);Q.prototype.Yl=function(){return this.LLd.Yl(this.vd)};Qk.Object.defineProperties(Q.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return dg.EwaSettings.tc()?
Object(Bk.a)(Q.prototype,this,"operationWorkingState"):0}}});Object(de.a)(Q,"DdaRichApiRequestOperation",ok.a,[]);U.prototype.ddaAddBinding=function(G,ka,Ua,e,C,J,ja){var Aa=this;this.RJ(function(gb,bc,Mc){var Hc=Aa.$.na.ta,yd=Aa.vja();gb=Rh.b(gb,J);bc=Rh.a(bc,Aa.jI);var we=Hc.Na(9);we.controlId=G;we.bindingId=ka;we.bindingType=Ua;we.currentSheetName=yd;we.formula=e;we.options=C;return hj.i(Hc,"DdaAddBinding",we,gb,bc,Mc,ja,0)},ja,563)};U.prototype.ddaReleaseBinding=function(G,ka,Ua,e){var C=this;
this.RJ(function(J,ja,Aa){var gb=C.$.na.ta;J=Rh.b(J,Ua);ja=Rh.a(ja,C.jI);var bc=gb.Na(9);bc.controlId=G;bc.bindingId=ka;return hj.i(gb,"DdaReleaseBinding",bc,J,ja,Aa,e,0)},e,564)};U.prototype.ddaGetBinding=function(G,ka,Ua,e){var C=this;this.RJ(function(J,ja,Aa){var gb=C.$.na.ta;J=Rh.b(J,Ua);ja=Rh.a(ja,C.jI);var bc=gb.Na(1);bc.controlId=G;bc.bindingId=ka;return hj.i(gb,"DdaGetBinding",bc,J,ja,Aa,e,0)},e,565,16)};U.prototype.ddaGetAllBindings=function(G,ka,Ua){var e=this;this.RJ(function(C,J,ja){var Aa=
e.$.na.ta;C=Rh.b(C,ka);J=Rh.a(J,e.jI);var gb=Aa.Na(1);gb.controlId=G;return hj.i(Aa,"DdaGetAllBindings",gb,C,J,ja,Ua,0)},Ua,566,16)};U.prototype.ddaGetBindingData=function(G,ka,Ua,e,C,J,ja,Aa,gb,bc,Mc){var Hc=this;this.RJ(function(yd,we,$e){var Gf=Hc.$.na.ta,ag=Hc.vja();yd=Rh.b(yd,bc);we=Rh.a(we,Hc.jI);var Nf=Gf.Na(1);Nf.controlId=G;Nf.bindingId=ka;Nf.coerceType=Ua;Nf.valueFormat=e;Nf.filterType=C;Nf.startRow=J;Nf.startCol=ja;Nf.rowCount=Aa;Nf.colCount=gb;Nf.currentSheetName=ag;return hj.i(Gf,"DdaGetBindingData",
Nf,yd,we,$e,Mc,0)},Mc,567,16)};U.prototype.ddaSetBindingData=function(G,ka,Ua,e,C,J,ja){var Aa=this;this.RJ(function(gb,bc,Mc){var Hc=Aa.$.na.ta,yd=Aa.vja();gb=Rh.b(gb,J);bc=Rh.a(bc,Aa.jI);var we=Hc.Na(9);we.controlId=G;we.bindingId=ka;we.startRow=Ua;we.startCol=e;we.currentSheetName=yd;we.bindingData=C;return hj.i(Hc,"DdaSetBindingData",we,gb,bc,Mc,ja,0)},ja,568)};U.prototype.ddaGetSelectedData=function(G,ka,Ua,e,C,J,ja){var Aa=this;this.RJ(function(gb,bc,Mc){var Hc=Aa.$.na.ta,yd=Aa.vja();gb=Rh.b(gb,
J);bc=Rh.a(bc,Aa.jI);var we=Hc.Na(1);we.controlId=G;we.coerceType=ka;we.valueFormat=Ua;we.filterType=e;we.currentSheetName=yd;we.formula=C;return hj.i(Hc,"DdaGetSelectedData",we,gb,bc,Mc,ja,0)},ja,569,16)};U.prototype.ddaSetSelectedData=function(G,ka,Ua,e,C){var J=this;this.RJ(function(ja,Aa,gb){var bc=J.$.na.ta,Mc=J.vja();ja=Rh.b(ja,e);Aa=Rh.a(Aa,J.jI);var Hc=bc.Na(9);Hc.controlId=G;Hc.currentSheetName=Mc;Hc.formula=ka;Hc.bindingData=Ua;return hj.i(bc,"DdaSetSelectedData",Hc,ja,Aa,gb,C,0)},C,570)};
U.prototype.ddaLoadSettings=function(G,ka,Ua){var e=this;this.RJ(function(C,J,ja){var Aa=e.$.na.ta;C=Rh.b(C,ka);J=Rh.a(J,e.jI);var gb=Aa.Na(1);gb.controlId=G;return hj.i(Aa,"DdaLoadSettings",gb,C,J,ja,Ua,0)},Ua,501,16)};U.prototype.ddaSaveSettings=function(G,ka,Ua,e,C){var J=this;this.RJ(function(ja,Aa,gb){var bc=J.$.na.ta;ja=Rh.b(ja,e);Aa=Rh.a(Aa,J.jI);var Mc=bc.Na(9);Mc.controlId=G;Mc.settings=ka;Mc.overwriteIfStale=Ua;return hj.i(bc,"DdaSaveSettings",Mc,ja,Aa,gb,C,0)},C,571)};U.prototype.ddaAddRowsColumns=
function(G,ka,Ua,e,C,J){var ja=this;this.RJ(function(Aa,gb,bc){var Mc=ja.$.na.ta,Hc=ja.vja();Aa=Rh.b(Aa,C);gb=Rh.a(gb,ja.jI);var yd=Mc.Na(9);yd.controlId=G;yd.bindingId=ka;yd.isRow=Ua;yd.currentSheetName=Hc;yd.bindingData=e;return hj.i(Mc,"DdaAddRowsColumns",yd,Aa,gb,bc,J,0)},J,572)};U.prototype.ddaDeleteAllDataValues=function(G,ka,Ua,e){var C=this;this.RJ(function(J,ja,Aa){var gb=C.$.na.ta,bc=C.vja();J=Rh.b(J,Ua);ja=Rh.a(ja,C.jI);var Mc=gb.Na(9);Mc.controlId=G;Mc.bindingId=ka;Mc.currentSheetName=
bc;return hj.i(gb,"DdaDeleteAllDataValues",Mc,J,ja,Aa,e,0)},e,573)};U.prototype.ddaClearBindingFormats=function(G,ka,Ua,e){var C=this;this.RJ(function(J,ja,Aa){var gb=C.$.na.ta,bc=C.vja();J=Rh.b(J,Ua);ja=Rh.a(ja,C.jI);var Mc=gb.Na(9);Mc.controlId=G;Mc.bindingId=ka;Mc.currentSheetName=bc;return hj.i(gb,"DdaClearBindingFormats",Mc,J,ja,Aa,e,0)},e,574)};U.prototype.ddaSetBindingFormats=function(G,ka,Ua,e,C,J){var ja=this;this.RJ(function(Aa,gb,bc){var Mc=ja.$.na.ta,Hc=ja.vja();Aa=Rh.b(Aa,C);gb=Rh.a(gb,
ja.jI);var yd=Mc.Na(9);yd.controlId=G;yd.bindingId=ka;yd.currentSheetName=Hc;yd.bindingData=Ua;yd.isSetFormats=e;return hj.i(Mc,"DdaSetBindingFormats",yd,Aa,gb,bc,J,0)},J,575)};U.prototype.parseRange=function(G,ka,Ua){var e=this;this.RJ(function(C,J,ja){var Aa=e.$.na.ta.$b();return hj.Q(e.$.na.ta,G,-1,Rh.b(C,ka),Rh.a(J,e.jI),ja,Ua,Aa)},Ua,162,16)};U.prototype.parseRangeForGoto=function(G,ka,Ua,e){var C=this;this.RJ(function(J,ja,Aa){var gb=C.$.na.ta.$b();return hj.R(C.$.na.ta,G,ka,Rh.b(J,Ua),Rh.a(ja,
C.jI),Aa,e,gb)},e,562,16)};U.prototype.executeRichApiRequest=function(G,ka,Ua){var e=this;dg.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(G.RequestFlags&=8191);if(dg.EwaSettings.la(260))this.yzh(this.$.na.ta.$b(),ka,function(){e.IQ.JJa(ae.a.internalError,Ua)},Ua,G);else{var C=li.DdaFacade.Ufd(G);!dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.QC||C&16?(dg.EwaSettings.tc()&&(C|=64),this.$.userOperationManager.Mt(new Q(this.$,
G,function(J,ja,Aa){return H(e.$.na.ta,G,Rh.b(J,ka),Rh.a(ja,e.jI),Aa,Ua)},C))):(this.IQ.JJa(ae.a.UCc,Ua),Te.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};U.prototype.vja=function(){return this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.activeItemName};U.prototype.RJ=function(G,ka,Ua,e){e=void 0===e?0:e;!dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.QC||e&16?dg.EwaSettings.tc()?this.$.userOperationManager.Mt(new ok.a(Ua,
0,G,e|64)):this.$.userOperationManager.Mt(new nk.a(Ua,0,G,e)):(this.IQ.JJa(ae.a.UCc,ka),Te.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};U.prototype.yzh=function(G,ka,Ua,e,C){var J=li.DdaFacade.Ufd(C);if(!dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.QC||J&16){var ja=this.$.Wb.Ic("UserAction","Rich Api request");dg.EwaSettings.tc()&&(J|=64);this.$.userOperationManager.ic(new la(this.$,G,ka,Ua,e,ja,C,J),null)}else this.IQ.JJa(ae.a.UCc,
e),Te.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(de.a)(U,"DdaWebServiceHelper",null,[]);Object(de.a)(V,"DocumentFile",null,[]);D.generalException="GeneralException";D.LJg="ApiNotFound";D.hCd="OperationCancelled";D.invalidArgument="InvalidArgument";Object(de.a)(D,"ErrorCodes",null,[]);z.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};z.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};
z.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(de.a)(z,"WacApiDelegates",null,[]);var kl=b(661);vm(I,z);I.prototype.replaceShortcuts=function(G){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,G,this.Ohf)};I.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};I.prototype.checkShortcutsInUse=function(G){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(G,
this.Ohf)};I.w7g=function(G,ka){var Ua=document.createEvent("KeyboardEvent");if(dj.a.qF)Ua.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(G&8),!!(G&32),!!(G&4),!!(G&256));else{var e=[];G&4&&e.push("Shift");G&8&&e.push("Control");G&32&&e.push("Alt");Ua.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,e,!1,"en-US")}G=new Sys.UI.DomEvent(Ua);G.keyCode=ka;return G};I.d3g=function(G,ka){if(dj.a.Df)switch(ka){case 189:ka=173;break;case 187:ka=61;break;case 186:ka=59}return I.w7g(G,ka)};Object(de.a)(I,
"ExcelWacApiDelegates",z,[]);r.prototype.bBg=function(G,ka){this.$cc(G)||(this.tIa[G]={});if(this.Mhi(G))return Te.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",G),ae.a.vAi;this.tIa[G][ka.mBh.toString()]=ka;return ae.a.success};r.prototype.bPh=function(G,ka){var Ua=null;this.$cc(G)&&(Ua=this.tIa[G][ka.toString()]);Ua||Te.ULS.sendTraceTag(537163156,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",G,ka);return Ua};r.prototype.$cc=function(G){return G in
this.tIa};r.prototype.U$i=function(G,ka){if(this.$cc(G)){var Ua=this.tIa[G];delete Ua[ka.toString()];1>Object.keys(Ua).length&&delete this.tIa[G];return ka.toString()in Ua?ae.a.internalError:ae.a.success}return ae.a.internalError};r.prototype.Mhi=function(G){return this.$cc(G)?Object.keys(this.tIa[G]).length>=this.Rzi:!1};r.getInstance=function(G){return G.da.Aa(200)||G.da.Ha(200,new r(r.Szi))};r.ZDi=function(){return++r.yTg};r.xzi=4194304;r.Szi=1;r.yTg=0;Object(de.a)(r,"GetFileApiHelper",null,[]);
B.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.eA)};B.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};B.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};B.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};B.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};B.prototype.invokeMethod=function(G){switch(G){case 1:return this.IEi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};B.prototype.IEi=function(){this.notifyActionHandlerReady();return null};
Object(de.a)(B,"AddinInternalService",null,[]);u.prototype.getAppRuntimeState=function(){return this.eJ.getAppRuntimeState(this.eA)?2:1};u.prototype.setAppRuntimeState=function(G){switch(G){case 2:G=!0;break;case 1:G=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.invalidArgument,vd.a.fa(1719));}this.eJ.setAppRuntimeState(this.eA,G)};u.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};u.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};u.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(G,ka){switch(G){case 2:return this.qKh();case 1:return this.Wpj(ka)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.qKh=function(){return this.getAppRuntimeState()};u.prototype.Wpj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");this.setAppRuntimeState(G);return null};Object(de.a)(u,"AppRuntimeService",null,[]);var fl=b(1118);x.prototype.disable=function(){try{if(!vd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qDe();
if(!this.qhf())return this.rDe();this.B1.hQj(this.Hs)}catch(G){return Te.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",G.message||"Unknown"),this.oDe()}return null};x.prototype.enable=function(){try{if(!vd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qDe();if(!this.qhf())return this.rDe();this.B1.W8i(this.Hs)}catch(G){return Te.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
G.message||"Unknown"),this.oDe()}return null};x.prototype._OnAccess=function(){};x.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};x.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};x.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};x.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};x.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.invokeMethod=function(G){switch(G){case 1:return this.hCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};x.prototype.invokeMethodAsync=function(G,ka){switch(G){case 3:return this.zfh();case 2:return this.Ukh()}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};x.prototype.zfh=
function(){return this.disable()};x.prototype.Ukh=function(){return this.enable()};x.prototype.hCa=function(){this._OnAccess();return null};x.prototype.qDe=function(){return fl.a(M.a.notImplemented,vd.a.fa(1720))};x.prototype.rDe=function(){return fl.a(M.a.sharedRuntimeNotAvailable,vd.a.fa(1724))};x.prototype.oDe=function(){return fl.a(M.a.generalException,vd.a.fa(1715))};x.prototype.qhf=function(){var G=this.Ay.getSharedRuntimeId();return!!G&&0<G.length};Object(de.a)(x,"BeforeDocumentCloseNotification",
null,[]);A.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};A.prototype.invokePropertyGet=function(G){switch(G){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};A.prototype.invokePropertySet=function(G,
ka){switch(G){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
A.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Qk.Object.defineProperties(A.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.Zz},set:function(G){this.Zz=G}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.Pbe},set:function(G){this.Pbe=G}},streamingEnabled:{configurable:!0,
enumerable:!0,get:function(){return this.Phe},set:function(G){this.Phe=G}}});Object(de.a)(A,"CustomFunctionEngineStatus",null,[]);t.prototype.register=function(G){return OfficeExtension.WacRuntime.Utility.createPromise(this.Kug(G))};t.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};t.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokePropertyGetAsync=
function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};t.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokeMethodAsync=
function(G,ka){switch(G){case 1:return this.O9i(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.O9i=function(G){var ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"string");return this.register(ka,G)};Qk.Object.defineProperties(t.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var G=new A;G.enabled=this.Oqg;G.streamingEnabled=this.Pqg;
G.nativeRuntime=!1;return G}}});Object(de.a)(t,"CustomFunctionManager",null,[]);var ll=b(1074);w.prototype._RegisterStateChange=function(){var G=this;this.JRb||this.iP.execute(function(ka){G.G2d=ka.Aza(G._id,function(Ua){G.eJ.uDh(G.eA,G._id,JSON.stringify(Ua))})});this.JRb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype._UnregisterStateChange=function(){var G=this;this.JRb--;this.JRb||this.iP.execute(function(ka){ka.pId(G._id,G.G2d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
w.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};w.prototype.invokePropertyGet=function(G){switch(G){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertySetAsync=
function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokeMethodAsync=function(G,ka){switch(G){case 6:return this.tkg();case 7:return this.vkg()}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.tkg=function(){return this._RegisterStateChange()};w.prototype.vkg=
function(){return this._UnregisterStateChange()};Qk.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(de.a)(w,"LicenseFeature",null,[]);v.prototype.getFeatureTier=function(G,ka){var Ua=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(e){var C=1===ka?1:2===ka?2:0;Ua.iP.execute(function(J){J.getFeatureTier(G,C).then(function(ja){e(Ua.mTh(ja))},function(){e(ka)})})})};v.prototype.getLicenseFeature=function(G){G=new w(this.iP,
G,this.eA,this.eJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.isFeatureEnabled=function(G,ka){var Ua=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(e){Ua.iP.execute(function(C){C.isFeatureEnabled(G,ka).then(function(J){e(J)},function(){e(ka)})})})};v.prototype.isFreemiumUpsellEnabled=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ka){G.iP.execute(function(Ua){Ua=Ua.isFreemiumUpsellEnabled();ka(Ua)})})};
v.prototype.launchUpsellExperience=function(G){var ka=this;if(this.ztg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){ka.iP.execute(function(Ua){Ua.launchUpsellExperience(G)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.cTc,"");};v.prototype._TestFireStateChangedEvent=function(){};v.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};v.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};v.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(G,ka){switch(G){case 6:return this.ukg(ka)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};v.prototype.invokeMethodAsync=function(G,ka){switch(G){case 2:return this.XPh(ka);case 5:return this.lTh(ka);case 1:return this.Aii(ka);case 3:return this.fji();case 4:return this.osi(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.XPh=function(G){var ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"int");return this.getFeatureTier(ka,G)};v.prototype.lTh=
function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.getLicenseFeature(G)};v.prototype.Aii=function(G){var ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"boolean");return this.isFeatureEnabled(ka,G)};v.prototype.fji=function(){return this.isFreemiumUpsellEnabled()};v.prototype.osi=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");
return this.launchUpsellExperience(G)};v.prototype.ukg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");this._TestFireStateChangedEvent(G);return null};v.prototype.mTh=function(G){switch(G){case 1:return 1;case 2:return 2;default:return 0}};Object(de.a)(v,"License",null,[]);var pl=b(147);m.prototype.areShortcutsInUse=function(G){var ka=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ua,e){ka.uvd.checkShortcutsInUse(G).then(function(C){Ua(C)}).catch(function(C){e(C)})})};
m.prototype.getShortcuts=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ka,Ua){G.uvd.getShortcuts().then(function(e){ka(e)}).catch(function(e){Ua(e)})})};m.prototype.replaceShortcuts=function(G){var ka=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ua,e){ka.uvd.replaceShortcuts(G).then(function(){Ua(null)}).catch(function(C){e(C)})})};m.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};m.prototype.invokePropertyGet=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};m.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokeMethodAsync=function(G,ka){switch(G){case 3:return this.tLg(ka);case 1:return this.lZh();case 2:return this.yfj(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};m.prototype.tLg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"Array<string>");return this.areShortcutsInUse(G)};m.prototype.lZh=function(){return this.getShortcuts()};
m.prototype.yfj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"any");return this.replaceShortcuts(G)};Object(de.a)(m,"ActionService",null,[]);var ml=b(525);n.prototype.$Yh=function(){this.qga||(this.qga=ml.a.Sq(oi.a.instance.pc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.qga};n.prototype.getSharedFilePickerResponse=function(G){var ka=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ua,e){try{var C=ka.$Yh();ak.Task.WAA.call(null,
C).continueWith(function(){var J=C.result;if(J){var ja={};(function(){var Aa=Vh.d(G);ja=Aa.Iu;return Aa})().returnValue?J.zed(ja).then(function(Aa){Aa&&0<Aa.length?Ua(Aa):e(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(function(Aa){e(Aa)}):e(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else e(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(J){e(J)}})};n.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};n.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};n.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};n.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokeMethodAsync=function(G,ka){switch(G){case 1:return this.ZYh(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};n.prototype.ZYh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"string");return this.getSharedFilePickerResponse(G)};Object(de.a)(n,"SharedFilePicker",null,[]);l.prototype.createInstance=function(G,ka){switch(G){case "Microsoft.Office.ActionService":return new m(ka);case "Microsoft.Office.SharedFilePicker":return new n}return null};Object(de.a)(l,"WacApiHost",null,[]);d.prototype.hostName=function(){return"ExcelOnline"};d.prototype.appId=function(){return this.RPb};d.prototype.createInstance=function(G){switch(G){case "Microsoft.Authentication.AuthenticationService":return oi.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.eA,
this.eJ.Ii);case "Microsoft.Authentication.TokenParameters":return new Ia;case "Microsoft.ExcelServices.CustomFunctionManager":G=this.vb.la(122);var ka=this.vb.la(123);return new t(G,ka,f(this.RPb,this.vb,this.eJ));case "Microsoft.AppRuntime.AppRuntimeService":return new u(this.eA,this.eJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return G=Ij.a(this.vb),new x(this.RPb,this.eA,G,this.eJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return G=Ij.a(this.vb),new ll.DynamicRibbon(this.RPb,
this.eA,this.eJ,G,G.an(this.eA).dl);case "Microsoft.Office.Licensing.License":return new v(this.eA,this.eJ);case "Microsoft.InternalService.AddinInternalService":return new B(this.eA);default:if(this.ISc||(this.ISc=new l),ka=this.ISc.createInstance(G,this.Qyg))return ka}Te.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",G);throw OfficeExtension.WacRuntime.Utility.createRichApiException(M.a.generalException,M.a.generalException);};
Object(de.a)(d,"RichApiHost",null,[]);var ql=b(385),rl=b(113),wk=b(32),Wk=b(94),gl=b(278),nl=b(41),tl=b(245),sl=b(6),Xk=b(65),ck=b(192);c.prototype.dispose=function(){this.$=this.S8b=null};c.prototype.Zc=function(){return!1};c.prototype.gd=function(){return!1};c.prototype.executeCommand=function(G,ka,Ua){G=ka.command;switch(G){case 451041795:this.Ae.yf(Ua[yj.a.Tg],Ua[yj.a.C3]);break;case 974713501:this.z4h(Ua[yj.a.Tg],Ua[yj.a.C3]);break;case 1237877382:this.Ae.Nu(Ua[yj.a.C3]);break;default:return Hi.a(G)}return ak.Task.Ta(!0)};
c.prototype.Kc=function(G,ka,Ua){if(G=!!Ua)switch(ka.command){case 974713501:case 1237877382:case 451041795:break;default:G=!1}return G};c.prototype.z4h=function(G,ka){var Ua=G.DdaMethod;if("undefined"===typeof Ua.DispatchId)this.Ae.yf(ae.a.internalError,ka);else if(c.Fhi(G)||this.$.Jd&1){if(Ua.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new da(this.$,this,G,ka)).start(this.Xe,G.DdaMethod.ControlId):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.zYh(G,
ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.nuj(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(G,this.$dd(G.DdaMethod.ControlId),0,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.UKh(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.fqj(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.TKh(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?
this.T$i(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.VJh(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.Dtd(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(G.DdaAddRowsColumns.IsRow=!0,this.Bme(G,ka)):Ua.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(G.DdaAddRowsColumns.IsRow=!1,this.Bme(G,ka)):Ua.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?
this.idh(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.fYg(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(G.DdaSetBindingFormats.IsSetFormats=!0,this.WYf(G,ka)):Ua.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(G.DdaSetBindingFormats.IsSetFormats=!1,this.WYf(G,ka)):Ua.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(G,G.DdaBindingsMethod.ItemName,G.DdaBindingsMethod.FailOnCollision?2:1,ka):Ua.DispatchId===
OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.aQh(ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.exd(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.ZOh(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.$Oh(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.V$i(G,ka):Ua.DispatchId===
OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(G.DdaMethod.ControlId,G),this.Ae.Nu(ka)):Ua.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?dg.EwaSettings.la(24)?this.Ae.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ka):this.cBi(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?dg.EwaSettings.la(24)?this.Ae.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ka):this.ZAi(G,
ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(G,ka):Ua.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(G,ka):this.Ae.yf(ae.a.kCd,ka),dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Ua.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){G=this.Xe.pZ(G.DdaMethod.ControlId);ka="";if(G){ka=li.DdaFacade.getSolutionId(G,this.$);var e=G.PrimaryMarketplace.MarketplaceType;
e===OSF.StoreType.InMemory?G.OwnerAddinAssetId&&G.AssetMarketplace&&(e=G.AssetMarketplace.MarketplaceType):e===OSF.StoreType.WopiCatalog&&(e=OSF.StoreType.OMEX);ka=Telemetry.PrivacyRules.GetAssetId(e,G.PrimaryMarketplace.MarketplaceRef,ka)}Te.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",Ua.DispatchId,ka)}}else this.Ae.yf(ae.a.sJe,ka)};c.prototype.UKh=function(G,ka){var Ua=this;G.DdaGetBindingData.CoerceType=c.o2b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.FilterType=
c.JTe(G.DdaGetBindingData.FilterType);G.DdaGetBindingData.ValueFormat=c.Wfg(G.DdaGetBindingData.ValueFormat);if(this.eic(G.DdaGetBindingData.CoerceType,ka)){if(G.DdaGetBindingData){var e=G.DdaGetBindingData;0===e.FilterType&&(e.FilterType=2);e.StartCol|=0;e.StartRow|=0;e.ColCount=void 0===e.ColCount?-1:e.ColCount;e.RowCount=void 0===e.RowCount?-1:e.RowCount}this.Qz.ddaGetBindingData(G.DdaMethod.ControlId,G.DdaGetBindingData.BindingId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,
G.DdaGetBindingData.FilterType,G.DdaGetBindingData.StartRow,G.DdaGetBindingData.StartCol,G.DdaGetBindingData.RowCount,G.DdaGetBindingData.ColCount,function(C){if(Gi.a(C)||!C.Result)Ua.Ae.mH(C,ka);else{var J=Ua.Ae.oQ();J.Data=c.Que(C.Result);ka(J)}},ka)}};c.prototype.fqj=function(G,ka){var Ua=this;G.DdaSetBindingData.CoerceType=c.o2b(G.DdaSetBindingData.CoerceType);if(this.eic(G.DdaSetBindingData.CoerceType,ka)){var e=c.HYc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data);c.jfc(e)?this.Ae.yf(ae.a.NAc,
ka):(1===e.CoerceType&&(e.CellFormat||(e.CellFormat=G.DdaSetBindingData.CellFormat),e.TableOptions||(e.TableOptions=G.DdaSetBindingData.TableOptions)),G.DdaSetBindingData&&(G.DdaSetBindingData.StartCol|=0,G.DdaSetBindingData.StartRow|=0),this.Qz.ddaSetBindingData(G.DdaMethod.ControlId,G.DdaSetBindingData.BindingId,G.DdaSetBindingData.StartRow,G.DdaSetBindingData.StartCol,e,function(C){Gi.a(C)?Ua.Ae.mH(C,ka):Ua.Ae.Nu(ka)},ka))}};c.prototype.zYh=function(G,ka){var Ua=this;G.DdaGetBindingData.CoerceType=
c.o2b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.ValueFormat=c.Wfg(G.DdaGetBindingData.ValueFormat);G.DdaGetBindingData.FilterType=c.JTe(G.DdaGetBindingData.FilterType);if(this.eic(G.DdaGetBindingData.CoerceType,ka)){var e=this.$dd(G.DdaMethod.ControlId);e?this.Qz.ddaGetSelectedData(G.DdaMethod.ControlId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,e,function(C){if(Gi.a(C))Ua.Ae.mH(C,ka);else{var J=Ua.Ae.oQ();J.Data=c.Que(C.Result);ka(J)}},
ka):this.Ae.yf(ae.a.h3e,ka)}};c.prototype.ZOh=function(G,ka){var Ua=this;if(dj.a.Pod)this.Ae.yf(ae.a.APg,ka);else{var e=G[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],C=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],J=G.DdaMethod.ControlId,ja=r.getInstance(this.$);if(0>=C)Te.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Ae.yf(ae.a.vei,ka);else if(C>r.xzi)Te.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),
this.Ae.yf(ae.a.mZe,ka);else{var Aa=null;switch(e){case 1:Aa="Compressed";break;case 0:Aa="Text";break;case 2:Aa="Pdf";break;default:Te.ULS.sendTraceTag(537163219,344,15,"Requested file type {0} is not supported.",e);this.Ae.yf(ae.a.xTe,ka);return}if("Text"===Aa)Te.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Aa),this.Ae.yf(ae.a.xTe,ka);else{dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(G=new Sys.StringBuilder,G.append(Vg.a(this.$,
Aa)),"Pdf"===Aa&&Gh.a.Xf(G,lj.a.NFd,"WholeWorkbook"),G=G.toString()):G=Vg.a(this.$,Aa);var gb=null,bc=new XMLHttpRequest;bc.onreadystatechange=function(){if(4===bc.readyState)if(200===bc.status){var Mc=bc.response;if(Mc){gb=new Uint8Array(Mc);Mc=Ua.Ae.oQ();for(var Hc=gb.length,yd=r.ZDi(),we={},$e=0,Gf=0;Gf<Hc;Gf+=C){for(var ag=[],Nf=Gf+C<Hc?Gf+C:Hc,Pg=0,Jh=Gf;Jh<Nf;Pg++,Jh++)ag[Pg]=gb[Jh];we[($e++).toString()]=ag}we=new V(yd,Hc,C,we);we=ja.bBg(J,we);we!==ae.a.success?Ua.Ae.yf(we,ka):(Mc[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
yd,Mc[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Hc,Te.ULS.sendTraceTag(537163216,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Aa,Hc),ka(Mc))}else Te.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Aa),Ua.Ae.yf(ae.a.internalError,ka)}else 500===bc.status?Ua.Ae.yf(ae.a.ZVe(parseInt(bc.statusText,10)),ka):(Te.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",
Aa),Ua.Ae.yf(ae.a.HDi,ka))};bc.open("GET",G,!0);bc.responseType="arraybuffer";bc.setRequestHeader("If-Modified-Since","0");bc.send(null)}}}};c.prototype.$Oh=function(G,ka){var Ua=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],e=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];G=G.DdaMethod.ControlId;(Ua=r.getInstance(this.$).bPh(G,Ua))?(Ua=Ua.WDj,0>e||e>=Object.keys(Ua).length?this.Ae.yf(ae.a.f$h,ka):(e=Ua[e.toString()],Ua=this.Ae.oQ(),Ua[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
e,Ua[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=e.length,ka(Ua))):this.Ae.yf(ae.a.internalError,ka)};c.prototype.V$i=function(G,ka){var Ua=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];G=G.DdaMethod.ControlId;Ua=r.getInstance(this.$).U$i(G,Ua);Ua===ae.a.success?this.Ae.Nu(ka):this.Ae.yf(Ua,ka)};c.prototype.nuj=function(G,ka){var Ua=this;G.DdaSetBindingData.CoerceType=c.o2b(G.DdaSetBindingData.CoerceType);if(this.eic(G.DdaSetBindingData.CoerceType,ka)){var e=this.$dd(G.DdaMethod.ControlId);
if(e){var C=c.HYc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data),J=Qi.g(this.$).ha;1===C.CoerceType&&(!C.Data&&J.va.e_&&(C.Headers||(C.Headers=[]),C.Headers.length||Array.add(C.Headers,[]),C.Headers[0].length||Array.add(C.Headers[0],"")),c.jfc(C)||(C.CellFormat||(C.CellFormat=G.DdaSetBindingData.CellFormat),C.TableOptions||(C.TableOptions=G.DdaSetBindingData.TableOptions)));if(c.jfc(C))this.Ae.yf(ae.a.NAc,ka);else{var ja=J.va.Td.clone(),Aa=J.va.activeCell.clone();this.Qz.ddaSetSelectedData(G.DdaMethod.ControlId,
e,C,function(gb){var bc;if(Gi.a(gb))Ua.Ae.mH(gb,ka);else{gb=ja.clone();var Mc=C.Headers?C.Headers[0].length:C.Data[0].length;1!==C.CoerceType||C.Data?1===C.CoerceType&&(null===(bc=C.TableOptions)||void 0===bc?0:bc.length)&&0==C.TableOptions[0]?(gb.top+=1,gb.bottom=gb.top+C.Data.length-1):gb.bottom=gb.top+C.Data.length-(1===C.CoerceType?0:1):gb.bottom=gb.top+1;gb.right=gb.left+Mc-1;bc=gb.contains(Aa)?Aa:gb.topLeft;J.updateSelection(gb,bc,0);Ua.Ae.Nu(ka)}},ka)}}else this.Ae.yf(ae.a.fxe,ka)}};c.prototype.addBinding=
function(G,ka,Ua,e){var C=this;ka?this.Qz.ddaAddBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,G.DdaBindingsMethod.BindingType,ka,Ua,function(J){if(Gi.a(J))C.Ae.mH(J,e);else{var ja=C.Ae.oQ();ja.Bindings=Array(1);ja.Bindings[0]=C.Xe.$_b(J.Result);e(ja)}},e):this.Ae.yf(ae.a.znj,e)};c.prototype.TKh=function(G,ka){var Ua=this;this.Qz.ddaGetBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(e){if(Gi.a(e)||!e.Result)Ua.Ae.mH(e,ka);else{var C=Ua.Ae.oQ();C.Bindings=Array(1);
C.Bindings[0]=Ua.Xe.$_b(e.Result);ka(C)}},ka)};c.prototype.aQh=function(G){var ka=this.Ae.oQ(),Ua={};Ua[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ka[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Ua;G(ka)};c.prototype.T$i=function(G,ka){var Ua=this;this.Qz.ddaReleaseBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(e){Gi.a(e)?Ua.Ae.mH(e,ka):Ua.Ae.Nu(ka)},ka)};c.prototype.VJh=function(G,ka){var Ua=this;this.Qz.ddaGetAllBindings(G.DdaMethod.ControlId,
function(e){if(Gi.a(e))Ua.Ae.mH(e,ka);else{var C=Ua.Ae.oQ();if(e.Result){e=e.Result;C.Bindings=Array(e.length);for(var J=0;J<e.length;J++)C.Bindings[J]=Ua.Xe.$_b(e[J])}else C.Bindings=null;ka(C)}},ka)};c.prototype.Dtd=function(G,ka){var Ua=this;this.Qz.ddaLoadSettings(G.DdaMethod.ControlId,function(e){if(Gi.a(e))Ua.Ae.mH(e,ka);else{var C=Ua.Ae.oQ();C.Properties=e.Result;ka(C)}},ka)};c.prototype.saveSettings=function(G,ka){for(var Ua=this,e={Settings:[]},C=0;C<G.DdaSettingsMethod.Properties.length;C++){var J=
{};J.Name=G.DdaSettingsMethod.Properties[C][0];J.Value=G.DdaSettingsMethod.Properties[C][1];e.Settings[C]=J}this.Qz.ddaSaveSettings(G.DdaMethod.ControlId,e,G.DdaSettingsMethod.OverwriteIfStale,function(ja){Gi.a(ja)?Ua.Ae.mH(ja,ka):Ua.Ae.Nu(ka)},ka)};c.prototype.Bme=function(G,ka){var Ua=this,e=c.HYc(1,G.DdaAddRowsColumns.Data);c.jfc(e)?this.Ae.yf(ae.a.NAc,ka):this.Qz.ddaAddRowsColumns(G.DdaMethod.ControlId,G.DdaAddRowsColumns.BindingId,G.DdaAddRowsColumns.IsRow,e,function(C){Gi.a(C)?Ua.Ae.mH(C,ka):
Ua.Ae.Nu(ka)},ka)};c.prototype.idh=function(G,ka){var Ua=this;this.Qz.ddaDeleteAllDataValues(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(e){Gi.a(e)?Ua.Ae.mH(e,ka):Ua.Ae.Nu(ka)},ka)};c.prototype.fYg=function(G,ka){var Ua=this;this.Qz.ddaClearBindingFormats(G.DdaMethod.ControlId,G.DdaClearBindingFormats.BindingId,function(e){Gi.a(e)?Ua.Ae.mH(e,ka):Ua.Ae.Nu(ka)},ka)};c.prototype.WYf=function(G,ka){var Ua=this,e={},C=G.DdaSetBindingFormats.IsSetFormats;C?e.CellFormat=G.DdaSetBindingFormats.CellFormat:
e.TableOptions=G.DdaSetBindingFormats.TableOptions;this.Qz.ddaSetBindingFormats(G.DdaMethod.ControlId,G.DdaSetBindingFormats.BindingId,e,C,function(J){Gi.a(J)?Ua.Ae.mH(J,ka):Ua.Ae.Nu(ka)},ka)};c.prototype.executeRichApiRequest=function(G,ka){var Ua=this,e=G.ArrayData,C={},J=Qi.g(this.$).ha;if(e){if("WacPartition"===e[0]){this.hzh(G,ka);return}var ja=Object(Ci.a)(li.DdaFacade,Ij.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===e[0]){var Aa=ja.an(G.DdaMethod.ControlId);Aa&&(Aa.upd=!0,
Aa.vKf())}C.HttpMethod=e[1];C.PathAndQuery=e[2];C.RequestHeaders=c.J_e(e[3]);C.RequestBody=e[4];C.AppPermission=e[5];Aa=e[6];C.RequestFlags=Aa;var gb=0;if(tj.i(this.$.pa))switch(J.We){case 1:gb=2;break;case 2:gb=3;break;case 128:gb=4;break;default:gb=1}var bc=null;J.Pa.oC&&(bc=J.Pa.oC.hj);C.SheetMultiRange=hi.r(J.va.selectedRanges,this.$);C.ActiveCell=hi.v(J.va.activeCell,this.$);C.ActiveChartId=bc;C.SelectionState=gb;gb=this.Xe.pZ(G.DdaMethod.ControlId);C.InstanceId=gb?gb.InstanceId:"";if(gb&&gb.PrimaryMarketplace){bc=
li.DdaFacade.getSolutionId(gb,this.$);var Mc=gb.PrimaryMarketplace.MarketplaceType;if(Mc===OSF.StoreType.InMemory){if(!gb.OwnerAddinSolutionId){this.Ae.yf(ae.a.Rxb,ka);return}if(gb.AssetMarketplace)Mc=gb.AssetMarketplace.MarketplaceType;else{this.Ae.yf(ae.a.Rxb,ka);return}}else Mc===OSF.StoreType.WopiCatalog&&(Mc=OSF.StoreType.OMEX);var Hc=Telemetry.PrivacyRules.GetAssetId(Mc,gb.PrimaryMarketplace.MarketplaceRef,bc);C.CompliantSolutionId=Hc;C.SolutionId=bc;C.MarketplaceType=Mc;C.SolutionVersion=gb.PrimaryMarketplace.SolutionVersion;
C.StoreLocation=gb.PrimaryMarketplace.MarketplaceRef}else C.SolutionId=C.MarketplaceType="",C.CompliantSolutionId="";C.IsEventsEnabled=void 0===ja||null===ja||ja.fj.k_b(C.InstanceId);C.RequestGuid=Kj.a.create().toString();ja=C.RequestBody.length;if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&ja>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.Ae.yf(ae.a.Sgj,ka);Te.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",ja);return}dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&
Aa&4096&&(ja=new fa(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(ja,W,e),C.RequestBody=e[4])}var yd=c.O2e(C.RequestHeaders);c.dDd++;var we=zh.a.Ra.Lb;dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&C&&C.RequestBody&&Te.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",C.RequestBody.length));this.Qz.executeRichApiRequest(C,function($e){var Gf;Ua.fYf(we,!0,$e.ServerCorrelationId);var ag=null,Nf=null,Pg=$e.ServerCorrelationId;
if(null===(Gf=null===$e||void 0===$e?void 0:$e.Errors)||void 0===Gf?0:Gf[0])ag=$e.Errors[0].MessageIdName,Nf=$e.Errors[0].Description,dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&Xk.a(Ua.$).rd.XD($e.Errors[0].MessageId);if(Gi.a($e)||!$e.Result)Ua.BNa(Pg,yd,"Server error",ag,Nf),Ua.Ae.mH($e,ka);else{var Jh=null;if(dg.EwaSettings.la(260))if((Gf=$e.Result)&&Gf.length){for(var jj=0;jj<Gf.length;jj++)if(Gf[jj].RequestGuid===C.RequestGuid){Jh=Gf[jj];break}Jh||Ua.Ae.mH($e,
ka)}else Jh=$e.Result;else Jh=$e.Result;if(!ag&&Jh&&Jh.ResponseBody&&Jh.ResponseBody[0])if($e=Jh.ResponseBody[0],$e.startsWith('{"Error":')){1<Jh.ResponseBody.length&&($e=$e.substring(0,$e.indexOf("}")+1),$e+="}");try{var Xi=fj.a.oi($e);Xi.Error&&Ua.BNa(Pg,yd,"Pipeline error",Xi.Error.Code,Xi.Error.Message)}catch(ol){Ua.BNa(Pg,yd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Ua.BNa(Pg,yd);else Ua.BNa(Pg,yd,"Server error",ag,Nf);var vj=(Xi=Jh.SheetMultiRange)?Xi.SheetName:
null;$e=Jh.ActiveChartId;var qj=Jh.SelectionState;ag=5===qj&&!!Xi||6===qj||7===qj||8===qj;if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Ua.$.Ab.QC&&ag)Ua.Ae.yf(ae.a.UCc,ka),Te.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",qj.toString()));else if(5===qj&&Xi){if(Ua.$.xa&&vj)if(Ua.$.xa.yj(vj))Ua.ATc(vj);else{var Xj=null;Xj=function(){Ua.$.xa.yj(vj)&&(Te.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Ua.ATc(vj),
Ua.$.xa.Xab(Xj))};Ua.$.xa.CYa(Xj);if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Yk=null;Yk=function(){Ua.$.xa.yj(vj)&&(Ua.ATc(vj),Ua.$.xa.Oma(Yk))};Ua.$.xa.Vga(Yk)}}}else if(6===qj||7===qj||8===qj||9===qj){if(Xi){var Yi=hi.g(Xi.Ranges);if(vj&&hi.cb(Yi,!0))if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Ua.$.xa.yj(vj)){var Zk=null;Zk=function(){Ua.zeg(J,Yi,vj,qj);Ua.$.xa.Oma(Zk)};
Ua.$.xa.Vga(Zk)}else Ua.zeg(J,Yi,vj,qj)}7===qj?($e="38.{"+ck.c($e)+"}",yk.a(Ua.$).jna(0,$e,!0)):8===qj&&yk.a(Ua.$).jna(2,$e,!0);9===qj&&(Ua.$.ya.ApiCallToSetPageLayout=!0)}Jh.PostProcessActions?Ua.$.Hgf?(Pg=fj.a.oi(Jh.PostProcessActions),Ua.o0i(Pg).then(function(){Ua.acb(Jh,ka);Ua.Zad(G.DdaMethod.ControlId,C);return Promise.resolve(null)},function(ol){Ua.acb(Jh,ka,ol);return Promise.reject(ol)})):(Ua.BNa(Pg,yd,"Promise not supported",null,"Promise is not supported on this browser."),Ua.Ae.yf(ae.a.internalError,
ka)):Ua.acb(Jh,ka)}},function($e){Ua.fYf(we,!1,null);Ua.BNa(null,yd,"Web service error");ka($e)})};c.prototype.Zad=function(G,ka){var Ua=Object(Ci.a)(li.DdaFacade,Ij.a(this.$));(null===Ua||void 0===Ua?0:Ua.KLd)&&Ua.an(G)&&c.gyj(ka.RequestHeaders)&&(Te.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",G,ka.SolutionId),Ua.KLd.bmh(G))};c.prototype.hzh=function(G,ka){var Ua=this,e=this.Xe.pZ(G.DdaMethod.ControlId),
C=li.DdaFacade.getSolutionId(e,this.$),J=null;J=li.DdaFacade.Tua(e,this.$);J=new I(J,this.$);J=new d(C,G.DdaMethod.ControlId,this.Xe,this.$,J);var ja={ResponseHeaders:[]};ja.ResponseBody=Array(1);e=c.J_e(G.ArrayData[3]);var Aa=c.O2e(e);e=new ia(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.nsf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(J,ea,e,G.ArrayData).then(function(gb){if(!gb)return Ua.oud(!1,"The rich api executor call failed",Aa),Te.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),
ja.ResponseStatusCode=500,Ua.acb(ja,ka),null;Ua.oud(!0,"The rich api executor call succeeded",Aa);ja.ResponseStatusCode=gb[0];ja.ResponseBody[0]=gb[2];Ua.acb(ja,ka);return null},function(gb){ja.ResponseStatusCode=400;ja.ResponseBody[0]=gb.toString();Ua.oud(!1,"The rich api executor call failed",Aa);Te.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",C);Ua.acb(ja,ka);return null})};c.prototype.fYf=function(G,ka,Ua){c.dDd--;G=rl.a(zh.a.Ra,G);Te.ULS.sendTraceTag(36763356,
0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",G,c.dDd,ka?"success":"false",Ua)};c.prototype.acb=function(G,ka,Ua){Ua=void 0===Ua?null:Ua;var e=Array(3);e[0]=G.ResponseStatusCode;e[1]=c.RZh(G.ResponseHeaders);var C=[],J=!1;if(Ua&&G.ResponseBody){var ja=fj.a.oi(G.ResponseBody.join(""));ja.Error||(J={},J.Error=Ua,J.TraceIds=ja.TraceIds,J.ProcessedResults={},J.ProcessedResults.Results=ja.Results,C[0]=fj.a.Lc(J),J=!0)}e[2]=
J?C:G.ResponseBody;G=this.Ae.oQ();G.Data=e;ka(G)};c.prototype.exd=function(G,ka){(new T(this.$,this.Ae,this.Qz)).exd(G,ka)};c.prototype.cBi=function(G,ka){Te.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Ua=G[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],e=G[ug.a.EVc],C=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];G=this.$.da.Aa(232).k1a.dBi(G.DdaMethod.ControlId,Ua,e,C);G===ae.a.success?this.Ae.Nu(ka):(Te.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),
this.Ae.yf(G,ka))};c.prototype.ZAi=function(G,ka){Te.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Ua=G[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],e=G[ug.a.EVc],C=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).k1a.zoj(G.DdaMethod.ControlId,Ua,e,C);this.Ae.Nu(ka)};c.prototype.getAccessToken=function(G,ka){function Ua(J,ja){if(J===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)J=e.Ae.oQ(),J[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=
ja.accessToken,ka(J);else{ja=e.Xe.pZ(G.DdaMethod.ControlId);var Aa=null!==ja.OwnerAddinSolutionId?ja.OwnerAddinSolutionId:ja.PrimaryMarketplace.MarketplaceType,gb={};Te.ULS.sendTraceTag(537163202,0,10,"{0}.",(gb.errorCode=J.toString(),gb.appId=Telemetry.PrivacyRules.GetAssetId(Aa,ja.PrimaryMarketplace.MarketplaceRef,li.DdaFacade.getSolutionId(ja,e.$)),gb.storeType=Aa,gb));e.Ae.yf(J,ka)}}var e=this;Te.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var C=!dg.EwaSettings.la(24);Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.create(this.$.da,
137,this.$.ma,1),function(J){var ja=e.Xe.Ii,Aa=pa.getInstance();Xa.AppsForOfficeSingleSignOnManager.getInstance(ja,J.result,Aa).getAccessToken(G.DdaMethod.ControlId,C,G,Ua)},this.$.ma)};c.prototype.getAuthContext=function(G,ka){var Ua=this;Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,1),function(){var e=Ua.Xe.Ii.getOsfControl(G.DdaMethod.ControlId);if(!dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||e.isFirstParty()){e=e.getManifest();
var C=e.getMarketplaceID(),J=e.getWebApplicationId(),ja=e.getWebApplicationMsaId();oi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(C).then(function(Aa){var gb=Ua.Ae.oQ(),bc={};bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=J;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ja||J;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Aa.upn;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Aa.userId;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=
Aa.authority;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=hg.DKh(Aa.authorityType);bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Aa.isAnonymous;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Aa.tenantId;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Aa.supportsAuthToken;gb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=bc;ka(gb)},function(Aa){var gb=Ua.Ae.oQ(),bc={},Mc=new hg;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
J;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ja||J;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Mc.upn;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Mc.userId;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Mc.authority;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Mc.authorityType;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Mc.isAnonymous;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
Mc.tenantId;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Aa;bc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Mc.supportsAuthToken;gb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=bc;gb.Error=1;ka(gb)})}},this.$.ma)};c.prototype.vhi=function(G){var ka=Qi.g(this.$).ha;return 16===ka.We&&!!ka.Pa.mc&&!!ka.Pa.mc.floatingObject&&Hj.a.equals(ka.Pa.mc.floatingObject.id,G,!0)};c.prototype.$dd=function(G){var ka=Qi.g(this.$).ha;return ka.va.qh?1===
ka.We||this.vhi(G)?ka.pia:null:null};c.prototype.eic=function(G,ka){return 1!==G&&2!==G&&3!==G?(this.Ae.yf(ae.a.sAe,ka),!1):!0};c.prototype.oud=function(G,ka,Ua){var e={};e.a=this.$.ya.UserSessionId;e.b=G;e.c=ka;e.d=null;e.e=Ua;bl.b().Qe(37,e)};c.prototype.BNa=function(G,ka,Ua,e,C){Ua=void 0===Ua?null:Ua;e=void 0===e?null:e;C=void 0===C?null:C;var J={};G&&(J.ServerCorrelationId=G);void 0!==ka&&null!==ka&&(J.Source=ka);Ua&&(J.ErrorType=Ua);e&&(J.MessageId=e);C&&(J.StatusDescription=C);Te.ULS.sendTraceTag(50688452,
0,50,fj.a.Lc(J))};c.prototype.o0i=function(G){for(var ka=new Promise(function(e){e(null)}),Ua=0;Ua<G.length;Ua++)ka=this.n0i(ka,G[Ua]);return ka};c.prototype.n0i=function(G,ka){var Ua=this;if(!ka)return Te.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),G.then(function(){return Promise.reject(c.c3a(D.generalException,gf.a.instance.fa(1715),null))});switch(ka.actionType){case 1:case 2:G=G.then(function(){var e=Object(Ci.a)(li.DdaFacade,Ij.a(Ua.$));if(e.an(ka.controlId))switch(e.fj.O3h(ka),
ka.messageType){case 14:case 100:e.JLd.I_b(ka);break;case 11:case 12:e.Hjj.qob(ka);break;case 51:case 52:e.Fjj.qob(ka);break;case 2101:case 2102:e.Gjj.qob(ka);break;case 2E3:e.Ijj.I_b(ka);break;case 2201:Ua.$.Lka&&e.KLd.pMg(ka);break;case 2203:e.Jjj.qMg(ka);break;case 2700:dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&e.ILd.I_b(ka)}else Te.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",ka.controlId);return Promise.resolve(null)});break;case 3:G=
G.then(function(){Ua.C3h(ka);return Promise.resolve(null)});break;case 15:dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(G=G.then(function(){Ua.c5h(ka);return Promise.resolve(null)}));break;case 4:G=G.then(function(){if(dg.EwaSettings.la(105)){var e=Qi.g(Ua.$).ha.va.activeCell;e.top!==ka.row+1&&e.left!==ka.column+1&&(e=hi.v(Zf.Range.ld(ka.row+1,ka.column+1),Ua.$),Qi.g(Ua.$).Ug(e,null,null,null,3,kj.a.Sbh));ek.a(Ua.$,243,242,0,function(C){C.GKb(ka.row+1,ka.column+1,1,!1,!1)})}return Promise.resolve(null)});
break;case 7:G=G.then(function(){Object(Ci.a)(li.DdaFacade,Ij.a(Ua.$)).fj.rLe(ka.controlId,ka.isEnableEvents);return Promise.resolve(null)});break;case 5:G=G.then(function(){return Ua.oah(ka)});break;case 6:G=G.then(function(){return Ua.BWi(ka)});break;case 8:G=G.then(function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(Ci.a)(li.DdaFacade,Ij.a(Ua.$)).eYg();var e=new tl.a(sl.a.Ak,5,null);nl.a(Ua.$).jt(e);return Promise.resolve(null)});
break;case 9:G=G.then(function(){return Ua.iqj(ka)});break;case 10:G=G.then(function(){return Ua.YYj(ka)});break;case 11:G=G.then(function(){return Ua.XYj()});break;case 12:G=G.then(function(){return Ua.UYj()});break;case 13:G=G.then(function(){return Ua.VYj(ka)});break;case 14:G=G.then(function(){return Ua.WYj(ka)});break;case 16:G=G.then(function(){return Promise.resolve(ka)});break;case 17:G=G.then(function(){return Ua.xmj(ka,Object(Ci.a)(li.DdaFacade,Ij.a(Ua.$)))});break;case 18:Qi.g(this.$).focus();
break;case 19:this.e6e(ka.entryType,!1,ka.options);break;case 20:this.e6e(ka.entryType,!0,ka.options);break;default:G=G.then(function(){return Promise.reject(c.c3a(D.LJg,gf.a.instance.fa(1716),null))})}return G};c.prototype.c5h=function(G){var ka=Object(Ci.a)(li.DdaFacade,Ij.a(this.$)).an(G.controlId);if(ka&&!(0===G.operationType^!ka.xda)){Qi.g(this.$).yhc=!0;switch(G.operationType){case 0:var Ua=new gl.a(document.createElement("input"));Ua.text=G.range;ka.hci(Qi.g(this.$).Gh.J9g(Ua,new ql.a(this.$)));
ka.xda.startEdit(!0);break;case 1:ka.bQf();this.rangePicker=null;break;case 2:ka.xda.Oeg(G.range);break;case 3:ka.xda.Oeg(G.startingRange);ka=G.expandSelection;Ua=G.getNextDataRegionCell;var e=0;switch(G.keyboardDirectionValue){case 2:e=38;G=ka&&Ua?105288353:ka?-31900117:Ua?542791952:137938150;break;case 3:e=40;G=ka&&Ua?-1297307319:ka?-1603798598:Ua?1713663844:-798660877;break;case 0:e=37;G=ka&&Ua?-403586027:ka?2039316657:Ua?-2012742350:-1470715894;break;case 1:e=39;G=ka&&Ua?784916030:ka?589730764:
Ua?1324884057:-1231471547;break;default:G=1461300262}ka=this.g4b("keydown",e,ka,Ua);Qi.g(this.$).aIb(ka,new Wf.a(G,1,0,8,null))}Qi.g(this.$).yhc=!1}};c.prototype.g4b=function(G,ka,Ua,e){var C=document.createEvent("KeyboardEvent");if(dj.a.qF)C.initKeyboardEvent(G,!1,!1,window.self,"A",0,e,!1,Ua,!1);else{var J="";Ua&&(J+="Shift");e&&(J+=0<J.length?" Control":"Control");C.initKeyboardEvent(G,!1,!1,window.self,"A",0,J,!1,"en-US")}G=new Sys.UI.DomEvent(C);G.keyCode=ka;return G};c.prototype.C3h=function(G){switch(G.operationType){case 1:Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.create(this.$.da,
153,this.$.ma,1),function(ka){ka.result.GKd()},this.$.ma,3);break;case 2:if(G=Object(Ci.a)(li.DdaFacade,Ij.a(this.$)).an(G.controlId))G.upd=!0,G.vKf()}};c.prototype.oah=function(G){var ka=this,Ua=G.fileBase64;return Ua&&Ua.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.c3a(D.invalidArgument,gf.a.instance.fa(1719),"Application.CreateWorkbook")):(new Promise(function(e,C){var J=new jd.StandardDialog;J.kc=4;J.Ik(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,
1,function(ja){2!==ja&&0!==ja||C(c.c3a(D.hCd,gf.a.instance.fa(1718),"Application.CreateWorkbook"));ja=new qa("blank","agave",Ua?"streamBase64":"streamEmpty",Ua);ka.nsf.create(e,C,ja).x0a()})})).then(function(e){ka.S8b.set(G.fakeFileId,e);return Promise.resolve(null)},function(e){return e?Promise.reject(e):Promise.reject(c.c3a(D.generalException,gf.a.instance.fa(1715),"Application.CreateWorkbook"))})};c.prototype.BWi=function(G){var ka=this;return new Promise(function(Ua,e){if(ka.S8b.has(G.fakeFileId)){var C=
ka.S8b.get(G.fakeFileId);e=new jd.StandardDialog;e.kc=4;e.Ik(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(J){1===J&&th.HelperMethods.vf(C,void 0,void 0,"DdaMethodHandler.fileUrl");Ua(null)})}else e(c.c3a(D.generalException,gf.a.instance.fa(1715),"Document.Open"))})};c.prototype.iqj=function(G){var ka=this;return new Promise(function(Ua){Object(Ci.a)(li.DdaFacade,Ij.a(ka.$)).KUf=G.runtimeCalculationMode;var e=ka.$.da.Aa(268);e&&e.eyd(3===G.runtimeCalculationMode);
Ua(null)})};c.prototype.YYj=function(G){yi.a.Rzb(this.$)&&this.$.da.Aa(331).bcb(0,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.XYj=function(){yi.a.Rzb(this.$)&&this.$.da.Aa(331).bcb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.UYj=function(){yi.a.Rzb(this.$)&&this.$.da.Aa(331).oLe();return Promise.resolve(null)};c.prototype.VYj=function(G){yi.a.Rzb(this.$)&&this.$.da.Aa(331).bcb(5,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.WYj=function(G){if(yi.a.Rzb(this.$)){var ka=
this.$.da.Aa(331);ka=yl(ka.laa);for(var Ua=ka.next();!Ua.done;Ua=ka.next())Ua=Ua.value,Ua.IsActive&&Ua.HostEditUrl&&Ua.UrlStr===G.hostEditUrlStr&&th.HelperMethods.vf(Ua.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.xmj=function(G,ka){var Ua=Ie.a.YW;G=fj.a.oi(G.payload);var e={};"eventId"in G&&"payload"in G&&(e.eventId=G.eventId,e.payload=G.payload);ka.UM(2201,Ua,fj.a.Lc(e));return Promise.resolve(null)};c.prototype.e6e=function(G,ka,Ua){var e=this.$.da.Aa(5);e&&(G=this.uLh(G))&&
(ka?e.removeEntry(G):e.nme(G,Ua))};c.prototype.uLh=function(G){switch(G){case 0:return 63}};c.prototype.ATc=function(G){G=Object(Ci.a)(Wk.a,this.$.xa.getItemByName(G));(null===G||void 0===G?0:G.visible)&&G.activate(!0)};c.prototype.zeg=function(G,ka,Ua,e){var C=G.va.$A,J=C<ka.length&&ka[C].contains(G.va.activeCell);G=J?G.va.activeCell:ka[0].topLeft;C=J?C:0;Qi.g(this.$).sV(ka,C,Ua,null,G,null,null,3,kj.a.Tbh,void 0,void 0,void 0,6===e)};c.J_e=function(G){if(!G||!G.length)return null;for(var ka=Array(G.length/
2),Ua=0;Ua<G.length/2;Ua++)ka[Ua]={},ka[Ua].Name=G[2*Ua],ka[Ua].Value=G[2*Ua+1];return ka};c.RZh=function(G){if(!G||!G.length)return null;for(var ka=Array(2*G.length),Ua=0;Ua<G.length;Ua++)ka[2*Ua]=G[Ua].Name,ka[2*Ua+1]=G[Ua].Value;return ka};c.kbd=function(G){if(!G||!G.length)return null;for(var ka=Array(G.length),Ua=0,e=G.length;Ua<e;Ua++){var C=G[Ua].length;if(C){ka[Ua]=Array(C);for(var J=0;J<C;J++)ka[Ua][J]=null==G[Ua][J]?null:G[Ua][J].toString()}else return null}return ka};c.o2b=function(G){return"string"===
typeof G?wk.a.Rn(c.Obh,G,0):G};c.JTe=function(G){return"string"===typeof G?wk.a.Rn(c.Rbh,G,0):G};c.Wfg=function(G){return"string"===typeof G?wk.a.Rn(c.Vbh,G,0):G};c.Fhi=function(G){switch(G.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};c.HYc=function(G,ka){var Ua={};Ua.CoerceType=G;1===Ua.CoerceType?(Ua.Data=c.kbd(ka.Rows),Ua.Headers=c.kbd(ka.Headers)):Ua.Data=c.kbd(ka);return Ua};c.Que=function(G){if(1===G.CoerceType){var ka={};return ka.Headers=
G.Headers,ka.Rows=G.Data,ka}return G.Data};c.jfc=function(G){return 1===G.CoerceType?!G.Data&&!G.Headers:!G.Data};c.O2e=function(G){var ka="Unknown";if(!G)return ka;for(var Ua=0;Ua<G.length;Ua++)if(G[Ua].Name.toLowerCase()===lj.a.Kjj){ka=G[Ua].Value;break}return ka};c.gyj=function(G){if(!G)return!1;for(var ka=lj.a.rGi.toLowerCase(),Ua=0;Ua<G.length;Ua++)if(G[Ua].Name.toLowerCase()===ka)return!0;return!1};c.c3a=function(G,ka,Ua){var e={};e.Code=G;e.Message=ka;e.Location=Ua;e.ActionIndex=0;return e};
Qk.Object.defineProperties(c.prototype,{IQ:{configurable:!0,enumerable:!0,get:function(){return this.Ae}}});Qk.Object.defineProperties(c,{Obh:{configurable:!0,enumerable:!0,get:function(){c.Fpa||(c.Fpa={},c.Fpa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.Fpa[Microsoft.Office.WebExtension.CoercionType.Text]=2,c.Fpa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.Fpa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.Fpa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return c.Fpa}},
Rbh:{configurable:!0,enumerable:!0,get:function(){c.vhb||(c.vhb={},c.vhb[Microsoft.Office.WebExtension.FilterType.All]=1,c.vhb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.vhb}},Vbh:{configurable:!0,enumerable:!0,get:function(){c.whb||(c.whb={},c.whb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,c.whb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.whb}}});c.Fpa=null;c.vhb=null;c.whb=null;c.dDd=0;Object(de.a)(c,"DdaMethodHandler",null,[239,2]);var Pk=
Aj.a;vm(a,Pk);a.prototype.Pd=function(){var G=this,ka=aj.GetServiceTaskFactory.create(this.$.da,106,this.ma,this.ub),Ua=aj.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.ub),e=qb(this.ma,this.ub);Fh.TaskExtensions.Ba(Fh.TaskExtensions.we([ka,Ua,e],this.ma),function(){var J=ka.result,ja=oi.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");G.Gd([new c(G.$,J,ja)])},this.ma,3);var C=oi.a.instance;Fh.TaskExtensions.Ba(aj.GetServiceTaskFactory.create(this.$.da,
137,this.$.ma,this.ub),function(){C.register(Na,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Cc().Mc(function(){return new Na})},this.$.ma)};a.ka=function(G){Aj.a.he(82,new a(G))};Object(de.a)(a,"DdaCommandHandlerFactory",Aj.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");
Type.registerNamespace("_Ewa");Vi.a.Zi("");Vi.a.Zi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=dk.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");ic.main();(function(){Yg.a.Ga(function(G){rg.ka(G)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){Yg.a.Ga(function(G){mf.ka(G);Vb.ka(G)})})();(function(){Yg.a.Ga(function(G){Cd.ka(G)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){Yg.a.Ga(function(G){dg.EwaSettings.la(54)&&dc.ka(G)})})();(function(){Yg.a.Ga(function(G){dg.EwaSettings.la(122)&&Kb.ka(G)})})();Yg.a.Ga(Ub.ka);Yg.a.Ga(rd.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){Yg.a.Ga(function(G){Ec.ka(G);
Ja.ka(G)})})();Yg.a.Ga(a.ka)},1413:function(y,F,b){function a(){this.mEc=null;this.YIc=0;this.DKc=!1;this.rb=new l.a;this.Iqg=new d.a}function c(){this.oKe=this.displayName=this.Eqb=this.Ao=this.nB=null;this.isUpgraded=!1}y=b(0);var d=b(185),l=b(93);c.prototype.rhf=function(n,m){return this.nB.getStoreType().toLowerCase()===n.toLowerCase()&&this.nB.getSolutionId().toLowerCase()===m.toLowerCase()};Object(y.a)(c,"AddinCommandsResourceItem",null,[]);b.d(F,"a",function(){return a});a.prototype.RDg=function(n){this.rb.addHandler("AddinCommandsLoadingMessageChanged",
n)};a.prototype.ybj=function(n){this.rb.removeHandler("AddinCommandsLoadingMessageChanged",n)};a.prototype.Dcb=function(n){n!==this.mEc&&(this.mEc=n,this.rb.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.eqj=function(){this.YIc++;this.LYa||this.Dcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Ivc=function(){this.YIc--;this.Gtd()&&(this.DKc?this.LYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Dcb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Dcb(null))};a.prototype.MZf=
function(n){this.DKc=!0;this.Dcb((void 0===n?0:n)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.Oye=function(){this.DKc=!1;this.Gtd()?this.Dcb(null):this.Dcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Gtd=function(){return 0>=this.YIc};a.prototype.Yia=function(n,m,f){f=void 0===f?0:f;for(var v=yl(this.z5a),w=v.next();!w.done;w=v.next())if(w=w.value,w.rhf(n,m)&&(!w.Ao||w.Ao.bJh===f))return w;return null};a.prototype.gme=
function(n,m,f,v){var w=new c;w.nB=n;w.Ao=m;w.Eqb=f;w.displayName=v;this.z5a.add(w)};a.prototype.XBg=function(n,m,f,v){var w=new c;w.nB=n;w.Ao=m;w.Eqb=null;w.oKe=f;w.displayName=v;this.z5a.add(w)};a.prototype.aaj=function(n,m){for(var f=0,v=yl(this.z5a),w=v.next();!w.done;w=v.next())w=w.value,w.nB.getStoreType()===n&&w.nB.getSolutionId()===m?this.z5a.removeAt(f):f++};a.getInstance=function(){a.Oa||(a.Oa=new a);return a.Oa};Qk.Object.defineProperties(a.prototype,{LYa:{configurable:!0,enumerable:!0,
get:function(){return this.mEc}},z5a:{configurable:!0,enumerable:!0,get:function(){return this.Iqg}}});a.Oa=null;Object(y.a)(a,"AddinCommandsResourceManager",null,[])},858:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.dCa="Alt";a.sUa="Command";a.fCa="Enabled";a.FDc="GroupId";a.id="Id";a.gCa="Image16by16";a.v0d="Image32by32";a.y0d="Keytip";a.egb="LabelText";a.Voa="Size";a.J0d="TemplateAlias";a.Uea="Title";a.G0d="Tab";a.KDc="Scaling";a.IDc="MaxSize";a.JDc="Scale";a.GROUP="Group";
a.cgb="Groups";a.tUa="Controls";a.I0d="Template";a.button="Button";a.tZ="FlyoutAnchor";a.LARGE="Large";a.pPb="Medium";a.SMALL="Small";Object(y.a)(a,"DataNodeWrapper",null,[])},859:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);var c=b(32);a.ZVe=function(d){return c.a.Rn(a.aBi,d.toString(),a.internalError)};Qk.Object.defineProperties(a,{aBi:{configurable:!0,enumerable:!0,get:function(){var d={};return a.mbe||(a.mbe=(d["-2002156328"]=a.sAe,d["-1954750170"]=a.h3e,d["317650254"]=
a.ZZg,d["-1005263101"]=a.oei,d["1353664579"]=a.Snj,d["159671765"]=a.pei,d["1446690022"]=a.mZe,d["1150069548"]=a.NAc,d["-1409306331"]=a.fxe,d["338507772"]=a.mGe,d["-457159301"]=a.vXi,d["-1037701970"]=a.pbh,d["-1893322318"]=a.uei,d["965579896"]=a.rbh,d["93287890"]=a.qbh,d["358088857"]=a.Qqj,d["-1223650923"]=a.mGe,d["2007306190"]=a.UVg,d["1549955423"]=a.Ute,d["-1275974171"]=a.tei,d["382101082"]=a.EWi,d["-898776235"]=a.RCi,d["335464256"]=a.GCi,d["1677378049"]=a.sei,d["-261992848"]=a.$Pj,d["-980820954"]=
a.Ute,d["-931375837"]=a.DWi,d["929186550"]=a.Ajh,d["-982144310"]=a.n3i,d["-785741187"]=a.mei,d["2125217573"]=a.wei,d["299124955"]=a.nei,d["1669853884"]=a.Zjj,d["-1515932330"]=a.$Zg,d["314621024"]=a.AFh,d["-300049690"]=a.YVg,d["14766835"]=a.Xvj,d["-1251992761"]=a.sJe,d["-2087635043"]=a.invalidOrTimedOutSession,d["2100961153"]=a.invalidOrTimedOutSession,d["-1218744139"]=a.invalidSheetName,d["-1468309555"]=5006,d["-315732528"]=a.invalidOrTimedOutSession,d["611268539"]=a.invalidOrTimedOutSession,d["1531005923"]=
5006,d["1593924569"]=5006,d["299476328"]=a.mFa,d["49173765"]=a.mFa,d["-907155566"]=a.mFa,d["-1201603824"]=a.mFa,d["1541165282"]=a.mFa,d["-1347753427"]=a.mFa,d["134912532"]=a.mFa,d["1780971550"]=a.responsePayloadSizeLimitExceeded,d))}}});a.success=0;a.sAe=1E3;a.h3e=1001;a.ZZg=1002;a.oei=1003;a.Snj=1004;a.pei=1005;a.mZe=1008;a.xTe=1009;a.invalidSheetName=1014;a.NAc=2E3;a.fxe=2001;a.mGe=2002;a.vXi=2003;a.pbh=2004;a.uei=2005;a.rbh=2007;a.qbh=2008;a.Qqj=2009;a.UVg=2014;a.znj=3E3;a.Ute=3002;a.tei=3004;
a.EWi=3005;a.RCi=3006;a.GCi=3007;a.sei=3008;a.$Pj=3009;a.DWi=3010;a.Xvj=4002;a.kCd=5E3;a.internalError=5001;a.sJe=5002;a.Rxb=5004;a.aRj=5007;a.f$h=5008;a.APg=5009;a.invalidOrTimedOutSession=5012;a.UCc=5016;a.mFa=5102;a.Sgj=5103;a.responsePayloadSizeLimitExceeded=5104;a.nVg=7001;a.c6f=7002;a.Ajh=8E3;a.n3i=8001;a.mei=8010;a.wei=8011;a.nei=8012;a.Zjj=8020;a.$Zg=8021;a.AFh=8022;a.YVg=8023;a.vAi=11E3;a.HDi=11001;a.vei=11002;a.mbe=null;Object(y.a)(a,"DdaErrorIds",null,[])},860:function(y,F,b){function a(){}
b.d(F,"a",function(){return a});y=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.cTc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.hCd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.dRj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.WHg="AddinIsAlreadyRequestingToken";a.tij="ResourceNotAllowed";
a.clientError="ClientError";a.serverError="ServerError";a.P2g="ControlIdNotFound";a.kjj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(y.a)(a,"ErrorCodes",null,[])},862:function(y,F,b){function a(ob,Ic){var Cc=Xe.call(this)||this;Cc.ea=null;Cc.Om=null;Cc.di=null;Cc.Ff=[];Cc.IIa=null;Cc.RFe=!1;Cc.xOb=!1;Cc.initialized=!1;Cc.disposed=!1;Cc.PBa=null;Cc.Goc=[];Cc.MFe=[];
Cc.iPa=[];Cc.Z0a=null;Cc.oDd=new rd.a($b.a.Gk());Cc.hZb=new Wb.a($b.a.Gk());Cc.XEb=[];Cc.AHf=[];Cc.x5b=350;Cc.bfa=null;Cc.mxa=null;Cc.NSc=!1;Cc.wfe=null;Cc.tfe=null;Cc.xfe=null;Cc.vfe=null;Cc.zfe=null;Cc.nvg=null;Cc.ufe=null;Cc.yfe=null;Cc.Afe=null;Cc.Bfe=null;Cc.Cfe=null;Cc.Mf=function(){Cc.PBa=Cc.ea.Cm.WebExtensions;for(var Uc=Cc.Ff.length-1;0<=Uc;--Uc){var Tc=Cc.Ff[Uc],ce;if(ce=!Cc.nDh(Tc.controlId))ce=Tc,ce=mb.EwaSettings.la(122)?!ce.SHa:!0;ce&&(Tc.Fmc(),Array.removeAt(Cc.Ff,Uc))}if(Cc.PBa)for(Uc=
0,Tc=Cc.PBa.length;Uc<Tc;Uc++){ce=Cc.PBa[Uc];var ye=Cc.an(ce.WebExtensionId);ye&&ye.OAd(ce)}};Cc.fma=function(Uc){Cc.raiseEvent("csc",Uc.getID())};Cc.jBf=function(Uc,Tc,ce){if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&Tc===OSF.AgaveHostAction.KeyboardShortcuts){var ye=Object(lc.a)(Object,ce);Tc={};Tc.keyCode=ye.keyCode;Tc.type="keydown";Tc.ctrlKey=ye.ctrlKey;Tc.shiftKey=ye.shiftKey;Tc.altKey=ye.altKey;Tc.metaKey=ye.metaKey;Uc=Cc.an(Uc);ye=Uc.jha;Tc.srcElement=
Object(Oa.a)(222,ye)?ye.RFa:kc.g(Cc.$).Kb;Tc=new Sys.UI.DomEvent(Tc);Uc={focusedAddinId:a.Tua(Uc.dl,Cc.$)};ye=new od.a(1461300262,1,Cc.$.hd,6,null);kc.g(Cc.$).aIb(Tc,ye,Uc)}else if(Tc===OSF.AgaveHostAction.Select)Cc.b6e(!0);else if(Tc===OSF.AgaveHostAction.UnSelect)Cc.b6e(!1);else if(Tc===OSF.AgaveHostAction.CancelDialog)Cc.hK(-684355545,null);else if(Tc===OSF.AgaveHostAction.InsertAgave)Uc={},ce&&(Uc[Za.a.KYa]=ce,Uc[ra.a.Tg]=a.grb(ce),Cc.hK(-741808261,Uc));else if(Tc===OSF.AgaveHostAction.InsertDevManifest)Uc=
{},ce&&(Uc[Za.a.KYa]=ce,Uc[ra.a.Tg]=a.grb(ce),Cc.hK(-741808261,Uc));else if(Tc===OSF.AgaveHostAction.InsertDevManifestError)Uc=Object(lc.a)(Object,ce),Tc={},Uc=(Tc[Za.a.DVc]=Cc.Om.getDevManifestInvalidUrlErrorString(Uc.manifestUrl),Tc),Cc.hK(-2025863019,Uc);else if(Tc===OSF.AgaveHostAction.NotifyHostError)Uc={},Uc=(Uc[Za.a.DVc]=Cc.Om.getManifestInvaildErrorString(),Uc),Cc.hK(-2025863019,Uc);else if(Tc===OSF.AgaveHostAction.RefreshAddinCommands)mb.EwaSettings.la(54)&&Cc.hK(Ce.a.refreshAddinCommands,
null);else if(Tc===OSF.AgaveHostAction.CtrlF6Exit||Tc===OSF.AgaveHostAction.CtrlF6ExitShift){if(ye=Cc.$.da.Aa(15)){(Uc=Cc.an(Uc).jha)&&Uc.xyc();Db.a.Df&&document.activeElement.blur();var Kf={keyCode:117,type:"keydown",ctrlKey:!0};Kf.shiftKey=Tc===OSF.AgaveHostAction.CtrlF6ExitShift;Kf.srcElement=Object(Oa.a)(222,Uc)?Uc.RFa:kc.g(Cc.$).Kb;Uc=new Sys.UI.DomEvent(Kf);ye.jW(Uc)}}else if(Tc===OSF.AgaveHostAction.PageIsReady){if((Uc=Cc.an(Uc).jha)&&Uc.RYa===OSF.OsfControlTarget.TaskPane&&(Uc=Cc.$.da.Aa(183))&&
Cc.Ff)for(Tc=Nb.a.Ld(Cc.$),ye=yl(Cc.Ff),Kf=ye.next();!Kf.done;Kf=ye.next())a.SLa(Kf.value.uU)&&(Tc?Uc.Oe(!0,!1):Uc.setFocusOnToolbarFirstElement())}else if(Tc===OSF.AgaveHostAction.TabExit){Tc=Cc.an(Uc);var yf=Tc.jha;if(yf)if(yf.RYa===OSF.OsfControlTarget.InContent)yf.Jjf();else{if(yf.RYa===OSF.OsfControlTarget.TaskPane)if(Nb.a.Ld(Cc.$))Db.a.Df&&document.activeElement.blur(),ub.UISurfaces.Fk().then(function(Qc){var Dd=Object(Oa.a)(222,yf)?yf:null;Dd?Dd.isResizable?Qc.focusResizeHandle():Qc.focusTabbedTaskPaneArea():
Qc.focusTabbedTaskPaneArea();return null});else if(Uc=Cc.$.da.Aa(183))Db.a.Df&&document.activeElement.blur(),(Tc=document.getElementById(Cc.$.Jb+Kb.a.Qlc))&&ld.DOMElementExtensions.isVisible(Tc)?ld.DOMElementExtensions.setFocus(Tc):Uc.setFocusOnToolbarFirstElement()}else Tc&&4===Tc.osfControlType&&Cc.Om.notifyAgave(Uc,OSF.AgaveHostAction.TabIn)}else if(Tc===OSF.AgaveHostAction.TabExitShift)(Tc=Cc.an(Uc),ye=Tc.jha)?ye.RYa===OSF.OsfControlTarget.InContent?ye.Kjf():ye.RYa===OSF.OsfControlTarget.TaskPane&&
(Uc=Object(Oa.a)(222,ye)?ye:null)&&(Db.a.Df&&document.activeElement.blur(),Uc.WZf()):Tc&&4===Tc.osfControlType&&Cc.Om.notifyAgave(Uc,OSF.AgaveHostAction.TabIn);else if(Tc===OSF.AgaveHostAction.EscExit||Tc===OSF.AgaveHostAction.ExitNoFocusable||Tc===OSF.AgaveHostAction.ExitNoFocusableShift)if(ye=Cc.an(Uc).jha)ye.xyc();else{if(Tc===OSF.AgaveHostAction.EscExit){Tc=null;ye=yl(fa.I1h());for(Kf=ye.next();!Kf.done;Kf=ye.next())if(Kf=Kf.value,Kf.value.Ve===Uc){Kf.value.dialog.hide();Tc=Kf.key;break}Tc&&(Uc=
Cc.an(Tc))&&4!==Uc.osfControlType&&Cc.Ii.notifyAgave(Tc,OSF.AgaveHostAction.TabIn)}}else if(Tc===OSF.AgaveHostAction.InstallCustomFunctions)if(mb.EwaSettings.la(122)){Yd.a(Cc.$).wVe(function(){return!1});var Pf=Cc.$.da;sa.TaskExtensions.Ba(Jc.GetServiceTaskFactory.Wa(Pf,278,279,1),function(Qc){Qc=Qc.result;Pf.Aa(278)||Pf.Ha(278,Qc);var Dd=ce.osfControl.getStoreType();Qc.ubf(ce.osfControl.getSolutionId(),Dd,a.dOh(ce.osfControl),ce).cna()},Cc.ma,3)}else Ia.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");
else if(Tc===OSF.AgaveHostAction.UninstallCustomFunctions)if(mb.EwaSettings.la(122)){Yd.a(Cc.$).wVe(function(){return!1});var ec=Cc.$.da;sa.TaskExtensions.Ba(Jc.GetServiceTaskFactory.Wa(ec,278,279,1),function(Qc){Qc=Qc.result;ec.Aa(278)||ec.Ha(278,Qc);Qc.Sbg(ce.solutionId,ce.storeType).cna()},Cc.ma,3)}else Ia.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Tc===OSF.AgaveHostAction.SendTelemetryEvent?d(ce):Tc===
OSF.AgaveHostAction.SendCustomerContent?c(ce):Tc===OSF.AgaveHostAction.LaunchExtensionComponent?lb.a.instance.Qri(ce):Tc===OSF.AgaveHostAction.RefreshRibbonGallery?(Uc=Cc.$.da.Aa(352))&&Uc.Pcc(ce):Tc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(Cc.abj(ce.assetId),Nb.a.Ld(Cc.$)||(Uc=Cc.$.da.Aa(183))&&Uc.qp()):Tc===OSF.AgaveHostAction.GetOriginalControlId&&(Uc=new kb.a(Cc.$.Jb,ce.ownerAssetId,new dc.a,!0),ce.originalControlId=Uc?Uc.dGe(ce.controlId):ce.controlId)};Cc.vVi=function(){Cc.$.pa&&$d.p(Cc.$.pa)&&
Cc.$.da.Aa(34).Lld()};Cc.ud=function(){Cc.Jlf()};Cc.QR=function(Uc,Tc){var ce,ye;1===Tc.Aw&&(Uc=Tc.Og)&&(Tc=new n(Ac.toTimestamp(Uc.enqueueUtcTime),Ac.toTimestamp(Uc.processUtcTime),Ac.toTimestamp(Uc.dequeueUtcTime),Ac.getElapsedMilliseconds(Uc.enqueueUtcTime,Uc.processUtcTime),Ac.getElapsedMilliseconds(Uc.processUtcTime,Uc.dequeueUtcTime),Uc.operationCount,(null===(ye=null===(ce=Uc.operation)||void 0===ce?void 0:ce.vd)||void 0===ye?0:ye.ServerCorrelationId)?Uc.operation.vd.ServerCorrelationId:null,
Uc.operation?Enum.toString(Sd.a,Uc.operation.operationName):null,Wc.a.iF(Ac.getElapsedMilliseconds(Uc.enqueueUtcTime,Cd.a.Ra.Lb))),ce=Sys.Serialization.JavaScriptSerializer.serialize(Tc),Ia.ULS.sendTraceTag(50872916,0,50,ce))};Cc.dd=function(Uc,Tc){!Cc.ea.rc&&qf.a(Tc)?(Array.forEach(Cc.Ff,Cc.Qwf),Array.clear(Cc.Ff),Cc.xOb=!1):(Tc.EH&&(Ia.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),Cc.MTf()),Cc.nL(),mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(Cc.xOb=!1))};Cc.Gq=function(){mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Ia.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Cc.MTf());Cc.nL();mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Cc.xOb=!1)};Cc.Qwf=function(Uc){Uc.Fmc();Cc.raiseEvent("cd",Uc.controlId)};Cc.vb=ob;Cc.YVc=Ic;Cc.initialize();S.ka(Cc);Cc.KUf=0;(ob=(ob=!(Db.a.Wp||Db.a.Pwa))&&(!mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!Db.a.Df))&&OfficeExt.ShortcutKeyDispatchManager.init();Cc.Jqg={};return Cc}function c(ob){Sc.a.sendOtelCustomerContent(Object.assign(new Yc.a,{otelEvent:ob}))}function d(ob){Sc.a.sendOtelEvent(Object.assign(new Yc.a,{otelEvent:ob}))}function l(ob,Ic,Cc){var Uc=ee.call(this,Cc,ob)||this;Uc.hashCode=null;Uc.Cva=null;Uc.d3b=!1;Uc.Em=function(Tc,ce){ce.ed.hash===Uc.hashCode&&Uc.Cva&&Object(lc.a)(b(862).DdaFacade,Uc.$.da.Aa(35)).xBj(Uc.Cva.InstanceId)};Uc.Se=function(Tc,ce){switch(ce.ed.block.state){case 1:case 3:case 5:Uc.yna(ce)}};
Uc.Ig=function(){Uc.UFb(!0)};Uc.wo=function(Tc,ce){Uc.isVisible&&Uc.uTa(ce.kI);Uc.clearCache()};Uc.Re=function(Tc,ce){Uc.xSa(ce.pa,!!ce.kI)};Uc.RN=function(){Uc.$.ea.jma()};Uc.dUa=Ic;Uc.domElement.classList.add(be.a.o8b);Uc.domElement.classList.add(td.a.Sk);Cc.tabIndex=0;Uc.xSa(Uc.$.pa,!1);Uc.xc.ka("mousedown",Uc.RN);Uc.xc.ka("contextmenu",function(Tc){md.g(Tc)});Uc.$.xa.wJ(Uc.wo);Uc.$.zb.wJ(Uc.wo);Uc.$.zb.Qf(Uc.Re);Uc.$.xa.Qf(Uc.Re);Uc.Ca.rq(Uc.Se);Uc.Ca.IG(Uc.Em);Uc.Ca.Ep(Uc.Ig);mb.EwaSettings.tc()&&
Uc.$q(Uc.nya);return Uc}function n(ob,Ic,Cc,Uc,Tc,ce,ye,Kf,yf){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=ob;this.processUtcTime=Ic;this.dequeueUtcTime=Cc;this.inQueueDurationInMS=Uc;this.executionDurationInMS=Tc;this.operationCount=ce;this.ServerCorrelationId=ye;this.UserOperationName=Kf;this.IsDocumentHidden=
yf}function m(ob,Ic,Cc){this.$=ob;this.fj=Ic;this.runtimeCalculationMode=Cc}function f(){}function v(ob,Ic,Cc){var Uc=this;this.jGf=null;this.Yad=function(Tc,ce){var ye=Ve.a.YW,Kf={};Kf.eventId=Tc;Kf.payload=ce;Uc.fj.XZ(2201,ye)&&Uc.di.UM(2201,ye,Ne.a.Lc(Kf))};this.$=ob;this.fj=Ic;this.di=Cc;this.Lbi()}function w(ob,Ic,Cc){var Uc=this;this.DGb=0;this.qhg=!0;this.T9b=0;this.bqd=!0;this.rye=function(){var Tc=document.hasFocus();if(Uc.qhg!==Tc){if(Tc){var ce=Ne.a.Lc({});Uc.di.UM(2203,Ve.a.YW,ce)}Uc.qhg=
Tc}};this.sye=function(Tc){(0<Tc.timeRemaining()||Tc.didTimeout)&&Uc.rye();window.requestIdleCallback(Uc.sye)};this.$=ob;this.fj=Ic;this.di=Cc;window.requestIdleCallback||(this.bqd=!1)}function t(ob,Ic,Cc){var Uc=this;this.CGb=0;this.J$a=this.Q$a=null;this.rFf=function(){var Tc=kc.g(Uc.$).ha.Pa.oC;if(Tc)if(Uc.Tif(Tc)){var ce=Uc.wja();Uc.$ad(ce);Uc.Q$a=Tc.floatingObject.id;Uc.J$a=ce}else Uc.Q$a&&(Uc.$ad(Uc.J$a),Uc.Q$a=null,Uc.J$a=null);else Uc.Q$a&&(Uc.$ad(Uc.J$a),Uc.Q$a=null,Uc.J$a=null)};this.$=
ob;this.fj=Ic;this.di=Cc}function A(ob,Ic,Cc){var Uc=this;this.d2b=null;this.frd=!1;this.onPointerDown=function(Tc){if(3===Tc.yb){var ce=Uc.gridView.W$b(Tc.clientPoint).K_a;Uc.frd=!!ce&&Uc.gridView.ha.va.tJe(ce)}else Uc.frd=!1;Uc.d2b=Tc.clientPoint;return!1};this.$c=function(Tc){if(Uc.gridView.inRangePicker||Uc.gridView.Bi||Uc.frd||Tc.shiftKey||Tc.ctrlKey||Tc.Ea.button!==Sys.UI.MouseButton.leftButton||!Uc.d2b||!Tc.clientPoint||Tc.clientPoint.x!==Uc.d2b.x||Tc.clientPoint.y!==Uc.d2b.y)return!1;var ce=
Uc.gridView.W$b(Tc.clientPoint);Tc=ce.K_a;ce=ce.returnValue;var ye=Object(lc.a)(te.a,Uc.$.xa.pa);if(ce&&ye&&0===ye.yI){if(!Uc.gridView.ha.va.p4.contains(Tc))return!1;Tc=new x(ye,Tc,Zc.HelperMethods.wDd(ce.x),Zc.HelperMethods.wDd(ce.y));Uc.RVi(Tc)}return!1};this.$=ob;this.gridView=kc.g(ob);this.fj=Ic;this.di=Cc;this.z$i()}function x(ob,Ic,Cc,Uc){var Tc=Zd.call(this)||this;Tc.sheet=ob;Tc.RVg=Ic;Tc.offsetX=Cc;Tc.offsetY=Uc;return Tc}function u(ob,Ic,Cc){var Uc=this;this.bPf=this.aPf=this.cPf=this.$Of=
0;this.NVi=function(Tc,ce){Tc=Object(lc.a)(te.a,ce.pa);Uc.k7a(Tc)&&(ce={},ce.worksheetId=Tc.sheetId,ce=Ne.a.Lc(ce),Uc.aja(11,Tc.sheetId,ce))};this.QVi=function(Tc,ce){Tc=Object(lc.a)(te.a,ce.kI);Uc.k7a(Tc)&&(ce={},ce.worksheetId=Tc.sheetId,ce=Ne.a.Lc(ce),Uc.aja(12,Tc.sheetId,ce))};this.OVi=function(Tc,ce){Tc=Object(lc.a)(te.a,ce.pa);Uc.k7a(Tc)&&(ce={},ce.worksheetId=Tc.sheetId,Tc=Ne.a.Lc(ce),Uc.aja(11,null,Tc,!0))};this.PVi=function(Tc,ce){Tc=Object(lc.a)(te.a,ce.kI);Uc.k7a(Tc)&&(ce={},ce.worksheetId=
Tc.sheetId,Tc=Ne.a.Lc(ce),Uc.aja(12,null,Tc,!0))};this.$=ob;this.fj=Ic;this.di=Cc}function B(ob,Ic,Cc){var Uc=this;this.dQa=this.cQa=0;this.zGa=this.Dha=null;this.gyf=function(){var Tc=kc.g(Uc.$).ha.Pa.oC;if(0<Uc.dQa&&Uc.Dha&&Uc.zGa){var ce={};ce.shapeId=Uc.Dha;ce.worksheetId=Uc.zGa;ce=Ne.a.Lc(ce);Uc.fireEvent(2102,Uc.Dha,ce)}Uc.zni(Tc)?(Uc.Dha=Uc.zOj(Tc),Uc.zGa=Uc.wja(),Uc.Dha&&Uc.zGa)?0<Uc.cQa&&(Tc={},Tc.shapeId=Uc.Dha,Tc.worksheetId=Uc.zGa,Tc=Ne.a.Lc(Tc),Uc.fireEvent(2101,Uc.Dha,Tc)):Ia.ULS.sendTraceTag(537170458,
344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",Uc.Dha,Uc.zGa):(Uc.Dha=null,Uc.zGa=null)};this.$=ob;this.fj=Ic;this.di=Cc}function r(ob,Ic,Cc){ob=I.call(this,ob,Ic,Cc)||this;ob.fkf=null;ob.ekf=null;return ob}function I(ob,Ic,Cc){var Uc=cc.call(this)||this;Uc.Dza=0;Uc.MU=0;Uc.od=function(Tc,ce){if(Uc.enabled&&!(Uc.iff()||null!==ce&&void 0!==ce&&ce.tif)&&(Tc=Object(lc.a)(te.a,Uc.$.xa.pa))&&0===Tc.yI){var ye=Tc.sheetId,Kf=Uc.gZe(),
yf=null,Pf=null;Uc.fj.iif()&&(yf=Uc.grid.Sb.Wj(Uc.grid.ha.va.activeCell),Pf=ye in Uc.Mic?Uc.Mic[ye]:null);Uc.Zre(ye,Kf)&&sa.TaskExtensions.Ba(Ke.Task.Ta(!0),function(){Uc.Y5h(ye,Kf);Uc.I5h(ye,Kf,yf,Pf)},Uc.ma);Uc.nJe(ye,Kf,yf)}};Uc.$=ob;Uc.fj=Ic;Uc.di=Cc;Uc.grid=kc.g(ob);Uc.ZMa={};Uc.Mic={};return Uc}function z(ob,Ic,Cc){var Uc=this;this.YOf=this.XOf=0;this.cKb=this.T$a=null;this.rIi=function(){var Tc=kc.g(Uc.$).ha.Pa.oC;if(Uc.ind(Tc)&&(Tc=Uc.Z$b(Tc))){var ce={chartId:Tc};ce.worksheetId=Uc.wja();
ce=Ne.a.Lc(ce);Uc.aja(51,Tc,ce);Uc.aja(51,Uc.wja(),ce)}};this.sIi=function(){if(Uc.T$a){var Tc={};Tc.chartId=Uc.T$a;Tc.worksheetId=Uc.cKb;Tc=Ne.a.Lc(Tc);Uc.aja(52,Uc.T$a,Tc);Uc.aja(52,Uc.cKb,Tc)}Tc=kc.g(Uc.$).ha.Pa.oC;Uc.ind(Tc)?(Uc.T$a=Uc.Z$b(Tc),Uc.cKb=Uc.wja()):(Uc.T$a=null,Uc.cKb=null)};this.$=ob;this.fj=Ic;this.di=Cc}function D(){this.NYa={}}function V(ob,Ic,Cc,Uc){Uc=void 0===Uc?!1:Uc;var Tc=Ad.call(this)||this;Tc.ecb=0;Tc.vE=null;Tc.awa=!1;Tc.mqc=null;Tc.MU=0;Tc.Q1d=null;Tc.TGc=null;Tc.lVa=
null;Tc.g5b=null;Tc.I9d=!1;Tc.b_d=null;Tc.xda=null;Tc.ZNc=null;Tc.od=function(){Tc.enabled&&(Tc.Joj(),Tc.mqc=Mb.d(kc.g(Tc.$).ha.va.selectedRanges))};Tc.m6e=function(ce){ce.controlId===Tc.Od.InstanceId&&Array.forEach(Tc.vE,function(ye){ye.vzi(ce)&&ye.T0b(ce)})};Tc.Fuf=function(ce){if((ce=Object(lc.a)(222,ce))&&!ce.Vp())if(!Tc.Od||OSF.OsfControl.isFirstPartyStoreString(Tc.Od.PrimaryMarketplace.MarketplaceType)||Tc.$.gha){ce.hf=Tc.Od;ce.xh=Tc.$g;Tc.b_d=ce;Tc.$vc(ce.RFa);var ye=mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&
Nb.a.Ld(Tc.$)&&Zc.HelperMethods.iw(Tc.Od)&&Tc.Od.Preload&&!Tc.Od.TaskpaneVisible;ye?ce.xAd():mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(ce.xAd(),(Tc.Od.SharedRuntime&&1===Tc.Od.SharedRuntime.LifeTime||Tc.Od.SharedRuntimeId)&&!Tc.Od.TaskpaneVisible&&ce.Nf(!1)):((Tc.Od.SharedRuntime&&1===Tc.Od.SharedRuntime.LifeTime||Tc.Od.SharedRuntimeId)&&!Tc.Od.TaskpaneVisible&&ce.Nf(!1),ce.xAd());Tc.J5a||(Nb.a.Ld(Tc.$)?ye||ce.WR():Ib.a(Tc.$).result.mD(ce,!0));
Tc.$.da.Aa(77).rQf(Tc.Fuf);Tc.jha=Object(lc.a)(252,ce)}else Ia.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};Tc.onFloatingObjectControlAdded=function(ce,ye){3===ye.control.floatingObject.type&&ye.control.floatingObject.dl.InstanceId===Tc.j1.WebExtensionId&&(Tc.jha=Object(lc.a)(252,ye.control),Tc.$vc(ye.control.Sd.firstChild),Rb.a(Tc.$).cHb(Tc.onFloatingObjectControlAdded))};Tc.vb=ob.$;Tc.$g=ob;Tc.Od=Cc;Tc.Od.InstanceId=Cc.SrcLocationOverrideResourceId?ob.KJa(Cc.InstanceId,
Cc.SrcLocationOverrideResourceId):Cc.InstanceId;Tc.di=Ic;Tc.j1={};Tc.j1.WebExtensionId=Cc.InstanceId;Tc.iGf="osfControl_"+Cc.InstanceId;Tc.I6c="disabled_"+Cc.InstanceId;Tc.j1.BindingData=Cc.BindingData;Tc.J5a=Tc.$g.J5a(Cc.InstanceId);Tc.bfc=Tc.$g.bfc(Cc.InstanceId);Tc.dde=Cc.WebExtensionOsfControlType;Tc.qJf=Uc;return Tc}function U(){}function Q(ob,Ic,Cc,Uc,Tc,ce,ye,Kf){ob=Tb.call(this,ob,Ic,Cc)||this;ob.startRow=0;ob.startColumn=0;ob.rowCount=0;ob.columnCount=0;ob.startColumn=ce-Uc.Reference.FirstColumn;
ob.columnCount=Kf;ce=Math.max(Tc,Uc.Reference.FirstRow);Tc=Math.min(Tc+ye-1,Uc.Reference.LastRow);ce>Tc?ob.startRow=ob.rowCount=void 0:(ob.startRow=ce-Uc.Reference.FirstRow,ob.rowCount=Tc-ce+1);return ob}function la(ob){var Ic=this;this.vE=null;this.awa=!1;this.od=function(){Ic.vE.forEach(function(Cc){Cc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Cc.T0b(new Fa.a(Cc.eventId,"",null))})};this.$g=ob}function ba(ob,Ic){this.GA=null;this.vfa=ob;this.rxg=Ic}function S(ob){var Ic=
this;this.Ii=this.EWc=null;this.KPi=function(Cc,Uc){Ic.handlers.xb(Uc.controlId)&&(Cc=new T(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Uc.controlId,null,Uc.messageType,Uc.messageContent,Uc.messageOrigin,Uc.targetOrigin),Ic.handlers.oa(Uc.controlId)(Cc),Uc.messageType===OSF.DialogMessageType.DialogClosed&&Ic.handlers.remove(Uc.controlId))};this.JPi=function(Cc,Uc){Ic.Skc.xb(Uc.controlId)&&(Cc=new H(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Uc.controlId,null,Uc.messageType,
Uc.messageContent,Uc.messageOrigin,Uc.targetOrigin),Ic.Skc.oa(Uc.controlId)(Cc))};this.handlers=new Ec.a;this.Skc=new Ec.a;this.$g=ob;this.k1a.oGg(this.KPi);this.k1a.nGg(this.JPi)}function H(ob,Ic,Cc,Uc,Tc,ce,ye){ob=Wa.call(this,ob,Ic,Cc)||this;ob.messageType=0;ob.messageContent=null;ob.messageOrigin=null;ob.targetOrigin=null;ob.messageType=Uc;ob.messageContent=Tc;ob.messageOrigin=ce;ob.targetOrigin=ye;return ob}function T(ob,Ic,Cc,Uc,Tc,ce,ye){ob=cb.call(this,ob,Ic,Cc)||this;ob.messageType=0;ob.messageContent=
null;ob.messageOrigin=null;ob.targetOrigin=null;ob.messageType=Uc;ob.messageContent=Tc;ob.messageOrigin=ce;ob.targetOrigin=ye;return ob}function K(ob,Ic){var Cc=ta.call(this)||this;Cc.requests=[];Cc.m1b=!1;Cc.disposed=!1;Cc.Jg=function(){if(!Cc.disposed){Cc.grid.zc.Mn(Cc.Jg);Cc.m1b=!1;var Uc=Cc.requests;Cc.requests=[];Uc=yl(Uc);for(var Tc=Uc.next();!Tc.done;Tc=Uc.next())Tc=Tc.value,Cc.ddaFacade.hK(Tc.command,Tc.properties)}};Cc.ddaFacade=ob;Cc.grid=Ic;return Cc}function da(){this.command=0;this.properties=
null}function fa(ob){this.rb=new ma.a;this.Om=ob}function W(ob,Ic,Cc,Uc,Tc){Cc=void 0===Cc?null:Cc;Uc=void 0===Uc?"":Uc;Tc=void 0===Tc?"":Tc;var ce=ya.call(this)||this;ce.controlId=ob;ce.messageType=Ic;ce.messageContent=Cc;ce.messageOrigin=Uc;ce.targetOrigin=Tc;return ce}function ca(ob,Ic,Cc,Uc,Tc){Cc=void 0===Cc?null:Cc;Uc=void 0===Uc?"":Uc;Tc=void 0===Tc?"":Tc;var ce=xa.call(this)||this;ce.controlId=ob;ce.messageType=Ic;ce.messageContent=Cc;ce.messageOrigin=Uc;ce.targetOrigin=Tc;return ce}function ia(){this.height=
this.width=0;this.Ve=this.controlId=this.pageUrl=null;this.Cdc=this.O6c=!1}function ea(){}function qa(){this.dialog=this.Ve=null}function pa(ob,Ic,Cc){var Uc=fb.call(this)||this;Uc.u9=null;Uc.dSc="WACDialogTitleText";Uc.bVa="0";Uc.DQb="15px";Uc.ang="0px";Uc.aVa="calc(100% - 30px)";Uc.$mg="100%";Uc.Vee=0;Uc.rb=new ma.a;Uc.Jkg=new Ha;Uc.kc=5;Uc.PCa=Cc;Uc.Ve=Cc;Uc.oHc=ob;Uc.W4d=Ic;Uc.DHc=!!Ta.AFrameworkApplication.ga&&Ta.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return Uc}
function Pa(){}function Ha(){}function Ya(ob,Ic){ob=Na.call(this,1,ob,Ic)||this;ob.bcf=OfficeExt.CommandInvokeMode.ExclusiveForNew;return ob}function Na(ob,Ic,Cc){this._id=ob;this.Hkg=Ic;this.Mmg=Cc;this.bcf=OfficeExt.CommandInvokeMode.Default}b.r(F);var eb=b(0),Ia=b(13),lb=b(1283),hc=b(80),ma=b(93);Na.prototype.execute=function(ob,Ic,Cc){var Uc=this;Cc=Cc||{};Cc.commandMode=this.bcf;Ic.invokeAppCommand(this.VHg,this.B_g,Cc,function(){ob.VPi(Uc.id)})};Qk.Object.defineProperties(Na.prototype,{id:{configurable:!0,
enumerable:!0,get:function(){return this._id}},VHg:{configurable:!0,enumerable:!0,get:function(){return this.Hkg}},B_g:{configurable:!0,enumerable:!0,get:function(){return this.Mmg}}});Object(eb.a)(Na,"AddinNativeActionBase",null,[739]);vm(Ya,Na);Object(eb.a)(Ya,"AddinTakeSnapshotAction",Na,[]);Ha.prototype.n4g=function(ob){return new Na(3,ob,this.KJh().getNativeActionName(3))};Ha.prototype.KJh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(eb.a)(Ha,"AddinNativeActionManager",
null,[706]);var Ja=b(140);Pa.prototype.invokeAppCommand=function(ob,Ic,Cc,Uc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ob,Ic,Cc,Uc)};Pa.getInstance=function(){Pa.Oa||(Pa.Oa=new Pa);return Pa.Oa};Pa.Oa=null;Object(eb.a)(Pa,"OSFAddinCommandsRuntimeManager",null,[704]);var Ta=b(5),pb=b(172),Db=b(23),fb=Ja.a;vm(pa,fb);pa.prototype.gGg=function(ob){this.rb.addHandler("OnDialogClosedEventKey",ob)};pa.prototype.Jsj=function(){this.aEa=null};pa.prototype.eD=function(){fb.prototype.eD.call(this);
this.xp.style.width="100%";this.xp.style.height=this.edc?this.aVa:this.$mg;this.xp.style.marginTop=this.edc?this.DQb:this.ang;this.xp.style.padding=this.bVa};pa.prototype.DO=function(){fb.prototype.DO.call(this);this.Mb.style.width=String.format("{0}px",this.oHc*window.innerWidth/100);this.Mb.style.height=String.format("{0}px",this.W4d*window.innerHeight/100);this.Mb.style.minWidth="0px";this.DHc&&Ta.AFrameworkApplication.isRtl&&100===this.oHc&&(this.Mb.style.right="0px",this.Mb.style.marginRight=
"0px");this.u9=document.getElementById(this.pi(this.dSc));this.u9.style.position="absolute";this.u9.style.whiteSpace="nowrap";this.u9.style.textOverflow="ellipsis";Ta.AFrameworkApplication.isRtl?(this.u9.style.right="14px",this.u9.style.left="44px"):(this.u9.style.right="44px",this.u9.style.left="14px")};pa.prototype.mv=function(ob){fb.prototype.mv.call(this,ob);this.u9&&this.u9.setAttribute("title",ob)};pa.prototype.MKd=function(){this.Mb.style.width=String.format("{0}px",this.oHc*window.innerWidth/
100);this.Mb.style.height=String.format("{0}px",this.W4d*window.innerHeight/100);this.Mb.style.overflowY="hidden";this.Mb.style.overflowX="hidden";this.Mb.style.marginTop="";this.Mb.style.top="";Db.a.jR&&Ta.AFrameworkApplication.isRtl?(this.Mb.style.right="",this.Mb.style.marginRight=""):(this.Mb.style.left="",this.Mb.style.marginLeft="")};pa.prototype.hide=function(){var ob=this;this.Jkg.n4g(this.PCa).execute(this,Pa.getInstance(),{});this.Vee=window.setTimeout(function(){ob.rb.raiseEvent("OnDialogClosedEventKey",
ob.PCa);pb.a.prototype.hide.call(ob)},500)};pa.prototype.VPi=function(ob){3===ob&&(window.clearTimeout(this.Vee),this.rb.raiseEvent("OnDialogClosedEventKey",this.PCa),fb.prototype.hide.call(this))};Qk.Object.defineProperties(pa.prototype,{j1a:{configurable:!0,enumerable:!0,get:function(){return this.xp}}});Object(eb.a)(pa,"AppsForOfficeDialog",Ja.a,[679,680]);Object(eb.a)(qa,"DialogInfo",null,[]);ea.url="url";ea.height="height";ea.width="width";ea.O6c="displayInIframe";ea.Cdc="hideTitle";Object(eb.a)(ea,
"DialogSettings",null,[]);Object(eb.a)(ia,"DisplayDialogParams",null,[]);var xa=Sys.EventArgs;vm(ca,xa);Object(eb.a)(ca,"OnMessageDialogEventArgs",Sys.EventArgs,[]);var ya=Sys.EventArgs;vm(W,ya);Object(eb.a)(W,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Ga=b(40),db=b(29),Ob=b(177),Ec=b(100);fa.prototype.oGg=function(ob){this.rb.addHandler("OnMessageParentEventKey",ob)};fa.prototype.nGg=function(ob){this.rb.addHandler("OnMessageDialogEventKey",ob)};fa.prototype.showDialog=function(ob,Ic,Cc,Uc){if(fa.j8.xb(Ic))Ia.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var Tc=Ga.b(ob),ce=Tc[ea.url];if(this.Om.getOsfControl(Ic).checkAppDomains(ce)){var ye=new ia;ye.width=Tc[ea.width];ye.height=Tc[ea.height];ye.pageUrl=ce;ye.O6c=Tc[ea.O6c];ye.Cdc=Tc[ea.Cdc];ye.controlId=Ic;ye.Ve=Ob.a.create().toString();var Kf=new qa;Kf.Ve=ye.Ve;var yf=this.Om.getOsfControl(ye.controlId).getManifest().getDefaultDisplayName(),Pf=this.Om.getOsfControl(ye.controlId).getStoreType().toLowerCase();
ob=null;var ec=Ta.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",!1);ob=(4===Ta.AFrameworkApplication.sa.Qa.Oj&&"hardcodedpreinstall"===Pf||ec&&"sdxcatalog"===Pf)&&ye.Cdc?this.createAndShowAppsForOfficeDialog(ye.width,ye.height,ye.Ve,!0,yf):this.createAndShowAppsForOfficeDialog(ye.width,ye.height,ye.Ve,!1,yf);var Qc=this.Om.getOsfControl(ye.controlId),Dd=Qc.getManifest();ec={};ec.id=ye.Ve;ec.solutionId=Qc.getSolutionId();ec.version=Qc.getVersion();
ec.storeType=Pf;ec.storeId=Qc.getStoreId();ec.assetId=Qc.getAssetId();ec.assetStoreId=Qc.getAssetStoreId();ec.ownerAddinSolutionId=Qc.getOwnerAddinSolutionId();ec.ownerAddinStoreType=Qc.getOwnerAddinStoreType();ec.appDomains=Dd.getAppDomains();ec.dialogUrl=ce;ec.osfControlType=1;ec.marketplaceID=Dd.getMarketplaceID();ec.marketplaceVersion=Dd.getMarketplaceVersion();ec.store=Qc.getStoreLocator();ec.ownerAddinAssetId=Qc.getOwnerAddinAssetId();ec.agaveName=yf;ec.div=ob.j1a;Ia.ULS.sendTraceTag(542978531,
344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==ec.ownerAddinStoreType?ec.ownerAddinStoreType:ec.storeType,ec.storeId,ec.solutionId),db.a.Qv(ye.pageUrl));this.Om.insertDialogControl(ec);ob.gGg(Object(hc.a)(this,this.kKi,"onDialogClosed"));Kf.dialog=ob;fa.j8.ia(ye.controlId,Kf);Uc&&Uc(ec);Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else Ia.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Jd){Ia.ULS.sendTraceTag(18371104,
344,10,"ShowDialog: action failed. Exception message: {0}",Jd.message),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};fa.prototype.dBi=function(ob,Ic,Cc,Uc){Ta.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Uc&&(Uc=Cc);try{var Tc=this.cva(ob);Tc&&this.rb.raiseEvent("OnMessageParentEventKey",new W(Tc,OSF.DialogMessageType.DialogMessageReceived,Ic,Cc,Uc))}catch(ce){return Ia.ULS.sendTraceTag(555238219,344,10,
"MessageParentOrigin: action failed. Exception message: {0}",ce.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};fa.prototype.Z0c=function(ob,Ic){if(fa.j8.xb(ob))try{var Cc=fa.j8.oa(ob);Cc.dialog&&Cc.dialog.hide();this.Om.purgeDialogControl(Cc.Ve);fa.j8.remove(ob);Ic(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Uc){Ia.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Uc.message),Ic(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else Ia.ULS.sendTraceTag(18896286,
344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Ic(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};fa.prototype.zoj=function(ob,Ic,Cc,Uc){Ta.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Uc&&(Uc=Cc);if(fa.j8.xb(ob)&&(ob=fa.j8.oa(ob),ob.dialog))try{this.rb.raiseEvent("OnMessageDialogEventKey",new ca(ob.Ve,OSF.DialogMessageType.DialogParentMessageReceived,Ic,Cc,Uc))}catch(Tc){Ia.ULS.sendTraceTag(555045763,
344,10,"SendMessageOrigin: action failed. Exception message: {0}",Tc.message)}};fa.prototype.cva=function(ob){for(var Ic=null,Cc=yl(fa.j8),Uc=Cc.next();!Uc.done;Uc=Cc.next())if(Uc=Uc.value,Uc.value.Ve===ob){Ic=Uc.key;break}return Ic};fa.prototype.kKi=function(ob,Ic){if(ob=this.cva(Ic))this.Om.purgeDialogControl(Ic),fa.j8.remove(ob),this.rb.raiseEvent("OnMessageParentEventKey",new W(ob,OSF.DialogMessageType.DialogClosed,null,null,"*"))};fa.prototype.createAndShowAppsForOfficeDialog=function(ob,Ic,
Cc,Uc,Tc){ob=new pa(ob,Ic,Cc);Tc=Uc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Tc);Uc&&(ob.edc=!1,ob.Ru=!1);ob.initializeAndShow(Tc,null,null);ob.Jsj();return ob};fa.I1h=function(){return fa.j8};fa.getInstance=function(ob){fa.Oa||(fa.Oa=new fa(ob));return fa.Oa};fa.Oa=null;fa.j8=new Ec.a;Object(eb.a)(fa,"AppsForOfficeDialogManager",null,[659]);var wb=b(985),kb=b(1294),vb=b(1365),Gb=b(1065),Za=b(845),ub=b(188),fc=b(1296),$a=b(142),nb=b(87),sc=b(88),rd=b(686),$b=b(574),Wb=b(805),
lc=b(84),Oa=b(411),qb=b(139),Ub=b(185),jc=b(36),Kb=b(4),dc=b(949),Qb=b(1243),O=b(74);Object(eb.a)(da,"DdaRequestInfo",null,[]);var Ba=b(859),ra=b(77),ta=O.a;vm(K,ta);K.prototype.Zch=function(ob,Ic){this.disposed||(this.m1b||(this.grid.zc.Lo(this.Jg),this.m1b=!0),this.requests.push(Object.assign(new da,{command:ob,properties:Ic})))};K.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.m1b&&this.grid.zc.Mn(this.Jg);var ob=this.requests;this.requests=null;ob=yl(ob);for(var Ic=ob.next();!Ic.done;Ic=
ob.next())Ic=Ic.value,(Ic=Ic.properties?Ic.properties[ra.a.C3]:null)&&this.ddaFacade.yf(Ba.a.Rxb,Ic);this.ddaFacade=this.grid=null;ta.prototype.dispose.call(this)}};K.E_g=function(ob,Ic){var Cc=!1;974713501===ob&&(Ic=(ob=Ic?Ic[ra.a.Tg]:null)?ob.DdaMethod:null)&&Ic.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Cc=ob.ArrayData,Cc=!!Cc&&64===(Cc[6]&64));return Cc};Object(eb.a)(K,"DdaCellEditDelayRequestHandler",O.a,[]);var Fa=b(894),cb=Fa.a;vm(T,cb);Object(eb.a)(T,"DialogMessageReceivedEventArgs",
Fa.a,[]);var Wa=Fa.a;vm(H,Wa);Object(eb.a)(H,"DialogParentMessageReceivedEventArgs",Fa.a,[]);var mb=b(1);S.prototype.addHandler=function(ob,Ic,Cc,Uc){var Tc=this;if(mb.EwaSettings.la(24))this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Cc);else{Ia.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var ce=function(ye){ye===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Tc.handlers.ia(ob,Ic),Tc.$g.Nu(Cc)):(Ia.ULS.sendTraceTag(537170501,0,
10,"DialogMessageReceivedEventManager.AddHandler failed!"),Tc.$g.yf(ye,Cc))};this.handlers.xb(ob)?ce(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(ob,Uc,ce)}};S.prototype.OBg=function(ob,Ic,Cc){mb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Cc):(Ia.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.Skc.ia(ob,Ic),this.$g.Nu(Cc))};S.prototype.removeHandler=function(ob,Ic){var Cc=
this;mb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ic):this.handlers.xb(ob)?(Ia.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.k1a.Z0c(ob,function(Uc){Cc.handlers.remove(ob);Uc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Cc.$g.Nu(Ic):(Ia.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),Cc.$g.yf(Uc,Ic))})):this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Ic)};S.prototype.Vaj=function(ob,Ic){mb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ic):(Ia.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Skc.remove(ob),this.$g.Nu(Ic))};S.prototype.showDialog=function(ob,Ic,Cc){var Uc=this;try{this.k1a.showDialog(Ic,ob,Cc,function(Tc){Uc.$g.fCg(Uc.pSg(Tc))})}catch(Tc){Ia.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",
Tc.message),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};S.prototype.pSg=function(ob){var Ic={};Ic.InstanceId=ob.id;Ic.WebExtensionType=ob.osfControlType===OSF.OsfControlTarget.InContent?0:1;Ic.PrimaryMarketplace={};Ic.PrimaryMarketplace.SolutionId=ob.solutionId;Ic.PrimaryMarketplace.SolutionVersion=ob.version;Ic.PrimaryMarketplace.MarketplaceRef=ob.storeId;Ic.PrimaryMarketplace.MarketplaceType=ob.storeType;return Ic};S.ka=function(ob){if(!ob.$.da.Aa(232)){var Ic=new S(ob);ob.$.da.Ha(232,
Ic)}};Qk.Object.defineProperties(S.prototype,{k1a:{configurable:!0,enumerable:!0,get:function(){this.EWc||(this.EWc=fa.getInstance(this.contextActivationMgr));return this.EWc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Ii&&this.$g&&(this.Ii=this.$g.Ii);return this.Ii}}});Object(eb.a)(S,"DialogMessageReceivedEventManager",null,[861]);ba.prototype.RYb=function(ob){ob&&(this.GA||(this.GA=[]),Array.add(this.GA,ob))};ba.prototype.zsc=function(ob){this.GA&&Array.remove(this.GA,
ob)};ba.prototype.vzi=function(ob){return this.eventId!==ob.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===ob.ddaBinding.Name:!0};ba.prototype.T0b=function(ob){this.GA&&Array.forEach(this.GA,function(Ic){Ic(ob)})};ba.prototype.Lma=function(){this.GA=[]};Qk.Object.defineProperties(ba.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.vfa}},targetId:{configurable:!0,
enumerable:!0,get:function(){return this.rxg}},z6h:{configurable:!0,enumerable:!0,get:function(){return 0<this.GA.length}}});Object(eb.a)(ba,"DdaEventRegistration",null,[]);var kc=b(19);la.prototype.invokeDdaMethod=function(ob,Ic){var Cc={};Cc[ra.a.Tg]=ob;Cc[ra.a.C3]=Ic;this.$g.hK(974713501,Cc)};la.prototype.registerDdaEventAsync=function(ob,Ic,Cc,Uc,Tc){la.wyb(ob)?(la.ynd(ob)&&this.ekd(),this.vE||(this.vE=[]),Ic=this.ptb(ob,Cc),Ic||(Ic=new ba(ob,Cc),Array.add(this.vE,Ic)),Ic.RYb(Uc),this.$g.Nu(Tc)):
this.$g.yf(-1,Tc)};la.prototype.unregisterDdaEventAsync=function(ob,Ic,Cc,Uc,Tc){la.wyb(ob)?((ob=this.ptb(ob,Cc))&&ob.zsc(Uc),this.$g.Nu(Tc)):this.$g.yf(-1,Tc)};la.prototype.ekd=function(){this.awa||(kc.g(this.$g.$).ha.LG(this.od),this.awa=!0)};la.prototype.ptb=function(ob,Ic){if(!this.vE)return null;for(var Cc=0;Cc<this.vE.length;Cc++){var Uc=this.vE[Cc];if(Uc.eventId===ob&&Uc.targetId===Ic)return Uc}return null};la.wyb=function(ob){return ob===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};
la.ynd=function(ob){return ob===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(eb.a)(la,"EmbeddingPage",null,[851]);var Ab=b(194),Tb=Fa.a;vm(Q,Tb);Q.prototype.getStartRow=function(){return this.startRow};Q.prototype.getStartColumn=function(){return this.startColumn};Q.prototype.getRowCount=function(){return this.rowCount};Q.prototype.getColumnCount=function(){return this.columnCount};Object(eb.a)(Q,"DdaBindingSelectionEventArgs",Fa.a,[]);var ib=b(187),Sa=b(24),Mb=b(43),Jc=b(56),Ib=
b(412),Nb=b(39),sa=b(35),Va=b(587),Xb=b(106),mc=b(53),od=b(92),ld=b(11),Zc=b(8),Rb=b(102);U.ruh="ewa-wx-disabled-div";U.quh="ewa-wx-container-div";U.IOe="ewa-ptp-nov2-flex";Object(eb.a)(U,"CssClassNames",null,[]);var fd=U.ruh,wd=U.quh,Ad=Ab.a;vm(V,Ad);V.prototype.hci=function(ob){this.xda||(this.xda=ob)};V.prototype.bQf=function(){this.xda&&(this.xda.dispose(),this.xda=null)};V.prototype.wld=function(){var ob=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.Od.PrimaryMarketplace.MarketplaceType)&&
mb.EwaSettings.la(187)){var Ic=Jc.GetServiceTaskFactory.Wa(this.$.da,5,4,0);sa.TaskExtensions.Ba(Ic,function(){Ic.result.ig(35,null)},this.ma,3);return this}if(1===this.Od.WebExtensionType)sa.TaskExtensions.Ba(Ib.a(this.$),function(Tc){Tc.result.Uqb(ob.$.da,77,6,ob.Fuf,1)},this.ma,3);else{var Cc=this.QTe(),Uc=Rb.a(this.$);Cc||(Cc={Type:3},Cc.Id=this.j1.WebExtensionId,Cc.WebExtensionData=this.Od,Cc.ContentHtml="<div/>",Cc.Version=0,Cc.AbsoluteLeft=0,Cc.AbsoluteTop=0,Cc.AbsoluteRight=0,Cc.AbsoluteBottom=
0,Cc.Width=0,Cc.Height=0,Cc.ZOrder=0,Cc.OriginDeltaX=0,Cc.OriginDeltaY=0,Cc=new ib.a(Cc),Uc.L3b(Cc,null),Cc=Uc.Tp(Cc.Gg()));Cc?(this.$vc(Cc.Sd.firstChild),this.jha=Object(lc.a)(252,Cc)):Uc.mnb(this.onFloatingObjectControlAdded)}return this};V.prototype.uaf=function(ob){this.$vc(ob);return this};V.prototype.Fmc=function(){this.qJf||this.$g.Ii.purgeOsfControl(this.controlId,!1);this.Pbg(!0);var ob=this.QTe();ob&&Rb.a(this.$).deleteFloatingObject(ob);this.$g.fj.Eaj(this.controlId);this.$g.fj.rLe(this.controlId,
!0);this.ZNc=null};V.prototype.OAd=function(ob){this.j1=ob};V.prototype.invokeDdaMethod=function(ob,Ic){if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Cc={};Cc[ra.a.Tg]=ob;Cc[ra.a.C3]=Ic;this.$g.hK(974713501,Cc)}else this.$g.yf(Ba.a.Rxb,Ic)};V.prototype.c9i=function(ob,Ic,Cc,Uc){if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!V.Ghh(ob)||void 0!==Ic&&null!==Ic&&void 0!==this.y2a(Ic)&&null!==this.y2a(Ic))if(Ia.ULS.sendTraceTag(36444195,
0,50,"eventId: {0}, targetId: {1}",ob,Ic),V.Bdf(ob)&&this.o8h(),V.ynd(ob)&&this.ekd(),V.zdf(ob))mb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Uc):this.$g.$.da.Aa(232).addHandler(this.controlId,Cc,Uc,Ic);else if(V.Adf(ob))mb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Uc):this.$g.$.da.Aa(232).OBg(this.controlId,Cc,Uc);else{V.ydf(ob)&&this.o6e(-1777565636,Uc);this.vE||(this.vE=[]);var Tc=this.ptb(ob,Ic);
Tc||(Tc=new ba(ob,Ic),Array.add(this.vE,Tc));Tc.Lma();Tc.RYb(Cc);this.$g.Nu(Uc);ob===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.lVa&&(this.g5b=Cc)}else this.$g.yf(3002,Uc);else this.$g.yf(-1,Uc)};V.prototype.lQj=function(ob,Ic,Cc,Uc){V.zdf(ob)?mb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Uc):this.$g.$.da.Aa(232).removeHandler(this.controlId,Uc):V.Adf(ob)?mb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Uc):this.$g.$.da.Aa(232).Vaj(this.controlId,Uc):(V.ydf(ob)&&this.o6e(1592314317,Uc),Ic=this.ptb(ob,Ic),this.enabled?(Ic&&(Ic.zsc(Cc),Ic.z6h||Array.remove(this.vE,Ic),this.vE.length?V.Bdf(ob)&&this.Qbg(!1):this.Pbg(!1)),this.$g.Nu(Uc)):this.$g.yf(-1,Uc))};V.prototype.ka=function(ob){ld.DOMElementExtensions.getElementById(ob,this.iGf)||ob.appendChild(ld.DOMElementExtensions.Tf(this.cy))};V.prototype.showHide=function(ob){ld.DOMElementExtensions.setVisible(this.cy,ob)};V.prototype.resize=function(ob,
Ic){ld.DOMElementExtensions.Tq(this.cy,ob);ld.DOMElementExtensions.nG(this.cy,Ic)};V.prototype.kIe=function(ob){if(!this.MU&&!ld.DOMElementExtensions.getElementById(this.cy,this.I6c)&&this.cy){var Ic=document.createElement("div");Ic.id=this.I6c;Ic.className=fd;Ic.style.backgroundImage="url("+mc.a.current.oo(81)+")";Ic.style.opacity=ob?"1":"0";Ic.style.backgroundRepeat="no-repeat";Ic.style.backgroundPosition="center";this.cy.insertBefore(Ic,this.cy.firstChild)}this.MU++};V.prototype.Rkh=function(){0<
this.MU&&this.MU--;this.MU||(ld.DOMElementExtensions.Tf(ld.DOMElementExtensions.getElementById(this.cy,this.I6c)),this.awa&&!Mb.Q(this.mqc,kc.g(this.$).ha.va.selectedRanges)&&this.od(null,null))};V.prototype.y2a=function(ob){if(!this.j1||!this.j1.BindingData)return null;for(var Ic=0;Ic<this.j1.BindingData.length;Ic++)if(this.j1.BindingData[Ic].Name===ob)return this.j1.BindingData[Ic];return null};V.prototype.getDefaultIconUrl=function(){var ob=this.L1e();return ob?ob.getDefaultIconUrl():null};V.prototype.getDefaultDisplayName=
function(){if(this.Od.TaskpaneTitle)return this.Od.TaskpaneTitle;var ob=this.L1e();return ob?ob.getDefaultDisplayName():null};V.prototype.vKf=function(){if(this.lVa&&this.g5b){var ob=new Fa.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.lVa);this.g5b(ob);this.g5b=this.lVa=null}};V.prototype.Nf=function(ob){this.b_d&&this.b_d.Nf(ob)};V.prototype.Dqj=function(){var ob=this;this.$.ea.isNamedObjectViewMode&&this.Qli()&&(this.$.da.Aa(34).Cqj(this.cy),this.showHide(!1));if(this.$g.iYj){if(!this.qJf){var Ic=
{};Ic.div=this.cy;Ic.id=this.Od.InstanceId;Ic.solutionId=this.Od.PrimaryMarketplace.SolutionId;Ic.version=this.Od.PrimaryMarketplace.SolutionVersion;Ic.storeId=this.Od.PrimaryMarketplace.MarketplaceRef;Ic.storeType=this.Od.PrimaryMarketplace.MarketplaceType;Ic.ownerAddinSolutionId=this.Od.OwnerAddinSolutionId;Ic.ownerAddinStoreType=this.Od.OwnerAddinStoreType;this.Od.AssetMarketplace&&(Ic.assetId=this.Od.AssetMarketplace.SolutionId,Ic.assetStoreId=this.Od.AssetMarketplace.MarketplaceRef,Ic.alternateReference=
{},Ic.alternateReference.marketplaceID=this.Od.AssetMarketplace.SolutionId,Ic.alternateReference.marketplaceVersion=this.Od.AssetMarketplace.SolutionVersion,Ic.alternateReference.store=this.Od.AssetMarketplace.MarketplaceRef,Ic.alternateReference.storeType=this.Od.AssetMarketplace.MarketplaceType);Ic.marketplaceID=this.Od.PrimaryMarketplace.SolutionId;Ic.marketplaceVersion=this.Od.PrimaryMarketplace.SolutionVersion;Ic.store=this.Od.PrimaryMarketplace.MarketplaceRef;Ic.ownerAddinAssetId=this.Od.OwnerAddinAssetId;
Ic.settings=this.Od.OsfPropertyBag;mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Ic.reason=this.J5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.bfc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Ic.reason=this.J5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Ic.osfControlType=
0===this.Od.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Ic.isForUILessAction=4===this.Od.WebExtensionOsfControlType;Ic.sourceLocationOverrideResourceId=this.Od.SrcLocationOverrideResourceId;Ic.focusOnIframeWhenLoaded=this.Od.FocusOnIframeWhenLoaded;Va.a(this.Od)&&(Ic.featureGates=Ta.AFrameworkApplication.ga.zQh(Ic.solutionId));Ic.hostInfoFlags=0;this.SHa&&(Ic.hostInfoFlags|=2);Zc.HelperMethods.iw(this.Od)&&(Ic.hostInfoFlags|=1);this.$.gha||(Ia.ULS.sendTraceTag(537170466,
0,50,"Content web add-in disabled by doc IRM"),Ic.hostInfoFlags|=4);mb.EwaSettings.la(662)&&(Ic.hostInfoFlags|=8);mb.EwaSettings.la(54)&&mb.EwaSettings.la(94)&&!this.TGc&&(Ic.virtualOsfControlActivationCallback=function(){ob.$g.PBd(ob.Od)});Ic.sharedRuntimeId=this.Od.SharedRuntime?this.Od.SharedRuntime.Resid:this.Od.SharedRuntimeId;!Zc.HelperMethods.iw(this.Od)||this.Od.Preload||Va.a(this.Od)||this.$g.Ii.getOsfControl(b(862).DdaFacade.getSolutionId(this.Od,this.$))||(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?
this.$.isEditMode&&this.$g.PBd(this.Od):this.$g.PBd(this.Od));Ic.initialDisplayMode=this.Od.TaskpaneVisible?2:1;mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Ic.titleOverride=this.dl.TaskpaneTitle);this.$g.Ii.insertOsfControl(Ic)}this.MU=0}else this.kIe(!0)};V.prototype.Pbg=function(ob){this.Qbg(ob);this.TPj()};V.prototype.o8h=function(){this.ecb||this.di.RYb(this.m6e);this.ecb++};V.prototype.Qbg=function(ob){0<this.ecb&&(ob?this.ecb=0:this.ecb--,this.ecb||this.di.zsc(this.m6e))};
V.prototype.ekd=function(){if(!this.awa){var ob=kc.g(this.$).ha;this.mqc=Mb.d(kc.g(this.$).ha.va.selectedRanges);ob.LG(this.od);this.awa=!0}};V.prototype.TPj=function(){this.awa&&(kc.g(this.$).ha.jL(this.od),this.awa=!1)};V.prototype.Anj=function(ob){var Ic=new Sa.Range(ob.Reference.FirstRow+1,ob.Reference.FirstColumn+1,ob.Reference.LastRow+1,ob.Reference.LastColumn+1,!1,!1);1===ob.BindingType&&(ob.HasHeaders&&--Ic.top,ob.HasTotals&&(Ic.bottom+=1));var Cc=kc.g(this.$).ha.va.selectedRanges;ob=Ic.Qxb(this.mqc);
Cc=Ic.Qxb(Cc);return(Ic=Ic.zf(kc.g(this.$).ha.va.activeRange))&&(Xb.e(ob)&&!Xb.e(Cc)||!Xb.e(ob)&&!Xb.e(Cc)&&!Mb.Q(ob,Cc))?Ic:null};V.prototype.Joj=function(){var ob=this;Array.forEach(this.vE,function(Ic){if(Ic.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ic.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ob.$g.fj.k_b(ob.controlId))if(Ic.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Ic.T0b(new Fa.a(Ic.eventId,ob.controlId,null));else if(Ic.eventId===
OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Cc=ob.y2a(Ic.targetId);if((null===Cc||void 0===Cc?0:Cc.IsValidRef)&&(ob.$.ea.isNamedObjectViewMode?ob.$.zb.pa.sheetName:ob.$.xa.pa.name)===Cc.Reference.SheetName){var Uc=ob.Anj(Cc);Uc&&Ic.T0b(new Q(Ic.eventId,ob.controlId,ob.$g.$_b(Cc),Cc,Uc.top-1,Uc.left-1,Uc.height,Uc.width))}}})};V.prototype.ptb=function(ob,Ic){if(!this.vE)return null;for(var Cc=0;Cc<this.vE.length;Cc++){var Uc=this.vE[Cc];if(Uc.eventId===ob&&Uc.targetId===Ic)return Uc}return null};
V.prototype.QTe=function(){for(var ob=Rb.a(this.$).dz,Ic=ob.length-1;0<=Ic;--Ic){var Cc=ob[Ic];if(3===Cc.floatingObject.type&&Cc.floatingObject.dl.InstanceId===this.j1.WebExtensionId)return Cc}return null};V.prototype.Qli=function(){for(var ob=0;ob<this.$.zb.count;ob++)if(this.$.zb.getItem(ob).ika===this.j1.WebExtensionId)return!0;return!1};V.prototype.$vc=function(ob){this.ZNc=ob;this.cy.id=this.iGf;this.cy.className=wd;this.cy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Dqj()};V.prototype.L1e=function(){if(!this.enabled)return null;
var ob=Va.a(this.dl)?"":this.dl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.dl.PrimaryMarketplace.SolutionId,ob)};V.prototype.o6e=function(ob,Ic){if(mb.EwaSettings.la(24))this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ic);else try{if(Ia.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.dde)this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Ic);else{var Cc={};Cc[Za.a.Anb]=
this.controlId;var Uc=new od.a(ob,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Yb(Uc,Cc);this.$g.Nu(Ic)}}catch(Tc){Ia.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",Tc.message),this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ic)}};V.Ghh=function(ob){return ob===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ob===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};V.Bdf=function(ob){return ob===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||
ob===OSF.DDA.EventDispId.dispidSettingsChangedEvent||ob===OSF.DDA.EventDispId.dispidRichApiMessageEvent};V.ynd=function(ob){return ob===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ob===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};V.zdf=function(ob){return ob===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};V.Adf=function(ob){return ob===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};V.ydf=function(ob){return ob===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};
Qk.Object.defineProperties(V.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.Od.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Od.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.Od.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.MU}},cy:{configurable:!0,enumerable:!0,get:function(){return this.ZNc}},
uU:{configurable:!0,enumerable:!0,get:function(){return this.Od.SrcLocationOverrideResourceId?this.$g.KJa(this.Od.PrimaryMarketplace.SolutionId,this.Od.SrcLocationOverrideResourceId):this.Od.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.Od.SrcLocationOverrideResourceId}},dl:{configurable:!0,enumerable:!0,get:function(){return this.Od}},jha:{configurable:!0,enumerable:!0,get:function(){return this.Q1d},set:function(ob){this.Q1d=
ob}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.dde}},SHa:{configurable:!0,enumerable:!0,get:function(){return this.TGc},set:function(ob){this.TGc=ob}},e5c:{configurable:!0,enumerable:!0,get:function(){return this.lVa},set:function(ob){this.lVa=ob}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.Od.FocusOnIframeWhenLoaded}},upd:{configurable:!0,enumerable:!0,get:function(){return this.I9d},set:function(ob){this.I9d=ob}}});Object(eb.a)(V,
"OsfControl",Ab.a,[860]);D.prototype.add=function(ob){this.NYa[ob]=!0};D.prototype.remove=function(ob){delete this.NYa[ob]};D.prototype.clear=function(){for(var ob=yl(Object.keys(this.NYa)),Ic=ob.next();!Ic.done;Ic=ob.next())delete this.NYa[Ic.value]};D.prototype.G7e=function(){return 0<Object.keys(this.NYa).length};D.prototype.JJh=function(){return Object.keys(this.NYa)};Object(eb.a)(D,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Ne=b(54);z.prototype.qob=function(ob){51===
ob.messageType?this.XOf=this.hGa(ob.actionType,this.XOf,this.rIi):52===ob.messageType&&(this.YOf=this.hGa(ob.actionType,this.YOf,this.sIi))};z.prototype.hGa=function(ob,Ic,Cc){if(1===ob)Ic||kc.g(this.$).ha.Pa.QUc(Cc),Ic++,this.muj();else if(2===ob){if(1>Ic)return Ic;1===Ic&&kc.g(this.$).ha.Pa.$Id(Cc);Ic--}return Ic};z.prototype.aja=function(ob,Ic,Cc){Ic&&this.fj.XZ(ob,Ic)&&this.di.UM(ob,Ic,Cc)};z.prototype.Z$b=function(ob){return ob&&ob.floatingObject?(ob=ob.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===ob.length?ob[0]:null:null};z.prototype.wja=function(){var ob=this.$.xa.pa;return ob&&0===ob.yI?ob.sheetId:null};z.prototype.muj=function(){var ob=kc.g(this.$).ha.Pa.oC;this.ind(ob)&&(this.T$a=this.Z$b(ob),this.cKb=this.wja())};z.prototype.ind=function(ob){return!!ob&&!!ob.floatingObject&&0===ob.floatingObject.type};Object(eb.a)(z,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Ve=b(869),Kd=b(181),Ud=b(657),te=b(94),oe=b(341),Ke=b(52),cc=O.a;vm(I,cc);I.prototype.I_b=function(ob){Object(lc.a)(oe.a,
this.$.xa);1===ob.actionType?(this.Dza||this.grid.ha.LG(this.od),this.Dza++):2!==ob.actionType||1>this.Dza||(1===this.Dza&&this.grid.ha.jL(this.od),this.Dza--)};I.prototype.Fvc=function(ob){ob?this.MU++:(0<this.MU&&this.MU--,this.MU||this.od(null,new Ud.a(!1)))};I.prototype.gZe=function(){return this.grid.ha.va.selectedRanges};I.prototype.Zre=function(ob,Ic){return mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!ob&&Kd.e(this.ZMa)||ob in
this.ZMa)&&!Mb.Q(this.ZMa[ob],Ic):ob in this.ZMa&&!Mb.Q(this.ZMa[ob],Ic)};I.prototype.nJe=function(ob,Ic,Cc){this.ZMa[ob]=Mb.d(Ic);this.Mic[ob]=Cc};I.prototype.iff=function(){return this.grid.isEditing||this.grid.Bi};I.prototype.pUe=function(ob,Ic){this.fj.XZ(14,ob)&&this.di.UM(14,ob,Ic);this.fj.XZ(14,Ve.a.YW)&&this.di.UM(14,Ve.a.YW,Ic)};I.prototype.Y5h=function(ob,Ic){var Cc={};Cc.worksheetId=ob;Cc.address=this.ugd(Ic);Ic=Ne.a.Lc(Cc);this.pUe(ob,Ic)};I.prototype.I5h=function(ob,Ic,Cc,Uc){if(this.fj.iif()){var Tc=
"",ce="";Uc&&(Tc=Uc.hj);Cc&&(ce=Cc.hj);Uc?Cc?(Ic=Cc.usedRange.Qxb(Ic),Tc!==ce&&this.D9b(Tc,"",ob),this.D9b(ce,this.ugd(Ic),ob)):this.D9b(Tc,"",ob):Cc&&(Tc=Cc.usedRange.Qxb(Ic),this.D9b(ce,this.ugd(Tc),ob))}};I.prototype.D9b=function(ob,Ic,Cc){if(this.fj.XZ(100,ob)){var Uc={};Uc.address=Ic;Uc.worksheetId=Cc;this.di.UM(100,ob,Ne.a.Lc(Uc))}};I.prototype.ugd=function(ob){return Mb.i(ob,",",this.$,!1)};I.prototype.dispose=function(){0<this.Dza&&this.grid.ha.jL(this.od);this.Mic=this.ZMa=null;this.Dza=
0;this.di=this.fj=this.$=this.grid=null};Qk.Object.defineProperties(I.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.MU&&0<this.Dza}}});Object(eb.a)(I,"RichApiEventSelectionChangedHandler",O.a,[]);var sd=b(336);vm(r,I);r.prototype.gZe=function(){return sd.a.AHa(this.grid.ha.rangePicker.$K)};r.prototype.Zre=function(ob,Ic){return this.fkf!==ob||!Mb.Q(this.ekf,Ic)};r.prototype.nJe=function(ob,Ic){this.fkf=ob;this.ekf=Mb.d(Ic)};r.prototype.iff=function(){return!this.grid.isEditing&&
!this.grid.Bi};r.prototype.pUe=function(ob,Ic){this.fj.XZ(2700,Ve.a.YW)&&this.di.UM(2700,Ve.a.YW,Ic)};Object(eb.a)(r,"RichApiEventPickedRangesChangedHandler",I,[]);B.prototype.qob=function(ob){var Ic=kc.g(this.$).ha;1===ob.actionType?(this.cQa||this.dQa||Ic.Pa.QUc(this.gyf),2101===ob.messageType?this.cQa++:2102===ob.messageType&&this.dQa++):2===ob.actionType&&(2101===ob.messageType?this.cQa=0<this.cQa?this.cQa-1:0:2102===ob.messageType&&(this.dQa=0<this.dQa?this.dQa-1:0),this.cQa||this.dQa||Ic.Pa.$Id(this.gyf))};
B.prototype.zni=function(ob){return!!ob&&!!ob.floatingObject&&(0===ob.floatingObject.type||7===ob.floatingObject.type||1===ob.floatingObject.type||3===ob.floatingObject.type||5===ob.floatingObject.type)};B.prototype.zOj=function(ob){if(!ob||!ob.floatingObject)return null;ob=ob.floatingObject.id;var Ic=ob.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Ic=Ic&&1===Ic.length?Ic[0]:null;return Ic?Ic:(Ia.ULS.sendTraceTag(537170457,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",
ob),null)};B.prototype.wja=function(){var ob=this.$.xa.pa;return ob&&0===ob.yI?ob.sheetId:null};B.prototype.fireEvent=function(ob,Ic,Cc){Ic&&this.fj.XZ(ob,Ic)&&this.di.UM(ob,Ic,Cc)};Object(eb.a)(B,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);u.prototype.qob=function(ob){11===ob.messageType?ob.targetId===Ve.a.YW?this.sMg(ob.actionType):this.rMg(ob.actionType):12===ob.messageType&&(ob.targetId===Ve.a.YW?this.tMg(ob.actionType):this.uMg(ob.actionType))};u.prototype.rMg=function(ob){this.$Of=
this.hGa(ob,this.$Of,this.NVi)};u.prototype.uMg=function(ob){this.cPf=this.hGa(ob,this.cPf,this.QVi)};u.prototype.sMg=function(ob){this.aPf=this.hGa(ob,this.aPf,this.OVi)};u.prototype.tMg=function(ob){this.bPf=this.hGa(ob,this.bPf,this.PVi)};u.prototype.hGa=function(ob,Ic,Cc){1===ob?Ic=this.oXc(Ic,Cc):2===ob&&(Ic=this.t6c(Ic,Cc));return Ic};u.prototype.oXc=function(ob,Ic){ob||this.$.xa.Qf(Ic);ob++;return ob};u.prototype.t6c=function(ob,Ic){if(1>ob)return ob;1===ob&&this.$.xa.ug(Ic);ob--;return ob};
u.prototype.k7a=function(ob){return!!ob&&0===ob.yI};u.prototype.aja=function(ob,Ic,Cc,Uc){Ic=(void 0===Uc?0:Uc)?Ve.a.YW:Ic;this.fj.XZ(ob,Ic)&&this.di.UM(ob,Ic,Cc)};Object(eb.a)(u,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var zc=b(169),nd=b(12),rb=b(275),Zd=Sys.EventArgs;vm(x,Zd);Object(eb.a)(x,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);A.prototype.dispose=function(){this.GQj()};A.prototype.z$i=function(){for(var ob=yl(this.gridView.mn),Ic=ob.next();!Ic.done;Ic=ob.next())Ic=Ic.value.domElement,
zc.a.instance.qa(nd.a.pointerDown,Ic,this.onPointerDown),rb.a.instance.qa(nd.a.click,Ic,this.$c)};A.prototype.GQj=function(){for(var ob=yl(this.gridView.mn),Ic=ob.next();!Ic.done;Ic=ob.next())Ic=Ic.value.domElement,zc.a.instance.za(nd.a.pointerDown,Ic,this.onPointerDown),rb.a.instance.za(nd.a.click,Ic,this.$c)};A.prototype.RVi=function(ob){var Ic=ob.sheet;if(this.k7a(Ic)){var Cc={};Cc.worksheetId=Ic.sheetId;Cc.address=ob.RVg.toString();Cc.offsetX=ob.offsetX;Cc.offsetY=ob.offsetY;ob=Ic.sheetId;this.fj.XZ(21,
ob)&&(Ic=Ne.a.Lc(Cc),this.di.UM(21,ob,Ic));ob=Ve.a.YW;this.fj.XZ(21,ob)&&(Cc=Ne.a.Lc(Cc),this.di.UM(21,ob,Cc))}};A.prototype.k7a=function(ob){return!!ob&&0===ob.yI};Object(eb.a)(A,"RichApiEventSingleClickedHandler",null,[]);t.prototype.I_b=function(ob){2E3===ob.messageType&&(1===ob.actionType?(this.CGb||kc.g(this.$).ha.Pa.QUc(this.rFf),this.CGb++,this.Kqj()):2===ob.actionType&&this.CGb&&(1===this.CGb&&kc.g(this.$).ha.Pa.$Id(this.rFf),this.CGb--))};t.prototype.$ad=function(ob){var Ic,Cc={};Cc.worksheetId=
ob;Cc.revisionLoad=!1;if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(mb.EwaSettings.la(746)||mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var Uc=kc.g(this.$).ha.Pa.oC;(null===(Ic=null===Uc||void 0===Uc?void 0:Uc.floatingObject)||void 0===Ic?0:Ic.Yc)?Cc.selectedVisualId=Uc.floatingObject.Yc.VisualID:Cc.selectedVisualId=null}Ic=Ne.a.Lc(Cc);ob&&this.fj.XZ(2E3,ob)&&this.di.UM(2E3,ob,
Ic)};t.prototype.wja=function(){var ob=this.$.xa.pa;return ob&&0===ob.yI?ob.sheetId:null};t.prototype.Kqj=function(){var ob=kc.g(this.$).ha.Pa.oC;this.Tif(ob)&&(this.Q$a=ob.floatingObject.id,this.J$a=this.wja())};t.prototype.Tif=function(ob){return!!ob&&ob.xrd()};Object(eb.a)(t,"RichApiEventVisualSelectionChangedHandler",null,[]);w.prototype.qMg=function(ob){1===ob.actionType?(this.DGb||this.LMg(),this.DGb++):2!==ob.actionType||1>this.DGb||(1===this.DGb&&this.eeh(),this.DGb--)};w.prototype.LMg=function(){if(this.fj.XZ(2203,
Ve.a.YW))if(this.bqd){var ob={};ob.timeout=this.$.ya.CheckFocusTimeout;this.T9b=window.requestIdleCallback(this.sye,ob)}else this.T9b=window.setInterval(this.rye,this.$.ya.CheckFocusTimeInterval)};w.prototype.eeh=function(){this.bqd?window.cancelIdleCallback(this.T9b):window.clearInterval(this.T9b)};Object(eb.a)(w,"RichApiEventWorkbookActivatedHandler",null,[]);var qc;(function(ob){ob[ob.none=0]="none";ob[ob.registerEvent=1]="registerEvent";ob[ob.unregisterEvent=2]="unregisterEvent";ob[ob.customFunction=
3]="customFunction";ob[ob.showCard=4]="showCard";ob[ob.createWorkbook=5]="createWorkbook";ob[ob.openWorkbook=6]="openWorkbook";ob[ob.enableEvents=7]="enableEvents";ob[ob.closeWorkbook=8]="closeWorkbook";ob[ob.setCalculationMode=9]="setCalculationMode";ob[ob.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";ob[ob.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";ob[ob.workbookLinksEnableContent=12]="workbookLinksEnableContent";ob[ob.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";
ob[ob.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";ob[ob.rangePicker=15]="rangePicker";ob[ob.enableRichApiRecording=16]="enableRichApiRecording";ob[ob.recordAction=17]="recordAction";ob[ob.focus=18]="focus";ob[ob.businessBarShow=19]="businessBarShow";ob[ob.businessBarHide=20]="businessBarHide"})(qc||(qc={}));Object(eb.b)("PostProcessActionType",qc);var pd=b(232);v.prototype.pMg=function(ob){1===ob.actionType?(this.$.rba=!0,Object(lc.a)(b(862).DdaFacade,pd.a(this.$)).Zad(!0)):2===ob.actionType&&
(this.$.rba=!1);this.jGf=ob.controlId;Ia.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",qc[ob.actionType],this.jGf,this.$.rba)};v.prototype.bmh=function(ob){Object(lc.a)(b(862).DdaFacade,pd.a(this.$)).sUe(ob,this.$.rba)};v.prototype.Lbi=function(){var ob=this;this.$.vba&&sa.TaskExtensions.Ba(Jc.GetServiceTaskFactory.Wa(this.$.da,297,298,1),function(Ic){(Ic=Ic.result)&&Ic.init(ob.Yad)},this.$.ma,
3)};Object(eb.a)(v,"RichApiMacroRecorderEventHandler",null,[]);Object(eb.a)(f,"SessionRecreationInfo",null,[]);m.prototype.ADi=function(){return mb.EwaSettings.la(261)?this.fj.I6h()||0!==this.runtimeCalculationMode:!1};m.prototype.zRg=function(){var ob={};ob.eventRegistrationInfos=this.fj.NPh();ob.runtimeCalculationMode=this.runtimeCalculationMode;ob=Object.assign(new f,{runtimeState:ob});var Ic={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Ic.RequestBody=JSON.stringify(ob);
Ic.RequestFlags=1;return Ic};Object(eb.a)(m,"RichApiRuntimeStateHandler",null,[]);Object(eb.a)(n,"UserOperationQueueItemsStatisticsData",null,[]);var ne=b(323),be=b(28),td=b(16),Qe=b(286),Qf=b(45),pf=b(610),$d=b(61),je=b(57),md=b(69),ee=ne.a;vm(l,ee);l.prototype.dispose=function(){this.$&&(this.$.xa.RF(this.wo),this.$.zb.RF(this.wo),this.$.zb.ug(this.Re),this.$.xa.ug(this.Re));this.dUa&&(this.dUa.np(this.Se),this.dUa.mI(this.Em),this.dUa.Jq(this.Ig));mb.EwaSettings.tc()&&this.ot(this.nya);this.clearCache();
sc.a.Fa(this.dUa);this.dUa=null;ld.DOMElementExtensions.Tf(this.domElement);ee.prototype.dispose.call(this)};l.prototype.Cqj=function(ob){ld.DOMElementExtensions.Tf(ld.DOMElementExtensions.getElementById(this.domElement,ob.id));this.domElement.appendChild(ob)};l.prototype.Lld=function(){if(this.Cva&&!this.d3b){var ob=Object(lc.a)(b(862).DdaFacade,pd.a(this.$)).an(this.Cva.InstanceId);ob&&(ob.resize(this.Cva.Width,this.Cva.Height),ob.ka(this.domElement),ob.showHide(!0),this.d3b=!0)}};l.prototype.m7a=
function(){return!0};l.prototype.yna=function(ob){this.Cva=ob.ed.block.te;this.d3b=!1;this.Lld()};l.prototype.uTa=function(ob){this.$.ea.TZ&&ob&&(ob.qu||(ob.qu=new Qe.a),ob.qu.Rg=new Qf.a(this.domElement.scrollLeft,this.domElement.scrollTop),ob.qu.pFb=20)};l.prototype.clearCache=function(){this.Ca.Fza(this.hashCode);this.Cva=this.hashCode=null;this.d3b=!1};l.prototype.xSa=function(ob,Ic){if(this.isVisible=!!ob&&$d.p(ob))this.hashCode=this.Ca.Nga(ob,je.a.Brb,this.hashCode),this.lwc(Ic)};l.iGa=function(ob){if(!ob.da.Aa(34)){var Ic=
ob.tf;ob.da.Ha(34,new l(ob,new pf.a(ob,ob.ea,ob.na.Ck,3,0),Ic.appendChild(Ic.ownerDocument.createElement("div"))))}};Qk.Object.defineProperties(l.prototype,{Ca:{configurable:!0,enumerable:!0,get:function(){return this.dUa}}});Object(eb.a)(l,"WebExtensionView",ne.a,[859,786,2]);var qf=b(217),Fc=b(521),Ed=b(369),Sd=b(437),qd=b(164),ke=b(81),Se=b(114),of=b(44),vc=b(42),id=b(147),Ac=b(107),Yd=b(72),Cd=b(26),wf=b(27),Vb=b(303),wc=b(20),yb=b(14),oc=b(272),Wc=b(880),Qd=b(48),Sc=b(151),Yc=b(1116),pc=b(192),
Be=b(1011),Ce=b(30);b.d(F,"DdaFacade",function(){return a});var Xe=jc.a;vm(a,Xe);a.prototype.sne=function(ob){this.addHandler("cd",ob)};a.prototype.acj=function(ob){this.removeHandler("cd",ob)};a.prototype.tne=function(ob){this.addHandler("csc",ob)};a.prototype.qsc=function(ob){this.removeHandler("csc",ob)};a.prototype.AEg=function(ob){this.addHandler("ca",ob)};a.prototype.$bj=function(ob){this.removeHandler("ca",ob)};a.prototype.BEg=function(ob){this.addHandler("ci",ob)};a.prototype.CEg=function(ob){this.addHandler("ekros",
ob)};a.prototype.bcj=function(ob){this.removeHandler("ekros",ob)};a.prototype.TCd=function(ob,Ic){try{return JSON.parse(ob)[Ic].toLowerCase()}catch(Cc){return""}};a.prototype.hxj=function(ob){var Ic=this.TCd(ob,"AudienceGroup"),Cc=this.TCd(ob,"SessionOrigin");try{var Uc=parseInt(this.TCd(ob,"Ring"),10);if("automation"!==Ic&&"bluechicken"!==Cc&&-2<=Uc)return!0}catch(Tc){if("automation"!==Ic&&"bluechicken"!==Cc)return!0}return!1};a.prototype.$_b=function(ob){var Ic={};Ic.Name=ob.Name;Ic.BindingType=
ob.BindingType;Ic.HasHeaders=ob.HasHeaders;ob.IsValidRef&&(Ic.ColCount=ob.Reference.LastColumn-ob.Reference.FirstColumn+1,Ic.RowCount=ob.Reference.LastRow-ob.Reference.FirstRow+1);return Ic};a.prototype.gsi=function(ob,Ic){this.Om.launchInsertDialog(ob,null,this.DQg(Ic))};a.prototype.KFd=function(ob,Ic){var Cc={};Cc.callbackFunc=ob;Cc.storeType=OSF.StoreTypeEnum.MarketPlace;Cc.fromInsertDialog=!1;Cc.refresh=Ic;this.Om.queryEntitlementDetails(Cc)};a.prototype.invokeDdaMethod=function(ob,Ic){var Cc=
this.an(ob.DdaMethod.ControlId);Cc?Cc.invokeDdaMethod(ob,Ic):this.yf(Ba.a.internalError,Ic)};a.prototype.registerDdaEventAsync=function(ob,Ic,Cc,Uc,Tc){(Ic=this.an(Ic))?a.wyb(ob)?Ic.c9i(ob,Cc,Uc,Tc):this.yf(Ba.a.kCd,Tc):this.yf(Ba.a.internalError,Tc)};a.prototype.unregisterDdaEventAsync=function(ob,Ic,Cc,Uc,Tc){(Ic=this.an(Ic))?a.wyb(ob)?Ic.lQj(ob,Cc,Uc,Tc):this.yf(Ba.a.kCd,Tc):this.yf(Ba.a.internalError,Tc)};a.prototype.dispose=function(){this.disposed||(this.$.ol(this.ud),this.ea.kk(this.dd),this.ea.LW(this.Gq),
this.ea.Dw(this.Mf),this.YVc.detach(this),this.$.userOperationManager.jv(this.QR),this.Goc=this.Ff=this.di=this.YVc=this.vb=null,this.IIa&&(this.IIa.dispose(),this.IIa=null),sc.a.Fa(this.JLd),sc.a.Fa(this.ILd),this.Z0a&&(this.Z0a.dispose(),this.Z0a=null),Xe.prototype.dispose.call(this),this.disposed=!0,Ia.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.wac=function(ob){return(ob=this.an(ob))?ob.getDefaultIconUrl():null};a.prototype.Fvc=function(ob){if(this.RFe!==ob){this.RFe=
ob;for(var Ic=0,Cc=this.Ff.length;Ic<Cc;Ic++){var Uc=this.Ff[Ic];ob?Uc.kIe(!1):Uc.Rkh()}this.JLd.Fvc(ob);this.ILd.Fvc(ob)}};a.prototype.yOh=function(ob){return(ob=this.an(ob))?ob.getDefaultDisplayName():null};a.prototype.yf=function(ob,Ic,Cc){var Uc={};Uc[ra.a.Tg]=ob;Uc[ra.a.C3]=Ic;this.hK(451041795,Uc,void 0===Cc?!0:Cc)};a.prototype.Nu=function(ob){var Ic={};Ic[ra.a.C3]=ob;this.hK(1237877382,Ic)};a.prototype.hK=function(ob,Ic,Cc){var Uc=this;Cc=void 0===Cc?!0:Cc;var Tc=new od.a(ob,0,this.$.hd,0,
null),ce=Ic?Ic[ra.a.C3]:null;this.Z0a&&kc.g(this.$).isEditing&&K.E_g(ob,Ic)?this.Z0a.Zch(ob,Ic):(ob=this.$.Ka.Yb(Tc,Ic),Cc&&sa.TaskExtensions.Ba(ob,function(ye){id.a(ye)?Uc.yf(Ba.a.internalError,ce,!1):ye.result||(kc.g(Uc.$).isEditing?Uc.yf(Ba.a.Rxb,ce,!1):Uc.yf(Ba.a.internalError,ce,!1))},this.ma,8))};a.prototype.e2g=function(ob){var Ic=this;return!!this.$ia(function(Cc){return a.getSolutionId(Cc.dl,Ic.$)===a.getSolutionId(ob,Ic.$)&&Cc.dl.PrimaryMarketplace.MarketplaceType===ob.PrimaryMarketplace.MarketplaceType&&
Cc.dl.PrimaryMarketplace.MarketplaceRef===ob.PrimaryMarketplace.MarketplaceRef&&Cc.dl.PrimaryMarketplace.SolutionVersion===ob.PrimaryMarketplace.SolutionVersion})};a.prototype.an=function(ob){return this.$ia(function(Ic){return Ic.controlId.startsWith(ob)})};a.prototype.aDh=function(ob){return this.$ia(function(Ic){return Ic.SHa===ob})};a.prototype.RTe=function(ob){return this.$ia(function(Ic){return Ic.uU===ob&&!!Ic.SHa})};a.prototype.hUe=function(ob,Ic,Cc,Uc){return this.$ia(function(Tc){return Tc.uU===
ob&&Tc.dl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Ic.toLowerCase()&&Tc.dl.PrimaryMarketplace.MarketplaceType.toLowerCase()===Cc.toLowerCase()&&!!Tc.dl.SharedRuntime&&!!Tc.dl.SharedRuntime.Resid&&!!Uc&&!!Uc.Resid&&Tc.dl.SharedRuntime.Resid.toLowerCase()===Uc.Resid.toLowerCase()})};a.prototype.cMg=function(ob,Ic){if(ob=this.an(ob))ob.ka(Ic),ob.showHide(!0)};a.prototype.xBj=function(ob){(ob=this.an(ob))&&ob.showHide(!1)};a.prototype.y0a=function(ob){if(1!==ob.WebExtensionType||this.$.Jd&8388608&&
ob.TaskpaneVisible||this.$.Jd&8388608&&!ob.TaskpaneVisible&&Zc.HelperMethods.iw(ob)){var Ic=null;Zc.HelperMethods.iw(ob)&&(Ic=a.Tua(ob,this.$),ob.TaskpaneWidth||(ob.TaskpaneWidth=this.x5b));var Cc=(new V(this,this.di,ob)).wld();Ia.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(ob.PrimaryMarketplace.MarketplaceType,ob.PrimaryMarketplace.MarketplaceRef,ob.PrimaryMarketplace.SolutionId),ob.PrimaryMarketplace.MarketplaceType,
Zc.HelperMethods.iw(ob));Ic&&(Cc.SHa=Ic);Array.add(this.Ff,Cc);this.mxa=null;this.J5a(ob.InstanceId)||(ob=String.format("{0}|{1}|{2}|{3}|{4}",ob.PrimaryMarketplace.SolutionId,ob.PrimaryMarketplace.SolutionVersion,ob.PrimaryMarketplace.MarketplaceRef,ob.PrimaryMarketplace.MarketplaceType,ob.WebExtensionType),this.raiseEvent("ci",ob))}};a.prototype.kDj=function(ob,Ic){function Cc(){Uc.jQa(ce.controlId);Uc.Ii.purgeOsfControl(ce.controlId,!1);Ic()}var Uc=this;ob.TaskpaneWidth=this.x5b;ob.TaskpaneVisible=
!0;var Tc={};Tc.SolutionId=ob.PrimaryMarketplace.SolutionId;Tc.TargetType=ob.WebExtensionType;Tc.Version=ob.PrimaryMarketplace.SolutionVersion;Tc.StoreType=ob.PrimaryMarketplace.MarketplaceType;Tc.StoreId=ob.PrimaryMarketplace.MarketplaceRef;Tc.AssetId=ob.PrimaryMarketplace.SolutionId;Tc.AssetStoreId=ob.PrimaryMarketplace.MarketplaceRef;Tc.Width=ob.TaskpaneWidth;Tc.Id=ob.PrimaryMarketplace.SolutionId;Tc.AppVersion=ob.PrimaryMarketplace.SolutionVersion;Tc.CurrentStoreType=ob.PrimaryMarketplace.MarketplaceType;
var ce=new V(this,this.di,ob,!0);ce.wld();Array.add(this.Ff,ce);var ye=null;ye=of.a.instance.mC(function(){ce.cy&&(sc.a.Fa(ye),ye=null,Uc.Ii.insertBlankControlWithErrorUX(Uc.vFb(ce,Tc),Cc))},100,vc.a.Qbh)};a.prototype.P5g=function(ob){var Ic=this;if(ob&&ob.length){var Cc=[];ob.forEach(function(Uc){if(Uc.ContainsCustomFunctions){var Tc=a.Tua(Uc,Ic.$);Ic.oDd.contains(Tc)||(Ic.oDd.add(Tc),Array.add(Ic.AHf,Uc));Ic.e2g(Uc)||Array.add(Cc,Uc)}});Cc.length&&this.hDe(Cc)}};a.prototype.ZEe=function(ob,Ic){this.an(ob.InstanceId)||
(Ic=Ic(),ob=(new V(this,this.di,ob)).uaf(Ic),Array.add(this.Ff,ob),this.mxa=null)};a.prototype.SAj=function(ob){a.R0a.xb(ob)&&a.R0a.oa(ob).initializeAndShowWithTitle()};a.prototype.E7h=function(ob){a.R0a.xb(ob)&&a.R0a.oa(ob).hide()};a.prototype.mVh=function(ob){var Ic=this,Cc=null,Uc,Tc=null;var ce=a.Qhd(ob,!0);if(!ce)return Ia.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ke.Task.Ta(null);(Uc=this.Om.getOsfControl(a.getSolutionId(ce,
this.$)))&&(Cc=Uc.getManifest())&&(Tc=Cc.getSharedRuntimeForCustomFunctions("Workbook"));if(Cc=Tc&&1===Tc.LifeTime?this.hUe(ce.PrimaryMarketplace.SolutionId,ce.PrimaryMarketplace.MarketplaceRef,ce.PrimaryMarketplace.MarketplaceType,Tc):this.aDh(ob))return Ke.Task.Ta(Cc.controlId);var ye=new qb.a;Zc.HelperMethods.hic(Tc)&&(ce.SharedRuntime=Tc);ob=Uc?Uc.getNotificationParams():[];if(!ob.length)return this.IDe(ce);this.z3f(ob,function(){sa.TaskExtensions.Ba(ye.task,function(){Ic.IDe(ce)},Ic.ma,3)},function(){});
return ye.task};a.prototype.HJh=function(ob){ob=a.Qhd(ob,!1);if(!ob)return Ia.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var Ic=null,Cc=this.Om.getOsfControl(a.getSolutionId(ob,this.$));Cc&&(Cc=Cc.getManifest())&&(Ic=Cc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Zc.HelperMethods.hic(Ic)&&(ob=this.hUe(ob.PrimaryMarketplace.SolutionId,ob.PrimaryMarketplace.MarketplaceRef,ob.PrimaryMarketplace.MarketplaceType,Ic))?ob.controlId:
null};a.prototype.m4g=function(ob,Ic){var Cc=this,Uc=a.Qhd(ob,!1);if(Uc){var Tc=null,ce=this.Om.getOsfControl(a.getSolutionId(Uc,this.$));ce&&(ce=ce.getManifest())&&(Tc=ce.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Zc.HelperMethods.hic(Tc)){Uc.SharedRuntime=Tc;var ye=Uc.PrimaryMarketplace.SolutionId;ce=Uc.PrimaryMarketplace.SolutionVersion;var Kf=OSF.OsfManifestManager.getCachedManifest(ye,ce);if(Kf)if(this.hZb.xb(ob))Tc=this.hZb.oa(ob),sa.TaskExtensions.Ba(Tc,function(ec){(ec=ec.result)&&
OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ec,Ic,Cc.di.RIb)},this.ma,3);else{var yf={solutionId:ye,version:ce};yf.storeType=Uc.PrimaryMarketplace.MarketplaceType;yf.storeId=Uc.PrimaryMarketplace.MarketplaceRef;yf.assetId=ye;yf.assetStoreId=null;yf.targetType=OSF.OsfControlTarget.TaskPane;var Pf=new qb.a;Uc=sa.TaskExtensions.nm();Uc=new Qb.a(this.$,this,yf,Uc);Tc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(ye,Tc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Kf,
Tc,ce);Uc.createUILessSandbox(yf,Kf,function(ec,Qc){ec&&!Qc?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ec,Ic,Cc.di.RIb),Pf.setResult(ec)):Pf.setResult(null);Cc.hZb.remove(ob)});this.hZb.ia(ob,Pf.task)}}}else Ia.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.dye=function(ob){(ob=this.RTe(ob))&&(ob.dl.SharedRuntime||this.KGb(ob.controlId))};a.prototype.KGb=function(ob){(ob=this.RTe(ob))&&this.jQa(ob.controlId)};
a.prototype.bhh=function(ob,Ic){if(!this.Ff||!ob||!Ic)return!1;if(ob.toLowerCase()===Ic.toLowerCase())return!0;for(var Cc=null,Uc=null,Tc=0,ce=this.Ff.length;Tc<ce;Tc++){var ye=this.Ff[Tc];if(ye.ownerAddinSolutionId&&(ye.controlId===ob&&(Cc=ye.ownerAddinSolutionId.toLowerCase()),ye.controlId===Ic&&(Uc=ye.ownerAddinSolutionId.toLowerCase()),Cc&&Uc))break}return Cc&&Cc===Uc?!0:!1};a.prototype.fCg=function(ob){this.an(ob.InstanceId)||(ob=new V(this,this.di,ob),Array.add(this.Ff,ob),this.mxa=null)};a.prototype.UPf=
function(ob){if(this.Ff&&0<=ob&&ob<this.Ff.length){var Ic=this.Ff[ob],Cc=Ic.cy;Array.removeAt(this.Ff,ob);this.Qwf(Ic);ld.DOMElementExtensions.Tf(Cc)}};a.prototype.jQa=function(ob){if(this.Ff)for(var Ic=0,Cc=this.Ff.length;Ic<Cc;Ic++)if(this.Ff[Ic].controlId===ob){this.UPf(Ic);break}};a.prototype.abj=function(ob){if(this.Ff){ob=ob.toLowerCase();for(var Ic=0,Cc=this.Ff.length;Ic<Cc;Ic++)if(ob===this.Ff[Ic].ownerAddinSolutionId.toLowerCase()){this.UPf(Ic);break}}};a.prototype.KMg=function(ob){ob.gn&&
(this.an(ob.floatingObject.dl.InstanceId)||(this.bfc(ob.floatingObject.dl.InstanceId)||Array.add(this.Goc,ob.floatingObject.dl.InstanceId),this.y0a(ob.floatingObject.dl)),this.ea.isNamedObjectViewMode&&this.cMg(ob.floatingObject.dl.InstanceId,ob.Sd))};a.prototype.uaa=function(ob){if(this.Ff)for(var Ic=0,Cc=this.Ff.length;Ic<Cc;Ic++)if(1===this.Ff[Ic].controlType&&wc.a.equals(this.Ff[Ic].uU,ob,!0))return this.Ff[Ic].controlId;return null};a.prototype.zCh=function(ob){var Ic=[];if(this.Ff)for(var Cc=
0,Uc=this.Ff.length;Cc<Uc;Cc++)wc.a.equals(this.Ff[Cc].uU,ob,!0)&&Ic.push(this.Ff[Cc].controlId);return Ic};a.prototype.hDh=function(ob,Ic){if(!Ic||!ob)return null;if(this.Ff)for(var Cc=0,Uc=this.Ff.length;Cc<Uc;Cc++)if(1===this.Ff[Cc].controlType&&wc.a.equals(this.Ff[Cc].uU,ob,!0)&&this.Ff[Cc].dl.SharedRuntime&&wc.a.equals(this.Ff[Cc].dl.SharedRuntime.Resid,Ic.Resid,!0))return this.Ff[Cc].controlId;return null};a.prototype.KJa=function(ob,Ic){Ic=void 0===Ic?null:Ic;return ob?Ic?String.format("{0}.{1}",
ob,Ic):ob:""};a.prototype.gye=function(ob,Ic,Cc){if(this.mxa===ob)return!0;this.mxa=ob;var Uc=null,Tc=!1;if(!Uc&&this.Ff)for(var ce=0,ye=this.Ff.length;ce<ye;ce++)if(1===this.Ff[ce].controlType&&wc.a.equals(this.Ff[ce].uU,ob,!0)){var Kf=!1,yf=!1;Ic?(Kf=!0,yf=!!this.Ff[ce].dl.SharedRuntime&&wc.a.equals(this.Ff[ce].dl.SharedRuntime.Resid,Ic.Resid,!0)):Cc&&(Kf=!0,yf=wc.a.equals(this.Ff[ce].dl.SharedRuntimeId,Cc,!0));if(!Kf||yf){yf&&this.Ff[ce].Nf(!0);Uc=this.Ff[ce].controlId;Tc=!0;this.mxa=null;break}}Uc&&
this.raiseEvent("ca",Uc);return Tc};a.prototype.setAppRuntimeState=function(ob,Ic){var Cc;if(ob){var Uc=this.an(ob);if(Uc&&Zc.HelperMethods.iw(Uc.dl))Uc.Nf(Ic),Ic&&(this.raiseEvent("ca",ob),(null===(Cc=Uc.cy)||void 0===Cc?0:Cc.firstChild)&&(ob=Uc.cy.firstChild.title)&&0<ob.length&&this.s_b.Boj(ob));else throw Ia.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(yb.a.instance.fa(2181));}else throw Ia.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(yb.a.instance.fa(2182));};a.prototype.getAppRuntimeState=function(ob){if(ob)if((ob=this.an(ob))&&Zc.HelperMethods.iw(ob.dl))ob=ob.dl.TaskpaneVisible;else throw Ia.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(yb.a.instance.fa(2181));else throw Ia.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(yb.a.instance.fa(2182));return ob};a.prototype.y2a=function(ob,Ic){return(ob=
this.an(ob))?ob.y2a(Ic):null};a.prototype.J5a=function(ob){return this.iye(this.Goc,ob)};a.prototype.bfc=function(ob){return this.iye(this.MFe,ob)};a.prototype.Ile=function(ob){Array.add(this.MFe,ob)};a.prototype.pZ=function(ob){return(ob=this.an(ob))?ob.dl:null};a.prototype.gyd=function(ob){this.raiseEvent("ekros",ob,this)};a.prototype.PBd=function(ob){if(ob){var Ic=this.an(ob.InstanceId);Ic&&(ob.SharedRuntime||ob.SharedRuntimeId||(this.jQa(Ic.controlId),this.Ii.purgeOsfControl(Ic.controlId,!1)),
Ic={},Ic.SolutionId=ob.PrimaryMarketplace.SolutionId,Ic.TargetType=ob.WebExtensionType,Ic.Version=ob.PrimaryMarketplace.SolutionVersion,Ic.StoreType=ob.PrimaryMarketplace.MarketplaceType,Ic.StoreId=ob.PrimaryMarketplace.MarketplaceRef,Ic.AssetId=ob.PrimaryMarketplace.SolutionId,Ic.AssetStoreId=ob.PrimaryMarketplace.MarketplaceRef,Ic.Width=ob.TaskpaneWidth,Ic.SharedRuntimeId=ob.SharedRuntimeId,Ic.Id=ob.PrimaryMarketplace.SolutionId,Ic.AppVersion=ob.PrimaryMarketplace.SolutionVersion,Ic.CurrentStoreType=
ob.PrimaryMarketplace.MarketplaceType,this.rag(Ic))}};a.prototype.Gia=function(){this.di.Gia()};a.prototype.UM=function(ob,Ic,Cc){this.di.UM(ob,Ic,Cc)};a.prototype.Koj=function(ob,Ic){var Cc=Array(2);Cc[0]=Ic;Cc[1]=null;this.di.wDh(ob,JSON.stringify(Cc))};a.prototype.sUe=function(ob,Ic){Ic=a.t9g(Ic);ob=this.pZ(ob);this.di.C9b(ob.InstanceId,2202,Ve.a.YW,Ic)};a.prototype.Zad=function(ob){for(var Ic=0,Cc=this.Ff.length;Ic<Cc;Ic++)this.sUe(this.Ff[Ic].controlId,ob)};a.prototype.sDh=function(ob,Ic){Ic=
a.S4g(Ic);this.di.C9b(ob,65539,"",Ic)};a.prototype.uDh=function(ob,Ic,Cc){this.di.C9b(ob,1,Ic,Cc)};a.prototype.rDh=function(ob,Ic){this.di.vDh(ob,Ic)};a.prototype.j4g=function(ob,Ic){return[[2,1E3,"",JSON.stringify([ob,Ic]),0,!1]]};a.prototype.Zfi=function(){return!!this.$ma&&this.$ma.G7e()};a.prototype.eYg=function(){this.$ma&&this.$ma.clear()};a.prototype.tDh=function(){if(this.$ma&&this.$ma.G7e()){var ob=this.$ma.JJh();ob=yl(ob);for(var Ic=ob.next();!Ic.done;Ic=ob.next()){Ic=this.zCh(Ic.value);
Ic=yl(Ic);for(var Cc=Ic.next();!Cc.done;Cc=Ic.next())this.di.C9b(Cc.value,65540,"","{}")}}};a.prototype.W8i=function(ob){this.$ma.add(ob)};a.prototype.hQj=function(ob){this.$ma.remove(ob)};a.prototype.$ia=function(ob){if(!this.Ff)return null;for(var Ic=yl(this.Ff),Cc=Ic.next();!Cc.done;Cc=Ic.next())if(Cc=Cc.value,ob(Cc))return Cc;return null};a.prototype.IDe=function(ob){var Ic=this,Cc=new qb.a,Uc=a.Tua(ob,this.$);if(Zc.HelperMethods.iw(ob))Ia.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),
this.xHf(ob,function(ce){ce?(ob.InstanceId=ce.InstanceId,ob.WebExtensionOsfControlType=3,ob.TaskpaneVisible=!1,Ic.y0a(ob),Cc.setResult(ob.InstanceId)):(Ia.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetAssetId(ob.PrimaryMarketplace.MarketplaceType,ob.PrimaryMarketplace.MarketplaceRef,ob.PrimaryMarketplace.SolutionId)),Cc.setException(Error.create("Null insert data")))});else{a.R0a.ia(ob.InstanceId,new vb.a);var Tc=a.R0a.oa(ob.InstanceId).j1a;
this.O5g(ob,Tc,Uc);this.xHf(ob,null);Cc.setResult(ob.InstanceId)}return Cc.task};a.prototype.O5g=function(ob,Ic,Cc){this.an(ob.InstanceId)||(ob=new V(this,this.di,ob),ob.SHa=Cc,ob.uaf(Ic),Array.add(this.Ff,ob),this.mxa=null)};a.prototype.xHf=function(ob,Ic){var Cc=a.Tua(ob,this.$);if(!this.oDd.contains(Cc))this.XEb.push(ob),1<=this.XEb.length&&this.yHf(ob,Ic);else if(Ic){ob=yl(this.AHf);for(var Uc=ob.next();!Uc.done;Uc=ob.next())if(Uc=Uc.value,a.Tua(Uc,this.$)===Cc){Ic(Uc,0);break}}};a.prototype.yHf=
function(ob,Ic){function Cc(ec){ec&&!Vb.a(ec)||Ia.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(ye.StoreType,ye.StoreId,ye.SolutionId),wf.a.Uc(ec.Errors));Tc.XEb.shift();0<Tc.XEb.length&&Tc.yHf(Tc.XEb[0],Ic)}function Uc(ec){ec=Se.a.og(ec.data);Ia.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",wf.a.Uc(ec))}var Tc=this,
ce=null,ye={};ye.SolutionId=a.getSolutionId(ob,this.$);ye.TargetType=ob.WebExtensionType;ye.Version=ob.PrimaryMarketplace.SolutionVersion;ye.StoreType=ob.PrimaryMarketplace.MarketplaceType;ye.StoreId=ob.PrimaryMarketplace.MarketplaceRef;ye.AssetId=ob.PrimaryMarketplace.SolutionId;ye.AssetStoreId=ob.PrimaryMarketplace.MarketplaceRef;ye.Width=ob.TaskpaneWidth;ye.ContainsCustomFunctions=!0;ye.Id=a.getSolutionId(ob,this.$);ye.AppVersion=ob.PrimaryMarketplace.SolutionVersion;ye.CurrentStoreType=ob.PrimaryMarketplace.MarketplaceType;
Zc.HelperMethods.iw(ob)&&(ye.SharedRuntimeId=ob.SharedRuntime.Resid);var Kf=this.$.na.ta;ob=this.$.na.ta.$b();var yf=Kf.Na(9,ob);yf.sharedInfo=ye;if(Ic){var Pf=function(ec){var Qc=ec.Result;(ce=Qc?Qc.AgaveData:null)||Ic(null,ec.Errors?ec.Errors[0].ErrorCause:5001);Ic(ce,0)};ob=function(ec,Qc,Dd){return ke.i(Kf,"InsertAgaveTaskpane",yf,oc.b(ec,Cc,Pf),oc.a(Qc,Uc),Dd,null,0)}}else ob=function(ec,Qc,Dd){return ke.i(Kf,"InsertAgaveTaskpane",yf,oc.b(ec,Cc),oc.a(Qc,Uc),Dd,null,0)};mb.EwaSettings.tc()?Ed.a(this.$.userOperationManager,
ob,function(ec){return new qd.a(519,0,ec,64)},null):Ed.a(this.$.userOperationManager,ob,function(ec){return new Fc.a(519,0,ec)},null)};a.prototype.$xj=function(){return this.$.jg.get(35)};a.prototype.HId=function(ob){ob=this.an(ob);(null===ob||void 0===ob?0:ob.xda)&&ob.bQf()};a.prototype.NEi=function(ob){var Ic=this.$ia(function(Cc){return a.SLa(Cc.uU)});Ic&&(Ic=this.Ii.getOsfControl(Ic.controlId))&&Ic.notifyAgave(OSF.AgaveHostAction.SendMessage,ob)};a.prototype.Lgi=function(){return!!this.$ia(function(ob){return 1===
ob.controlType&&a.SLa(ob.uU)})};a.prototype.Kgi=function(){var ob=this.$ia(function(Ic){return a.SLa(Ic.uU)});return ob?ob.cy?ld.DOMElementExtensions.isVisible(ob.cy):!1:!1};a.prototype.Brj=function(){var ob=this.$ia(function(Ic){return a.SLa(Ic.uU)});ob&&(ob.Nf(!0),this.raiseEvent("ca",ob.controlId))};a.prototype.initialize=function(){var ob=b(1342).DdaEventDispatch,Ic=void 0===this.$||null===this.$||mb.EwaSettings.la(261);void 0!==this.$&&null!==this.$||Ia.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");
Ic&&Ia.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(l.iGa(this.$),this.ea=this.$.ea,this.di=new ob(this.$),this.$.Pk(this.ud),this.ea.Tj(this.dd),this.ea.MP(this.Gq),this.ea.Bt(this.Mf),this.$.userOperationManager.kx(this.QR),this.Jlf(),this.qPi(),this.Yai(),this.$.da.Ha(35,this),this.YVc.ka(this),Ic&&Ia.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.wfe=new Ve.a,Ic&&Ia.ULS.sendTraceTag(537170521,
0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.zfe=new u(this.$,this.fj,this.di),this.nvg=new A(this.$,this.fj,this.di),this.xfe=new I(this.$,this.fj,this.di),this.vfe=new r(this.$,this.fj,this.di),this.ufe=new z(this.$,this.fj,this.di),this.yfe=new B(this.$,this.fj,this.di),this.Afe=new t(this.$,this.fj,this.di),this.Bfe=new w(this.$,this.fj,this.di),this.$.vba&&(this.Cfe=new v(this.$,this.fj,this.di)),mb.EwaSettings.la(191)&&(this.Z0a=new K(this,kc.g(this.$))),mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.tfe=new D),this.initialized=!0,Ia.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.nDh=function(ob){if(!this.PBa)return null;for(var Ic=0,Cc=this.PBa.length;Ic<Cc;Ic++)if(ob.startsWith(this.PBa[Ic].WebExtensionId))return this.PBa[Ic];return null};a.prototype.Jlf=function(){var ob,Ic=this.ea;if(Ic.rc&&!this.xOb){if(Ic.workbookContext){if(this.NSc=this.$.ea.oh.get(22),null===(ob=Ic.workbookContext.WebExtensions)||void 0===ob?0:ob.length){ob=Ic.workbookContext.WebExtensions;
Ic=!1;for(var Cc={},Uc=ob.length-1;0<=Uc;Cc={ROb:Cc.ROb},Uc--){if(!this.ea.isNamedObjectViewMode){Array.add(this.Goc,ob[Uc].InstanceId);if(1!==ob[Uc].WebExtensionType){Array.removeAt(ob,Uc);continue}if(Zc.HelperMethods.iw(ob[Uc])&&0!==ob[Uc].SharedRuntime.State)1===ob[Uc].SharedRuntime.State?ob[Uc].TaskpaneVisible=!1:2===ob[Uc].SharedRuntime.State?ob[Uc].TaskpaneVisible=!0:Ia.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!ob[Uc].ContainsCustomFunctions&&!ob[Uc].TaskpaneVisible&&
!Va.a(ob[Uc])){Array.removeAt(ob,Uc);continue}}var Tc=OSF.OsfControl.isFirstPartyStoreString(ob[Uc].PrimaryMarketplace.MarketplaceType);mb.EwaSettings.la(187)&&!Tc&&(Array.removeAt(ob,Uc),Ic||(Ic=!0,Cc.ROb=Jc.GetServiceTaskFactory.Wa(this.$.da,5,4,3),sa.TaskExtensions.Ba(Cc.ROb,function(ce){return function(){ce.ROb.result.ig(35,null)}}(Cc),this.ma,3)));mb.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&ob[Uc].PrimaryMarketplace&&a.SLa(ob[Uc].PrimaryMarketplace.SolutionId)&&
(Ia.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(ob,Uc))}this.hDe(ob)}}else this.NSc=!1;this.xOb=!0}};a.prototype.b6e=function(ob){var Ic=kc.g(this.$),Cc=Ic.ha.Pa.mc;if(Cc&&ob){ob=!1;if(this.Ff)for(var Uc=yl(this.Ff),Tc=Uc.next();!Tc.done;Tc=Uc.next())if(Tc=Tc.value,a.SLa(Tc.uU)||a.Lji(Tc.uU)){ob=!0;break}ob||Ic.ha.Pa.$G(Cc)}};a.prototype.qPi=function(){this.Ii&&this.ea.isNamedObjectViewMode&&this.$.pa&&$d.p(this.$.pa)&&(this.$.da.Aa(34).eR?
this.$.da.Aa(34).Lld():this.$.da.Aa(34).$q(this.vVi))};a.prototype.hDe=function(ob){var Ic=this,Cc=null;Cc=function(ce){function ye(){Ic.iPa.shift();0<Ic.iPa.length&&Cc(Ic.iPa[0])}var Kf=ce.WebExtensionData,yf=ce.IsTaskPane,Pf=ce.RecordHandler;if(Ic.uaa(Kf.PrimaryMarketplace.SolutionId))ye();else{yf&&(Kf.WebExtensionOsfControlType=1);var ec=Va.a(Kf);if(!yf||Kf.TaskpaneVisible||ec||Kf.SharedRuntime&&0!==Kf.SharedRuntime.State||Kf.ContainsCustomFunctions){var Qc=new V(Ic,Ic.di,Kf,!yf);Ia.ULS.sendTraceTag(537170517,
0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(Kf.PrimaryMarketplace.MarketplaceType,Kf.PrimaryMarketplace.MarketplaceRef,Kf.PrimaryMarketplace.SolutionId),Kf.PrimaryMarketplace.MarketplaceType,Zc.HelperMethods.iw(Kf));Qc.wld();Zc.HelperMethods.iw(Kf)&&(Qc.SHa=a.Tua(Kf,Ic.$),Kf.TaskpaneWidth=Ic.x5b);ec&&(Kf.WebExtensionToolTip="");yf&&Kf.TaskpaneVisible&&!ec&&(Kf.TaskpaneWidth=Ic.x5b);Array.add(Ic.Ff,Qc);var Dd=Ic.mxa=
null;Dd=of.a.instance.mC(function(){Qc.cy&&(sc.a.Fa(Dd),Dd=null,Pf&&Pf(ce,Qc),ye())},100,vc.a.Pbh)}else ye()}};for(var Uc={},Tc=0;Tc<ob.length;Uc={n1:Uc.n1},Tc++)if(!this.an(ob[Tc].InstanceId))if(1!==ob[Tc].WebExtensionType)this.y0a(ob[Tc]);else if(!mb.EwaSettings.la(54))this.ymb(ob[Tc],Cc);else if(this.$.Jd&8388608||ob[Tc].TaskpaneVisible)Uc.n1={},Uc.n1.marketplaceId=ob[Tc].PrimaryMarketplace.SolutionId,Uc.n1.marketplaceVersion=ob[Tc].PrimaryMarketplace.SolutionVersion,Uc.n1.storeType=ob[Tc].PrimaryMarketplace.MarketplaceType,
Uc.n1.storeId=ob[Tc].PrimaryMarketplace.MarketplaceRef,Uc.n1.targetData=ob[Tc],this.Ii.isAddinCommandsAsync(Uc.n1,function(ce){return function(ye,Kf,yf){if(ye){var Pf=yf.targetData;if(Kf){if(mb.EwaSettings.la(88))if(ce.n1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())ye=ce.n1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Kf=mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&ce.n1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),
(ye||Kf)&&Zc.HelperMethods.iw(Pf)&&Ic.ymb(Pf,Cc);else if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))Ic.L4h(yf,Cc);else{var ec=!1;Ic.KFd(function(Qc){if(!Qc.errorCode){if(Qc.value){Qc=yl(Qc.value);for(var Dd=Qc.next();!Dd.done&&!ec;Dd=Qc.next())ec=pc.c(Dd.value[1])===pc.c(Pf.PrimaryMarketplace.SolutionId)}ec?Zc.HelperMethods.iw(Pf)&&Ic.ymb(Pf,Cc):(Qc={},Qc.SolutionId=yf.marketplaceId,Qc.TargetType=Pf.WebExtensionType,Qc.Version=yf.marketplaceVersion,
Qc.StoreType=Pf.PrimaryMarketplace.MarketplaceType,Qc.StoreId=yf.storeId,Qc.AssetId=yf.marketplaceId,Qc.AssetStoreId=yf.storeId,Qc.Width=Pf.TaskpaneWidth,Pf.TaskpaneVisible=!0,Qc.Id=yf.marketplaceId,Qc.AppVersion=yf.marketplaceVersion,Qc.CurrentStoreType=Pf.PrimaryMarketplace.MarketplaceType,Ic.uke(Qc,Pf,Cc))}},!0)}}else Ic.ymb(Pf,Cc)}else ye=yf.targetData,Ia.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetAssetId(ye.PrimaryMarketplace.MarketplaceType,
ye.PrimaryMarketplace.MarketplaceRef,ye.PrimaryMarketplace.SolutionId),ye.PrimaryMarketplace.MarketplaceType)}}(Uc))};a.prototype.L4h=function(ob,Ic){var Cc=this,Uc=!1;this.KFd(function(Tc){var ce=ob.targetData;if(!Tc.errorCode){if(Tc.value){Tc=yl(Tc.value);for(var ye=Tc.next();!ye.done&&!Uc;ye=Tc.next())Uc=pc.c(ye.value[1])===pc.c(ce.PrimaryMarketplace.SolutionId)}Uc?Zc.HelperMethods.iw(ce)&&Cc.ymb(ce,Ic):(Tc={},Tc.SolutionId=ob.marketplaceId,Tc.TargetType=ce.WebExtensionType,Tc.Version=ob.marketplaceVersion,
Tc.StoreType=ce.PrimaryMarketplace.MarketplaceType,Tc.StoreId=ob.storeId,Tc.AssetId=ob.marketplaceId,Tc.AssetStoreId=ob.storeId,Tc.Width=ce.TaskpaneWidth,Tc.Id=ob.marketplaceId,Tc.AppVersion=ob.marketplaceVersion,Tc.CurrentStoreType=ce.PrimaryMarketplace.MarketplaceType,ce.TaskpaneVisible=!0,Cc.uke(Tc,ce,Ic))}},!0)};a.prototype.ymb=function(ob,Ic){var Cc={};Cc.WebExtensionData=ob;Cc.IsTaskPane=!0;this.iPa.push(Cc);1===this.iPa.length&&Ic(Cc)};a.prototype.uke=function(ob,Ic,Cc){var Uc=this,Tc={};Tc.ActivationInfo=
ob;Tc.WebExtensionData=Ic;Tc.IsTaskPane=!1;Tc.RecordHandler=function(ce,ye){var Kf=ce.ActivationInfo;Uc.Ii.insertBlankControlWithErrorUX(Uc.vFb(ye,Kf),function(){Uc.jQa(ye.controlId);Uc.Ii.purgeOsfControl(ye.controlId,!1);Uc.rag(Kf)})};this.iPa.push(Tc);1===this.iPa.length&&Cc(Tc)};a.prototype.rag=function(ob){var Ic={};Ic.solutionId=ob.SolutionId;Ic.version=ob.Version;Ic.storeType=ob.StoreType;Ic.storeId=ob.StoreId;Ic.assetId=ob.AssetId;Ic.assetStoreId=ob.AssetStoreId;Ic.targetType=ob.TargetType;
Ic.sharedRuntimeId=ob.SharedRuntimeId;Ic.id=ob.Id;Ic.currentStoreType=ob.CurrentStoreType;Ic.appVersion=ob.AppVersion;ob=new Ub.a;ob.add(Ic);Ic={};Ic[Za.a.IFa]=ob;Ic[Za.a.xJ]=3;ob=new od.a(Ce.a.GAb,0,this.$.hd,0,null);this.$.Ka.Yb(ob,Ic)};a.prototype.vFb=function(ob,Ic){var Cc={};Cc.div=ob.cy;Cc.id=ob.controlId;Cc.solutionId=Ic.SolutionId;Cc.version=Ic.Version;Cc.storeId=Ic.StoreId;Cc.storeType=Ic.StoreType;Cc.osfControlType=OSF.OsfControlTarget.TaskPane;Cc.marketplaceID=Ic.Id;Cc.marketplaceVersion=
Ic.AppVersion;Cc.store=Ic.StoreId;return Cc};a.prototype.MTf=function(){var ob=this;if(mb.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var Ic=[],Cc=0;Cc<this.Ff.length;Cc++){var Uc=this.Ff[Cc];0!==Uc.osfControlType&&3!==Uc.osfControlType&&4!==Uc.osfControlType||Array.add(Ic,Uc)}Cc=!1;for(Uc=0;Uc<Ic.length;Uc++){var Tc=Ic[Uc];this.jQa(Tc.controlId);!Cc&&Tc&&Tc.dl&&(Cc=Zc.HelperMethods.iw(Tc.dl))}Cc&&(Ic={},Ic=(Ic.DynamicAddinCommandsMethodDispatchId=4,
Ic),this.hK(-1014260128,Ic))}mb.EwaSettings.la(413)&&sa.TaskExtensions.Ba(Jc.GetServiceTaskFactory.Wa(this.$.da,278,279,3),function(ce){ce&&(ce=ce.result)&&(ob.$.da.Aa(278)||ob.$.da.Ha(278,ce),ce.xbf().cna())},this.ma,3)};a.prototype.nL=function(){var ob=this,Ic=new m(this.$,this.fj,this.KUf);void 0===this.$||null===this.$?Ia.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):mb.EwaSettings.la(261)&&Ia.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.fj||null===this.fj));if(Ic.ADi()){var Cc=function(){},Uc=function(ye){ye=Se.a.og(ye.data);Ia.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",wf.a.Uc(ye))},Tc=Ic.zRg();Ic=function(ye,Kf,yf){return ke.i(ob.$.na.ta,"ExecuteRichApiRequest",ob.BRg(Tc),oc.b(ye,Cc),oc.a(Kf,Uc),yf,null,0)};var ce=a.Ufd(Tc);mb.EwaSettings.tc()?this.$.userOperationManager.Mt(new qd.a(507,0,Ic,ce|64)):this.$.userOperationManager.Mt(new Fc.a(507,
0,Ic,ce))}};a.prototype.BRg=function(ob){var Ic=this.$.na.ta.Na(1);Ic.request=ob;return Ic};a.prototype.iye=function(ob,Ic){if(ob)for(var Cc=0;Cc<ob.length;Cc++)if(wc.a.equals(ob[Cc],Ic,!0))return!0;return!1};a.prototype.DQg=function(ob){var Ic={};Ic.navigationMode=OSF.OsfNavigationMode.DefaultMode;Ic.assetId=null;Ic.category=null;if(!ob||3>ob.length)return Ic;if(ob[0]){var Cc=parseInt(ob[0],10);isNaN(parseInt(Cc,10))||(Ic.navigationMode=Cc)}ob[1]&&(Ic.assetId=ob[1]);ob[2]&&(Ic.category=ob[2]);return Ic};
a.prototype.Yai=function(){if(mb.EwaSettings.la(62)){var ob=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(ob&&"*"!==ob.trim()){this.IIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new la(this),ob,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.jg.get(2));try{this.IIa.init()}catch(Ic){try{this.IIa.dispose()}catch(Cc){}this.IIa=null;Ia.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Ic.message)}ob={};ob.a=this.$.ya.UserSessionId;
Qd.b().Qe(39,ob)}}};a.prototype.z3f=function(ob,Ic,Cc){var Uc=this,Tc=a.RPg(ob[0]),ce=Tc.Aha,ye=Tc.via;Tc.Aha=function(){ce&&ce();var Kf=Tc.tLa!==OSF.InfoType.Error?Ic:null;ob.shift();ob.length?Uc.z3f(ob,Kf,Cc):Kf&&Kf()};Tc.via=function(){ye&&ye();Cc&&Tc.tLa!==OSF.InfoType.Error&&Cc()};Gb.a.lRd(Tc)};a.prototype.WRh=function(){var ob={};ob.AddinRibbonControlsOverriddenByApi=mb.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();ob.AddinActionDefinitionHybridMode=
mb.EwaSettings.la(665).toString();ob.UseActionIdForUILessCommand=mb.EwaSettings.la(669).toString();ob.AllowStorageAccessByUserActivationOnIFrame=mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();ob.RequirementSetRibbonApiOnePointTwo=mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();ob.flightingTreatmentVariables=Ta.AFrameworkApplication.ga.L9b;ob.ShortcutInfoArrayInUserPreferenceData=
mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return ob};a.getSolutionId=function(ob){var Ic=ob.PrimaryMarketplace.SolutionId;mb.EwaSettings.la(298)&&ob.OwnerAddinSolutionId&&(Ic=ob.OwnerAddinSolutionId);return Ic};a.Ufd=function(ob){var Ic=0;mb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ob.RequestFlags&1&&256!==(ob.RequestFlags&256)||(Ic=16):Ic=ob.RequestFlags&1?0:16;return Ic};a.Tua=function(ob,
Ic){Ic=a.getSolutionId(ob,Ic);return a.jZe(Ic,ob.PrimaryMarketplace.SolutionVersion,ob.PrimaryMarketplace.MarketplaceType,ob.PrimaryMarketplace.MarketplaceRef)};a.t9g=function(ob){var Ic={};ob=(Ic.recording=ob,Ic);return JSON.stringify(ob)};a.S4g=function(ob){var Ic={};Ic.visibility=ob?"Visible":"Hidden";return JSON.stringify(Ic)};a.dOh=function(ob){var Ic=ob.getSolutionId(),Cc=ob.getVersion(),Uc=ob.getStoreType();ob=ob.getStoreId();return a.jZe(Ic,Cc,Uc,ob)};a.jZe=function(ob,Ic,Cc,Uc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",ob,Ic,a.PZh(Cc).toString(),Uc)};a.Qhd=function(ob,Ic){var Cc=ob.split("|");if(7>Cc.length)return Ia.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Cc[0])return Ia.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Cc[0]),null;var Uc=Cc[1],Tc=Cc[2],ce=a.QZh(Cc[3]),ye=Cc[4];Cc=Cc[5];Uc&&Uc.length||(Uc=Cc);Cc={};Cc.InstanceId=String.format("{{{0}}}",Ob.a.create().toString());
Cc.WebExtensionOsfControlType=4;Cc.WebExtensionType=1;Cc.PrimaryMarketplace={};Cc.PrimaryMarketplace.SolutionId=Uc;Cc.PrimaryMarketplace.SolutionVersion=Tc;Cc.PrimaryMarketplace.MarketplaceRef=ye;Cc.PrimaryMarketplace.MarketplaceType=ce;Cc.ContainsCustomFunctions=Ic?!0:!1;Ic&&(Cc.OsfPropertyBag=[["customFunctionAddinId",ob]]);return Cc};a.QZh=function(ob){ob=parseInt(ob,10);return ob===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:ob===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:ob===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:ob===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:ob===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:ob===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:ob===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:ob===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:ob===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:ob===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:ob===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.PZh=function(ob){return ob===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:ob===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:ob===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:ob===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:ob===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:ob===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:ob===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:ob===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
ob===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:ob===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:ob===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.grb=function(ob){var Ic={};Ic.Version=ob.appVersion;Ic.AssetId=ob.assetId;Ic.AssetStoreId=null!==ob.assetStoreId?ob.assetStoreId.toString():null;Ic.StoreType=ob.storeType;Ic.Height=ob.height;Ic.SolutionId=ob.solutionId;Ic.StoreId=ob.storeId;Ic.TargetType=ob.targetType;Ic.Width=1===Ic.TargetType?
0:ob.width;Ic.SharedRuntimeId=ob.sharedRuntimeId;Ic.AppVersion=ob.appVersion;Ic.CurrentStoreType=ob.currentStoreType;Ic.Id=ob.id;return Ic};a.wyb=function(ob){return ob===OSF.DDA.EventDispId.dispidSettingsChangedEvent||ob===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||ob===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ob===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||ob===OSF.DDA.EventDispId.dispidRichApiMessageEvent||ob===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
ob===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||ob===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.RPg=function(ob){return Object.assign(new Be.a,{tLa:ob.infoType,id:ob.id,title:ob.title,description:ob.description,buttonText:ob.buttonTxt,Aha:ob.buttonCallback,Ddc:ob.highPriority,via:ob.dismissCallback,errorCode:ob.errorCode,A$e:ob.iframeNotificationUrl})};a.SLa=function(ob){var Ic="FA000000014"===ob;Ic||(Ic="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===ob);
return Ic};a.Lji=function(ob){return"FA000000005"===ob};Qk.Object.defineProperties(a.prototype,{s_b:{configurable:!0,enumerable:!0,get:function(){return this.bfa||(this.bfa=new fc.a(this.$.Vv))}},Ii:{configurable:!0,enumerable:!0,get:function(){if(!this.Om){var ob={},Ic=!(this.$.Jd&1),Cc=mc.a.current.aL,Uc=this.$.workbookContext,Tc=$a.a.zL+$a.a.E2b,ce=0;mb.EwaSettings.la(509)&&(ce|=2);ob.pageBaseUrl=Cc.LayoutsContentUrlPrefix;ob.appName=OSF.AppName.ExcelWebApp;ob.appVersion="16";ob.appSettings=this.WRh();
ob.singleSignOnSettings=wb.AppsForOfficeSingleSignOnManager.uZh();ob.clientMode=Ic?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;ob.appUILocale=this.$.ya.UICultureTag;ob.dataLocale=this.$.ya.DataCultureTag;ob.docUrl=Uc.ClientUrl;ob.hostControl=this;ob.formFactor=OSF.FormFactor.Default;ob.lcid=this.$.OI.toString();ob.localizedScriptsUrl=$a.a.zL+$a.a.U1c;ob.localizedImagesUrl=Tc;ob.localizedStylesUrl=$a.a.zL+$a.a.hBe;ob.localizedResourcesUrl=Tc;ob.osfOmexBaseUrl=Cc.OsfOmexBaseUrl;ob.firstPartyManifestCDNUrl=
Cc.FirstPartyAddInManifestCDN;ob.sdxAssetsToPrefetchMapping=Ta.AFrameworkApplication.ga.Ua("SdxAssetsToPrefetchMapping");ob.sdxCdnUrl=Cc.SdxCdnUrl;ob.sdxDmsUrl=Cc.SdxDmsUrl;ob.devCatalogUrl=Cc.DevCatalogUrl;ob.controlStatusChanged=this.fma;ob.notifyHost=this.jBf;ob.allowExternalMarketplace=this.$.ea.oh.get(27)&&a.F2c;ob.enableAddinCommands=mb.EwaSettings.la(54);ob.enableBlackForestRedirect=mb.EwaSettings.la(89);ob.enableMyOrg=this.$.ea.oh.get(33);ob.enableMyApps=this.$.ea.oh.get(34);ob.enableDevCatalog=
mb.EwaSettings.la(45);ob.enablePrivateCatalog=this.$xj();ob.enableTaskpaneUpgradeToAppCommand=mb.EwaSettings.la(94);ob.showSignOutFromPrivateCatalogMessage=this.$.ea.oh.get(36);ob.enableUploadFileDevCatalog=mb.EwaSettings.la(54)&&!mb.EwaSettings.la(286);ob.userNameHashCode=db.a.Qv(Ta.AFrameworkApplication.userName);ob.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();ob.enableSingleSignOnForAddin=!mb.EwaSettings.la(24)&&Ta.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;
ob.enableDisplayBlockedMinorError=mb.EwaSettings.la(184);ob.hideAppsExtensionUrl=Ta.AFrameworkApplication.hideAppsExtensionUrl;ob.enableAnonymousUseLegacyCatalogService=mb.EwaSettings.la(174);ob.enableInsertDialogAccessibilityFix=mb.EwaSettings.la(181);ob.disableAppsForOfficeThirdParty=mb.EwaSettings.la(187);ob.enableFirstPartySSO=mb.EwaSettings.la(199);ob.wacSessionId=this.$.ya.UserSessionId;ob.disableLogging=!this.$.ya.AriaLoggingIsEnabled;ob.enableFirstPartySDXErrorMessages=mb.EwaSettings.la(212);
ob.enableRichApiCellEditDelay=mb.EwaSettings.la(191);ob.isHostDocumentDomain=mb.EwaSettings.la(228);ob.loggableUserId=Ta.AFrameworkApplication.ga.Ua("LoggableUserId");ob.sessionStartInfoJson=Ta.AFrameworkApplication.ga.Ua("SessionStartInfoJson");ob.wopiHostOriginFromPostMessage=Ta.AFrameworkApplication.wopiHostOriginFromPostMessage;ob.wopiHostOriginFromWacPropBag=Ta.AFrameworkApplication.ga.Ua("PostMessageOrigin");ob.wacIsEmbedded=Ta.AFrameworkApplication.ga.ra("IsEmbedded");ob.accessibilityAllowFocusAddinTaskpane=
Ta.AFrameworkApplication.ga.ra("AccessibilityAllowFocusAddinTaskpane");ob.enableRemoveAppCommandsAddin=Ta.AFrameworkApplication.ga.ra("RemoveAppCommandsAddinIsEnabled");ob.isHostFrameTrustCheckEnabledForAddIns=Ta.AFrameworkApplication.ga.ra("HostFrameTrustCheckIsEnabledForAddIns");ob.isHostFrameTrusted=Ta.AFrameworkApplication.isHostFrameTrusted;ob.agaveAddinUploadEnabled=mb.EwaSettings.la(47);ob.hostAllowedOfficeStore=Ta.AFrameworkApplication.ga.ra("HostAllowedOfficeStore");ob.hostAllowedSdxEmbedding=
Ta.AFrameworkApplication.ga.ra("HostAllowedSdxEmbedding");ob.hostInstallAddIns=Ta.AFrameworkApplication.ga.Ua("HostInstallAddIns");ob.hostInstallAddInsIsEnabled=Ta.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled");ob.approvedAddIns=Ta.AFrameworkApplication.ga.Ua("ApprovedAddIns");ob.addinEnforceHttpsIsEnabled=this.hxj(ob.sessionStartInfoJson);ob.hostFeatureGateFlag=ce;ob.isUpnCheckEnabled=Ta.AFrameworkApplication.ga.ra("IsUpnCheckEnabled");ob.wacUpn=Ta.AFrameworkApplication.ga.Ua("UserPrincipalName");
ob.isReactRibbonEnabled=Nb.a.isReactRibbonEnabled();ob.enableSetFocusOnTaskpaneOnUserAction=mb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);ob.isSafariWithIndexedDBDisabled=mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Db.a.O6a;ob.isIndexedDBDisabled=mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Db.a.O6a||mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Db.a.Df;ob.enableCustomShortcuts=mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");ob.changeGetModifierKeyStringOutputOrder=mb.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.Om=new OSF.ContextActivationManager(ob);ob={};this.Om.setIframeAttributeBag((ob.frameborder=0,ob.marginheight=0,ob.marginwidth=0,ob));this.Om.setWSA(Ta.AFrameworkApplication.Lm);this.Om&&"undefined"!==typeof this.Om.hostCheckReadyHandler&&Ta.AFrameworkApplication.AFg(Object(hc.a)(this.Om,
this.Om.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var ye=nb.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Om.setOAuthManager(ye)}catch(Kf){}}return this.Om}},iYj:{configurable:!0,enumerable:!0,get:function(){return this.NSc}},fj:{configurable:!0,enumerable:!0,get:function(){return this.wfe}},$ma:{configurable:!0,enumerable:!0,get:function(){return this.tfe}},JLd:{configurable:!0,enumerable:!0,get:function(){return this.xfe}},ILd:{configurable:!0,enumerable:!0,get:function(){return this.vfe}},
Hjj:{configurable:!0,enumerable:!0,get:function(){return this.zfe}},Fjj:{configurable:!0,enumerable:!0,get:function(){return this.ufe}},Gjj:{configurable:!0,enumerable:!0,get:function(){return this.yfe}},Ijj:{configurable:!0,enumerable:!0,get:function(){return this.Afe}},Jjj:{configurable:!0,enumerable:!0,get:function(){return this.Bfe}},KLd:{configurable:!0,enumerable:!0,get:function(){return this.Cfe}},GV:{configurable:!0,enumerable:!0,get:function(){return this.Jqg}},$:{configurable:!0,enumerable:!0,
get:function(){return this.vb}}});Qk.Object.defineProperties(a,{F2c:{configurable:!0,enumerable:!0,get:function(){return a.b4d},set:function(ob){a.b4d=ob}}});a.R0a=new Ec.a;a.b4d=!0;Object(eb.a)(a,"DdaFacade",jc.a,[207,849,711,850,851,2])},869:function(y,F,b){function a(){this.ZHd=0;this.KW={};this.Vsa={}}b.d(F,"a",function(){return a});y=b(0);var c=b(13),d=b(109);a.prototype.sVh=function(l,n){return this.KW[a.JYc(l,n)]};a.prototype.rLe=function(l,n){n||void 0!==this.Vsa[l]&&null!==this.Vsa[l]?n&&
void 0!==this.Vsa[l]&&null!==this.Vsa[l]&&delete this.Vsa[l]:this.Vsa[l]=1};a.prototype.k_b=function(l){return void 0===this.Vsa[l]||null===this.Vsa[l]};a.prototype.O3h=function(l){var n=a.JYc(l.messageType,l.targetId);1===l.actionType?this.g5h(l.controlId,l.messageType,n):2===l.actionType&&this.R5h(l.controlId,l.messageType,n)};a.prototype.Eaj=function(l){if(l){var n=Object.keys(this.KW);if(!(void 0===n||null===n||0>=n.length)){n=yl(n);for(var m=n.next();!m.done;m=n.next()){m=m.value;var f=this.KW[m];
f[l]&&(delete f[l],Object.keys(f).length||delete this.KW[m])}}}};a.prototype.XZ=function(l,n){l=a.JYc(l,n);l=this.KW[l];return!!l&&0<Object.keys(l).length};a.prototype.I6h=function(){return!d.a.isEmpty(this.KW)};a.prototype.iif=function(){return 0<this.ZHd};a.prototype.NPh=function(){var l=[],n=this.KW,m;for(m in n){var f=m,v=n[m],w;for(w in v){v=w;var t={};t.eventType=parseInt(f.split("#")[0],10);t.targetId=f.split("#")[1];t.addinId=v;l.push(t)}}return l};a.prototype.g5h=function(l,n,m){if(this.KW[m])m=
this.KW[m],m[l]=m[l]?m[l]+1:1;else{var f={};f[l]=1;this.KW[m]=f}100===n&&this.ZHd++};a.prototype.R5h=function(l,n,m){if(this.KW[m]){var f=this.KW[m];if(l){var v=f[l];1===v?(delete f[l],Object.keys(f).length||delete this.KW[m]):f[l]=v-1;100===n&&this.ZHd--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",l,m)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",m)};a.JYc=function(l,n){return String.format("{0}#{1}",
l,n)};a.YW="Workbook";Object(y.a)(a,"RichApiEventRegistration",null,[])},894:function(y,F,b){function a(c,d,l,n){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=d;this.ddaBinding=l;this.ArrayData=void 0===n?null:n}b.d(F,"a",function(){return a});y=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(y.a)(a,"DdaEventArgs",null,[])},941:function(y,F,b){function a(d,l,n){this.DPb=
d;this.Dkg=l;this.Ekg=n}function c(){this.title=this.id=this.tabs=null}y=b(0);Object(y.a)(c,"AddInDataTransferObject",null,[]);b.d(F,"a",function(){return a});a.eub=function(d){return(d=d.mW)?Object.assign(new c,{tabs:d.Mr.toArray(),id:d.ABg,title:d.BBg}):null};Qk.Object.defineProperties(a.prototype,{Mr:{configurable:!0,enumerable:!0,get:function(){return this.DPb}},ABg:{configurable:!0,enumerable:!0,get:function(){return this.Dkg}},BBg:{configurable:!0,enumerable:!0,get:function(){return this.Ekg}}});
Object(y.a)(a,"OneLineRibbonExtensibility",null,[])},949:function(y,F,b){function a(){var d={};this.t$c=(d.tabhome="Ribbon.Home",d.tabinsert="Ribbon.Insert",d.tabdata="Ribbon.Data",d.tabreview="Ribbon.Review",d.tabview="Ribbon.View",d);d={};this.r$c=(d.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.fa(1588),c.a.instance.fa(1592)],d.tabformulas=["Ribbon.Formulas",c.a.instance.fa(1589),c.a.instance.fa(1593)],d.tabdeveloper=["Ribbon.Developer",c.a.instance.fa(1590),c.a.instance.fa(1594)],
d.tabaddins=["Ribbon.AddIns",c.a.instance.fa(1591),c.a.instance.fa(1595)],d);this.$yh="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");this.i2a=null}b.d(F,"a",function(){return a});y=b(0);var c=b(14);a.prototype.UTh=function(){if(this.i2a)return this.i2a;this.i2a={};for(var d=yl(Object.keys(this.t$c)),l=d.next();!l.done;l=d.next())l=l.value,this.i2a[l]=this.t$c[l];d=yl(Object.keys(this.r$c));for(l=d.next();!l.done;l=
d.next())l=l.value,this.i2a[l]=this.r$c[l][0];return this.i2a};Qk.Object.defineProperties(a.prototype,{eia:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},lK:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},bzc:{configurable:!0,enumerable:!0,get:function(){return this.t$c}},d$a:{configurable:!0,enumerable:!0,get:function(){return this.$yh}},EBi:{configurable:!0,enumerable:!0,
get:function(){return this.r$c}}});Object(y.a)(a,"AddinCommandsStringProvider",null,[852])},985:function(y,F,b){function a(Q,la){this.lEc=new t.a;this.Om=Q;this.ayg=la}function c(Q,la,ba,S){this.pT=new v.a;this.xG=new v.a;this.qpa=null;this.Ukb=new v.a;this.U$d=Promise.resolve(null);this.mhe=!1;this.cVb=la;this.kng=Q;this.Ohe=ba;this.Ikg=S}function d(){var Q=l.call(this)||this;Q.errorCode=0;return Q}function l(){this.iQb=new v.a;this.S9=this.R9=!1;this.joa=this.authChallenge=null;this.startTime=this.retryCount=
0;this.Xoe=null}function n(){this.token=null;this.expiresOn=0;this.mha=this.authChallenge=null}function m(){this.accessToken=null}function f(){this.startTime=0;this.callback=null}b.r(F);y=b(0);var v=b(185),w=b(13),t=b(100);Object(y.a)(f,"SSOCallbackInfo",null,[]);Object(y.a)(m,"AccessTokenInformation",null,[145]);var A=b(1117);Object(y.a)(n,"CachedTokenInfo",null,[]);Qk.Object.defineProperties(l.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.iQb}}});Object(y.a)(l,"SSORequestInfo",
null,[]);vm(d,l);Object(y.a)(d,"SSOFailedRequestInfo",l,[]);var x=b(5);c.prototype.czj=function(Q){if(this.qpa&&this.qpa.authChallenge===Q.authChallenge){if(Date.now()/1E3+c.Izi>this.qpa.expiresOn)return this.qpa=null,!1;Q=new A.a;Q.token=this.qpa.token;Q.expiresOn=this.qpa.expiresOn;Q.mha=this.qpa.mha;Q.aTa=!0;Q.Svb=0;this.kwb(Q);return!0}return!1};c.prototype.Gxj=function(Q){for(var la=0;la<this.xG.count;la++)if(this.xG.oa(la).authChallenge===Q.authChallenge&&this.xG.oa(la).joa===Q.joa){var ba=
void 0;(ba=this.xG.oa(la)).retryCount=ba.retryCount+1;Q.retryCount=this.xG.oa(la).retryCount;if(this.xG.oa(la).retryCount<c.eAi||!this.xG.oa(la).R9&&Q.R9||!this.xG.oa(la).S9&&Q.S9){if(!this.xG.oa(la).R9&&Q.R9||!this.xG.oa(la).S9&&Q.S9)Q.retryCount=0;this.xG.removeAt(la);break}Q=new A.a;Q.errorCode=this.xG.oa(la).errorCode;this.kwb(Q);return!0}return!1};c.prototype.qDg=function(Q,la){for(var ba=0;ba<this.xG.count;ba++)if(this.xG.oa(ba).joa===Q.joa&&this.xG.oa(ba).authChallenge===Q.authChallenge)return;
this.xG.add(Object.assign(new d,{R9:Q.R9,S9:Q.S9,authChallenge:Q.authChallenge,joa:Q.joa,errorCode:la,retryCount:Q.retryCount}))};c.prototype.Tcd=function(Q,la,ba,S,H,T){var K=this,da=b(985).AppsForOfficeSingleSignOnManager;""===ba&&(ba=null);if(this.mhe)da.O5(T,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var fa=null,W=yl(this.pT),ca=W.next();!ca.done;ca=W.next())if(ca=ca.value,ca.R9===Q&&ca.S9===la&&ca.authChallenge===ba&&ca.joa===H){fa=ca;break}fa||(fa=Object.assign(new l,
{R9:Q,S9:la,authChallenge:ba,Xoe:S,joa:H,retryCount:0,startTime:da.ew()}),this.pT.add(fa));fa.retryCount=0;fa.callbacks.add(T);this.U$d=this.U$d.then(function(){var ia=b(985).AppsForOfficeSingleSignOnManager;if(0<K.pT.count){var ea=K.pT.oa(0);if(K.czj(ea)||K.Gxj(ea))return null;for(var qa=0;qa<K.Ukb.count;)K.Ukb.oa(qa)+c.wKj<ia.ew()?K.Ukb.removeAt(qa):qa++;if(K.Ukb.count>=c.$zi||K.pT.count>=c.Fzi)return ea=new A.a,ea.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,K.kwb(ea),null;
var pa=null;x.AFrameworkApplication.sa&&(ia=x.AFrameworkApplication.sa.vD)&&(pa=ia.Ic("ComponentAttach",K.kng+c.Wwg));return ea.joa.wzg(K.resource,ea.R9,ea.S9,ea.authChallenge,K.Ikg,ea.Xoe).then(function(Pa){pa&&pa.stop();K.kwb(Pa)},function(){pa&&pa.stop();var Pa=new A.a;Pa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;K.kwb(Pa)})}return null})}};c.prototype.kwb=function(Q){var la=b(985).AppsForOfficeSingleSignOnManager;try{if(this.pT.count){var ba=this.pT.oa(0);this.pT.removeAt(0);
var S=null;Q.errorCode||(S=new m,S.accessToken=Q.token);Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.qDg(ba,Q.errorCode);var H={};null!=Q.Svb&&(H.getTokenSilentTime=Q.Svb.toString());null!=Q.vhd&&(H.getTokenPopupTime=Q.vhd.toString());null!=Q.ffd&&(H.getIDTokenTime=
Q.ffd.toString());null!=Q.aTa&&(H.tokenCached=Q.aTa.toString());Q.YUd&&(H.detailedError=Q.YUd);Q.mha&&(H.authLibrary=Q.mha);ba.retryCount&&(H.retryCount=ba.retryCount);for(var T=yl(ba.callbacks),K=T.next();!K.done;K=T.next())la.O5(K.value,Q.errorCode,S,H);null!=Q.aTa&&Q.aTa||this.Ukb.add(ba.startTime);if(!Q.errorCode)for(null!=Q.expiresOn&&(this.qpa=Object.assign(new n,{token:Q.token,expiresOn:Q.expiresOn,authChallenge:ba.authChallenge,mha:Q.mha})),this.xG.clear(),T=0;T<this.pT.count;)if(this.pT.oa(T).authChallenge===
ba.authChallenge){var da=yl(this.pT.oa(T).callbacks);for(K=da.next();!K.done;K=da.next())la.O5(K.value,Q.errorCode,S,H);this.pT.removeAt(T)}else T++}}catch(fa){w.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",fa.message)}};c.prototype.shutdown=function(){this.mhe=!0;this.pT.clear()};Qk.Object.defineProperties(c.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.cVb}}});c.wKj=6E4;c.$zi=6;c.Fzi=6;c.eAi=3;c.Izi=300;c.Wwg="GetAccessToken";
Object(y.a)(c,"SSOCallbackManager",null,[]);var u=b(845),B=b(857),r=b(116),I=b(78),z=b(23),D=b(29),V=b(151),U=b(337);b.d(F,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Ucd=function(Q,la,ba,S,H,T,K,da,fa,W){W=Object.assign(new f,{startTime:a.ew(),callback:W});try{var ca=!!ba&&""!==ba,ia=W.startTime,ea=this.getOsfControl(Q),qa=ea.getStoreType()||"",pa=ea.getOwnerAddinStoreType()||"",Pa=ea.getSolutionId()||"",Ha=ea.getVersion()||"";qa=qa.toLowerCase();pa=pa.toLowerCase();Pa=Pa.toLowerCase();
var Ya=I.a.efd(la)||"",Na=I.a.efd(ea.getIframeUrl())||"",eb=Ya.toLowerCase()===Na.toLowerCase();Ya=qa;"inmemory"===qa&&(Ya=pa);var Ia=Telemetry.PrivacyRules.GetAssetId(Ya,ea.getStoreId(),Pa);ea={};var lb=(ea.callInstanceId=ia.toString(),ea.controlAssetId=Ia,ea.controlVersion=Ha,ea.storeType=qa,ea.ownerStoreType=pa,ea.allowConsentPrompt=S.toString(),ea.forMSGraphAccess=H.toString(),ea.allowSignInPrompt=T.toString(),ea.hasAddinAuthChallenge=ca.toString(),ea.securityOriginEqualsSourceLocation=eb.toString(),
ea.singleSignOnEnabled=K.toString(),ea.accountTypeFilter=da||"",ea);w.ULS.sendTraceTag(51401115,344,50,"{0}",lb);V.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:r.a.Qk(lb)}));ia=!0;var hc=x.AFrameworkApplication.ga.Ua("HostAuthType");switch(da){case "aad":ia="aad"===hc;break;case "msa":ia="msa"===hc;break;default:ia=!da||"noFilter"===da}if(ia){da=null;if(K)for(var ma=yl(this.ayg),Ja=ma.next();!Ja.done;Ja=ma.next()){var Ta=Ja.value;
if(Ta.iii(Pa)){da=Ta;break}}da?this.isSSOAddin(Q)?(K=!0,"omex"===Ya&&(K=!1),"spapp"===Ya||"spcatalog"===Ya?(w.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.O5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):H&&!K?(w.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.O5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(H&&"exchange"===Ya&&
(S=!1),this.Tcd(Q,la,ba,Ya,S,T,fa,da,W))):(w.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.O5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.O5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.O5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(pb){this.Gjc(),w.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",pb.message),a.O5(W,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(Q,la,ba,S){this.Ucd(Q,ba[u.a.EVc]||null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,la,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,S)};a.prototype.Tcd=function(Q,la,ba,S,H,T,K,da,fa){this.lEc.xb(Q)?S=this.lEc.oa(Q):(S=new c(Q,this.getWebApplicationResource(Q).split(",")[0],S,this.getDefaultDisplayName(Q)),this.lEc.add(Q,S));var W=S.resource;Q=a.OXh(W,this.getWebApplicationId(Q));var ca=OfficeExt.WACUtils.getHostSecure(la);Q&&ca?Q.toLowerCase()===ca.toLowerCase()?S.Tcd(H,T,ba,K,da,fa):(a.DNa('SSO Resource "'+W+'" cannot be used from "'+la+'" origin due to domain mismatch.'),
w.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.O5(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(Q||w.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ca||w.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.O5(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.Gjc=function(){var Q={};w.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",
(Q.UserAgent=window.navigator.userAgent,Q))};a.prototype.getOsfControl=function(Q){return this.Om.getOsfControl(Q)};a.prototype.isSSOAddin=function(Q){return this.getOsfControl(Q).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(Q){return this.getOsfControl(Q).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(Q){return this.getOsfControl(Q).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(Q){return this.getOsfControl(Q).getManifest().getDefaultDisplayName()};
a.uZh=function(){try{var Q={};z.a.Wka&&B.a.bxb&&(Q.UiHostSupportsAuthTokenAddinList=a.AUe);Q.UiHostSupportsAuthToken=B.a.bxb;return Q}catch(la){w.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",la.message)}return null};a.getInstance=function(Q,la,ba){ba=void 0===ba?null:ba;a.Oa||(la=new v.a,ba&&la.add(ba.jyi),a.Oa=new a(Q,la));return a.Oa};a.DNa=function(Q){window.console.warn&&window.console.warn(Q)};a.OXh=function(Q,la){if(!Q)return"";la||(la="");var ba=
Q.toLowerCase(),S=la.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(S)||(a.DNa('SSO App Id "'+la+'" is not a valid format. It will be rejected from store submission.'),w.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));ba.endsWith(S)||(a.DNa('SSO Resource "'+Q+'" does not end with App Id "'+la+'". It will be rejected from store submission.'),w.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!ba.startsWith("https://")&&
!ba.startsWith("api://"))return a.DNa('SSO Resource "'+Q+'" must be https:// or api:// protocol.'),w.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(la=0;la<Q.length;la++){S=Q.charAt(la);var H=D.a.charCodeAt(Q,la);if(33>H||126<H||"&"===S||"?"===S||"#"===S||"%"===S||"\\"===S)return a.DNa('SSO Resource "'+Q+'" contains an invalid character "'+S+'".'),w.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+S+"' in resource URI."),""}if(0<=Q.indexOf("::"))return a.DNa('SSO Resource "'+
Q+'" contains an invalid string "::".'),w.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<Q.length)return a.DNa('SSO Resource "'+Q+'" is '+Q.length+" characters and exceeds the max length of 120 characters."),w.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+Q.length+"."),"";ba.startsWith("api://")&&(ba="https://"+ba.substring(6,ba.length));return 8===ba.length?"":OfficeExt.WACUtils.getHostSecure(ba)||""};a.O5=function(Q,la,ba,S){var H=Q.startTime,T=0;0<H&&(T=a.ew()-H);
var K={};H=(K.callInstanceId=H.toString(),K.callDuration=T.toString(),K.errorCode=la.toString(),K);if(S)for(var da in S)H[da]=S[da];w.ULS.sendTraceTag(51401116,344,50,"{0}",H);V.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:r.a.Qk(H)}));Q.callback(la,ba)};a.ew=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(Q){}return Date.now()};a.AUe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
a.Oa=null;Object(y.a)(a,"AppsForOfficeSingleSignOnManager",null,[111])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/244ebe54d76cda8a49b65f7044ccdf10/EwaDS.agave.js.map