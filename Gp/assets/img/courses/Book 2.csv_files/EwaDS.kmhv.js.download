(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1082:function(y,F,b){function a(u,B){var r=this;this.dd=function(){f.a.yg(w.a(r.$).rd.activityState,x.a.Ryd)||r.raa.reset()};this.$=B;this.fkc=u;this.ea=B.ea;this.ea.Tj(this.dd);this.raa=A.a.Mse(this.$)}function c(u){var B=this;this.ij=this.jDc=null;this._state=0;this.moveNext=function(){try{for(B._state=1;1===B._state;)B.vu=B.vu()}catch(r){B.dispose(),B._state=3}};this.Bf=u;this.vu=this.TL;this.moveNext()}b.r(F);y=b(0);
var d=b(13),l=b(35),n=b(200),m=b(114),f=b(32),v=b(1),w=b(65),t=b(52);c.prototype.TL=function(){this.jDc=this.Bf.$.Wb.Ic("LoadResource","DownloadACopyOperation");return this.S_d};c.prototype.S_d=function(){var u=b(1082).DownloadACopyOperation;if(this.Bf.raa.z$e||!(this.jDc.Ec<u.Bkc))return this.Thg;this.ij=t.Task.delay(u.OJe).g();this.ij.isCompleted||(this._state=2,this.ij.IN(this.moveNext));return this.Afb};c.prototype.Thg=function(){var u=b(1082).DownloadACopyOperation;this.jDc.Ec>=u.Bkc&&d.ULS.sendTraceTag(537154819,
0,15,"Download did not complete after 10 seconds.");w.a(this.Bf.$).rd.HJ();this._state=3};c.prototype.Afb=function(){this.ij.gz();return this.S_d};c.prototype.dispose=function(){};Object(y.a)(c,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[2]);var A=b(1178),x=b(136);b.d(F,"DownloadACopyOperation",function(){return a});a.prototype.Thh=function(){var u=this,B=this.qSg(this.$),r=this.$.userOperationManager.operationCount;0<r&&d.ULS.sendTraceTag(537154822,
0,15,"flushing queue in downloadcopy. Queue is {0}",r);this.$.userOperationManager.m4("DownloadACopyOperation.DownloadForkedFile");this.fkc&&d.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.raa.downloadFile(B,-21742208);v.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?l.TaskExtensions.Ba(t.Task.delay(1),function(){u.y$e()},this.raa.ma,3):l.TaskExtensions.Ba(t.Task.delay(1),function(){u.o9h()},
this.raa.ma,3)};a.prototype.dispose=function(){this.ea&&this.ea.kk(this.dd);this.$=this.ea=null};a.prototype.y$e=function(u){var B=this;(u=void 0===u?null:u)||(u=this.$.Wb.Ic("LoadResource","DownloadACopyOperation"));!this.raa.z$e&&u.Ec<a.Bkc?window.setTimeout(function(){B.y$e(u)},a.OJe):(u.Ec>=a.Bkc&&d.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),w.a(this.$).rd.HJ())};a.prototype.o9h=function(){new c(this)};a.prototype.qSg=function(u){var B=new Sys.StringBuilder,
r=u.workbookContext,I=u.ya;B.append(u.Kda);B.append(I.FileHandlerRelativeUri);B.append("?id=");B.append(encodeURIComponent(n.a.SGb(r.WorkbookUri,"sc")));u.ea.rc&&(B.append("&sessionId="),B.append(encodeURIComponent(u.ea.sessionId)));B.append("&workbookType=FullForkedWorkbook");B.append("&dataloss=");B.append(this.fkc?"true":"false");m.a.aGa(B,I);return B.toString()};a.Bkc=1E5;a.OJe=100;Object(y.a)(a,"DownloadACopyOperation",null,[2])},1170:function(y,F,b){function a(m,f){m=n.call(this,m,f)||this;
c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");m.title="";m.message=a.Jxa;m.PKa=!0;return m}b.d(F,"a",function(){return a});y=b(0);var c=b(13),d=b(47),l=b(78);b=b(830);var n=b.a;vm(a,n);a.prototype.dma=function(m){n.prototype.dma.call(this,m);d.a.openWindow(4,l.a.qH(a.Oof))};a.prototype.yF=function(m){n.prototype.yF.call(this,m);a.Xud&&a.Xud(null)};a.initialize=function(m,f,v,w){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
a.Jxa=m;a.Pof=f;a.Oof=v;a.Xud=w};Qk.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.Pof}}});a.Jxa=null;a.Pof=null;a.Oof=null;a.Xud=null;Object(y.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1171:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.bnh="ewa-bb";a.dnh="ewa-bb-entry";a.enh="ewa-bb-entry-body";a.knh="ewa-bb-icon";a.gnh="ewa-bb-entry-icon";a.jnh="ewa-bb-entry-title";a.inh="ewa-bb-entry-message";a.$Me="ewa-bb-entry-button";
a.hnh="ewa-bb-entry-link";a.fnh="ewa-bb-entry-close";a.aNe="ewa-bb-entry-button-holder";a.u9c="ewa-nov2-ltr";a.cnh="ewa-bb-content";a.w9c="ewa-nov2-rtl";Object(y.a)(a,"CssClassNames",null,[])},1172:function(y,F,b){function a(d,l){d=c.call(this,d,l)||this;d.hw=!0;d.title=a.$oa;d.message=a.Yoa;return d}b.d(F,"a",function(){return a});y=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.jp=function(d){c.prototype.jp.call(this,d);(d=a.Zoa)&&d(null)};a.initialize=function(d,l,n,m){a.$oa=d;a.Yoa=l;a.Xoa=n;a.Zoa=
m};Qk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Xoa}}});a.$oa=null;a.Yoa=null;a.Xoa=null;a.Zoa=null;Object(y.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1173:function(y,F,b){function a(d,l){d=c.call(this,d,l)||this;d.hw=!0;d.title=a.$oa;d.message=a.Yoa;return d}b.d(F,"a",function(){return a});y=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.jp=function(d){c.prototype.jp.call(this,d);(d=a.Zoa)&&d(null)};a.initialize=function(d,
l,n,m){a.$oa=d;a.Yoa=l;a.Xoa=n;a.Zoa=m};Qk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Xoa}}});a.$oa=null;a.Yoa=null;a.Xoa=null;a.Zoa=null;Object(y.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1174:function(y,F,b){function a(d,l){d=c.call(this,d,l)||this;d.hw=!0;d.title=a.$oa;d.message=a.Yoa;return d}b.d(F,"a",function(){return a});y=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.jp=function(d){c.prototype.jp.call(this,d);(d=
a.Zoa)&&d(null)};a.initialize=function(d,l,n,m){a.$oa=d;a.Yoa=l;a.Xoa=n;a.Zoa=m};Qk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Xoa}}});a.$oa=null;a.Yoa=null;a.Xoa=null;a.Zoa=null;Object(y.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1175:function(y,F,b){function a(d,l){d=c.call(this,d,l)||this;d.hw=!0;d.title=a.wBb;d.message=a.Jxa;return d}b.d(F,"a",function(){return a});y=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.jp=function(d){c.prototype.jp.call(this,
d);a.Lxa&&a.Lxa(null)};a.initialize=function(d,l,n,m){a.wBb=d;a.Jxa=l;a.f8a=n;a.Lxa=m};Qk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.f8a}}});a.wBb=null;a.Jxa=null;a.f8a=null;a.Lxa=null;Object(y.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1176:function(y,F,b){function a(d,l){d=c.call(this,d,l)||this;a.f8a&&a.Lxa&&(d.hw=!0);d.title=a.wBb;d.message=a.Jxa;return d}b.d(F,"a",function(){return a});y=b(0);b=b(830);
var c=b.a;vm(a,c);a.prototype.jp=function(d){c.prototype.jp.call(this,d);a.Lxa&&a.Lxa(null)};a.initialize=function(d,l,n,m){a.wBb=d;a.Jxa=l;a.f8a=n;a.Lxa=m};Qk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.f8a}}});a.wBb=null;a.Jxa=null;a.f8a=null;a.Lxa=null;Object(y.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1177:function(y,F,b){function a(m,f,v,w,t,A){this.$X=m;this.aY=f;this.GJc=v;this.DD=w;this.hRb=t;this.GUa=A}
b.d(F,"a",function(){return a});y=b(0);var c=b(1233),d=b(5),l=b(49),n=b(87);a.prototype.p6i=function(m){this.juf(m)};a.prototype.Gsi=function(m){this.juf(m)};a.prototype.juf=function(m){var f=10;1===m?(n.a.instance.resolve("Common.IOfficeTrialExperience").djc(this.GUa),f=3):2===m&&((!this.GJc||this.GJc(this.DD))&&this.aY&&c.a.instance.p8g(this.aY,this.$X,this.DD),f=5);(0===m||1===m)&&this.$X&&this.$X(this.DD);d.AFrameworkApplication.btc(l.a.UFf,this.hRb,f);this.dispose()};a.prototype.dispose=function(){this.DD=
this.aY=this.$X=null};Qk.Object.defineProperties(a.prototype,{f4f:{configurable:!0,enumerable:!0,get:function(){return!this.aY&&!this.GJc}},Stf:{configurable:!0,enumerable:!0,get:function(){return 2===this.GUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},BMe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},l$e:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},Tva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},W8e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},tXb:{configurable:!0,enumerable:!0,get:function(){return 2===this.GUa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},fo:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(y.a)(a,"AOICErrorDialogWithTrial",null,[2])},1178:function(y,F,b){function a(A,x){var u=t.call(this,A)||this;u.qVj=["id","sessionId","workbookType","workbookFileType","dataloss"];u.command=0;u.oDb=function(){var B=u.LPh();if(B){u.$.lI(!0);if(-2028960985!==u.command&&1461300262!==u.command){var r=v.a(u.$).rd.activityState;r[f.a.jYa]=m.a.download;r[w.a.FTc]=u.command}n.a(u.$).nv(B.Errors)}};u.iframe=A;u.$=x;u.xc.ka("load",u.oDb);return u}b.d(F,"a",function(){return a});y=b(0);var c=b(13),d=b(47);
F=b(230);var l=b(200),n=b(41),m=b(6),f=b(33),v=b(65),w=b(607),t=F.a;vm(a,t);a.prototype.downloadFile=function(A,x){var u={};(A=this.lAh(A,u))&&d.a.Rpc("dlfr",A,u);this.command=x};a.prototype.lAh=function(A,x){var u=A.split("?");if(2!==u.length)return A=null,c.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),A;u=u[1].split("&");u=yl(u);for(var B=u.next();!B.done;B=u.next()){var r=B.value.split("=",2);if(2!==r.length){A=null;c.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}B=r[0];Array.contains(this.qVj,B)&&(r=decodeURIComponent(r[1]),x[B]=r,A=l.a.SGb(A,B))}return A};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.LPh=function(){try{return this.iframe.contentWindow.ewaResult}catch(x){if(!this.$.ea.oc.isDivSyndicated){var A=window.document.referrer.match(RegExp("://(.[^/]+)/"));c.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<A.length?A[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.Awa);throw x;}return null}};a.Mse=function(A){var x=document.createElement("iframe");x.id="ewaFileLoader";x.style.cssText="height:0;width:0;display:none";x.src="about:blank";x.setAttribute("name","dlfr");x=A.domElement.appendChild(x);return new a(x,A)};Qk.Object.defineProperties(a.prototype,
{z$e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(y.a)(a,"FileLoader",F.a,[])},1179:function(y,F,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(F,"a",function(){return a});y=b(0);var c=b(1337),d=b(5),l=b(40),n=b(78);a.prototype.GNd=function(){return l.c([this.rja(),this])};a.prototype.execute=function(m,f,v){var w="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=n.a.hl(w,"wdEnableRoaming","1"));d.AFrameworkApplication.Kd.Wl(w,2,this.GNd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.a4a(),m,f,v,void 0,void 0,void 0,void 0,"6")};Object(y.a)(a,"ARoamingAppsRequest",null,[])},1183:function(y,F,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(F,"a",function(){return a});y=b(0);Object(y.a)(a,"PrintPreviewPaneProps",null,[])},1184:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);a.T1i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.V7b="ewa-dlg-elements-container-rtl";a.U1i="PrintDialogLeftContainer";a.V1i="PrintDialogRightContainer";a.W$a="PrintDialogRadioButtonContainer";a.UJf="PrintRadioButtonElementInnerDiv";a.$1i="PrintRadioButtonElementOuterDiv";a.X$a="PrintDialogTitleSection";
a.XEd="PrintDialogComboBoxContainer";a.a2i="PrintRadioButtonIcon";a.S1i="PrintButtonArea";a.zw="PrintPreviewerContainer";Object(y.a)(a,"CssClassNames",null,[])},1225:function(y,F,b){function a(jc,Kb){var dc=Ub.call(this,Kb)||this;dc.eFh=T.DOMElementExtensions.Qp+",div";dc.yU=Array(66);dc.sm=!1;dc.kW=function(Qb){if(Qb.Ea.keyCode===U.a.yD){var O=dc.Kb.querySelectorAll(dc.eFh),Ba=T.DOMElementExtensions.Bl(O);O=T.DOMElementExtensions.fz(O);return T.DOMElementExtensions.Lda(Qb.Ea,Ba,O)}return!1};dc.vb=
jc;dc.set_visible(!1);dc.addCssClass(da.a.bnh);Q.KeyInputManager.instance.qa(la.a.Tb,dc.Kb,dc.kW);W.a(jc).Qg(dc);return dc}function c(jc,Kb,dc,Qb,O,Ba){var ra=D.call(this,jc,Kb,dc)||this;lc.a.instance.create(function(){if(ra.businessBar&&ra.businessBar.cMa(Kb.YZa)){var ta=new qa.a(-847286761,0,ra.businessBar.$.hd,0,null),Fa={};Fa=(Fa.CalloutName=Qb,Fa.Target=ra.QS.domElement,Fa);ra.businessBar.$.Ka.Yb(ta,Fa)}},O,Ba,!0,!0);return ra}function d(jc,Kb,dc,Qb){jc=Wb.call(this,jc,Kb)||this;jc.automateCommandManager=
dc.da.Aa(352);V.ULS.shipAssertTag(526787654,0,!!jc.automateCommandManager);jc.id=nb.a.create();jc.$=dc;jc.title=Ya.a.instance.fa(2212);jc.message="";jc.BTd=Ya.a.instance.fa(2208);jc.uXj=Ya.a.instance.fa(2209);jc.qgg=Ya.a.instance.fa(2210);jc.Y1g=Ya.a.instance.fa(2211);jc.update(Qb);return jc}function l(jc,Kb){jc=vb.call(this,jc,Kb)||this;jc.SBa=kb.a.t4b();jc.hw=!0;jc.K4=jc.SBa.AVj;jc.title=jc.SBa.title;jc.message=jc.SBa.message;return jc}function n(jc,Kb){jc=Ec.call(this,jc,Kb)||this;jc.hw=!0;jc.title=
"";return jc}function m(jc,Kb){Kb=fb.call(this,jc,Kb)||this;Kb.policyManager=jc.$.da.Aa(274);if(!Kb.policyManager)return V.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),Kb;Kb.message=Kb.policyManager.Fpc;Kb.title=Kb.policyManager.title;Kb.PKa=!0;return Kb}function f(jc,Kb){jc=pb.call(this,jc,Kb)||this;jc.hw=!0;jc.K4=!0;return jc}function v(jc,Kb,dc,Qb){jc=Ta.call(this,jc,Kb)||this;jc.Nwb=dc;jc.command=Qb;jc.PKa=!0;jc.hw=
1461300262!==Qb;return jc}function w(jc,Kb,dc){jc=ma.call(this,jc,Kb)||this;jc.Nwb=dc;jc.PKa=!0;return jc}function t(jc,Kb,dc){jc=hc.call(this,jc,Kb)||this;jc.Nwb=dc;jc.hw=!0;return jc}function A(jc,Kb){jc=Ia.call(this,jc,Kb)||this;jc.hw=!0;jc.K4=!1;return jc}function x(jc,Kb){jc=eb.call(this,jc,Kb)||this;jc.hw=!0;jc.K4=!0;return jc}function u(jc,Kb,dc,Qb,O,Ba,ra){return B.call(this,jc,0,Kb,dc,Qb,O,Ba,ra)||this}function B(jc,Kb,dc,Qb,O,Ba,ra,ta){this.kJ=this.k8=this.QS=0;this.amg=jc;this.ALj=Kb;this.uP=
dc;this.nqg=ra;this.Dib=H.a.Qv(ta);this.qog=ta;0!==Qb&&(this.QS=Qb);0!==O&&(this.k8=O);0!==Ba&&(this.kJ=Ba)}function r(jc,Kb,dc,Qb,O){jc=I.call(this,jc,Kb,dc,Qb)||this;jc.command=O;jc.K4=!0;return jc}function I(jc,Kb,dc,Qb){jc=Ha.call(this,jc,Kb)||this;jc.error=dc;jc.options=Qb;jc.error&&jc.options&2&&(jc.message=jc.error.Description);jc.error&&jc.options&1&&(jc.title=jc.error.Caption);jc.hw=!(Qb&4);return jc}function z(jc,Kb,dc){return D.call(this,jc,Kb,dc)||this}function D(jc,Kb,dc){jc=pa.call(this,
jc,Kb)||this;jc.hw=!0;jc.command=dc;return jc}b.r(F);y=b(0);var V=b(13),U=b(91),Q=b(117),la=b(12),ba=b(88),S=b(49),H=b(29),T=b(11),K=b(230),da=b(1171),fa=b(4),W=b(255),ca=b(1172),ia=b(830),ea=b(1251),qa=b(92),pa=ia.a;vm(D,pa);D.prototype.jp=function(jc){pa.prototype.jp.call(this,jc);this.businessBar.$.Ka.Yb(new qa.a(this.command,jc,this.businessBar.$.hd,10,null))};Object(y.a)(D,"CommandActionBusinessBarEntry",ia.a,[]);vm(z,D);z.prototype.yF=function(jc){D.prototype.yF.call(this,jc)};Object(y.a)(z,
"EditAttemptReadOnlyBusinessBarEntry",D,[]);var Pa=b(41),Ha=ia.a;vm(I,Ha);I.prototype.jp=function(jc){Ha.prototype.jp.call(this,jc);this.error.Appearance&=-33;Pa.a(this.businessBar.$).nv([this.error])};Object(y.a)(I,"ErrorBusinessBarEntry",ia.a,[]);vm(r,I);r.prototype.i6=function(jc){I.prototype.i6.call(this,jc);this.businessBar.$.Ka.Yb(new qa.a(this.command,jc,this.businessBar.$.hd,10,null))};Object(y.a)(r,"ErrorAndCommandBusinessBarEntry",I,[]);var Ya=b(14);B.fa=function(jc){return Ya.a.instance.fa(jc)};
Qk.Object.defineProperties(B.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.ALj)}},message:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.uP)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.uP}},YZa:{configurable:!0,enumerable:!0,get:function(){return this.amg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.QS)}},YYa:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.k8)}},link:{configurable:!0,
enumerable:!0,get:function(){return B.fa(this.kJ)}},Mj:{configurable:!0,enumerable:!0,get:function(){return this.nqg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.Dib}},alt:{configurable:!0,enumerable:!0,get:function(){var jc=b(1225).BusinessBarControl;switch(this.Mj){case jc.Hia:return B.fa(26);case jc.FB:return B.fa(25);case jc.oj:return B.fa(24);default:return B.fa(0)}}},K8c:{configurable:!0,enumerable:!0,get:function(){return this.qog}}});Object(y.a)(B,"EwaBusinessBarEntry",
null,[]);vm(u,B);Qk.Object.defineProperties(u.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(y.a)(u,"EwaNoTitleBusinessBarEntry",B,[]);var Na=b(69),eb=ia.a;vm(x,eb);x.prototype.jp=function(jc){eb.prototype.jp.call(this,jc);this.set_visible(!1);this.businessBar.$.oI();this.businessBar.$.Ka.Yb(new qa.a(1038998010,jc,this.businessBar.$.hd,10,null))};x.prototype.i6=function(jc){eb.prototype.i6.call(this,jc);this.businessBar.$.Ka.Yb(new qa.a(-722953877,jc,this.businessBar.$.hd,
10,null))};x.prototype.yF=function(jc){this.businessBar.removeEntry(53);Na.g(jc)};Object(y.a)(x,"ExternalLinksEnableContentBusinessBarEntry",ia.a,[]);var Ia=ia.a;vm(A,Ia);A.prototype.jp=function(jc){Ia.prototype.jp.call(this,jc);this.businessBar.$.Ka.Yb(new qa.a(-722953877,jc,this.businessBar.$.hd,10,null))};A.prototype.yF=function(jc){this.businessBar.removeEntry(5);Na.g(jc)};Object(y.a)(A,"ExternalLinksShowErrorBusinessBarEntry",ia.a,[]);var lb=b(8),hc=ia.a;vm(t,hc);t.prototype.jp=function(jc){hc.prototype.jp.call(this,
jc);lb.HelperMethods.wca(this.businessBar.$.OI,this.Nwb,this.businessBar.$.xX)};Object(y.a)(t,"HelpButtonBusinessBarEntry",ia.a,[]);var ma=ia.a;vm(w,ma);w.prototype.dma=function(jc){ma.prototype.dma.call(this,jc);lb.HelperMethods.wca(this.businessBar.$.OI,this.Nwb,this.businessBar.$.xX)};Object(y.a)(w,"HelpTextBusinessBarEntry",ia.a,[]);var Ja=b(77),Ta=ia.a;vm(v,Ta);v.prototype.jp=function(jc){Ta.prototype.jp.call(this,jc);this.businessBar.$.Ka.Yb(new qa.a(this.command,jc,this.businessBar.$.hd,10,
null))};v.prototype.dma=function(jc){Ta.prototype.dma.call(this,jc);var Kb=new qa.a(-859308420,jc,this.businessBar.$.hd,12,null),dc={};jc=(dc[Ja.a.Tg]="HelpID="+this.Nwb,dc.InputMethod=jc,dc[Ja.a.nd]=fa.a.JZ,dc[fa.a.ZAa]=!0,dc);this.businessBar.$.Ka.Yb(Kb,jc)};Object(y.a)(v,"HelpTextTaskPaneAndCommandBusinessBarEntry",ia.a,[]);var pb=ia.a;vm(f,pb);f.prototype.jp=function(jc){pb.prototype.jp.call(this,jc);this.set_visible(!1);this.businessBar.$.oI();this.businessBar.$.Ka.Yb(new qa.a(-1081442996,jc,
this.businessBar.$.hd,10,null))};f.prototype.i6=function(jc){pb.prototype.i6.call(this,jc);this.businessBar.$.Ka.Yb(new qa.a(1702917262,jc,this.businessBar.$.hd,10,null))};f.prototype.yF=function(jc){this.businessBar.removeEntry(57);Na.g(jc)};Object(y.a)(f,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ia.a,[]);var Db=b(1174),fb=ia.a;vm(m,fb);m.prototype.dma=function(jc){fb.prototype.dma.call(this,jc);(jc=this.policyManager.iPi)&&jc(null)};Qk.Object.defineProperties(m.prototype,{linkText:{configurable:!0,
enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(y.a)(m,"PolicyBusinessBarEntry",ia.a,[]);var xa=b(1173),ya=b(1176),Ga=b(1175);b(413);var db=b(176),Ob=b(30),Ec=ia.a;vm(n,Ec);n.prototype.jp=function(jc){Ec.prototype.jp.call(this,jc);db.c(Ob.a.KDi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(y.a)(n,"UnsupportedBrowserBusinessBarEntry",ia.a,[]);var wb=b(1170),kb=b(1267),vb=ia.a;vm(l,vb);l.prototype.jp=function(jc){vb.prototype.jp.call(this,
jc);this.SBa.rvf(null)};l.prototype.i6=function(jc){vb.prototype.i6.call(this,jc);this.SBa.uvf(null)};l.prototype.yF=function(jc){vb.prototype.yF.call(this,jc);this.SBa.CIe(null)};Qk.Object.defineProperties(l.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.SBa.zve}},YYa:{configurable:!0,enumerable:!0,get:function(){return this.SBa.Bve}}});Object(y.a)(l,"WildFireMobileAppBusinessBarEntry",ia.a,[]);var Gb=b(244),Za=b(20),ub=b(238),fc=b(166),$a=b(46),nb=b(177),sc=b(1096),
rd=b(75),$b=b(126),Wb=ia.a;vm(d,Wb);d.prototype.update=function(jc){this.scriptLink=jc.scriptLink;this.runStatus=jc.runStatus;this.buttonText=jc.buttonText||"";this.Aui(jc.clickId);this.ihj();"preparing"===this.runStatus?(this.message=String.format(Ya.a.instance.Cb(198),this.buttonText),this.hw=!0,this.YXa=this.BTd,this.cqb=this.iFa=this.P9a):"running"===this.runStatus?(this.message=String.format(Ya.a.instance.Cb(197),this.buttonText),this.hw=!0,this.YXa=this.BTd,this.cqb=this.iFa=this.P9a):"succeeded"===
this.runStatus?(this.message=String.format(Ya.a.instance.Cb(200),this.buttonText),this.hw=!0,this.YXa=this.qgg,this.iFa=this.nFf,this.K4=!0,this.bWc=this.uXj,this.cWc=this.pVi):"runFailed"===this.runStatus?(this.message=String.format(Ya.a.instance.Cb(199),this.buttonText),this.h5a=a.Hia,this.hw=!0,this.YXa=this.qgg,this.iFa=this.nFf,"false"===jc.isOwner&&(this.K4=!0,this.bWc=this.Y1g,this.cWc=this.vJi)):"fetchFailed"===this.runStatus?(this.h5a=a.Hia,this.message=String.format(Ya.a.instance.Cb(201),
this.buttonText)):"canceled"===this.runStatus?(this.h5a=a.FB,this.message=String.format(Ya.a.instance.Cb(203),this.buttonText)):"alreadyRunning"===this.runStatus?(this.h5a=a.FB,this.message=String.format(Ya.a.instance.Cb(202),this.buttonText),this.hw=!0,this.YXa=this.BTd,this.cqb=this.iFa=this.P9a):"initializing"===this.runStatus&&(this.h5a=a.oj,this.message=Ya.a.instance.fa(2213))};d.prototype.jp=function(jc){Wb.prototype.jp.call(this,jc);this.iFa&&this.iFa()};d.prototype.i6=function(jc){Wb.prototype.i6.call(this,
jc);this.YYa&&this.cWc()};d.prototype.yF=function(jc){Wb.prototype.yF.call(this,jc);this.cqb&&this.cqb()};d.prototype.ihj=function(){this.message="";this.h5a=a.oj;this.hw=!1;this.YXa="";this.iFa=void 0;this.K4=!1;this.bWc="";this.cWc=void 0;this.Qwb=!1;this.cqb=void 0};d.prototype.P9a=function(){var jc=nb.a.create().toString();this.automateCommandManager.o3h(jc);this.Fjc(-2186799,jc)};d.prototype.nFf=function(){var jc=nb.a.create().toString();this.automateCommandManager.n3h(jc);this.Fjc(1036446140,
jc)};d.prototype.pVi=function(){var jc=nb.a.create();if(this.scriptLink){var Kb=new sc.b(this.scriptLink);this.automateCommandManager.n7e(this.id.toString(),JSON.stringify(Kb),jc)}this.Fjc(-585097204,jc.toString())};d.prototype.vJi=function(){var jc=nb.a.create().toString();this.automateCommandManager.m3h(jc);this.Fjc(-639858579,jc)};d.prototype.Aui=function(jc){var Kb=[];Kb.push(Object.assign(new rd.a,{name:"id",string:this.id.toString()}));Kb.push(Object.assign(new rd.a,{name:"hasScriptLink",bool:!!this.scriptLink}));
Kb.push(Object.assign(new rd.a,{name:"runStatus",string:this.runStatus}));Kb.push(Object.assign(new rd.a,{name:"clickId",string:jc}));Kb.push(Object.assign(new rd.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));db.a($b.a.sGi,void 0,void 0,Kb)};d.prototype.Fjc=function(jc,Kb){var dc=[];dc.push(Object.assign(new rd.a,{name:"id",string:this.id.toString()}));dc.push(Object.assign(new rd.a,{name:"hasScriptLink",bool:!!this.scriptLink}));dc.push(Object.assign(new rd.a,{name:"runStatus",
string:this.runStatus}));dc.push(Object.assign(new rd.a,{name:"clickId",string:Kb}));db.d(jc,void 0,void 0,void 0,void 0,void 0,dc)};Qk.Object.defineProperties(d.prototype,{Mj:{configurable:!0,enumerable:!0,get:function(){return this.h5a}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.YXa}},YYa:{configurable:!0,enumerable:!0,get:function(){return this.bWc}}});Object(y.a)(d,"OfficeScriptsRunStatusBusinessBarEntry",ia.a,[]);var lc=b(44);vm(c,D);Object(y.a)(c,"CalloutBusinessBarEntry",
D,[]);var Oa=b(1),qb=b(16);b.d(F,"BusinessBarControl",function(){return a});var Ub=K.a;vm(a,Ub);a.prototype.Oe=function(jc,Kb){Kb||T.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Kb};a.prototype.Yf=function(jc){return T.DOMElementExtensions.Pe(this.Kb,jc)};a.prototype.fi=function(){};a.prototype.Ph=function(){};a.prototype.dispose=function(){this.sm||(Q.KeyInputManager.instance.za(la.a.Tb,this.Kb,this.kW),ba.a.sc(this.yU),this.yU=Array(66),this.vb=null,Ub.prototype.dispose.call(this),
this.sm=!0)};a.prototype.cMa=function(jc){if(!this.get_visible())return!1;jc=this.yU[jc];return!!jc&&jc.isVisible};a.prototype.cC=function(jc){return!!this.yU[jc]};a.prototype.qNb=function(jc,Kb){if(jc=this.yU[jc])jc.update(Kb),jc.zRj()};a.prototype.YD=function(jc,Kb,dc,Qb){dc=void 0===dc?null:dc;Qb=void 0===Qb?null:Qb;var O=!1;if(this.cC(jc))dc=this.yU[jc].get_visible();else{this.set_visible(!0);var Ba=a.d5e()[jc];this.yU[jc]=this.J$(jc,Kb,dc,Qb);dc=!1;O=!0;Qb="";var ra=0;Kb&&(Qb=Kb.MessageIdName,
ra=Kb.MessageId);var ta=Ba.K8c;V.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",jc,$a.PageLoadTrackingInfo.instance.Kja(new Date));if(Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var Fa=this.yU.filter(function(cb){return null!=cb}).length;1<Fa&&V.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",Fa.toString())}fc.a(this.$).dKd(Ba.hash,Qb,ra,S.a.BAc,!0,1,Kb,ta)}dc||!Array.contains(ea.a.icc(),jc)&&!O||
(this.yU[jc].set_visible(!0),this.$.oI())};a.prototype.removeEntry=function(jc){return this.Baj(jc)};a.prototype.fId=function(){ba.a.sc(this.yU);this.yU=Array(66);this.set_visible(!1)};a.prototype.Baj=function(jc){if(!this.cC(jc))return!1;ba.a.Fa(this.yU[jc]);this.yU[jc]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.oI();return!0};a.prototype.J$=function(jc,Kb,dc,Qb){dc=void 0===dc?null:dc;Qb=void 0===Qb?null:Qb;var O=a.d5e()[jc],Ba=!!(this.$.Jd&64);switch(jc){case 2:case 4:case 23:case 25:case 26:case 35:case 34:jc=
new ia.a(this,O);break;case 12:case 29:case 30:case 31:case 32:case 55:jc=Ba?new D(this,O,-8805455):new ia.a(this,O);break;case 22:jc=new z(this,O,-8805455);break;case 44:case 43:jc=Ba?new r(this,O,Kb,0,-8805455):new I(this,O,Kb,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:jc=new I(this,O,Kb,0);break;case 19:jc=new ia.a(this,O);break;case 45:jc=new I(this,O,Kb,0);break;case 6:case 14:jc=new t(this,O,Kb.HelpTopicId);break;case 64:jc=new w(this,O,Kb.HelpTopicId);break;case 36:jc=new w(this,
O,fa.a.ybh);break;case 16:jc=new ia.a(this,O);jc.title=H.a.Lf(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);jc.message=H.a.Lf(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:jc=new D(this,O,-1762562205);jc.Qwb=!0;break;case 20:jc=new l(this,O);break;case 21:case 54:jc=new ia.a(this,O);break;case 28:jc=new ia.a(this,O);break;case 24:jc=new n(this,O);break;case 27:jc=new m(this,O);break;case 37:jc=new wb.a(this,O);break;case 38:jc=new ca.a(this,O);break;case 39:jc=
new xa.a(this,O);break;case 40:jc=new Db.a(this,O);break;case 46:jc=new ia.a(this,O);break;case 47:jc=new ia.a(this,O);break;case 48:jc=new ia.a(this,O);break;case 49:jc=new ia.a(this,O);break;case 50:jc=new ia.a(this,O);break;case 51:jc=new Ga.a(this,O);break;case 52:jc=new ya.a(this,O);break;case 53:jc=new x(this,O);break;case 5:jc=new A(this,O);break;case 56:jc=new D(this,O,-1753056834);Kb?(Kb=Kb.Directive,Za.a.qo(Kb)||"&nbsp;"===Kb||(jc.message=Kb)):dc&&(jc.message=dc);break;case 57:jc=new f(this,
O);break;case 58:jc=new ia.a(this,O);break;case 59:case 62:jc=new w(this,O,fa.a.wFi);break;case 60:jc=new v(this,O,fa.a.LNg,-8805455);break;case 65:jc=new v(this,O,fa.a.V6i,1461300262);break;case 61:jc=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",!1)?new c(this,O,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new D(this,O,515196233);break;case 63:jc=new d(this,O,this.$,Qb);break;default:jc=new I(this,
O,Kb,7)}jc.o3c();return jc};a.d5e=function(){var jc=ub.a.j6a()?259:258;return a.pve||(a.pve=[new B(0,274,275,276,0,0,a.Hia,"BB_UnableToRefreshLock"),new B(1,274,275,276,0,0,a.Hia,"BB_UnableToRefreshLockExpected"),new B(2,266,267,0,0,0,a.FB,"BB_WorkbookAlmostTooLarge"),new B(3,268,269,270,0,0,a.Hia,"BB_WorkbookTooLarge"),new B(4,257,jc,0,0,0,a.FB,"BB_ExternalWorkbookLinksDisabled"),new B(5,261,260,262,0,0,a.Hia,"BB_ExternalWorkbookLinksShowError"),new B(6,263,264,265,0,0,a.oj,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),
new B(7,249,250,251,0,0,a.oj,"BB_UnsupportedFeatures"),new B(8,0,0,0,0,0,a.oj,"BB_CollabDataAndDataStringsLocaleMismatch"),new B(9,0,0,0,0,0,a.oj,"BB_CollabDataStringsLocaleMismatch"),new B(10,0,0,0,0,0,a.oj,"BB_CollabDataLocaleMismatch"),new B(11,277,278,279,0,0,a.Hia,"BB_LastGenericStatusError"),new B(12,280,281,282,0,0,a.FB,"BB_ScratchPadWarning"),new B(13,283,284,285,0,0,a.Hia,"BB_AuthenticationLost"),new B(14,286,287,288,0,0,a.FB,"BB_OdfCompatibilityIssues"),new B(15,0,568,0,0,0,a.FB,"BB_PivotChartInteractivityMissingWarning"),
new B(16,0,0,0,0,0,a.oj,"BB_WorkbookIsIrmProtected"),new B(17,0,0,0,0,0,a.oj,"BB_BIFeatureNotAvailable"),new B(18,289,290,285,0,0,a.FB,"BB_AnonymousCreateMode"),new B(19,252,253,0,0,0,a.FB,"BB_UnsupportedInteractiveReportEditing"),new B(20,0,0,0,0,0,a.oj,"BB_MobileAppCampaignBizBar"),new B(21,295,296,0,0,0,a.oj,"BB_TransientServerCommunicationFailures"),new B(22,1598,1609,1610,0,0,a.oj,"BB_EditAttemptInReadOnly"),new B(23,1598,1609,0,0,0,a.oj,"BB_EditAttemptInReadOnlyNoEditPermissions"),new B(24,
0,lb.HelperMethods.$Qj(),1587,0,0,a.oj,"BB_UnsupportedBrowser"),new B(25,298,299,0,0,0,a.oj,"BB_ReadOnlyPermissions"),new B(26,300,301,0,0,0,a.oj,"BB_DocumentIsIrmProtectedWarning"),new B(27,0,0,0,0,0,a.FB,"BB_PolicyWarningMessage"),new B(28,1242,297,0,0,0,a.oj,"BB_WorkingOnIt"),new B(29,1598,1596,1597,0,0,a.oj,"BB_PasswordProtectedWorkbookLockedForEdit"),new B(30,1611,1612,1613,0,0,a.oj,"BB_WorkbookIsReadOnlyRecommended"),new B(31,1598,1614,1615,0,0,a.oj,"BB_WorkbookHasPasswordToModify"),new B(32,
1598,1616,1619,0,0,a.oj,"BB_LegacySharedWorkbookEditWarning"),new B(33,1606,1617,251,0,0,a.oj,"BB_LegacyConnectionsWarning"),new B(34,1607,1608,0,0,0,a.oj,"BB_GroupedSlicers"),new B(35,311,312,0,0,0,a.FB,"BB_ThirdPartyAddinDisabled"),new B(36,1739,1740,0,0,1741,a.oj,"BB_FinanceLinkedEntityDisclaimerBar"),new B(37,0,0,0,0,0,a.oj,"BB_WacGdprNotice"),new B(38,0,0,0,0,0,a.oj,"BB_AutomaticSensitivityLabel"),new B(39,0,0,0,0,0,a.oj,"BB_RecommendedSensitivityLabel"),new B(40,0,0,0,0,0,a.oj,"BB_MandatorySensitivityLabel"),
new B(41,313,314,315,0,0,a.oj,"BB_LocalStorageDisabled"),new B(42,625,626,0,0,0,a.oj,"BB_AutoRefreshDisabled"),new B(43,983,981,985,1271,0,a.oj,"BB_CorruptedFileRepaired"),new B(44,984,982,985,1271,0,a.oj,"CorruptedOdsFileRepaired"),new B(45,271,272,273,0,0,a.FB,"BB_MinorVersionLimitReached"),new B(46,302,303,0,0,0,a.FB,"BB_SensitivityApplicationGenericError"),new B(47,304,306,0,0,0,a.FB,"BB_SensitivityApplicationTooLargeFileError"),new B(48,305,306,0,0,0,a.FB,"BB_SensitivityApplicationLabelNotSupportedError"),
new B(49,307,308,0,0,0,a.FB,"BB_SensitivityApplicationLabelDisabledError"),new B(50,309,310,0,0,0,a.FB,"BB_SensitivityApplicationMandatoryConflictError"),new B(51,0,0,0,0,0,a.FB,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new B(52,0,0,0,0,0,a.FB,"BB_SensitivityApplicationSetLabelError"),new B(53,2059,2060,2061,2064,0,a.oj,"BB_ExternalWorkbookLinksPromptEnableContent"),new B(54,295,296,0,0,0,a.oj,"BB_NetworkDown"),new B(55,316,317,318,0,0,a.oj,"BB_DefaultToViewDueToCogs"),new B(56,1765,
1766,1767,0,0,a.oj,"BB_RefreshLinkedEntityErrorBar"),new B(57,1742,1743,1744,1745,0,a.oj,"BB_LinkedEntitiesUntrustedImagesDisabled"),new u(58,248,0,0,0,a.oj,"BB_CanvasHealth"),new B(59,319,320,0,0,321,a.oj,"BB_NovModeDepreciation"),new B(60,986,987,1271,0,988,a.oj,"BB_MismatchedFileFormatConverted"),new B(61,2169,2170,2171,0,0,a.oj,"BB_OptimizeWorkbook"),new B(62,322,323,0,0,324,a.oj,"BB_NovModePostDepreciation"),new B(63,0,0,0,0,0,a.oj,"BB_OfficeScriptsRunning"),new B(64,2148,2149,0,0,2150,a.oj,
"BB_PowerQueryRefreshDataSourceNotSupported"),new B(65,325,326,0,0,327,a.oj,"BB_ReadOnlyPivotTable")])};Qk.Object.defineProperties(a.prototype,{$d:{configurable:!0,enumerable:!0,get:function(){return Gb.a.SYc}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});a.Hia=qb.a.qrh;a.FB=qb.a.srh;a.oj=qb.a.rrh;a.pve=null;Object(y.a)(a,
"BusinessBarControl",K.a,[117])},1233:function(y,F,b){function a(){this.bjb=!!t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.qw}function c(z,D,V){var U=n.call(this,z,D,V)||this;z={};z=(z.errorMessage=U.CMe,z.errorFileDownloadOffer=U.Nsb,z);D={};z.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=U.Tva,D.onExecute=function(Q){U.mOa(Q)},D);D=new I.a(!1,!1,!0);D.kc=1;D.Gc(1,U.Osb);D.Ve=U.id;V={};z=(V.id=U.id,V.dialogIcon=U.icon,V.bodyControls=z,V);D.initializeAndShow(U.fo,Object(v.a)(U,
U.wGd,"reactOICErrorDialogHandler"),z);return U}function d(z,D,V,U){var Q=f.call(this,z,D,V,U)||this;z={};z=(z.errorMessage=Q.errorMessage,z);D={};z.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=Q.Tva,D.onExecute=function(la){Q.mOa(la)},D);Q.Rwc?(z.macOfficePreLinkText=Q.npf,D={},z.macOfficeLink=(D.type="AppLinkProps",D.id="macOfficeLink",D.text=Q.kpf,D.onExecute=function(la){Q.Syd(la)},D),z.macOfficePostText=Q.mpf):Q.$2b&&(z.errorFileDownloadOffer=Q.Nsb);D=new I.a(!1,!1,!0);Q.$2b?(D.kc=
1,D.Gc(1,Q.Osb)):D.kc=0;D.Ve=Q.id;V={};z=(V.id=Q.id,V.dialogIcon=Q.icon,V.bodyControls=z,V);D.initializeAndShow(Q.fo,Object(v.a)(Q,Q.wGd,"reactOICErrorDialogHandler"),z);return Q}function l(z,D,V){z=n.call(this,z,D,V)||this;z.Sl=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=z.CMe;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));z.Sl=document.createElement("a");z.Sl.href="#";z.Sl.innerText=z.Tva;D.appendChild(z.Sl);B.a.addHandler(z.Sl,
"click",Object(v.a)(z,z.mOa,"oicErrorHelpLinkHandler"));D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));V=document.createElement("span");V.innerText=z.Nsb;D.appendChild(V);V=new r.StandardDialog;V.Ve=z.id;V.kc=1;V.Gc(1,z.Osb);V.Ik(z.fo,null,z.icon,Object(v.a)(z,z.dtd,"legacyOICErrorDialogHandler"),D);V.cX("errorMessageText");return z}function n(z,D,V){this.$X=D;this.aY=z;this.DD=V}function m(z,D,V,U){z=f.call(this,z,D,V,U)||this;z.Sl=null;z.xqa=null;D=document.createElement("span");
D.id="errorMessageText";D.innerText=z.errorMessage;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));z.Sl=document.createElement("a");z.Sl.href="#";z.Sl.innerText=z.Tva;D.appendChild(z.Sl);B.a.addHandler(z.Sl,"click",Object(v.a)(z,z.mOa,"oicErrorHelpLinkHandler"));V=new r.StandardDialog;V.Ve=z.id;if(z.Rwc){U=document.createElement("span");var Q=document.createElement("span");U.innerText=z.npf;Q.innerText=z.mpf;z.xqa=document.createElement("a");z.xqa.href="#";
z.xqa.innerText=z.kpf;D.appendChild(document.createElement("br"));D.appendChild(U);D.appendChild(z.xqa);D.appendChild(Q);B.a.addHandler(z.xqa,"click",Object(v.a)(z,z.Syd,"oicErrorMacOfferLinkHandler"))}else z.$2b&&(D.appendChild(document.createElement("br")),D.appendChild(document.createElement("br")),U=document.createElement("span"),U.innerText=z.Nsb,D.appendChild(U));z.$2b?(V.kc=1,V.Gc(1,z.Osb)):V.kc=0;V.Ik(z.fo,null,z.icon,Object(v.a)(z,z.dtd,"legacyOICErrorDialogHandler"),D);V.cX("errorMessageText");
return z}function f(z,D,V,U){this.KMc=null;this.hRb=U;this.$X=z;this.aY=D;this.DD=V;this.dhe=this.lpf.Fyj;z=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.wsg=z[0];this.vsg=z[1]}y=b(0);var v=b(80),w=b(13),t=b(5),A=b(49),x=b(413),u=b(87);f.prototype.wGd=function(z){this.NCb(z)};f.prototype.dtd=function(z){this.NCb(z)};f.prototype.NCb=function(z){var D=10;this.aY&&1===z&&(this.aY(this.DD),D=1);this.$X&&this.$X(this.DD);this.WF(D)};f.prototype.mOa=function(){x.Redirect.showHelp("OICFailure");
this.WF(2)};f.prototype.Syd=function(){this.lpf.Wkf();this.WF(4)};f.prototype.WF=function(z){w.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.hRb,z);t.AFrameworkApplication.btc(A.a.SFf,this.hRb,z)};f.prototype.dispose=function(){this.DD=this.$X=this.aY=null};Qk.Object.defineProperties(f.prototype,{lpf:{configurable:!0,enumerable:!0,get:function(){return this.KMc||(this.KMc=u.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,
get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},Tva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Rwc:{configurable:!0,enumerable:!0,get:function(){return this.dhe}},npf:{configurable:!0,enumerable:!0,get:function(){return this.wsg}},mpf:{configurable:!0,enumerable:!0,get:function(){return this.vsg}},kpf:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},
icon:{configurable:!0,enumerable:!0,get:function(){return this.dhe?3:2}},Nsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},$2b:{configurable:!0,enumerable:!0,get:function(){return!!this.aY}},Osb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},fo:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(y.a)(f,"AOICErrorDialog",null,[2]);var B=b(38),
r=b(128);vm(m,f);m.prototype.dispose=function(){this.Sl&&(B.a.removeHandler(this.Sl,"click",Object(v.a)(this,this.mOa,"oicErrorHelpLinkHandler")),this.Sl=null);this.xqa&&(B.a.removeHandler(this.xqa,"click",Object(v.a)(this,this.Syd,"oicErrorMacOfferLinkHandler")),this.xqa=null);f.prototype.dispose.call(this)};Object(y.a)(m,"OICErrorDialog",f,[]);n.prototype.wGd=function(z){this.NCb(z)};n.prototype.dtd=function(z){this.NCb(z)};n.prototype.NCb=function(z){var D=10;1===z&&(this.aY(this.DD),D=1);this.$X&&
this.$X(this.DD);this.WF(D)};n.prototype.mOa=function(){x.Redirect.showHelp("OICFailure");this.WF(2)};n.prototype.WF=function(z){t.AFrameworkApplication.btc(A.a.TFf,3,z)};n.prototype.dispose=function(){this.DD=this.aY=this.$X=null};Qk.Object.defineProperties(n.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},CMe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},Tva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
Nsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Osb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},fo:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(y.a)(n,"AOICErrorDialogWithDownload",null,[2]);vm(l,n);l.prototype.dispose=function(){this.Sl&&(B.a.removeHandler(this.Sl,"click",
Object(v.a)(this,this.mOa,"oicErrorHelpLinkHandler")),this.Sl=null);n.prototype.dispose.call(this)};Object(y.a)(l,"OICErrorDialogWithDownload",n,[]);var I=b(140);vm(d,f);Object(y.a)(d,"ReactOICErrorDialog",f,[]);vm(c,n);Object(y.a)(c,"ReactOICErrorDialogWithDownload",n,[]);b.d(F,"a",function(){return a});a.prototype.o8g=function(z,D,V){this.bjb?new d(z,D,null,V):new m(z,D,null,V)};a.prototype.p8g=function(z,D,V){this.bjb?new c(z,D,V):new l(z,D,V)};a.prototype.q8g=function(z,D,V,U,Q){var la=b(1317).ReactOICErrorDialogWithTrial,
ba=b(1318).OICErrorDialogWithTrial;this.bjb?new la(z,D,V,null,U,Q):new ba(z,D,V,null,U,Q)};Qk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Oa||(a.Oa=new a)}}});a.Oa=null;Object(y.a)(a,"OICErrorDialogFactory",null,[470])},1251:function(y,F,b){function a(ea,qa){var pa=ia.call(this)||this;pa.Ma=new v.a;pa.hU=null;pa.BHc=[];pa.nmc=function(){pa.$.na.MLa?pa.removeEntry(13):pa.ig(13,null)};pa.zya=function(){H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
d.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");pa.removeEntry(21);pa.cC(54)&&(d.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),pa.removeEntry(54));pa.qSf("OnNetworkResumed")};pa.Mh=function(Ha,Ya){Ha=0;for(var Na=a.icc().length;Ha<Na;Ha++){var eb=a.icc()[Ha];pa.removeEntry(eb)}Ya.context&&0<Ya.context.communicationErrorRetryCount&&(d.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
pa.removeEntry(21));pa.qSf("OnWebMethodSuccess")};pa.Kn=function(Ha,Ya){var Na;Ha=pa.YBh(Ya.errors);for(var eb=[],Ia=0,lb=Ha.length;Ia<lb;++Ia){var hc=Ha[Ia];if(1===hc.Type&&hc.Appearance&32)eb=pa.t5h(hc,eb);else if(Ya.spj){d.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ma=(null===(Na=Ya.context)||void 0===Na?0:Na.stopwatch)?Ya.context.stopwatch.Ec:-1;5E3>ma?d.ULS.sendTraceTag(537170208,
0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",ma):l.AFrameworkApplication.Oqd()||pa.zDg(hc,Ya.context.methodName)}ma=[].concat(Gl(a.icc()));for(var Ja=0,Ta=eb.length;Ja<Ta;++Ja){var pb=eb[Ja];pa.ig(pb,hc);Array.remove(ma,pb)}hc=0;for(Ja=ma.length;hc<Ja;++hc)pa.removeEntry(ma[hc])}};pa.IDb=function(Ha,Ya){Ha=0;for(var Na=Ya.errors.length;Ha<Na;++Ha){var eb=Ya.errors[Ha];l.AFrameworkApplication.Oqd()||
(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),pa.ig(54,eb))}};pa.dd=function(Ha,Ya){pa.qd(Ha,Ya)};pa.qd=function(){var Ha=pa.$.ea;Ha.rc||Ha.Mg()||(pa.fId(),Array.clear(pa.BHc))};pa.ud=function(Ha,Ya){pa.$.ea.Mg()&&!Ya.oR||pa.laf(Ya.oR)};pa.rEb=function(){var Ha=pa.$.userOperationManager.Vbc();Ha&&Ha.operation.flags&1&&pa.e4f()};pa.bzf=function(){pa.e4f()};pa.Mf=function(){pa.eye();
pa.n4f()};pa.QN=function(){if(pa.$.s5&&pa.$.ea.Mg()&&pa.$.ea.rc)if(pa.$.ea.isEditMode)pa.removeEntry(43),pa.removeEntry(12),pa.removeEntry(29),pa.removeEntry(30),pa.removeEntry(31),pa.removeEntry(32),pa.removeEntry(22),pa.removeEntry(55);else{var Ha=pa.$.da.Aa(331);Ha&&Ha.eJa||pa.removeEntry(53);pa.removeEntry(5)}};pa.$=ea;pa.TYa=qa;pa.YLg();l.AFrameworkApplication.Kd&&l.AFrameworkApplication.Kd.mUc(pa);pa.Emb=Array(66);for(var Pa=0;66>Pa;Pa++)pa.Emb[Pa]=null;pa.mh=ba.EcmaDateClock.instance;pa.Pjf=
pa.mh.Lb.getTime();qa&&(qa=ea.na,Pa=qa.sf,qa.Jy(pa.Kn),qa.tq(pa.Mh),qa.dnb(pa.nmc),qa.vYa(pa.nmc),H.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(Pa.$Fg(pa.IDb),Pa.pnb(pa.zya)),ea.ea.Tj(pa.dd),ea.ea.Bt(pa.Mf),ea.Pk(pa.ud),ea.ul(pa.qd),ea.ea.H9(pa.QN),ea.userOperationManager.kx(pa.rEb),H.EwaSettings.la(170)&&ea.ea.oh.get(45)&&l.AFrameworkApplication.ga.ra("SupportsPolicies")||pa.Z6e(),pa.laf(da.c(ea)));ea.da.Ha(5,pa);return pa}function c(ea,qa,pa){pa=void 0===pa?null:
pa;var Pa=u.call(this)||this;Pa.YZa=ea;Pa.S6c=qa;Pa.data=pa;return Pa}y=b(0);var d=b(13),l=b(5),n=b(88),m=b(23),f=b(120),v=b(36),w=b(74),t;(function(ea){ea[ea.unableToRefreshLock=0]="unableToRefreshLock";ea[ea.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";ea[ea.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";ea[ea.workbookTooLarge=3]="workbookTooLarge";ea[ea.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";ea[ea.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";
ea[ea.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";ea[ea.unsupportedFeatures=7]="unsupportedFeatures";ea[ea.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";ea[ea.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";ea[ea.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";ea[ea.lastGenericStatusError=11]="lastGenericStatusError";ea[ea.scratchPadWarning=12]="scratchPadWarning";ea[ea.authenticationLost=13]=
"authenticationLost";ea[ea.odfCompatibilityIssues=14]="odfCompatibilityIssues";ea[ea.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";ea[ea.workbookIsIrmProtected=16]="workbookIsIrmProtected";ea[ea.biFeatureNotAvailable=17]="biFeatureNotAvailable";ea[ea.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";ea[ea.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";ea[ea.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";ea[ea.transientServerCommunicationFailures=
21]="transientServerCommunicationFailures";ea[ea.editAttemptInReadOnly=22]="editAttemptInReadOnly";ea[ea.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";ea[ea.unsupportedBrowser=24]="unsupportedBrowser";ea[ea.readOnlyPermissions=25]="readOnlyPermissions";ea[ea.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";ea[ea.policyWarningMessage=27]="policyWarningMessage";ea[ea.workingOnIt=28]="workingOnIt";ea[ea.passwordProtectedWorkbookLockedForEdit=29]=
"passwordProtectedWorkbookLockedForEdit";ea[ea.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";ea[ea.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";ea[ea.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";ea[ea.legacyConnectionsBB=33]="legacyConnectionsBB";ea[ea.groupedSlicersBB=34]="groupedSlicersBB";ea[ea.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";ea[ea.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";ea[ea.wacGdprNotice=
37]="wacGdprNotice";ea[ea.automaticSensitivityLabel=38]="automaticSensitivityLabel";ea[ea.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";ea[ea.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";ea[ea.localStorageDisabled=41]="localStorageDisabled";ea[ea.autoRefreshDisabled=42]="autoRefreshDisabled";ea[ea.corruptedFileRepaired=43]="corruptedFileRepaired";ea[ea.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";ea[ea.minorVersionLimitReached=45]="minorVersionLimitReached";
ea[ea.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";ea[ea.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";ea[ea.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";ea[ea.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";ea[ea.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";ea[ea.sensitivityApplicationMinorVersionLimitReachedError=
51]="sensitivityApplicationMinorVersionLimitReachedError";ea[ea.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";ea[ea.promptEnableExternalLinks=53]="promptEnableExternalLinks";ea[ea.networkDown=54]="networkDown";ea[ea.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";ea[ea.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";ea[ea.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";ea[ea.canvasHealth=58]="canvasHealth";
ea[ea.novModeDepreciation=59]="novModeDepreciation";ea[ea.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";ea[ea.optimizeWorkbook=61]="optimizeWorkbook";ea[ea.novModePostDepreciation=62]="novModePostDepreciation";ea[ea.officeScriptsRunning=63]="officeScriptsRunning";ea[ea.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";ea[ea.readOnlyPivotTable=65]="readOnlyPivotTable";ea[ea.count=66]="count"})(t||(t={}));Object(y.b)("EwaBusinessBarEntryType",
t);var A=b(4),x=b(1172),u=Sys.EventArgs;vm(c,u);Object(y.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var B=b(1174),r=b(1173),I=b(1176),z=b(1175),D=b(1170),V=b(479),U=b(56),Q=b(216),la=b(35),ba=b(691),S=b(27),H=b(1),T=b(8),K=b(19),da=b(55),fa=b(65),W=b(974),ca=b(176);b.d(F,"a",function(){return a});var ia=w.a;vm(a,ia);a.prototype.Z6e=function(){S.a.dr(this.$.ea.KF)&&this.Kn(this,new V.a(this.$.ea.KF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.dEg=function(ea){this.Ma.addHandler("bBarAttachedOrDetached",
ea)};a.prototype.dispose=function(){if(this.$){var ea=this.$,qa=ea.na,pa=qa.sf;qa.Dz(this.Kn);qa.xr(this.Mh);qa.lsc(this.nmc);qa.UGb(this.nmc);pa.jHb(this.zya);pa.ldj(this.IDb);ea.ea.kk(this.dd);ea.ea.Dw(this.Mf);ea.ol(this.ud);ea.rn(this.qd);ea.ea.W6(this.QN);ea.userOperationManager.jv(this.rEb);K.g(ea).zc.nl(this.bzf)}n.a.Fa(this.hU);this.$=this.hU=null;ia.prototype.dispose.call(this)};a.prototype.qgi=function(ea){switch(ea){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return H.EwaSettings.la(680);
default:return!1}};a.prototype.ig=function(ea,qa,pa,Pa,Ha){pa=void 0===pa?null:pa;Pa=void 0===Pa?null:Pa;Ha=void 0===Ha?null:Ha;if(!this.$.isMobileMode||this.qgi(ea))this.TYa&&!this.cC(ea)&&(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(t,ea)),this.Emb[ea]=this.mh.Gea,this.hU.YD(ea,qa,Pa,Ha),this.Ma.raiseEvent("bBarAttachedOrDetached",new c(ea,!0,pa))),qa&&32===qa.Appearance&&fa.a(this.$).rd.vla(qa)};
a.prototype.uBj=function(ea,qa,pa,Pa){d.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");D.a.initialize(ea,qa,pa,Pa);this.ig(37,null)};a.prototype.vAj=function(ea,qa,pa,Pa){x.a.initialize(ea,qa,pa,Pa);this.ig(38,null)};a.prototype.ICj=function(ea,qa,pa,Pa){r.a.initialize(ea,qa,pa,Pa);this.ig(39,null)};a.prototype.XBj=function(ea,qa,pa,Pa){B.a.initialize(ea,qa,pa,Pa);this.ig(40,null)};a.prototype.SCj=function(ea,qa,pa,Pa){z.a.initialize(ea,qa,pa,Pa);this.ig(51,null)};a.prototype.RCj=
function(ea,qa,pa,Pa){I.a.initialize(ea,qa,pa,Pa);this.ig(52,null)};a.prototype.removeEntry=function(ea){this.TYa&&(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(t,ea)),this.Emb[ea]=null,this.hU.removeEntry(ea)&&this.Ma.raiseEvent("bBarAttachedOrDetached",new c(ea,!1)))};a.prototype.cMa=function(ea){return this.TYa?this.hU.cMa(ea):!1};a.prototype.cC=function(ea){return this.TYa?this.hU.cC(ea):
!1};a.prototype.jCb=function(){d.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.zlc=function(){d.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.YLg=function(){var ea=b(1225).BusinessBarControl;if(this.TYa&&!this.hU){K.g(this.$).zc.Xl(this.bzf);var qa=document.getElementById(this.$.Jb+A.a.rve);this.hU=new ea(this.$,
qa)}};a.prototype.fId=function(){this.TYa&&this.hU.fId()};a.prototype.qSf=function(ea){if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var qa=this.mh.Gea;if(3E5<=qa-this.Pjf){this.Pjf=qa;for(var pa=0;66>pa;pa++){var Pa=this.Emb[pa];Pa&&(Pa=qa-Pa,3E5<=Pa&&d.ULS.sendTraceTag(537170241,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",ea,Enum.toString(t,pa),Pa))}}}};a.prototype.YBh=function(ea){for(var qa=[],pa=yl(ea),Pa=pa.next();!Pa.done;Pa=pa.next())switch(Pa.value.MessageId){case -113742550:Pa=
[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||S.a.kh(ea,Pa))&&Array.add(qa,-113742550)}return S.a.QF(ea,qa)};a.prototype.t5h=function(ea,qa){switch(ea.MessageId){case 2113407564:for(var pa=S.a.VZa([1821390342,-943219229,-502303485,1437034227]),Pa=0;Pa<pa.length;Pa++)pa[Pa].HelpTopicId=ea.HelpTopicId,pa[Pa].HelpDescription=ea.HelpDescription,Array.add(this.BHc,pa[Pa])}switch(ea.MessageId){case -395951567:this.ig(6,ea);break;
case 1643490758:this.ig(4,ea);break;case -907264831:this.ig(5,ea);break;case 757111532:case 2113407564:this.ig(7,ea);break;case 2010656511:this.ig(15,ea);break;case 1321660996:this.$.t5c=!0;this.ig(8,ea);break;case 526339737:this.$.t5c=!0;this.ig(9,ea);break;case -407088521:this.ig(10,ea);break;case 1756116017:this.ig(14,ea);break;case -1703455218:this.ig(17,ea);break;case 1393475740:this.ig(25,ea);break;case -949523941:this.ig(26,ea);break;case 1779381952:this.ig(42,ea);break;case 1421575100:this.ig(43,
ea);break;case 613676060:this.ig(44,ea);break;case 1233668252:this.ig(60,ea);break;case 1911608588:ea=!!(this.$.Jd&64);!this.$.ea.Mg()&&ea&&Array.add(qa,29);break;case 1544494907:break;case -655555355:Array.add(qa,this.drd()?1:0);break;case -1221382671:Array.add(qa,2);break;case 1662282929:Array.add(qa,3);break;case 104919273:this.$.ea.Mg()||Array.add(qa,30);break;case -689453604:ea=!!(this.$.Jd&64);this.$.ea.o8e=!0;!this.$.ea.Mg()&&ea&&Array.add(qa,31);break;case 157762400:this.$.ea.ygc=!0;!this.$.ea.Mg()&&
this.$.Jd&64&&!this.$.isEditMode&&Array.add(qa,32);break;case -73730134:H.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.Mg()&&this.$.Jd&64&&Array.add(qa,33);break;case -293349236:Array.add(qa,64);break;case -37299333:break;case 136737622:Array.add(qa,45);break;case -1780327030:this.ig(53,ea);break;case -113742550:this.ig(55,ea);break;case -260312420:this.$.ea.Mg()||Array.add(qa,65);break;default:this.ig(11,ea)}return qa};a.prototype.vai=
function(){var ea=this;if(l.AFrameworkApplication.ga.ra("WildFireExcelBizBar")&&!W.a.Zod(W.a.rdd(1))&&(m.a.Up||m.a.ah)){var qa=U.GetServiceTaskFactory.create(this.$.da,155,this.$.ma,1);la.TaskExtensions.Ba(qa,function(){ea.ig(20,null)},this.ma,3)}};a.prototype.sai=function(){var ea=H.EwaSettings.la(74),qa=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",!1),pa=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",
!1);T.HelperMethods.aRd(pa||qa,ea)&&(ca.a("NewBrowserSuggestionShown"),pa||f.a.pv("NewBrowserSuggestionShown","true",7),this.ig(24,null))};a.prototype.P$h=function(ea){!ea&&Q.g(this.$)&&this.ig(59,null)};a.prototype.Q$h=function(ea){!ea&&Q.h(this.$)&&this.ig(62,null)};a.prototype.laf=function(ea){(!ea&&!this.$.printingEnabled||this.$.jg.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(d.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),
this.ig(16,null));this.vai();this.sai();this.eye();this.n4f();this.P$h(ea);this.Q$h(ea)};a.prototype.eye=function(){this.$.workbookContext.Options&32768&&this.jBj()};a.prototype.jBj=function(){this.Emb[36]||this.ig(36,null)};a.prototype.n4f=function(){H.EwaSettings.la(680)&&this.$.workbookContext.Options&524288&&this.ig(57,null)};a.prototype.K4f=function(ea,qa){this.ig(56,ea,null,qa)};a.prototype.nme=function(ea,qa){var pa=null,Pa=null;pa=void 0===pa?null:pa;Pa=void 0===Pa?null:Pa;qa=void 0===qa?
null:qa;this.hU.cC(ea)?this.hU.qNb(ea,qa):this.ig(ea,null,pa,Pa,qa)};a.prototype.e4f=function(){this.$.Jd&8&&this.ig(12,null)};a.prototype.drd=function(){var ea=this.$.da.Aa(38);return ea?ea.tokenExpired:!1};a.prototype.zDg=function(ea,qa){if(!this.cC(21)&&-1387426400!==ea.MessageId){d.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var pa={};pa.FailedMethod=qa;this.ig(21,ea,pa)}};a.icc=function(){return a.Fpe||(a.Fpe=[0,1,2,3])};Qk.Object.defineProperties(a.prototype,
{W7c:{configurable:!0,enumerable:!0,get:function(){return this.BHc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.hU?this.hU.domElement:null}}});a.Fpe=null;Object(y.a)(a,"BusinessBarManager",w.a,[438,2,188])},1267:function(y,F,b){function a(A,x,u,B,r,I){this.WNc=null;this._id=A;this.DOc=x;this.Gpg=void 0===r?null:r;this.Vib=B;this.jlb=void 0===I?null:I;this.kpa=null;this.PXa=u;this.Ilb=c.instance.VZh(x,A)}function c(){this.EEc=new f.a;this.CEc=new f.a;this.BEc=new f.a;this.WPg(this.EEc);
this.VPg(this.CEc);this.UPg(this.BEc);this.JJc=new f.a;this.IJc=new f.a;this.HJc=new f.a;this.tSg(this.JJc);this.sSg(this.IJc);this.rSg(this.HJc);this.UFc=new f.a;this.oQg(this.UFc);this.rFa(this.UFc);this.rFa(this.BEc);this.rFa(this.CEc);this.rFa(this.EEc);this.rFa(this.IJc);this.rFa(this.JJc);this.rFa(this.HJc)}y=b(0);var d=b(13),l=b(80),n=b(988),m=b(974),f=b(1246);c.prototype.VZh=function(A,x){switch(A){case 1:return this.g2h(x);case 2:return this.iKh(x)}return m.a.exc?this.UFc:null};c.prototype.WPg=
function(A){A.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.VPg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.UPg=function(A){A.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.tSg=function(A){A.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);
A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);A.add("OverlayBig","Get the Word app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1","Discover Word");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};c.prototype.oQg=function(A){A.add("Headline","Get the Office Online extension for Chrome");A.add("UseAppButton","Get the extension");A.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};
c.prototype.sSg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);A.add("OverlayBig","Get the PowerPoint app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
A.add("OverlaySmallSplit1","Discover PowerPoint");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};c.prototype.rSg=function(A){A.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};
c.prototype.rFa=function(A){A.add("Corporation","Microsoft Corporation")};c.prototype.g2h=function(A){switch(A){case 3:return this.JJc;case 2:return this.IJc;case 1:return this.HJc}return null};c.prototype.iKh=function(A){switch(A){case 3:return this.EEc;case 2:return this.CEc;case 1:return this.BEc}return null};Qk.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Oa||(c.Oa=new c);return c.Oa}}});c.Oa=null;Object(y.a)(c,"WildFireStringFactory",null,[]);var v=b(5),
w=b(47),t=b(23);b.d(F,"a",function(){return a});a.prototype.o3c=function(){this.kpa=new n.a(this.title,this.message,null);this.kpa.addButton(this.zve,Object(l.a)(this,this.rvf,"onButtonOneClick"),"");this.PXa&&this.kpa.LCg(this.Bve,Object(l.a)(this,this.uvf,"onButtonTwoClick"));this.kpa.t$=Object(l.a)(this,this.CIe,"dismissBar");this.kpa.image=3;this.kpa.id=16;this.kpa.closeable=!0};a.prototype.rvf=function(){this.PXa?this.xdi():this.rVj()};a.prototype.uvf=function(){this.PXa&&this.ZVi()};a.prototype.xdi=
function(){d.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Vib&&this.jlb&&this.jlb();m.a.WNf(this._id,this.DOc)};a.prototype.ZVi=function(){this.openUrl&&(d.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Vib&&this.jlb&&this.jlb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(m.a.Cqe(this._id),this.openUrl,0,!1))};a.prototype.rVj=function(){m.a.exc?this.ASg():(d.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),
m.a.jPd("BizBarClicked"),1!==this.DOc&&2!==this.DOc||m.a.cZg(this.openUrl,this.Vib,this._id,this.jlb))};a.prototype.ASg=function(){this.Vib?d.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):d.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");w.a.bV(v.AFrameworkApplication.ga.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.Nfh=function(){this.Vib?d.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):d.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");
m.a.jPd(m.a.Fye)};a.prototype.CIe=function(){m.a.exc?this.Nfh():(m.a.jPd(m.a.rdd(this._id)),d.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.t4b=function(){var A=v.AFrameworkApplication.sa.Qa,x=new a(A.Oj,m.a.gcc(),8<t.a.g5a,1===A.ica,function(){return A.dC},A.MVf());d.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return x};Qk.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Ilb.oa("Headline")}},message:{configurable:!0,
enumerable:!0,get:function(){return this.Ilb.oa("CallToAction")}},AVj:{configurable:!0,enumerable:!0,get:function(){return this.PXa}},zve:{configurable:!0,enumerable:!0,get:function(){return this.PXa?this.Ilb.oa("InstallButton"):this.Ilb.oa("UseAppButton")}},Bve:{configurable:!0,enumerable:!0,get:function(){return this.PXa?this.Ilb.oa("OpenAppButton"):""}},xSg:{configurable:!0,enumerable:!0,get:function(){return this.kpa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.WNc||(this.WNc=
this.Gpg());return this.WNc}}});Object(y.a)(a,"WildFireBusinessBar",null,[])},1317:function(y,F,b){function a(m,f,v,w,t,A){var x=n.call(this,m,f,v,w,t,A)||this;m={};f=(m.errorMessage=x.BMe,m.offerString=x.Stf,m);m=new l.a(!1,!1,!0);x.f4f?(m.kc=1,v={},f.helpLink=(v.type="AppLinkProps",v.id="helpLink",v.text=x.Tva,v.onExecute=function(){d.Redirect.showHelp(x.W8e)},v)):(m.kc=4,m.Gc(2,x.l$e));m.Gc(1,x.tXb);m.Ve=x.id;v={};f=(v.id=x.id,v.dialogIcon=x.icon,v.bodyControls=f,v);m.initializeAndShow(x.fo,Object(c.a)(x,
x.p6i,"reactOICErrorDialogWithTrialHandler"),f);return x}b.r(F);b.d(F,"ReactOICErrorDialogWithTrial",function(){return a});y=b(0);var c=b(80);F=b(1177);var d=b(413),l=b(140),n=F.a;vm(a,n);Object(y.a)(a,"ReactOICErrorDialogWithTrial",F.a,[])},1318:function(y,F,b){function a(n,m,f,v,w,t){n=l.call(this,n,m,f,v,w,t)||this;m=document.createElement("span");m.innerText=n.BMe;m.appendChild(document.createElement("br"));m.appendChild(document.createElement("br"));f=document.createElement("span");f.innerText=
n.Stf;m.appendChild(f);f=new d.StandardDialog;n.f4f?(f.kc=1,f.$le(n.Tva,n.W8e)):(f.kc=4,f.Gc(2,n.l$e));f.Gc(1,n.tXb);f.Ve=n.id;f.Ik(n.fo,null,n.icon,Object(c.a)(n,n.Gsi,"legacyOICErrorDialogWithTrialHandler"),m);return n}b.r(F);b.d(F,"OICErrorDialogWithTrial",function(){return a});y=b(0);var c=b(80);F=b(1177);var d=b(128),l=F.a;vm(a,l);Object(y.a)(a,"OICErrorDialogWithTrial",F.a,[])},1319:function(y,F,b){function a(){return c.call(this)||this}b.r(F);b.d(F,"CheckRoamingRightsRequest",function(){return a});
y=b(0);b=b(1179);var c=b.a;vm(a,c);a.prototype.a4a=function(){return 2};a.prototype.rja=function(){return 1};Object(y.a)(a,"CheckRoamingRightsRequest",b.a,[])},1320:function(y,F,b){function a(){return c.call(this)||this}b.r(F);b.d(F,"GetRoamingLauncherRequest",function(){return a});y=b(0);b=b(1179);var c=b.a;vm(a,c);a.prototype.a4a=function(){return 0};a.prototype.rja=function(){return 2};Object(y.a)(a,"GetRoamingLauncherRequest",b.a,[])},1337:function(y,F,b){function a(v){this.SFc=!1;this.fXa=a.xec;
this.GPc=this.JNc=0;this.platform=null;this.pvg=v;this.qje=this.HPc=!1}function c(){this.state=this.callback=null;this.kod=!1}function d(){this.classId=0}y=b(0);var l=b(80),n=b(40);d.dIa=function(v){try{return n.a(v)}catch(w){}return null};Object(y.a)(d,"ARoamingAppsResponse",null,[]);Object(y.a)(c,"GetRoamingAppsLauncherContext",null,[]);var m=b(5),f=b(108);b.d(F,"a",function(){return a});a.prototype.AXg=function(){m.AFrameworkApplication.Rgc&&this.roamingAppsAreEnabled&&!this.HPc&&!this.SFc&&(this.GPc=
1,this.SFc=!0,this.Fhj(),this.RRe())};a.prototype.Fhj=function(){this.fXa=a.xec;this.JNc=0};a.prototype.getRoamingAppsLauncher=function(v,w,t){this.KVj?(v=new c,v.callback=w,v.state=t,v.kod=!0,this.WRe(v)):w(!1,"",t)};a.prototype.RRe=function(){var v=new (b(1319).CheckRoamingRightsRequest);v.RoamingApp=this.GPc;v.BaseDocQuerySignature=m.AFrameworkApplication.lj;v.execute(Object(l.a)(this,this.CXg,"checkUserRoamingRightsSucceeded"),Object(l.a)(this,this.BXg,"checkUserRoamingRightsFailed"),null)};a.prototype.CXg=
function(v){m.AFrameworkApplication.Hg||((v=d.dIa(v.data.je))?this.lPd(v.HasRights):this.lPd(!1))};a.prototype.BXg=function(){if(!m.AFrameworkApplication.Hg)if(this.JNc>=a.Uzi)this.lPd(!1);else{var v=new f.a(2,1,this.fXa,Object(l.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);m.AFrameworkApplication.gj.Yg(v);this.JNc++;this.fXa*=a.Zij;this.fXa>a.aqf&&(this.fXa=a.aqf)}};a.prototype.lPd=function(v){this.qje=v;this.HPc=!0;this.SFc=!1};a.prototype.retryCheckUserRoamingRights=
function(){this.RRe()};a.prototype.WRe=function(v){var w=new (b(1320).GetRoamingLauncherRequest);w.RoamingApp=this.GPc;w.BaseDocQuerySignature=m.AFrameworkApplication.lj;w.execute(Object(l.a)(this,this.cYh,"getRoamingAppsLauncherSucceeded"),Object(l.a)(this,this.bYh,"getRoamingAppsLauncherFailed"),v)};a.prototype.cYh=function(v){if(!m.AFrameworkApplication.Hg){var w=d.dIa(v.data.je);v=v.data.state;w?(this.platform=w.Platform,v.callback(!0,w.Launcher,v.state)):v.callback(!1,"",v.state)}};a.prototype.bYh=
function(v){if(!m.AFrameworkApplication.Hg){var w=v.data.state;5===v.data.status&&w.kod?(w.kod=!1,this.WRe(w)):w.callback(!1,"",w.state)}};Qk.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.pvg}},KVj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.HPc?this.qje:!1}}});Qk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.RB||(a.RB=new a(m.AFrameworkApplication.qLg))}}});
a.xec=1E3;a.Zij=5;a.aqf=12E5;a.Uzi=5;a.RB=null;Object(y.a)(a,"RoamingAppsManager",null,[])},1372:function(y,F,b){function a(M){return jl.call(this,M)||this}function c(M,oa,Xa){var Sb=this;this.ignorePrintArea=!1;this.pNj=function(){var xc=zg.g(Sb.$).Ca;Sb.EQc=!0;xc.kyd()};this.IQi=function(){Sb.Sid()};this.HQi=function(xc,jd,vd){ud.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",vd);Sb.Sid()};this.$=M;this.ea=M.ea;this.uia=oa;this.$N=
new H(1,this.ignorePrintArea);this.hD=oa=new d(M,oa,Pd.AFrameworkApplication.Kd,Xa);this.$.da.Ha(418,oa);this.MJf=new I(M);this.$.da.Ha(384,this);this.EQc=!1}function d(M,oa,Xa,Sb){var xc=this;this.activeCell=this.selectedRange=this.tg=this.graphServiceEndpoint=null;this.W_=0;this.Fm=this.fv=null;this.BH=new r;this.sk=new r;this.Nba=0;this.C7a=null;this.NLb=!1;this.W2a=this.MEb=null;this.Npd=!1;this.A6a=this.ezb=this.Wgc=!0;this.oma=this.Rya=this.$Ma=null;this.kyb=!1;this.z7a=null;this.V5a=this.$Kc=
!1;this.cAd=function(jd){if(!(jd&&jd.data&&jd.data.je&&jd.data.responseHeaders&&jd.data.je.length)){var vd=jd?jd.data?jd.data.je?jd.data.responseHeaders?jd.data.je.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";xc.tg&&(jd=xc.Xza(qe.a.instance.fa(1168)),xc.Nna(jd,0));ud.ULS.sendTraceTag(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",
vd);xc.jKd&&(jd=Object.assign(new tj.a,{extendedProperties:new Map}),jd.extendedProperties.set("InvalidParameterName",vd),jh.Health.instance.recordQosError(sj.a.OJf,[Wf.a.PJf],!1,!0,!0,!1,jd))}else if(0<xc.Nba&&jd.data.id===xc.Nba){if(jd.data.responseHeaders["Content-Type"]&&(Jb.a.contains(jd.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Jb.a.contains(jd.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){ud.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");
var ae=null;Jb.a.contains(jd.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ae=xc.e5g(jd));vd={};xc.bDb(vd,null,null,ae);jd.data.responseHeaders["Total-Pdf-PageCount"]?(ae=parseInt(jd.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),xc.kyb||(xc.$Ed>=ae?xc.oma=ae:xc.kyb=!0),xc.A6a&&xc.tg&&xc.tg.setPageRangeSettings(ae,xc.$Ed,xc.kyb,xc.Rya,xc.oma)):ud.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else vd=
sk.a.oi(jd.data.je),Qg.a.Y9(vd.Errors)||$f.a(xc.$).rd.XD(vd.Errors[0].MessageId),xc.c8i(vd.Errors),xc.tg&&(ae=xc.Xza(vd.Errors[0].Description),-1831476778===vd.Errors[0].MessageId?(ud.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),xc.Nna(ae,0,qe.a.instance.fa(1171))):xc.Nna(ae,0)),297284985===vd.Errors[0].MessageId?ud.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",
vd.Errors[0].MessageId):ud.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",vd.Errors[0].MessageId);jd=jd.data.state;jd.A9c(vd,jd.userContext,jd.methodName)}};this.bAd=function(jd){if(0<xc.Nba&&jd.data.id===xc.Nba){var vd=Ug.a.og(jd.data);xc.tg&&xc.Nna(xc.Xza(vd[0].Description),1);ud.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Qg.a.Uc(vd));vd=jd.data.state;
vd.naa(jd,vd.userContext,vd.methodName);xc.$.userOperationManager.fla.operation.tAa(function(){return xc.NLb})}};this.NJi=function(jd,vd,ae){jd.Errors&&0<jd.Errors.length&&xc.tg?(Qg.a.Y9(jd.Errors)||$f.a(xc.$).rd.XD(jd.Errors[0].MessageId),xc.Nna(xc.Xza(jd.Errors[0].Description),0),ud.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",jd.Errors[0].MessageId)):(ud.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),
xc.bDb(jd,vd,ae,null))};this.MJi=function(jd){jd=Ug.a.og(jd.data);xc.tg&&xc.Nna(xc.Xza(jd[0].Description),1);ud.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Qg.a.Uc(jd));xc.$.userOperationManager.fla.operation.tAa(function(){return xc.NLb})};this.ZAf=function(jd,vd){if(vd)switch(vd.X1i){case 1:if(xc.sk&&xc.W2a)switch(jd=xc.W2a.Ec,xc.W2a.stop(),xc.W2a=null,xc.sk.xv){case 1:xc.R_c(jd,4800,"ActiveSheet");break;case 0:xc.R_c(jd,6100,"CurrentSelection");
break;case 2:xc.R_c(jd,7500,"EntireWorkbook")}break;case 0:xc.MEb&&(jd=xc.MEb.Ec,xc.MEb.stop(),2400<jd&&(vd=Object.assign(new tj.a,{extendedProperties:new Map}),vd.extendedProperties.set("PaneLoadTime",jd.toString()),jh.Health.instance.recordQosError(sj.a.AEj,[Wf.a.O5f],!1,!0,!0,!1,vd)),xc.fv.Jei(function(ae){xc.yCj(ae)}))}};this.EF=function(jd,vd){(1===vd.Aw&&xc.$Ma===vd.Og||2===vd.Aw)&&xc.UKd()};this.$=M;this.uia=oa;this.f3=Xa;this.Eyd=Sb;this.jKd=Dg.HelperMethods.$Z;this.Ma=new Mj.a;this.$Ed=this.$.ya.PrintPreviewerPaginationRange;
this.Twa=kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);this.useMSPdfViewer=this.eAj();this.Ebi();this.agi=this.YWg();this.Mpd=kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!Sb&&Sb.LLa()&&kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.jg.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint}function l(){this.appName=this.disabledChangeGates=
this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function n(){this.onBackToSheet=null}function m(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function f(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=
this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function v(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function w(M,oa,Xa,Sb,xc,jd){var vd=A.call(this,xc)||this;vd.Nd=!1;vd.F5f=!1;vd.gBd=function(ae){vd.hD.gBd(ae)};vd.pBd=function(ae){vd.hD.pBd(ae)};vd.qSi=function(){ud.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
vd.pSi=function(ae){ae=Ug.a.og(ae.data);ud.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Qg.a.Uc(ae))};vd.EF=function(ae,Ie){2===Ie.Aw?vd.ev.clear():1===Ie.Aw&&vd.ev&&vd.ev.contains(Ie.Og)&&(ud.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Ok.a(Ie.Og.operation.operationName),Ie.Og.dequeueUtcTime.getTime()-Ie.Og.enqueueUtcTime.getTime()),
vd.ev.remove(Ie.Og))};vd.hD=M;vd.$N=Xa;vd.$=oa;vd.sheetName=Sb;vd.locale=window.navigator.browserLanguage||window.navigator.language||vd.$.ya.UICultureTag;vd.IXi=vd.g3g();vd.$.userOperationManager.kx(vd.EF);vd.ev=new ua.a;vd.Twa=kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);vd.isUniversalPrintEnabled=jd;return vd}function t(M,oa){this.sheetPrintOptions=this.sheetName=null;this.sheetName=M;this.sheetPrintOptions=oa}function A(M){this.rEi=[.75,.75,.7,.7,.3,.3];this.gDi=
[.75,.75,.25,.25,.3,.3];this.xYj=[1,1,1,1,.5,.5];this.Vae=this.bge=this.pde=this.Zce=this.Pje=this.C6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Km=M;this.Sbi();this.$bi()}function x(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function u(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function B(){this.marginValue=this.printSettingOption=null}function r(){this.margin=this.s0=this.yca=this.orientation=this.xv=0;this.ignorePrintArea=
!1;this.sheetPrintOptions=null;this.x1a=!1;this.NoColor=null}function I(M){var oa=this;this.ribbonCommandInfo=this.zEb=null;this.vNj=function(Xa,Sb,xc){Sb=!!Xa&&!!Xa.RequestTelemetryData;zg.g(oa.$).Li&&zg.g(oa.$).Li.wla(oa.FKa.oa(oa.ribbonCommandInfo.command),Xa.StateId,Sb?Xa.RequestTelemetryData.EcsOperationDuration:0,Sb?Xa.RequestTelemetryData.EcsRequestDuration:0,Sb?Xa.RequestTelemetryData.WfeRequestDuration:0);Dg.HelperMethods.$Z&&oa.SWg(xc)};this.$=M;this.FKa=new hi.a;this.Fva=new hi.a;this.Fva.add(78661008,
12);this.Fva.add(275604654,13);this.Fva.add(-13332329,14);this.Fva.add(-837651977,9);this.Fva.add(-1778266776,10);this.Fva.add(845325699,11);this.Mpd=kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function z(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function D(){this.Max=this.Min=this.Index=0}function V(){this.Col=this.Row=null}function U(M){this.sheetName=null;this.sheetName=M}function Q(M){this.sheetName=null;this.sheetName=M}
function la(M){this.sharedSheetCell=null;this.sharedSheetCell=M}function ba(M){this.sharedSheetCell=null;this.sharedSheetCell=M}function S(M,oa){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=M;this.addToPrintArea=oa}function H(M,oa){this.D6=0;this.c8d=!1;this.xv=M;this.ignorePrintArea=oa}function T(M,oa,Xa,Sb,xc,jd,vd,ae){var Ie=ia.call(this,M,oa,Xa,Sb,xc,kf.EwaSettings.la(407))||this;Ie.Oca=null;Ie.daa=null;Ie.bec=null;Ie.GSd=!1;Ie.nxa=null;Ie.H$a=null;Ie.Tya=null;Ie.$za=null;Ie.m5a=
null;Ie.jza=1;Ie.Bma=1;Ie.V_=0;Ie.D6=1;Ie.HFb=!1;Ie.ms=null;Ie.xIb=0;Ie.wIb=0;Ie.Uya=null;Ie.aAa=null;Ie.selectedRange=null;Ie.W_=0;Ie.i9a=function(){Ie.W_++;Ie.D6=Ie.rZc();Ie.c8c(Ie.daa.checked?!0:!1);Ie.w7&&(Ie.bec.disabled=Ie.Yv.checked);Ie.lOd(Ie.daa.checked?!0:!1);ud.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Ie.D6.toString());return!0};Ie.Fvf=function(){Ie.W_++;Ie.HFb=Ie.m5a.checked;ud.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",
Ie.HFb.toString())};Ie.umc=function(){Ie.W_++;Ie.jza=Ie.bwe();ud.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Ie.jza.toString());return!0};Ie.Gvf=function(){Ie.W_++;var Zf=Ie.Bma;Ie.Bma=T.paperSizeOptions[Ie.Tya.selectedIndex];ud.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",Zf.toString(),Ie.Bma.toString());return!0};Ie.Hvf=function(){Ie.W_++;var Zf=Ie.V_;Ie.V_=T.scalingOptions[Ie.$za.selectedIndex];
2===Ie.V_?(Ie.xIb=1,Ie.wIb=0):3===Ie.V_?(Ie.xIb=0,Ie.wIb=1):1===Ie.V_&&(Ie.xIb=1,Ie.wIb=1);ud.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",Zf.toString(),Ie.V_.toString());return!0};Ie.cAd=function(Zf){if(Zf&&Zf.data&&Zf.data.je&&Zf.data.responseHeaders&&Zf.data.je.length){if(Zf.data.responseHeaders["Content-Type"]&&Jb.a.contains(Zf.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){ud.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var Vg={};Ie.bDb(Vg,null,null)}else Vg=sk.a.oi(Zf.data.je),ud.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Vg.Errors[0].MessageId);Zf=Zf.data.state;Zf.A9c(Vg,Zf.userContext,Zf.methodName)}else ud.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Zf?Zf.data?Zf.data.je?Zf.data.responseHeaders?Zf.data.je.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Ie.bAd=function(Zf){var Vg=Ug.a.og(Zf.data);ud.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Qg.a.Uc(Vg));Vg=Zf.data.state;Vg.naa(Zf,Vg.userContext,Vg.methodName)};Ie.bDb=function(Zf){Zf.Errors&&0<Zf.Errors.length?ud.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
Zf.Errors[0].MessageId):(6===Ie.de.df&&Pd.AFrameworkApplication.sa.Te.dk(zg.g(Ie.$).RWf),ud.ULS.shipAssertTag(537154309,0,!!Ie.$.xa.pa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),Ie.$.xa.pa&&Ie.uia.G4f(Ie.wHa()))};Ie.uia=jd;Ie.activeCell=Ie.$.pa.activeCell.toString();Ie.Fm.SelectedRanges&&Ie.Fm.SelectedRanges.Ranges&&0<Ie.Fm.SelectedRanges.Ranges.length&&Ie.Fm.SelectedRanges.Ranges[0]&&(Ie.selectedRange=Cf.B(Ie.Fm.SelectedRanges.Ranges[0]).toString());
Ie.sheetName=vd;Ie.$N=ae;Ie.KCd={};M=0;for(oa=T.paperSizeOptions.length;M<oa;++M)Ie.KCd[T.paperSizeOptions[M].toString()]=M;Ie.locale=window.navigator.browserLanguage||window.navigator.language||Ie.$.ya.UICultureTag;Ie.w7=kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return Ie}function K(M,oa){this.printSettings=this.sheetName=null;this.sheetName=M;this.printSettings=oa}function da(M,oa,Xa,Sb,xc){M=ia.call(this,M,oa,Xa,Sb,xc)||this;M.Isb=null;return M}
function fa(M,oa,Xa,Sb,xc,jd,vd,ae){ae=M.Na(1,void 0===ae?null:ae);ae.sheetName=oa;ae.locale=Xa;return ha.i(M,"GetPrintSettings",ae,Sb,xc,jd,vd,4)}function W(M,oa,Xa,Sb,xc,jd,vd){vd=M.Na(1,void 0===vd?null:vd);vd.ConvertInParameters=oa;return ha.i(M,"ConvertWorkbookToPrintPdf",vd,Xa,Sb,xc,jd,4)}function ca(M,oa,Xa,Sb,xc,jd,vd,ae){ae=M.Na(9,void 0===ae?null:ae);ae.sheetName=oa;ae.printSettings=Xa;return ha.i(M,"SetSheetPrintSettings",ae,Sb,xc,jd,vd,0)}function ia(M,oa,Xa,Sb,xc,jd){M=Ai.call(this,M,
oa,Xa,void 0===jd?!1:jd)||this;M.Yv=null;M.Fm=Sb;M.yQb=xc;return M}function ea(){this.d5d=this.tb=null}function qa(M,oa,Xa,Sb,xc,jd,vd,ae,Ie,Zf){this.YWb=null;this.Sng=M;this.akb=oa;this.uNc=Xa;this.brg=Sb;this.Frg=xc;this.POc=new If.a(Object(uf.a)(this,this.DWh,"getProbeResults"));this.mVa=jd;this.jae=Ie;this.Vwg=vd;this.Grg=ae;this.Nrg=Zf}function pa(M,oa){this.j8f=M;this.LSa=oa}function Pa(M){this.isEnabled=Boolean.parse(M.DirectPrintIsEnabled||"false");Boolean.parse(M.DirectPrintProbeIsEnabled||
"false");this.Zji=Boolean.parse(M.DirectPrintEnabledForInternetExplorer||"false");this.KSa=(M.DirectPrintSupportedMimeTypes||"").split(Pa.G6c);this.LSa=(M.DirectPrintSupportedPlugins||"").split(Pa.G6c);this.I9h=(M.DirectPrintImmersivePreviewPlugins||"").split(Pa.G6c);this.Pdf=Boolean.parse(M.DirectPrintEnabledForEdge||"false");this.Ogi=Boolean.parse(M.ChromePrintLayoutFixIsEnabled||"false");this.NXg=parseInt(M.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.rwd=14;this.Sqf=14394;if(M=M.DirectPrintMinimalSupportedEdgeVersion){var oa=
M.split(".");2===oa.length?(this.rwd=parseInt(oa[0]),this.Sqf=parseInt(oa[1])):ud.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",M)}else ud.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}function Ha(M,oa,Xa,Sb,xc){Xa=void 0===Xa?null:Xa;Sb=void 0===Sb?!0:Sb;xc=void 0===xc?!1:xc;oa=ze.call(this,M,!0,!(Ha.HTa&&Sb),new ie(M,oa),Xa,xc)||this;Ha.HTa=Ha.HTa&&Sb;if(Ha.HTa){Sb=
document.createElement("iframe");xc=null;var jd=oa.Yeh;Sb.name="pdfObjectFrame";Sb.id="pdfObjectIFrame";if(Xa&&0<Xa.count){var vd=fg.a.egd(M,Xa);M=fg.a.FId(M,Xa);xc=document.createElement("form");xc.id="printPreviewPostForm";xc.method="POST";xc.target=Sb.name;xc.action=M;M=yl(vd);for(Xa=M.next();!Xa.done;Xa=M.next())Xa=Xa.value,vd=document.createElement("input"),vd.type="hidden",vd.name=Xa.key,vd.value=Xa.value,xc.appendChild(vd)}else Sb.src=M;jd.appendChild(Sb);xc&&(jd.appendChild(xc),xc.submit());
Sys.UI.DomElement.addCssClass(Sb,"DirectPrintPdfObjectHidden");Yh.a.Xg(Sb,Yh.a.YB,Yh.a.uj)}return oa}function Ya(M){this.vP=M}function Na(M,oa,Xa,Sb){Sb=void 0===Sb?null:Sb;var xc=wi.call(this)||this;xc.Upa=null;xc.Tl=null;xc.zP=null;xc.Rm=[];xc.nUb=oa;xc.vP=M;xc.$pg=Xa;xc.BVb=Sb;xc.Hlb=new Li.a("LoadResource","LoadPrintablePdf");return xc}function eb(M){var oa=Wh.call(this)||this;oa.$=M;oa.fc();return oa}function Ia(M){this.stopwatch=this.PZb=this.tzc=this.WUd=null;this.f9f=0;this.$=M;(this.JWc=
kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||M.da.Ha(322,this)}function lb(M){this.vie=0;this.g9f=M}function hc(M,oa,Xa,Sb,xc,jd,vd){this.title=M;this.body=oa;this.Q1i=Xa;this.primaryButtonAction=Sb;this.secondaryButtonAction=jd;this.pXf=xc;this.targetObject=vd}function ma(M){var oa=Oi.call(this)||this;oa.$=M;oa.fc();return oa}function Ja(M){this.$=M;M.da.Ha(309,this)}function Ta(M){var oa=zi.call(this,M)||this;oa.Vo=null;oa.stopwatch=null;oa.bDi=function(Xa){if(1===Xa)oa.$.Ka.Yb(new Uj.a(-2050946363,
na.a.dc,2,8,null)).continueWith(function(xc){oa.Vo.setResult(!Tg.a(xc)&&xc.result)}),Xa="Yes";else{var Sb=2===Xa;oa.Vo.setResult(Sb);Xa=2===Xa?"No":"Close";Sb&&oa.F1i()}oa.Zvi(Xa);oa.hide()};return oa}function pb(){}function Db(M){return th.call(this,M)||this}function fb(M){this.Fi=M}function xa(M){var oa=Ch.call(this)||this;oa.$=M;oa.fc();return oa}function ya(M){M.da.Ha(446,this)}function Ga(M){return rh.call(this,M)||this}function db(M,oa){var Xa=this;this.sortOptions=this.byc=this.selectedRange=
null;this.kdf=!1;this.activeCell=this.ag=this.Db=this.Vc=null;this.GTi=function(Sb,xc){gj.b(Sb,-901005882)?($f.a(Xa.$).rd.XD(-901005882),Xa.zFd(xc)):Xa.k8e(Sb)?Xa.V6e(Sb.Errors[0]):!gj.a(Sb)&&Sb.Result&&(Xa.sortOptions=xc,Xa.byc=Cf.D(Sb.Result.ActualSortRange),Xa.Fkf=Xa.ha().pia,Xa.kdf||(Xa.selectedRange=Xa.ha().va.Td,Xa.selectedRange.equals(Xa.byc)||Xa.$Cj()),Xa.sortOptions&&Xa.sortOptions.ActiveCell&&(Sb=Xa.sortOptions.ActiveCell,Sb=new Hj.Range(Sb.FirstRow+1,Sb.FirstColumn+1,Sb.FirstRow+1,Sb.FirstColumn+
1,!0,!1),Xa.JL(Sb),Xa.AWd(Sb)))};this.onContentReady=function(){Xa.BOf(!1);var Sb=Xa.ha();Sb.va.qh&&Sb.va.Td.equals(Xa.byc)&&Sb.updateSelection(Xa.selectedRange,Sb.va.activeCell,0,void 0,void 0,void 0,!0)};this.$Mi=function(Sb,xc){Sb&&!Qg.a.lh(Sb.Errors)&&Xa.Vc&&(Xa.Vc.Po=Sb.Result,Xa.pJb(),Xa.applyPivotSort(xc))};this.ZMi=function(){};this.$=M;this.Fkf="";this.namedSheetViewPublic=oa;this.gridView=zg.g(this.$);this.$.Wb.Vh("LoadResource","LoadDialogControlsStopwatch")}function Ob(M,oa,Xa,Sb,xc,jd,
vd){vd=M.Na(41,void 0===vd?null:vd);vd.options=oa;return ha.i(M,"Sort",vd,Xa,Sb,xc,jd,0)}function Ec(M){this.filterRange=null;this.filterRange=M}function wb(M){this.selection=null;this.selection=M}function kb(M,oa,Xa,Sb){var xc=Fd.call(this,M)||this;xc.QQd=!1;xc.Mfc=!1;xc.z6=[];xc.Mei=function(jd,vd){var ae=xc.S6g(jd);xc.G5a(214,function(Ie,Zf,Vg){return ha.H(xc.$.na.ta,ae,xc.y_a(Ie,xc.FHh(vd)),xc.mU(Zf),Vg,null)},16,!0)};xc.Lei=function(jd,vd,ae){jd=ha.G(xc.$.na.ta,vd,xc.pIh(vd,ae),xc.rNi,null,jd);
Array.add(xc.z6,jd)};xc.rNi=function(){ud.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");xc.i6b(kb.Sqb())};xc.A6c=function(jd,vd){if(1===jd){jd=vd.sortRangeType;var ae={};ae.SortOptions=vd.sortOptions;ae.ShouldRestoreSelection=xc.QQd;ae.SelectedRange=xc.selectedRange;ae.OriginalActiveCell=xc.Foc;ae.TopCellAddress=xc.fTa;if(xc.Pyj(jd)){var Ie=xc.$;xc.namedSheetViewPublic.GAa().continueWith(function(Zf){Zf.result&&
kb.WLf(Ie,ae)})}else kb.WLf(xc.$,ae)}else xc.QQd&&xc.Coa(xc.selectedRange,xc.Foc)};xc.k8h=function(jd,vd){xc.QQd=!0;xc.Coa(jd,vd)};xc.getColorName=function(jd){return Gc.a.jKa(dd.a.jH(jd))};ud.ULS.shipAssertTag(529105669,0,!!oa.ActiveCell);ud.ULS.shipAssertTag(529105668,0,!!oa.SelectedRange);ud.ULS.shipAssertTag(529105667,0,Cf.D(oa.SelectedRange).contains(Cf.C(oa.ActiveCell)));ud.ULS.shipAssertTag(529105666,0,Jb.a.equals(oa.SelectedRange.SheetName,oa.ActiveCell.SheetName,!0));kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&
(xc.Obb=new zd.a(M,Rc.a.Zah,function(){return xc.Mfc},1));xc.selectedRange=oa.SelectedRange;xc.Foc=oa.ActiveCell;xc.tUg=oa.ExpandSelection;xc.namedSheetViewPublic=Xa;xc.fTa=Sb;xc.initializeAndShow(qe.a.instance.fa(182),xc.A6c,xc.eta(oa));return xc}function vb(M,oa){M=Pc.call(this,M,oa)||this;M.PBb=M.Mcd();M.zr();return M}function Gb(M,oa){var Xa=M.SortRange;M=M.SortTopToBottom?Xa.LastColumn-Xa.FirstColumn:Xa.LastRow-Xa.FirstRow;return 0<=oa&&oa<=M}function Za(M,oa){if(!M.SortColumnInfoItems)return ud.ULS.sendTraceTag(537151618,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Xa=new ua.a,Sb=yl(M.SortColumnInfoItems),xc=Sb.next();!xc.done;xc=Sb.next()){xc=xc.value;if(!Gb(M,xc.ColumnOffset))return ud.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",xc.ColumnOffset,M.SortRange),!1;if(!xc.Name)return ud.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",
xc.ColumnOffset),!1;if(xc.CellColors&&!xc.CellColors.length)return ud.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",xc.CellColors.length),!1;if(xc.TextColors&&!xc.TextColors.length)return ud.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",xc.TextColors.length),!1;if(xc.Icons&&!xc.Icons.length)return ud.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",
xc.Icons.length),!1;Xa.add(xc.ColumnOffset)}if(M.SortConditions)for(Sb=yl(M.SortConditions),xc=Sb.next();!xc.done;xc=Sb.next())if(xc=xc.value,!Xa.contains(xc.RowColOffset))return ud.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",xc.RowColOffset),!1;if(M.HeaderColumnInfoItems){if(M.HeaderColumnInfoItems.length!==M.SortColumnInfoItems.length)return ud.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),
!1;for(Xa=0;Xa<M.HeaderColumnInfoItems.length;++Xa){Sb=M.HeaderColumnInfoItems[Xa];if(oa&&Sb.ColumnOffset!==M.SortColumnInfoItems[Xa].ColumnOffset)return ud.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Sb.CellColors&&1<Sb.CellColors.length)return ud.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),
!1;if(Sb.TextColors&&1<Sb.TextColors.length)return ud.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Sb.Icons&&1<Sb.Icons.length)return ud.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function ub(M){if(!M.SortConditions)return!0;for(var oa=yl(M.SortConditions),Xa=oa.next();!Xa.done;Xa=
oa.next()){Xa=Xa.value;if(!Gb(M,Xa.RowColOffset))return ud.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Xa.RowColOffset,M.SortRange),!1;if(1===Xa.SortConditionType&&Xa.FillGradient&&!$a.isValid(Xa.FillGradient))return ud.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function fc(M){return M.SortRange?4===M.SortRangeType?
(ud.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",M.SortRangeType),!1):2===M.SortRangeType&&M.SortTopToBottom&&(null==M.HeaderRowSize||0>M.HeaderRowSize)?(ud.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(ud.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function $a(){}
function nb(M,oa,Xa,Sb){new Sys.UI.Point(M,oa);new Sys.UI.Point(Xa,Sb)}function sc(){}function rd(M,oa,Xa,Sb){M=M.HeaderColumnInfo;return Sb||M?2===oa&&Xa?M.CellColors&&1!==M.CellColors.length?(ud.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):M.TextColors&&1!==M.TextColors.length?(ud.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):M.Icons&&1!==M.Icons.length?(ud.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:M?(ud.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Xa),!1):!0:!0}function $b(M,oa){M=M.ColumnInfo;switch(oa){case 1:return M.CellColors&&
M.CellColors.length?!0:(ud.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return M.TextColors&&M.TextColors.length?!0:(ud.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return M.Icons&&M.Icons.length?
!0:(ud.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return ud.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function Wb(M){var oa=this;this.$v=function(Xa){switch(Xa){case 0:oa.CNa("Cancel");break;case 1:oa.CNa("Expand and sort");oa.eSe(!0);break;case 2:oa.CNa("Just sort"),
oa.eSe(!1)}};this.eSe=M}function lc(M,oa,Xa,Sb,xc,jd,vd){vd=M.Na(41,void 0===vd?null:vd);vd.filterRange=oa;return ha.i(M,"ReapplyAutoFilter",vd,Xa,Sb,xc,jd,0)}function Oa(M){this.options=null;this.options=M}function qb(M){return Z.call(this,M)||this}function Ub(M,oa,Xa){var Sb=Wj.call(this)||this;Sb.qwe=!1;Sb.pwe=!1;Sb.dIi=function(){Sb.qwe=!0;Sb.L3f()};Sb.$=M;Sb.Sa=oa;Sb.bK=Xa;$f.a(Sb.$).AHd(new bj.a(zb.a.Gcg,zb.a.idle,Ub.pWg),new Hi.a(zb.a.Rze,zb.a.A_,null,zb.a.ZO,zb.a.idle));return Sb}function jc(M){var oa=
kk.call(this,M,qe.a.instance.fa(1228))||this;oa.textBox=null;oa.bRa=null;oa.tTa=null;oa.eFf=function(){var Xa=oa.$;oa.Cu();var Sb=new Kb(Xa,1231,1232,1233,function(xc,jd,vd){var ae=Xa.na.ta.$b(),Ie=Xa.na.ta;ae=Ie.Na(1,ae);return ha.i(Ie,"UnshareForm",ae,xc,jd,vd,null,0)},16);Sb.initialize();Sb.mf()};return oa}function Kb(M,oa,Xa,Sb,xc,jd){jd=void 0===jd?0:jd;M=zk.call(this,M,qe.a.instance.fa(oa),!1)||this;M.message=Xa;M.JGi=Sb;M.c_d=xc;M.operationFlags=jd;return M}function dc(M,oa,Xa){var Sb=ra.call(this,
M,new Sys.UI.Point(dc.Uch,dc.vch),qe.a.instance.fa(oa?1226:1225))||this;Sb.F0a=null;Sb.SKc=!1;Sb.roc=function(xc){function jd(Zf,Vg,Gh){return ha.F(vd.na.ta,lh.b(Zf,Sb.QSi),Vg,Gh,ae)}var vd=Sb.$,ae=new Qb;ae.uH=xc.Values[O.uH];var Ie=!1;switch(xc.MessageId){case O.z1f:Sb.Cu();Ie=!0;ae.VDd=1334518759;break;case O.view:Sb.iBa=qe.a.instance.fa(1226);Sb.Jeg(!0);break;case O.Jze:Sb.Cu(),Ie=!0}kf.EwaSettings.tc()?(xc=new Kc.a(140,0,jd),xc.flags=Ie?16:80):(xc=Ie?new Kc.a(140,0,jd):new Cj.a(140,0,jd),xc.flags=
16);vd.userOperationManager.ic(xc,Sb.de)};Sb.MKi=function(){var xc=Sb.$;xc.ya.SurveyRedirectUrl?(Sb.Cu(),xc.ye(1305810481,0,8,null)):(Sb.iBa=qe.a.instance.fa(1225),Sb.Jeg(!1))};Sb.dTi=function(){var xc=Sb.$;Sb.Cu();xc.ye(1334518759,0,8,null)};Sb.cwf=function(xc){var jd=Sb.$;Sb.Cu();xc.MessageId===O.Tze&&jd.ea.Vbd()};Sb.uRi=function(){Sb.SKc=!0;Sb.raiseEvent(dc.etd)};Sb.QSi=function(xc,jd){if(!gj.a(xc)){xc=Sb.$;if(jd.uH){var vd=xc.ea.xa;if(vd.contains(jd.uH.SheetName))Sb.jnc(jd);else{var ae=null;ae=
function(){vd.Oma(ae);Sb.jnc(jd)};vd.Vga(ae)}}1461300262!==jd.VDd&&xc.ye(jd.VDd,0,8,null)}};Sb.N9d=oa;Sb.de=Xa;return Sb}function Qb(){this.uH=null;this.VDd=1461300262}function O(){}function Ba(M){M=ra.call(this,M,new Sys.UI.Point(960,680),qe.a.instance.fa(1221))||this;M.name=E.a.fLe;return M}function ra(M,oa,Xa,Sb){var xc=uk.call(this,M,Xa,2,void 0===Sb?null:Sb)||this;xc.EJc=null;xc.onResize=function(){var jd=xc.aSh();xc.iLa.setAttribute("width",jd.x.toString());xc.iLa.setAttribute("height",jd.y.toString());
xc.gSj(jd);xc.tAd()};xc.Ilh=function(){var jd=xc.sx.parentNode.style,vd=jd.top;jd.top="2px";jd.top=vd};xc.bHe=oa;xc.$.mA(xc.onResize);xc.sdc();return xc}function ta(M){return tk.call(this,M)||this}function Fa(M){this.$=M}function cb(M,oa,Xa,Sb,xc,jd,vd,ae){ae=M.Na(9,void 0===ae?null:ae);ae.sheetName=oa;ae.directionRtl=Xa;return ha.i(M,"ChangeSheetDirection",ae,Sb,xc,jd,vd,0)}function Wa(M,oa,Xa,Sb,xc,jd,vd,ae){ae=M.Na(9,void 0===ae?null:ae);ae.sheetName=oa;ae.show=Xa;return ha.i(M,"ShowHeadings",
ae,Sb,xc,jd,vd,0)}function mb(M,oa,Xa,Sb,xc,jd,vd,ae){ae=M.Na(9,void 0===ae?null:ae);ae.sheetName=oa;ae.show=Xa;return ha.i(M,"ShowGridlines",ae,Sb,xc,jd,vd,0)}function kc(M,oa){this.sheetName=null;this.value=!1;this.sheetName=M;this.value=oa}function Ab(M,oa){var Xa=ug.call(this)||this;Xa.activityName=M;Xa.JM=oa;Xa.fc();return Xa}function Tb(M,oa,Xa,Sb,xc){M=Dk.call(this,M,oa)||this;Tb.pvd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Tb.ovd=[-1468309555,-315732528,-399065540,
810218235,1531005923,1593924569,1112506702,1220851643];Tb.fpf=[-1468309555,611268539,-1750576502,61029505];Tb.epf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];M.Jxc=Xa;M.vDj=Sb;M.EMj=xc;return M}function ib(){var M=Qi.call(this)||this;M.fc();return M}function Sa(M,oa){return yk.call(this,M,oa)||this}function Mb(M){var oa=aj.call(this)||this;oa.$=M;oa.fc();return oa}function Jc(M,oa){this.$=M;this.Fi=oa;this.$.da.Ha(393,this)}function Ib(M){var oa=Ij.call(this,M)||
this;oa.jFh=function(Xa,Sb,xc,jd,vd){return 1===xc?32:Xa===Tf.a.VQa&&2===xc?(Xa=oa.$.na.ta.$b(),ha.ab(oa.$.na.ta,vd[0],vd[1],null,null,Xa),32):8};return oa}function Nb(M,oa){this.$=M;this.Fi=oa}function sa(M){return Vj.call(this,M)||this}function Va(M,oa){var Xa=this;this.PRi=function(Sb,xc){if(!gj.a(Sb)&&xc){var jd=!!Sb&&!!Sb.RequestTelemetryData;zg.g(Xa.$).Li.wla(xc,Sb.StateId,jd?Sb.RequestTelemetryData.EcsOperationDuration:0,jd?Sb.RequestTelemetryData.EcsRequestDuration:0,jd?Sb.RequestTelemetryData.WfeRequestDuration:
0)}};this.$=M;this.Fh=oa}function Xb(M,oa){var Xa=Lk.call(this,M)||this;Xa.gvb=function(Sb){Sb=Xa.ofd(Sb);return Xa.Hcd(Sb)};Xa.Yhj=function(Sb,xc){var jd=Xa.Azb=xc[Xb.Hhi];1===Sb?(Sb=xc[Xb.CDj],jd=Xa.F4e(Sb,jd),ud.ULS.shipAssertTag(537153996,0,jd!==Xb.kba,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Sb),Sb=jd!==Xa.Eld,ud.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Xa.isRow,Xa.Azb,jd,
Sb),Sb&&Xa.E4g(jd)):ud.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Xa.isRow)};Xa.isRow=2040891415===oa.command;Xa.gridView=zg.g(Xa.$);Xa.wtc=new Rb(Xa.$.workbookContext.DxDigitNormal);Xa.Eld=Xa.RTg();M=Xa.r3g(Xa.Eld);oa=Xa.t3g(Xa.Eld);Xa.fo=qe.a.instance.fa(Xa.isRow?470:471);M=Xa.pV(M,oa);Xa.initializeAndShow(Xa.fo,Xa.Yhj,M);ud.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Xa.isRow);return Xa}function mc(M){this.resizeParameters=
null;this.resizeParameters=M}function od(M,oa){this.isRow=!1;this.autoFitRange=null;this.isRow=M;this.autoFitRange=oa}function ld(){var M=Rk.call(this)||this;M.fc();return M}function Zc(M,oa){var Xa=al.call(this,oa.domElement)||this;Xa.XTf=!1;Xa.zba=!1;Xa.ASa=null;Xa.B7a=null;Xa.uq=null;Xa.offset=0;Xa.dm=0;Xa.vIb=0;Xa.P0=null;Xa.Z6=null;Xa.eN=null;Xa.i7h="headerResizeTooltip";Xa.nud=null;Xa.lG=null;Xa.Qza=!1;Xa.jWa=!1;Xa.DXc=!1;Xa.RN=function(Sb){if(Xa.grid.Rx)return!0;Sb=fk.a(Xa.grid.$).Ie(Sb);if(3===
Sb.yb&&!Xa.Cif(Sb.Ea)||!Xa.YIf(Sb,!1))return!1;ud.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var xc=Xa.Dxc();Xa.Ocd(Sb.clientPoint,xc,!0);Xa.Qza||(mj.a.instance.qa(kg.a.fh,Xa.domElement.ownerDocument.body,Xa.l9a),Eg.a.instance.qa(kg.a.xg,Xa.domElement.ownerDocument.body,Xa.l9a),Xa.Qza=!0);Xa.Kef()&&Xa.zba&&Xa.F$e(Sb);return!1};Xa.Kmc=function(Sb){Sb=fk.a(Xa.grid.$).Ie(Sb);Xa.Kef()&&Xa.DXc&&Xa.F$e(Sb);if(Sb.Ea.button!==Sys.UI.MouseButton.leftButton||
!Xa.zba)return!1;hj.g(Sb.Ea);Xa.FLe();Sb=Gg.a.D5a;Xa.uq&&(Sb=Xa.jWa?Xa.led():Xa.uq.Bja());var xc=Sb!==Xa.dm;if(Xa.ASa&&xc&&Sb!==Gg.a.D5a){Sb=Xa.grid;xc=Xa.M2e(Sb);var jd={};jd.SheetMultiRange=Cf.r(xc,Sb.$);Zc.UOd(jd,Xa.isRow,Xa.dm);Xa.wlh(jd);Sb.QIj=!0}else Xa.Xh(null,null),Xa.asc();return Xa.jWa=!1};Xa.mca=function(Sb){Sb=Nj.a.create(Sb.eventName,Sb.Ub,Sb.Ea,Sb.yb);Sb=fk.a(Xa.grid.$).Ie(Sb);if(!Xa.YIf(Sb,!0))return!1;Sb=Xa.grid;var xc=Xa.M2e(Sb);xc=Cf.r(xc,Sb.$);Sb.Ob.kl([Xa.isRow?13:14]);Sb.Ob.ldb();
Xa.asc();var jd={};Sb.$.ye(Xa.isRow?146338636:1391094586,na.a.dc,30,(jd.autoFitRanges=xc,jd));return!1};Xa.l9a=function(Sb){Sb=fk.a(Xa.grid.$).Ie(Sb);if(!Xa.zba)return!1;hj.g(Sb.Ea);var xc=Xa.isRow;if(!Xa.P0){Xa.P0=document.createElement("div");Xa.P0.style.cssText="position: relative; width: inherit; height: inherit;"+(xc?"top: 0px; ":Xa.rtl?"right: 0px:":"left: 0px:");for(var jd=Xa.uq.aK();jd.nextSibling;)Xa.P0.appendChild(jd.nextSibling);jd.parentNode.appendChild(Xa.P0)}jd=Sb.clientPoint;var vd=
xc?jd.y-Xa.B7a.y:(Xa.rtl?-1:1)*(jd.x-Xa.B7a.x),ae=xc?jd.y-Xa.ASa.y:(Xa.rtl?-1:1)*(jd.x-Xa.ASa.x),Ie=Xa.uq.Bja();if(Ie===Gg.a.D5a)return!1;vd&&(0<Xa.dm||0<Ie+ae)&&Ie+ae<=Xa.Ppf&&(Xa.dm=Xa.Dxc(ae),Xa.Ocd(jd,Xa.dm,!1),Fe.DOMElementExtensions.CTa(Xa.uq.aK(),!xc,Math.max(Xa.vIb+ae,0)),Xa.P0.style[xc?"top":Xa.rtl?"right":"left"]=Math.max(ae,-Xa.vIb)+"px",Fe.DOMElementExtensions.CTa(Xa.uq.qf.domElement,!xc,(xc?Xa.uq.qf.YP:Xa.uq.qf.ZP)+Math.max(ae,-Xa.vIb)),Xa.B7a=new Sys.UI.Point(Sb.clientPoint.x,Sb.clientPoint.y),
Fe.DOMElementExtensions.setVisible(Xa.lG,!1));return!0};Xa.PR=function(Sb){if(Xa.grid.Rx)return!0;Sb=fk.a(Xa.grid.$).Ie(Sb);var xc;if(!Xa.ghf||-1!==Xa.grid.ha.selectionType)return Ah.a(Xa.grid.$).Cq()&&(xc=Xa.$ed(Sb))&&(xc.Pva.style.cursor=""),!1;if(Xa.zba)return Xa.eci(),!1;xc=Xa.$ed(Sb);if(!xc)return!1;xc.Pva.style.cursor=!Xa.grid.isEditing&&Xa.Brd(xc)?Xa.isRow?"row-resize":"col-resize":"";hj.g(Sb.Ea);return!0};Xa.sr=function(){Xa.asc()};Xa.Xh=function(){if((3===na.a.dc||Ff.a.Wp)&&Xa.grid.ha.va.qh){var Sb=
Xa.grid.ha.va.Td;if(!(!Sb.isRow&&!Sb.Rh||!Xa.domElement||Sb.isRow&&Xa.isRow&&!Array.contains(Xa.qf.En,Sb.top)||Sb.Rh&&!Xa.isRow&&!Array.contains(Xa.qf.En,Sb.left))){var xc=Xa.grid.pg(Sb,Xa.qf.vj.paneType);xc&&(Xa.lG||Xa.T$g(),Sb.isRow&&Xa.isRow?(Fe.DOMElementExtensions.setVisible(Xa.lG,!0),Xa.lG.style.top=xc.bottomRight.y-Xa.lG.offsetHeight/2+"px"):Sb.isRow||Xa.isRow||(Fe.DOMElementExtensions.setVisible(Xa.lG,!0),Rh.c(Xa.lG.style,Xa.grid.rtl,xc.bottomRight.x-Xa.lG.offsetWidth/2+"px")))}}};Xa.DF=function(Sb,
xc){xc.KP&&Xa.wpb()};Xa.qf=oa;Xa.isRow=oa.isRow;Xa.rtl=oa.vj.rtl;Xa.grid=M;Xa.Ppf=Xa.isRow?Gg.a.Ovd:Gg.a.ykc;Xa.e7h=qe.a.instance.fa(429);Xa.n7h=qe.a.instance.fa(428);Xa.h7h=qe.a.instance.fa(430);gf.a(Xa.grid.$,function(Sb){Xa.nud=Sb.rQ(yc.a.fij,!1)});Xa.n9i();Xa.grid.ha.E2(Xa.Xh);Xa.grid.ha.K9(Xa.sr);Xa.grid.$q(Xa.Xh);Ah.a(Xa.grid.$).sg.Wga(Xa.DF);return Xa}function Rb(M){this.z7c=M}function fd(M,oa,Xa,Sb,xc,jd,vd){this.Pva=M;this.VBb=oa;this.lOa=Xa;this.Ajd=Sb;this.Abb=xc;this.Bif=jd;this.m6h=vd}
function wd(){}function Ad(M){var oa=pj.call(this)||this;oa.$=M;oa.fc();return oa}function Ne(M){var oa=this;this.poa=this.aWe=this.xFb=this.d2a=this.eqc=this.Lca=this.yPa=null;this.sqd=this.sNb=this.BLd=!1;this.BKb=!0;this.Sfc=!1;this.TRd=!0;this.rNb=this.N0a=this.bCe=0;this.Ouc={};this.Soc={};this.Roc={};this.lJf=0;this.X6a=this.M9d=!1;this.nbj=function(){Fe.DOMElementExtensions.toggleCssClass(oa.$.ar,"ewr-presentMode-transition",!1);$removeHandler(oa.d2a,"transitionend",oa.poa)};this.dj=function(){parseInt(oa.$.Vv.style.right,
10)!==oa.bCe&&window.requestAnimationFrame(function(){oa.bBc(0);oa.$.qza(Hb.a.DZ("PresentModeManager.OnContentAreaResized"))})};this.Fya=function(){var Xa=Object(Yf.a)(af.a,oa.$.pa);if(Xa&&oa.mz){oa.gridView.yod=!1;Xa=Xa.headersVisible;var Sb=zg.g(oa.$).rtl;Fe.DOMElementExtensions.toggleCssClass(oa.$.ar,"ewr-presentMode-on-headers-off",!Xa);Fe.DOMElementExtensions.toggleCssClass(oa.$.ar,"ewr-presentMode-on-rtl",Sb);(12!==oa.N0a&&!Xa||32!==oa.N0a&&Xa&&!Sb||0!==oa.N0a&&Xa&&Sb)&&window.requestAnimationFrame(function(){oa.bBc(2)})}};
this.ud=function(){oa.ecf();oa.sh("OnWorkbookOpened");ud.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.sr=function(){oa.sqd=!0;oa.zea("OnSelectionStarted")};this.Xh=function(){oa.sqd=!1;oa.zea("OnSelectionEnded");oa.fWf()};this.ej=function(){oa.zea("OnEditStarted")};this.Jg=function(){oa.zea("OnEditEnded")};this.xw=function(){if(!oa.Sfc){var Xa=kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");
oa.zea("OnVisibleAreaChanged",!0,Xa)}};this.lya=function(){oa.Sfc=!0};this.kp=function(){oa.zea("OnCurrentSelectionModeChanged");oa.fWf();oa.sh("OnCurrentSelectionModeChanged")};this.Em=function(){oa.zea("OnBlockCacheItemEvicted")};this.Se=function(){oa.zea("OnBlockCacheItemChanged")};this.jca=function(){oa.Sfc||oa.zea("OnActiveItemPanesChanged")};this.hi=function(){oa.Sfc=!1;oa.Lca.sh("ActiveSheetChanged");oa.Fya()};this.$Db=function(Xa,Sb){if(Xa=Object(Yf.a)(af.a,Sb.item))Xa.Epb(16,!0),Xa.xnb(oa.Fya)};
this.LLi=function(){Ve.hji||(oa.eqc&&oa.eqc.Dq&&oa.eqc.hide(),zg.g(oa.$).isEditing&&zg.g(oa.$).Qq(!0),oa.xxc(!1),ud.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.MLi=function(){ud.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=M;this.gridView=zg.g(this.$);this.Zlj=M.ya.PresentModeRenderUpdateTimeout;this.initialize(M)}function Ve(){}function Kd(M,
oa){var Xa=oi.call(this,M)||this;Xa.x1i=function(){Xa.Lca.ORd(!0)};Xa.Lca=oa;Xa.domElement.classList.add("ewr-presentMode-on");M={};M=(M[Kd.Zy]=Xa.Bc,M);Xa.kc=0;Xa.initializeAndShow("",Xa.x1i,M);return Xa}function Ud(M){this.f_a=this.vEd=null;this.$=M;this.gridView=zg.g(this.$)}function te(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function oe(){this.height=this.width=0}function Ke(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=
0}function cc(M){var oa=this;this.Dse=this.wPa=this.tEd=this.uEd=this.Kca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.Jpc={};this.Ipc={};this.sPa=null;this.aIf=0;this.onKeyDown=function(Xa){Xa=Xa.Ea;if(9===Xa.keyCode){var Sb=oa.Kca.querySelectorAll(Fe.DOMElementExtensions.Qp),xc=Fe.DOMElementExtensions.Bl(Sb);Sb=Fe.DOMElementExtensions.fz(Sb);Fe.DOMElementExtensions.Lda(Xa,xc,Sb);return!0}return!1};this.Hl=function(){var Xa=[];oa.$.da.Za(337,function(Sb){oa.wPa.getPresentModeFloatieControlsMap().then(function(xc){for(var jd=
{},vd=0;vd<xc.length;vd++)jd[xc[vd].controlId]=xc[vd].modelType;Xa.push.apply(Xa,Sb.Qca.k4a(jd));0<Xa.length&&appChrome.api.dispatch(Xa);oa.nlj()})})};this.$=M}function sd(){}function zc(M){return Ee.call(this,M)||this}function nd(M,oa){this.$=M;this.presentModeManager=oa}function rb(M,oa,Xa,Sb){var xc=$c.call(this)||this;xc.activityName=M;xc.JM=oa;xc.TJ=Xa;xc.$=Sb;xc.fc();return xc}function Zd(M,oa,Xa){var Sb=jk.call(this,M,oa)||this;Sb.yi=null;Sb.Ksi=function(xc){var jd=Sb.Cs.rd,vd=Object(Yf.a)(8,
jd.Je);var ae=xc.Mrb;Sb.unsubscribe(function(Vg){xc.remove_disposing(Vg)});for(var Ie=0,Zf=jd.errors.length;Ie<Zf;Ie++)-573864504===jd.errors[Ie].MessageId&&jd.vla(jd.errors[Ie]);switch(ae){case 1:vd.ea.uAc=!0;ud.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");Sb.vh(vd.isEditMode?zb.a.KMb:Sb.Ech);Sb.hp();break;case 2:Sb.vh(zb.a.openInExcelClient);Sb.hp();break;case 0:jd.activityState[Vd.a.Ks]=
!1,Sb.vh(Sb.TJ),Sb.hp()}};Sb.Ech=oa;Sb.TJ=Xa;return Sb}function qc(M,oa){M=ek.call(this,M,oa)||this;M.Hpa=0;M.zr();return M}function pd(M,oa,Xa,Sb){var xc=yj.call(this)||this;xc.activityName=M;xc.JM=oa;xc.TJ=Xa;xc.$=Sb;xc.fc();return xc}function ne(M,oa,Xa){return $d.call(this,M,oa,Xa)||this}function be(M,oa){M=pf.call(this,M)||this;M.password=null;M.Yif=oa;M.Bh();return M}function td(M,oa,Xa,Sb){var xc=Aj.call(this)||this;xc.activityName=M;xc.JM=oa;xc.TJ=Xa;xc.$=Sb;xc.fc();return xc}function Qe(M,
oa,Xa){return $d.call(this,M,oa,Xa)||this}function Qf(M){var oa=pf.call(this,M)||this;oa.tLd=5;oa.J9d=!1;oa.passwordToModify=null;oa.cHf=function(){oa.$.isEditMode&&oa.Vgc&&(Ra.b().o8c("PasswordToModifyPasswordVerifiedTillInteractive"),oa.$.ol(oa.cHf))};oa.Bh();oa.$.Pk(oa.cHf);return oa}function pf(M){var oa=Zj.call(this,M)||this;oa.Hpa=0;oa.A6i=function(Xa,Sb){oa.oab(Xa,Sb)};return oa}function $d(M,oa,Xa){var Sb=lj.call(this,M,oa)||this;Sb.yi=null;Sb.WCd=null;Sb.GYi=function(xc,jd){Sb.UEb(xc,jd)};
Sb.TJ=Xa;return Sb}function je(M){var oa=mk.call(this)||this;oa.$=M;M.da.Ha(56,new ee(M));oa.fc();return oa}function md(M,oa){return ik.call(this,M,oa)||this}function ee(M){var oa=Ci.call(this)||this;oa.$=M;oa.fc();ee.p1g();return oa}function qf(M,oa,Xa){var Sb=Fc.call(this,!0)||this;Sb.Ma=new Mj.a;Sb.vVe=!1;Sb.j7c=!1;Sb.cAe=null;Sb.wm=null;Sb.K2b=null;Sb.dd=function(){Qj.a.yg($f.a(Sb.$).rd.activityState,gc.a.Ryd)||Sb.raa.reset()};Sb.LKi=function(xc){Sb.uSf(xc)};Sb.KKi=function(){Sb.cBj()};Sb.$=M;
Sb.ea=M.ea;Sb.bK=oa;Sb.businessBar=Xa;Sb.ea.Tj(Sb.dd);Sb.raa=ui.a.Mse(Sb.$);Sb.q1g();M.da.Ha(55,Sb);return Sb}function Fc(M){this.Zfa=this.s5d=this.VUa=null;this.oib=!1;this.KMc=this.zce=null;this.tQb=this.FD=this.JVb="";this.application=this.MB=0;this.wIj=this.nUd=!1;this.uVj=M&&Pd.AFrameworkApplication.ga.ra("OICLaunchDialogIsEnabled");Pd.AFrameworkApplication.Hb.r4(Tf.a.GQa)||Pd.AFrameworkApplication.Hb.hc(Tf.a.GQa,kh.a.frame,Object(uf.a)(this,this.bjj,"retryOpenInClientAction"));this.r5f=!!Pd.AFrameworkApplication.ga&&
Pd.AFrameworkApplication.ga.ra("SilentExternalHandler")}function Ed(){}function Sd(){}function qd(M){var oa=Zh.call(this)||this;oa.mq=M;oa.Ve="ProtocolLaunchingDialog";Pd.AFrameworkApplication.gj.Q4a&&Pd.AFrameworkApplication.gj.Atc();Pd.AFrameworkApplication.sa.Qa.$hd&&oa.Tle(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(uf.a)(oa,oa.Wmc,"onGiveFeedbackClick"));qd.O7e?(oa.kc=12,oa.Gc(1,CommonUIStrings.l_CloseFile),oa.Gc(2,CommonUIStrings.l_OICDialogContinueHere),oa.Gc(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(oa.kc=4,oa.Gc(1,CommonUIStrings.l_OICDialogContinueHere),oa.Gc(2,CommonUIStrings.l_OICDialogLaunchAgain));oa.QBb(CommonUIStrings.l_OICDialog2ndTitle,5===oa.mq.PFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(uf.a)(oa,oa.CFd,"protocolLaunchingDialogResultHandler"),null);return oa}function ke(M){var oa=Vh.call(this)||this;oa.cfa=null;oa.OUa=null;oa.Jpa=!1;oa.opa=null;oa.mq=M;oa.eg=Se.eg;oa.rte=!0;oa.kc=5;oa.Ve="ProtocolLaunchingDialog";oa.SGc=
"OICRetryDialog";Pd.AFrameworkApplication.gj.Q4a&&Pd.AFrameworkApplication.gj.Atc();Pd.AFrameworkApplication.gj.Yg(new dh.a(2,1,5E3,function(){oa.switchToBackupMode()},101));oa.showDialog("",Object(uf.a)(oa,oa.CFd,"protocolLaunchingDialogResultHandler"));oa.F_f();oa.cX("Issues");oa.gVe();ud.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return oa}function Se(){}function of(M){var oa=Bh.call(this)||this;oa.vCa=null;oa.PUa=
null;oa.Jpa=!1;oa.mq=M;oa.eg=vc.eg;oa.rte=!0;oa.kc=5;oa.Ve="OICLaunchDialog";oa.showDialog("",Object(uf.a)(oa,oa.HGi,"oicLaunchDialogResultHandler"));oa.F_f();oa.cX("ProtocolLaunchingDialogTitle");4!==Pd.AFrameworkApplication.sa.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);oa.Gz(oa.vCa);ud.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";
return oa}function vc(){}function id(M,oa,Xa,Sb,xc){var jd=document.createElement("img");jd.alt=M;jd.className=Jg.getImageClassWithCluster(Xa,Sb);jd.src=oa;jd.setAttribute(Yh.a.Ud,Yh.a.Qr);M=document.createElement("span");M.className="ProtocolLaunchingDialogImg32Container";M.appendChild(jd);jd=document.createElement("span");jd.className="ProtocolLaunchingDialogIconContainer";jd.appendChild(M);xc.appendChild(jd)}function Ac(M,oa,Xa,Sb,xc,jd,vd){var ae=document.createElement("a");ae.className="ProtocolLaunchingDialogButtonAnchor";
ae.className+=" OICDialog";ae.id=M;ae.setAttribute(Yh.a.Ud,Yh.a.Pr);ae.style.padding="0";ae.style.margin="0";Sb&&id(xc,oa,Xa,Sb,ae);M=document.createElement("span");M.className="ProtocolLaunchingDialogButtonLabel";M.innerText=xc;ae.appendChild(M);ae.tabIndex=0;jd&&wj.a.instance.qa(kg.a.click,ae,jd);vd&&nf.KeyInputManager.instance.qa(kg.a.Xd,ae,vd);return ae}function Yd(M){return M.Ea.keyCode===mi.a.Zh||M.Ea.keyCode===mi.a.Ioa?(M.Ub.click(),!0):!1}function Cd(M){for(var oa=0;oa<M.children.length;oa++){var Xa=
M.children[oa];Xa.style.position="relative";Xa.style.top=(Xa.parentNode.offsetHeight-Xa.offsetHeight)/2+"px"}}function wf(){}function Vb(M,oa,Xa){var Sb=this;this.La=M;this.nrg=oa;this.OEc=null;(this.VWb=Pd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Uh.a.instance.pc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(xc){Sb.OEc=xc});this.R1=Xa}function wc(M,oa,Xa){this.La=M;this.krg=
oa;this.R1=Xa}function yb(M){var oa=Te.call(this)||this;oa.$=M;oa.fc();return oa}function oc(M){var oa=de.call(this)||this;oa.$=M;oa.fc();return oa}function Wc(M,oa,Xa){Xa=void 0===Xa?!1:Xa;var Sb=dk.call(this,M,oa)||this;Sb.pBb=null;Sb.hBd=function(xc){Sb.unsubscribe(function(jd){xc.remove_disposing(jd)});Sb.vh(zb.a.Ak);Sb.hp()};Sb.fkc=Xa;return Sb}function Qd(M){return tf.call(this,M)||this}function Sc(M,oa){this.Fi=oa;this.$=M}function Yc(M){var oa=fe.call(this)||this;oa.$=M;oa.fc();return oa}
function pc(M){return Hd.call(this,M)||this}function Be(M){this.jo="Excel";this.$=M;this.cV=Dc.a.current}function Ce(M,oa,Xa,Sb,xc,jd,vd){vd=M.Na(9,void 0===vd?null:vd);vd.sheetName=oa;vd.confirmationChoice=!0;return ha.i(M,"DeleteSheet",vd,Xa,Sb,xc,jd,0)}function Xe(){}function ob(M){var oa=ic.call(this)||this;oa.T_d=null;oa.V_d=0;oa.ij=null;oa._state=0;oa.moveNext=function(){try{for(oa._state=1;1===oa._state;)oa.vu=oa.vu()}catch(Xa){oa.dispose(),oa.Oda(Xa),oa._state=3}};oa.Bf=M;oa.vu=oa.TL;oa.moveNext();
return oa}function Ic(){}function Cc(M){return jb.call(this,M)||this}function Uc(M,oa){this.$=M;this.gridView=oa}function Tc(M,oa,Xa){var Sb=za.call(this,M)||this;Sb.Fmb=0;Sb.tyb=!1;Sb.q1a=null;Sb.nIe=!1;Sb.Hqb=!0;Sb.xTc=null;Sb.fo=null;Sb.Axd=0;Sb.Bxd=null;Sb.zxd=null;Sb.removeHyperLink=!1;Sb.cellValue=null;Sb.location=null;Sb.N8h=function(xc,jd){1===xc||2===xc?(ud.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===xc?"OK":"Remove"),Sb.Bxd=jd[Tc.ati],Sb.Axd=jd[Tc.snj],Sb.zxd=jd[Tc.ngh],
2===xc&&(Sb.removeHyperLink=!0),Sb.commit()):ud.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Sb.BWj=function(xc,jd){return 0!==jd&&xc.length?1===jd?Sb.RZe(Cf.y(xc,Sb.ea.xa)||Sb.TCi(xc),747):Sb.RZe(Sf.a.Vnd(xc),749):null};Sb.selectedRange=oa;Sb.mM=Xa;Sb.ea=M.ea;Sb.sheetName=oa.SheetName;Sb.vLa();Sb.lm();Sb.kc=Sb.tyb?9:1;Sb.Gc(1,qe.a.instance.fa(4));Sb.tyb&&Sb.Gc(2,qe.a.instance.fa(750));M={};M=(M[Tc.xfh]=Sb.nIe,M[Tc.ogh]=Sb.q1a,M[Tc.Tzg]=Sb.Fmb,M[Tc.Uzg]=Sb.xTc,M[Tc.N3g]=Sb.Hqb,M);
oa={};M=(oa[Tc.Zy]=Sb.Bc,oa[Tc.CWj]=Sb.BWj,oa[Tc.VOg]=M,oa);Sb.initializeAndShow(Sb.fo,Sb.N8h,M);return Sb}function ce(M){return Bi.call(this,M)||this}function ye(M,oa,Xa,Sb){var xc=Hg.call(this)||this;xc.$=M;xc.businessBar=Sb;xc.openInExcelOperation=oa;xc.bK=Xa;return xc}function Kf(){}function yf(M){var oa=fh.call(this,M)||this;oa.XH=null;oa.XCb=function(){ud.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(oa.$.ya.IsMeetingLiveSession)return oa.Gjg(),!0;Ff.a.Up?(ud.ULS.sendTraceTag(574993312,
306,50,"Android intent scheme is being used to open android app from browser"),oa.dC&&oa.dC.length||ud.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),oa.openUrl("intent:"+oa.dC+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+oa.Rq+";end","_top")):9<=Ff.a.Ekd?(ud.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),oa.openUrl(oa.nOa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Rq,
"_blank")},9E3)):(ud.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),oa.openUrl(oa.nOa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Rq,"_blank")},500));return!0};oa.cma=function(Xa){return Xa.Ea.keyCode===mi.a.Zh||Xa.Ea.keyCode===mi.a.Ioa?(ud.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Xa.Ub.click(),!0):!1};if(1!==Pd.AFrameworkApplication.sa.Qa.Oj)return oa;oa.dC=
oa.$.workbookContext.ClientUrl;oa.nOa="ms-excel:ofe|u|"+oa.dC;oa.Rq=Pd.AFrameworkApplication.ga.Ua("AppUrl");Ff.a.Gka?oa.Rq="itms-apps://"+Pd.AFrameworkApplication.ga.Ua("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Ff.a.Up&&(kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&oa.$.ya.IsMeetingLiveSession?(ud.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),oa.Rq=Pd.AFrameworkApplication.ga.Ua("WildFireMarketUrlExcelAndroid")):
Ff.a.Bgc?oa.Rq=Pd.AFrameworkApplication.ga.Ua("WildFireUrlChinaStoreAndroid"):4<Ff.a.Zpe.zBb&&(oa.Rq=Pd.AFrameworkApplication.ga.Ua("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return oa}function Pf(){}function ec(M){this.calculateType=0;this.calculateType=M}function Qc(M){this.calculationMode=0;this.calculationMode=M}function Dd(M,oa){var Xa=this;this.dialog=null;this.cxf=function(){Xa.dialog&&Xa.dialog.hide()};this.IGi=M;this.Ab=oa;this.Ab.hnb(this.cxf)}
function Jd(M,oa){return ze.call(this,M,void 0,void 0,oa)||this}function ze(M,oa,Xa,Sb,xc,jd){oa=void 0===oa?!0:oa;Xa=void 0===Xa?!1:Xa;Sb=void 0===Sb?null:Sb;xc=void 0===xc?null:xc;jd=void 0===jd?!1:jd;var vd=gd.call(this)||this;vd.YX=null;vd.Tl=null;vd.JVa=null;vd.KVa=null;var ae=vd.EVd?vd.EVd:CommonUIStrings.l_DefaultDialogTitle;ze.Twb=jd;vd.oRb=Sb||new ie(M,!0);vd.oRb.Jse(vd);var Ie=[],Zf=[];ze.vy&&(vd.IVc&&vd.IVc.forEach(function(ij){Array.add(Ie,ij)}),vd.Zoe&&vd.Zoe.forEach(function(ij){Array.add(Zf,
ij)}));oa?Xa?(vd.kc=4,vd.Gc(1,vd.buttonText),vd.Gc(2,CommonUIStrings.l_DialogClose)):(vd.kc=6,vd.Gc(0,CommonUIStrings.l_DialogClose)):vd.kc=5;jd=document.createElement("span");vd.I4c&&(jd.className=vd.I4c);Sb=document.createElement("a");Sb.innerText=vd.mjc;Sb.href=M;Sb.target="_blank";Sb.id=vd.ljc;Sb.className=rc.AFrame.Hpe;var Vg=!Ff.a.LC&&!!xc&&0<xc.count;if(Vg){var Gh=fg.a.egd(M,xc);xc=fg.a.FId(M,xc);Sb.href="#";Sb.target="_self";vd.Tl=document.createElement("form");vd.Tl.id="printPreviewPostForm1";
vd.Tl.method="post";vd.Tl.target="_blank";vd.Tl.action=xc;xc=yl(Gh);for(Gh=xc.next();!Gh.done;Gh=xc.next()){Gh=Gh.value;var pi=document.createElement("input");pi.type="hidden";pi.name=Gh.key;pi.value=Gh.value;vd.Tl.appendChild(pi)}}else vd.Tl=null;vd.Tl||ze.Twb?ze.Twb||(M={},Array.add(Zf,(M.type="AppLinkProps",M.id=vd.ljc,M.text=vd.mjc,M.onExecute=function(){vd.GMf()},M))):(xc={},Gh={},Array.add(Zf,(Gh.type="AppLinkProps",Gh.id=vd.ljc,Gh.text=vd.mjc,Gh.handler=(xc.href=Vg?"#":M,xc.target=Vg?"_self":
"_blank",xc),Gh)));vd.SNa&&Array.add(Ie,vd.SNa);Xa?(M=document.createElement("span"),M.innerText=vd.SNa.replace("{0}",""),jd.appendChild(M)):vd.Kqf?(M=document.createElement("span"),M.id=vd.pi("message"),Vg=document.createElement("span"),xc=document.createElement("span"),Gh=vd.SNa.split("{0}"),Vg.innerText=Gh[0],xc.innerText=Gh[1],M.appendChild(Vg),M.appendChild(Sb),M.appendChild(xc),jd.appendChild(M)):(M=document.createElement("span"),M.innerText=vd.SNa,jd.appendChild(M),jd.appendChild(document.createElement("br")),
jd.appendChild(document.createElement("br")),jd.appendChild(Sb),ze.Twb||Array.add(Ie,"{0}"));vd.Tl&&jd.appendChild(vd.Tl);ze.vy&&(vd.P7a&&(vd.JAb?vd.Rle(vd.P7a,vd.JAb):(Array.add(Ie,"{0}"),M={},Array.add(Zf,(M.type="AppLinkProps",M.id="LearnMoreLinkId",M.text=vd.P7a,M.onExecute=function(){vd.fjc()},M)))),vd.Fra(Ie,Zf));vd.QBb(ae,null,vd.s$e,null,Object(uf.a)(vd,vd.$v,"dialogHandler"),ze.vy?null:jd);vd.cX(vd.pi("message"));!ze.vy&&vd.JAb&&vd.P7a&&(ae=document.createElement("div"),ae.className="WACDialogLearnMoreLinkContainer",
vd.YX=document.createElement("a"),vd.YX.innerText=vd.P7a,vd.YX.href=vd.JAb,vd.YX.target="_blank",vd.YX.id=vd.pi("LearnMoreLinkId"),vd.YX.className=rc.AFrame.Hpe,ae.appendChild(vd.YX),oa?vd.Mb.insertBefore(ae,vd.Mb.lastChild):vd.Mb.appendChild(ae),vd.cX(String.format("{0} {1}",vd.pi("message"),vd.pi("LearnMoreLinkId"))));vd.Khb=Sb;Xa?vd.Gz(vd.GB):vd.Gz(vd.Khb);vd.Amf();Pd.AFrameworkApplication.sa.oX.qa(kg.a.click,vd.Khb,Object(uf.a)(vd,vd.IJe,"downloadLinkClicked"),null);vd.YX&&Pd.AFrameworkApplication.sa.oX.qa(kg.a.click,
vd.YX,Object(uf.a)(vd,vd.fjc,"learnMoreLinkClicked"),null);vd.nRb=!1;return vd}function ie(M,oa){this._url=M;this.vtg=oa}function jf(M){return Bb.call(this,M)||this}function mf(M){this.Fi=M}function vf(M){var oa=ih.call(this)||this;oa.$=M;oa.fc();return oa}function rg(){}function he(){this.tb=null}function eg(M){this.fLa=this.aab=null;this._initialized=!1;this.qkd=M}function tg(){this.tb=null}function Wd(M,oa,Xa,Sb,xc,jd){oa=ig.call(this,oa,Xa,Sb,xc,jd)||this;oa.La=M;return oa}function Mf(M,oa,Xa,
Sb,xc,jd,vd){oa=xd.call(this,oa,Xa,Sb,xc,jd,vd)||this;oa.Nog=M;return oa}function Rd(M,oa,Xa,Sb){M=Vc.call(this,M,oa,Xa,Sb)||this;M.qtg=oa;return M}function Ze(M){var oa=ue.call(this)||this;oa.kc=1;oa.Gc(1,CommonUIStrings.l_RetryButtonLabel);oa.Gc(0,CommonUIStrings.l_DialogClose);oa.La=M;return oa}function Xf(M,oa,Xa){this.La=M;this.HX=oa;this.fmb=Xa}function bg(M,oa,Xa,Sb){var xc=Ng.call(this)||this;xc.J8=null;xc.XRb=null;xc.La=M;xc.HX=oa;xc.fmb=Xa;xc.Gc(1,CommonUIStrings.l_SaveButtonLabel);xc.eg=
mg.eg;xc.Ve="FileNameDialog-SaveACopy";xc.Eh=Sb;return xc}function mg(){}function xf(){this.tb=null}function ig(M,oa,Xa,Sb,xc){this.J8=this.um=this.zCa=null;this.gDa=!1;this.Eh=this.Dga=null;this.sSc=M;this.Mkb=oa;this.Ds=Xa;this.gf=Sb;this.Ah=xc}function wh(M){this.wb=M;this.eFa=M.appSettings.SkyDriveUploadWebServiceBase;this.aA=M.appSettings.FileName;this.Cfa=M.Ua("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function La(M,oa,Xa,Sb,xc,jd,vd){this.dFa=M;this.aA=oa;this.DVa=Xa;this.XRb=Sb;
this.XOc=xc;this.Cfa=jd;this.Eh=vd}function Eb(M,oa,Xa){this.La=M;this.c2=oa;this.HX=Xa}function uc(M,oa,Xa){var Sb=nh.call(this)||this;Sb.La=M;Sb.c2=oa;Sb.HX=Xa;Sb.Cv=!1;Sb.kc=1;Sb.sna(1);Sb.Gc(1,CommonUIStrings.l_SignIn);Sb.Gc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Sb}function Vc(M,oa,Xa,Sb){this.hVb=null;this.Dvg=M;this.wb=Xa;this.Rce=oa;this.sae=new Ph.a;this.Ah=Sb}function xd(M,oa,Xa,Sb,xc,jd){this.Eh=null;this.zwg=M;this.c2=oa;this.fmb=Xa;this.wb=Sb;this.PPb=xc;this.Ds=jd}
function Od(){}function re(){var M=yg.call(this)||this;M.kc=0;M.Gc(1,CommonUIStrings.l_DialogClose);return M}function Zb(){this.qga=this.MTb=this.KTb=this.tb=null}function Nc(M,oa,Xa,Sb,xc){this.um=this.zCa=null;this.wEc=!1;this.YPc=this.J8=null;this.sSc=oa;this.Mkb=Xa;this.Ds=Sb;this.gf=xc;this.La=M}function cd(M){this.eFa=M.appSettings.SaveAsToHostWebServiceBase;this.aA=M.appSettings.FileName;this.Cfa=M.Ua("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function Xd(M,oa,Xa,Sb,xc,jd,vd,
ae){this.dFa=M;this.aA=oa;this.DVa=Sb;this.XOc=jd;this.J8=Xa;this.Gwg=xc;this.Cfa=vd;this.Eh=ae}function Le(M,oa,Xa,Sb){this.Eh=this.Tbe=null;this.YEa=M;this.Ds=oa;this.UNc=Xa;this.gf=Sb}function le(M,oa,Xa,Sb,xc,jd,vd){this.wb=M;this.bIc=Xa;this.La=oa;this.mlb=Sb;this.gib=xc;this.UNc=jd;this.qmg=vd}function zf(){return sf.call(this)||this}function bf(M,oa,Xa,Sb){var xc=this;this.Go=this.kkb=null;this.gib=M;this.gf=Xa;this.Ttg=Sb;this.sDa=new If.a(function(){return new Hh.a(oa.value,Object(uf.a)(xc,
xc.mvb,"getMoreInfoEventReceived"))})}function Lf(M,oa,Xa,Sb,xc,jd,vd,ae,Ie,Zf){this.La=oa;this.wb=M;this.HX=Sb;this.Ega=jd;this.Ds=xc;this.gf=Xa;this.Xfe=vd;this.asg=void 0===ae?null:ae;this.YEa=void 0===Ie?null:Ie;this.vXa=void 0===Zf?null:Zf}function hf(M,oa,Xa,Sb,xc,jd,vd,ae,Ie){this.kMc=null;this.aA="";this.mlb=M;this.Ds=oa;this.Eh=Ie;this.Ega=Xa;this.gf=xc;this.Bv=Sb;this.YEa=vd;this.vXa=ae;jd&&(this.kMc=new If.a(function(){return new Hh.a(jd.value,null)}))}function pg(){this.properties=this.friendlyPath=
this.folderName=null}function df(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function Uf(M,oa,Xa,Sb,xc,jd,vd,ae){M=Fb.call(this,M,oa,Xa,Sb,xc,jd,ae)||this;M.Fy=null;M.bQc=null;M.cqa=null;M.NSg=CommonUIStrings.l_SaveToAnotherFolder;M.eg=Re.eg;M.Ve="FileNameDialog-SaveToSharePoint";M.mlb=vd;M.xtg=ae;return M}function Re(){}function Je(){var M=ii.call(this)||this;M.kc=0;M.Gc(1,CommonUIStrings.l_DialogClose);return M}function qg(){this.tb=null}
function Xg(M,oa,Xa,Sb,xc,jd,vd,ae){this.um=null;this.OWa=this.gDa=!1;this.Dga=this.Eh=this.aA=null;this.wb=oa;this.dFa=this.wb.appSettings.SaveAsToHostWebServiceBase;this.N8d=Sb;this.Mkb=xc;this.Sg=Xa;this.Ds=jd;this.Ah=ae;this.gf=vd;this.La=M;this.Cfa=oa.Ua("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function Lh(M,oa,Xa){this.Ega=Xa;this.bIc=oa;this.wb=M}function cg(M,oa,Xa,Sb,xc,jd){this.La=oa;this.wb=M;this.HX=Sb;this.Ega=jd;this.Ds=xc;this.gf=Xa}function Lg(M,oa,Xa,Sb,xc,jd){M=Fb.call(this,
M,oa,Xa,Sb,xc,jd)||this;M.eg=Da.eg;M.Ve="FileNameDialog-SaveAsToHost";return M}function Da(){}function Fb(M,oa,Xa,Sb,xc,jd,vd){vd=void 0===vd?null:vd;var ae=Cg.call(this)||this;ae.gJ=null;ae.La=oa;ae.HX=Sb;ae.Ega=jd;ae.wb=M;ae.Ds=xc;ae.gf=Xa;ae.aib=ae.wb.ra("SaveToHostWithExtraCharsInFileName");ae.Eh=vd;ae.Gc(1,CommonUIStrings.l_SaveButtonLabel);return ae}function Oc(M,oa){this.wb=M;this.La=oa;this.aib=this.wb.ra("SaveToHostWithExtraCharsInFileName")}function kd(M,oa){var Xa=wg.call(this)||this;Xa.OWa=
!1;Xa.aA=null;Xa.La=M;Xa.aib=oa;Xa.dSa=!1;return Xa}function Ld(){this.tb=null}function De(M){this.Ul=null;this.Sg=M;this.yPc=3}function Ge(M,oa,Xa,Sb){oa=Ka.call(this,M,oa,Xa,Sb)||this;oa.options.advanced.filter=M.Ua("OneDriveApiV72Filter")||"folder,photo";oa.options.advanced.linkType="download";oa.options.multiSelect=Pd.AFrameworkApplication.Aqe;M.ra("OneDriveApiV72CommandModeEnabled")&&(oa.options.commandMode=M.Ua("OneDriveApiV72CommandMode")||"none");M.ra("OneDriveApiV72QosExtraDataEnabled")&&
(oa.options.qosExtradata=new lf(Pd.AFrameworkApplication.userSessionId));return oa}function lf(M){this.olsSessionId=this.value=this.key=null;this.olsSessionId=M}function Ka(M,oa,Xa,Sb){oa=Bc.call(this,M,oa,Xa,Sb)||this;oa.glg=M;oa.options={};oa.options.advanced={};oa.options.action="query";oa.options.clientId=oa.ga.Ua("OneDriveApiV72ClientId");oa.options.advanced.trapFocus=!0;return oa}function bb(M,oa,Xa,Sb,xc){M=Bc.call(this,M,oa,Xa,Sb)||this;M.Qce=null;M.kSb=null;M.nog=xc;M.options={};M.options.clientId=
M.ga.Ua("OneDriveApiV7ClientId");M.options.cancel=Object(uf.a)(M,M.Tzc,"toggleHostDivVisibility");return M}function ac(M,oa,Xa,Sb,xc,jd){oa=Bc.call(this,oa,Xa,Sb,jd)||this;oa.Eh=null;oa.c2=M;oa.twg=xc;return oa}function Bc(M,oa,Xa,Sb){this.kEa=this.p6=null;this.tQc=this.vQc=!1;this.NWa=null;this.wb=M;this.PPb=oa;this.RDa=Xa;this.Ds=Sb}function Lc(){}function Cb(){var M=di.call(this)||this;M.kc=0;M.Gc(1,CommonUIStrings.l_DialogClose);return M}function nc(){}function Td(M,oa,Xa,Sb){this.fib=M;this.Fqa=
oa;this.W1=Xa;this.Apg=Sb}function Me(M,oa,Xa,Sb,xc,jd,vd){var ae=this;this.Go=null;this.jge=!1;this.Wpa=this.F2d=0;this.Wsg=M;this.LWa=oa;this.OTb=Xa;this.fib=Sb;this.Fqa=xc;this.W1=jd;this.sDa=new If.a(function(){return new Hh.a(vd.value,Object(uf.a)(ae,ae.mvb,"getMoreInfoEventReceived"))})}function ge(M,oa,Xa,Sb,xc,jd,vd,ae){var Ie=this;this.BFc=null;this.KSc=!0;this.fQb="";this.Wxg=0;this.uWa=null;this.VLc=3;this.wb=ae;this.W1=M;this.kj=oa;this.Oog=Xa;this.Ulg=Sb;this.Tlg=xc;this.sDa=new If.a(function(){return new Hh.a(jd.value,
null)});this.Bpg=new If.a(function(){return new Hh.a(vd.value,Object(uf.a)(Ie,Ie.zCi,"mruEventResultReceived"))});this.wb.ra("WacInTabOpenMRUIsEnabledForUiHost");this.wb.ra("UiHostSupportsDocRebootFeatures")}function Ef(){return Mh.call(this)||this}function He(M,oa,Xa,Sb,xc,jd){var vd=this;this.MRc=this.Go=this.gQb=null;this.aWb=this.RQc=!1;this.hbe=0;this.FQc=this.bLc=!1;this.W1=M;this.fib=oa;this.sDa=new If.a(function(){return new Hh.a(Xa.value,Object(uf.a)(vd,vd.mvb,"getMoreInfoEventReceived"))});
this.Nsg=Sb;this.Fqa=xc;this.kwg=jd;this.wlb=this.bxc;2===this.RK.bca&&(this.FQc=!0)}function Of(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function Md(){}function cf(){}b.r(F);var Gd=b(516),pe=b(0),jg=b(273);cf.prototype.ii=function(){};cf.prototype.init=function(){};cf.prototype.dispose=function(){};cf.main=function(){jg.a.instance.rj(new cf)};Qk.Object.defineProperties(cf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});
Object(pe.a)(cf,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var If=b(685),ud=b(13),uf=b(80),Hh=b(940),Sf=b(29),Zg=b(125);Md.$kh=function(M){return Md.lve("New",M)};Md.alh=function(M){return Md.lve("Open",M)};Md.Vue=function(M,oa){return Md.xha("LoadingMenuSection",Md.$ti,M,Md.Xob("lblLoading",oa))};Md.Yob=function(M,oa,Xa,Sb){return Md.xha("MessageMenuSection",Md.xrf,oa,Md.Xob("lblMessage",M,void 0===Xa?null:Xa,void 0===Sb?null:Sb))};Md.hRg=function(M){return Md.Vue(M,CommonUIStrings.l_VoicedLoadingText)};
Md.iRg=function(M,oa){return Md.Yob(CommonUIStrings.l_NewCreationLocationMessage,M.Di,oa.YR,oa.Yna)};Md.gRg=function(M,oa){return Md.Yob(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,oa.Yna,"\n\n"),M.Di)};Md.Xue=function(M){return Md.Yob(CommonUIStrings.l_NewGenericErrorMessage,M.Di)};Md.eRg=function(M,oa,Xa){return Md.xha("menuNewBlank",Md.b7h,Xa?M.Di:null,Md.Sob(M.I8e,M.J8e,M.K8e,null,M.hka,M.jxb,oa,"blank"))};Md.fSg=function(){return Md.Xob("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};
Md.gve=function(){return Md.Xob("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};Md.gSg=function(M,oa){return Md.xha("menuNewTemplates",M,null,oa)};Md.cRg=function(M,oa){return Md.xha("menuNewMoreTemplates",Md.tVe,null,Md.Sob("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,M,oa))};Md.gQg=function(M,oa,Xa){var Sb="";Xa&&oa&&(Sb=Md.xha("BrowseMoreMenuSection",Md.tVe,null,Md.Sob("btnBrowseMore",oa,oa,null,null,null,M||"1959943459",
Xa)));return Sb};Md.Xob=function(M,oa,Xa,Sb){Xa=void 0===Xa?null:Xa;var xc=Sb=void 0===Sb?null:Sb;oa&&0<oa.length&&(xc=Md.qsf.upc(oa).trimEnd(),xc=0<=xc.indexOf("{0}")?String.format(xc,Sb):String.format("{0} {1}",xc,Sb));Xa=Xa&&Sb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Sf.a.xf(Xa),Sf.a.xf(Sb),Sf.a.xf(xc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Sf.a.xf(M||
""),Md.qsf.upc(Sf.a.xf(oa||"")),Xa)};Md.Sob=function(M,oa,Xa,Sb,xc,jd,vd,ae){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Sf.a.xf(M||""),Sf.a.xf(oa||""),Sf.a.xf(Xa||""),Sb||"32by32",Sf.a.xf(xc||""),Sf.a.xf(jd||""),vd,Sf.a.xf(ae||""))};Md.lve=function(M,oa){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
M,oa)};Md.xha=function(M,oa,Xa,Sb){Xa=Xa?String.format('Title="{0}"',Sf.a.xf(Xa)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',Sf.a.xf(M||""),Sf.a.xf(oa||""),Xa,Sb)};Md.xrf="MenuMru";Md.$ti="MenuLoading";Md.b7h="MenuHeader";Md.tVe="MenuFooter";Md.qsf=Zg.a.xx("\n","&#10;");Object(pe.a)(Md,"NewAndOpenXmlUtilities",
null,[]);var Pd=b(5),jh=b(95),ci=b(168);Object(pe.a)(Of,"HostInformation",null,[]);var dh=b(108),xe=b(47),Ag=b(373),Jf=b(170),Oe=b(689),$h=b(596),kh=b(104),Tf=b(30);He.prototype.Pg=function(){var M=this.RK.M8a;M.hc(Tf.a.newDocument,kh.a.frame,Object(uf.a)(this,this.newDocument,"newDocument"));M.ff(Tf.a.Mpc,kh.a.frame,Object(uf.a)(this,this.Mpc,"populateNewMenu"),96)};He.prototype.newDocument=function(M,oa,Xa,Sb,xc){return 1===Xa?32:2===Xa&&xc&&xc.MenuItemId&&xc.SourceControlId?this.x0a(xc.MenuItemId,
xc.SourceControlId):8};He.prototype.x0a=function(M,oa){var Xa=this.Clc.c4c;if(null===Xa)return 8;var Sb=Pd.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(Pd.AFrameworkApplication.Xka&&Sb){ud.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");var xc={};xc[Ag.a.Vdb]=M;xc[Ag.a.OP]=this.OP;xc[Ag.a.lcid]=Pd.AFrameworkApplication.lcid.toString();xc[Ag.a.reason]=Oe.a.createNew;Pd.AFrameworkApplication.rV().execute(function(jd){jd.Rj(Jf.a.x0a,
xc)})}else Sb=(new Date).getTime(),oa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Xa,Sf.a.pf(this.Ila),Sf.a.pf(M),Sf.a.pf(this.OP),Sf.a.pf(Pd.AFrameworkApplication.lcid.toString()),Sf.a.pf(Sb.toString()),Sf.a.pf(oa),Sf.a.pf(Pd.AFrameworkApplication.canary),Pd.AFrameworkApplication.lj),(Xa=Pd.AFrameworkApplication.ga.Ua("ScenarioId"))&&""!==Xa&&(oa+="&wdscenarioid="+Sf.a.pf(Xa)),oa+="&"+Pd.AFrameworkApplication.Mbc(),
Pd.AFrameworkApplication.Mwa&&(oa+="&"+Pd.AFrameworkApplication.fbc()),(Xa=this.Go?this.Go.YR:null)&&(oa+="&DestinationUrl="+Sf.a.pf(Xa)),xe.a.vf(oa,"_blank",void 0,"CreateNewDocument");2===this.RK.bca&&(oa={},ud.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(oa.AppType=$h.a[this.RK.bca],oa.Template=M,oa)));return 32};He.prototype.cxi=function(M){var oa=Number.MAX_VALUE,Xa=Number.MIN_VALUE,Sb=window.performance;if(Sb&&"undefined"!==typeof Sb.getEntriesByName){for(var xc=0;xc<
M.length;xc++){var jd=Sb.getEntriesByName(M[xc]);jd&&0<jd.length&&(jd=jd[0],oa=Math.min(parseInt(String(jd.fetchStart)),oa),Xa=Math.max(parseInt(String(jd.responseEnd)),Xa))}Xa>oa&&(M={},ud.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(M.TotalElapsedMs=Xa-oa,M.MinFetchStart=oa,M.MaxResponseEnd=Xa,M)))}};He.prototype.Mpc=function(M,oa,Xa,Sb,xc){if(1===Xa)return this.FQc&&(Pd.AFrameworkApplication.AK("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.FQc=!1),32;2!==Xa||this.bLc||(this.hbe=(new Date).getTime(),M={},ud.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(M.ShouldShowTemplates=this.bxc,M.CachedNewMenuXmlExists=!!this.gQb,M.ShouldCallGetMoreInfo=this.RK.supportsGetMoreInfoForPersonalStorage,M)));return this.G_i(xc)};He.prototype.G_i=function(M){M&&(this.gQb?M.PopulationXML=this.gQb:(this.RK.supportsGetMoreInfoForPersonalStorage&&!this.Go&&this.TDi.gz("Opened New menu",!0),M.PopulationXML=this.eJh(this.getTemplateListJson())));
return 32};He.prototype.Xgf=function(){return!this.RK.supportsGetMoreInfoForPersonalStorage||!!this.Go&&3===this.Go.state&&!!this.Go.Yna&&!!this.Go.YR};He.prototype.nmi=function(){return Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.c_?!0:this.Xgf()};He.prototype.getTemplateListJson=function(){var M=this;if(!this.bxc||!this.nmi())return null;if(this.wlb&&!this.aWb){var oa="9",Xa=Pd.AFrameworkApplication.ga.appSettings;"NumberOfTemplatesInBackstage"in Xa&&(oa=Xa.NumberOfTemplatesInBackstage);
var Sb=this.OP;"TemplateCollectionId"in Xa&&(Sb=Xa.TemplateCollectionId);oa=String.format(this.RK.fW+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Sf.a.pf(Pd.AFrameworkApplication.lcid.toString()),Sf.a.pf(Sb),oa);Boolean.parse(Xa.AppendOriginQueryParam||"false")&&(oa+="&org=backstage");oa+="&"+Pd.AFrameworkApplication.Mbc();Pd.AFrameworkApplication.Mwa&&(oa+="&"+Pd.AFrameworkApplication.fbc());this.RK.kCb.Wl(oa,1,null,null,!1,2,function(xc){M.RK.zNa("CreateNewActor.GetTemplateListJson",xc.data);
M.RJj(xc.data.je)},function(xc){M.RK.zNa("CreateNewActor.GetTemplateListJson",xc.data);M.QJj()},null,void 0,void 0,void 0,void 0,"5");this.wlb=!1}return this.MRc};He.prototype.RJj=function(M){this.MRc=M;this.wlb=!1;this.tGb();if(Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.c_&&ci.c()){M=Pd.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");var oa=Pd.AFrameworkApplication.Xka;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.MRc,!0,
M&&oa))}};He.prototype.QJj=function(){this.aWb=this.wlb=!0;this.tGb();Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.c_&&ci.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));jh.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};He.prototype.P_h=function(M){for(var oa=0,Xa=0;Xa<M.length;Xa++)if("ST"===M[Xa].ImageType){oa=Xa;break}var Sb=M.length?M[oa]:null;M=Sb?Sb.Url||"":"";var xc,jd=Xa=oa=!1;if(Sb&&
(xc=Sb.AspectRatio))xc=parseFloat(xc),1>xc?oa=!0:1.5<xc?Xa=!0:1===xc&&(jd=!0);else switch(xc={},ud.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(xc.Url=M,xc)),this.RK.bca){case 3:oa=!0;break;case 2:Xa=!0;break;case 5:jd=!0}return{returnValue:M,C9h:oa?"95by123":Xa?"123by69":jd?"100by100":"123by95"}};He.prototype.eJh=function(M){var oa=this.fRg(M,this.Clc,this.Clc.uGa||"1056925771");M=oa.returnValue;if(oa.Ewc){this.gQb=M;oa=(new Date).getTime()-this.hbe;var Xa={};ud.ULS.sendTraceTag(5849604,
202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Xa.ElapsedMsSinceMenuOpened=oa,Xa))}return M};He.prototype.mvb=function(M,oa){ud.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Go||3!==M.state?2===M.state&&(ud.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.RQc=!0,this.tGb()):(this.Go=M,oa||this.tGb(),Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.c_&&ci.c()&&ci.d("setFileMenuHostInformation")&&(M=Object.assign(new Of,
{hostUrl:this.Go.YR,hostName:this.Go.Yna,folderUrl:Pd.AFrameworkApplication.breadcrumbFolderUrl,folderName:Pd.AFrameworkApplication.breadcrumbFolderName}),ud.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(M))))};He.prototype.fRg=function(M,oa,Xa){var Sb=!1;var xc=this.Xgf(),jd="";if(this.RK.supportsGetMoreInfoForPersonalStorage)if(this.RQc)jd=Md.Xue(oa),this.RQc=!1,ud.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");
else if(this.Go)if(xc)jd=Md.iRg(oa,this.Go);else if(this.Go.Idi)Sb=!0,this.wlb=!1,jd=Md.gRg(oa,this.Go),ud.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Sb=!0;jd=Md.Xue(oa);var vd={};ud.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(vd.PersonalFileStorageUrlIsSet=!!this.Go.YR,vd.StorageServiceDisplayNameIsSet=!!this.Go.Yna,vd))}else jd=Md.hRg(oa.Di),ud.ULS.sendTraceTag(5849606,
202,50,"Rendering File>New with loading spinner");xc&&(xc=jd,oa=Md.eRg(oa,Xa,!jd),M=this.eSg(M,Xa),Sb=M.Ewc,jd=xc+(oa+M.returnValue));return{returnValue:Md.$kh(jd),Ewc:Sb}};He.prototype.eSg=function(M,oa){var Xa=!1;if(!this.bxc)return Xa=!0,ud.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Ewc:Xa};var Sb="",xc="",jd="MenuTemplate";if(this.aWb)Sb=Md.gve(),this.aWb=!1,ud.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");
else if(M){try{var vd=Sys.Serialization.JavaScriptSerializer.deserialize(M,!0);Sb=this.dSg(vd,oa);ud.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");Pd.AFrameworkApplication.rsf&&"OneDrive"===this.Ila&&(xc=Md.cRg(this.UDi,Pd.AFrameworkApplication.rsf))}catch(ae){oa={},ud.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",(oa.JsonToConvert=M,oa)),Sb=Md.gve()}Xa=!0}else jd="MenuLoading",Sb=Md.fSg(),ud.ULS.sendTraceTag(5849611,202,50,
"Rendering File>New with template loading spinner");return{returnValue:Md.gSg(jd,Sb)+xc,Ewc:Xa}};He.prototype.dSg=function(M,oa){for(var Xa=this,Sb="",xc=[],jd=0;jd<M.length;jd++){var vd=M[jd],ae="";if(vd){var Ie=vd.Title,Zf=vd.AssetId,Vg=vd.Thumbnails;Zf&&Ie&&Vg&&(vd=void 0,ae=this.P_h(Vg),vd=ae.C9h,ae=ae.returnValue,Sb+=Md.Sob("jbtnNewTemplate"+jd,Ie,null,vd,null,ae,oa,Zf))}xc[jd]=ae}M=new dh.a(4,1,5E3,function(){Xa.cxi(xc)},106);this.RK.Alc.Yg(M);return Sb};He.prototype.tGb=function(){this.bLc=
!0;this.RK.jsf.Ow(this.Clc.Htb);this.bLc=!1};Qk.Object.defineProperties(He.prototype,{OP:{configurable:!0,enumerable:!0,get:function(){switch(this.RK.bca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},RK:{configurable:!0,enumerable:!0,get:function(){return this.W1.value}},Clc:{configurable:!0,enumerable:!0,get:function(){return this.fib.value}},TDi:{configurable:!0,enumerable:!0,get:function(){return this.sDa.value}},UDi:{configurable:!0,
enumerable:!0,get:function(){return this.Nsg.value}},Ila:{configurable:!0,enumerable:!0,get:function(){return this.Fqa.value}},bxc:{configurable:!0,enumerable:!0,get:function(){return this.kwg.value}}});Object(pe.a)(He,"CreateNewActor",null,[]);var ki=b(1316),Mh=ki.a;vm(Ef,Mh);Ef.prototype.Lme=function(){this.OT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.OT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.OT(2,CommonUIStrings.l_Open);this.OT(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.OT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.OT(5,CommonUIStrings.l_VoicedLoadingText)};Ef.vWi=function(M){return Ef.instance.fa(M)};Qk.Object.defineProperties(Ef,{instance:{configurable:!0,enumerable:!0,get:function(){return Ef.Oa||(Ef.Oa=new Ef)}}});Ef.Oa=null;Object(pe.a)(Ef,"MruActorIntlHelper",ki.a,[]);var Nh;(function(M){M[M.success=0]="success";M[M.failure=1]="failure";M[M.spinner=2]="spinner";M[M.none=3]="none"})(Nh||(Nh={}));Object(pe.b)("DisplayState",Nh);var ph=b(40);ge.prototype.zCi=
function(M,oa){this.uWa=M;oa||this.nOf()};ge.prototype.l$i=function(){this.mB.M8a.ff(Tf.a.Lpc,kh.a.frame,Object(uf.a)(this,this.Lpc,"populateMruMenu"),96)};ge.prototype.Lpc=function(M,oa,Xa,Sb,xc){return 1!==Xa&&xc?this.D_i(xc):32};ge.prototype.D_i=function(M){this.Flh();this.Elh();M.PopulationXML=Md.alh(this.fQb+this.BFc);return 32};ge.prototype.Flh=function(){var M=3,oa=!1;if(this.fQb&&this.Wxg===this.uWa.xLj)M={},ud.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",
(M.CacheRefresh="Not Dirty",M)),M=this.VLc;else{var Xa={};ud.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Xa.CacheRefresh="Starting",Xa));Xa=this.mB.ew();this.uWa=this.yCi.gz("File Open opened",!0);if(this.fQb&&2!==this.VLc&&3!==this.uWa.state)oa=!0;else{M=this.KYh(this.uWa);Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.c_&&ci.c()&&M&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(M,!0));var Sb=this.fJh(this.uWa);M=Sb.LDi;this.fQb=
Sb.returnValue}Xa=this.mB.ew()-Xa;Sb={};ud.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Sb.CacheRefresh="Complete",Sb.ElapsedMs=Xa,Sb))}2!==M&&(Xa={},Xa=(Xa.DisplayState=Nh[M],Xa),1!==M&&(Xa.IsStale=oa),ud.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Xa));this.VLc=M};ge.prototype.KYh=function(M){try{var oa=ph.c(M.Owd)}catch(Xa){oa=null,ud.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Xa)}return oa};ge.prototype.Elh=function(){if(this.KSc){ud.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var M=this.wyi();this.KSc=M.cYj;this.BFc=M.returnValue}else ud.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");M={};ud.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(M.WaitingOnLinkInfo=this.KSc,M.NotDisplayingLink=!this.BFc,M))};ge.prototype.fJh=function(M){if(1===M.state||0===M.state){M={};ud.ULS.sendTraceTag(5849635,
202,50,"Open menu XML built {0}",(M.Display="Spinner",M));M=2;var oa=Md.Vue(this.Qja(2),this.Qja(5))}else 3===M.state&&M.Owd?(oa=this.dRg(M.Owd),M=0):(M={},ud.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(M.Display="Server Error",M)),oa=Md.Yob(this.Qja(1),this.Qja(2)),M=1);return{returnValue:oa,LDi:M}};ge.prototype.dRg=function(M){var oa=this.LBb.uGa||"2155708348";if(M.length){var Xa=Md.Xob("lblRecentDocuments",this.Qja(3));for(var Sb=0,xc=0;xc<M.length;xc++){var jd=M[xc];"FileName"in
jd&&"DocumentUrl"in jd&&"Path"in jd&&(Xa+=Md.Sob("MruButton"+xc,jd.FileName.toString(),jd.Path.toString(),null,this.LBb.hka,this.LBb.jxb,oa,jd.DocumentUrl.toString()),jd.IsPinned&&Sb++)}Xa=Md.xha("RecentDocumentsMenuSection",Md.xrf,this.Qja(2),Xa);oa={};ud.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(oa.Display="MRU List",oa.TotalDocuments=M.length,oa.NumPinnedDocuments=Sb,oa))}else Xa=Md.Yob(this.Qja(0),this.Qja(2)),M={},ud.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
(M.Display="Empty MRU",M));return Xa};ge.prototype.wyi=function(){var M=!0;var oa=this.zPg,Xa=this.yPg;if(oa&&Xa||!this.mB.supportsGetMoreInfoForPersonalStorage)M=!1;else{var Sb=this.obc.gz("File Open",!1);3===Sb.state&&(oa=Sb.YR,Xa=Sb.Yna,M=!1)}Xa=Xa?String.format(this.Qja(4),Xa):null;return{returnValue:Md.gQg(this.LBb.uGa,Xa,oa),cYj:M}};ge.prototype.nOf=function(){this.mB.jsf.Ow(this.LBb.Htb)};Qk.Object.defineProperties(ge.prototype,{mB:{configurable:!0,enumerable:!0,get:function(){return this.W1.value}},
Qja:{configurable:!0,enumerable:!0,get:function(){return this.kj.value}},LBb:{configurable:!0,enumerable:!0,get:function(){return this.Oog.value}},zPg:{configurable:!0,enumerable:!0,get:function(){return this.Ulg.value}},yPg:{configurable:!0,enumerable:!0,get:function(){return this.Tlg.value}},obc:{configurable:!0,enumerable:!0,get:function(){return this.sDa.value}},yCi:{configurable:!0,enumerable:!0,get:function(){return this.Bpg.value}}});Object(pe.a)(ge,"MruRenderer",null,[]);var gh=b(231),eh=
b(895);Me.prototype.x0a=function(){!this.Go&&this.xxd.supportsGetMoreInfoForPersonalStorage?this.obc.gz("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};Me.prototype.mvb=function(M){if(!this.Go&&3===M.state)this.Go=M;else if(2===M.state){this.jge?ud.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.obc.gz("NewDocumentFromStream",!0),this.jge=!0);return}this.createNewDocumentFromStream()};Me.prototype.createNewDocumentFromStream=function(){this.F2d=
(new Date).getTime();var M=this.sBh.c4c;if(null===M)this.LWa(null);else{var oa=this.OTb.menuItemId,Xa=this.OTb.AI,Sb=this.OTb.zHj,xc=this.OTb.xBh;this.Wpa="streamBase64"===Sb?xc.length/1024:0;ud.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.OP,this.Wpa);var jd=(new Date).getTime();M=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",M,Sf.a.pf(this.Ila),Sf.a.pf(oa),Sf.a.pf(this.OP),Sf.a.pf(Pd.AFrameworkApplication.lcid.toString()),
Sf.a.pf(jd.toString()),Sf.a.pf(Xa),Sf.a.pf(Pd.AFrameworkApplication.canary),Pd.AFrameworkApplication.lj,Sf.a.pf(Sb));M+="&"+Pd.AFrameworkApplication.Mbc();Pd.AFrameworkApplication.Mwa&&(M+="&"+Pd.AFrameworkApplication.fbc());(oa=this.Go?this.Go.YR:null)&&(M+="&DestinationUrl="+Sf.a.pf(oa));this.xxd.kCb.Wl(M,2,xc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(uf.a)(this,this.ODi,"newDocumentFromStreamSuccessHandler"),Object(uf.a)(this,this.NDi,"newDocumentFromStreamFailureHandler"),
null,void 0,void 0,void 0,void 0,"31")}};Me.prototype.ODi=function(M){if(M&&M.data&&M.data.je){var oa=ph.d(M.data.je);var Xa=oa.Iu;oa.returnValue?Xa.StatusCode!==gh.a.fP&&Xa.StatusCode!==gh.a.jrb?(ud.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.OP,this.Wpa,Xa.StatusCode),this.LWa(null)):Xa.NewDocumentUrl&&""!==Xa.NewDocumentUrl?(M=(new Date).getTime()-this.F2d,ud.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.OP,this.Wpa,M),this.Wsg(Xa.NewDocumentUrl)):(ud.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.OP,this.Wpa),this.LWa(null)):(Xa={},ud.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.OP,this.Wpa,(Xa.ResponseData=eh.a.zeb(M.data.je),Xa)),this.LWa(null))}else ud.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.OP,this.Wpa),this.LWa(null)};Me.prototype.NDi=function(M){M&&M.data&&ud.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.OP,this.Wpa,M.data.status);this.LWa(null)};Qk.Object.defineProperties(Me.prototype,{OP:{configurable:!0,enumerable:!0,get:function(){switch(this.xxd.bca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},sBh:{configurable:!0,enumerable:!0,
get:function(){return this.fib.value}},Ila:{configurable:!0,enumerable:!0,get:function(){return this.Fqa.value}},xxd:{configurable:!0,enumerable:!0,get:function(){return this.W1.value}},obc:{configurable:!0,enumerable:!0,get:function(){return this.sDa.value}}});Object(pe.a)(Me,"NewDocumentFromStreamOperation",null,[]);Td.prototype.create=function(M,oa,Xa){return new Me(M,oa,Xa,this.fib,this.Fqa,this.W1,this.Apg)};Object(pe.a)(Td,"NewDocumentFromStreamOperationFactory",null,[448]);var Uh=b(87),xh=
b(525),Wg=b(52);nc.prototype.ii=function(M){M.register(Td,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Cc().Mc(function(){return new Td(new If.a(function(){return Pd.AFrameworkApplication.sa.Qa.xed()}),new If.a(function(){return Pd.AFrameworkApplication.Ila}),new If.a(function(){return M.Nh("Common.INewAndOpenCommonHelpers")}),new If.a(function(){return M.Nh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
nc.prototype.init=function(){var M=this;Pd.AFrameworkApplication.ga.Tu(function(){M.zxb()})};nc.prototype.zxb=function(){var M=xh.a.Sq(Uh.a.instance.pc("Common.INewAndOpenCommonHelpers")),oa=xh.a.Sq(Uh.a.instance.pc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Pd.AFrameworkApplication.Ila&&Wg.Task.WAA.call(null,M,oa).continueWith(function(){var Sb=new He(new If.a(function(){return M.result}),new If.a(function(){return Pd.AFrameworkApplication.sa.Qa.xed()}),new If.a(function(){return oa.result}),
new If.a(function(){return Pd.AFrameworkApplication.sa.Qa.yed().uGa||"1959943459"}),new If.a(function(){return Pd.AFrameworkApplication.Ila}),new If.a(function(){return Pd.AFrameworkApplication.Yki}));Sb.Pg();Sb.tGb()});if(Pd.AFrameworkApplication.aNf){var Xa=xh.a.Sq(Uh.a.instance.pc("Common.IEventEmitter<Common.IMruResult>"));Wg.Task.WAA.call(null,M,oa,Xa).continueWith(function(){var Sb=new ge(new If.a(function(){return M.result}),new If.a(function(){return Ef.vWi}),new If.a(function(){return Pd.AFrameworkApplication.sa.Qa.yed()}),
new If.a(function(){return Pd.AFrameworkApplication.uWi}),new If.a(function(){return Pd.AFrameworkApplication.tWi}),new If.a(function(){return oa.result}),new If.a(function(){return Xa.result}),Pd.AFrameworkApplication.ga);Sb.l$i();Sb.nOf()})}};nc.prototype.dispose=function(){};Qk.Object.defineProperties(nc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(pe.a)(nc,"UXPackageManager",null,[4,5,2]);var Og=b(128),di=Og.StandardDialog;vm(Cb,di);
Cb.prototype.displayError=function(M){this.Iz(M,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};Cb.prototype.R6c=function(M){this.Iz(M,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(pe.a)(Cb,"ErrorDialog",Og.StandardDialog,[553]);var Ph=b(139);Lc.prototype.AXe=function(){ud.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var M=new Ph.a;M.setResult("api.onedrive.com");return M.task};Object(pe.a)(Lc,"OneDriveConsumerEndpointHelper",
null,[538]);var Fg=b(49),ei=b(375),Dh=b(219);Bc.prototype.T3a=function(){this.NWa||(this.NWa=this.Y9a?Dh.a.create(this.Y9a,null,null,null,!1):null);return this.NWa};Bc.prototype.setup=function(M){var oa=this;this.kEa=M;this.vQc||this.tQc?this.vQc&&this.kEa&&this.kEa(!0):(M=this.T3a())?(this.tQc=!0,M.V7a.continueWith(function(Xa){oa.CQi(Xa)}),ei.a.Fia(M)):(ud.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.kEa(!1))};Bc.prototype.EAd=
function(M){ud.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",M.exception?M.exception.toString():"No error detail.")};Bc.prototype.CQi=function(M){this.tQc=!1;if(M.kg)this.EAd(M),this.kEa(!1);else try{this.vQc=!0,ud.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Jld(),ud.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.kEa(!0)}catch(oa){ud.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",oa.toString()),this.kEa(!1)}};
Bc.prototype.startPicker=function(M){this.p6=M;this.RDa?ud.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(ud.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(uf.a)(this,this.czd,"onApiReady")))};Bc.prototype.czd=function(M){M?this.cjc():this.ui()};Bc.prototype.ui=function(){this.Ds().displayError(Fg.a.UVi)};Bc.prototype.onSuccess=function(M){ud.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.p6&&this.p6(!0,M)};Bc.prototype.dispose=function(){this.NWa&&this.NWa.dispose()};Qk.Object.defineProperties(Bc.prototype,{sqe:{configurable:!0,enumerable:!0,get:function(){return this.PPb}},ga:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(pe.a)(Bc,"AOneDriveFilePickerApiManager",null,[64,2]);vm(ac,Bc);ac.prototype.start=function(M,oa){this.Eh=M;this.startPicker(oa)};ac.prototype.Jld=function(){var M={},oa={};M=1===this.sqe||2===this.sqe?(M.client_id=this.ga.appSettings.UploadToSkyDriveClientId,
M):(oa.client_id=this.ga.appSettings.UploadToSkyDriveClientId,oa.env="INT",oa);WL.init(M)};ac.prototype.startPicker=function(M){this.p6=M;!this.RDa&&this.c2.MLa?(ud.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(uf.a)(this,this.czd,"onApiReady"))):(ud.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.twg())};ac.prototype.cjc=function(){try{ud.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Eh).then(Object(uf.a)(this,
this.onSuccess,"onSuccess"),Object(uf.a)(this,this.o6,"onFailure"))}catch(M){ud.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",M,M.stack),this.ui()}};ac.prototype.o6=function(M){if(M&&M.error){if("user_canceled"===M.error.code){ud.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}ud.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",M.error.code,M.error.message)}else ud.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.p6&&this.p6(!1,M);this.ui()};Qk.Object.defineProperties(ac.prototype,{Y9a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiUrl")}}});Object(pe.a)(ac,"OneDriveFilePickerApiManagerV5",Bc,[]);vm(bb,Bc);bb.prototype.start=function(M,oa){var Xa=this;this.kSb=oa;var Sb=this.nog.AXe();Sb.continueWith(function(){ud.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Xa.Qce=Sb.result;
Xa.startPicker(function(xc,jd){Xa.Tzc();M(xc,jd)})},3);Sb.continueWith(function(){ud.ULS.sendTraceTag(24134242,352,15,Sb.exception.message);Xa.Tzc()},5)};bb.prototype.Jld=function(){var M=this;this.options.success=function(oa){var Xa={};Xa.data=oa;M.onSuccess(Xa)};this.options.error=function(oa){var Xa={};Xa.error=oa;M.o6(Xa)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Qce;this.options.advanced.iframeParentDiv=this.kSb};bb.prototype.cjc=
function(){try{ud.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Tzc(),OneDrive.open(this.options)}catch(M){ud.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",M.message),this.ui()}};bb.prototype.o6=function(M){this.p6&&this.p6(!1,M);this.ui()};bb.prototype.Tzc=function(){this.kSb.style.visibility="hidden"===this.kSb.style.visibility?"":"hidden"};Qk.Object.defineProperties(bb.prototype,{Y9a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});
Object(pe.a)(bb,"OneDriveFilePickerApiManagerV7",Bc,[]);vm(Ka,Bc);Ka.prototype.start=function(M,oa,Xa,Sb){this.options.advanced.iframeParentDiv=Xa;this.options.advanced.endpointHint=Sb;this.options.cancel=oa;this.glg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(M)};Ka.prototype.startPicker=
function(M){this.p6=M;this.RDa?ud.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(ud.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(uf.a)(this,this.czd,"onApiReady")))};Ka.prototype.Jld=function(){var M=this;this.options.success=function(oa){var Xa={};Xa.data=oa;M.onSuccess(Xa)};this.options.error=function(oa){var Xa={};Xa.error=oa;M.o6(Xa)}};Ka.prototype.cjc=function(){try{ud.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(M){ud.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",M.message,M.stack),this.ui()}};Ka.prototype.EAd=function(M){ud.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",M.exception?M.exception.toString():"No error detail.");ei.a.fbj(this.Y9a);this.NWa=null};Ka.prototype.ui=function(){this.Ds().R6c(Fg.a.Skj)};Ka.prototype.o6=function(M){this.p6&&
this.p6(!1,M)};Qk.Object.defineProperties(Ka.prototype,{Y9a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(pe.a)(Ka,"OneDriveFilePickerApiManagerV72",Bc,[]);Object(pe.a)(lf,"IExtraData",null,[]);vm(Ge,Ka);Ge.prototype.cjc=function(){try{ud.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",Pd.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(M){ud.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",M.message,M.stack),this.ui()}};Qk.Object.defineProperties(Ge.prototype,{Y9a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(pe.a)(Ge,"OneDriveFilePickerApiOpenManagerV72",Ka,[]);De.prototype.AXe=function(){this.Ul=new Ph.a;ud.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.tNd();return this.Ul.task};De.prototype.tNd=function(M){M=void 0===M?null:M;var oa=String.format("GetMoreInfoHandler.ashx?{0}",Pd.AFrameworkApplication.HHa);this.Sg.E9(oa,1,null,M,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(uf.a)(this,this.iUh,"getMoreInfoSucceeded"),Object(uf.a)(this,this.gUh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};De.prototype.gUh=function(M){if(M.data.httpStatus===gh.a.tFb&&"X-NewKey"in
M.data.responseHeaders){ud.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var oa={};oa["X-Key"]=M.data.responseHeaders["X-NewKey"];this.tNd(oa)}else 0<this.yPc?(ud.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.yPc),this.yPc--,this.tNd()):(ud.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Ul.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
De.prototype.iUh=function(M){"PersonalFileStorageUrl"in M.data.responseHeaders&&""!==M.data.responseHeaders.PersonalFileStorageUrl?(ud.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Ul.setResult(M.data.responseHeaders.PersonalFileStorageUrl)):(ud.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Ul.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(pe.a)(De,"OneDriveForBusinessEndpointHelper",
null,[538]);var Sg=b(581);Ld.prototype.init=function(){};Ld.prototype.dispose=function(){};Ld.prototype.ii=function(M){var oa=this;this.tb=M;this.tb.register(ac,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").Cc().Mc(function(){return new ac(Sg.a.instance,Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.V1a,Pd.AFrameworkApplication.limitedEdit,Pd.AFrameworkApplication.N4f,function(){return new Cb})});Pd.AFrameworkApplication.Shf?
this.tb.register(538,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Cc().Mc(function(){return new Lc}):this.tb.register(538,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Cc().Mc(function(){return new De(Pd.AFrameworkApplication.Kd)});this.tb.register(bb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").Cc().Mc(function(){return new bb(Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.V1a,Pd.AFrameworkApplication.limitedEdit,function(){return new Cb},
oa.tb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.tb.register(Ka,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").Cc().Mc(function(){return new Ka(Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.V1a,Pd.AFrameworkApplication.limitedEdit,function(){return new Cb})});this.tb.register(Ge,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").Cc().Mc(function(){return new Ge(Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.V1a,
Pd.AFrameworkApplication.limitedEdit,function(){return new Cb})})};Ld.main=function(){jg.a.instance.rj(new Ld)};Qk.Object.defineProperties(Ld.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(pe.a)(Ld,"PackageManager",null,[4,5]);var wg=Og.StandardDialog;vm(kd,wg);kd.prototype.displayError=function(M,oa,Xa){this.aA=oa;this.OWa=Xa;ud.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",M,Xa);M=this.U_c(M);
0===M?(this.kc=6,this.Gc(0,CommonUIStrings.l_DialogClose)):(this.kc=0,this.Gc(1,CommonUIStrings.l_DialogClose));0===M&&ud.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Iz(Fg.a.Rkj,this.eed(M),this.KOh(M,oa),Object(uf.a)(this,this.yLd,"retryDialogHandler"),!0)};kd.prototype.yLd=function(M){1===M?(ud.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.aA?this.La.De(Tf.a.pIb,2,[this.aA,this.OWa]):this.La.processAction(Tf.a.pIb,2)):ud.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};kd.prototype.U_c=function(M){return 0>M||6<M?(ud.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",M),0):M};kd.prototype.KOh=function(M,oa){M=this.U_c(M);return this.aib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][M]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][M]};kd.prototype.eed=function(M){M=this.U_c(M);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][M]};Object(pe.a)(kd,"ErrorRetryDialog",Og.StandardDialog,[526]);Oc.prototype.create=function(){return new kd(this.La,this.aib)};Object(pe.a)(Oc,"ErrorRetryDialogFactory",null,[495]);var yh=b(140),bh=b(38),Cg=yh.a;vm(Fb,Cg);Fb.prototype.uIe=function(M,oa){this.vL(1,!!M&&M!==oa);this.gJ=document.getElementById(Fb.vTe);bh.a.addHandler(this.gJ,"change",Object(uf.a)(this,this.Qmc,"onFileNameChange"));bh.a.addHandler(this.gJ,"input",
Object(uf.a)(this,this.Qmc,"onFileNameChange"));this.gJ.focus()};Fb.prototype.h9b=function(M){return this.aib?(new RegExp("["+this.O7b('\\/:*?"<>|')+"]")).test(M):(new RegExp("["+this.O7b('\\/:*?"<>|#{}%~&')+"]")).test(M)};Fb.prototype.O7b=function(M){return M.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};Fb.prototype.Hid=function(){var M=Sf.a.kr(Pd.AFrameworkApplication.am.yn);this.vL(1,!!this.gJ&&""!==this.gJ.value&&this.gJ.value!==M)};Fb.prototype.Qmc=function(){var M=this;this.gJ&&window.setTimeout(function(){M.Hid()},
0)};Fb.prototype.g9b=function(M,oa){if(1!==M)ud.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{M=oa[Fb.vTe];oa=Fb.pGf in oa?oa[Fb.pGf]:!1;ud.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Sf.a.jrc(M),oa);var Xa=Sf.a.s4(Pd.AFrameworkApplication.fileName);(M=M?M.trim():null)&&""!==M&&""!==Xa||1===this.sa.state?this.h9b(M)?this.Ds.create().displayError(1,M,oa):this.Ega.Vna(M+Xa,oa,
this.Eh):this.Ds.create().displayError(2,M,oa)}};Fb.prototype.dispose=function(){this.gJ&&(bh.a.removeHandler(this.gJ,"change",Object(uf.a)(this,this.Qmc,"onFileNameChange")),bh.a.removeHandler(this.gJ,"input",Object(uf.a)(this,this.Qmc,"onFileNameChange")),this.gJ=null);Cg.prototype.dispose.call(this)};Qk.Object.defineProperties(Fb.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.gf}}});Fb.vTe="txtFileName";Fb.pGf="chkOverwrite";Object(pe.a)(Fb,"FileNameDialogBase",yh.a,[]);
Qk.Object.defineProperties(Da,{eg:{configurable:!0,enumerable:!0,get:function(){return yh.a.Bn(Da.Uj,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Da.Uj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(pe.a)(Da,"FileNameDialogHtml",null,[]);vm(Lg,Fb);Lg.prototype.AQ=function(M,oa){var Xa=Sf.a.kr(Pd.AFrameworkApplication.am.yn),Sb={};oa=(Sb.txtFileName=M||Xa,Sb.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Sb.chkOverwrite=oa,Sb);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(uf.a)(this,this.g9b,"fileNameDialogHandler"),oa);this.uIe(M,Xa)};Object(pe.a)(Lg,"FileNameDialog",Fb,[525]);cg.prototype.create=function(){return new Lg(this.wb,this.La,this.gf,this.HX,this.Ds,this.Ega)};Object(pe.a)(cg,
"FileNameDialogFactory",null,[496]);var uh=b(688);Lh.prototype.Pg=function(){2===Pd.AFrameworkApplication.sa.Qa.Oj?Pd.AFrameworkApplication.Hb.ff(Tf.a.pIb,kh.a.frame,Object(uf.a)(this,this.UVf,"saveAsToHostActionDispatcher"),4):Pd.AFrameworkApplication.Hb.hc(Tf.a.pIb,kh.a.frame,Object(uf.a)(this,this.UVf,"saveAsToHostActionDispatcher"))};Lh.prototype.UVf=function(M,oa,Xa,Sb,xc){return oa.contextId!==kh.a.frame||M!==Tf.a.pIb?2:this.wb.ra("SaveAsToHostBrsIsEnabled")?1===Xa?uh.SessionStatusManager.instance.swb||
Pd.AFrameworkApplication.n5?8:32:2===Xa?(ud.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),M=this.bIc.create(),xc&&Object.getType(xc)===Array&&2===xc.length?M.AQ(xc[0],!!xc[1]):M.AQ(null,!1),32):8:8};Object(pe.a)(Lh,"SaveAsToHostActor",null,[]);var fg=b(78);Xg.prototype.ZKb=function(){1!==this.gf.state&&(this.um=this.Mkb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Ru=!1,this.um.HAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))};Xg.prototype.rS=function(M){M=void 0===M?0:M;1!==this.gf.state&&this.Ds.create().displayError(M,Sf.a.kr(this.aA),this.OWa)};Xg.prototype.$Pa=function(){var M=this.wb.appSettings.BreadcrumbFolderUrl;ud.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");xe.a.vf(M,xe.a.zX(3),void 0,"UploadToHostManager.RedirectToFolder")};Xg.prototype.ZPa=function(M){var oa=!1,Xa=!1;this.wb&&(oa=this.wb.ra("SaveACopyIsEnabledForUiHost"),Xa=this.wb.ra("UiHostSupportsDocRebootFeatures"));
ud.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",M,oa,Xa);if(oa&&Xa){ud.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Sb={};Sb[Ag.a.UPa]="1";Sb[Ag.a.documentUrl]=M;Sb[Ag.a.reason]=Oe.a.saveAs;Pd.AFrameworkApplication.rV().execute(function(xc){xc.Rj(Jf.a.Lta,Sb)})}else oa&&!Xa&&Pd.AFrameworkApplication.Ika?xe.a.vf(M,xe.a.zX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
xe.a.vf(M,xe.a.zX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};Xg.prototype.Vna=function(M,oa,Xa){Xa=void 0===Xa?null:Xa;ud.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.N8d&&!this.N8d()&&this.Sg&&(this.Ah&&(this.Dga=this.Ah.Ic("DialogShown","SaveAsToHostUploadTime")),this.ZKb(),this.OWa=oa,this.aA=M,(this.Eh=Xa)&&"true"===this.Eh.SkipSaveToHost?this.x8b():this.JQ())};Xg.prototype.JQ=function(){var M=this;32!==this.La.processAction(Tf.a.VQa,1)?(ud.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.x8b()):this.La.De(Tf.a.VQa,2,[function(){ud.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");M.x8b()},function(oa,Xa){ud.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");M.rS(Xa)}])};Xg.prototype.fVi=function(M){this.pIa();this.gDa=!1;if(M&&M.data&&M.data.je){var oa=ph.d(M.data.je);var Xa=oa.Iu;if(oa.returnValue)if(Xa.StatusCode!==
gh.a.fP&&Xa.StatusCode!==gh.a.jrb)ud.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),M={},M.FailureReason=Xa.StatusCode.toString(),M.ExtraInfo=Xa.ExtraInfo,this.qda(M),this.rS(parseInt(Xa.ExtraInfo));else{ud.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.rKd();try{Xa.NewDocumentUrl&&""!==Xa.NewDocumentUrl?this.ZPa(Xa.NewDocumentUrl):this.$Pa()}catch(Sb){ud.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Sb.toString())}this.aFb()}else Xa=
{},ud.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Xa.ResponseData=eh.a.zeb(M.data.je),Xa)),M={},this.qda((M.FailureReason="Failed to deserialize response",M)),this.rS()}else ud.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),M={},this.qda((M.FailureReason="null response",M)),this.rS()};Xg.prototype.eVi=function(M){if(5!==M.data.status&&12!==M.data.status||this.gDa){var oa={};ud.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(oa.Status=M.data.status,oa.HttpStatus=M.data.httpStatus,oa));oa={};this.qda((oa.FailureReason=M.data.httpStatus.toString(),oa));this.pIa();this.rS();this.aFb()}else ud.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.gDa=!0,this.Eh&&"true"===this.Eh.SkipSaveToHost?this.x8b():this.JQ()};Xg.prototype.pIa=function(){this.um&&(this.um.close(),this.um=null)};Xg.prototype.aFb=function(){this.Dga&&(this.Dga.stop(),this.Dga=null)};Xg.prototype.rKd=function(){this.Eh&&
"VersionHistory"===this.Eh.SaveEntryPoint&&this.La.processAction(Tf.a.jtc,2)};Xg.prototype.qda=function(M){this.Eh&&"VersionHistory"===this.Eh.SaveEntryPoint&&this.La.De(Tf.a.tKd,2,M)};Xg.prototype.x8b=function(){var M=this.dFa+this.Cfa;M=fg.a.hl(M,"qs",Sf.a.pf(Pd.AFrameworkApplication.lj));M=fg.a.hl(M,"n",Sf.a.pf((new Date).getTime().toString()));M=fg.a.hl(M,"ov",Sf.a.pf(this.OWa.toString()));M=fg.a.hl(M,"fn",Sf.a.pf(this.aA));this.Eh&&this.Eh.FileDownloadUrl&&(M=fg.a.hl(M,"furl",Sf.a.pf(this.Eh.FileDownloadUrl)));
this.Sg.Wl(M,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(uf.a)(this,this.fVi,"onUploadFinished"),Object(uf.a)(this,this.eVi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(pe.a)(Xg,"UploadToHostManager",null,[441]);var Qh=b(909);qg.prototype.init=function(){Pd.AFrameworkApplication.ga.Tu(Object(uf.a)(this,this.kB,"onFullAppSettingsReady"))};qg.prototype.kB=function(){Pd.AFrameworkApplication.ga.ra("SaveAsToHostBrsIsEnabled")&&this.tb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Pg()};
qg.prototype.ii=function(M){this.tb=M;this.tb.register(Oc,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Mc(function(){return new Oc(Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.Hb)}).Cc();this.tb.register(Xg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Mc(function(){return new Xg(Pd.AFrameworkApplication.Hb,Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.Kd,function(){return Pd.AFrameworkApplication.Hg},
function(){return(new Qh.a).create()},M.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Pd.AFrameworkApplication.sa,Pd.AFrameworkApplication.sa.vD)}).Cc();this.tb.register(cg,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Mc(function(){return new cg(Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.Hb,Pd.AFrameworkApplication.sa,Pd.AFrameworkApplication.sa.Qa,M.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),M.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Cc();
this.tb.register(Lh,"Common.App.SaveAsToHost.SaveAsToHostActor").Mc(function(){return new Lh(Pd.AFrameworkApplication.ga,M.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),M.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Cc()};qg.prototype.dispose=function(){};qg.main=function(){jg.a.instance.rj(new qg)};Qk.Object.defineProperties(qg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(pe.a)(qg,"SaveAsToHostPackage",null,[4,5]);
var ii=Og.StandardDialog;vm(Je,ii);Je.prototype.displayError=function(M,oa){this.PIe(M,oa,Fg.a.Tkj)};Je.prototype.PIe=function(M,oa,Xa){ud.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Xa);this.Iz(Xa,M,oa,null)};Je.prototype.R6c=function(M,oa){ud.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Iz(Fg.a.Vkj,M,oa,null,!0)};Object(pe.a)(Je,"ErrorDialog",Og.StandardDialog,[501]);Qk.Object.defineProperties(Re,{eg:{configurable:!0,
enumerable:!0,get:function(){return yh.a.Bn(Re.Uj,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});Re.Uj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(pe.a)(Re,"FileNameDialogHtml",null,[]);var kg=b(12),mi=b(91),Yh=b(89);vm(Uf,Fb);Uf.prototype.AQ=function(M){var oa=Sf.a.kr(Pd.AFrameworkApplication.am.yn),Xa=Pd.AFrameworkApplication.breadcrumbFolderName,Sb=Pd.AFrameworkApplication.breadcrumbBrandName,xc={};xc=(xc.txtFileName=M||oa,xc);var jd=CommonUIStrings.L_SaveAs;2===Pd.AFrameworkApplication.sa.Qa.Oj&&(jd=CommonUIStrings.L_SaveACopy);this.initializeAndShow(jd,Object(uf.a)(this,this.g9b,"fileNameDialogHandler"),xc);this.uIe(M,oa);this.gIa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");Pd.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.Fy=document.getElementById("anotherFolder"),M=document.getElementById("folderLocation"),this.bQc=Yh.a.Lqe(M,this.Fy,"anotherFolderDescribedBy"),this.Fy.className="WACButton WACDialogButtonNormal",M=!1,Xa&&Xa.length?(this.zle(this.Fy,this.bQc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Sb,Xa)),
M=this.AAg(Sb,Xa)):this.zle(this.Fy,this.bQc,CommonUIStrings.l_CurrentOnlineFolder),this.xBg(this.Fy),this.CAg(this.Fy),M?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Fy,"SaveToAnotherLocationTwo"),ud.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Fy,"SaveToAnotherLocationOne"),bh.a.addHandler(this.Fy,kg.a.click,Object(uf.a)(this,this.qBd,"onSaveToAnotherLocationClick")),
bh.a.addHandler(this.Fy,kg.a.Tb,Object(uf.a)(this,this.SCf,"onSaveToAnotherLocationKeyDown")))};Uf.prototype.AAg=function(M,oa){var Xa=!1;var Sb=document.getElementById("currentLocation");Sb.innerText="";var xc=this.X0e(Sb,M),jd=this.X0e(Sb,oa),vd=255,ae=255;255<xc+jd&&(vd=Math.max(238,408-xc),ae=Math.max(170,408-jd),Xa=!0);this.UCg(Sb,M,ae,oa,vd);return Xa};Uf.prototype.X0e=function(M,oa){var Xa=document.createElement("div");Xa.innerText=oa;Xa.style.visibility="hidden";M.appendChild(Xa);oa=Xa.clientWidth;
M.removeChild(Xa);return oa};Uf.prototype.UCg=function(M,oa,Xa,Sb,xc){oa&&(this.xle(M,oa,Xa),this.NCg(M));Sb&&this.xle(M,Sb,xc)};Uf.prototype.xle=function(M,oa,Xa){var Sb=document.createElement("div");Sb.innerText=oa;Sb.title=oa;Sb.className="SaveToAnotherFolderBreadcrumb";Sb.style.maxWidth=Xa.toString()+"px";M.appendChild(Sb)};Uf.prototype.NCg=function(M){var oa=document.createElement("span");oa.id="FolderSeparator";var Xa=document.createElementNS("http://www.w3.org/2000/svg","svg");Xa.setAttribute("class",
"SeparatorCaret");var Sb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Sb.setAttribute("points","1 4 1 11 5 7.5");Xa.appendChild(Sb);oa.appendChild(Xa);M.appendChild(oa)};Uf.prototype.zle=function(M,oa,Xa){Xa=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Xa);oa&&(oa.innerText=Xa);M.tabIndex=0;M.setAttribute(Yh.a.Ud,Yh.a.Pr)};Uf.prototype.CAg=function(M){var oa=document.createElement("span");oa.id="anotherFolderText";oa.innerText=this.NSg;oa.className="AnotherFolderTextSpan";
M.appendChild(oa)};Uf.prototype.xBg=function(M){var oa=document.createElement("span");oa.className="cui-img-cont-float cui-img-16by16 ";this.cqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.cqa.setAttribute("class","FolderIconSVG");var Xa=document.createElementNS("http://www.w3.org/2000/svg","path");Xa.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.cqa.appendChild(Xa);oa.appendChild(this.cqa);
M.appendChild(oa)};Uf.prototype.SCf=function(M){!M||M.keyCode!==mi.a.Zh&&M.keyCode!==mi.a.g1||this.qBd(M)};Uf.prototype.qBd=function(){if(this.gJ){var M=Sf.a.s4(Pd.AFrameworkApplication.fileName),oa=this.gJ.value;this.hide();oa&&""!==oa&&""!==M||1===this.sa.state?(""!==M&&(oa+=M),this.h9b(oa)?this.Ds.create().displayError(1,oa,!1):this.mlb.start(oa,this.xtg)):this.Ds.create().displayError(2,oa,!1)}};Uf.prototype.xWg=function(M){this.Fy&&this.cqa&&(M?(this.Fy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Fy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.cqa,"DisabledFolderIconSVG")):(this.Fy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Fy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.cqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Fy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.cqa,"DisabledFolderIconSVG"))))};Uf.prototype.Hid=function(){Fb.prototype.Hid.call(this);this.xWg(!!this.gJ&&""!==this.gJ.value)};Uf.prototype.dispose=function(){this.Fy&&
(bh.a.removeHandler(this.Fy,kg.a.click,Object(uf.a)(this,this.qBd,"onSaveToAnotherLocationClick")),bh.a.removeHandler(this.Fy,kg.a.Tb,Object(uf.a)(this,this.SCf,"onSaveToAnotherLocationKeyDown")),this.Fy=null);Fb.prototype.dispose.call(this)};Object(pe.a)(Uf,"FileNameDialog",Fb,[528]);var og=b(805),Ca=b(574),ua=b(185),tb=b(1040),Nd=b(129);Object(pe.a)(df,"SaveAsDialogInput",null,[]);Object(pe.a)(pg,"SaveLocation",null,[]);var me=b(338);hf.prototype.RNh=function(){var M=new og.a(Ca.a.Gk());M.ia("type",
"currentHost");return Object.assign(new pg,{folderName:this.Bv.breadcrumbFolderName,friendlyPath:this.Bv.breadcrumbBrandName,properties:M})};hf.prototype.Dni=function(M){return!!M&&"ClassicMru"===M.type&&!!M.service_info&&!!M.service_info.service_id&&-1!==M.service_info.service_id.indexOf("SHAREPOINT")};hf.prototype.aZh=function(){if(!this.kMc||!this.YEa)return null;var M=this.kMc.value.gz("SaveAsToSharePointDialog",!1);if(!M||3!==M.state||!M.yrf)return null;M=M.yrf;for(var oa=new ua.a,Xa=0,Sb=0,
xc=0;xc<M.length;xc++){var jd=M[xc];if(this.Dni(jd)&&(Xa++,jd.sharepoint_info)){var vd=jd.url,ae=jd.sharepoint_info.site_url,Ie=jd.title;jd=tb.b(jd,Pd.AFrameworkApplication.isRtl);if(vd&&ae&&Ie&&jd){Sb++;var Zf=new og.a(Ca.a.Gk());Zf.ia("type","SharePoint");Zf.ia("siteUrl",ae);Zf.ia("folderUrl",vd);Sb++;oa.add(Object.assign(new pg,{folderName:Ie,friendlyPath:jd,properties:Zf}))}}}xc=new Map;xc.set("NumPlaces",M.length.toString());xc.set("NumSharepointPlaces",Xa.toString());xc.set("placesWithMetadata",
Sb.toString());jh.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",xc);0<Xa&&(Sb?.5>1*Sb/Xa&&jh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):jh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return oa};hf.prototype.JOh=function(){var M=new ua.a;M.add(this.RNh());var oa=this.aZh();oa&&M.addRange(oa);return Object.assign(new df,{enableMoreLocations:!Pd.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.aA,extension:Sf.a.s4(this.Bv.yn),saveLocations:M.toArray(),scenario:"SaveToSharePoint"})};hf.prototype.GOh=function(){return{inputPropsCallback:Object(uf.a)(this,this.JOh,"getDialogInput")}};hf.prototype.AQ=function(M){this.aA=M;this.aA||(this.aA=String.format(CommonUIStrings.l_SaveACopy_Filename,Sf.a.kr(this.Bv.yn)));M={};M=(M.id="SaveAsDialog",M.bodyControls=this.GOh(),M);var oa=CommonUIStrings.L_SaveAs;2===this.gf.Qa.Oj&&(oa=CommonUIStrings.L_SaveACopy);var Xa=new yh.a(!1,!1,!0);
Xa.kc=1;Xa.Ve="SaveAsDialog";Xa.Gc(1,CommonUIStrings.l_SaveButtonLabel);Xa.initializeAndShow(oa,Object(uf.a)(this,this.Pkj,"saveAsDialogHandler"),M)};hf.prototype.$Bj=function(M,oa){M&&""!==M&&""!==oa||1===this.gf.state?this.Cni()?this.Rti(M,oa):(""!==oa&&(M+=oa),this.mlb.start(M,this.Eh)):(ud.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Ds.create().displayError(2,M,!1))};hf.prototype.Rti=function(M,oa){var Xa=this;jh.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var Sb=this.vXa.ZDe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.vXa.zed(Sb).then(function(xc){if(xc&&0<xc.length){var jd=xc[0][Ag.a.wZi];xc=xc[0][Ag.a.FHf];if(""!==jd&&""!==xc)Xa.YEa.Vna(xc,M+oa,jd,Xa.Eh),jh.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Xa.Ds.create().displayError(0,M,!1);var vd=Nd.a.Vr();vd&&(vd.set("SiteUrlAvailable",""===jd?"false":"true"),vd.set("FolderUrlAvailable",""===xc?"false":
"true"));jh.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new me.a,{extendedProperties:vd}))}}else Xa.Ds.create().displayError(0,M,!1),jh.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(xc){"Canceled"===xc?((xc=Nd.a.Vr())&&xc.set("IsCanceled","true"),jh.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new me.a,{extendedProperties:xc}))):jh.Health.instance.recordKpiFailure("SaveACopySFP",
xc,!1,!1,null)})};hf.prototype.Cni=function(){return this.vXa?this.vXa.zqd()&&(Pd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1)||"SharePointOnlineConsumer"===Pd.AFrameworkApplication.ga.Ua("FileSource")):(ud.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};hf.prototype.Pkj=function(M,oa){if(oa&&1===M){M=oa.fileName;var Xa=Sf.a.s4(this.Bv.yn);oa.moreLocationsSelected&&this.$Bj(M,Xa);if(oa.locationCallback){var Sb=
oa.locationCallback();Sb?Sb.properties&&"currentHost"===Sb.properties.oa("type")?this.Ega.Vna(M+Xa,!1,this.Eh):Sb.properties&&"SharePoint"===Sb.properties.oa("type")?(oa=Sb.properties.oa("siteUrl"),Sb=Sb.properties.oa("folderUrl"),this.YEa.Vna(Sb,M+Xa,oa,this.Eh)):ud.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ud.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ud.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(pe.a)(hf,"ReactSaveAsDialog",
null,[528]);Lf.prototype.create=function(M){return this.gf&&this.gf.Qa.qw?new hf(this.Xfe,this.Ds,this.Ega,Pd.AFrameworkApplication.am,this.gf,this.asg,this.YEa,this.vXa,M):new Uf(this.wb,this.La,this.gf,this.HX,this.Ds,this.Ega,this.Xfe,M)};Object(pe.a)(Lf,"FileNameDialogFactory",null,[503]);bf.prototype.start=function(M){var oa=this;if(!this.FFf)if(Pd.AFrameworkApplication.breadcrumbFolderUrl&&Pd.AFrameworkApplication.breadcrumbFolderUrl.length)this.kkb=Pd.AFrameworkApplication.breadcrumbFolderUrl;
else return ud.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Go),!1;var Xa=this.Ttg();Xa.tCj();var Sb=Xa.MVh();if(!Sb)return ud.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.gib.start(function(xc,jd){Xa.hide();M(xc,jd)},function(){oa.szd(Xa)},Sb,this.kkb);return!0};bf.prototype.szd=function(M){M.hide();ud.ULS.sendTraceTag(24664068,
216,50,"User cancelled save to another folder.")};bf.prototype.gVh=function(M){M=M.toLowerCase();M.endsWith("/")||(M+="/");var oa=M.indexOf("/documents/");return-1!==oa?M.substring(0,oa+1)+"_layouts/15/onedrive.aspx":""};bf.prototype.mvb=function(M){this.Go||3!==M.state||(this.Go=M)};Qk.Object.defineProperties(bf.prototype,{FFf:{configurable:!0,enumerable:!0,get:function(){this.kkb||(this.sDa.value.gz("Save As",!0),this.Go&&this.Go.YR&&this.Go.YR.length&&(this.kkb=this.gVh(this.Go.YR)));return this.kkb}}});
Object(pe.a)(bf,"OneDriveFilePickerHelper",null,[498]);var sf=yh.a;vm(zf,sf);zf.prototype.tCj=function(){this.SGc="FilePickerDialog";this.eg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ve="PickerDialog-MsoSp";this.showDialog("",null)};zf.prototype.MVh=function(){return document.getElementById("FilePickerDiv")};zf.prototype.DO=function(){};zf.prototype.NPa=function(){};Object(pe.a)(zf,"PickerDialog",yh.a,[500]);var sg=b(973),Ff=b(23);le.prototype.Pg=function(){var M=this,oa=this.gib.T3a();
oa?Ff.a.bB||this.wb.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.ff(Tf.a.saveToSharePoint,kh.a.frame,Object(uf.a)(this,this.nWf,"saveToSharePointActionDispatcher"),64):(oa.V7a.continueWith(function(Xa){Xa.kg&&M.gib.EAd(Xa)}),this.S0b()):ud.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};le.prototype.S0b=function(){ei.a.EHd(Object(uf.a)(this,this.nWf,"saveToSharePointActionDispatcher"));ei.a.q8c([new sg.a(Tf.a.saveToSharePoint,kh.a.frame,
0)],this.gib.T3a())};le.prototype.nWf=function(M,oa,Xa,Sb,xc){return oa.contextId!==kh.a.frame||M!==Tf.a.saveToSharePoint?2:this.g7a&&(this.UNc.FFf||this.Ewe)?1===Xa?uh.SessionStatusManager.instance.swb||Pd.AFrameworkApplication.n5?8:this.qmg()?32:8:2===Xa?(ud.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(xc&&xc.SaveEntryPoint&&"VersionHistory"===xc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Ewe?(ud.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),
this.bIc.create(xc).AQ(null)):(ud.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.mlb.start(null,xc)),32):8:8};Qk.Object.defineProperties(le.prototype,{g7a:{configurable:!0,enumerable:!0,get:function(){return this.wb.ra("SaveToAnotherFolderBrsIsEnabled")}},Ewe:{configurable:!0,enumerable:!0,get:function(){return this.wb.ra("UserCanWriteRelative")}}});Object(pe.a)(le,"SaveToSharePointActor",null,[]);Le.prototype.start=function(M,
oa){var Xa=this;ud.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Tbe=M;this.Eh=oa;this.UNc.start(function(Sb,xc){Xa.Q2i(Sb,xc)})||this.PRd()};Le.prototype.Q2i=function(M,oa){if(M)this.onSuccess(oa);else this.o6(oa)};Le.prototype.PRd=function(){1!==this.gf.state&&this.Ds().R6c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};Le.prototype.onSuccess=function(M){ud.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(M&&M.data&&M.data.value&&M.data.value.length&&M.data.value[0].sharePoint){var oa=M.data.value[0].sharePoint.url;M=M.data.value[0].sharePoint.listUrl;var Xa=null;if(oa&&(Xa=M?this.wZh(M):this.vZh(oa))){this.YEa.Vna(oa,this.Tbe,Xa,this.Eh);return}ud.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!oa,!Xa)}ud.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.PRd()};Le.prototype.vZh=function(M){M.endsWith("/")||
(M+="/");for(var oa=0,Xa=0;Xa<M.length;Xa++)if("/"===M.charAt(Xa)&&5===++oa)return M.substr(0,Xa);return null};Le.prototype.wZh=function(M){M.endsWith("/")&&(M=M.substring(0,M.length-1));var oa=M.lastIndexOf("/");return-1!==oa?M.substring(0,oa):null};Le.prototype.o6=function(M){ud.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");M&&M.error?ud.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",M.error.errorCode,M.error.message):ud.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.PRd()};Object(pe.a)(Le,"SaveToSharePointManager",null,[499]);Xd.prototype.execute=function(M,oa){if(!Pd.AFrameworkApplication.Hg&&Pd.AFrameworkApplication.Kd){var Xa=this.dFa+this.Cfa;Xa=fg.a.hl(Xa,"fu",Sf.a.pf(this.J8));Xa=fg.a.hl(Xa,"su",Sf.a.pf(this.Gwg));Xa=fg.a.hl(Xa,"fn",Sf.a.pf(this.aA));Xa=fg.a.hl(Xa,"n",Sf.a.pf((new Date).getTime().toString()));this.Eh&&this.Eh.FileDownloadUrl&&(Xa=fg.a.hl(Xa,"furl",Sf.a.pf(this.Eh.FileDownloadUrl)));Xa=Xa+
"&"+this.XOc;this.DVa&&this.DVa.length?Xa=fg.a.hl(Xa,"fnn",Sf.a.pf(this.DVa)):ud.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ud.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");Pd.AFrameworkApplication.Kd.Wl(Xa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,M,oa,null,void 0,void 0,void 0,void 0,"9")}};Object(pe.a)(Xd,"SharePointSaveAsCaller",null,[527]);cd.prototype.create=function(M,oa,Xa,Sb){return new Xd(this.eFa,this.aA,M,
oa,Xa,Pd.AFrameworkApplication.lj,this.Cfa,Sb)};Object(pe.a)(cd,"SharePointUploadCallerFactory",null,[497]);var xg=b(807);Nc.prototype.Vna=function(M,oa,Xa,Sb){this.wEc=!1;ud.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.ZKb();this.J8=M;Sb&&Sb.SaveEntryPoint&&(this.YPc=Sb.SaveEntryPoint);this.zCa=this.sSc.create(M,oa,Xa,Sb);Sb&&"true"===Sb.SkipSaveToHost?this.JQ():this.kFh()};Nc.prototype.kFh=function(){function M(){ud.ULS.sendTraceTag(23881923,
216,15,"The file change is not saved successfully, this operation may lead to data loss.");oa.JQ()}var oa=this;32!==this.La.De(Tf.a.VQa,2,[function(){ud.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");oa.JQ()},M])&&M()};Nc.prototype.JQ=function(){ud.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.zCa.execute(Object(uf.a)(this,this.uSi,"onSaveToSharePointUploadFinished"),Object(uf.a)(this,this.tSi,"onSaveToSharePointUploadFailed"))};
Nc.prototype.uSi=function(M){if(M&&M.data&&M.data.je){var oa=ph.d(M.data.je);var Xa=oa.Iu;if(oa.returnValue)if(Xa.StatusCode!==gh.a.fP&&Xa.StatusCode!==gh.a.jrb)ud.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",M.data.status,Xa.StatusCode),Xa.StatusCode!==gh.a.hTf&&this.oJe(M.data.status)||(this.qda(Xa.StatusCode.toString()),this.aBj(Xa.StatusCode));else{ud.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.rKd();try{Xa.NewDocumentUrl?this.ZPa(Xa.NewDocumentUrl):this.$Pa()}catch(Sb){ud.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Sb.toString())}}else Xa={},ud.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Xa.ResponseData=eh.a.zeb(M.data.je),Xa)),this.D6b()||(this.qda("Failed to deserialize response"),this.XKb())}else ud.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.D6b()||(this.qda("Unknown"),this.XKb())};Nc.prototype.tSi=
function(M){M&&M.data?this.oJe(M.data.status)||(ud.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.qda(xg.a[M.data.status]),this.XKb()):(ud.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.D6b()||(this.qda("Unknown"),this.XKb()))};Nc.prototype.D6b=function(){if(!this.wEc)return ud.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.wEc=!0,this.JQ(),!0;ud.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};
Nc.prototype.oJe=function(M){ud.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",M);return this.D6b()};Nc.prototype.$Pa=function(){ud.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");xe.a.vf(this.J8,xe.a.zX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};Nc.prototype.ZPa=function(M){var oa=!1,Xa=!1;Pd.AFrameworkApplication.ga&&(oa=Pd.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Xa=Pd.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));ud.ULS.sendTraceTag(23881934,
216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",M,oa);if(oa&&Xa){ud.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Sb={};Sb[Ag.a.UPa]="1";Sb[Ag.a.documentUrl]=M;Sb[Ag.a.reason]=Oe.a.saveAs;Pd.AFrameworkApplication.rV().execute(function(xc){xc.Rj(Jf.a.Lta,Sb)})}else xe.a.vf(M,xe.a.zX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};Nc.prototype.ZKb=function(){this.gf&&1===this.gf.state||(this.um=this.Mkb(),
this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Ru=!1,this.um.HAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};Nc.prototype.pIa=function(){this.um&&(this.um.close(),this.um=null)};Nc.prototype.XKb=function(){this.ui(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)};Nc.prototype.dCj=function(){this.ui(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};Nc.prototype.gBj=function(){var M=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,
250);this.ui(CommonUIStrings.l_SaveAsFileTooLargeTitle,M,Fg.a.Qkj)};Nc.prototype.ui=function(M,oa,Xa){Xa=void 0===Xa?Fg.a.Ukj:Xa;ud.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",M,oa);this.pIa();1!==this.gf.state&&this.Ds().PIe(M,oa,Xa)};Nc.prototype.aBj=function(M){ud.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",M);switch(M){case gh.a.Jbg:this.dCj();break;case gh.a.hTf:this.gBj();break;default:this.XKb()}};Nc.prototype.rKd=function(){"VersionHistory"===
this.YPc&&this.La.processAction(Tf.a.jtc,2)};Nc.prototype.qda=function(M){if("VersionHistory"===this.YPc){var oa={};this.La.De(Tf.a.tKd,2,(oa.FailureReason=M,oa))}};Object(pe.a)(Nc,"UploadToSharePointManager",null,[440]);Zb.prototype.init=function(){};Zb.prototype.dispose=function(){};Zb.prototype.ii=function(M){var oa=this;this.tb=M;this.KTb=xh.a.Sq(M.pc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.MTb=xh.a.Sq(M.pc("Common.IEventEmitter<Common.IMruResult>"));Pd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1)||"SharePointOnlineConsumer"===Pd.AFrameworkApplication.ga.Ua("FileSource")?(this.qga=xh.a.Sq(M.pc("Common.App.SharedFilePicker.ISharedFilePicker")),Wg.Task.WAA.call(null,this.KTb,this.MTb,this.qga).continueWith(function(){oa.yOf()})):(this.qga=null,Wg.Task.WAA.call(null,this.KTb,this.MTb).continueWith(function(){oa.yOf()}))};Zb.prototype.yOf=function(){var M=this;this.tb.register(cd,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Mc(function(){return new cd(Pd.AFrameworkApplication.ga)}).Cc();
this.tb.register(Nc,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Mc(function(){return new Nc(Pd.AFrameworkApplication.Hb,M.tb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new Qh.a).create()},function(){return new Je},Pd.AFrameworkApplication.sa)}).Cc();this.tb.register(Le,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Mc(function(){return new Le(M.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new Je},M.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),Pd.AFrameworkApplication.sa)}).Cc();this.tb.register(bf,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Mc(function(){return new bf(M.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new If.a(function(){return M.KTb.result}),Pd.AFrameworkApplication.sa,function(){return new zf})}).Cc();this.tb.register(Lf,
"Common.App.SaveToSharePoint.FileNameDialogFactory").Mc(function(){return new Lf(Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.Hb,Pd.AFrameworkApplication.sa,Pd.AFrameworkApplication.sa.Qa,M.tb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),M.tb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),M.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new If.a(function(){return M.MTb.result}),M.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
M.qga?M.qga.result:null)}).Cc();this.tb.register(le,"Common.App.SaveToSharePoint.SaveToSharePointActor").Mc(function(){return new le(Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.Hb,M.tb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),M.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),M.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),M.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return Pd.AFrameworkApplication.sa.OUg})}).Cc();
Pd.AFrameworkApplication.ga.ra("SaveToAnotherFolderBrsIsEnabled")&&this.tb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Pg()};Zb.main=function(){jg.a.instance.rj(new Zb)};Qk.Object.defineProperties(Zb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(pe.a)(Zb,"PackageManager",null,[4,5]);var yg=Og.StandardDialog;vm(re,yg);re.prototype.displayError=function(M){this.Iz(M,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)};Object(pe.a)(re,"ErrorDialog",Og.StandardDialog,[508]);Od.default=0;Object(pe.a)(Od,"SaveToCloudErrorCodes",null,[]);xd.prototype.start=function(M){this.Eh=M;if("SharePointOnlineConsumer"===this.wb.Ua("FileSource")){var oa=Uh.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(oa){oa.start(null,M);return}}this.c2.MLa?(ud.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.kUg()):(ud.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),
this.showSignInDialog())};xd.prototype.showSignInDialog=function(){this.zwg.create().AQ()};xd.prototype.ui=function(){this.Ds().displayError(Od.default)};xd.prototype.kUg=function(){try{ud.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var M={},oa=(M.client_id=this.wb.appSettings.UploadToSkyDriveClientId,M.env="INT",M);if(1===this.PPb||2===this.PPb)M={},oa=(M.client_id=this.wb.appSettings.UploadToSkyDriveClientId,M);M={};var Xa=(M.mode="save",M.lightbox="grey",M);WL.init(oa);ud.ULS.sendTraceTag(6590562,
216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Xa).then(Object(uf.a)(this,this.onSuccess,"onSuccess"),Object(uf.a)(this,this.o6,"onFailure"))}catch(Sb){ud.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Sb,Sb.stack),this.ui()}};xd.prototype.onSuccess=function(M){ud.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");M&&M.data&&M.data.folders&&this.fmb.Vna(M.data.folders[0].id,M.data.folders[0].urls.viewInBrowser,
null,this.Eh)};xd.prototype.o6=function(M){if(M&&M.error){if("user_canceled"===M.error.code){ud.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ud.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",M.error.code,M.error.message)}else ud.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.ui()};Object(pe.a)(xd,"SaveToCloudManager",null,[502]);Vc.prototype.g7a=function(){return this.wb.ra("SaveToCloudStorageUIIsEnabled")};
Vc.prototype.gXe=function(){return Tf.a.saveToCloudStorage};Vc.prototype.S0b=function(){ei.a.EHd(Object(uf.a)(this,this.lWf,"saveToCloudActionDispatcher"));ei.a.q8c([new sg.a(Tf.a.saveToCloudStorage,kh.a.frame,0)],this.Rce.T3a())};Vc.prototype.Pg=function(){var M=this,oa=this.Rce.T3a();oa?(oa.J9(function(){M.sae.setResult(!0)}),this.S0b()):ud.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};Vc.prototype.KNf=function(){ud.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")};Vc.prototype.lWf=function(M,oa,Xa,Sb,xc){var jd=this;return oa.contextId!==kh.a.frame||M!==this.gXe()?2:this.g7a()?1===Xa?uh.SessionStatusManager.instance.swb||Pd.AFrameworkApplication.n5?8:32:2===Xa?(this.KNf(),xc&&xc.FileDownloadUrl&&ud.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ah&&(this.hVb=this.Ah.Ic("DialogShown","SaveToOneDriveReponseTime")),this.sae.task.continueWith(function(){jd.hVb&&(jd.hVb.stop(),
jd.hVb=null);jd.Dvg.start(xc)}),32):8:8};Object(pe.a)(Vc,"SaveToCloudStorageActor",null,[507]);var hh=b(277),nh=Og.StandardDialog;vm(uc,nh);uc.prototype.AQ=function(){this.c2.vYa(Object(uf.a)(this,this.TDf,"onSignIn"));this.Ik(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(uf.a)(this,this.Wci,"inputHandler"))};uc.prototype.Wci=function(M){0===M?(ud.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.A6()};uc.prototype.WWg=
function(){var M="2";if(this.HX)switch(this.HX.Oj){case 3:M="0";break;case 2:M="3";break;case 1:M="1"}return M};uc.prototype.hide=function(){this.c2.UGb(Object(uf.a)(this,this.TDf,"onSignIn"));nh.prototype.hide.call(this)};uc.prototype.A6=function(){var M=new hh.QueryStringBuilder("Signin.aspx");M.Gi("prompt","1");M.Gi("cbcxt",this.WWg());Pd.AFrameworkApplication.Pmb(M);xe.a.vf(M.toString(),"LoginWindow",void 0,"SignInDialog")};uc.prototype.TDf=function(){this.Dq&&this.hide();ud.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(Tf.a.saveToCloudStorage,2)};Object(pe.a)(uc,"SignInDialog",Og.StandardDialog,[531]);Eb.prototype.create=function(){return new uc(this.La,this.c2,this.HX)};Object(pe.a)(Eb,"SignInDialogFactory",null,[506]);La.prototype.execute=function(M,oa){if(!Pd.AFrameworkApplication.Hg&&Pd.AFrameworkApplication.Kd){var Xa=this.dFa+this.Cfa;Xa=fg.a.hl(Xa,"fo",Sf.a.pf(this.XRb));Xa=fg.a.hl(Xa,"fn",Sf.a.pf(this.aA));
Xa=fg.a.hl(Xa,"qs",Sf.a.pf(this.XOc));Xa=fg.a.hl(Xa,"n",Sf.a.pf((new Date).getTime().toString()));this.Eh&&this.Eh.FileDownloadUrl&&(Xa=fg.a.hl(Xa,"furl",Sf.a.pf(this.Eh.FileDownloadUrl)));this.DVa&&(Xa=fg.a.hl(Xa,"fnn",Sf.a.pf(this.DVa)));Pd.AFrameworkApplication.Kd.Wl(Xa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,M,oa,null)}};Object(pe.a)(La,"SkyDriveUploadCaller",null,[529]);wh.prototype.create=function(M,oa,Xa){return new La(this.eFa,this.aA,oa,M,Pd.AFrameworkApplication.lj,
this.Cfa,Xa)};Object(pe.a)(wh,"SkydriveUploadCallerFactory",null,[504]);ig.prototype.ZKb=function(){this.gf&&1===this.gf.state||(this.um=this.Mkb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Ru=!1,this.um.HAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};ig.prototype.pIa=function(){this.um&&(this.um.close(),this.um=null)};ig.prototype.rS=function(){1!==Pd.AFrameworkApplication.sa.state&&this.Ds().displayError(Od.default)};ig.prototype.$Pa=function(){ud.ULS.sendTraceTag(6590599,
216,50,"Redirecting to OneDrive Folder.");xe.a.vf(this.J8,xe.a.zX(3),void 0,"UploadToCloudManager.RedirectToFolder")};ig.prototype.ZPa=function(M){var oa=!1,Xa=!1;Pd.AFrameworkApplication.ga&&(oa=Pd.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Xa=Pd.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));ud.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",M,oa);if(oa&&Xa){ud.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
var Sb={};Sb[Ag.a.UPa]="1";Sb[Ag.a.documentUrl]=M;Pd.AFrameworkApplication.rV().execute(function(xc){xc.Rj(Jf.a.Lta,Sb)})}else xe.a.vf(M,xe.a.zX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};ig.prototype.Vna=function(M,oa,Xa,Sb){Xa=void 0===Xa?null:Xa;Sb=void 0===Sb?null:Sb;ud.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ah&&(this.Dga=this.Ah.Ic("DialogShown","SaveToOneDriveUploadTime"));this.ZKb();this.J8=oa;this.zCa=this.sSc.create(M,Xa,Sb);this.Eh=Sb;this.JQ()};ig.prototype.JQ=
function(){ud.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.zCa.execute(Object(uf.a)(this,this.sSi,"onSaveToCloudUploadFinished"),Object(uf.a)(this,this.rSi,"onSaveToCloudUploadFailed"))};ig.prototype.sSi=function(M){this.pIa();this.gDa=!1;if(M&&M.data&&M.data.je){var oa=ph.d(M.data.je);var Xa=oa.Iu;if(oa.returnValue)if(Xa.StatusCode!==gh.a.fP&&Xa.StatusCode!==gh.a.jrb)ud.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.rS();
else{ud.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Xa.NewDocumentUrl&&""!==Xa.NewDocumentUrl?this.ZPa(Xa.NewDocumentUrl):this.$Pa()}catch(Sb){ud.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Sb.toString())}this.aFb()}else Xa={},ud.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Xa.ResponseData=eh.a.zeb(M.data.je),Xa)),this.rS()}else ud.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.rS()};ig.prototype.rSi=function(M){5!==M.data.status&&12!==M.data.status||this.gDa?(ud.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",M.data.status),this.pIa(),this.rS(),this.aFb()):(ud.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.gDa=!0,this.JQ())};ig.prototype.aFb=function(){this.Dga&&(this.Dga.stop(),this.Dga=null)};Object(pe.a)(ig,"UploadToCloudManager",null,[439]);xf.prototype.init=function(){Pd.AFrameworkApplication.ga.ra("SaveToCloudStorageUIIsEnabled")&&
this.tb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Pg()};xf.prototype.dispose=function(){};xf.prototype.ii=function(M){this.tb=M;this.tb.register(Eb,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Mc(function(){return new Eb(Pd.AFrameworkApplication.Hb,Sg.a.instance,Pd.AFrameworkApplication.sa.Qa)}).Cc();this.tb.register(wh,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Mc(function(){return new wh(Pd.AFrameworkApplication.ga)}).Cc();
this.tb.register(Vc,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Mc(function(){return new Vc(M.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),M.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.sa.vD)}).Cc();this.tb.register(ig,"Common.App.SaveToCloudStorage.UploadToCloudManager").Mc(function(){return new ig(M.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new Qh.a).create()},
function(){return new re},Pd.AFrameworkApplication.sa,Pd.AFrameworkApplication.sa.vD)}).Cc();this.tb.register(xd,"Common.App.SaveToCloudStorage.SaveToCloudManager").Mc(function(){return new xd(M.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Sg.a.instance,M.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.V1a,function(){return new re})}).Cc()};xf.main=function(){jg.a.instance.rj(new xf)};Qk.Object.defineProperties(xf.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(pe.a)(xf,"PackageManager",null,[4,5]);Qk.Object.defineProperties(mg,{eg:{configurable:!0,enumerable:!0,get:function(){return yh.a.Bn(mg.Uj,CommonUIStrings.l_SaveACopyFileName)}}});mg.Uj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(pe.a)(mg,"FileNameDialogHtml",null,[]);var Ng=yh.a;vm(bg,Ng);bg.prototype.AQ=function(M,oa,Xa){this.XRb=M;this.J8=Xa;M={};oa=(M.txtFileName=Sf.a.kr(Pd.AFrameworkApplication.am.yn),M.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,oa),M);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(uf.a)(this,this.g9b,"fileNameDialogHandler"),oa);ud.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
bg.prototype.g9b=function(M,oa){1!==M?ud.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(M=oa.txtFileName.trim(),ud.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),oa=Sf.a.s4(Pd.AFrameworkApplication.fileName),M&&""!==M&&""!==oa&&(M+=oa),this.fmb.Vna(this.XRb,this.J8,M,this.Eh))};Object(pe.a)(bg,"FileNameDialog",yh.a,[530]);Xf.prototype.create=function(M){return new bg(this.La,this.HX,this.fmb,M)};Object(pe.a)(Xf,"FileNameDialogFactory",
null,[509]);var ue=Og.StandardDialog;vm(Ze,ue);Ze.prototype.displayError=function(M){ud.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",M);this.Iz(M,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(uf.a)(this,this.yLd,"retryDialogHandler"))};Ze.prototype.yLd=function(M){1===M?(ud.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(Tf.a.saveACopy,2)):ud.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(pe.a)(Ze,"RetryDialog",Og.StandardDialog,[508]);vm(Rd,Vc);Rd.prototype.g7a=function(){return this.wb.ra("SaveACopyBrsIsEnabled")};Rd.prototype.gXe=function(){return Tf.a.saveACopy};Rd.prototype.S0b=function(){ei.a.EHd(Object(uf.a)(this,this.lWf,"saveToCloudActionDispatcher"));ei.a.q8c([new sg.a(Tf.a.saveACopy,kh.a.frame,0)],this.qtg.T3a())};Rd.prototype.KNf=function(){ud.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(pe.a)(Rd,"SaveACopyActor",Vc,
[]);vm(Mf,xd);Mf.prototype.onSuccess=function(M){M&&M.data&&M.data.folders?(ud.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Nog.create(this.Eh).AQ(M.data.folders[0].id,M.data.folders[0].name,M.data.folders[0].urls.viewInBrowser)):(ud.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.ui())};Mf.prototype.o6=function(M){M&&M.error&&"user_canceled"===M.error.code&&ud.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
xd.prototype.o6.call(this,M)};Mf.prototype.ui=function(){ud.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");xd.prototype.ui.call(this)};Object(pe.a)(Mf,"SaveACopyManager",xd,[]);vm(Wd,ig);Wd.prototype.jqd=function(){return!!this.Eh&&!!this.Eh.SaveEntryPoint&&"VersionHistory"===this.Eh.SaveEntryPoint.toString()};Wd.prototype.rS=function(){ud.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.jqd()){var M={};this.La.De(Tf.a.tKd,2,(M.FailureReason="Unknown",
M))}ig.prototype.rS.call(this)};Wd.prototype.$Pa=function(){ud.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.jqd()&&this.La.processAction(Tf.a.jtc,2);ig.prototype.$Pa.call(this)};Wd.prototype.ZPa=function(M){ud.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",M);this.jqd()&&this.La.processAction(Tf.a.jtc,2);ig.prototype.ZPa.call(this,M)};Wd.prototype.JQ=function(){var M=this;this.Eh&&"true"===this.Eh.SkipSaveToHost?ig.prototype.JQ.call(this):
32!==this.La.processAction(Tf.a.VQa,1)?(ud.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),ig.prototype.JQ.call(this)):this.La.De(Tf.a.VQa,2,[function(){ud.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");ig.prototype.JQ.call(M)},function(){ud.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");M.rS()}])};Object(pe.a)(Wd,"SaveACopyUploadToCloudManager",
ig,[]);tg.prototype.init=function(){Pd.AFrameworkApplication.ga.Tu(Object(uf.a)(this,this.kB,"onFullAppSettingsReady"))};tg.prototype.kB=function(){Pd.AFrameworkApplication.ga.ra("SaveACopyBrsIsEnabled")&&this.tb.resolve("Common.App.SaveACopy.SaveACopyActor").Pg()};tg.prototype.dispose=function(){};tg.prototype.ii=function(M){this.tb=M;this.tb.register(Wd,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Mc(function(){return new Wd(Pd.AFrameworkApplication.Hb,M.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new Qh.a).create()},function(){return new Ze(Pd.AFrameworkApplication.Hb)},Pd.AFrameworkApplication.sa,Pd.AFrameworkApplication.sa.vD)}).Cc();this.tb.register(Xf,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Mc(function(){return new Xf(Pd.AFrameworkApplication.Hb,Pd.AFrameworkApplication.sa.Qa,M.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).Cc();this.tb.register(Rd,"Common.App.SaveACopy.SaveACopyActor").Mc(function(){return new Rd(M.resolve("Common.App.SaveACopy.SaveACopyManager"),
M.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.sa.vD)}).Cc();this.tb.register(Mf,"Common.App.SaveACopy.SaveACopyManager").Mc(function(){return new Mf(M.resolve("Common.App.SaveACopy.FileNameDialogFactory"),M.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Sg.a.instance,M.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),Pd.AFrameworkApplication.ga,Pd.AFrameworkApplication.V1a,function(){return new Ze(Pd.AFrameworkApplication.Hb)})}).Cc()};
tg.main=function(){jg.a.instance.rj(new tg)};Qk.Object.defineProperties(tg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(pe.a)(tg,"PackageManager",null,[4,5]);var Bg;(function(M){M[M.myFiles=0]="myFiles";M[M.recent=1]="recent";M[M.currentFolder=2]="currentFolder";M[M.yourPhone=3]="yourPhone"})(Bg||(Bg={}));Object(pe.b)("SharedFilePickerLandingLocation",Bg);eg.prototype.R1a=function(M){this._initialized||(M.Xn(Jf.a.rNf),M.Jl(Jf.a.rNf,Object(uf.a)(this,
this.zRi,"onReceivedPickerResponse")),this._initialized=!0)};eg.prototype.zed=function(M){var oa=this;return this.fLa=new Promise(function(Xa,Sb){var xc={};xc[Ag.a.vZi]=M;oa.aab=function(jd,vd){""===vd?(ud.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Xa(jd)):("Canceled"===vd?ud.ULS.sendTraceTag(572548164,306,50,vd):ud.ULS.sendTraceTag(556901065,306,10,vd),Sb(vd))};oa.qkd.execute(function(jd){oa.R1a(jd);jd.Rj(Jf.a.zWi,xc)})})};eg.prototype.zRi=function(M){this.aab(M.Values[Ag.a.unj],
void 0===M.Values[Ag.a.rDd]||null===M.Values[Ag.a.rDd]?"":M.Values[Ag.a.rDd])};eg.prototype.zqd=function(){return Pd.AFrameworkApplication.ga.ra("UiHostCommonFilePicker")};eg.prototype.ZDe=function(M,oa,Xa,Sb,xc,jd,vd){var ae=void 0===ae?null:ae;var Ie={};Ie[Ag.a.gnj]=M;Ie[Ag.a.titleText]=oa;Ie[Ag.a.iJg]=Xa;Ie[Ag.a.jJg]=Sb;Ie[Ag.a.kJg]=!1;Ie[Ag.a.dgh]=!0;Ie[Ag.a.EBh]=xc;Ie[Ag.a.zZi]=jd;Ie[Ag.a.yZi]=Bg[vd];ci.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Ie[Ag.a.AZi]="Dark");ae&&
(null!=ae.aWc&&(Ie[Ag.a.aWc]=ae.aWc),null!=ae.hld&&(Ie[Ag.a.hld]=ae.hld));return Ie};Object(pe.a)(eg,"SharedFilePickerManager",null,[437]);he.prototype.ii=function(M){this.tb=M;M.register(eg,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").Cc().Mc(function(){return new eg(M.pc("Postmessage.IHostPostmessenger"))})};he.prototype.init=function(){var M=this;Pd.AFrameworkApplication.ga.Tu(function(){M.zxb()})};he.prototype.zxb=function(){this.tb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
he.prototype.dispose=function(){};he.main=function(){jg.a.instance.rj(new he)};Qk.Object.defineProperties(he.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(pe.a)(he,"SharedFilePickerPackage",null,[4,5]);var ng=b(1267),mh=b(974);rg.prototype.yle=function(M){var oa=!1;M&&(M.o3c(),M.xSg&&(oa=!1));return oa};rg.prototype.l5g=function(){var M=Pd.AFrameworkApplication.sa.Qa;M=new ng.a(M.Oj,mh.a.gcc(),!1,1===M.ica);this.yle(M)&&ud.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};rg.prototype.t4b=function(M,oa,Xa,Sb,xc,jd){M=new ng.a(M,Xa,Sb,oa,xc,jd);this.yle(M)&&ud.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};rg.prototype.mah=function(){var M=Pd.AFrameworkApplication.sa.Qa,oa=Pd.AFrameworkApplication.ga,Xa=M.Oj,Sb=1===M.ica;if(oa.ra(mh.a.w1h(Xa))){var xc=mh.a.gcc(),jd=8<Ff.a.g5a;if(2!==Xa||2!==xc||!Sb){oa=oa.ra(mh.a.x1h(Xa));var vd=M.MVf(),ae=function(){return M.dC};oa&&!mh.a.Zod(mh.a.rdd(Xa))&&this.t4b(Xa,Sb,xc,jd,ae,vd)}}};
rg.prototype.init=function(){var M=Pd.AFrameworkApplication.ga,oa=M.ra("WildFireChromeExtensionEnabled");M=M.ra("WildFireChromeExtensionBar")&&oa;mh.a.exc&&M&&!mh.a.Zod(mh.a.Fye)?this.l5g():(document.body&&mh.a.Fzj&&this.mah(),Pd.AFrameworkApplication.Hb.hc(Tf.a.Wsd,kh.a.frame,Object(uf.a)(this,this.Wsd,"launchWildFireBusinessBar")))};rg.prototype.Wsd=function(M,oa,Xa,Sb,xc){if(1===Xa)return 32;if(!xc)return 8;this.t4b(xc.app,xc.mode,xc.platform,xc.useTwoButton,null,null);return 32};rg.prototype.dispose=
function(){};rg.prototype.ii=function(){};rg.main=function(){jg.a.instance.rj(new rg)};Qk.Object.defineProperties(rg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(pe.a)(rg,"PackageManager",null,[4,5]);var gg=b(214),ai=b(1251),ih=gg.a;vm(vf,ih);vf.prototype.create=function(){this.Gb(this.$.da.Aa(5)||new ai.a(this.$,!this.$.cba))};vf.ka=function(M){M.da.Ha(4,new vf(M))};Object(pe.a)(vf,"BusinessBarManagerFactory",gg.a,[]);var rf=b(10),Rf;"undefined"==
typeof Rf&&(Rf={});window.MSOJS=Rf;Rf.bgb=function(){function M(){return vd()&&(Fj()||3<=(Gh()?Pj("version/"):0))}function oa(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Xa(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Sb(){ul||(ul=!0,vl=xc("Windows Phone"))}function xc(Hf){Hf=(new RegExp(Hf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var ah=-1;return null!=Hf&&2<=Hf.length&&(ah=parseFloat(Hf[1]),isNaN(ah)&&(ah=-1)),ah}function jd(){return"function"==
typeof navigator.msLaunchUri&&!Xa()&&!ij()&&!ae()}function vd(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function ae(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Ie(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Zf(){return Ie()?8==window.document.documentMode:!1}function Vg(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Gh(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}
function pi(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function ij(){var Hf=window.navigator.userAgent.toLowerCase();return 0<=Hf.indexOf("android")&&0<=Hf.indexOf("chrome")}function Fj(){return 3<=(Vg()?Pj("firefox/"):0)}function Pj(Hf){var ah=window.navigator.userAgent.toLowerCase(),Xh=ah.indexOf(Hf),Kh,Ei;return 0<=Xh?(Kh=Xh+Hf.length,Ei=ah.length,parseInt(ah.substring(Kh,Ei))):0}function Gi(Hf,ah,Xh,Kh,Ei){if(Kh&&null!=ah)ah();else if(jd())navigator.msLaunchUri(Hf,
ah,Xh);else if(!(pi()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&vd())||ae())hk(Hf,ah,Xh);else if(pi()&&Ei)a:{try{window.open(Hf,"_self")}catch(Ti){null!=Xh&&Xh();break a}null!=ah&&ah()}else kj(Hf,ah,Xh)}function kj(Hf,ah,Xh){var Kh=document.getElementById("OICLinkTag"),Ei;null==Kh&&(Kh=document.createElement("a"),Kh.id="OICLinkTag",Kh.style.visibility="hidden",Kh.href="",Kh.target=0==(Yi.Options&qk.SupportsTopTargetNavigation)||
Yi.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Kh),null!=Kh.addEventListener&&Kh.addEventListener("click",function(Ti){null!=Ti.stopPropagation&&Ti.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Ei=function(Ti){var Mi=document.createEvent("MouseEvent");return Mi.initMouseEvent(Ti,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Mi},Ei.prototype=Event.prototype,window.MouseEvent=Ei),Kh.href=Hf,Kh.dispatchEvent(new MouseEvent("click"))}catch(Ti){null!=Xh&&Xh();return}null!=
ah&&ah()}function hk(Hf,ah,Xh){var Kh=document.getElementById("OICFrame");null==Kh&&(Kh=document.createElement("iframe"),Kh.className="ObjectInDialog",Kh.style.visibility="hidden",Kh.src="about:blank",document.body.appendChild(Kh),Kh.id="OICFrame");try{Kh.contentWindow.location.href=Hf}catch(Ei){null!=Xh&&Xh();return}null!=ah&&ah()}function vk(Hf){return 0!=(Hf.Options&qk.SkipProtocolHandler)||Zf()}function Bk(Hf){return Hf===$k.ReadOnly||Hf===$k.ReadWrite}function Vk(Hf,ah,Xh,Kh){var Ei,Ti;try{if(Ei=
new ActiveXObject(Ua),Ei)return Ti=Ei.ViewDocument3(window.self,Hf,ah,Kh),Ti?(Xk(Jk.O14ActiveX),cj.None):cj.Failed}catch(Mi){}if(qk.O14Only===(Xh&qk.O14Only))return Yi.DescriptiveUnattemptedEnums?cj.O14AttemptFailure:cj.Unattempted;try{if(Ei=new ActiveXObject(e),Ei)return Ti=Ei.ViewDocument3(window.self,Hf,ah,Kh),Ti?(Xk(Jk.O12ActiveX),cj.None):cj.Failed}catch(Mi){}if(qk.O12UpOnly===(Xh&qk.O12UpOnly))return Yi.DescriptiveUnattemptedEnums?cj.O12UpOnlyFail:cj.Unattempted;try{if(Ei=new ActiveXObject(C),
Ei)return Ti=Bk(ah)?Ei.ViewDocument2(window.self,Hf,Kh):Ei.EditDocument2(window.self,Hf,Kh),Ti?(Xk(Jk.O11ActiveX),cj.None):cj.Failed}catch(Mi){}return Yi.DescriptiveUnattemptedEnums?cj.ActiveXUnattempted:cj.Unattempted}function el(Hf,ah,Xh,Kh,Ei){var Ti,Mi,Yj;Hf==zj.Visio&&Xh==$k.ReadWrite&&(Xh=$k.WriteOnly);Hf=Ei;(Kh=Kh||Xa()&&!(Sb(),8<=vl))||(Ti="",Ti+=Bk(Xh)?we+$e:Gf,Ti+=ag,Hf+=fl(Ti));Hf+=fl(ah);Yi.NewTelemetryDataIsEnabled&&(Mi=-1!==Hf.indexOf("?")?"&":"?",Mi+=Yi.SessionOrigin?"OR=wac-"+Yi.SessionOrigin+
"&":"",Mi+=Yi.ClickTime?"CT="+Yi.ClickTime+"&":"",Mi+=Yi.CorrelationId?"CID="+Yi.CorrelationId:"",Mi="?"!=Mi?Mi:"",Mi="&"!=Mi.slice(-1)?Mi:Mi.slice(0,-1),Hf+=fl(Mi));ah=window.location.href;Xh=Pg;Kh=ah.toLowerCase().indexOf("&"+Xh+"=");var Gj;Xh=-1==Kh?void 0:(Yj=Kh+(Xh.length+2),Gj=ah.indexOf("&",Yj),-1==Gj)?ah.substr(Yj):ah.substring(Yj,Gj);if(null!=Xh&&"undefined"!=typeof Xh){Yj="";try{Yj=decodeURIComponent(Xh)}catch(Kk){}0<Yj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Yj)&&
(Hf+=Nf,Hf+=Yj)}return Hf}function kl(Hf,ah,Xh,Kh,Ei,Ti){var Mi=nl(Hf),Yj;return null==Mi?(ck(Yi.DescriptiveUnattemptedEnums?cj.ProtocolHandlerIsNull:cj.Unattempted,Yi.Application),!1):(Yj=el(Hf,ah,Xh,Kh,Mi),Gi(Yj,ll,pl,Ei,Ti),!0)}function fl(Hf){if(vd()&&pi()){var ah="";try{ah=decodeURI(Hf)}catch(Xh){}if(ah==Hf)return encodeURI(Hf)}return Hf}function ll(){Xk(Jk.ProtocolHandler)}function pl(){Yi.Options|=qk.SkipProtocolHandler;sl(Yi,vj,qj)}function ml(){null!=Xj&&Xj(Jk.RoamingProtocolHandler)}function ql(){null!=
Yk&&Yk(cj.ControlNeeded)}function rl(){var Hf=document.getElementById(Mc),ah;if(null==Hf){if(ah=J,vd()&&3<=(Gh()?Pj("version/"):0)&&wk(ja,!0)&&(ah=ja),!wk(ah,!0))if(vd()&&wk(bc,!0))ah=bc;else return null;Hf=document.createElement("object");Hf.id=Mc;Hf.type=ah;Hf.style.width="0px";Hf.style.height="0px";Hf.style.setProperty("visibility","hidden","");document.body.appendChild(Hf);Hf=document.getElementById(Mc)}return Hf}function wk(Hf,ah){var Xh=window.navigator.mimeTypes,Kh;return null==Xh?!1:(Kh=Xh[Hf],
Kh)?ah&&!Kh.enabledPlugin?!1:!0:!1}function Wk(Hf){try{if(null!=new ActiveXObject(Hf))return!0}catch(ah){}return!1}function gl(Hf){switch(Hf){case zj.OneNote:return yd;default:return""}}function nl(Hf){if(Hf!=zj.OneNote&&Xa()&&!(Sb(),8<=vl))return"office:";switch(Hf){case zj.Excel:return"ms-excel:";case zj.OneNote:return"onenote:";case zj.PowerPoint:return"ms-powerpoint:";case zj.Visio:return"ms-visio:";case zj.Word:return"ms-word:";case zj.Project:return"ms-project:";case zj.Publisher:return"ms-publisher:";
case zj.Infopath:return"ms-infopath:";case zj.Access:return"ms-access:";default:return""}}function tl(Hf){switch(Hf){case zj.Excel:return"root\\office15\\excel.exe";case zj.PowerPoint:return"root\\office15\\powerpnt.exe";case zj.Visio:return"root\\office15\\visio.exe";case zj.Word:return"root\\office15\\winword.exe";case zj.Project:return"root\\office15\\winproj.exe";case zj.Publisher:return"root\\office15\\mspub.exe";case zj.Infopath:return"root\\office15\\infopath.exe";case zj.Access:return"root\\office15\\msaccess.exe";
default:return null}}function sl(Hf,ah,Xh){if(Yi=Hf,vj=ah,qj=Xh,Hf.DocumentUrl){var Kh=Xh=ah=Hf.DocumentUrl;try{Kh=decodeURIComponent(Hf.DocumentUrl)}catch(Kk){}try{Xh=encodeURI(Hf.DocumentUrl)}catch(Kk){}ah=ah+""+Hf.CorrelationIdForWinClient;Kh+=Hf.CorrelationIdForWinClient;Xh+=Hf.CorrelationIdForWinClient;Hf.Mode===$k.ReadWrite&&qk.CheckoutRequired===(Hf.Options&qk.CheckoutRequired)&&(Hf.Mode=$k.ForceCheckout);qk.HostIsEditOnly===(Hf.Options&qk.HostIsEditOnly)&&(Hf.Mode=$k.WriteOnly);if(vk(Hf)?
0:vd()&&(Hf.Application==zj.OneNote||wk(Aa,!1)||wk(gb,!1))||jd()||ij()||!(M()||Fj()||"ActiveXObject"in window&&!Xa()||pi())||15<=Pk())kl(Hf.Application,Hf.EncodeUrl?Xh:ah,Hf.Mode,Hf.Application==zj.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen);else{var Ei;if(Ei=Zf())a:{var Ti=Hf.EncodeUrl?ah:Kh,Mi=Hf.Mode,Yj=gl(Hf.Application);try{Ei=(new ActiveXObject(ka)).ViewDocument3(window.self,Ti,Mi,Yj);break a}catch(Kk){}Ei=!1}if(Ei)Xk(Jk.O15ActiveX);else{if(M()||Fj()){var Gj=Hf.EncodeUrl?ah:
Kh;Kh=Hf.Mode;Ei=gl(Hf.Application);Ti=rl();if(null==Ti)Gj=Yi.DescriptiveUnattemptedEnums?cj.PluginIsNull:cj.Unattempted;else{Mi=!1;try{Mi=Ti.ViewDocument3(window.self,Gj,Kh,Ei)}catch(Kk){}if(!Mi)try{Mi=Bk(Kh)?Ti.ViewDocument2(window.self,Gj,Ei):Ti.EditDocument2(window.self,Gj,Ei)}catch(Kk){}Gj=Mi?(Xk(Jk.NpapiPlugin),cj.None):cj.Failed}}else{try{Gj=new ActiveXObject(Hc),null!=Gj&&Gj.SaveSSOCreds()}catch(Kk){}Gj=Vk(Hf.EncodeUrl?ah:Kh,Hf.Mode,Hf.Options,gl(Hf.Application))}if(Gj!=cj.None){if(Kh=Hf.CouldUseRoamingApps)Zk||
(Zk=!0,ol=xc("Windows NT")),Kh=6.1<=ol&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Ie()||Fj()||pi());if(Kh&&Hf.Application!=zj.OneNote){if(!Rf.bgb.LZj()){ck(cj.ControlNeeded,Yi.Application);return}if(Hf.RoamingAppsLauncher){"undefined"==typeof Hf.RoamingAppsLauncher||null==Hf.RoamingAppsLauncher?ck(Yi.DescriptiveUnattemptedEnums?cj.RoamingLauncherIsNull:cj.Unattempted,Yi.Application):"undefined"==typeof Hf.RoamingBitsUrl||null==Hf.RoamingBitsUrl?Rf.bgb.QZj(Hf.DocumentUrl,Hf.RoamingAppsLauncher,
Hf.Application,Hf.ApplicationParameters,vj,qj):Rf.bgb.ujg(Hf.DocumentUrl,Hf.RoamingAppsLauncher,Hf.RoamingApplicationExe,Hf.ApplicationParameters,Hf.RoamingPlatform,Hf.RoamingBitsUrl,vj,qj);return}if(!Hf.ContinueIfLauncherIsNull){ck(cj.LauncherNeeded,Yi.Application);return}}qk.NoProtocolHandlerFallback==(Hf.Options&qk.NoProtocolHandlerFallback)||vk(Hf)||Ie()||vd()&&!(Yi.DescriptiveUnattemptedEnums?Gj>=cj.O14Unattempted&&Gj<=cj.DocumentUrlIsNull:Gj==cj.Unattempted)?ck(Gj,Yi.Application):kl(Hf.Application,
Hf.EncodeUrl?Xh:ah,Hf.Mode,Hf.Application==zj.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen)}}}}else ck(Yi.DescriptiveUnattemptedEnums?cj.DocumentUrlIsNull:cj.Unattempted,Yi.Application)}function Xk(Hf){null!=vj&&vj(Hf)}function ck(Hf,ah){"undefined"==typeof ah&&(ah=null);null!=qj&&qj(Hf,ah)}function Pk(){var Hf=0;if(M()||Fj()||pi()){var ah=rl();try{null!=ah&&(Hf=ah.GetOfficeVersion())}catch(Xh){}}else Wk(ka)?Hf=15:Wk(Ua)?Hf=14:Wk(e)?Hf=12:Wk(C)&&(Hf=11);return Hf}function G(){return vd()&&
(wk(J,!0)||wk(ja,!0))}var ka="SharePoint.OpenDocuments.5",Ua="SharePoint.OpenDocuments.4",e="SharePoint.OpenDocuments.3",C="SharePoint.OpenDocuments.2",J="application/x-sharepoint",ja="application/x-sharepoint-webkit",Aa="application/x-sharepoint-protocolhandler",gb="application/x-sharepoint-webkit-protocolhandler",bc="application/officelive",Mc="npSharePointPlugin",Hc="IDBHO.IDBHOCtrl",yd="OneNote.Notebook",we="ofv|",$e="ofc|",Gf="ofe|",ag="u|",Nf="|f|",Pg="wdlor",Jh="",jj="",Xi="",vj,qj,Xj,Yk,Yi,
Zk,ol,ul,vl,$k={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},qk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},cj={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
Jk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},zj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:$k,OpenDocumentOptions:qk,OpenDocumentFailureType:cj,OpenDocumentControl:Jk,OfficeApplication:zj,EditDocumentInClient:sl,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=zj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Pk,
IsO14MacPluginInstalled:G,OfferOfficeInDialog:function(){return oa()&&11>=Pk()},OfferOfficeNoIntrusive:function(){return oa()&&15>Pk()},OfferMacOffice:function(){return vd()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!G()},InstallRoamingControl:function(){Vg()?window.InstallTrigger.install({Office:{URL:jj}}):hk(Xi,null,null)},CanUseRoamingControl:function(){var Hf,ah,Xh;if(jd())return!0;if(pi())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(Vg())return Hf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Hf),ah=document.createEvent("Events"),ah.initEvent("RoamingOfficeInstalled",!0,!1),Hf.dispatchEvent(ah),!!Hf.getAttribute("installed");if(Ie())try{return Xh=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Xh.HrExists()}catch(Kh){}return!1},InitUrls:function(Hf,ah,Xh){Jh=Hf;jj=Xh;Xi=ah},LaunchRoamingApps:function(Hf,ah,Xh,Kh,Ei,Ti){Rf.bgb.ujg(Hf,ah,tl(Xh),Kh,"x86",Jh,Ei,Ti)},LaunchRoamingApps2:function(Hf,
ah,Xh,Kh,Ei,Ti,Mi,Yj){var Gj="",Kk;if(null!=Kh&&(Gj+=" "+Kh),null!=Hf&&(Gj+=' "'+Hf+'"'),jd()||pi())Xj=Mi,Yk=Yj,Mi='office: "'+(Ti+'" "')+(Xh+'" "ROAMING"'),Mi+=' "'+ah+'"',Mi+=' "'+Ei+'"',Mi+=" "+Gj,Gi(Mi,ml,ql,!1,!1);else if(Vg())Hf=document.createElement("RoamingExtensionElement"),Hf.setAttribute("cabUrl",Ti),Hf.setAttribute("app",Xh),Hf.setAttribute("licensingEntitlements",ah),Hf.setAttribute("platform",Ei),Hf.setAttribute("args",Gj),document.documentElement.appendChild(Hf),ah=document.createEvent("Events"),
ah.initEvent("RoamingOfficeLaunch",!0,!1),Hf.dispatchEvent(ah),null!=Mi&&Mi(Jk.RoamingFFExtension);else if(Ie()){if(Kk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Kk)try{Kk.HrConfigureSingle(Ti,Xh,ah,Ei,Gj),null!=Mi&&Mi(Jk.RoamingActiveX)}catch(zl){}}else null!=Yj&&Yj(cj.Failed)},ShouldShowDialog:function(){return!Xa()},NavigateToUrlUsingClickingOnATag:kj,OpenDocumentWithProtocolHandler:kl,OpenDocumentWithProtocolHandlerNoCallBack:function(Hf,ah,Xh,Kh){var Ei=nl(Hf),Ti;return null==
Ei?(ck(Yi.DescriptiveUnattemptedEnums?cj.ProtocolHandlerNoCallbackIsNull:cj.Unattempted,Yi.Application),!1):(Ti=el(Hf,ah,Xh,Kh,Ei),Gi(Ti,null,null,!1,!1),!0)}}}();Rf.ClientUtils=Rf.bgb;var ch=b(817),vg=b(56),oh=b(35),h=b(175);mf.prototype.Zc=function(){return!1};mf.prototype.executeCommand=function(M,oa,Xa){return 2!==this.Fi.De(Tf.a.newDocument,2,Xa)?Wg.Task.Ta(!0):h.a(oa.command)};mf.prototype.Kc=function(M,oa){return 1056925771===oa.command};mf.prototype.gd=function(M,oa,Xa){M=!0;switch(oa){case "PopulateNewMenu":this.Fi&&
this.Fi.De(Tf.a.Mpc,2,Xa);break;default:M=!1}return M};Object(pe.a)(mf,"CreateNewCommandHandler",null,[239]);var Bb=ch.a;vm(jf,Bb);jf.prototype.Pd=function(){var M=this,oa=vg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),Xa=vg.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.ub);oh.TaskExtensions.Ba(oh.TaskExtensions.we([oa,Xa],this.ma),function(){M.Gd([new mf(Pd.AFrameworkApplication.Hb)])},this.ma,3)};jf.ka=function(M){ch.a.he(87,new jf(M))};Object(pe.a)(jf,"CreateNewCommandHandlerFactory",
ch.a,[]);var tc=b(1247),X=b(879),va=b(309),P=b(194),k=b(281),E=b(4),L=b(150),aa=b(96),na=b(77),sb=b(73),Lb=b(369),Kc=b(164),ad=b(57),ha=b(81),Qa=b(318),Pb=b(605);ie.prototype.Jse=function(){};ie.prototype.Z6c=function(){this.vtg?xe.a.downloadFile(this._url):xe.a.vf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};ie.prototype.dispose=function(){};Object(pe.a)(ie,"OpenUrlInTabDialogDownloadBehavior",null,[36,2]);var rc=b(274),gd=Og.StandardDialog;vm(ze,gd);ze.prototype.kXc=
function(){this.Tl&&(this.JVa||(this.JVa=Object(uf.a)(this,this.QGi,"onActionButtonClicked"),this.yy.qa(kg.a.click,this.GB,this.JVa)),this.KVa||(this.KVa=Object(uf.a)(this,this.RGi,"onActionButtonKeyUp"),this.ke.qa(kg.a.Xd,this.GB,this.KVa)));gd.prototype.kXc.call(this)};ze.prototype.QGi=function(M){this.URe(M);return!0};ze.prototype.RGi=function(M){return this.Gjf(M,Object(uf.a)(this,this.URe,"executeDismissActionButtonFromArgs"))};ze.prototype.URe=function(M){this.Tl&&this.Tl.submit();this.rua(M.Ub)};
ze.prototype.Rtd=function(){};ze.prototype.IJe=function(){this.Cmf();this.Tl?this.Tl.submit():this.oRb.Z6c();return!0};ze.prototype.fjc=function(){return!1};ze.prototype.dispose=function(){this.oRb.dispose();this.Khb&&(Pd.AFrameworkApplication.sa.oX.za(kg.a.click,this.Khb,Object(uf.a)(this,this.IJe,"downloadLinkClicked")),this.Khb=null);this.YX&&(Pd.AFrameworkApplication.sa.oX.za(kg.a.click,this.YX,Object(uf.a)(this,this.fjc,"learnMoreLinkClicked")),this.YX=null);this.yy&&this.JVa&&(this.yy.za(kg.a.click,
this.GB,this.JVa),this.JVa=null);this.ke&&this.KVa&&(this.ke.za(kg.a.Xd,this.GB,this.KVa),this.KVa=null);gd.prototype.dispose.call(this)};ze.prototype.GMf=function(){this.Tl&&(document.body.appendChild(this.Tl),this.Tl.submit(),document.body.removeChild(this.Tl))};ze.prototype.$v=function(M){1===M&&(this.Rtd(),this.Tl?ze.vy&&this.GMf():this.oRb.Z6c());this.dispose()};Qk.Object.defineProperties(ze.prototype,{s$e:{configurable:!0,enumerable:!0,get:function(){return null}},EVd:{configurable:!0,enumerable:!0,
get:function(){return null}},SNa:{configurable:!0,enumerable:!0,get:function(){return null}},JAb:{configurable:!0,enumerable:!0,get:function(){return null}},P7a:{configurable:!0,enumerable:!0,get:function(){return null}},Kqf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},I4c:{configurable:!0,enumerable:!0,get:function(){return null}},IVc:{configurable:!0,enumerable:!0,get:function(){return null}},Zoe:{configurable:!0,
enumerable:!0,get:function(){return null}}});Qk.Object.defineProperties(ze,{vy:{configurable:!0,enumerable:!0,get:function(){return Pd.AFrameworkApplication.sa.Qa.qw&&Pd.AFrameworkApplication.sa.Qa.Rgf}},Twb:{configurable:!0,enumerable:!0,get:function(){return ze.K7d},set:function(M){ze.K7d=M}}});ze.K7d=!1;Object(pe.a)(ze,"ADialogWithLinkToResource",Og.StandardDialog,[]);var hd=b(413),Bd=b(313),qe=b(14);vm(Jd,ze);Jd.prototype.Amf=function(){ud.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};
Jd.prototype.Cmf=function(){ud.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};Jd.prototype.fjc=function(){hd.Redirect.showHelp(Bd.a.lGi);return!0};Qk.Object.defineProperties(Jd.prototype,{SNa:{configurable:!0,enumerable:!0,get:function(){return qe.a.instance.Va(410)}},mjc:{configurable:!0,enumerable:!0,get:function(){return qe.a.instance.Va(411)}},ljc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},JAb:{configurable:!0,
enumerable:!0,get:function(){return"#"}},P7a:{configurable:!0,enumerable:!0,get:function(){return qe.a.instance.Va(412)}},Kqf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(pe.a)(Jd,"DownloadACopyAsOdsDialog",ze,[]);Dd.prototype.Jse=function(M){this.dialog=M};Dd.prototype.Z6c=function(){this.IGi.LFf(-1059172980)};Dd.prototype.dispose=function(){this.Ab.YGb(this.cxf)};Object(pe.a)(Dd,"DownloadACopyAsOdsDialogDownloadBehavior",null,[36,2]);Object(pe.a)(Qc,"MacroRecorderWorkbookCalculationModeSetPayload",
null,[106]);Object(pe.a)(ec,"MacroRecorderWorkbookRecalculatedPayload",null,[106]);var ef=b(206),nf=b(117),kf=b(1),Af=b(304);Qk.Object.defineProperties(Pf,{hWi:{configurable:!0,enumerable:!0,get:function(){return Pf.gWi}}});Pf.gWi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(pe.a)(Pf,"OpenInAppDialogCopyHtml",null,[]);var Jg=b(370),fh=Af.a;vm(yf,fh);yf.prototype.openUrl=function(M,oa){var Xa=document.getElementById("link");Xa||(Xa=document.createElement("a"),Xa.id="link",Xa.style.visibility="hidden",Xa.href="",document.body.appendChild(Xa));Xa.target=oa;Xa.href=M;Xa.click()};yf.prototype.Gjg=function(){var M=this;ud.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.Wa(this.$.da,21,137,1),function(oa){var Xa=
{};Xa.OpenInAppUrl=M.nOa;Xa.StoreUrl=M.Rq;oa.result.Rj("UI_OpenInMobileApp",Xa)},this.$.ma)};yf.prototype.iWi=function(){ud.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};yf.prototype.Bh=function(){this.eg=yh.a.Bn(Pf.hWi,qe.a.instance.fa(655),qe.a.instance.fa(656),Pd.AFrameworkApplication.JC,Jg.getImageClass(Pd.AFrameworkApplication.ga.Ua("AppIcon")),qe.a.instance.fa(657));this.Ve="OpenInAppDialog";this.kc=5;this.initializeAndShow("",this.iWi.bind(this),null);this.Gz(this.XH)};
yf.prototype.mv=function(M){fh.prototype.mv.call(this,M);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.XH=document.getElementById("LinkToInstall");ef.a.instance.qa(kg.a.click,this.XH,this.XCb);nf.KeyInputManager.instance.qa(kg.a.Xd,this.XH,this.cma)};yf.prototype.dispose=function(){this.XH&&(ef.a.instance.za(kg.a.click,this.XH,this.XCb),nf.KeyInputManager.instance.za(kg.a.Xd,this.XH,this.cma),this.XH=null);fh.prototype.dispose.call(this)};Qk.Object.defineProperties(yf.prototype,
{Bc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(pe.a)(yf,"OpenInAppDialogCopy",Af.a,[]);var Oh=b(26),Qg=b(27),fi=b(353),Dg=b(8),lh=b(272),zg=b(19),Ah=b(41),Ui=b(245),xi=b(462),Y=b(377),Ra=b(48),zb=b(6),gc=b(136),bd=b(1119),Id=b(79),Vd=b(33),ve=b(359),Pe=b(247);Kf.prototype.TQ=function(M,oa){M=Qg.a.jd(12,1,658,0,0,0,"Blank");M.Description=String.format(qe.a.instance.fa(659),oa);return M};Kf.prototype.B$b=function(M){switch(M){case 1:case 2:return 0;default:return 2}};
Object(pe.a)(Kf,"ReloadCloseConfirmation",null,[113]);var We=b(145),Vf=b(606),$f=b(65),Hg=P.a;vm(ye,Hg);ye.prototype.Zc=function(){return!1};ye.prototype.executeCommand=function(M,oa,Xa,Sb){var xc=this,jd=this.F6b,vd=this.$,ae=oa.command,Ie=this.openInExcelOperation,Zf=this.$.Jb,Vg=Xa.SourceControlId;vd.Kk.xme(ae);M=null;switch(ae){case 1455037301:this.$.s5?Ie.kCe():Ie.C2c();break;case -2044628748:case 2004484710:this.$.s5?Ie.kCe():Ie.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===
Vg?(this.hBb("CellLongPress"),ud.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.hBb("PencilIcon"),ud.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case -2028960985:Ie.q6f();break;case -1059172980:new Jd(Ie.kve(ae),new Dd(Ie,vd.Ab));break;case -1285148982:this.clientWorkflow.rd.activityState[Vd.a.HTc]=
!0;this.kAc(!1);break;case -75280711:this.kAc(!1);break;case -455164169:this.kAc(!0);break;case -1388494670:this.$.da.Za(400,function(kj){kj.ozi();xc.kAc(!1)});break;case 810888577:Pd.AFrameworkApplication.qk=(new Date).getTime();ud.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",Pd.AFrameworkApplication.qk);break;case -1804063550:case -974518828:oa=0;E.a.aCd in Xa&&(oa=Xa[E.a.aCd]);Ie.LFf(ae,oa);break;case -1339961039:oa=!1;Xa&&E.a.UHb in Xa&&
(oa=Xa[E.a.UHb]);this.reloadWorkbook(!1,oa);break;case -8805455:var Gh=this.workbookContext;vd.isEditMode||(ye.Nze(vd),M=oh.TaskExtensions.Ba(this.bK.value,function(kj){kj=kj.result;var hk=kj.isEnabled();hk&&Pb.a(kj,Jf.a.copyAndEdit,ad.a.Rf.YYe(),xc.$.ea.oh.get(2))?ud.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):hk&&Pd.AFrameworkApplication.gfg?(hk={},hk[tc.a.TEd]=Pd.AFrameworkApplication.userSessionId,
hk[Pd.AFrameworkApplication.KBi]=Oh.a.Ra.Lb.getTime().toString(),ud.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),kj.Rj(Jf.a.editMode,hk)):jd.CopyAndEditUrl?xc.G3g():(xc.oc.supportsEditing||Gh.EditUrl)&&xc.reloadWorkbookInEditMode()},this.ma,3));break;case -723527778:vd.isEditMode&&(ye.Nze(vd),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var pi=vd.na.ta.$b(),
ij=-1355155015===ae?1:0,Fj=function(){return new ec(ij)};M=Lb.a(this.$.userOperationManager,function(kj,hk,vk){return ha.V(vd.na.ta,ij,null,kj,hk,vk,null,pi)},function(kj){return new Kc.a(128,0,kj,void 0,Fj)},oa);zg.g(vd).Gh.VG(!1);break;case -1158102843:M=zg.g(vd).Gh.recalcSheet(oa);zg.g(vd).Gh.VG(!1);break;case -988468372:if(kf.EwaSettings.la(306))if(Sb=parseInt(Xa[na.a.nd],10),0<=Sb&&3>Sb)this.setCalculationMode(oa,Sb);else return ud.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",
Xa[na.a.nd]),h.a(ae);break;case 257398710:L.a.ntw(jd.ReportAbuseUrl,vd);break;case 1800405051:this.Wkj();break;case -48469327:this.saveACopy();break;case 214430355:oa=!1;Xa&&E.a.J7c in Xa&&(oa=Xa[E.a.J7c]);if(!this.Nyj(oa,Xa))break;Pd.AFrameworkApplication.n5?this.businessBar.ig(40,null):this.businessBar.ig(oa?22:23,null);break;case 1389557314:M=oh.TaskExtensions.Ba(this.bK.value,function(kj){Pb.a(kj.result,Jf.a.FBh,null,xc.$.ea.oh.get(6))||L.a.ntw(jd.FileVersionUrl,vd)},this.ma,3);break;case 2145659238:this.closeWorkbook();
break;case 1773624819:Vg===Zf+E.a.xjf?Ie.dsi():Ie.csi();break;case 512141517:Vg===Zf+E.a.wjf?Ie.nsi():Ie.msi();break;case -1224038235:var Pj=X.a.On in Xa?!Xa[X.a.On]:aa.j(vd.ea.workbookContext.Options);Xa[X.a.Description]=Pj?qe.a.instance.fa(564):qe.a.instance.fa(565);M=Lb.a(this.$.userOperationManager,function(kj,hk,vk){var Bk=xc.$.na.ta,Vk=Bk.Na(9,null);Vk.isReadOnlyRecommended=!Pj;return ha.i(Bk,"SetReadOnlyRecommended",Vk,kj,hk,vk,null,0)},function(kj){return new Kc.a(129,0,kj)},oa);break;case 1118926154:if(this.$.isEditMode){var Gi=
new Ph.a;this.$.da.Za(53,function(kj){kj?(kj.Hm.Yri(xc.$.Jb+E.a.Mrd),Gi.setResult(!0)):ud.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});M=Gi.task}break;case -1698025133:Ie.openInBrowser();break;case 520859864:M=oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.Wa(this.$.da,393,394,Sb.Mja()),function(kj){kj.result||ud.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.ma,3);
break;default:M=h.a(ae)}return M||Wg.Task.Ta(!0)};ye.prototype.hBb=function(M){if(kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(Dg.HelperMethods.$Z){var oa=new Map;oa.set("EntryPoint",M);jh.Health.instance.recordKpiUsage(Y.a.fWi,0,xi.a.rBi,oa)}else ud.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};ye.prototype.showOpenInAppDialog=function(){Pd.AFrameworkApplication.isMobileMode&&(kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",
!1)?(ud.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new yf(this.$)).Bh()):(ud.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),Pd.AFrameworkApplication.showOpenInAppDialog()))};ye.prototype.Nyj=function(M,oa){var Xa=this;return Pd.AFrameworkApplication.isMobileMode&&!sb.a(this.$.ya,30)?(this.showOpenInAppDialog(),ud.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),
this.hBb("CellDoubleTap"),ud.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):Pd.AFrameworkApplication.Ngc&&(M&&fi.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(ud.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",
fi.d(this.workbookContext.WorkbookFileName)?"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):va.a.any([25,26,30,31,55,32],function(Sb){return Xa.businessBar.cMa(Sb)})?(ud.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):oa&&E.a.i3i in oa&&!M?!1:!0};ye.prototype.Kc=function(M,oa){M=!1;switch(oa.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:M=
!0;break;case 520859864:M=kf.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:M=kf.EwaSettings.la(109);break;case -1388494670:M=kf.EwaSettings.la(109);break;case 810888577:M=kf.EwaSettings.la(273);break;case -1224038235:M=this.$.ea.amIAlone;break;case -988468372:M=kf.EwaSettings.la(306);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:M=!0,ud.ULS.shipAssertTag(537162642,0,this.$.Bka,
"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return M};ye.prototype.gd=function(){return!1};ye.prototype.Wkj=function(){var M=this;if(this.rc){var oa=this.$;Ah.a(oa).jt(new Ui.a(zb.a.ez,5,function(){oa.lI(!1,!0);var Xa=M.clientWorkflow.rd.activityState;Xa[Pe.a.Xq]=zb.a.Ada;Xa[gc.a.DT]=2;Xa[Vd.a.Ks]=oa.isEditMode;Xa[gc.a.Jga]=!1}))}};ye.prototype.saveACopy=function(){var M=this;if(this.rc){var oa=this.$;Ah.a(oa).jt(new Ui.a(zb.a.ez,5,function(){oa.lI(!1,
!1);var Xa=M.clientWorkflow.rd,Sb=Xa.activityState;Sb[Pe.a.Xq]=zb.a.KVf;Sb[Vf.a.bYb]=M.oc.hasUnsupportedFeaturesForEdit;Sb[gc.a.Jga]=!1;Xa.zt(Qg.a.maa(M.businessBar.W7c,[-502303485]))}))}};ye.prototype.kAc=function(M){var oa=this;Ah.a(this.$).jt(new Ui.a(zb.a.pna,2,function(){oa.$.lI(!0,!0);var Xa=$f.a(oa.$).rd,Sb=oa.$.isEditMode;Sb=Qg.a.jd(1,1,0,0,0,Sb?-315732528:-2087635043,Sb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Sb.ForceVersionUpgrade=M;Xa.zt([Sb]);Xa=$f.a(oa.$).rd.activityState;
Xa[Pe.a.Xq]=zb.a.pna;Xa[Vd.a.Ks]=oa.$.isEditMode;Xa[gc.a.Jga]=!1}))};ye.prototype.closeWorkbook=function(){var M=this;if(this.rc){var oa=this.$;ad.a.Rf.Gwc("2145659238")?oh.TaskExtensions.Ba(this.bK.value,function(Xa){Xa.result.Rj(Jf.a.qTe,{})},this.ma,3):Ah.a(oa).jt(new Ui.a(zb.a.ez,5,function(){oa.lI(!0,!1);var Xa=M.clientWorkflow.rd.activityState;Xa[gc.a.qY]=!1;Xa[gc.a.Jga]=!1;M.oc.inViewerFromWebPart?(Qa.a.GFd(oa,M.clientWorkflow.rd),oa.Kk.Iy("InViewerFromWebPart"),Xa[Pe.a.Xq]=zb.a.A_):(Xa[Pe.a.Xq]=
zb.a.Ak,oa.Jd&32?Xa[gc.a.DT]=0:(Xa[gc.a.DT]=1,Xa[gc.a.RXb]=new bd.a),Xa[We.a.Xke]=!0)}))}};ye.prototype.G3g=function(){var M=this,oa=this.oc.vbaRemovedDuringConversion;ud.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",oa);var Xa=this.$;oa?Ah.a(Xa).jt(new Ui.a(zb.a.ez,5,function(){var Sb=Qg.a.jd(3,0,0,1222,0,1069271157,"XLSMacroFailure");M.clientWorkflow.rd.zt([Sb]);M.clientWorkflow.rd.activityState[Pe.a.Xq]=zb.a.oeb})):Pd.AFrameworkApplication.hideHeader?
Dg.HelperMethods.vf(this.F6b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):L.a.ntw(this.F6b.CopyAndEditUrl,Xa)};ye.prototype.reloadWorkbookInEditMode=function(){var M=this;if(this.rc)if(kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&ad.a.Rf.OV&&ad.a.Rf.uHd(),Pd.AFrameworkApplication.Ngc&&!Pd.AFrameworkApplication.Xka)Dg.HelperMethods.vf(this.$.Wob(!0),k.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var oa=
this.$,Xa=!1,Sb=this.oc.hasUnsupportedFeaturesForEdit,xc=this.workbookContext.FileWasRepaired;fi.d(this.workbookContext.WorkbookFileName)?(Xa=!0,ud.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Sb)):fi.a(this.workbookContext.WorkbookFileName)&&(Xa=!0,ud.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var jd=oa.jg.get(59);jd=!(oa.ea.oc.supportsEditing&&
jd);if(Xa&&!Sb||jd&&(Xa||Sb)){var vd=jd?Sb?-2066104278:816071846:kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&sb.a(this.$.ya,25)&&!this.$.uzb?765011943:-213064907;Xa=function(){var ae=Qg.a.VZa([vd]);M.clientWorkflow.rd.zt(ae);M.clientWorkflow.rd.activityState[Pe.a.Xq]=zb.a.oeb}}else Xa=function(){oa.lI(!0,!1);var ae=M.clientWorkflow.rd,Ie=ae.activityState;Ie[gc.a.DT]=1;Ie[ve.a.WXb]=Oe.a.Xkc;Ie[Vd.a.Ks]=!0;Ie[Vf.a.bYb]=M.oc.hasUnsupportedFeaturesForEdit;Ie[gc.a.Jga]=
!!M.workbookContext.EditUrl;Ie[Id.a.q2]=M.workbookContext.EditUrl;if(!M.F6b.CopyAndEditUrl){var Zf=[kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&sb.a(M.$.ya,25)&&!M.$.uzb?-943219229:1821390342];ae.zt(Qg.a.maa(M.businessBar.W7c,Zf))}xc&&!Sb?(fi.b(M.workbookContext.WorkbookFileName)&&kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(ae=Qg.a.VZa([-425642652]),ud.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
ae=Qg.a.VZa([108482388]),M.clientWorkflow.rd.zt(ae),Ie[Pe.a.Xq]=zb.a.ZVf):M.$.ea.o8e?(ud.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Ra.b().sTd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Ie[Pe.a.Xq]=zb.a.TEb):Ie[Pe.a.Xq]=M.$.ea.ygc?zb.a.NAb:zb.a.oeb};Ah.a(oa).jt(new Ui.a(zb.a.ez,5,Xa))}};ye.prototype.reloadWorkbookInViewMode=function(){var M=
this;if(this.rc){kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&ad.a.Rf.OV&&ad.a.Rf.uHd();var oa=this.$;Ff.a.ah&&zg.g(oa).zc.textBox.blur();Ah.a(oa).jt(new Ui.a(zb.a.ez,5,function(){oa.lI(!oa.ea.isNamedObjectViewMode,!1);var Xa=M.clientWorkflow.rd.activityState;Xa[Pe.a.Xq]=zb.a.Tha;Xa[gc.a.DT]=1;Xa[gc.a.qY]=!0;Xa[Vd.a.Ks]=!1;Xa[Vd.a.Jmb]=!0;Xa[ve.a.WXb]=Oe.a.Xkc}))}};ye.prototype.reloadWorkbook=function(M,oa){var Xa=this;if(this.rc){var Sb=this.$;Sb.RM&65536&&
Ah.a(Sb).jt(new Ui.a(zb.a.ez,5,function(){Sb.lI(M,!0);var xc=Xa.clientWorkflow.rd.activityState;xc[Pe.a.Xq]=zb.a.Bk;xc[Vd.a.KTc]=Xa.workbookContext.NovMode;oa||(xc[gc.a.DT]=1,xc[gc.a.RXb]=new Kf)}))}};ye.prototype.setCalculationMode=function(M,oa){function Xa(){return new Qc(oa)}var Sb=this;ud.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",oa);var xc=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=oa;return Lb.a(this.$.userOperationManager,
function(jd,vd,ae){var Ie=Sb.$.na.ta;jd=lh.b(jd,ye.SSi(Sb.$,xc));vd=lh.a(vd,ye.RSi(Sb.$,xc));var Zf=Ie.Na(9,null);Zf.calc_type=oa;return ha.i(Ie,"SetCalculationOptions",Zf,jd,vd,ae,null,0)},function(jd){return new Kc.a(197,0,jd,void 0,Xa)},M)};ye.Nze=function(M){M.Ab&&0<M.Ab.WN&&M.Ab.y$c(function(oa){oa.Cu()})};ye.SSi=function(M,oa){return function(Xa){Qg.a.lh(Xa.Errors)&&(M.ea.workbookContext.CalcMode=oa,ud.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
oa,Qg.a.Uc(Xa.Errors)))}};ye.RSi=function(M,oa){return function(){M.ea.workbookContext.CalcMode=oa;ud.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",oa)}};Qk.Object.defineProperties(ye.prototype,{rc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.rc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},F6b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return $f.a(this.$)}},oc:{configurable:!0,enumerable:!0,get:function(){return this.$.oc}}});Object(pe.a)(ye,"FileOperationsCommandHandler",P.a,[239]);var Tg=b(147),Bi=ch.a;vm(ce,Bi);ce.prototype.Pd=function(){var M=this,oa=this.$,Xa=[],Sb=vg.GetServiceTaskFactory.create(oa.da,56,this.ma,this.ub);Xa.push(Sb);var xc=vg.GetServiceTaskFactory.Wa(oa.da,5,4,this.ub);Xa.push(xc);oh.TaskExtensions.Ba(Wg.Task.WAA.apply(null,Xa),function(){Tg.b(Sb)&&
M.Gd([new ye(oa,Sb.result,new If.a(function(){return vg.GetServiceTaskFactory.create(oa.da,137,M.ma,M.ub)}),xc.result)])},this.ma,0)};ce.ka=function(M){ch.a.he(94,new ce(M))};Object(pe.a)(ce,"FileOperationsCommandHandlerFactory",ch.a,[]);var Cf=b(43),Ih;(function(M){M[M.url=0]="url";M[M.ref=1]="ref";M[M.mailto=2]="mailto"})(Ih||(Ih={}));Object(pe.b)("HyperlinkSelectionState",Ih);var Eh=b(899),Gg=b(9),ti=b(603),R=b(82),za=Eh.a;vm(Tc,za);Tc.prototype.w0e=function(M,oa){switch(oa){case 2:return M.startsWith("mailto:")?
M:"mailto:"+M;case 1:return String.format("{0}{1}",Gg.a.HIf,this.oTh(M));default:return M}};Tc.prototype.nx=function(){var M=this,oa=this.$;this.location=this.w0e(this.Bxd,this.Axd);try{this.location=R.a.xm(this.location)}catch(xc){ud.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}ud.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",Ih[this.Axd]);this.cellValue=this.zxd.length?this.zxd:this.Bxd;oa.ny();var Xa=oa.na.ta.$b(),Sb=Cf.s(this.selectedRange);return function(xc,jd,vd){return ha.c(oa.na.ta,
Sb,M.cellValue,M.location,M.removeHyperLink,!1,123,xc,jd,vd,M.mM.range,Xa)}};Tc.prototype.Yl=function(){var M=this,oa=Cf.s(this.selectedRange);return function(){return new ti.a(oa,M.cellValue,M.location)}};Tc.prototype.kAh=function(){var M=this.mM.cell.f5a;this.mM.cell.twb?M&&M.startsWith("mailto:")?(this.Fmb=2,M=M.substr(7)):this.Fmb=0:this.Fmb=1;return M};Tc.prototype.vLa=function(){kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.tyb=this.mM.Xaa:this.tyb=!!this.mM.gKa(64)||
!!this.mM.gKa(128)};Tc.prototype.lm=function(){if(this.tyb){this.q1a=this.mM.text;var M=this.kAh();M&&(this.xTc=M);this.fo=qe.a.instance.fa(810);this.Hqb=this.xTc===this.q1a}else this.mM.text?(this.q1a=this.mM.text,this.Hqb=!1):(this.q1a="",this.Hqb=!0),this.Fmb=0,this.fo=qe.a.instance.fa(809);this.mM.iK&&(this.Hqb=!1,this.nIe=!0,kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.q1a=this.mM.formulaBarText))};Tc.prototype.TCi=function(M){return this.ea.zb.yj(M)};
Tc.prototype.RZe=function(M,oa){return M?null:qe.a.instance.fa(oa)};Tc.prototype.oTh=function(M){var oa=Cf.Z(M,this.ea.xa);var Xa=oa.sheetName;var Sb=oa.range;oa.returnValue&&Sb&&(M=Cf.x(Sb,Xa||this.sheetName,!1));return M};Qk.Object.defineProperties(Tc.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Qw:{configurable:!0,enumerable:!0,get:function(){return 526}}});Tc.CWj="validateLinkValues";Tc.VOg="bodyProps";Tc.xfh="disableDisplayText";Tc.ogh="displayTextValue";
Tc.Tzg="activeLinkOption";Tc.Uzg="activeLinkValue";Tc.N3g="copyLinkValueToDisplay";Tc.ati="linkValue";Tc.snj="selectedLink";Tc.ngh="displayText";Object(pe.a)(Tc,"HyperlinkDialog",Eh.a,[]);Uc.prototype.Zc=function(){return!1};Uc.prototype.Kc=function(M,oa){return 1===M&&-1583422759===oa.command};Uc.prototype.gd=function(){return!1};Uc.prototype.executeCommand=function(){this.FBj();return Wg.Task.Ta(!0)};Uc.prototype.FBj=function(){var M=Cf.v(this.gridView.ha.va.Td,this.$),oa=zg.e(this.gridView);(!kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.Ms([this.gridView.ha.va.Td],!0))&&oa&&new Tc(this.$,M,oa)};Object(pe.a)(Uc,"ShowHyperlinkCommandHandler",null,[239]);var jb=ch.a;vm(Cc,jb);Cc.prototype.Pd=function(){this.Gd([new Uc(this.$,zg.g(this.$))])};Cc.ka=function(M){ch.a.he(105,new Cc(M))};Object(pe.a)(Cc,"ShowHyperlinkCommandHandlerFactory",ch.a,[]);var Jb=b(20),Dc=b(1139);Ic.create="Create";Ic.activate="Activate";Ic.close="Close";Ic.remove="Delete";Ic.duplicate="Duplicate";Object(pe.a)(Ic,"Actions",null,[]);var ic=Wg.Task;vm(ob,ic);
ob.prototype.TL=function(){this.T_d=Qg.a.jd(3,2,0,1622,0,-1244327602,"MsFormDeleteConfirmation");this.ij=Ah.a(this.Bf.$).ui(this.T_d).G();this.ij.isCompleted||(this._state=2,this.ij.IN(this.moveNext));return this.gDc};ob.prototype.gDc=function(){this.V_d=this.ij.gz();0===this.V_d&&(this.Bf.$.workbookContext.Options=Dg.HelperMethods.xO(!1,this.Bf.$.workbookContext.Options,2048),this.Bf.deleteMsFormMetaDataSheet());this._state=3;this.qRa(!0)};ob.prototype.dispose=function(){};Object(pe.a)(ob,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
Wg.Task,[2]);Xe.action="Action";Xe.WDh="FlexPane";Xe.c$b="formId";Xe.id="id";Xe.title="Title";Xe.yOb="XlWorkbookId";Xe.YFh="Fragment";Xe.host="Host";Xe.CMj="TopView";Xe.m2="auth_pvr";Object(pe.a)(Xe,"Parameters",null,[]);Be.prototype.Zc=function(M,oa){switch(oa){case -105284469:return!aa.i(this.$.lg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};Be.prototype.executeCommand=function(M,oa){M=oh.TaskExtensions.nm();oa=oa.command;switch(oa){case -105284469:this.insertMsForm();
break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:M=this.deleteMsForm();break;default:M=h.a(oa)}return M};Be.prototype.Kc=function(M,oa){if(!this.$.ea.oh.get(61))return!1;M=!1;switch(oa.command){case -105284469:M=aa.i(this.$.lg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:M=this.hasMsForm}return M};Be.prototype.gd=function(){return!1};Be.prototype.insertMsForm=
function(){var M=Sf.a.kr(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),oa={},Xa={};oa[Xe.action]=Ic.create;oa[Xe.m2]=this.m2;Xa[Xe.action]=Ic.create;Xa[Xe.yOb]=encodeURIComponent(this.uOb);Xa[Xe.host]=this.jo;Xa[Xe.title]=encodeURIComponent(M);this.CBb(oa,Xa);this.$.workbookContext.Options=Dg.HelperMethods.xO(!1,this.$.workbookContext.Options,2048)};Be.prototype.editMsForm=function(){var M={},oa={};M[Xe.m2]=this.m2;oa[Xe.c$b]=this.llc;oa[Xe.yOb]=encodeURIComponent(this.uOb);oa[Xe.host]=
this.jo;this.CBb(M,oa)};Be.prototype.previewMsForm=function(){var M={},oa={};M[Xe.m2]=this.m2;oa[Xe.c$b]=this.llc;oa[Xe.yOb]=encodeURIComponent(this.uOb);oa[Xe.host]=this.jo;oa[Xe.CMj]="Preview";this.CBb(M,oa)};Be.prototype.sendMsForm=function(){var M={},oa={};M[Xe.m2]=this.m2;oa[Xe.c$b]=this.llc;oa[Xe.WDh]="SendForm";oa[Xe.yOb]=encodeURIComponent(this.uOb);oa[Xe.host]=this.jo;this.CBb(M,oa)};Be.prototype.deleteMsForm=function(){return new ob(this)};Be.prototype.deleteMsFormMetaDataSheet=function(){var M=
this;this.$.userOperationManager.Mt(new Kc.a(158,0,function(oa,Xa,Sb){return Ce(M.$.na.vw,M.cV.Qtb,lh.b(oa,function(){M.udh()}),Xa,Sb,null)}))};Be.prototype.udh=function(){var M={},oa={};M[Xe.action]=Ic.remove;M[Xe.m2]=this.m2;oa[Xe.action]=Ic.remove;oa[Xe.host]=this.jo;oa[Xe.c$b]=encodeURIComponent(this.llc);oa[Xe.yOb]=encodeURIComponent(this.uOb);this.CBb(M,oa)};Be.prototype.CBb=function(M,oa){var Xa=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Sb="",xc="";if(oa){for(var jd in oa){var vd=jd,
ae=oa[jd];xc+=xc.length?"&":"";xc+=vd+"="+ae}M||(M={});M[Xe.YFh]=encodeURIComponent(xc)}if(M)for(var Ie in M)oa=Ie,xc=M[Ie],Sb+=Sb.length?"&":"?",Sb+=oa+"="+xc;window.open(Xa+Sb,"_blank")};Qk.Object.defineProperties(Be.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return aa.c(this.$.lg)}},llc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},uOb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},m2:{configurable:!0,
enumerable:!0,get:function(){return Jb.a.contains(this.$.zu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(pe.a)(Be,"MsFormCommandHandler",null,[239]);var Hd=ch.a;vm(pc,Hd);pc.prototype.Pd=function(){var M=this,oa=vg.GetServiceTaskFactory.create(this.$.da,203,this.ma,this.ub);oh.TaskExtensions.Ba(oh.TaskExtensions.we([oa],this.ma),function(){M.Gd([new Be(M.$)])},this.ma,3)};pc.ka=function(M){M.ea.oh.get(61)&&ch.a.he(215,new pc(M))};Object(pe.a)(pc,"MsFormCommandHandlerFactory",
ch.a,[]);var fe=gg.a;vm(Yc,fe);Yc.prototype.create=function(){var M=this;oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.create(this.$.da,164,this.ma,this.ub),function(){M.Gb(new nc)},this.ma,3)};Object(pe.a)(Yc,"NewAndOpenUXFactory",gg.a,[]);Sc.prototype.executeCommand=function(M,oa,Xa){M=2;switch(oa.command){case Tf.a.openUrlInNewTab:M=this.Fi.De(Tf.a.openUrlInNewTab,2,Xa);break;case Tf.a.UOa:M=this.Fi.De(Tf.a.UOa,2,Xa)}return 2!==M?Wg.Task.Ta(!0):h.a(oa.command)};Sc.prototype.Kc=function(M,oa){return oa.command===
Tf.a.openUrlInNewTab||oa.command===Tf.a.UOa};Sc.prototype.gd=function(M,oa,Xa){return"PopulateMruMenu"===oa?(this.Fi.De(Tf.a.Lpc,2,Xa),!0):!1};Sc.prototype.Zc=function(){return!1};Object(pe.a)(Sc,"OpenFromMruCommandHandler",null,[239]);var tf=ch.a;vm(Qd,tf);Qd.prototype.Pd=function(){var M=this,oa=vg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),Xa=vg.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.ub);oh.TaskExtensions.Ba(oh.TaskExtensions.we([oa,Xa],this.ma),function(){M.Gd([new Sc(M.$,
Pd.AFrameworkApplication.Hb)])},this.ma,3)};Qd.ka=function(M){ch.a.he(88,new Qd(M))};Object(pe.a)(Qd,"OpenFromMruCommandHandlerFactory",ch.a,[]);var hg=b(88),Yf=b(84),qh=b(241),gi=b(667),Vi=b(1082),dk=qh.a;vm(Wc,dk);Wc.prototype.execute=function(M){var oa=Object(Yf.a)(8,M.Je);if(!oa.Bka)return ud.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Amd(M),this.vh(zb.a.idle),1;this.pBb||(this.pBb=new Vi.DownloadACopyOperation(this.fkc,
oa));this.pBb.Thh();ud.ULS.shipAssertTag(537154817,0,3!==$f.a(oa).xi.Nt,"The current activity should not be closed.");return 1};Wc.prototype.Amd=function(M){var oa=Object(Yf.a)(8,M.Je),Xa=new gi.a(oa);this.subscribe(M,this.hBd,function(Sb){Xa.add_disposing(Sb)});ud.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Xa.initialize();Xa.mf()};Wc.prototype.dispose=function(){hg.a.Fa(this.pBb);this.pBb=null;dk.prototype.dispose.call(this)};
Object(pe.a)(Wc,"DownloadAForkedCopyActivity",qh.a,[]);var de=gg.a;vm(oc,de);oc.prototype.create=function(){var M=this;oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){M.Gb(new Wc(zb.a.w1a,zb.a.Ak,!0))},this.ma)};Object(pe.a)(oc,"DownloadACopyPreDatalossActivityFactory",gg.a,[]);var Te=gg.a;vm(yb,Te);yb.prototype.create=function(){var M=this;oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){M.Gb(new Wc(zb.a.unmergeableDownloadCopy,
zb.a.uoa))},this.ma)};Object(pe.a)(yb,"DownloadAForkedCopyActivityFactory",gg.a,[]);wc.prototype.Pg=function(){this.La.hc(Tf.a.tryMacOffice,kh.a.frame,Object(uf.a)(this,this.MUi,"onTryMacOffice"));this.La.hc(Tf.a.ebg,kh.a.frame,Object(uf.a)(this,this.aFf,"onTryMacOfficeFromViewer"));this.La.hc(Tf.a.dbg,kh.a.frame,Object(uf.a)(this,this.aFf,"onTryMacOfficeFromViewer"))};wc.prototype.MUi=function(M,oa,Xa,Sb,xc){if(1===Xa)return 32;xc?(M=xc.SourceControlId,"btnjTryMacOfficeForWordEditor"===M?xe.a.vf(fg.a.CZ(12),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===M&&xe.a.vf(fg.a.CZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Wkf();return 32};wc.prototype.aFf=function(M,oa,Xa){if(1===Xa)return 32;switch(M){case Tf.a.ebg:xe.a.vf(fg.a.CZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Tf.a.dbg:xe.a.vf(fg.a.CZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};wc.prototype.Wkf=function(){var M=void 0===M?null:M;
var oa=0;M&&(oa=M);xe.a.vf(2===oa?"https://go.microsoft.com/fwlink/?LinkId=331579":wc.lyi,"_blank",void 0,"LaunchMacTrialWindow")};Qk.Object.defineProperties(wc.prototype,{Rwc:{configurable:!0,enumerable:!0,get:function(){return this.krg&&Ff.a.isMac&&!Ff.a.Hli&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Fyj:{configurable:!0,enumerable:!0,get:function(){return this.Rwc}}});Qk.Object.defineProperties(wc,{lyi:{configurable:!0,enumerable:!0,get:function(){return fg.a.qH("522401")}}});Object(pe.a)(wc,
"MacOfficeOffer",null,[863]);Vb.prototype.Pg=function(){this.La.hc(Tf.a.tryOffice,kh.a.frame,Object(uf.a)(this,this.NUi,"onTryOffice"));this.La.hc(Tf.a.tryOfficeThroughTellMe,kh.a.frame,Object(uf.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.hc(Tf.a.hbg,kh.a.frame,Object(uf.a)(this,this.ibg,"tryOfficeThroughViewer"));this.La.hc(Tf.a.gbg,kh.a.frame,Object(uf.a)(this,this.ibg,"tryOfficeThroughViewer"))};Vb.prototype.NUi=function(M,oa,Xa,Sb,xc){if(this.VWb&&1===Xa)return this.isFreemiumUpsellEnabled&&
this.uKb?32:8;2===Xa&&(xc?(M=xc.SourceControlId,"btnjTryOfficeForWordEditor"===M?xe.a.vf(fg.a.CZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===M?xe.a.vf(fg.a.CZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.djc()):this.djc());return 32};Vb.prototype.tryOfficeThroughTellMe=function(M,oa,Xa,Sb,xc){if(this.VWb&&1===Xa)return this.isFreemiumUpsellEnabled&&this.uKb?32:8;2===Xa&&(xc?(M=xc.SourceControlId,xe.a.vf(fg.a.qH("862405")+this.EVh(M),"_blank",
void 0,"TryOfficeThroughTellMe.WithSourceControlId")):xe.a.vf(fg.a.qH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};Vb.prototype.ibg=function(M,oa,Xa){if(this.VWb&&1===Xa)return this.isFreemiumUpsellEnabled&&this.uKb?32:8;if(2===Xa)switch(M){case Tf.a.hbg:xe.a.vf(fg.a.CZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Tf.a.gbg:xe.a.vf(fg.a.CZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};Vb.prototype.djc=function(M){M=void 0===M?null:M;var oa=
0;M&&(oa=M);xe.a.vf(Vb.pTh(oa),"_blank",void 0,"LaunchOfficeOffer")};Vb.prototype.EVh=function(M){var oa=0;switch(M){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":oa=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":oa=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":oa=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":oa=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":oa=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":oa=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":oa=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":oa=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":oa=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":oa=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":oa=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":oa=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":oa=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":oa=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":oa=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":oa=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":oa=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":oa=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":oa=29}return 0===oa?"":String.format("&pc={0:D}",oa)};Vb.pTh=function(M){if(Ff.a.ah)switch(M){case 1:return fg.a.qH("393806");case 2:return fg.a.qH("393810");case 3:return fg.a.qH("393809");case 5:return fg.a.qH("393805")}else if(Ff.a.Up)switch(M){case 1:return fg.a.qH("521979");
case 3:return fg.a.qH("521980");case 5:return fg.a.qH("521978");case 2:return fg.a.qH("522490")}else{if(2===M)return fg.a.qH("517778");if(1===M)return fg.a.CZ(30)}return fg.a.qH("522402")};Qk.Object.defineProperties(Vb.prototype,{Rtf:{configurable:!0,enumerable:!0,get:function(){return this.uKb}},nGi:{configurable:!0,enumerable:!0,get:function(){return this.uKb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},uKb:{configurable:!0,enumerable:!0,get:function(){return this.nrg&&!Ff.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,
enumerable:!0,get:function(){var M=!1;this.OEc&&(M=this.OEc.isFreemiumUpsellEnabled());return M}}});Object(pe.a)(Vb,"OfficeTrialExperience",null,[197]);wf.prototype.ii=function(M){M.register(Vb,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").Cc().Mc(function(){return new Vb(Pd.AFrameworkApplication.Hb,Pd.AFrameworkApplication.bzb,Pd.AFrameworkApplication.lcid)});M.register(wc,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").Cc().Mc(function(){return new wc(Pd.AFrameworkApplication.Hb,
Pd.AFrameworkApplication.Dgc,Pd.AFrameworkApplication.lcid)})};Object(pe.a)(wf,"OpenInClientConfiguration",null,[5]);var Pi=b(1337),Mj=b(36),Bf=b(1233),wj=b(275);Qk.Object.defineProperties(vc,{eg:{configurable:!0,enumerable:!0,get:function(){return yh.a.Bn(vc.Uj,CommonUIStrings.l_OICLaunchDialogTitle)}}});vc.Uj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(pe.a)(vc,"OICLaunchDialogHtml",null,[]);var Bh=yh.a;vm(of,Bh);of.prototype.r9a=function(){this.vCa=Ac("BtnRichClient",this.mq.Wrb,this.mq.qxb,this.mq.Xkd,CommonUIStrings.l_OICLaunchRichClient,Object(uf.a)(this,this.LCf,"onRichClientButtonClick"),Yd);document.getElementById("OICLaunchRichClient").appendChild(this.vCa);Cd(this.vCa);this.PUa=Ac("BtnReturn",this.mq.Wrb,this.mq.qxb,this.mq.N$e,CommonUIStrings.l_OICReturnToOnlineClient,Object(uf.a)(this,this.ICf,"onReturnButtonClick"),Yd);document.getElementById("OICReturnToApp").appendChild(this.PUa);
Cd(this.PUa)};of.prototype.ICf=function(){this.hide();this.mq.Dbb();return!0};of.prototype.LCf=function(){ud.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();Pd.AFrameworkApplication.Hb.processAction(Tf.a.GQa,2);return!0};of.prototype.HGi=function(){this.mq.Dbb()};of.prototype.dispose=function(){this.Jpa||(this.vCa&&(wj.a.instance.za(kg.a.click,this.vCa,Object(uf.a)(this,this.LCf,"onRichClientButtonClick")),nf.KeyInputManager.instance.za(kg.a.Xd,this.vCa,Yd)),this.PUa&&
(wj.a.instance.za(kg.a.click,this.PUa,Object(uf.a)(this,this.ICf,"onReturnButtonClick")),nf.KeyInputManager.instance.za(kg.a.Xd,this.PUa,Yd)),Bh.prototype.dispose.call(this),this.Jpa=!0)};Object(pe.a)(of,"OICLaunchDialog",yh.a,[]);Qk.Object.defineProperties(Se,{eg:{configurable:!0,enumerable:!0,get:function(){return yh.a.Bn(Se.Uj,CommonUIStrings.l_OICDialogTitle)}}});Se.Uj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(pe.a)(Se,"ProtocolLaunchingDialogV2Html",null,[]);var Vh=yh.a;vm(ke,Vh);ke.prototype.r9a=function(){var M=document.getElementById("Issues");if(M){id("",this.mq.Wrb,this.mq.qxb,this.mq.Xkd,M);var oa=document.createElement("span");oa.className="WACDialogSectionTitle";oa.innerText=5===this.mq.PFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;M.appendChild(oa);Cd(M);M.style.display="none"}Pd.AFrameworkApplication.sa.Qa.$hd?(this.OUa=Ac("GiveFeedback",this.mq.Wrb,
this.mq.qxb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(uf.a)(this,this.Wmc,"onGiveFeedbackClick"),Object(uf.a)(this,this.Vyf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.OUa),Cd(this.OUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===Pd.AFrameworkApplication.sa.Qa.editMode||Pd.AFrameworkApplication.yfh?document.getElementById("ButtonEdit").style.display="none":(this.cfa=Ac("Edit",this.mq.Wrb,this.mq.qxb,
"",2===Pd.AFrameworkApplication.sa.Qa.Oj?4===Pd.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===Pd.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(uf.a)(this,this.txf,"onEditClick"),Object(uf.a)(this,this.yxf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.cfa),Cd(this.cfa));0===Pd.AFrameworkApplication.sa.Qa.editMode&&
!Pd.AFrameworkApplication.bzb&&M&&(M.style.display="none")};ke.prototype.iVe=function(){return this.opa?(this.Gz(this.opa),!0):!1};ke.prototype.gVe=function(){return this.cfa?(this.Gz(this.cfa),!0):!1};ke.prototype.yxf=function(M){return this.ozd(M,0)};ke.prototype.Vyf=function(M){return this.ozd(M,2)};ke.prototype.GCf=function(M){return this.ozd(M,1)};ke.prototype.ozd=function(M,oa){var Xa=!1;if(M.Ea.keyCode===mi.a.Zh||M.Ea.keyCode===mi.a.Ioa)M.Ub.click(),Xa=!0;else if(M.Ea.keyCode===Sys.UI.Key.down||
M.Ea.keyCode===Sys.UI.Key.up)switch(oa){case 1:Xa=this.gVe();break;case 0:Xa=this.iVe()}return Xa};ke.prototype.txf=function(){this.hide();4===Pd.AFrameworkApplication.sa.Qa.editMode?(ud.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.mq.Dbb()):(ud.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.mq.Fid());return!0};ke.prototype.Wmc=function(){ud.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.mq.M6e();return!0};ke.prototype.Unc=
function(){ud.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";Pd.AFrameworkApplication.Hb.processAction(Tf.a.GQa,2);return!0};ke.prototype.CFd=function(){this.mq.Dbb()};ke.prototype.switchToBackupMode=function(){var M=document.getElementById("ProtocolLaunchingDialogTitle");if(M){M.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(M=document.getElementById("Issues"))M.style.display="block";(M=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!M.children.length&&(this.opa=Ac("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(uf.a)(this,this.Unc,"onRetryOICClick"),Object(uf.a)(this,this.GCf,"onRetryOICKeyUp")),M.appendChild(this.opa),Cd(this.opa),this.cfa||this.iVe())}};ke.prototype.dispose=function(){this.Jpa||(this.cfa&&(wj.a.instance.za(kg.a.click,this.cfa,Object(uf.a)(this,this.txf,"onEditClick")),nf.KeyInputManager.instance.za(kg.a.Xd,this.cfa,Object(uf.a)(this,this.yxf,"onEditKeyUp"))),this.OUa&&(wj.a.instance.za(kg.a.click,
this.OUa,Object(uf.a)(this,this.Wmc,"onGiveFeedbackClick")),nf.KeyInputManager.instance.za(kg.a.Xd,this.OUa,Object(uf.a)(this,this.Vyf,"onGiveFeedbackKeyUp"))),this.opa&&(wj.a.instance.za(kg.a.click,this.opa,Object(uf.a)(this,this.Unc,"onRetryOICClick")),nf.KeyInputManager.instance.za(kg.a.Xd,this.opa,Object(uf.a)(this,this.GCf,"onRetryOICKeyUp"))),Vh.prototype.dispose.call(this),this.Jpa=!0)};Object(pe.a)(ke,"ProtocolLaunchingDialog",yh.a,[]);var dj=b(429),Zh=Og.StandardDialog;vm(qd,Zh);qd.prototype.Wmc=
function(M){ud.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Rxf(M)};qd.prototype.Unc=function(){ud.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");Pd.AFrameworkApplication.Hb.processAction(Tf.a.GQa,2)};qd.prototype.CFd=function(M){qd.O7e?3===M?this.uUf():2===M||0===M?this.continueEditing():1===M&&this.CZg():2===M?this.uUf():(1===M||0===M)&&this.continueEditing()};qd.prototype.CZg=function(){ud.ULS.sendTraceTag(577783557,211,50,"Closing the document");Pd.AFrameworkApplication.Hb.De(Tf.a.close,
2,dj.a)};qd.prototype.uUf=function(){ud.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(uf.a)(this,this.Unc,"onRetryOICClick"),0)};qd.prototype.continueEditing=function(){4===Pd.AFrameworkApplication.sa.Qa.editMode||Pd.AFrameworkApplication.ga.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===Pd.AFrameworkApplication.sa.mode?(ud.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.mq.Dbb()):(ud.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),
this.mq.Fid())};Qk.Object.defineProperties(qd,{O7e:{configurable:!0,enumerable:!0,get:function(){return Pd.AFrameworkApplication.ga.ra("OICDialogThreeActions")&&32===Pd.AFrameworkApplication.Hb.processAction(Tf.a.close,1)}}});Object(pe.a)(qd,"StandardProtocolLaunchingDialog",Og.StandardDialog,[]);Object(pe.a)(Sd,"EditDocumentInClientParams",null,[]);Ed.N7c=function(M,oa,Xa,Sb,xc,jd,vd,ae,Ie,Zf,Vg,Gh,pi,ij,Fj,Pj){vd=void 0===vd?!1:vd;ae=void 0===ae?!1:ae;Ie=void 0===Ie?"":Ie;Zf=void 0===Zf?!1:Zf;Vg=
void 0===Vg?!1:Vg;Gh=void 0===Gh?!1:Gh;pi=void 0===pi?"":pi;ij=void 0===ij?"":ij;Fj=void 0===Fj?"":Fj;Pj=void 0===Pj?!1:Pj;var Gi=new Sd;Gi.DocumentUrl=M;Gi.Mode=oa;Gi.Options=Xa;Gi.Application=Sb;Gi.SilentExternalHandler=vd;Gi.EncodeUrl=ae;Gi.CorrelationIdForWinClient=Ie;Gi.NavigateUsingWindowOpen=Zf;Gi.DescriptiveUnattemptedEnums=Vg;Gi.NoBrowserModalDialogs=Gh;Gi.SessionOrigin=pi;Gi.CorrelationId=ij;Gi.ClickTime=Fj;Gi.NewTelemetryDataIsEnabled=Pj;MSOJS.ClientUtils.EditDocumentInClient(Gi,xc,jd)};
Object(pe.a)(Ed,"ClientUtils",null,[]);var Wi=b(176),Tj=b(961),Ue=b(75),qi=b(177);Fc.prototype.sEi=function(){if(!Pd.AFrameworkApplication.ga)return 0;switch((Pd.AFrameworkApplication.ga.Ua(Pd.AFrameworkApplication.vea)||"").toLowerCase()){case "teams":var M=524288;break;case "onedrive":M=131072;break;case "owa":M=262144;break;case "assignments":M=65536;break;default:M=0}switch((Pd.AFrameworkApplication.ga.Ua("FileSource")||"").toLowerCase()){case "exchangeonline":var oa=1;break;case "exchangeonlineconsumer":oa=
2;break;case "onedrivewopi":oa=4;break;case "sharepointonline":oa=8;break;default:oa=0}return oa|M};Fc.prototype.bjj=function(M,oa,Xa){return oa.contextId!==kh.a.frame?2:1===Xa?32:this.GQa()};Fc.prototype.tIj=function(){return!(2===this.application&&Pd.AFrameworkApplication.ga.ra("IsEmbeddedScenario"))};Fc.prototype.closeApplication=function(){this.nUd||this.izh()};Fc.prototype.Dbb=function(){this.wIj||this.wzh()};Fc.prototype.mNf=function(M){this.uVj&&Ff.a.ah?new of(this):this.J2b(M)};Fc.prototype.J2b=
function(M){M=this.Gri(M);var oa=M.returnValue;ud.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===oa,M.pBa);return oa};Fc.prototype.nGa=function(M,oa,Xa,Sb,xc,jd){this.VUa=M;this.s5d=oa;this.Zfa=jd;this.application=Xa;this.MB=Sb;Pd.AFrameworkApplication.downloadCopyOnOpenInClient?this.Tkf():Pd.AFrameworkApplication.limitedEdit&&!Pd.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?Pd.AFrameworkApplication.N4f():this.YNg(xc)};Fc.prototype.GQa=function(){this.GGi&&this.yui();
return this.J2b(this.oib)};Fc.prototype.dYf=function(){var M=new Tj.a(Jf.a.openInClient);M.Values["ui-language"]=Pd.AFrameworkApplication.lcid.toString();M.Values[tc.a.V4c]=Pd.AFrameworkApplication.userSessionId;return this.Zfa.value.send(M)?32:8};Fc.prototype.yui=function(){jh.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new me.a,{inStaging:!0}))};Fc.prototype.Moj=function(M){var oa=new Tj.a(Jf.a.MXj);oa.Values["ui-language"]=Pd.AFrameworkApplication.lcid.toString();
oa.Values[tc.a.V4c]=Pd.AFrameworkApplication.userSessionId;oa.Values[Ag.a.LXj]=M;this.Zfa.value.send(oa)};Fc.prototype.Gri=function(M){this.oib=M;this.Moj(5===this.MB?Fc.mWi:Fc.oWi);return 5===this.MB?this.Fri():this.Kri()};Fc.prototype.Fri=function(){this.Zkf();return{returnValue:32,pBa:"HostEditUrl,"}};Fc.prototype.Kri=function(){var M,oa=M="";Pd.AFrameworkApplication.Hme&&(oa="|f|"+Pd.AFrameworkApplication.userSessionId);var Xa=Pd.AFrameworkApplication.ga.ra("IsAssignmentMode")&&Pd.AFrameworkApplication.ga.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
Pd.AFrameworkApplication.isUnifiedHostMode||Ff.a.Wka,Sb=Pd.AFrameworkApplication.ga.ra("UnattemptedEnumIsEnabled"),xc=Pd.AFrameworkApplication.ga.ra("NoBrowserModalDialogs");if(Pd.AFrameworkApplication.Hb.Dlc){var jd=Pd.AFrameworkApplication.Hb.HZ(3588168074);jd&&(this.JVb=String.format("{0}{1}{2}",Fc.Dpj.toString(),"_",this.sEi().toString()),this.FD=jd.correlationId?jd.correlationId:"",this.tQb=jd.TriggerTime?jd.TriggerTime:"")}if(Pd.AFrameworkApplication.NIf){M+="NewOrder,";jd=8;this.Zfa&&this.Zfa.value&&
this.Zfa.value.isEnabled()&&Pd.AFrameworkApplication.TYd&&(M+="Post,",jd=this.dYf());if(32===jd)return{returnValue:jd,pBa:M};ud.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return Pd.AFrameworkApplication.am.Z9a?(ud.ULS.shipAssertTag(5566816,211,!!Pd.AFrameworkApplication.am.Z9a),M+="HostUrl,",{returnValue:Pd.AFrameworkApplication.sa.I8a(Pd.AFrameworkApplication.am.Z9a),pBa:M}):this.VUa?(ud.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
Pd.AFrameworkApplication.userSessionId),M+="DocUrl,",Ed.N7c(this.VUa,this.MB,this.options,this.application,Object(uf.a)(this,this.xxf,"onEditInClientSuccess"),Object(uf.a)(this,this.wxf,"onEditInClientFailure"),this.r5f,Pd.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Xa,Sb,xc,this.JVb,this.FD,this.tQb,Pd.AFrameworkApplication.Hb.Dlc),{returnValue:32,pBa:M}):{returnValue:8,pBa:M}}M+="OldOrder,";if(!this.VUa&&Pd.AFrameworkApplication.am.Z9a)return this.Zfa&&this.Zfa.value&&this.Zfa.value.isEnabled()&&
Pd.AFrameworkApplication.TYd?(M+="Post,",oa=this.dYf()):(ud.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),oa=8),32!==oa?(ud.ULS.shipAssertTag(22595484,211,!!Pd.AFrameworkApplication.am.Z9a),M+="HostUrl,",{returnValue:Pd.AFrameworkApplication.sa.I8a(Pd.AFrameworkApplication.am.Z9a),pBa:M}):{returnValue:oa,pBa:M};ud.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",Pd.AFrameworkApplication.userSessionId);M+="DocUrl,";
Ed.N7c(this.VUa,this.MB,this.options,this.application,Object(uf.a)(this,this.xxf,"onEditInClientSuccess"),Object(uf.a)(this,this.wxf,"onEditInClientFailure"),this.r5f,Pd.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Xa,Sb,xc,this.JVb,this.FD,this.tQb,Pd.AFrameworkApplication.Hb.Dlc);return{returnValue:32,pBa:M}};Fc.prototype.uSf=function(M){Pd.AFrameworkApplication.Lm.setDw(8981,M)};Fc.prototype.xxf=function(M){this.uSf(M);ud.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");
6===M&&MSOJS.ClientUtils.ShouldShowDialog()?(this.s8f||this.Zkf(),this.awi()):this.nUd||this.closeApplication()};Fc.prototype.wxf=function(M,oa){oa=void 0===oa?0:oa;ud.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",M,oa);if(5===M)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Xa=!!this.s5d&&!this.oib,Sb=0;1===M&&(Sb=2);6<=M&&13>=M&&(Sb=1,1===oa&&(this.nUd=!0));this.Czc.nGi?(ud.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",
Sb),Bf.a.instance.q8g(this.oib?Object(uf.a)(this,this.huf,"oicErrorDialogHandlerCloseForced"):Object(uf.a)(this,this.iuf,"oicErrorDialogHandlerNoCloseForced"),Xa?Object(uf.a)(this,this.Yzf,"onLaunchDownload"):null,this.hIe(!1)?Object(uf.a)(this,this.S8h,"iHaveOfficeButtonHandler"):null,Sb,oa)):(ud.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Sb),Bf.a.instance.o8g(this.oib?Object(uf.a)(this,this.huf,"oicErrorDialogHandlerCloseForced"):Object(uf.a)(this,this.iuf,"oicErrorDialogHandlerNoCloseForced"),
Xa?Object(uf.a)(this,this.Yzf,"onLaunchDownload"):null,Sb))}};Fc.prototype.awi=function(){try{var M=[Object.assign(new Ue.a,{name:"CorrelationId",string:this.FD}),Object.assign(new Ue.a,{name:"SessionOrigin",string:this.JVb}),Object.assign(new Ue.a,{name:"ClickTime",string:this.tQb}),Object.assign(new Ue.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Wi.a("OpenInClientCompleted",!0,0,M)}catch(oa){ud.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+oa.toString())}};
Fc.prototype.Zkf=function(){Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.qw&&Pd.AFrameworkApplication.ga.ra("StandardProtocolDialogIsEnabled")?new qd(this):new ke(this)};Fc.prototype.huf=function(){this.closeApplication()};Fc.prototype.iuf=function(){this.Dbb()};Fc.prototype.Yzf=function(){this.Tkf()};Fc.prototype.S8h=function(){return this.hIe(!0)};Fc.prototype.hIe=function(M){var oa=(Ff.a.mN||Ff.a.KH)&&!!Pd.AFrameworkApplication.Z5b;oa&&M&&(xe.a.vf(Pd.AFrameworkApplication.Z5b,"_blank",
void 0,"OpenInClient"),this.closeApplication());return oa};Qk.Object.defineProperties(Fc.prototype,{PFf:{configurable:!0,enumerable:!0,get:function(){return this.MB}},options:{configurable:!0,enumerable:!0,get:function(){var M=0;Pd.AFrameworkApplication.ahj&&(M|=1);Pd.AFrameworkApplication.openInClientEditOnly&&(M|=4);this.tIj()&&(M|=64);return M}},Wrb:{configurable:!0,enumerable:!0,get:function(){return Pd.AFrameworkApplication.JC}},qxb:{configurable:!0,enumerable:!0,get:function(){return Pd.AFrameworkApplication.lxb}},
N$e:{configurable:!0,enumerable:!0,get:function(){return""}},Xkd:{configurable:!0,enumerable:!0,get:function(){return""}},s8f:{configurable:!0,enumerable:!0,get:function(){return Pd.AFrameworkApplication.ga.ra("OneNoteMobileViewerIsEnabled")}},Czc:{configurable:!0,enumerable:!0,get:function(){return this.zce||(this.zce=Uh.a.instance.resolve("Common.IOfficeTrialExperience"))}},GGi:{configurable:!0,enumerable:!0,get:function(){return!!Pd.AFrameworkApplication.ga&&Pd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}}});Fc.oWi="OpenInDesktop";Fc.mWi="OpenInBrowser";Fc.Dpj=qi.a.gta("B5F65EF9-A5B1-4887-A968-C779537C8303");Object(pe.a)(Fc,"AOpenInClientOperation",null,[]);var ej=b(196),Yg=b(200),Ug=b(114),sh=b(44),xj=b(42),fj=b(180),Uj=b(92),Qj=b(32),dg=b(480),ui=b(1178),vh=b(607);vm(qf,Fc);qf.prototype.J0g=function(){this.mNf(this.vVe)};qf.prototype.J2g=function(){var M=this,oa=this.$;oh.TaskExtensions.Ba(this.bK.value,function(Xa){M.nGa(oa.workbookContext.ClientUrl,Pd.AFrameworkApplication.R3,1,oa.isEditMode?
2:0,!0,new If.a(function(){return Xa.result}))},this.ma,3)};qf.prototype.Fid=function(){0!==ad.a.Rf.editMode&&(this.$.Ab.QC=!1)};qf.prototype.M6e=function(){var M={};M[E.a.X8b]=!1;M[E.a.oZ]="OpenInExcel";this.$.ye(802602464,na.a.dc,8,M)};qf.prototype.C2c=function(){var M=this;if(this.ea.rc){var oa=this.$;oa.isEditMode&&oh.TaskExtensions.Ba(this.bK.value,function(Xa){M.nGa(oa.workbookContext.ClientUrl,Pd.AFrameworkApplication.R3,1,2,!1,new If.a(function(){return Xa.result}))},this.ma,3)}};qf.prototype.kCe=
function(){var M=this;this.ea.rc&&oh.TaskExtensions.Ba(this.bK.value,function(oa){M.nGa(M.$.workbookContext.ClientUrl,Pd.AFrameworkApplication.R3,1,M.$.isEditMode?2:0,!1,new If.a(function(){return oa.result}))},this.ma,3)};qf.prototype.openInExcelClient=function(){var M=this;this.ea.rc&&(this.$.isEditMode||oh.TaskExtensions.Ba(this.bK.value,function(oa){M.nGa(M.$.workbookContext.ClientUrl,Pd.AFrameworkApplication.R3,1,0,!1,new If.a(function(){return oa.result}))},this.ma,3))};qf.prototype.openInBrowser=
function(){var M=this;this.ea.rc&&oh.TaskExtensions.Ba(this.bK.value,function(oa){M.nGa(M.$.workbookContext.ClientUrl,Pd.AFrameworkApplication.R3,1,5,!1,new If.a(function(){return oa.result}))},this.ma,3)};qf.prototype.downloadFile=function(M){var oa=this.kve(M);this.raa.downloadFile(oa,M)};qf.prototype.LFf=function(M,oa){oa=void 0===oa?0:oa;if(this.ea.rc){var Xa=this.$;$f.a(Xa).NLa?this.MFf(M,Xa):0<oa?this.pGj(M,Xa,oa):this.A3f(Xa)}};qf.prototype.nGa=function(M,oa,Xa,Sb,xc,jd){this.$.Ab.QC=!kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||
!this.$.oc.inWebPart;this.vVe=xc;this.K2b=null;this.j7c=!1;this.cOg(M,oa,Sb,xc,jd)};qf.prototype.J2b=function(M){var oa=this.$.oc;ud.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?ej.a.edit:ej.a.view);return qf.Uff()?(this.i2b(),Ed.N7c(this.VUa,this.MB,this.options,1,this.LKi,this.KKi,!1,Pd.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")),32):
Fc.prototype.J2b.call(this,M)};qf.prototype.izh=function(){this.vTf();var M=this.$;if(!this.ea.oc.inWebPart&&this.ea.rc&&!M.isEditMode){var oa=new Uj.a(2145659238,na.a.dc,this.$.hd,0,null);this.cAe=sh.a.instance.create(function(){M.Ka.Yb(oa)},0,xj.a.pWi)}};qf.prototype.dispose=function(){this.ea&&this.ea.kk(this.dd);hg.a.sc([this.Ma,this.cAe,this.wm]);this.$=this.ea=null};qf.prototype.wzh=function(){this.vTf()};qf.prototype.Tkf=function(){var M=this;sh.a.instance.create(function(){M.$.Ka.Yb(new Uj.a(-2028960985,
na.a.dc,0,30,null))},0,xj.a.qWi,!0,!0)};qf.prototype.YNg=function(M){var oa=this.$,Xa=$f.a(this.$).rd.activityState;Xa[dg.a.Yke]=!0;oa.isEditMode&&this.ea.rc?(this.i2b(),Ah.a(oa).jt(new Ui.a(zb.a.ez,5,function(){oa.lI(!1);Xa[Pe.a.Xq]=zb.a.k2b;Xa[dg.a.cAg]=M;Xa[gc.a.fbd]=!0;oa.isEditMode&&(Xa[gc.a.DT]=1,Xa[gc.a.qY]=!0,Xa[We.a.$Xb]=!0,Xa[We.a.LTc]=!0);Xa[dg.a.ale]=1455037301}))):this.mNf(M)};qf.prototype.q6f=function(){var M=Pd.AFrameworkApplication.R3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.I8a(M,
!0)){var oa=this.$.ea.oc;ud.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",M,oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?ej.a.edit:ej.a.view)}}else this.raa.downloadFile(M,-2028960985);this.j7c=!0;this.i2b()};qf.prototype.csi=function(){this.Czc.Rtf&&this.Czc.djc(1)};qf.prototype.dsi=function(){this.Czc.Rtf&&Dg.HelperMethods.vf(fg.a.CZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};qf.prototype.msi=
function(){Dg.HelperMethods.vf(fg.a.CZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};qf.prototype.nsi=function(){Dg.HelperMethods.vf(fg.a.CZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};qf.prototype.kve=function(M){var oa=new Sys.StringBuilder,Xa=this.$.workbookContext,Sb=this.$.ya;oa.append(this.$.Kda);oa.append(Sb.FileHandlerRelativeUri);oa.append("?id=");oa.append(encodeURIComponent(Yg.a.SGb(Xa.WorkbookUri,"sc")));this.$.ea.rc&&(oa.append("&sessionId="),
oa.append(encodeURIComponent(this.$.ea.sessionId)));switch(M){case -974518828:oa.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:oa.append("&workbookType=FullWorkbook");break;case -1059172980:oa.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:oa.clear()}Ug.a.aGa(oa,Sb);return oa.toString()};qf.prototype.q1g=function(){Pi.a.instance.AXg();var M=this.$.ya;MSOJS.ClientUtils.InitUrls(M.RoamingAppsX86RootUrl,M.RoamingAppsControlInstallerUrl,M.RoamingAppsFirefoxExtensionUrl)};
qf.prototype.vTf=function(){var M=this.$;this.ea.rc||Qa.a.GFd(M,$f.a(M).rd);this.i2b();this.K2b&&this.K2b(this,this.j7c);M.frame.qt.$l(this.$.frame.Jaa());M.frame.oX.$l(this.$.frame.Jaa());M.Ab.QC=!1;zg.g(M).focus()};qf.prototype.cOg=function(M,oa,Xa,Sb,xc){var jd=this.$;Pd.AFrameworkApplication.sa&&!qf.Uff()&&(jd.frame.qt.en(jd.frame.Jaa()),jd.frame.oX.en(jd.frame.Jaa()));Fc.prototype.nGa.call(this,M,oa,1,Xa,Sb,xc)};qf.prototype.i2b=function(){var M=this.$;$f.a(M).xi.activityName===zb.a.openInExcelClient&&
$f.a(M).rd.HJ()};qf.prototype.cBj=function(){var M=Qg.a.jd(1,0,668,669,0,1341525452,"OpenInExcelActiveXError");Ah.a(this.$).nv([M])};qf.prototype.pGj=function(M,oa,Xa){var Sb=this,xc=null,jd=window.setTimeout(function(){$f.a(oa).rsc(xc);Sb.A3f(oa)},Xa);xc=function(){$f.a(oa).NLa&&($f.a(oa).rsc(xc),window.clearTimeout(jd),Sb.MFf(M,oa))};$f.a(oa).OUc(xc)};qf.prototype.A3f=function(M){var oa=Qg.a.jd(1,1,0,683,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");Ah.a(M).nv([oa])};qf.prototype.MFf=
function(M,oa){var Xa=this;Ah.a(oa).jt(new Ui.a(zb.a.ez,5,function(){oa.lI(!1);var Sb=$f.a(oa).rd,xc=Sb.activityState;xc[Pe.a.Xq]=zb.a.HJe;xc[Vf.a.bYb]=oa.ea.oc.hasUnsupportedFeaturesForEdit;xc[vh.a.FTc]=M;Sb.zt(Qg.a.maa(Xa.businessBar.W7c,[1437034227]))}))};qf.Uff=function(){return 1<ad.a.getRegisteredEwaInstances().length};Qk.Object.defineProperties(qf.prototype,{N$e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},ma:{configurable:!0,enumerable:!0,get:function(){this.wm=
this.wm||new fj.a;return this.wm.token}},Xkd:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},s8f:{configurable:!0,enumerable:!0,get:function(){return this.ea.oc.inWebPart}}});Object(pe.a)(qf,"OpenInExcelOperation",Fc,[447,2]);var Ci=gg.a;vm(ee,Ci);ee.prototype.create=function(){var M=this;if(this.$.da.Aa(55))this.Gb(this.$.da.Aa(55));else{var oa=vg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),Xa=vg.GetServiceTaskFactory.Wa(this.$.da,5,4,this.ub);oh.TaskExtensions.Ba(Wg.Task.WAA(oa,
Xa),function(){M.Gb(new qf(M.$,new If.a(function(){return vg.GetServiceTaskFactory.create(M.$.da,137,M.ma,M.ub)}),Xa.result))},this.ma,3)}};ee.p1g=function(){ee.kuf||(ee.kuf=!0,(new wf).ii(Uh.a.instance),Uh.a.instance.resolve("Common.IOfficeTrialExperience").Pg(),Uh.a.instance.resolve("Common.IMacOfficeOffer").Pg())};ee.kuf=!1;Object(pe.a)(ee,"OpenInClientFactory",gg.a,[]);var Zi=b(110),rk=b(390),ik=Zi.a;vm(md,ik);md.prototype.execute=function(M){var oa=Object(Yf.a)(8,M.Je);oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.create(oa.da,
56,oa.ma,0),function(Xa){oa.downloadCopyOnOpenInClient?(M.activityState[rk.a.Zke]=!0,Xa.result.q6f()):Xa.result.J2g()},oa.ma,3);return 1};Object(pe.a)(md,"OpenInExcelClientActivity",Zi.a,[]);var mk=gg.a;vm(je,mk);je.prototype.create=function(){var M=this;oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){M.Gb(new md(zb.a.openInExcelClient,zb.a.idle))},this.ma)};Object(pe.a)(je,"OpenInExcelClientActivityFactory",gg.a,[]);var lj=qh.a;vm($d,lj);$d.prototype.initialize=
function(M){lj.prototype.initialize.call(this,M)};$d.prototype.execute=function(M){this.yi=M;M=Object(Yf.a)(8,this.yi.Je);this.$qb(M);return 1};$d.prototype.QI=function(M){lj.prototype.QI.call(this,M)};$d.prototype.$qb=function(){var M=this;this.subscribe(this.yi,this.GYi,function(oa){M.WCd.add_disposing(oa)})};$d.prototype.UEb=function(M){this.unsubscribe(function(oa){M.remove_disposing(oa)});this.yi.activityState[Vd.a.r2]=0};Object(pe.a)($d,"PasswordProtectedFileActivity",qh.a,[]);var ri=b(371),
Zj=ri.a;vm(pf,Zj);pf.prototype.oab=function(M){this.Hpa=M};pf.prototype.s3=function(){var M={};M[ri.a.description]=qe.a.instance.fa(1923);M[ri.a.tma]=qe.a.instance.fa(1919);M[ri.a.bHf]=qe.a.instance.fa(1941);M[ri.a.$Gf]=qe.a.instance.fa(1942);M[ri.a.aHf]=qe.a.instance.fa(1920);M[ri.a.jld]=qe.a.instance.fa(1926);M[ri.a.$se]=qe.a.instance.fa(1621);M[ri.a.WWj]=qe.a.instance.Va(25);M[ri.a.cgg]=Object(uf.a)(this,this.UTa,"verifySubmittedPassword");return M};pf.prototype.eta=function(){var M={};M[Af.a.Zy]=
this.Bc;M[ri.a.kue]=this.s3();return M};pf.prototype.Bh=function(){this.kc=1;this.initializeAndShow(this.fo,this.A6i,this.eta())};Qk.Object.defineProperties(pf.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},Mrb:{configurable:!0,enumerable:!0,get:function(){return this.Hpa}},fo:{configurable:!0,enumerable:!0,get:function(){return qe.a.instance.fa(1922)}}});Object(pe.a)(pf,"PasswordProtectedFilePasswordInputDialog",ri.a,[]);var gj=b(303);vm(Qf,pf);Qf.prototype.oab=
function(M,oa){pf.prototype.oab.call(this,M,oa);ud.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",M)};Qf.prototype.UTa=function(M,oa){this.passwordToModify=M;var Xa={};Xa.FileModifyPassword=Sf.a.pf(M);ha.ob(this.$.na.ta,Xa,this.jVi(oa),this.iVi(oa),null,null)};Qf.prototype.s3=function(){var M=pf.prototype.s3.call(this);M[ri.a.jld]=qe.a.instance.fa(1927);M[ri.a.description]=qe.a.instance.Va(24);return M};
Qf.prototype.Bh=function(){Ra.b().o8c("PasswordToModifyDialogShown");ud.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");pf.prototype.Bh.call(this)};Qf.prototype.jVi=function(M){var oa=this;return function(Xa){Qg.a.kh(Xa.Errors,[-2019873242])&&oa.i6b(oa.Sqb());if(!Xa||gj.a(Xa))if(0<oa.tLd)oa.zMf(M);else{ud.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",
Qg.a.Uc(Xa.Errors));oa.$.ea.lp(Xa.Errors);oa.hide();return}oa.J9d=Xa.Result;oa.Vgc&&(Ra.b().sTd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),ud.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));M(oa.Vgc?0:1)}};Qf.prototype.iVi=function(M){var oa=this;return function(){0<oa.tLd?oa.zMf(M):
(ud.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),M(3))}};Qf.prototype.zMf=function(M){--this.tLd;this.UTa(this.passwordToModify,M)};Qf.prototype.Sqb=function(){return Qg.a.jd(1,0,1620,1621,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};Qk.Object.defineProperties(Qf.prototype,{Vgc:{configurable:!0,enumerable:!0,get:function(){return this.J9d}},fo:{configurable:!0,enumerable:!0,
get:function(){return qe.a.instance.fa(1924)}}});Object(pe.a)(Qf,"PasswordProtectedFileModifyPasswordInputDialog",pf,[]);vm(Qe,$d);Qe.prototype.$qb=function(M){this.WCd=new Qf(M);$d.prototype.$qb.call(this,M)};Qe.prototype.UEb=function(M,oa){var Xa=M.Mrb,Sb=M.Vgc,xc=M.passwordToModify;$d.prototype.UEb.call(this,M,oa);this.yi.Sxa([2001366804]);switch(Xa){case 1:Sb?(oa=Object(Yf.a)(8,this.yi.Je),this.yi.activityState[Vd.a.ole]=Sf.a.pf(xc),this.yi.activityState[Vd.a.iYa]=!0,M.passwordToModify="",this.vh(oa.isEditMode?
zb.a.Pj:this.JM)):ud.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.hp();break;case 0:this.yi.activityState[Vd.a.Ks]=!1;this.vh(this.TJ);this.hp();break;default:ud.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Xa)}};Object(pe.a)(Qe,"PasswordProtectedFileModifyActivity",$d,[]);var Aj=
gg.a;vm(td,Aj);td.prototype.create=function(){this.Gb(new Qe(this.activityName,this.JM,this.TJ))};td.ka=function(M){M.da.Ha(434,new td(zb.a.TEb,zb.a.oeb,zb.a.QGa,M))};Object(pe.a)(td,"PasswordProtectedFileModifyActivityFactory",gg.a,[]);vm(be,pf);be.prototype.UTa=function(M,oa){this.password=M;oa(0)};be.prototype.s3=function(){var M=pf.prototype.s3.call(this);this.Yif&&(M[ri.a.umh]=1);return M};be.prototype.Bh=function(){ud.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",
this.Yif);pf.prototype.Bh.call(this);Ah.a(this.$).qpe()};Object(pe.a)(be,"PasswordProtectedFileOpenPasswordInputDialog",pf,[]);vm(ne,$d);ne.prototype.$qb=function(M){var oa=Qg.a.kh(this.yi.errors,[1217361942]);this.WCd=new be(M,oa);M.efc||M.aIe();$d.prototype.$qb.call(this,M)};ne.prototype.UEb=function(M,oa){var Xa=M.password;M.password="";var Sb=M.Mrb;$d.prototype.UEb.call(this,M,oa);this.yi.activityState[Vd.a.PTc]=Sf.a.pf(Xa);this.yi.activityState[Vd.a.iYa]=!0;this.yi.Sxa([110414285,1217361942]);
ud.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Sb);switch(Sb){case 1:this.vh(this.JM);this.hp();break;case 0:this.vh(this.TJ),this.hp()}};Object(pe.a)(ne,"PasswordProtectedFileOpenActivity",$d,[]);var yj=gg.a;vm(pd,yj);pd.prototype.create=function(){this.Gb(new ne(this.activityName,this.JM,this.TJ))};pd.ka=function(M){M.da.Ha(386,new pd(zb.a.jpc,zb.a.Pj,zb.a.Ak,M))};Object(pe.a)(pd,"PasswordProtectedFileOpenActivityFactory",
gg.a,[]);var Fh=b(381),ek=Fh.a;vm(qc,ek);qc.prototype.GO=function(M,oa){this.Hpa=M;ek.prototype.GO.call(this,M,oa)};qc.prototype.zr=function(){ek.prototype.zr.call(this);this.kc=9;var M=this.gTh();this.Gc(1,qe.a.instance.fa(1619));this.Gc(2,qe.a.instance.fa(963));this.Ik(qe.a.instance.fa(689),R.a.xm(M),this.icon,this.HO)};qc.prototype.gTh=function(){return String.format(qe.a.instance.fa(690))};Qk.Object.defineProperties(qc.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},
Mrb:{configurable:!0,enumerable:!0,get:function(){return this.Hpa}}});Object(pe.a)(qc,"LegacySharedWorkbookDialog",Fh.a,[]);var jk=qh.a;vm(Zd,jk);Zd.prototype.initialize=function(M){jk.prototype.initialize.call(this,M)};Zd.prototype.execute=function(M){this.yi=M;this.Z5g();return 1};Zd.prototype.QI=function(M){jk.prototype.QI.call(this,M)};Zd.prototype.Z5g=function(){var M=Object(Yf.a)(8,this.yi.Je),oa=Qg.a.VZa([-573864504]);oa[0].HelpDescription=qe.a.instance.fa(692);oa[0].HelpTopicId=Bd.a.Lsi;var Xa=
new qc(M,oa[0]);this.subscribe(this.yi,this.Ksi,function(Sb){Xa.add_disposing(Sb)})};Object(pe.a)(Zd,"LegacySharedWorkbookActivity",qh.a,[]);var $c=gg.a;vm(rb,$c);rb.prototype.create=function(){this.Gb(new Zd(this.activityName,this.JM,this.TJ))};rb.ka=function(M){M.da.Ha(460,new rb(zb.a.NAb,zb.a.oeb,zb.a.QGa,M))};Object(pe.a)(rb,"LegacySharedWorkbookActivityFactory",gg.a,[]);nd.prototype.Zc=function(){return!1};nd.prototype.Kc=function(M,oa){if(!kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",
!1))return!1;switch(oa.command){case 642419866:return!0;case 588342182:return this.presentModeManager.mz;default:return!1}};nd.prototype.executeCommand=function(M,oa){M=oh.TaskExtensions.nm();oa=oa.command;switch(oa){case 642419866:this.presentModeManager.xxc(!this.presentModeManager.mz);this.presentModeManager.sh("TogglePresentMode");break;case 588342182:this.presentModeManager.X6a=!this.presentModeManager.X6a;this.presentModeManager.A4f(this.presentModeManager.X6a,"TogglePresentModeOverlay");this.presentModeManager.sh("TogglePresentModeOverlay");
break;default:M=h.a(oa)}return M};nd.prototype.gd=function(){return!1};Object(pe.a)(nd,"PresentModeCommandHandler",null,[239]);var Ee=ch.a;vm(zc,Ee);zc.prototype.Pd=function(){var M=this;oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.Wa(this.$.da,423,424,this.ub),function(oa){M.Gd([new nd(M.$,oa.result)])},this.ma,3)};zc.ka=function(M){ch.a.he(420,new zc(M))};Object(pe.a)(zc,"PresentModeCommandHandlerFactory",ch.a,[]);var ni=b(120),zh=b(109);sd.Fsh="ewa-presentMode-overlay";sd.Gsh="ewa-presentMode-panel-container";
sd.Hsh="ewa-presentMode-rowHdrParent-container";Object(pe.a)(sd,"CssClassNames",null,[]);var N=b(16),Ea=b(143),Hb=b(283),yc=b(126),Xc=b(119),Ae=b(436),Fe=b(11),af=b(94),Df=b(341),gf=b(127),Rg=b(415),Ig=b(255),Kg=b(244),bi=b(186);cc.prototype.dispose=function(){this.$=this.tEd=this.uEd=this.Kca=this.wPa=null};cc.prototype.hbi=function(){var M=this;window.requestAnimationFrame(function(){M.Kca=document.createElement("div");M.$.Vv.insertBefore(M.Kca,M.$.Vv.lastChild);M.Kca.id=M.$.Jb+E.a.M9b;M.Kca.classList.add(sd.Gsh);
M.uEd=document.getElementById(M.$.Jb+E.a.F5c);M.tEd=[M.$.Py];M.isInitialized=!0});this.wPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.wPa.initializePresentModeFloatie()};cc.prototype.y_h=function(){var M={};M.PollingCountPerCaller=zh.a.toJSON(this.Ipc);M.PollingDurationPerCaller=zh.a.toJSON(this.Jpc);return M};cc.prototype.ORd=function(M){this.isInitialized?M?(this.wPa.showPresentModeFloatie(this.Kca,this.uEd,this.tEd),this.sh("ShowOrHideFloatiePanel"),
this.Q9i()):(this.wPa.hidePresentModeFloatie(),this.vQj()):ud.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};cc.prototype.sh=function(M){this.aIf=Dg.HelperMethods.lc();this.sPa=M;this.Dse=bi.AsyncMethodContext.Yy(this.Hl,100,xj.a.w1i+M,this.Dse)};cc.prototype.Oe=function(M,oa){if(oa)return!1;M=Fe.DOMElementExtensions.Bl(this.Kca.querySelectorAll(Fe.DOMElementExtensions.Qp));if(!M)return ud.ULS.sendTraceTag(537154325,0,10,
"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;M.focus();return!0};cc.prototype.Yf=function(M){return Fe.DOMElementExtensions.Pe(this.Kb,M)};cc.prototype.fi=function(){};cc.prototype.Ph=function(){};cc.prototype.Q9i=function(){var M=this;Ig.a(this.$).Qg(this);this.$.da.Za(15,function(oa){M.ewaAccessibilityManager=oa;M.ewaAccessibilityManager.mode=5});nf.KeyInputManager.instance.qa(kg.a.Tb,this.Kb,this.onKeyDown)};cc.prototype.vQj=function(){Ig.a(this.$).Cz(this);
zg.g(this.$).C0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);nf.KeyInputManager.instance.za(kg.a.Tb,this.Kb,this.onKeyDown)};cc.prototype.nlj=function(){var M=Dg.HelperMethods.lc()-this.aIf,oa=this.Jpc[this.sPa]?this.Jpc[this.sPa]:0;this.Jpc[this.sPa]=oa>M?oa:M;this.Ipc[this.sPa]=this.Ipc[this.sPa]?this.Ipc[this.sPa]+1:1};Qk.Object.defineProperties(cc.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return this.Kca}},canReceiveFocus:{configurable:!0,enumerable:!0,
get:function(){this.wPa.updatePresentModeFloatieShyState(2);return!!this.Kca}},$d:{configurable:!0,enumerable:!0,get:function(){return Kg.a.mJf}}});Object(pe.a)(cc,"PresentModeFloatieManager",null,[469,117,2]);var yi=b(58);Object(pe.a)(Ke,"OverlayCavityInfo",null,[]);Object(pe.a)(oe,"OverlayContainerInfo",null,[]);Object(pe.a)(te,"PresentModeOverlayProps",null,[]);Ud.prototype.Rbi=function(){var M=this;this.vEd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){M.f_a=
Array(5);for(var oa,Xa,Sb=1;4>=Sb;Sb++)oa=document.createElement("div"),Fe.DOMElementExtensions.setVisible(oa,!1),oa.id=String.format("{0}-{1}","PresentModeOverlay",Sb),Fe.DOMElementExtensions.toggleCssClass(oa,sd.Fsh,!0),Xa=M.gridView.Sf(Sb).domElement,Xa.insertBefore(oa,Xa.firstChild),M.f_a[Sb]=oa})};Ud.prototype.z4f=function(M){M&&this.JTj();for(var oa=1;4>=oa;oa++)this.pgf(oa)&&Fe.DOMElementExtensions.setVisible(this.f_a[oa],M);Fe.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-overlay",
M)};Ud.prototype.JTj=function(){for(var M=this.WTg(),oa,Xa=1;4>=Xa;Xa++)oa=Xa,M[oa]&&this.vEd.showOverlayWithCavity(this.f_a[oa],M[oa])};Ud.prototype.dispose=function(){this.vEd=this.f_a=this.gridView=this.$=null};Ud.prototype.WTg=function(){for(var M,oa,Xa=zg.g(this.$).rtl,Sb,xc=Array(5),jd=1;4>=jd;jd++)oa=jd,this.pgf(jd)&&(M=this.gridView.Sf(jd),Sb=this.gridView.ha.Pa.f5?this.FQh(jd,M,Xa):this.xRh(jd,M,Xa),M=this.A8g(M),xc[oa]=this.T8g(this.f_a[oa].id,M,Sb));return xc};Ud.prototype.pgf=function(M){return this.gridView.$a.jK(M)};
Ud.prototype.A8g=function(M){return Object.assign(new oe,{width:M.nn.width,height:M.nn.height})};Ud.prototype.T8g=function(M,oa,Xa){return Object.assign(new te,{containerId:M,overlayContainerInfo:oa,overlayCavityInfos:Xa?[Xa]:null})};Ud.prototype.FQh=function(M,oa,Xa){var Sb=zg.g(this.$).ha.Pa.mc;if(!Sb)return ud.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var xc=Sb.extension.IQh(M);M=xc.NBa;Sb=xc.rotation;
var jd=xc.translateX;var vd=xc.translateY;return xc.returnValue?(xc=M.x-oa.nn.x,Object.assign(new Ke,{left:(Xa?oa.nn.width-(xc+M.width):xc)-3+1,top:M.y-oa.nn.y-3+1,width:M.width+5,height:M.height+5,angle:Sb,translateX:jd,translateY:vd})):null};Ud.prototype.xRh=function(M,oa,Xa){M=this.gridView.Ob.vub(this.gridView.ha.va.activeRange,M)||yi.a.a4;if(!M.zf(oa.nn))return null;var Sb=M.x-oa.nn.x;return Object.assign(new Ke,{left:Xa?oa.nn.width-(Sb+M.width)-2:Sb-3,top:M.y-oa.nn.y-3,width:M.width+5,height:M.height+
5})};Object(pe.a)(Ud,"PresentModeOverlayRenderer",null,[468,2]);var oi=ri.a;vm(Kd,oi);Kd.prototype.hide=function(){oi.prototype.hide.call(this);ni.a.pv(E.a.E4f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Qk.Object.defineProperties(Kd.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(pe.a)(Kd,"PresentModeWelcomeDialog",ri.a,[]);Ve.requestFullscreen=function(M){M.webkitRequestFullscreen?M.webkitRequestFullscreen():M.msRequestFullscreen?
M.msRequestFullscreen():M.mozRequestFullScreen?M.mozRequestFullScreen():M.requestFullscreen?M.requestFullscreen():ud.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};Ve.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ud.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};
Qk.Object.defineProperties(Ve,{zGh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},AGh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":
"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},hji:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(pe.a)(Ve,"FullscreenUtils",null,[]);Ne.prototype.xxc=function(M){var oa=this;this.mz!==M&&(this.M9d=M,this.X6a=this.mz,this.ecf(),this.BKb=this.m3f(),window.requestAnimationFrame(function(){Fe.DOMElementExtensions.toggleCssClass(oa.$.ar,
"ewr-presentMode-transition",!0);$addHandler(oa.d2a,"transitionend",oa.poa);oa.jCj(!M);oa.sXi();Fe.DOMElementExtensions.toggleCssClass(oa.$.ar,"ewr-presentMode-on",M);oa.iCj(M);Ea.b(oa.$).x4f(oa.mz);Ea.c(oa.$).x4f(oa.mz);oa.$.Wma();oa.yPa.z4f(oa.BKb);if(oa.mz){oa.rZa();ni.a.get(E.a.E4f)?oa.Lca.ORd(oa.mz):oa.eqc=new Kd(oa.$,oa.Lca);var Xa=Rg.b(oa.$);Xa&&(oa.BLd=Xa.d8c(!1));oa.lJf=Dg.HelperMethods.lc()}else oa.Lca.ORd(M),oa.BLd&&(Xa=Rg.b(oa.$))&&(Xa.d8c(!0),oa.BLd=!1),oa.N5b(),oa.pwi()}))};Ne.prototype.A4f=
function(M,oa){this.TRd=M;this.zea(oa)};Ne.prototype.sh=function(M){this.Lca.sh(M)};Ne.prototype.dispose=function(){this.N5b();this.yPa&&(this.yPa.dispose(),this.yPa=null);this.gridView=this.$=null};Ne.prototype.jCj=function(M){var oa=this.$.da.Aa(25);void 0===oa||null===oa?ud.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):M?oa.rxc():oa.vdc()};Ne.prototype.sXi=function(){var M=this;Fe.DOMElementExtensions.toggleCssClass(document.getElementById(Pd.AFrameworkApplication.m2a),
N.a.Wo,this.mz);Fe.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on",this.mz);this.mCj(this.mz);this.gridView.yod=!this.mz;this.ZTj();this.$.da.Za(32,function(oa){oa.tUj(M.mz)});Xc.b(this.$,function(oa){oa.Fdg(M.mz)})};Ne.prototype.mCj=function(M){if(this.xFb)if(M){if(M=Object(Yf.a)(af.a,this.$.pa))Fe.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on-headers-off",!M.headersVisible),Fe.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on-rtl",zg.g(this.$).rtl);
this.bBc(0)}else this.$.ar.classList.remove("ewr-presentMode-on-headers-off"),this.$.ar.classList.remove("ewr-presentMode-on-rtl"),this.bBc(1)};Ne.prototype.bBc=function(M){var oa=Object(Yf.a)(af.a,this.$.pa);if(oa){var Xa=parseInt(this.$.Vv.style.right,10);if(1===M||2===M){if(isNaN(Xa)||Xa<this.N0a)return;Xa-=this.N0a}if(0===M||2===M)M=oa.headersVisible,oa=zg.g(this.$).rtl,M=M?oa?0:32:12,Xa=isNaN(Xa)?M:Xa+M,this.N0a=M;this.$.Vv.style.right=Dg.HelperMethods.Rb(Xa);this.bCe=Xa}};Ne.prototype.ZTj=function(){var M=
document.getElementById(this.$.Jb+E.a.n5b).parentNode;Fe.DOMElementExtensions.toggleCssClass(M,sd.Hsh,this.mz)};Ne.prototype.initialize=function(M){this.yPa=new Ud(M);this.yPa.Rbi();this.Lca=new cc(M);this.Lca.hbi();this.d2a=document.getElementById("MainApp");this.aWe=this.LLi;$addHandler(this.d2a,Ve.zGh,this.aWe);$addHandler(this.d2a,Ve.AGh,this.MLi);this.xFb||(this.xFb=document.createElement("div"),this.xFb.className="ewa-presentMode-right-frame",this.$.Py.appendChild(this.xFb));this.poa=this.nbj};
Ne.prototype.rZa=function(){this.gridView.ha.K9(this.sr);this.gridView.ha.D2(this.Xh);this.gridView.qc.Xl(this.ej);this.gridView.qc.Lo(this.Jg);this.gridView.aE(this.kp);this.gridView.view.Ls(this.xw);this.gridView.CYb(this.lya);this.gridView.Ca.IG(this.Em);this.gridView.Ca.rq(this.Se);this.$.xa.Qf(this.hi);this.$.xa.uYa(this.jca);this.$.xa.Vga(this.$Db);this.$.mA(this.dj);this.$.Pk(this.ud);var M=Object(Yf.a)(Df.a,this.$.xa);M=yl(M.items);for(var oa=M.next();!oa.done;oa=M.next())oa.value.xnb(this.Fya)};
Ne.prototype.N5b=function(){this.gridView&&(this.gridView.ha.mda(this.sr),this.gridView.ha.j0(this.Xh),this.gridView.qc.nl(this.ej),this.gridView.qc.Mn(this.Jg),this.gridView.SF(this.kp),this.gridView.view.Mq(this.xw),this.gridView.msc(this.lya),this.gridView.Ca.mI(this.Em),this.gridView.Ca.np(this.Se));if(this.$){this.$.xa.ug(this.hi);this.$.xa.Qab(this.jca);this.$.xa.Oma(this.$Db);this.$.kD(this.dj);this.$.ol(this.ud);var M=Object(Yf.a)(Df.a,this.$.xa);M=yl(M.items);for(var oa=M.next();!oa.done;oa=
M.next())oa.value.CJd(this.Fya)}};Ne.prototype.m3f=function(){if(!this.mz||!this.X6a)return!1;if(1===this.gridView.ha.We){var M=this.$.pa.activeRange.isSingle,oa=1===this.$.pa.selectedRanges.length&&!M,Xa=this.gridView.isEditing,Sb=this.sqd;oa||ud.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",M);return this.TRd&&oa&&!Xa&&!Sb}return this.TRd};Ne.prototype.iCj=function(M){M?Ve.requestFullscreen(this.d2a):
Ve.exitFullscreen()};Ne.prototype.zea=function(M,oa,Xa){var Sb=this;Xa=void 0===Xa?!1:Xa;void 0!==oa&&oa||(this.BKb=this.m3f());ud.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",M,this.BKb,Xa);if(this.sNb&&Xa)ud.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.rNb),window.cancelAnimationFrame(this.rNb),this.rNb=0;else if(this.sNb){ud.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",M);return}Xa?this.fYd(Dg.HelperMethods.lc(),M):(this.rNb=window.requestAnimationFrame(function(xc){Sb.fYd(xc,M)}),this.sNb=!0)};Ne.prototype.fYd=function(M,oa){var Xa=this,Sb=Dg.HelperMethods.lc();if(Sb-M>this.Zlj)this.rNb=window.requestAnimationFrame(function(jd){Xa.fYd(jd,oa)}),this.sNb=!1,ud.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Sb-
M);else{this.yPa.z4f(this.BKb);this.sNb=!1;var xc=Dg.HelperMethods.lc();M=Dg.HelperMethods.lc()-M;Sb=xc-Sb;this.blj(M,oa);ud.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Sb,M)}};Ne.prototype.ecf=function(){var M=this;Lb.a(this.$.userOperationManager,function(oa,Xa,Sb){var xc=M.$.na.ta,jd=M.mz,vd=xc.Na(41,null);vd.shouldEnablePresentMode=jd;return ha.i(xc,"SetPresentMode",vd,oa,Xa,Sb,null,0)},function(oa){return new Kc.a(252,
0,oa)},null)};Ne.prototype.fWf=function(){var M=Ae.a(this.gridView.We);1!==this.gridView.We||this.$.pa.activeRange.isSingle||(M="Range");this.Ouc[M]=this.Ouc[M]?this.Ouc[M]+1:1};Ne.prototype.blj=function(M,oa){var Xa=this.Soc[oa]?this.Soc[oa]:0;this.Soc[oa]=Xa>M?Xa:M;this.Roc[oa]=this.Roc[oa]?this.Roc[oa]+1:1};Ne.prototype.pwi=function(){var M={},oa=Dg.HelperMethods.lc()-this.lJf;M.PresentModeDuration=oa;M.SelectionCountPerObject=zh.a.toJSON(this.Ouc);M.OverlayCountPerCaller=zh.a.toJSON(this.Roc);
M.OverlayDurationPerCaller=zh.a.toJSON(this.Soc);oa=this.Lca.y_h();for(var Xa in oa)M[Xa]=oa[Xa];gf.b(this.$).fe(yc.a.v1i,M,void 0,!0)};Qk.Object.defineProperties(Ne.prototype,{mz:{configurable:!0,enumerable:!0,get:function(){return this.M9d}}});Object(pe.a)(Ne,"PresentModeManager",null,[426,2]);var rj=b(335),pj=gg.a;vm(Ad,pj);Ad.prototype.create=function(){var M=this,oa=vg.GetServiceTaskFactory.Wa(this.$.da,283,284,1);oh.TaskExtensions.Ba(oa,function(){oh.TaskExtensions.Ba(rj.c(oa.result.Sn.loadScript("presentMode")),
function(){var Xa=M.$.da.Aa(423);Xa||(Xa=new Ne(M.$),M.$.da.Ha(423,Xa));M.Gb(Xa)},M.$.ma,3)},this.$.ma,3)};Ad.ka=function(M){M.da.Ha(424,new Ad(M))};Object(pe.a)(Ad,"PresentModeManagerFactory",gg.a,[]);var mj=b(169),Eg=b(158),Nj=b(675),Kj=b(83),$i=b(28);wd.kth="ewa-resizehdr-row-hidden";wd.jth="ewa-resizehdr-col-hidden";Object(pe.a)(wd,"CssClassNames",null,[]);var Fi=b(60),Hj=b(24),nk=b(141),ok=b(53),hj=b(69),Rh=b(246),Ck=b(372);Object(pe.a)(fd,"HeaderEventCachedInfo",null,[]);Rb.prototype.BCe=function(M){return Math.max(0,
Math.min(Rb.dqf,Dg.HelperMethods.wDd(M)))};Rb.prototype.sCe=function(M){return this.TZi(M)};Rb.prototype.m_g=function(M){return Math.round(this.z7c*M+2*this.FZe()+1)};Rb.prototype.TZi=function(M){return Math.max(0,Math.min(Rb.Npf,(Math.max(0,Math.min(Gg.a.ykc,M))-2*this.FZe()-1)/this.z7c))};Rb.prototype.FZe=function(){return Math.floor(Math.max((this.z7c+3)/4,2))};Rb.prototype.lbc=function(M,oa){return oa?M?Rb.dqf:Gg.a.Ovd:M?Rb.Npf:Gg.a.ykc};Rb.dqf=409;Rb.Npf=255;Object(pe.a)(Rb,"ResizeHeadersConverter",
null,[]);var fk=b(34),al=Kj.a;vm(Zc,al);Zc.prototype.COa=function(M,oa,Xa){this.k1i(M,oa,Xa);M=this.Dxc();this.Ocd(this.ASa,M,!0);this.Qza||(mj.a.instance.qa(kg.a.fh,this.domElement.ownerDocument.body,this.Ozd),this.Qza=!0)};Zc.prototype.dispose=function(){this.z0c();this.grid.ha&&(this.grid.ha.lda(this.Xh),this.grid.ha.mda(this.sr));this.grid.ot(this.Xh);Ah.a(this.grid.$)&&Ah.a(this.grid.$).sg.Pma(this.DF);wj.a.instance.za(kg.a.gk,this.domElement,this.mca);mj.a.instance.za(kg.a.Zd,this.domElement.ownerDocument.body,
this.Kmc);Eg.a.instance.za(kg.a.ze,this.domElement.ownerDocument.body,this.Kmc);Ff.a.Wp||(mj.a.instance.za(kg.a.pointerDown,this.domElement,this.RN),mj.a.instance.za(kg.a.fh,this.domElement,this.PR));this.Qza&&(mj.a.instance.za(kg.a.fh,this.domElement.ownerDocument.body,this.l9a),Eg.a.instance.za(kg.a.xg,this.domElement.ownerDocument.body,this.l9a),this.Qza=!1);this.lG&&(mj.a.instance.za(kg.a.pointerDown,this.lG,this.RN),wj.a.instance.za(kg.a.gk,this.lG,this.mca),this.z0c(),this.lG=null);this.XTf&&
(Fe.DOMElementExtensions.Tf(Zc.Bbb),Zc.Bbb=null);this.qf=null;al.prototype.dispose.call(this)};Zc.prototype.n9i=function(){wj.a.instance.qa(kg.a.gk,this.domElement,this.mca);mj.a.instance.qa(kg.a.Zd,this.domElement.ownerDocument.body,this.Kmc);Eg.a.instance.qa(kg.a.ze,this.domElement.ownerDocument.body,this.Kmc);Ff.a.Wp||(mj.a.instance.qa(kg.a.pointerDown,this.domElement,this.RN),mj.a.instance.qa(kg.a.fh,this.domElement,this.PR))};Zc.prototype.emh=function(){if(!Zc.Bbb){document.getElementById(Zc.WTf);
this.XTf=!0;var M=Zc.Bbb=document.createElement("div");this.grid.$.frame.Jaa().appendChild(M);M.id=Zc.WTf;M.className=$i.a.lth;Fe.DOMElementExtensions.setVisible(M,!1)}};Zc.prototype.FLe=function(){this.Qza&&(mj.a.instance.za(kg.a.fh,this.domElement.ownerDocument.body,this.l9a),Eg.a.instance.za(kg.a.xg,this.domElement.ownerDocument.body,this.l9a),this.Qza=!1);this.zba=!1;this.fjj();this.JId();Ck.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};Zc.prototype.fjj=function(){this.grid.Ob.kl([this.isRow?
13:14]);this.grid.Ob.ldb()};Zc.prototype.Ozd=function(){return!0};Zc.prototype.Ocd=function(M,oa,Xa){this.eN&&Xa&&(ud.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.JId());this.eN||Xa||ud.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.nud&&this.nud(function(){var Sb={};return Sb.Location=
"canvas",Sb});this.eN?this.$We(oa):(this.eN=document.createElement("div"),this.eN.id=this.i7h,this.$We(oa),this.eN.className=$i.a.crh,oa=document.getElementById(this.grid.$.Jb+E.a.Hrf),oa.insertBefore(this.eN,oa.firstChild),M=fk.a(this.grid.$).Jja(M),this.eN.style.left=(this.rtl?Math.max(M.x-this.eN.offsetWidth,0):M.x-Math.max(M.x+this.eN.offsetWidth-oa.offsetWidth,0)).toString()+"px",oa=document.getElementById(E.a.$Fa),this.eN.style.top=(M.y-(Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.ph?
0:oa.offsetHeight)-this.eN.offsetHeight).toString()+"px")};Zc.prototype.JId=function(){Fe.DOMElementExtensions.Tf(this.eN);this.eN=null};Zc.prototype.$We=function(M){var oa=new Rb(this.grid.$.workbookContext.DxDigitNormal);this.eN.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.e7h:this.n7h,this.isRow?oa.BCe(M).toFixed(2):oa.sCe(M).toFixed(2),M.toString(),this.h7h)};Zc.prototype.YIf=function(M,oa){var Xa;if(-1!==this.grid.ha.selectionType||2===M.yb&&M.Ea.button!==Sys.UI.MouseButton.leftButton||
!this.Brd(Xa=this.$ed(M))||!this.ghf)return!1;hj.g(M.Ea);this.ASa=this.B7a=new Sys.UI.Point(M.clientPoint.x,M.clientPoint.y);this.qTg(Xa,oa);if(!this.uq)return!1;this.zba=!0;this.Dmi(this.uq,Xa)&&this.cai();return this.ZIf(oa)};Zc.prototype.k1i=function(M,oa,Xa){this.uq=M;this.ASa=this.B7a=new Sys.UI.Point(oa,Xa);this.ZIf(!1)};Zc.prototype.ZIf=function(M){var oa={};gf.b(this.grid.$).fe(yc.a.Xhj,(oa.IsResizingHiddenHeader=this.jWa,oa.IsAutoFitting=M,oa.NumberOfSelectedRanges=this.grid.ha.va.TK,oa.Location=
"canvas",oa));this.vIb=this.grid.Rx?this.vPh():this.led();this.offset=this.uq.Qaa();this.dm=this.uq.Bja();if(this.dm===Gg.a.D5a)return!1;Ck.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};Zc.prototype.Dmi=function(M,oa){var Xa=this.uq.aK();if(!Xa)return ud.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Xa=Xa.nextSibling;if(!Xa)return!1;M=M.getRange();Xa=this.qf.ava(Xa).getRange();if(!M||!Xa)return ud.ULS.shipAssertTag(537154048,
2,!1,"IsResizingHidden: range is null"),!1;var Sb=kf.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");M=Sb&&this.isRow?M.bottom:M.right;Xa=Sb&&this.isRow?Xa.bottom:Xa.right;return M+1!==Xa&&M!==Xa&&this.Brd(oa,!0)};Zc.prototype.cai=function(){var M=this.uq.aK(),oa=this.qf.ava(M.nextSibling);Zc.Emi(oa,this.isRow)?(this.uq=oa,this.Z6=this.uq.getRange()):(this.uBg(M),this.uq=oa,M=this.uq.getRange(),this.Z6=this.isRow?new Hj.Range(M.top-1,M.left,M.top-1,M.right,!1,!0):new Hj.Range(M.top,
M.left-1,M.bottom,M.left-1,!1,!0),this.jWa=!0)};Zc.prototype.uBg=function(M){var oa=this.qf.ava(M.nextSibling),Xa=Zc.b7g(oa,this.isRow,this.rtl);Xa&&M.parentNode.insertBefore(Xa,oa.aK())};Zc.prototype.M2e=function(M){var oa=this.Z6,Xa=M.ha.va.selectedRanges;if(M.ha.va.asb(oa))if(this.isRow){if(va.a.all(Xa,function(Sb){return Sb.isRow}))return Xa}else if(va.a.all(Xa,function(Sb){return Sb.Rh}))return Xa;return[oa]};Zc.prototype.vPh=function(){return this.uq.Bja()-Zc.ycc};Zc.prototype.led=function(){var M=
this.uq.aK().style;return Math.max(0,Math.min(this.Ppf,0|parseInt(this.isRow?M.height:M.width,10)))};Zc.prototype.Dxc=function(M){M=void 0===M?0:M;var oa=this.grid,Xa=this.qf.vj.paneType;Xa=this.isRow?3===Xa?[3,2]:[1,4]:4===Xa?[2,4]:[1,3];var Sb=oa.view.visibleArea.bottomRight,xc=this.uq.Bja();xc===Gg.a.D5a&&(xc=0);M=this.jWa?Math.max(this.led(),0):Math.max(xc+M,0);Sb=this.isRow?new yi.a(0,this.offset,Sb.x,M):new yi.a(this.offset,0,M,Sb.y);xc=[this.isRow?13:14];oa.Ob.Ml(Hj.Range.ld(1,1),xc,!1);oa.Ob.xs(xc,
Sb,Xa);return M};Zc.prototype.z0c=function(){this.Z6=this.ASa=this.B7a=null;if(this.P0){var M=this.P0.parentNode;if(M)for(M.removeChild(this.P0);this.P0.firstChild;)M.appendChild(this.P0.firstChild);this.P0=null}this.uq=null;Fe.DOMElementExtensions.setVisible(Zc.Bbb,!1);this.zba=!1;this.JId();Fe.DOMElementExtensions.setVisible(this.lG,!1)};Zc.prototype.$ed=function(M){if(Fe.DOMElementExtensions.kz(M.Ub,"a"))return null;var oa=this.Cif(M.Ea);if(oa&&this.grid.ha.va.qh){var Xa=this.grid.ha.va.Td;Xa=
this.qf.Us(Hj.Range.ld(Xa.bottom,Xa.right))}else Xa=this.qf.ava(M.Ub);if(!Xa)return null;var Sb=Xa.aK(),xc=new Sys.UI.Bounds(Sb.offsetLeft,Sb.offsetTop,Sb.offsetWidth,Sb.offsetHeight),jd=Fe.DOMElementExtensions.getBoundingClientRect(M.Ub);jd=new Sys.UI.Point(M.clientPoint.x-jd.x,M.clientPoint.y-jd.y);this.isRow&&!oa&&(jd.y+=Dg.HelperMethods.XA(M.Ub,Sb,this.rtl).y);return new fd(Sb,jd,xc,Xa.getRange(),Math.max(Zc.oBi,Math.min(Zc.aAi,(this.isRow?xc.height:xc.width)*Zc.gij)),oa,!this.isRow&&0<Sb.getElementsByTagName("input").length)};
Zc.prototype.Brd=function(M,oa){oa=void 0===oa?!1:oa;if(!M||this.grid.isEditing)return!1;if(M.Bif)return!0;var Xa=M.lOa,Sb=M.Abb,xc=this.qf.vj.paneType,jd=this.grid.Sf(xc).Jh,vd=!!jd&&jd.top===M.Ajd.top,ae=!!jd&&jd.left===M.Ajd.left;xc=!!jd&&jd.bottom===M.Ajd.bottom&&(3===xc||2===xc);this.isRow?(ae=M.VBb.y,M=ae<=Sb&&!vd,Xa=ae>=Xa.height-Sb-(xc?Zc.sGh:0),oa=oa?M:Xa||M):(xc=M.m6h,vd=this.rtl,jd=M.VBb.x,M=jd<=Sb&&(!ae||vd)&&(!xc||!vd),Xa=jd>=Xa.width-Sb&&(!vd||!ae)&&(!xc||vd),oa=oa?vd?Xa:M:M||Xa);return oa};
Zc.prototype.qTg=function(M,oa){var Xa=this.isRow;if(M.Bif)this.uq=this.qf.ava(M.Pva);else if(Xa&&M.VBb.y<=M.Abb&&M.lOa.height>M.Abb||!Xa&&M.lOa.width>M.Abb&&(!this.rtl&&M.VBb.x<=M.Abb||this.rtl&&M.VBb.x>=M.lOa.width-M.Abb)){if(this.uq=M.Pva.previousSibling?this.qf.ava(M.Pva.previousSibling):this.XSh(),oa&&M.Pva.classList.contains(Xa?$i.a.DRe:$i.a.CRe)&&(M=this.qf.ava(M.Pva)))M=M.getRange(),this.Z6=Xa?new Hj.Range(M.top-1,M.left,M.top-1,M.right,!1,!0):new Hj.Range(M.top,M.left-1,M.bottom,M.left-1,
!1,!0)}else this.uq=this.qf.ava(M.Pva);!this.Z6&&this.uq&&(this.Z6=this.uq.getRange())};Zc.prototype.XSh=function(){var M=this.isRow?1:0;return(M=this.qf.vj.oG(this.qf.vj.Ca.Gg(this.grid.$.pa,Fi.a.GM(this.qf.position.X+M-1,this.qf.position.Y-M,this.qf.position.PaneType))))?M.WSh():null};Zc.prototype.eci=function(){var M=this.hij;Fe.DOMElementExtensions.setVisible(M,!0);M.style.cursor=this.isRow?$i.a.OOe:$i.a.gNe;this.Dxc()};Zc.prototype.wlh=function(M){var oa={};this.grid.$.ye(this.isRow?745189930:
-445963340,na.a.dc,30,(oa.resizeRowColumnParameters=M,oa))};Zc.prototype.T$g=function(){var M=document.createElement("div");M.className=$i.a.kuh;var oa=document.createElement("div");oa.className=N.a.fr;M.appendChild(oa);var Xa=document.createElement("img");Xa.src=ok.a.Fe(0);Xa.className=this.isRow?N.a.ith:N.a.dth;oa.appendChild(Xa);this.qf.sA.domElement.parentNode.insertBefore(M,this.qf.sA.domElement);mj.a.instance.qa(kg.a.pointerDown,M,this.RN);wj.a.instance.qa(kg.a.gk,M,this.mca);Fe.DOMElementExtensions.setVisible(M,
!1);this.lG=M};Zc.prototype.asc=function(){this.z0c();this.lG&&(this.qf.sA.domElement.parentNode.removeChild(this.lG),this.lG=null)};Zc.prototype.Cif=function(M){return Fe.DOMElementExtensions.Pe(this.lG,M.target)};Zc.prototype.wpb=function(){this.zba&&(this.FLe(),Fe.DOMElementExtensions.CTa(this.uq.aK(),!this.isRow,this.vIb),this.asc(),this.jWa=!1)};Zc.prototype.Kef=function(){return kf.EwaSettings.la(707)};Zc.prototype.F$e=function(M){(M=M.Ea.rawEvent)&&M.detail===Zc.Qmj&&(M.type===kg.a.$p?(this.zba=
!1,this.DXc=!0):M.type===kg.a.cI&&(this.zba=!0,this.DXc=!1))};Zc.Y6g=function(M,oa){return new Zc(M,oa)};Zc.UOd=function(M,oa,Xa){if(oa)for(M.ColumnWidth=-1,M.RowHeight=Xa,M=yl(M.SheetMultiRange.Ranges),oa=M.next();!oa.done;oa=M.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(M.RowHeight=-1,M.ColumnWidth=Xa,M=yl(M.SheetMultiRange.Ranges),oa=M.next();!oa.done;oa=M.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};Zc.Emi=function(M,oa){if(!M||!M.aK())return ud.ULS.shipAssertTag(537154014,
2,!1,"header after hidden headers is null"),!1;var Xa=M.getRange();M=M.aK().style;if(!Xa||!M)return ud.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;M=oa?M.height:M.width;return(oa?Xa.top:Xa.left)===(oa?Gg.a.Kh:Gg.a.Wh)&&M===Zc.zhg};Zc.b7g=function(M,oa,Xa){if(!M)return ud.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Sb=M.aK();if(!Sb||!Sb.style)return ud.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;M=document.createElement("div");
var xc=Sb.style;M.style.top=oa?xc.top:Zc.zhg;oa||(Xa?M.style.right=xc.right:M.style.left=xc.left);M.classList.add(oa?wd.kth:wd.jth);M.classList.add(oa?$i.a.etb:$i.a.dtb);Xa=document.createElement("div");Xa.classList.add(oa?$i.a.rRe:$i.a.j$c);Sb=oa?Number.parseInvariant(Sb.innerText):Hj.Range.V_a(Sb.innerText);Xa.innerText=oa?(Sb-1).toString():Hj.Range.qU(Sb-1);M.appendChild(Xa);return M};Qk.Object.defineProperties(Zc.prototype,{ghf:{configurable:!0,enumerable:!0,get:function(){var M=(new nk.a(this.grid.$.xa)).ue(this.isRow?
16:8),oa=this.grid.$.Ab.QC,Xa=this.grid.Bi,Sb=Ah.a(this.grid.$).Cq();return M&&!oa&&!Xa&&!Sb}},hij:{configurable:!0,enumerable:!0,get:function(){this.emh();return Zc.Bbb}}});Zc.oBi=0;Zc.aAi=5;Zc.ycc=1;Zc.sGh=3;Zc.gij=.1;Zc.WTf="ewa-rszrbg";Zc.zhg="0px";Zc.Qmj=2;Zc.Bbb=null;Object(pe.a)(Zc,"HeaderResizeBehavior",Kj.a,[431]);var Rk=gg.a;vm(ld,Rk);ld.prototype.create=function(){this.Gb(Zc.Y6g)};ld.ka=function(M){M.da.Ha(136,new ld)};Object(pe.a)(ld,"HeaderResizeBehaviorFactory",gg.a,[]);var bl=b(418),
Cj=b(521),xk=b(67);Object(pe.a)(od,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[106]);Object(pe.a)(mc,"MacroRecorderSheetRowsColumnsResizedPayload",null,[106]);var Lk=ri.a;vm(Xb,Lk);Xb.prototype.pV=function(M,oa){var Xa={};return Xa[Xb.X4]=this.Bc,Xa[Xb.Qmi]=this.isRow,Xa[Xb.Aai]=M,Xa[Xb.zai]=oa,Xa[Xb.Rji]=this.Azb,Xa[Xb.nfd]=this.gvb,Xa};Xb.prototype.RTg=function(){var M=this.xJh();try{return this.UNh(M)}finally{M&&M.dispose()}};Xb.prototype.E4g=function(M){var oa={};oa.SheetMultiRange=Cf.r(this.gridView.ha.va.selectedRanges,
this.$);Xb.UOd(oa,this.isRow,M);M={};this.$.ye(this.isRow?745189930:-445963340,na.a.dc,8,(M.resizeRowColumnParameters=oa,M))};Xb.prototype.F4e=function(M,oa){return Jb.a.p5(M)?oa?this.q3g(M):this.s3g(M):Xb.kba};Xb.prototype.s3g=function(M){return Math.floor(parseFloat(M))};Xb.prototype.q3g=function(M){M=parseFloat(M);return 0>M?Xb.kba:M?this.isRow?Dg.HelperMethods.a_i(M):this.wtc.m_g(M):0};Xb.prototype.t3g=function(M){return M===Xb.kba?"":this.isRow?this.wtc.BCe(M).toString():this.wtc.sCe(M).toFixed(2)};
Xb.prototype.r3g=function(M){return M===Xb.kba?"":M.toString()};Xb.prototype.UNh=function(M){if(!M||!M.$$mn()||!M.eo)return Xb.kba;var oa=Object(Yf.a)(471,M.eo);if(!oa)return Xb.kba;for(oa=this.isRow?oa.Dxb:oa.Cld;M.$$mn();){var Xa=Object(Yf.a)(471,M.eo);if(Xa&&(this.isRow?Xa.Dxb:Xa.Cld)!==oa)return Xb.kba}return oa};Xb.prototype.xJh=function(){for(var M=[],oa=yl(this.gridView.ha.va.selectedRanges),Xa=oa.next();!Xa.done;Xa=oa.next()){Xa=Xa.value.clone();var Sb=this.gridView.Sf(this.gridView.$a.nj(Xa));
Sb=Xa.zf(Sb.Jh);if(!Sb)return null;this.isRow?Xa.right=Xa.left=Sb.left:Xa.top=Xa.bottom=Sb.top;Array.add(M,Xa)}return M.length?this.gridView.K$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",M):null};Xb.prototype.ofd=function(M){if(!Jb.a.p5(M))return 1;M=this.F4e(M,this.Azb);return!M&&this.Cmi()?3:this.tpi(M)?0:2};Xb.prototype.Cmi=function(){var M=this.gridView.ha.va.selectedRanges;return this.isRow&&Cf.P(M)||!this.isRow&&Cf.O(M)};Xb.prototype.Hcd=function(M){var oa="";switch(M){case 0:oa=
"";break;case 1:oa=qe.a.instance.fa(754);break;case 2:M=this.Azb;oa=String.format(qe.a.instance.Cb(98),0,this.lbc(M));break;case 3:oa=qe.a.instance.fa(755)}return oa};Xb.prototype.tpi=function(M){return 0<=M&&M<=this.lbc(!1)};Xb.prototype.lbc=function(M){return this.wtc.lbc(M,this.isRow)};Xb.UOd=function(M,oa,Xa){if(oa)for(M.ColumnWidth=Xb.kba,M.RowHeight=Xa,M=yl(M.SheetMultiRange.Ranges),oa=M.next();!oa.done;oa=M.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(M.RowHeight=Xb.kba,M.ColumnWidth=
Xa,M=yl(M.SheetMultiRange.Ranges),oa=M.next();!oa.done;oa=M.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};Qk.Object.defineProperties(Xb.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},Azb:{configurable:!0,enumerable:!0,get:function(){return Xb.Y9d},set:function(M){Xb.Y9d=M}}});Xb.X4="id";Xb.Qmi="isRow";Xb.Aai="initialSizeInPx";Xb.zai="initialSizeInDefaultUnits";Xb.Rji="isInitialUnitsDefaultUnits";Xb.nfd="getInputErrorIfInvalid";Xb.CDj="size";Xb.Hhi="isDefaultUnits";
Xb.kba=-1;Xb.Y9d=!0;Object(pe.a)(Xb,"ResizeHeadersDialog",ri.a,[]);var Dj=b(586);Va.prototype.Zc=function(M,oa){M=!0;switch(oa){case -445963340:case 1391094586:M=this.ue(8);break;case 745189930:case 146338636:M=this.ue(16)}return!M};Va.prototype.executeCommand=function(M,oa,Xa){var Sb=oh.TaskExtensions.nm();var xc=zg.g(this.$);M=qi.a.create().toString();var jd=oa.command;switch(jd){case 1391094586:case 146338636:var vd=1391094586===jd;(M=Xa.autoFitRanges)&&M.Ranges&&M.Ranges.length||(M=Cf.r(xc.ha.va.selectedRanges,
this.$));Sb=this.Zgh(vd?1:0,M,oa);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:vd=-445963340===jd||-706918724===jd||369708605===jd;if(-445963340===jd||745189930===jd)vd=bl.a(oa.command),xc.Li.z7(16,M,vd),Xa=Xa.resizeRowColumnParameters;else{var ae=xc.ha.va.selectedRanges;if(-706918724===jd&&6===oa.df&&Cf.O(ae)){ud.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");
break}if(1051390410===jd&&6===oa.df&&Cf.P(ae)){ud.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}xc=369708605===jd||1542466017===jd?-2:0;Xa={};Xa.SheetMultiRange=Cf.r(ae,this.$);if(vd)for(Sb=yl(Xa.SheetMultiRange.Ranges),jd=Sb.next();!jd.done;jd=Sb.next())jd=jd.value,jd.FirstRow=0,jd.LastRow=0;else for(Sb=yl(Xa.SheetMultiRange.Ranges),jd=Sb.next();!jd.done;jd=Sb.next())jd=jd.value,jd.FirstColumn=0,
jd.LastColumn=0;Xa.RowHeight=vd?-1:xc;Xa.ColumnWidth=vd?xc:-1}Sb=this.thh(Xa,oa,M);break;case 957527587:case 2040891415:new Xb(this.$,oa)}return Sb};Va.prototype.Kc=function(M,oa,Xa,Sb){if(M=!!Xa&&!!Sb&&1===Sb.wA)switch(oa.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:M=!1}return M};Va.prototype.gd=function(){return!1};Va.prototype.Ivi=function(M){ud.ULS.sendTraceTag(537154004,
0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",M.success,Object(Dj.c)(M)?void 0:M.reason)};Va.prototype.ue=function(M){return(new nk.a(this.$.xa)).ue(M)};Va.prototype.Zgh=function(M,oa,Xa){function Sb(){return new od(vd,oa)}var xc=this,jd=this.$.na.ta.$b(),vd=0===M;return Lb.a(this.$.userOperationManager,function(ae,Ie,Zf){var Vg=xc.$.na.ta,Gh=Vg.Na(41,jd);Gh.isRow=vd;Gh.autoFitRanges=oa;return ha.i(Vg,"AutoFit",Gh,ae,Ie,Zf,null,0)},function(ae){return new Kc.a(135,
0,ae,void 0,Sb)},Xa)};Va.prototype.thh=function(M,oa,Xa){function Sb(){return new mc(M)}function xc(Vg,Gh,pi){jd.$.ny();Cf.i(vd,",",jd.$,!1);var ij=jd.$.na.ta;Vg=lh.b(Vg,jd.PRi);var Fj=ij.Na(41,void 0===Zf?null:Zf);Fj.resizeRowColumnParameters=M;return ha.i(ij,"ResizeRowsColumns",Fj,Vg,Gh,pi,Xa,0)}var jd=this,vd=Cf.g(M.SheetMultiRange.Ranges),ae=oa.command;if(745189930===ae||-445963340===ae){ud.ULS.shipAssertTag(537154002,0,this.$.activeItemName===M.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");
var Ie=zg.g(this.$);ae=745189930===ae;Ie=this.Fh.MBj(Ie,vd,ae?M.RowHeight:M.ColumnWidth,ae);this.Ivi(Ie);Object(Dj.c)(Ie)&&zg.g(this.$).Li.L0(Xa,xk.BasicTelemetryCalculator.cR)}var Zf=this.$.na.ta.$b(!0);return Ie&&Object(Dj.c)(Ie)?kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,xc,function(Vg){return new Kc.a(136,0,Vg,64,Sb)},oa):Lb.a(this.$.userOperationManager,xc,function(Vg){return new Cj.a(136,0,Vg,void 0,Sb)},oa):Lb.a(this.$.userOperationManager,xc,function(Vg){return new Kc.a(136,0,Vg,
void 0,Sb)},oa)};Object(pe.a)(Va,"ResizeCommandHandler",null,[239]);var Vj=ch.a;vm(sa,Vj);sa.prototype.Pd=function(){var M=this,oa=vg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub);oh.TaskExtensions.Ba(oa,function(){M.Gd([new Va(M.$,oa.result)])},this.ma,3)};sa.ka=function(M){ch.a.he(113,new sa(M))};Object(pe.a)(sa,"ResizeCommandHandlerFactory",ch.a,[]);Nb.prototype.Zc=function(){return!1};Nb.prototype.executeCommand=function(M,oa,Xa){M=2;switch(oa.command){case -309686558:M=this.Fi.De(Tf.a.saveACopy,
2,Xa);break;case 617689800:M=this.Fi.De(Tf.a.saveToCloudStorage,2,Xa);break;case -1244760097:M=this.Fi.De(Tf.a.saveToSharePoint,2,Xa)}return 2===M&&oa?h.a(oa.command):Wg.Task.Ta(!0)};Nb.prototype.Kc=function(M,oa){M=!1;switch(oa.command){case -1244760097:case -309686558:case 617689800:M=!0,ud.ULS.shipAssertTag(537153984,0,this.$.Bka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return M};Nb.prototype.gd=function(){return!1};Object(pe.a)(Nb,"SaveToHostCommandHandler",
null,[239]);var Ij=ch.a;vm(Ib,Ij);Ib.prototype.Pd=function(){var M=this;oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){M.Gd([new Nb(M.$,Pd.AFrameworkApplication.Hb)])},this.ma,3);Pd.AFrameworkApplication.Hb.hc(Tf.a.VQa,kh.a.frame,this.jFh)};Ib.ka=function(M){ch.a.he(267,new Ib(M))};Object(pe.a)(Ib,"SaveToHostCommandHandlerFactory",ch.a,[]);Jc.prototype.Zc=function(M){switch(M){case -309686558:return 8===this.Fi.processAction(Tf.a.saveACopy,1,null);case 617689800:return 8===
this.Fi.De(Tf.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Fi.De(Tf.a.saveToSharePoint,1,null)}return!1};Jc.prototype.dispose=function(){this.$=null};Object(pe.a)(Jc,"SaveToHostManager",null,[430,2]);var aj=gg.a;vm(Mb,aj);Mb.prototype.create=function(){this.Gb(this.$.da.Aa(393)||new Jc(this.$,Pd.AFrameworkApplication.Hb))};Mb.ka=function(M){M.da.Ha(394,new Mb(M))};Object(pe.a)(Mb,"SaveToHostManagerFactory",gg.a,[]);var yk=Zi.a;vm(Sa,yk);Sa.prototype.execute=function(M){var oa=Object(Yf.a)(8,
M.Je);ud.ULS.shipAssertTag(537153921,0,Qg.a.Vnb(M.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");oa.lI(!0,!0);M.activityState[Vd.a.VXb]=oa.ea.sessionId;M.activityState[Vd.a.Imb]=!0;M.activityState[Vd.a.aYb]=!0;ud.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(pe.a)(Sa,"SessionReloadActivity",Zi.a,[]);var Qi=gg.a;vm(ib,Qi);ib.prototype.create=function(){this.Gb(new Sa(zb.a.fcb,
zb.a.Bk))};ib.ka=function(M){M.da.Ha(142,new ib)};Object(pe.a)(ib,"SessionReloadActivityFactory",gg.a,[]);var sk=b(54),hl=b(259),Sk=b(106),cl=b(46),Hi=b(243),ak=b(111),Dk=Zi.a;vm(Tb,Dk);Tb.prototype.execute=function(M){var oa=Object(Yf.a)(8,M.Je);M.activityState[Vd.a.Era]=!0;var Xa=Tb.sZh(M);if(Tb.yxj(M,Xa))return Tb.qzi(M),Xa=50,0<M.errors.length&&(Xa=15),ud.ULS.sendTraceTag(537153891,0,Xa,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",Qg.a.Uc(M.errors)),
M.activityState[Vd.a.Era]=!1,this.vh(zb.a.idle),3;switch(Xa){case 1:case 3:this.Nci(M,Xa);break;case 2:this.Mci(M);break;case 0:M.activityState[Vd.a.jYa]=null}ud.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",Xa,this.activityName,this.E_,oa.ea.K7);var Sb=Qj.a.yg(M.activityState,ak.a.seb);ud.ULS.shipAssertTag(40502925,0,!Sb||Sb&&(1===Xa||3===Xa),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",
Sb,Xa);oa=oa.Kk.reloadCount;return 0!==Xa&&0<oa?(Sb=hl.a.vva(oa,200),ud.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Xa,oa,Sb,this.activityName),sh.a.instance.create(function(){Tb.HJ(M)},Sb,xj.a.Epj),1):3};Tb.prototype.Nci=function(M,oa){ud.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Xa=Object(Yf.a)(8,M.Je);M.activityState[Vd.a.Imb]=
!0;Xa.efc||cl.PageLoadTrackingInfo.instance.Jj("ReopenOnLoad");!Tb.isEditMode(M)&&Qg.a.Vnb(M.errors)&&(ud.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),M.activityState[Vd.a.VXb]=Xa.ea.sessionId,M.activityState[Vd.a.aYb]=!0);M.Cvd();3===oa?(Xa.ea.Mg()||Xa.ea.cFi(),Xa.lI(!0,!0),this.vh(this.EMj),M.activityState[Vd.a.ele]=Xa.workbookContext.CalcMode):(kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===oa&&Xa.lI(!0,!0),M.activityState[Vd.a.HTc]=!1,this.vh(this.Jxc))};Tb.prototype.Mci=function(M){ud.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");M.activityState[Vd.a.jYa]=null;M.Cvd();this.vh(this.vDj);M=Object(Yf.a)(8,M.Je);M.efc||(cl.PageLoadTrackingInfo.instance.Jj("RefreshOnLoad"),M.xHb())};Tb.HJ=function(M){M.HJ()};Tb.sZh=function(M){var oa=Object(Yf.a)(8,M.Je),Xa=oa.ea,Sb=Tb.isEditMode(M),xc=Qg.a.kh(M.errors,Sb?Tb.ovd:Tb.pvd),
jd=Qg.a.kh(M.errors,Sb?Tb.epf:Tb.fpf),vd=oa.dR,ae=oa.Kk.reloadCount,Ie=oa.ya.MaxConsecutiveSilentReloadAllowed,Zf=oa.Kk.j8e(),Vg=Qg.a.Uc(M.errors),Gh=Qg.a.Uc(M.lza),pi=0<Qg.a.SM(function(Pj){return!Pj.triggerSilentReopenOnly},M.errors).length,ij=xc,Fj=Qj.a.yg(M.activityState,ak.a.seb);Fj&&(ij=!0);xc={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Sb,isSilentReopenError:xc,isSilentRefreshError:jd};xc.reloadSequenceCount=oa.Kk.fQa;xc.reloadCount=ae;xc.maxReloads=Ie;xc.stopSilentReloads=
Zf;xc.errorNames=Vg;xc.processedErrorNames=Gh;xc.isClientDirty=vd;xc.errorsForSilentReopenOnly=pi;xc.triggerSilentReloadAfterTokenRefresh=Fj;xc.IsReopenDisabled=oa.AMa;vd=sk.a.Lc(xc);ud.ULS.sendTraceTag(21837004,0,50,vd);if(!Zf){if(ij&&(Sb?Tb.oxj(M):Tb.qxj(M)))return Hi.a.j2f(M,oa)?3:oa.AMa?2:1;if(jd&&(Sb||!Xa.sab))return 2}return 0};Tb.yxj=function(M,oa){for(var Xa=yl(M.errors),Sb=Xa.next();!Sb.done;Sb=Xa.next())if(Sb=Sb.value,-1337545025===Sb.MessageId||-238814601===Sb.MessageId)return!1;return Qg.a.SM(function(xc){return!xc.triggerSilentReopenOnly},
M.errors).length?3!==oa:!1};Tb.qzi=function(M){var oa=Qg.a.SM(function(Sb){return!Sb.triggerSilentReopenOnly},M.errors);oa=yl(oa);for(var Xa=oa.next();!Xa.done;Xa=oa.next())M.vla(Xa.value)};Tb.isEditMode=function(M){var oa=Object(Yf.a)(8,M.Je);return oa.ea.rc?oa.Uu&&!!(oa.Jd&64):Qj.a.yg(M.activityState,Vd.a.Ks)};Tb.qxj=function(M){var oa=Object(Yf.a)(8,M.Je),Xa=Qg.a.maa(M.errors,Tb.pvd);if(Sk.b(Xa,function(Sb){return Sb.ForceVersionUpgrade}))return!1;M=Qg.a.Vnb(M.errors);return!oa.ea.sab||M?!0:!1};
Tb.oxj=function(M){M=Qg.a.maa(M.errors,Tb.ovd);return!Sk.b(M,function(oa){return oa.ForceVersionUpgrade})};Tb.pvd=null;Tb.ovd=null;Tb.fpf=null;Tb.epf=null;Object(pe.a)(Tb,"SessionReloadSilentActivity",Zi.a,[]);var ug=gg.a;vm(Ab,ug);Ab.prototype.create=function(){this.Gb(new Tb(this.activityName,this.JM,zb.a.Bk,zb.a.qj,zb.a.KMb))};Ab.ka=function(M){M.da.Ha(143,new Ab(zb.a.pna,zb.a.R_b));M.da.Ha(144,new Ab(zb.a.ovc,zb.a.VOa));M.da.Ha(145,new Ab(zb.a.pvc,zb.a.cCd));M.da.Ha(154,new Ab(zb.a.gcb,zb.a.ZO))};
Object(pe.a)(Ab,"SessionReloadSilentActivityFactory",gg.a,[]);kc.prototype.getSheetName=function(){return this.sheetName};kc.prototype.getValue=function(){return this.value};Object(pe.a)(kc,"MacroRecorderSheetOptionToggledPayload",null,[106]);Fa.prototype.Zc=function(){return!1};Fa.prototype.executeCommand=function(M,oa){function Xa(){return new kc(Sb.SheetName,Zf)}var Sb={};this.$.Bj(Sb);M=oa.command;var xc=Object(Yf.a)(af.a,this.$.xa.getItemByName(Sb.SheetName));if(!xc)return h.a(M);switch(M){case 705559150:case -1411193626:var jd=
16;var vd=!xc.hideGridLines;var ae=mb;var Ie=183;var Zf=xc.hideGridLines;break;case -2052321504:case 515737500:jd=4;vd=!xc.headersVisible;ae=Wa;Ie=184;Zf=!xc.headersVisible;break;case -1478455630:jd=2;vd=!xc.displayRtl;ae=cb;Ie=185;Zf=!xc.displayRtl;zg.g(this.$).Ca.wRj(vd);break;default:return h.a(M)}xc.Epb(jd,vd);var Vg=this.$.na.ta;return Lb.a(this.$.userOperationManager,function(Gh,pi,ij){return ae(Vg,Sb.SheetName,Zf,lh.b(Gh,function(Fj){Fa.fEb(Fj,xc,jd,vd)}),lh.a(pi,function(){Fa.lDb(xc,jd,vd)}),
ij,null)},function(Gh){return new Kc.a(Ie,0,Gh,void 0,Xa)},oa)};Fa.prototype.Kc=function(M,oa){M=!1;switch(oa.command){case -1411193626:case 515737500:case -1478455630:M=!0;break;case 705559150:case -2052321504:M=Ck.a(this.$)}return M};Fa.prototype.gd=function(){return!1};Fa.fEb=function(M,oa,Xa,Sb){Qg.a.dr(M.Errors)&&oa.Epb(Xa,!Sb)};Fa.lDb=function(M,oa,Xa){M.Epb(oa,!Xa)};Object(pe.a)(Fa,"SheetOptionsToggleCommandHandler",null,[239]);var tk=ch.a;vm(ta,tk);ta.prototype.Pd=function(){this.Gd([new Fa(this.$)])};
ta.ka=function(M){ch.a.he(100,new ta(M))};Object(pe.a)(ta,"SheetOptionsToggleCommandHandlerFactory",ch.a,[]);var vi=b(61),Tk=b(202),uk=Tk.a;vm(ra,uk);ra.prototype.initialize=function(){var M=this.$.Jb+"iframeDialog_frame",oa=this.$.Jb+"iframeDialog";var Xa=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',M,this.v_e(oa));this.Pb.style.margin=Dg.HelperMethods.Rb(0);this.Pb.style.marginBottom=Dg.HelperMethods.Rb(-2);this.Pb.innerHTML=Xa;this.EJc=document.getElementById(M);
this.domElement.id=oa;this.onResize(null,Sys.EventArgs.Empty);Ff.a.vgc&&sh.a.instance.create(this.Ilh,50,xj.a.Q8h,!0,!0);uk.prototype.initialize.call(this)};ra.prototype.dispose=function(){this.$&&this.$.kD(this.onResize);uk.prototype.dispose.call(this)};ra.prototype.setFocus=function(){Fe.DOMElementExtensions.setFocus(this.iLa)};ra.prototype.onHide=function(){this.iLa.contentWindow.close();Fe.DOMElementExtensions.Tf(this.iLa);this.EJc=null;uk.prototype.onHide.call(this)};ra.prototype.gSj=function(M){var oa=
this.domElement.style;oa.width=Dg.HelperMethods.Rb(M.x);oa.marginLeft=Dg.HelperMethods.Rb(-M.x/2)};ra.prototype.aSh=function(){var M=Fe.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*M.width),this.bHe.x),Math.min(Math.floor(.9*M.height),this.bHe.y))};Qk.Object.defineProperties(ra.prototype,{iLa:{configurable:!0,enumerable:!0,get:function(){return this.EJc}}});Object(pe.a)(ra,"IFrameDialog",Tk.a,[]);vm(Ba,ra);Ba.prototype.v_e=function(M){var oa=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);
Yg.a.Xf(oa,E.a.Pnh,M);sb.a(this.$.ya,34)&&Yg.a.Xf(oa,E.a.hNe,"1");sb.a(this.$.ya,35)&&Yg.a.Xf(oa,E.a.iNe,"1");return oa.toString()};Ba.prototype.onShow=function(){ud.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");ra.prototype.onShow.call(this)};Qk.Object.defineProperties(Ba.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(pe.a)(Ba,"EmbeddingDialog",ra,[]);O.z1f="FrameDialog_ShareFromEdit";O.view="FrameDialog_View";
O.Jze="FrameDialog_CloseAndRefresh";O.xwj="FrameDialog_ShareFromView";O.edit="FrameDialog_Edit";O.E8i="FrameDialog_RefreshGrid";O.GZg="FrameDialog_CloseMe";O.Tze="FrameDialog_CloseMeError";O.ready="FrameDialog_Ready";O.$Zi="FrameDialog_PleaseClose";O.uH="GotoRange";Object(pe.a)(O,"PostMessageConstants",null,[]);var Ek=b(105);Object(pe.a)(Qb,"SessionUpdateContext",null,[]);vm(dc,ra);dc.prototype.KFg=function(M){this.addHandler(dc.etd,M)};dc.prototype.Xcj=function(M){this.removeHandler(dc.etd,M)};dc.prototype.dispose=
function(){hg.a.Fa(this.F0a);this.F0a=null;ra.prototype.dispose.call(this)};dc.prototype.initialize=function(){ra.prototype.initialize.call(this);var M=fg.a.Oaa(this.$.ya.FormLightBoxUrl),oa=this.F0a=new tc.a(this.iLa.contentWindow,M);oa.isEnabled()&&oa.qFa(M)&&(this.Jma(O.z1f,this.roc),this.Jma(O.view,this.roc),this.Jma(O.Jze,this.roc),this.Jma(O.xwj,this.dTi),this.Jma(O.edit,this.MKi),this.Jma(O.E8i,this.roc),this.Jma(O.ready,this.uRi),this.Jma(O.GZg,this.cwf),this.Jma(O.Tze,this.cwf))};dc.prototype.close=
function(M){M===this.closeAction&&this.vff&&this.F0a.send(new Tj.a(O.$Zi))||ra.prototype.close.call(this,M)};dc.prototype.v_e=function(){return this.XDe(this.jhc)};dc.prototype.XDe=function(M){var oa=this.$.ya,Xa=new Sys.StringBuilder(oa.FormLightBoxUrl);Yg.a.Xf(Xa,E.a.GFh,this.$.ea.sessionId);Yg.a.Xf(Xa,E.a.EFh,M?E.a.FFh:E.a.DFh);Ug.a.aGa(Xa,oa);return Xa.toString()};dc.prototype.Jeg=function(M){this.SKc=!1;this.iLa.src=this.XDe(M);this.N9d=M};dc.prototype.Jma=function(M,oa){this.F0a.Xn(M);this.F0a.Jl(M,
oa)};dc.prototype.jnc=function(M){var oa=this.$.ea.xa.getItemByName(M.uH.SheetName);oa&&0===oa.ty&&zg.g(this.$).Ug(M.uH,null,null,null,20,Ek.a.oFh)};Qk.Object.defineProperties(dc.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},vff:{configurable:!0,enumerable:!0,get:function(){return this.SKc}},jhc:{configurable:!0,enumerable:!0,get:function(){return this.N9d}}});dc.Uch=900;dc.vch=1200;dc.etd="lightBoxReady";Object(pe.a)(dc,"FormDialog",ra,[209]);var Di;(function(M){M[M.comment=
10]="comment";M[M.range=12]="range";M[M.table=13]="table";M[M.chart=14]="chart"})(Di||(Di={}));Object(pe.b)("NavigationType",Di);var Fk=b(1015),Jj=b(112),il=b(580),pk=b(1072),Gk=b(278),gk=b(851),zk=gk.a;vm(Kb,zk);Kb.prototype.initialize=function(){var M="<div class='"+Jj.a.io+"'>\r\n\t<div class='"+Jj.a.xNe+"'>\r\n\t\t<div class='"+N.a.P0c+"'>\r\n\t\t\t<img src='{0}' class='"+N.a.NQe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Jj.a.BNe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";
M=String.format(M,ok.a.Fe(13),qe.a.instance.fa(25),qe.a.instance.fa(this.message));this.Pb.innerHTML=M;this.addButton(0,this.JGi);this.addButton(1);zk.prototype.initialize.call(this)};Kb.prototype.nx=function(){return this.c_d};Qk.Object.defineProperties(Kb.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},Qw:{configurable:!0,enumerable:!0,get:function(){return 1005}},Osa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(pe.a)(Kb,
"WebMethodConfirmationDialog",gk.a,[]);var kk=Fk.a;vm(jc,kk);jc.prototype.dispose=function(){this.tTa&&this.tTa.hda(this.eFf);hg.a.sc([this.textBox,this.bRa,this.tTa]);this.tTa=this.bRa=this.textBox=null;kk.prototype.dispose.call(this)};jc.prototype.initialize=function(){var M="<div class='"+Jj.a.io+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Jj.a.Vsb+"'>\r\n\t<input type='text' id='{1}' class='"+Jj.a.wC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
M=String.format(M,qe.a.instance.fa(1229),"sfd_input","sfd_unshare",N.a.Wo,qe.a.instance.fa(1230));this.Pb.innerHTML=M;this.textBox=new Gk.a(this.getElementById("sfd_input"));this.bRa=new pk.a(this.textBox.domElement);this.tTa=il.a.create(this.getElementById("sfd_unshare"));this.tTa.A2(this.eFf);this.textBox.text=qe.a.instance.fa(723);this.textBox.enabled=!1;this.textBox.readOnly=!Ff.a.ah;this.addButton(1,10);kk.prototype.initialize.call(this)};jc.prototype.vha=function(){var M=this;return function(oa,
Xa,Sb){var xc=M.$.na.ta.$b(),jd=M.$.na.ta;oa=M.qja(oa);Xa=M.Faa(Xa);xc=jd.Na(1,xc);return ha.i(jd,"ShareForm",xc,oa,Xa,Sb,null,0)}};jc.prototype.Zx=function(M,oa,Xa){this.textBox.text=M.Result;this.textBox.enabled=!0;Fe.DOMElementExtensions.setVisible(this.tTa.domElement,!0);kk.prototype.Zx.call(this,M,oa,Xa)};jc.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(M){}kk.prototype.setFocus.call(this)};Qk.Object.defineProperties(jc.prototype,{Bc:{configurable:!0,
enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(pe.a)(jc,"ShareFormDialog",Fk.a,[]);var Hk=b(668),bj=b(133),Mk=b(250),si=b(15),Wj=P.a;vm(Ub,Wj);Ub.prototype.Zc=function(M,oa){M=this.$.workbookContext.FullDocumentInfo;switch(oa){case 353606613:case -1099009678:case 192430811:return!kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return oa=Mk.a()&&this.$.ea.oh.get(5),!M.FileSharingUrl&&
!oa;case -1570751769:case 1986648902:return 131072!==(this.$.RM&131072);case 330035228:return!(this.P2a(!0)&&this.RCc);case -509039657:return!(this.P2a()&&this.RCc);case 1334518759:return!(this.P2a()&&this.RCc&&this.zwe())}return!1};Ub.prototype.executeCommand=function(M,oa,Xa){M=this.$.workbookContext.FullDocumentInfo;var Sb=Tf.a.workflow,xc=oh.TaskExtensions.nm(),jd=oa.command;if(jd===Sb||-266099===jd)return this.X5h(oa,Sb,M);switch(jd){case 1986648902:this.M0f();break;case -1570751769:this.I3h(oa);
break;case 869186573:oa=Tf.a.wwj;xc=Pd.AFrameworkApplication.ga.ra("ShareMenuIsEnabled");Sb=null;(kf.EwaSettings.la(580)||xc)&&Xa&&"CopyLink"===Xa.SourceControlId?(Sb={},Sb[Ag.a.aKb]="copy",oa=Tf.a.y1f):xc&&Xa&&"ManageAccess"===Xa.SourceControlId?(Sb={},Sb[Ag.a.aKb]="manageAccess",oa=Tf.a.ywj):Xa&&"LinkToComment"===Xa.SourceControlId&&(Sb={},Sb[Ag.a.aKb]="copy",Sb[Ag.a.A1f]=Xa.navId,oa=Tf.a.y1f);xc=this.T4f(M,Sb);Wi.c(oa);break;case -1099009678:xc=this.EPd(12,M);break;case 192430811:xc=this.EPd(13,
M);break;case 353606613:xc=this.EPd(14,M);break;case -59906385:case 1197060601:this.j5h(oa,M);break;case 1305810481:this.I6e(!1,oa);break;case 330035228:this.I6e(!0,oa);break;case -509039657:this.deleteForm();break;case 1334518759:oa.syb=!0;this.shareForm();break;case 710925581:ad.a.Rf.Gwc("710925581")&&(xc=oh.TaskExtensions.Ba(this.bK.value,function(vd){vd.result.Rj(Jf.a.conversation,{})},this.ma,3));break;case 327119921:this.y3h();break;default:xc=h.a(jd)}return xc};Ub.prototype.Kc=function(M,oa){M=
!1;oa=oa.command;if(oa===Tf.a.workflow)return!0;switch(oa){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:M=!0;break;case 353606613:case -1099009678:case 192430811:M=kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return M};Ub.prototype.gd=function(M,oa,Xa){if("PopulateFormMenu"===oa){oa=this.RCc?
this.zwe()?Ub.Azh:Ub.Bzh:Ub.SDi;M=this.Sa.Nc();for(var Sb=0;Sb<oa.length;Sb++)Array.add(M.buttons,this.Sa.Bb(oa[Sb]));oa=this.Sa.Kp("Forms.Flyout");Array.add(oa.Ac,M);Xa.MenuItems=oa.$B();return!0}return!1};Ub.prototype.X5h=function(M,oa,Xa){return this.mMd&&M.command===oa?(this.kMd(M,-266099),oh.TaskExtensions.D4()):oh.TaskExtensions.Ba(this.bK.value,function(Sb){Pb.a(Sb.result,Jf.a.workflow,null,Xa.WorkflowPostMessage)||Dg.HelperMethods.vf(Xa.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},
this.ma,3)};Ub.prototype.zwe=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.oh.get(26)};Ub.prototype.y3h=function(){var M=qi.a.create().toString();ud.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+M);var oa=this.$.frame,Xa=oa.I8a,Sb=this.$,xc=new hh.QueryStringBuilder(Pd.AFrameworkApplication.ga.Ua("TeamsMeetingShareEndpoint"));xc.Gi("deeplinkId",M);xc.Gi("lm","deeplink");M=xc.Gi;var jd={};var vd=new hh.QueryStringBuilder(Pd.AFrameworkApplication.ga.Ua("TeamsAppSharingUrl"));
vd.Gi("auth","2");vd.Gi("flight","officeunihost");vd.Gi("source","TEAMS-ELECTRON.meetingStage.deeplink");var ae={};ae.fileType=Sf.a.s4(Sb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);ae.objectUrl=Sb.workbookContext.FullDocumentInfo.WorkbookPath;ae.baseUrl=Sb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Sb=Sb.workbookContext.WorkbookFileVersionId;for(var Ie=decodeURIComponent(Sb);Sb!=Ie;)Sb=Ie,Ie=decodeURIComponent(Sb);0>Sb.indexOf("{")||0>Sb.indexOf("}")?(ud.ULS.sendTraceTag(528250338,
306,15,"Decoded fileId does not match expected format. Decoded id: "+Sb),Sb=""):Sb=Sb.substring(Sb.indexOf("{")+1,Sb.indexOf("}")).toLowerCase();ae.fileId=Sb;ae=ph.c(ph.c(ae));vd.Gi("subEntityId",ae.substring(1,ae.length-1));jd.appSharingUrl=vd.toString();jd.appId=Pd.AFrameworkApplication.ga.Ua("TeamsAppId");jd=JSON.stringify(jd);M.call(xc,"appContext",jd);Xa.call(oa,xc.toString(),!0)};Ub.prototype.I3h=function(M){this.mMd?this.kMd(M,1986648902):this.M0f()};Ub.prototype.I6e=function(M,oa){!M&&this.$.ya.SurveyRedirectUrl?
this.j3i():(M=new dc(this.$,M,oa),M.initialize(),M.mf())};Ub.prototype.j5h=function(M,oa){var Xa=this;this.mMd&&1197060601===M.command?this.kMd(M,-59906385):oh.TaskExtensions.Ba(this.bK.value,function(Sb){Sb=Sb.result;Sb&&Pb.a(Sb,Jf.a.replyWithChanges,null,Xa.$.ea.oh.get(8))||(Sb=new Sys.StringBuilder(oa.ReplyWithChangesUrl),Yg.a.Xf(Sb,dj.e,dj.d),L.a.ntw(Sb.toString(),Xa.$))},this.ma,3)};Ub.prototype.kMd=function(M,oa){var Xa=this,Sb=$f.a(this.$).rd.activityState,xc=new Uj.a(oa,M.method,M.mode,M.df,
M.tabName);Ah.a(this.$).jt(new Ui.a(zb.a.ez,5,function(){Sb[Pe.a.Xq]=zb.a.OVf;Sb[Hk.a.DTc]=xc;Xa.$.Kk.Iy("SocialSharingSaveBeforeCommand");Xa.$.Kk.xme(xc.command)}))};Ub.prototype.M0f=function(){var M=this,oa=this.$.ya.DocumentHostInfo;oa.HostEmbeddedViewUrl||this.qwe?this.L3f():this.$.jg.get(53)&&oh.TaskExtensions.Ba(this.bK.value,function(Xa){M.cPj(Xa.result)||L.a.ntw(oa.FileEmbedCommandUrl,M.$)},this.ma,3)};Ub.prototype.cPj=function(M){return M.isEnabled()&&(this.pwe||(this.pwe=M.Jl(Jf.a.owe,this.dIi)))?
M.Rj(Jf.a.hBh,null):!1};Ub.prototype.L3f=function(){if(Ff.a.Wp)L.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var M=new Ba(this.$);M.initialize();M.mf()}};Ub.prototype.deleteForm=function(){var M=this.$,oa=new Kb(M,1234,1235,1227,function(Xa,Sb,xc){var jd=M.na.ta.$b(),vd=M.na.ta;jd=vd.Na(9,jd);jd.surveyId=null;return ha.i(vd,"DeleteSurvey",jd,Xa,Sb,xc,null,0)});oa.initialize();oa.mf()};Ub.prototype.shareForm=function(){var M=this,oa=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.oh.get(26)){var Xa=
new jc(this.$);Xa.initialize();Xa.mf()}else oh.TaskExtensions.Ba(this.bK.value,function(Sb){var xc={};Pb.a(Sb.result,Jf.a.shareForm,(xc[Ag.a.AIj]=M.$.workbookContext.SurveyTitle,xc),M.$.ea.oh.get(10))||L.a.ntw(oa.ShareFormCommandUrl,M.$)},this.ma,3)};Ub.prototype.j3i=function(){var M=this.$;M.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var oa=new Sys.StringBuilder(M.ya.SurveyRedirectUrl);Yg.a.Xf(oa,"startupDialog","FormEdit");var Xa=$f.a(this.$),Sb=Xa.rd.activityState;
Sb[Id.a.q2]=oa.toString();Sb[Id.a.nM]=Id.a.hxd;this.$.Kk.Iy("SocialSharingEnvironmentChange");Ah.a(M).jt(new Ui.a(zb.a.ez,5,function(){var xc=Qg.a.jd(3,2,1279,1280,1281,554412057,"FossEnvironmentUnsupported");Xa.rd.zt([xc]);Sb[Pe.a.Xq]=zb.a.Gcg}))};Ub.prototype.P2a=function(M){return(this.$.ea.isEditMode||(void 0===M?!1:M))&&this.$.ea.oh.get(25)&&Mk.a()};Ub.prototype.bZh=function(M){var oa=void 0===oa?null:oa;var Xa=zg.g(this.$).ha;var Sb=this.$.xa.pa?vi.d(this.$.xa.pa):null;if(!Sb)return ud.ULS.sendTraceTag(537151649,
0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",Di[M]),null;14===M?oa=this.BYh(Xa):12===M?(oa=Xa.pia,oa=Jb.a.contains(oa,"!",!0)?oa.split("!")[1]:oa):13===M&&(Xa=Xa.va.selectedRanges,Xa[0]&&(Xa=zg.g(this.$).Sb.Wj(Xa[0])))&&(oa=Xa.hj);if(!oa)return ud.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",Di[M]),null;Xa={};Xa[Ag.a.aKb]="copy";Xa[Ag.a.A1f]=
this.APh(M,oa,Sb);ud.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",Di[M],oa,Sb);return Xa};Ub.prototype.BYh=function(M){if(M.Pa.f5&&(M=M.Pa.mc.floatingObject)&&0===M.type){var oa=M.id.split(".");if(1<oa.length)return oa[1];ud.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",M.id)}return null};
Ub.prototype.APh=function(M,oa,Xa){M=btoa(M+"_"+oa+"_"+Xa);M=M.replace(RegExp("\\+","g"),"-");M=M.replace(RegExp("\\/","g"),"_");return M=M.replace(RegExp("\\=+$","g"),"")};Ub.prototype.T4f=function(M,oa){var Xa=this;return oh.TaskExtensions.Ba(this.bK.value,function(Sb){Pb.a(Sb.result,Jf.a.sharing,oa,Xa.$.ea.oh.get(5))?ud.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",oa?oa[Ag.a.aKb]:""):Dg.HelperMethods.vf(M.FileSharingUrl,
"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ma,3)};Ub.prototype.EPd=function(M,oa){if(!kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;var Xa=this.bZh(M);if(Xa)return this.T4f(oa,Xa);ud.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",Di[M]);return null};Qk.Object.defineProperties(Ub.prototype,{RCc:{configurable:!0,enumerable:!0,
get:function(){return aa.b(this.$.lg)}},mMd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.pjh||this.$.dR)}}});Ub.SDi=[103];Ub.Azh=[107,104,105,106];Ub.Bzh=[104,105];Ub.pWg=[new si.a(zb.a.Rze,554412057,0,0,1282),new si.a(zb.a.idle,554412057,0,1)];Object(pe.a)(Ub,"SocialSharingCommandHandler",P.a,[239]);var Z=ch.a;vm(qb,Z);qb.prototype.Pd=function(){var M=this,oa=new If.a(function(){return vg.GetServiceTaskFactory.create(M.$.da,137,M.ma,M.ub)});oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.ub),function(Xa){M.Gd([new Ub(M.$,Xa.result,oa)])},this.ma,3)};qb.ka=function(M){ch.a.he(114,new qb(M))};Object(pe.a)(qb,"SocialSharingCommandHandlerFactory",ch.a,[]);Object(pe.a)(Oa,"MacroRecorderRangeCustomSortedPayload",null,[106]);var wa=b(1089),hb=b(1090),Yb=b(972),Gc=b(877),dd=b(201);Wb.prototype.show=function(){var M=new Og.StandardDialog;M.kc=11;M.Gc(1,qe.a.instance.fa(2066));M.Gc(2,qe.a.instance.fa(2067));M.I4f(qe.a.instance.fa(2065),qe.a.instance.Va(645),this.$v)};Wb.prototype.CNa=
function(M){ud.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",M)};Object(pe.a)(Wb,"ExpandSortSelectionDialog",null,[]);sc.isValid=function(M){return Array.contains(sc.Mzh,M.Position)?!0:(ud.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",M.Position),!1)};sc.Mzh=[0,.5,1];Object(pe.a)(sc,"FillGradientStopExtension",null,[]);Object(pe.a)(nb,"GradientLine",null,[]);$a.isValid=function(M){if(!(M.Degree.toString()in
$a.Kzh))return ud.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",M.Degree),!1;if(!M.GradientStops)return ud.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(M.GradientStops.length<$a.jBi||M.GradientStops.length>$a.Kzi)return ud.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",M.GradientStops.length),!1;M=yl(M.GradientStops);for(var oa=M.next();!oa.done;oa=
M.next())if(!sc.isValid(oa.value))return!1;return!0};$a.jBi=2;$a.Kzi=3;var ed={};$a.Kzh=(ed["0"]=new nb(0,0,1,0),ed["180"]=new nb(1,0,0,0),ed["90"]=new nb(0,0,0,1),ed["270"]=new nb(0,1,0,0),ed["45"]=new nb(0,0,1,1),ed["225"]=new nb(1,1,0,0),ed["135"]=new nb(1,0,0,1),ed["315"]=new nb(0,1,1,0),ed);Object(pe.a)($a,"FillGradientExtension",null,[]);var Pc=Fh.a;vm(vb,Pc);vb.prototype.GO=function(M,oa){if(1===M){var Xa=Cf.v(this.PBb,this.$);zg.g(this.$).Ug(Xa,null,null,null,0,Ek.a.QEj)}Xa={};Xa=(Xa.DialogButton=
M,Xa.Location="dialog",Xa);gf.b(this.$).fe(yc.a.SEj,Xa,null,!0);Pc.prototype.GO.call(this,M,oa)};vb.prototype.zr=function(){Pc.prototype.zr.call(this);var M=this.PEj();this.kc=1;this.Gc(1,qe.a.instance.fa(2176));this.Ik(qe.a.instance.fa(2177),R.a.xm(M),1,this.HO)};vb.prototype.PEj=function(){return String.format(qe.a.instance.Cb(165),this.PBb.toString())};vb.prototype.Mcd=function(){var M=this.error.Description.split("_");return new Hj.Range(Number.parseInvariant(M[1])+1,Number.parseInvariant(M[2])+
1,Number.parseInvariant(M[3])+1,Number.parseInvariant(M[4])+1,!0,!1)};Qk.Object.defineProperties(vb.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(pe.a)(vb,"SortMergedCellsErrorDialog",Fh.a,[]);var Rc=b(595),zd=b(655),Fd=Yb.a;vm(kb,Fd);kb.prototype.dispose=function(){this.Mfc||(this.Mfc=!0,this.e1b(),this.z6=null,kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.Obb.dispose(),this.Obb=null));Fd.prototype.dispose.call(this)};
kb.prototype.FHh=function(M){var oa=this;return function(Xa){if(gj.b(Xa,-901005882))$f.a(oa.$).rd.XD(-901005882),oa.zFd();else if(gj.b(Xa,-569193796))$f.a(oa.$).rd.XD(-569193796),oa.hide(),new vb(oa.$,Xa.Errors[0]);else if(gj.a(Xa))ud.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),oa.hide();else{Xa=Xa.Result;oa.$.Bj(Xa.SortRange);var Sb=kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
Xa&&fc(Xa)&&ub(Xa)&&Za(Xa,Sb)?M(Xa):oa.i6b(kb.Sqb())}}};kb.prototype.pIh=function(M,oa){var Xa=this;return function(Sb,xc){if(Xa.Mfc)ud.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Sb||gj.a(Sb))ud.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",Qg.a.Uc(Sb.Errors)),Xa.$.ea.lp(Sb.Errors),Xa.hide();else{Sb=
Sb.Result;var jd=M.RangeType,vd=M.HeaderRowSize,ae=M.SortTopToBottom;Sb&&$b(Sb,M.ConditionType)&&rd(Sb,jd,vd,ae)?(Sb.ColumnInfo.ColumnOffset=xc,void 0!==Sb.HeaderColumnInfo&&null!==Sb.HeaderColumnInfo&&(Sb.HeaderColumnInfo.ColumnOffset=xc),oa(Sb,M.ConditionType,M.SortTopToBottom)):(ud.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Xa.i6b(kb.Sqb()))}}};kb.prototype.Pyj=function(M){return!!this.namedSheetViewPublic&&
(!M||3===M)};kb.prototype.S6g=function(M){var oa={};oa.SelectedRange=this.selectedRange;oa.ActiveCell=this.Foc;oa.SortInfoMode=M;oa.ExpandSortSelection=this.tUg;oa.ExpandSortSelectionSupported=!0;return oa};kb.prototype.eta=function(M){var oa={};oa[Af.a.Zy]=this.Bc;oa.fromAutoFilter=M.FromAutoFilter;oa.gridRTL=zg.g(this.$).rtl;oa.activeCell=M.ActiveCell;oa.selectedRange=M.SelectedRange;oa.invokeGetSortInfo=this.Mei;oa.invokeGetSortConditionColorsOrIcons=this.Lei;oa.highlightSortRange=this.k8h;oa.getColorName=
this.getColorName;return oa};kb.prototype.Coa=function(M,oa){M=Cf.D(M);this.ha.va.Td.equals(M)||this.ha.updateSelection(M,Cf.C(oa),0,void 0,void 0,void 0,!0)};kb.prototype.zFd=function(){var M=this;(new Wb(function(oa){var Xa={};Xa.ActiveCell=M.Foc;Xa.SelectedRange=M.selectedRange;Xa.ExpandSelection=oa;Xa.FromAutoFilter=!1;oa={};M.$.ye(-207540907,na.a.dc,8,(oa.SortCommandData=Xa,oa))})).show()};kb.prototype.e1b=function(){if(void 0!==this.z6&&null!==this.z6)for(var M=yl(this.z6),oa=M.next();!oa.done;oa=
M.next())this.$.na.ta.Aeb(oa.value.Et)};kb.WLf=function(M,oa){var Xa={};M.ye(1659552324,na.a.dc,8,(Xa.CustomSortCommandData=oa,Xa))};kb.Sqb=function(){return Qg.a.jd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Qk.Object.defineProperties(kb.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return zg.g(this.$).ha}}});Object(pe.a)(kb,"CustomSortDialog",Yb.a,[]);var se=b(1180);wb.prototype.getSelection=function(){return this.selection};
Object(pe.a)(wb,"MacroRecorderRangeAutoFilterClearedPayload",null,[106]);Object(pe.a)(Ec,"MacroRecorderRangeFilterReappliedPayload",null,[106]);var Ye=b(900),ff=b(901),Wf=b(135),lg=b(39);db.prototype.Zc=function(M,oa){return!this.eqd(M,oa)};db.prototype.executeCommand=function(M,oa,Xa){M=null;var Sb=oa.command;switch(Sb){case -864298118:M=this.fhh(oa,Xa);break;case -1010737776:M=this.d7c(!0,oa,Xa);break;case 2123420468:M=this.d7c(!1,oa,Xa);break;case -207540907:case -1677817820:M=this.gridView.Sb.Nka(this.gridView.ha.va.activeCell)?
this.k3i():this.h3i(oa,Xa);break;case 1659552324:M=this.chh(oa,Xa);break;case 368460465:M=this.vhh(oa);break;case 529856798:M=this.$gh(oa);break;case 644342024:M=this.qhh(oa)}return M||h.a(Sb)};db.prototype.Kc=function(M,oa){if(M=1===M)switch(oa.command){case -864298118:case -1010737776:case 2123420468:case 368460465:case 529856798:case 1659552324:case 644342024:case -207540907:case -1677817820:break;default:M=!1}return M};db.prototype.gd=function(){return!1};db.prototype.ha=function(){return this.$&&
this.gridView?this.gridView.ha:null};db.prototype.BOf=function(M){M?this.gridView.$q(this.onContentReady):this.gridView.ot(this.onContentReady);this.kdf=M};db.prototype.Tzj=function(M){return!!this.sortOptions&&Jb.a.equals(this.Fkf,M.pia,!0)};db.prototype.eqd=function(M,oa){var Xa=zg.g(this.$).ha.va.selectedRanges;return(new nk.a(this.$.xa)).Fn(M,oa,Xa,this.gridView)};db.prototype.d7c=function(M,oa,Xa){var Sb={OperationType:0};Sb.IsAscending=M;Sb.HasHeader=!0;Sb.GuessHeader=!0;Sb.SortTopToBottom=
!0;Sb.ExpandSortSelectionSupported=!0;Xa&&void 0!==Xa[db.qSa]&&null!==Xa[db.qSa]?(Xa=Xa[db.qSa],Sb.ActiveCell=Xa.ActiveCell,Sb.SelectedRange=Xa.SelectedRange,Sb.ExpandSortSelection=Xa.ExpandSelection):(Sb.ActiveCell=Cf.o(this.ha().va.activeCell,this.$),Sb.SelectedRange=Cf.v(this.ha().va.Td,this.$),Sb.ExpandSortSelection=null);return this.Mqd([Cf.D(Sb.SelectedRange)])?this.gridView.Sb.Nka(Cf.D(Sb.SelectedRange))?this.nhh(M):this.icf(Sb,oa):oh.TaskExtensions.nm()};db.prototype.fhh=function(M,oa){var Xa=
null,Sb=this.ha();Sb&&(this.Tzj(Sb)?this.Mqd(Sb.va.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Xa=this.icf(this.sortOptions,M)):Xa=this.d7c(!0,M,oa));return Xa};db.prototype.Mqd=function(M){return kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.Ms(M,!0,1):this.$.LWc(M,!0,1):!0};db.prototype.nhh=
function(M){this.RVh(M);return Wg.Task.Ta(!0)};db.prototype.ZQg=function(M){if(kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var oa=this.gridView.Sb.Wj(this.ha().va.Td,!1);if(oa){var Xa=oa.name;oa=oa.usedRange;oa=this.ha().va.activeCell.left-oa.left;return new hb.a(Xa,oa,M.IsAscending)}}return new wa.a(M)};db.prototype.icf=function(M,oa){function Xa(){return Sb.ZQg(M)}var Sb=this;this.gridView.Gh.VG(!1);return this.QLe(function(xc,jd,vd){return Ob(Sb.$.na.ta,
M,lh.b(xc,Sb.GTi),jd,vd,M)},function(xc){return new Kc.a(141,0,xc,void 0,Xa)},oa,this.Oyj(M))};db.prototype.Oyj=function(M){if(!this.namedSheetViewPublic)return!1;var oa=this.ha().va.Td,Xa=Cf.v(this.ha().va.Td,this.$),Sb=this.gridView.Sb.Wwa(oa,!0),xc=this.ha().va.exa()&&this.gridView.Sb.Ngf(Xa),jd=this.gridView.Sb.Yli(Xa);M=!oa.x5&&!oa.f_||oa.isSingle||null!=M.ExpandSortSelection?M.ExpandSortSelection&&this.gridView.Sb.Ngf(Xa):!1;return Sb||xc||jd||M};db.prototype.k3i=function(){return this.$.ye(-1556797033,
na.a.dc,8,null)};db.prototype.h3i=function(M,oa){M=8===M.df&&oa&&void 0!==oa[db.qSa]&&null!==oa[db.qSa]?oa[db.qSa]:19===M.df&&oa&&void 0!==oa[na.a.Tg]&&null!==oa[na.a.Tg]?sk.a.oi(oa[na.a.Tg]):this.V5g();if(!this.Mqd([Cf.D(M.SelectedRange)]))return oh.TaskExtensions.nm();zg.g(this.$).Gh.VG(!1);var Xa=null;(oa=oa.TopCellAddress)&&(Xa=Cf.o(oa,this.$));new kb(this.$,M,this.namedSheetViewPublic,Xa);return Wg.Task.Ta(!0)};db.prototype.chh=function(M,oa){function Xa(){return new Oa(vd.SortOptions)}function Sb(){vd.ShouldRestoreSelection&&
jd.Coa(vd.SelectedRange,vd.OriginalActiveCell);ud.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",M.df)}function xc(ae){kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&jd.k8e(ae)?jd.V6e(ae.Errors[0]):(vd.ShouldRestoreSelection&&jd.Coa(vd.SelectedRange,vd.OriginalActiveCell),ud.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",
M.df),vd.TopCellAddress?ae=Cf.C(vd.TopCellAddress):(ae=vd.OriginalActiveCell,ae=new Hj.Range(ae.FirstRow+1,ae.FirstColumn+1,ae.FirstRow+1,ae.FirstColumn+1,!0,!1)),jd.JL(ae))}var jd=this,vd=oa[db.Yah];return Lb.a(this.$.userOperationManager,function(ae,Ie,Zf){return Ob(jd.$.na.ta,vd.SortOptions,lh.b(ae,xc),lh.a(Ie,Sb),Zf,jd.sortOptions)},function(ae){return new Kc.a(187,0,ae,void 0,Xa)},null)};db.prototype.Coa=function(M,oa){M=Cf.D(M);zg.g(this.$).ha.va.Td.equals(M)||zg.g(this.$).ha.updateSelection(M,
Cf.C(oa),0,void 0,void 0,void 0,!0)};db.prototype.V5g=function(){var M={};M.ActiveCell=Cf.o(this.ha().va.activeCell,this.$);M.SelectedRange=Cf.v(this.ha().va.Td,this.$);M.FromAutoFilter=!1;M.ExpandSelection=null;return M};db.prototype.vhh=function(M){function oa(){return new se.a(Sb)}var Xa=this,Sb=this.YJa();if(!Sb)return Wg.Task.Ta(!1);var xc=this.$.na.ta.$b();return kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,function(jd,vd,ae){return ha.kb(Xa.$.na.ta,Sb,Ye.a.yva(Wf.a.zZa,ff.a.toggleAutoFilter,
jd),vd,ae,null,xc)},function(jd){return new Kc.a(516,0,jd,64,oa)},M):Lb.a(this.$.userOperationManager,function(jd,vd,ae){return ha.kb(Xa.$.na.ta,Sb,Ye.a.yva(Wf.a.zZa,ff.a.toggleAutoFilter,jd),vd,ae,null,xc)},function(jd){return new Cj.a(516,0,jd,void 0,oa)},M)};db.prototype.$gh=function(M){function oa(){return new wb(Sb)}var Xa=this,Sb=this.YJa();if(!Sb)return Wg.Task.Ta(!1);var xc=this.gridView.Sb.Wj(this.ha().va.Td,!0);xc&&ud.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",
xc.type.toString());var jd=this.$.na.ta.$b();xc=kf.EwaSettings.tc()?function(vd){return new Kc.a(517,0,vd,64,oa)}:function(vd){return new Cj.a(517,0,vd,void 0,oa)};return this.QLe(function(vd,ae,Ie){var Zf=Xa.$.na.ta;vd=Ye.a.yva(Wf.a.fsa,ff.a.clearAutoFilter,vd);var Vg=Zf.Na(41,void 0===jd?null:jd);Vg.selectedRange=Sb;return ha.i(Zf,"ClearAutoFilter",Vg,vd,ae,Ie,null,0)},xc,M,!!this.namedSheetViewPublic)};db.prototype.QLe=function(M,oa,Xa,Sb){var xc=this;return Sb?this.namedSheetViewPublic.GAa().continueWith(function(jd){jd.result&&
Lb.a(xc.$.userOperationManager,M,oa,Xa)}):Lb.a(this.$.userOperationManager,M,oa,Xa)};db.prototype.qhh=function(M){function oa(){return new Ec(Sb)}var Xa=this,Sb=this.YJa();if(!Sb)return Wg.Task.Ta(!1);var xc=this.$.na.ta.$b();return kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,function(jd,vd,ae){return lc(Xa.$.na.ta,Sb,Ye.a.yva(Wf.a.fsa,ff.a.vMf,jd),vd,ae,null,xc)},function(jd){return new Kc.a(518,0,jd,64,oa)},M):Lb.a(this.$.userOperationManager,function(jd,vd,ae){return lc(Xa.$.na.ta,Sb,
Ye.a.yva(Wf.a.fsa,ff.a.vMf,jd),vd,ae,null,xc)},function(jd){return new Cj.a(518,0,jd,void 0,oa)},M)};db.prototype.k8e=function(M){return gj.b(M,-569193796)};db.prototype.V6e=function(M){$f.a(this.$).rd.XD(-569193796);new vb(this.$,M)};db.prototype.zFd=function(M){var oa=this;(new Wb(function(Xa){var Sb={};Sb.ActiveCell=M.ActiveCell;Sb.SelectedRange=M.SelectedRange;Sb.ExpandSelection=Xa;Xa={};oa.$.ye(M.IsAscending?-1010737776:2123420468,na.a.dc,8,(Xa[db.qSa]=Sb,Xa))})).show()};db.prototype.$Cj=function(){var M=
this.ha();M.updateSelection(this.byc,M.va.activeCell,0,void 0,void 0,void 0,!0);this.BOf(!0)};db.prototype.YJa=function(){var M=this.ha();if(!M)return ud.ULS.shipAssertTag(537151573,0,!!M,"SelectionManger is null"),null;this.gridView.Gh.VG(!1);return Cf.v(M.va.Td,this.$)};db.prototype.pJb=function(){this.Vc&&this.Vc.Po&&(this.ag=this.Vc.Po,this.Db=this.Vc.tac())};db.prototype.RVh=function(M){var oa=this;if(this.$.isEditMode&&(this.Vc=this.gridView.Sb.Zo(this.gridView.ha.va.activeCell))){this.activeCell=
Cf.o(this.gridView.ha.va.activeCell,this.$);if(this.Vc&&this.Vc.Po){var Xa=this.Vc.Po.CurrentCol;if(this.Vc.Po.CurrentRow===this.activeCell.FirstRow&&Xa===this.activeCell.FirstColumn){this.pJb();this.applyPivotSort(M);return}}this.$.na.ta.$b();Xa=new Kc.a(228,0,function(Sb,xc,jd){return ha.C(oa.$.na.ta,oa.activeCell,lh.b(Sb,oa.$Mi),lh.a(xc,oa.ZMi),jd,M)},16);this.$.userOperationManager.ic(Xa,null)}};db.prototype.applyPivotSort=function(M){var oa=this;if(this.Vc&&this.Db&&this.activeCell&&this.ag){var Xa=
8===this.ag.CellArea,Sb=1===this.ag.CellArea||2===this.ag.CellArea;(Xa||Sb)&&8!==this.ag.CellType&&4!==this.ag.CellType&&(Xa?Lb.a(this.$.userOperationManager,function(xc,jd,vd){return ha.e(oa.$.na.ta,oa.activeCell,M?1:2,oa.Db.Caption,xc,jd,vd,null)},function(xc){return new Kc.a(1015,0,xc,void 0,null)},null):(Xa=1===this.ag.CellArea?1:2,this.$.la(724)?L.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Vc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,
this.Vc.isOlap?"":this.Db.Caption,Xa,M):L.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Vc.externalSourceIndex,this.Db.Index.toString(),M)))}};db.prototype.JL=function(M){(kf.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?lg.a.Mka(this.$):kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.Wa(this.$.da,430,431,1),function(oa){oa.result.tea(M);ud.ULS.sendTraceTag(537151571,
306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ma,3)};db.prototype.AWd=function(M){kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.Wa(this.$.da,476,475,0),function(oa){oa.result.AWd(M,0);ud.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.ma,3)};db.Yah="CustomSortCommandData";
db.qSa="SortCommandData";Object(pe.a)(db,"SortCommandHandler",null,[239]);var rh=ch.a;vm(Ga,rh);Ga.prototype.Pd=function(){var M=this;oh.TaskExtensions.Ba(vg.GetServiceTaskFactory.Wa(this.$.da,309,310,this.ub),function(oa){M.Gd([new db(M.$,oa.result)])},this.$.ma,3)};Ga.ka=function(M){ch.a.he(160,new Ga(M))};Object(pe.a)(Ga,"SortCommandHandlerFactory",ch.a,[]);ya.prototype.n$g=function(M,oa){new vb(M,oa)};Object(pe.a)(ya,"SortUtil",null,[428]);var Ch=gg.a;vm(xa,Ch);xa.prototype.create=function(){var M=
this.$.da.Aa(446);M||(M=new ya(this.$),this.$.da.Ha(446,M));this.Gb(M)};xa.ka=function(M){M.da.Ha(447,new xa(M))};Object(pe.a)(xa,"SortUtilFactory",gg.a,[]);fb.prototype.executeCommand=function(M,oa,Xa){return 2!==this.Fi.De(Tf.a.tryOfficeThroughTellMe,2,Xa)?Wg.Task.Ta(!0):h.a(oa.command)};fb.prototype.Kc=function(M,oa){return 215809929===oa.command};fb.prototype.gd=function(){return!1};fb.prototype.Zc=function(){return!1};Object(pe.a)(fb,"TryOfficeThroughTellMeCommandHandler",null,[239]);var th=
ch.a;vm(Db,th);Db.prototype.Pd=function(){this.Gd([new fb(Pd.AFrameworkApplication.Hb)])};Db.ka=function(M){ch.a.he(207,new Db(M))};Object(pe.a)(Db,"TryOfficeThroughTellMeCommandHandlerFactory",ch.a,[]);var Ii=b(157);pb.XM=function(){return yh.a.Bn(pb.Uj,Ii.a.Va(433))};pb.Uj="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(pe.a)(pb,"NamedSheetViewTeachingDialogHtml",null,[]);var zi=Af.a;vm(Ta,zi);Ta.prototype.Bh=function(){this.kc=4;this.stopwatch=this.$.Wb.Ic("UserAction",this.Bc);var M=qe.a.instance.fa(1861);this.eg=pb.XM();this.Vo=new Ph.a;this.initializeAndShow(M,this.bDi,{});return this.Vo.task};Ta.prototype.mv=function(M){zi.prototype.mv.call(this,M);this.Gc(1,qe.a.instance.fa(1863));this.Gc(2,qe.a.instance.Va(446))};Ta.prototype.F1i=function(){this.$.ea.wlc=!1};Ta.prototype.Zvi=function(M){var oa={};oa.a=
this.$.ya.UserSessionId;oa.b="NamedSheetViewTeachingDialogClose";oa.c=M;oa.e=!0;this.stopwatch&&(this.stopwatch.stop(),oa.d=this.stopwatch.Ec);Ra.b().Qe(53,oa,!0)};Qk.Object.defineProperties(Ta.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(pe.a)(Ta,"NamedSheetViewTeachingDialog",Af.a,[]);var Ni=b(178);Ja.prototype.GAa=function(){if(this.pzj()){if(kf.EwaSettings.la(606)){this.$.xa.pa.Ce.TQd=!0;var M=new Ph.a;this.$.Ka.Yb(new Uj.a(-2050946363,
na.a.dc,2,0,null)).continueWith(function(oa){M.setResult(!Tg.a(oa)&&oa.result)});return M.task}return(new Ta(this.$)).Bh()}return Wg.Task.Ta(!0)};Ja.prototype.pzj=function(){var M=this.$.xa.pa;return this.$.ea.V8a&&this.$.ea.wlc&&!M.Ce.MC&&this.$.ea.MM&&!Ni.c(this.$)};Object(pe.a)(Ja,"NamedSheetViewPublic",null,[429]);var Oi=gg.a;vm(ma,Oi);ma.prototype.create=function(){this.Gb(this.$.da.Aa(309)||new Ja(this.$))};ma.ka=function(M){M.da.Ha(310,new ma(M))};Object(pe.a)(ma,"NamedSheetViewPublicFactory",
gg.a,[]);var Ki=b(1315),Bj=b(999),nj=b(585);Object(pe.a)(hc,"NamedSheetViewTeachingCalloutContent",null,[]);Qk.Object.defineProperties(lb.prototype,{e9f:{configurable:!0,enumerable:!0,get:function(){return this.vie}},r3i:{configurable:!0,enumerable:!0,get:function(){return this.e9f<this.g9f.count?this.g9f.oa(this.vie++):null}}});Object(pe.a)(lb,"NamedSheetViewTeachingCalloutList",null,[]);var $g=b(1181);Ia.prototype.oai=function(M){var oa=this;this.f9f=M;var Xa=Object.assign(new ua.a,{});Ia.Kii(M)?
(Xa.add(new hc(qe.a.instance.Va(435),qe.a.instance.Va(436),qe.a.instance.fa(1891),function(){oa.YH(2,"Continue");oa.QJ(!0)},qe.a.instance.fa(1892),function(){oa.QJ();oa.YH(1,"ExitGuide")},$g.a())),1===M&&Xa.add(new hc(qe.a.instance.fa(1893),qe.a.instance.Va(438),qe.a.instance.fa(1891),function(){oa.YH(2,"FirstEnterTempViewContinueSecond");oa.QJ(!0)},qe.a.instance.fa(1892),function(){oa.QJ();oa.YH(1,"FirstEnterTempViewExitGuideSecond")},$g.a())),Xa.add(new hc(qe.a.instance.Va(439),qe.a.instance.Va(440),
qe.a.instance.fa(1891),function(){oa.YH(2,"FirstEnterExitCalloutContinue");oa.QJ(!0)},qe.a.instance.fa(1892),function(){oa.QJ();oa.YH(1,"FirstEnterExitCalloutGuide")},Ia.b1e())),Xa.add(new hc(qe.a.instance.fa(1894),qe.a.instance.Va(437),qe.a.instance.fa(1895),function(){oa.s4f();oa.QJ();oa.YH(1,"LearnMore")},qe.a.instance.fa(1896),function(){oa.QJ();oa.YH(1,"Done")},Ia.a1e()))):2===M?Xa.add(new hc(qe.a.instance.fa(1893),qe.a.instance.Va(438),qe.a.instance.fa(1890),function(){oa.QJ();oa.YH(1,"EnterTempViewAfterPersistedView")},
null,null,$g.a())):3===M&&(Xa.add(new hc(qe.a.instance.Va(435),qe.a.instance.fa(1902),qe.a.instance.fa(1891),function(){oa.YH(2,"AutoOptInExitCalloutContinue");oa.QJ(!0)},qe.a.instance.fa(1892),function(){oa.QJ();oa.YH(1,"AutoOptInExitGuide")},Ia.b1e())),Xa.add(new hc(qe.a.instance.fa(1893),qe.a.instance.Va(438),qe.a.instance.fa(1891),function(){oa.YH(2,"Continue");oa.QJ(!0)},qe.a.instance.fa(1892),function(){oa.QJ();oa.YH(1,"ExitGuide")},$g.a())),Xa.add(new hc(qe.a.instance.fa(1894),qe.a.instance.Va(437),
qe.a.instance.fa(1895),function(){oa.s4f();oa.QJ();oa.YH(1,"LearnMore")},qe.a.instance.fa(1896),function(){oa.QJ();oa.YH(1,"Done")},Ia.a1e())));this.WUd=new lb(Xa)};Ia.prototype.s4f=function(){var M=new Uj.a(-859308420,na.a.dc,this.$.hd,9,null),oa={};oa=(oa[na.a.Tg]="HelpID=SheetViews",oa.InputMethod=na.a.dc,oa[na.a.nd]=E.a.JZ,oa.ShouldCanvasTakeFocus=!0,oa);this.$.Ka.Yb(M,oa)};Ia.prototype.show=function(M){this.oai(M);this.fdb()};Ia.prototype.Rsj=function(M){this.PZb=M};Ia.prototype.fdb=function(){var M=
this,oa=this.WUd.r3i;if(oa){var Xa=Object.assign(new Ki.a,{label:oa.Q1i,onExecute:oa.primaryButtonAction}),Sb=null;oa.pXf&&(Sb=Object.assign(new Ki.a,{label:oa.pXf,onExecute:oa.secondaryButtonAction}));oa=Object.assign(new Bj.a,{target:oa.targetObject,content:oa.body,title:oa.title,showCloseIcon:!0,primaryButtonProps:Xa,secondaryButtonProps:Sb,useTeachingStyles:!0});oa=this.PZb.callout(oa);Xa=Object.assign(new nj.a,{onShow:function(){M.YH(0)}});this.tzc=this.PZb.addNotification(oa,Xa);this.JWc||(this.$.Dqd=
!0)}};Ia.prototype.dismiss=function(){this.QJ();this.YH(1,"DismissedByOthers")};Ia.prototype.QJ=function(M){M=void 0===M?!1:M;this.tzc&&(this.JWc||(this.$.Dqd=!1),this.PZb.removeNotification(this.tzc),this.tzc=null);M&&this.fdb()};Ia.prototype.YH=function(M,oa){var Xa={};Xa.a=this.$.ya.UserSessionId;Xa.b=this.f9f;Xa.c=this.WUd.e9f;Xa.d=M;Xa.e=void 0===oa?null:oa;0===M?this.stopwatch=this.$.Wb.Ic("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Xa.f=this.stopwatch.Ec,
this.stopwatch=null),2===M&&(this.stopwatch=this.$.Wb.Ic("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Ra.b().Qe(52,Xa,!0)};Ia.a1e=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};Ia.b1e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};Ia.Kii=function(M){return 0===M||1===M};Object(pe.a)(Ia,"NamedSheetViewTeachingCallout",null,[427]);var Wh=gg.a;vm(eb,Wh);eb.prototype.create=function(){var M=this.$.da.Aa(322);
M||(M=new Ia(this.$),kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ha(322,M));this.Gb(M)};eb.ka=function(M){M.da.Ha(323,new eb(M))};Object(pe.a)(eb,"NamedSheetViewTeachingCalloutFactory",gg.a,[]);var Ri=b(99),Si=b(172),Ej=b(1182),li=b(85),Li=b(1068),wi=Og.StandardDialog;vm(Na,wi);Na.prototype.AQ=function(){this.kc=5;this.width=40;var M=document.createElement("span");M.id=this.pi("DirectPrintHeaderContent");var oa=document.createElement("span");oa.innerText=CommonUIStrings.l_DirectPrintDialogHeader;
Sys.UI.DomElement.addCssClass(oa,"DirectPrintHeader");this.zP=document.createElement("iframe");this.zP.name="pdfObjectFrame";this.zP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.zP.onload=Object(uf.a)(this,this.b2i,"printablePdfLoaded");if(this.BVb&&0<this.BVb.count){var Xa=fg.a.egd(this.nUb,this.BVb),Sb=fg.a.FId(this.nUb,this.BVb);this.Tl=document.createElement("form");this.Tl.id="printPreviewPostForm";this.Tl.method="POST";this.Tl.target=this.zP.name;this.Tl.action=Sb;Xa=yl(Xa);for(Sb=Xa.next();!Sb.done;Sb=
Xa.next()){Sb=Sb.value;var xc=document.createElement("input");xc.type="hidden";xc.name=Sb.key;xc.value=Sb.value;this.Tl.appendChild(xc)}}else this.zP.setAttribute("src",this.nUb);Sys.UI.DomElement.addCssClass(this.zP,Si.a.tce);this.$pg?(Sys.UI.DomElement.addCssClass(this.zP,"DirectPrintPdfObjectHidden"),oa.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Yh.a.Xg(this.zP,Yh.a.YB,Yh.a.uj)):(Sys.UI.DomElement.addCssClass(this.zP,"DirectPrintPdfObject"),this.Rm.push(this.zP));M.appendChild(oa);
M.appendChild(document.createElement("br"));M.appendChild(this.zP);this.Tl&&M.appendChild(this.Tl);M.appendChild(document.createElement("br"));M.appendChild(this.N1g(this.Tl?"#":this.nUb));this.Hlb.start();this.QBb(CommonUIStrings.l_AppTitle,null,null,null,null,M);this.cX(this.pi("DirectPrintHeaderContent"));this.Tl&&this.Tl.submit();this.I6g();ud.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};Na.prototype.N1g=function(M){var oa=document.createElement("span"),Xa=document.createElement("span");
Xa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;oa.appendChild(Xa);Pd.AFrameworkApplication.ga&&(2===Pd.AFrameworkApplication.sa.Qa.Oj&&Pd.AFrameworkApplication.ga.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===Pd.AFrameworkApplication.sa.Qa.Oj&&Pd.AFrameworkApplication.ga.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(M=document.createElement("span"),2===Pd.AFrameworkApplication.sa.Qa.Oj?M.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===Pd.AFrameworkApplication.sa.Qa.Oj&&
(M.innerText=CommonUIStrings.l_InternalError_Directive,ud.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Upa=M,oa.appendChild(document.createElement("br")),oa.appendChild(M)):(Xa=document.createElement("a"),Xa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Xa.href=M,Xa.target="_blank",Xa.id="PrintPDFLink",Xa.className="AllowBrowserClick",this.Upa=Xa,oa.appendChild(document.createElement("br")),oa.appendChild(Xa),this.Tl&&bh.a.addHandler(Xa,
"click",Object(uf.a)(this,this.joc,"onSubmit")),this.vP.qa(kg.a.click,this.Upa,Object(uf.a)(this,this.KJe,"downloadPDFLinkClicked"),null));this.Rm.push(this.Upa);return oa};Na.prototype.joc=function(M){this.Tl&&(this.Tl.target="_blank",this.Tl.submit());M.preventDefault()};Na.prototype.I6g=function(){if(0<this.Rm.length){var M=new Ej.a(this.Rm),oa=Ri.FocusManager.instance().RQ();oa&&(this.Upa.focus(),oa.jf=M,oa.s_=!0)}};Na.prototype.KJe=function(){ud.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1};Na.prototype.Rtd=function(){ud.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};Na.prototype.b2i=function(){ud.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Hlb&&this.Hlb.stop()};Na.prototype.dispose=function(){this.Upa&&(this.vP.za(kg.a.click,this.Upa,Object(uf.a)(this,this.KJe,"downloadPDFLinkClicked")),this.Upa=null);li.a.i0(this.zP);this.zP=null;wi.prototype.dispose.call(this)};Object(pe.a)(Na,"DirectPrintDialog",Og.StandardDialog,
[449]);Ya.prototype.QOh=function(M,oa,Xa){return new Na(this.vP,M,oa,void 0===Xa?null:Xa)};Object(pe.a)(Ya,"DirectPrintDialogFactory",null,[432]);vm(Ha,ze);Ha.prototype.Amf=function(){ud.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};Ha.prototype.Cmf=function(){Pd.AFrameworkApplication.Lm.vxb(9540);ud.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};Ha.prototype.Rtd=function(){ud.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Qk.Object.defineProperties(Ha.prototype,
{s$e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},EVd:{configurable:!0,enumerable:!0,get:function(){return Ha.HTa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},SNa:{configurable:!0,enumerable:!0,get:function(){return Ha.HTa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},IVc:{configurable:!0,enumerable:!0,get:function(){var M=[];Array.add(M,CommonUIStrings.l_PrintDialogCanCloseDocument);if(ze.Twb){var oa=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;
""!==Pd.AFrameworkApplication.sa.Qa.ZFe&&(oa=Pd.AFrameworkApplication.sa.Qa.ZFe);Array.add(M,oa)}return Ha.HTa?M:null}},mjc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},ljc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},I4c:{configurable:!0,enumerable:!0,get:function(){return Pd.AFrameworkApplication.THe?"UIFontDialogTextLarge":
null}}});Qk.Object.defineProperties(Ha,{HTa:{configurable:!0,enumerable:!0,get:function(){return!!Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.sa.Qa.qw&&Pd.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Ff.a.LC||Ff.a.Af||Ff.a.Df||Ff.a.O6a)&&!Pd.AFrameworkApplication.isUnifiedHostMode&&Pd.AFrameworkApplication.ga.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(pe.a)(Ha,"PrintDialogWithLinkToPdf",ze,[]);Pa.G6c=",";Object(pe.a)(Pa,
"DirectPrintBrsSettings",null,[]);Object(pe.a)(pa,"DirectPrintProbeResults",null,[]);qa.prototype.start=function(){};qa.prototype.a4i=function(){var M=Array(this.qC.KSa.length);if(void 0!==this.akb&&null!==this.akb)for(var oa=0;oa<this.qC.KSa.length;oa++)M[oa]=this.qC.KSa[oa]in this.akb&&this.brg(this.akb[this.qC.KSa[oa]]);return M};qa.prototype.b4i=function(){for(var M=Array(this.qC.LSa.length),oa=!(void 0===this.uNc||null===this.uNc),Xa=0;Xa<this.qC.LSa.length;Xa++){var Sb=this.qC.LSa[Xa];M[Xa]=
oa&&Sb in this.uNc?!0:this.Frg(Sb)}return M};qa.prototype.j_h=function(){for(var M=this.a4i(),oa=Array(M.length),Xa=0;Xa<M.length;Xa++)oa[Xa]=M[Xa]?this.nAh(this.akb[this.qC.KSa[Xa]]):null;return oa};qa.prototype.nAh=function(M){if(void 0===M||null===M)return null;M=M.enabledPlugin;return void 0===M||null===M?null:M.name};qa.prototype.DWh=function(){for(var M=this.j_h(),oa=this.b4i(),Xa={},Sb={},xc=0;xc<this.qC.KSa.length;xc++)Xa[this.qC.KSa[xc]]=M[xc];for(M=0;M<this.qC.LSa.length;M++)Sb[this.qC.LSa[M]]=
oa[M];return new pa(Xa,Sb)};qa.prototype.cAj=function(){return this.Nrg||!this.qC.isEnabled||Pd.AFrameworkApplication.isUnifiedHostMode?!1:this.hIj()};qa.prototype.gxc=function(){if(null!=this.YWb)return this.YWb;var M=qa.Odf(this.qC);return this.YWb=this.qC.Pdf&&M||this.Ngi()};qa.prototype.Ngi=function(){return Ff.a.cp&&this.qC.Ogi&&Ff.a.Hye>=this.qC.NXg?!0:!1};qa.prototype.hIj=function(){if(!this.Grg(this.qC))return!1;var M=zh.a.Lhd(this.POc.value.j8f);M=yl(M);for(var oa=M.next();!oa.done;oa=M.next())if(oa=
oa.value,void 0!==oa&&null!==oa)return!0;M=zh.a.Lhd(this.POc.value.LSa);M=yl(M);for(oa=M.next();!oa.done;oa=M.next())if(oa.value)return!0;return!1};qa.prototype.w6h=function(){var M=zh.a.Lhd(this.POc.value.j8f);M=yl(M);for(var oa=M.next();!oa.done;oa=M.next())if(va.a.contains(this.qC.I9h,oa.value))return!0;return!1};qa.prototype.G4f=function(M){var oa=void 0===oa?!1:oa;var Xa=void 0===Xa?null:Xa;Pd.AFrameworkApplication.sa&&Pd.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")?
this.jae(M,Xa):this.cAj()?this.fgh(M,this.w6h()&&!oa,Xa):this.jae(M,Xa)};qa.prototype.fgh=function(M,oa,Xa){Xa=void 0===Xa?null:Xa;var Sb=this.Vwg.Ic("UserAction","OpenDirectPrintDialog");this.mVa.QOh(M,oa,Xa).AQ();Sb.stop()};qa.aif=function(M){try{return new ActiveXObject(M),!0}catch(oa){ud.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",M)}return!1};qa.Qdf=function(M){return void 0===M||null===M?!1:!(void 0===M.enabledPlugin||null===M.enabledPlugin)};qa.create=
function(M){var oa=new Pa(Pd.AFrameworkApplication.ga.appSettings),Xa=null;try{Xa=window.navigator.mimeTypes}catch(Zf){ud.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var Sb=null;try{Sb=window.navigator.plugins}catch(Zf){ud.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var xc=qa.Qdf,jd=qa.aif;M=M.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var vd=Pd.AFrameworkApplication.sa.vD,ae=qa.bif,Ie=!!Pd.AFrameworkApplication.sa&&
Pd.AFrameworkApplication.sa.Qa.qw&&!Pd.AFrameworkApplication.ga.ra("PrintDialogFallbackLinkEnabled");return new qa(oa,Xa,Sb,xc,jd,M,vd,ae,function(Zf,Vg){return new Ha(Zf,!1,Vg,!0,Ie)},Pd.AFrameworkApplication.aMa)};qa.bif=function(M){return Ff.a.cp||Ff.a.Af&&M.Zji||M.Pdf&&qa.Odf(M)?!0:!1};qa.Odf=function(M){var oa=Ff.a.rsb;if(oa){var Xa=oa.split(".");if(2===Xa.length)return oa=parseInt(Xa[0]),Xa=parseInt(Xa[1]),oa>M.rwd||oa===M.rwd&&Xa>=M.Sqf}return!1};Qk.Object.defineProperties(qa.prototype,{qC:{configurable:!0,
enumerable:!0,get:function(){return this.Sng}}});Object(pe.a)(qa,"DirectPrintManager",null,[423]);ea.prototype.ii=function(M){var oa=this;this.tb=M;M.register(Ya,"Common.App.DirectPrint.DirectPrintDialogFactory").Cc().Mc(function(){return new Ya(Pd.AFrameworkApplication.sa.oX)});M.register(423,"Common.App.DirectPrint.IDirectPrintManager").Cc().Mc(function(){return qa.create(oa.tb)})};ea.prototype.init=function(){this.d5d=this.tb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.d5d.start()};
ea.prototype.dispose=function(){};Qk.Object.defineProperties(ea.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(pe.a)(ea,"PackageManager",null,[4,5]);var Ji=b(594),Ai=Fk.a;vm(ia,Ai);ia.prototype.setFocus=function(){this.Yv.checked?Fe.DOMElementExtensions.setFocus(this.Yv):Fe.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Qk.Object.defineProperties(ia.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return this.yQb}}});
ia.W4b="printCurrentSelection";Object(pe.a)(ia,"BasePrintDialog",Fk.a,[]);var ji=b(224);vm(da,ia);da.prototype.initialize=function(){ud.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.obi();this.nYa(1175);this.addButton(1);ia.prototype.initialize.call(this)};da.prototype.vha=function(){var M=this;return function(oa,Xa,Sb){var xc=M.$.na.ta,jd=M.Fm;oa=M.qja(oa);Xa=M.Faa(Xa);var vd=M.de,ae=xc.Na(1,null);ae.printOptions=jd;return ha.i(xc,"ValidatePrint",
ae,oa,Xa,Sb,vd,0)}};da.prototype.commit=function(){this.m0g();return!0};da.prototype.Zx=function(M,oa,Xa){var Sb,xc=M.Result;if(xc&&oa){var jd=0,vd=0;(null===(Sb=xc.SelectedRanges)||void 0===Sb?0:Sb.Ranges)&&0<xc.SelectedRanges.Ranges.length&&xc.SelectedRanges.Ranges[0]&&(jd=Math.min(da.N1f(xc.SelectedRanges.Ranges[0]),65535));xc.UsedRange&&(vd=Math.min(da.N1f(Cf.j(Cf.D(xc.UsedRange))),65535));ji.h(oa,jd);ji.i(oa,vd)}this.Fm=xc;ia.prototype.Zx.call(this,M,oa,Xa)};da.prototype.setFocus=function(){this.Isb.checked?
Fe.DOMElementExtensions.setFocus(this.Isb):ia.prototype.setFocus.call(this)};da.prototype.obi=function(){this.Pb.innerHTML=da.V0i(this.$.ea.isNamedObjectViewMode);this.Yv=Fe.DOMElementExtensions.getElementById(this.Pb,ia.W4b);this.Isb=Fe.DOMElementExtensions.getElementById(this.Pb,"printEntireItem");0!==this.Fm.Type&&this.Fm.UseSelection?(this.Yv.checked=!0,this.Isb.disabled=!this.Fm.SheetName):(this.Isb.checked=!0,this.Yv.disabled=0===this.Fm.Type||!zg.g(this.$).ha.va.qh)};da.prototype.m0g=function(){ud.ULS.sendTraceTag(51499290,
0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var M=new Sys.StringBuilder;this.zIh(M);var oa=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",Ff.a.Df?0:1);Dg.HelperMethods.vf(M.toString(),"",oa,"PrintDialog.PrintViewUrl")||ud.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};da.prototype.zIh=function(M){var oa=this.$.ya;M.append(this.$.Kda+oa.LayoutsRelativeUri+
"/xlprintview.aspx?");Yg.a.Xf(M,E.a.w3i,this.Fm.SessionId);Yg.a.Xf(M,E.a.y3i,this.Yv.checked?"1":"0");if(0===this.Fm.Type)Yg.a.Xf(M,E.a.t3i,this.Fm.ObjectId);else{if(!this.Fm.UsedRangeTooBig){var Xa=Cf.D(this.Fm.UsedRange);(Xa=Cf.x(Xa,this.Fm.SheetName))&&Yg.a.Xf(M,E.a.z3i,Xa)}1===this.Fm.Type?Yg.a.Xf(M,E.a.u3i,this.Fm.ObjectId):(Xa=Cf.B(this.Fm.SelectedRanges.Ranges[0]),Xa=Cf.x(Xa,this.Fm.SheetName),Yg.a.Xf(M,E.a.v3i,Xa))}Ug.a.aGa(M,oa);Yg.a.Xf(M,E.a.x3i,this.Fm.Title)};da.V0i=function(M){return String.format("<div class='"+
Jj.a.io+"'>{0}</div>\r\n\t<div class='"+Jj.a.f9c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",qe.a.instance.fa(1176),ia.W4b,qe.a.instance.fa(1179),"printEntireItem",M?qe.a.instance.fa(1178):qe.a.instance.fa(1177))};da.N1f=function(M){return(M.LastColumn-M.FirstColumn+1)*(M.LastRow-M.FirstRow+1)};Qk.Object.defineProperties(da.prototype,{Bc:{configurable:!0,
enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(pe.a)(da,"HtmlPrintDialog",ia,[]);var Sh=b(576),Th=b(64),Mg=b(1184),bk=b(897),Lj=b(285),Nk=b(1012),Uk=b(852);K.prototype.getSheetName=function(){return this.sheetName};K.prototype.getPrintSettings=function(){return this.printSettings};Object(pe.a)(K,"MacroRecorderSheetPrintSettingsSavedPayload",null,[106]);vm(T,ia);T.prototype.initialize=function(){this.w7&&kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&
T.q7g(this.Pb);this.Ne?this.GBe(990,null):(this.Vk(),this.nYa(990));ia.prototype.initialize.call(this)};T.prototype.dispose=function(){this.CPj();ia.prototype.dispose.call(this)};T.prototype.close=function(M){ud.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",this.W_,0===M?"with":"without");this.olj();if(this.ms){var oa=this.SNh();!this.GSd&&!this.daa.checked&&this.$.isEditMode&&this.tjd(oa)&&this.flj(oa)}ia.prototype.close.call(this,
M)};T.prototype.vha=function(){var M=this;return function(oa,Xa,Sb){return fa(M.$.na.ta,M.$.xa.pa.name,M.locale,M.qja(oa),M.Faa(Xa),Sb,null)}};T.prototype.Zx=function(M,oa,Xa){this.ms=M.Result;this.xIb=this.ms.ScalingWidth;this.wIb=this.ms.ScalingHeight;this.ibd();this.Wai();ia.prototype.Zx.call(this,M,oa,Xa)};T.prototype.Vk=function(){ud.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.pbi();ia.prototype.Vk.call(this)};T.prototype.commit=
function(){this.l0g();return!0};T.prototype.setFocus=function(){this.Ne?Tk.a.tAc(this.Oca):this.Oca.checked?Fe.DOMElementExtensions.setFocus(this.Oca):ia.prototype.setFocus.call(this)};T.prototype.Fci=function(){switch(this.$N.xv){case 1:this.Oca.checked=!0;break;case 0:this.Yv.disabled?this.Oca.checked=!0:this.Yv.checked=!0;break;case 2:this.daa.checked=!0;break;default:ud.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.$N.xv),this.$N.xv=1,this.Oca.checked=
!0}};T.prototype.olj=function(){this.$N.xv=this.rZc();this.w7&&(this.$N.ignorePrintArea=this.m5a.checked)};T.prototype.ibd=function(){if(100!==this.ms.ScalingPercent||this.ms.FitToPage&&(1<this.ms.ScalingWidth||1<this.ms.ScalingHeight))this.GSd=!0,this.ms.ScalingWidth=T.b6c,this.ms.ScalingHeight=T.a6c,this.ms.ScalingPercent=T.w5b,this.ms.FitToPage=T.V5c;this.ms.PaperSize.toString()in this.KCd||(this.GSd=!0,this.ms.PaperSize=this.ms.PaperSize===T.FNg?34:T.Drb)};T.prototype.Wai=function(){this.jza=
this.ms.IsLandscape?2:1;this.V_=this.ms.FitToPage?1===this.ms.ScalingWidth&&1===this.ms.ScalingHeight?1:this.ms.ScalingWidth||1!==this.ms.ScalingHeight?2:3:0;this.Bma=this.ms.PaperSize;this.c8c(this.daa.checked?!0:!1);this.lOd(this.daa.checked?!0:!1)};T.prototype.Dbi=function(){this.bec.disabled=this.Yv.checked;this.HFb=this.m5a.checked=this.$N.ignorePrintArea};T.prototype.Q9g=function(M){this.aAa=document.createElement("select");this.aAa.style.width=224+Th.a.kf;this.aAa.style.height=32+Th.a.kf;this.aAa.setAttribute(E.a.dE,
"scalingElementId");this.$za=new Uk.a(this.aAa,!0);for(var oa=0,Xa=T.scalingOptions.length;oa<Xa;++oa){var Sb=qe.a.instance.fa(T.Plj[oa]);this.$za.oM(Sb,T.scalingOptions[oa].toString(),!1)}M.appendChild(this.aAa)};T.prototype.NEe=function(M){this.Uya=document.createElement("select");this.Uya.style.width=224+Th.a.kf;this.Uya.style.height=32+Th.a.kf;this.Uya.setAttribute(E.a.dE,"paperSizeElementId");this.Tya=new Uk.a(this.Uya,!0);for(var oa=0,Xa=T.paperSizeOptions.length;oa<Xa;++oa){var Sb=qe.a.instance.fa(T.JXi[oa]);
this.Tya.oM(Sb,T.paperSizeOptions[oa].toString(),!1)}M.appendChild(this.Uya)};T.prototype.SNh=function(){var M={};M.IsLandscape=2===this.jza;M.PaperSize=this.Bma;M.ScalingWidth=this.xIb;M.ScalingHeight=this.wIb;M.ScalingPercent=100;M.FitToPage=0===this.V_?!1:!0;return M};T.prototype.wHa=function(){var M=new Sys.StringBuilder;M.append(Nk.a(this.$,"Pdf",!0));this.uia.gxc()&&Yg.a.Xf(M,Gg.a.lfg,"1");Yg.a.Xf(M,Gg.a.NFd,""+this.D6);Yg.a.Xf(M,Gg.a.kLf,this.$.xa.pa.name);0===this.D6&&(Yg.a.Xf(M,Gg.a.jLf,
this.selectedRange),Yg.a.Xf(M,Gg.a.dLf,this.activeCell));Yg.a.Xf(M,Gg.a.eLf,""+this.jza);Yg.a.Xf(M,Gg.a.fLf,""+this.Bma);Yg.a.Xf(M,Gg.a.iLf,""+this.V_);Yg.a.Xf(M,Gg.a.hLf,"1");Yg.a.Xf(M,Gg.a.cLf,this.HFb?"1":"0");Yg.a.Xf(M,Gg.a.gLf,"1");ud.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",M.toString());return M.toString()};T.prototype.Vxb=function(){var M=this,oa=null;ud.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");
this.$.userOperationManager.ic(new Kc.a(223,0,function(Xa,Sb,xc){Xa=new Lj.a(Xa,null,Sb,xc,null,!0,!1,"GetFileCopyFileHandler","");Xa.correlationID=qi.a.create().toString();oa=Xa;Pd.AFrameworkApplication.Kd.E9(M.wHa(),1,null,null,T.Aad,!1,2,M.cAd,M.bAd,oa,void 0,void 0,void 0,12E4);return Wg.Task.Ta(!0)},16),null)};T.prototype.pbi=function(){ud.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.U0i(this.Pb);this.c8c(!0);this.lOd(!0);this.Yv=
Fe.DOMElementExtensions.getElementById(this.Pb,ia.W4b);this.Oca=Fe.DOMElementExtensions.getElementById(this.Pb,"printActiveSheet");this.daa=Fe.DOMElementExtensions.getElementById(this.Pb,"printEntireWorkbook");this.w7&&(this.bec=Fe.DOMElementExtensions.getElementById(this.Pb,"ignorePrintAreaCheckboxButtonId"),this.m5a=new bk.a(this.bec));this.Jwc()&&(this.Yv.disabled=!0,this.Fm.SheetName=this.sheetName);this.Fci();this.w7&&this.Dbi();this.N9i()};T.prototype.Jwc=function(){return!!this.Fm.ObjectId||
!zg.g(this.$).ha.va.qh};T.prototype.N9i=function(){Sh.a.instance.qa(kg.a.change,this.Oca,this.i9a);Sh.a.instance.qa(kg.a.change,this.daa,this.i9a);Sh.a.instance.qa(kg.a.change,this.Yv,this.i9a);Sh.a.instance.qa(kg.a.change,this.nxa,this.umc);Sh.a.instance.qa(kg.a.change,this.H$a,this.umc);Sh.a.instance.qa(kg.a.change,this.Uya,this.Gvf);Sh.a.instance.qa(kg.a.change,this.aAa,this.Hvf);this.w7&&this.m5a.fnb(this.Fvf)};T.prototype.CPj=function(){Sh.a.instance.za(kg.a.change,this.Oca,this.i9a);Sh.a.instance.za(kg.a.change,
this.daa,this.i9a);Sh.a.instance.za(kg.a.change,this.Yv,this.i9a);Sh.a.instance.za(kg.a.change,this.nxa,this.umc);Sh.a.instance.za(kg.a.change,this.H$a,this.umc);Sh.a.instance.za(kg.a.change,this.Uya,this.Gvf);Sh.a.instance.za(kg.a.change,this.aAa,this.Hvf);this.w7&&this.m5a.gda(this.Fvf)};T.prototype.U0i=function(M){M.classList.add(Mg.a.T1i);if(!this.Ne){document.getElementById("ewaDialogTitle").classList.add(Mg.a.printDialogTitle);var oa=document.getElementById("ewaDialogCloseButtonLink");oa.style.top=
32+Th.a.kf;this.rtl?oa.style.left=32+Th.a.kf:oa.style.right=32+Th.a.kf}oa=T.Wy(Mg.a.U1i);M.appendChild(oa);var Xa=T.Wy(Mg.a.X$a,1183);Xa.style.marginBottom=12+Th.a.kf;Xa.id="whatToPrintTitleElementId";oa.appendChild(Xa);Xa=T.Wy(Mg.a.W$a);oa.appendChild(Xa);T.crb(Xa,this.rtl,"printActiveSheet",1187,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));Xa=T.Wy(Mg.a.W$a);oa.appendChild(Xa);
T.crb(Xa,this.rtl,"printEntireWorkbook",1180,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));Xa=T.Wy(Mg.a.W$a);oa.appendChild(Xa);T.crb(Xa,this.rtl,ia.W4b,1179,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.w7?(Xa=T.Wy(Mg.a.X$a,1212),Xa.style.marginTop=24+Th.a.kf,Xa.id="printAreaElementId",
oa.appendChild(Xa),kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Xa.style.marginBottom=12+Th.a.kf,Xa=T.Wy(Jj.a.g9c),Xa.id="ignorePrintAreaCheckboxWarpperId",Fe.DOMElementExtensions.setVisible(Xa,!0),oa.appendChild(Xa),oa=this.getElementById("ignorePrintAreaCheckboxButtonId"),Fe.DOMElementExtensions.setVisible(oa,!0),Xa.appendChild(oa),oa=this.getElementById("ignorePrintAreaCheckboxLabelId"),Fe.DOMElementExtensions.setVisible(oa,!0),Xa.appendChild(oa)):(Xa=
T.Wy(Mg.a.W$a),oa.appendChild(Xa),T.j5g(Xa,this.rtl))):(Xa=T.Wy(Mg.a.X$a,1185),Xa.style.marginTop=24+Th.a.kf,Xa.id="paperSizeElementId",oa.appendChild(Xa),Xa=T.Wy(Mg.a.XEd),this.NEe(Xa),oa.appendChild(Xa));oa=T.Wy(Mg.a.V1i);M.appendChild(oa);M=T.Wy(Mg.a.X$a,1184);M.style.marginBottom=12+Th.a.kf;M.id="orientationTitleElementId";oa.appendChild(M);M=T.Wy(Mg.a.W$a);oa.appendChild(M);T.crb(M,this.rtl,"portraitRadioButtonId",1190,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId",
"orientationTitleElementId");oa.appendChild(document.createElement("BR"));M=T.Wy(Mg.a.W$a);oa.appendChild(M);T.crb(M,this.rtl,"landscapeRadioButtonId",1189,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.w7&&(M=T.Wy(Mg.a.X$a,1185),M.style.marginTop=12+Th.a.kf,M.id="paperSizeElementId",oa.appendChild(M),M=T.Wy(Mg.a.XEd),this.NEe(M),oa.appendChild(M));M=T.Wy(Mg.a.X$a,1186);M.style.marginTop=(this.w7?10:74)+Th.a.kf;M.id="scalingElementId";
oa.appendChild(M);M=T.Wy(Mg.a.XEd);this.Q9g(M);oa.appendChild(M);this.Ne||document.getElementById("buttonarea").classList.add(Mg.a.S1i);this.nxa=Fe.DOMElementExtensions.getElementById(this.Pb,"landscapeRadioButtonId");this.H$a=Fe.DOMElementExtensions.getElementById(this.Pb,"portraitRadioButtonId")};T.prototype.l0g=function(){var M=this;ud.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.D6=this.rZc();2!==this.D6&&(this.jza=this.bwe(),this.Tya&&
(this.Bma=T.paperSizeOptions[this.Tya.selectedIndex]),this.$za&&(this.V_=T.scalingOptions[this.$za.selectedIndex]));if(this.$.Awa&&kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var oa=this.$.na.ta.$b();this.$.userOperationManager.ic(new Kc.a(133,0,function(Xa,Sb,xc){var jd={};jd.WhatToPrint=M.D6;jd.UseNamedAction=M.uia.gxc();jd.SelectedSheetName=M.$.xa.pa.name;jd.ActiveCell=M.activeCell;jd.SelectedRanges=[M.selectedRange];jd.IsPdfDocumentRequired=
!1;jd.Orientation=M.jza;jd.PaperSize=M.Bma;jd.Scaling=M.V_;jd.RichValuesEnabled=!0;M.w7&&(jd.IgnorePrintArea=M.HFb);return W(M.$.na.ta,jd,lh.b(M.bDb,Xa),Sb,xc,oa)},16),null)}else this.Vxb()};T.prototype.c8c=function(M){this.H$a.disabled=M;this.nxa.disabled=M;this.Tya.Pn.disabled=M;this.$za.Pn.disabled=M};T.prototype.lOd=function(M){M?(this.nxa.checked=!1,this.H$a.checked=!1,this.Tya.selectedIndex=-1,this.$za.selectedIndex=-1):(2===this.jza?this.nxa.checked=!0:this.H$a.checked=!0,this.Tya.selectedIndex=
this.KCd[this.Bma.toString()],this.$za.selectedIndex=this.V_)};T.prototype.flj=function(M){var oa=this;ud.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Xa=this.$.xa.pa.name,Sb=this.$.na.ta.$b();this.$.userOperationManager.ic(new Kc.a(226,0,function(xc,jd,vd){return ca(oa.$.na.ta,Xa,M,xc,jd,vd,Sb)},void 0,function(){return new K(Xa,M)}),null)};T.prototype.tjd=function(M){return this.ms.IsLandscape!==
M.IsLandscape||this.ms.PaperSize!==M.PaperSize||this.ms.FitToPage!==M.FitToPage||this.ms.ScalingHeight!==M.ScalingHeight||this.ms.ScalingWidth!==M.ScalingWidth?!0:!1};T.prototype.bwe=function(){return this.nxa&&this.nxa.checked?2:1};T.prototype.rZc=function(){return this.Yv.checked?0:this.Oca.checked?1:this.daa.checked?2:1};T.Wy=function(M,oa){M=void 0===M?null:M;oa=void 0===oa?0:oa;var Xa=document.createElement("div");M&&(Xa.className=M);0!==oa&&(Xa.innerHTML=qe.a.instance.fa(oa));return Xa};T.q7g=
function(M){var oa=document.createElement("input");oa.setAttribute("type","checkbox");oa.className=Jj.a.pNe;oa.id="ignorePrintAreaCheckboxButtonId";oa.setAttribute("name","ignorePrintAreaCbName");oa.style.height=16+Th.a.kf;oa.style.width=16+Th.a.kf;Fe.DOMElementExtensions.setVisible(oa,!1);var Xa=qe.a.instance.fa(1212),Sb=qe.a.instance.fa(1213);oa.setAttribute(E.a.Dt,Xa+Th.a.space+Sb);M.appendChild(oa);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.id=
"ignorePrintAreaCheckboxLabelId";oa.innerHTML=Sb;oa.setAttribute(E.a.QP,"true");oa.style.position="relative";oa.style.marginLeft=15+Th.a.kf;Fe.DOMElementExtensions.setVisible(oa,!1);M.appendChild(oa)};T.j5g=function(M,oa){var Xa=document.createElement("input");Xa.setAttribute("type","checkbox");Xa.id="ignorePrintAreaCheckboxButtonId";Xa.setAttribute("name","ignorePrintAreaCbName");Xa.setAttribute(E.a.dE,"printAreaElementId"+Th.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Xa.style.height=
16+Th.a.kf;Xa.style.width=16+Th.a.kf;oa?Xa.style.marginRight=0+Th.a.kf:Xa.style.marginLeft=0+Th.a.kf;M.appendChild(Xa);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.setAttribute(E.a.QP,"true");oa.style.position="relative";oa.style.marginLeft=15+Th.a.kf;M.appendChild(oa);M=T.Wy(Mg.a.UJf,1213);M.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";oa.appendChild(M)};T.crb=function(M,oa,Xa,Sb,xc,jd,vd,ae){var Ie=document.createElement("input");Ie.setAttribute("type",
"radio");Ie.id=Xa;Ie.setAttribute("name",xc);Ie.setAttribute(E.a.dE,ae+Th.a.space+vd);Ie.style.height=16+Th.a.kf;Ie.style.width=16+Th.a.kf;oa?Ie.style.marginRight=0+Th.a.kf:Ie.style.marginLeft=0+Th.a.kf;M.appendChild(Ie);oa=document.createElement("label");oa.setAttribute("for",Xa);oa.style.position="relative";M.appendChild(oa);M=Jg.createClusteredImage(32,32,jd,Mg.a.a2i,!0,qe.a.instance.fa(Sb));Sb=T.Wy(Mg.a.UJf,Sb);Sb.id=vd;Sb.setAttribute(E.a.QP,"true");vd=T.Wy(Mg.a.$1i);vd.appendChild(Sb);oa.appendChild(vd);
oa.appendChild(M)};Qk.Object.defineProperties(T.prototype,{Bc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});T.b6c=1;T.a6c=0;T.w5b=100;T.Drb=9;T.V5c=!0;T.FNg=13;T.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];T.JXi=[1192,1193,1200,1194,1195,1196,1197,1198,1191,1201,1202,1203,1204,1205,1206,1207];T.scalingOptions=[0,1,2,3];T.Plj=[1208,1209,1210,1211];T.Aad=["Content-Type"];Object(pe.a)(T,"PdfPrintDialog",ia,[]);Qk.Object.defineProperties(H.prototype,{xv:{configurable:!0,
enumerable:!0,get:function(){return this.D6},set:function(M){0<=M&&2>=M?this.D6=M:(ud.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.D6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.c8d},set:function(M){M||!M?this.c8d=M:ud.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(pe.a)(H,"PdfPrintDialogBrowserSessionState",null,[]);var oj=b(1366);Object(pe.a)(S,"MacroRecorderPrintAreaSetPayload",
null,[106]);Object(pe.a)(ba,"MacroRecorderPageBreakInsertedPayload",null,[106]);Object(pe.a)(la,"MacroRecorderPageBreakRemovedPayload",null,[106]);Q.prototype.getSheetName=function(){return this.sheetName};Object(pe.a)(Q,"MacroRecorderPageBreaksAllResetPayload",null,[106]);U.prototype.getSheetName=function(){return this.sheetName};Object(pe.a)(U,"MacroRecorderPrintAreaClearedPayload",null,[106]);var sj=b(155),tj=b(276);Object(pe.a)(V,"PageBreaksInformation",null,[]);Object(pe.a)(D,"RowColBreak",null,
[]);Object(pe.a)(z,"SharedRange",null,[]);var hi=b(123);I.prototype.executeCommand=function(M,oa,Xa,Sb,xc,jd,vd){xc=void 0===xc?null:xc;jd=void 0===jd?null:jd;vd=void 0===vd?null:vd;this.zWd();this.ribbonCommandInfo=oa;this.OFj(oa.command);M=lh.b(xc,this.vNj);ud.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",oa.command);switch(oa.command){case 78661008:return this.l7e(oa,M,jd,vd,!1);case 275604654:return this.l7e(oa,M,jd,vd,!0);case -13332329:return this.j6e(oa,
M,jd,vd);case -837651977:return this.p4h(oa,M,jd,vd);case -1778266776:return this.h5h(oa,M,jd,vd);case 845325699:return this.g7e(oa,M,jd,vd)}return h.a(oa.command)};I.prototype.Kc=function(M,oa){switch(oa.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===M;case 845325699:case -13332329:return!0}return!1};I.prototype.k0f=function(M,oa,Xa){var Sb=zg.g(this.$),xc=Sb.Ca,jd=Cf.r(Sb.ha.va.selectedRanges,this.$);if((xc=xc.UE())&&xc.length){xc=yl(xc);for(var vd=xc.next();!vd.done;vd=
xc.next()){vd=vd.value;var ae=vd.Cf;if(ae){for(var Ie=Cf.j(vd.Zf),Zf=[],Vg=yl(jd.Ranges),Gh=Vg.next();!Gh.done;Gh=Vg.next()){var pi=Gh.value;pi.FirstRow>Ie.LastRow+1||pi.LastRow<Ie.FirstRow||pi.FirstColumn>Ie.LastColumn+1||pi.LastColumn<Ie.FirstColumn||(Gh=this.tWh(Ie,pi,ae),pi=this.sWh(Ie,pi,ae),Zf.push(Object.assign(new z,{FirstRow:Gh.FirstRow,FirstColumn:pi.FirstColumn,LastRow:Gh.LastRow,LastColumn:pi.LastColumn})))}0<Zf.length&&!Xa?ae.setPrintArea(Zf):0<Zf.length&&Xa?ae.addToPrintArea(Zf):!Xa&&
ae.hasPrintArea()&&ae.clearPrintArea();!ae.isDirty()&&ae.hasPageLayout()&&ae.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+vd.Yd,4)}}this.QMb(Sb,M,oa)}};I.prototype.IYg=function(M,oa){var Xa=zg.g(this.$),Sb=zg.g(this.$).Ca.UE();if(Sb&&Sb.length){Sb=yl(Sb);for(var xc=Sb.next();!xc.done;xc=Sb.next()){xc=xc.value;var jd=xc.Cf;jd&&(jd.clearPrintArea(),!jd.isDirty()&&jd.hasPageLayout()&&jd.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+xc.Yd,4))}this.QMb(Xa,
M,oa)}};I.prototype.mdi=function(M,oa){var Xa=zg.g(this.$),Sb=Xa.Ca,xc=Cf.o(Xa.ha.va.activeCell,this.$);if(xc){var jd=Sb.UE();if(jd&&jd.length){Sb=null;for(var vd=yl(jd),ae=vd.next();!ae.done;ae=vd.next()){ae=ae.value;var Ie=ae.Cf;if(Ie){var Zf=Cf.j(ae.Zf);if(!(xc.FirstRow>Zf.LastRow||xc.FirstRow<Zf.FirstRow||xc.FirstColumn>Zf.LastColumn||xc.FirstColumn<Zf.FirstColumn)&&(Sb=this.B8g(Ie,Zf,xc),Ie.insertPageBreak(Sb),!Ie.isDirty()&&Ie.hasPageLayout()&&Ie.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+
ae.Yd,4),Sb))break}}if(!Sb)for(jd=yl(jd),ae=jd.next();!ae.done;ae=jd.next())if(Sb=ae.value,vd=Sb.Cf)Sb=Cf.j(Sb.Zf),Sb=this.MEe(vd,Sb,xc),vd.insertPageBreak(Sb);this.QMb(Xa,M,oa)}}};I.prototype.bbj=function(M,oa){var Xa=zg.g(this.$),Sb=Xa.Ca,xc=Cf.o(Xa.ha.va.activeCell,this.$);if(xc&&(Sb=Sb.UE())&&Sb.length){Sb=yl(Sb);for(var jd=Sb.next();!jd.done;jd=Sb.next()){jd=jd.value;var vd=jd.Cf;if(vd){var ae=Cf.j(jd.Zf);(ae=this.MEe(vd,ae,xc))&&vd.removePageBreak(ae);!vd.isDirty()&&vd.hasPageLayout()&&vd.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
jd.Yd,4)}}this.QMb(Xa,M,oa)}};I.prototype.dhj=function(M,oa){var Xa=zg.g(this.$),Sb=Xa.Ca.UE();if(Sb&&Sb.length){Sb=yl(Sb);for(var xc=Sb.next();!xc.done;xc=Sb.next()){xc=xc.value;var jd=xc.Cf;jd&&(jd.resetAllPageBreak(),!jd.isDirty()&&jd.hasPageLayout()&&jd.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+xc.Yd,4))}this.QMb(Xa,M,oa)}};I.prototype.l7e=function(M,oa,Xa,Sb,xc){if(!xc){var jd=this.$.zb.getItemByName("PRINT_AREA");if(jd&&(ud.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
jd.type),2===jd.type))return this.Tei(),Wg.Task.Ta(!0)}jd=zg.g(this.$).ha.va;var vd=Cf.r(jd.selectedRanges,this.$);if(1===vd.Ranges.length&&!xc){if(jd.exa())return this.w5h(M,vd,oa,Xa,Sb,xc),Wg.Task.Ta(!0);if(Cf.R(vd.Ranges[0]))return this.$.xa.pa.hasPrintArea?this.j6e(M,oa,Xa,Sb):Wg.Task.Ta(!0)}this.k0f(M.command,Sb,xc);return this.hcf(M,oa,Xa,vd,xc)};I.prototype.j6e=function(M,oa,Xa,Sb){this.IYg(M.command,Sb);return this.Eei(M,oa,Xa)};I.prototype.p4h=function(M,oa,Xa,Sb){this.mdi(M.command,Sb);
return this.Qei(M,oa,Xa)};I.prototype.h5h=function(M,oa,Xa,Sb){if(kf.EwaSettings.isChangeGateEnabled("OfficeVSO:4767450_ResetAllPageBreaksOnSelectAllAndRemovePageBreak")){var xc=Cf.r(zg.g(this.$).ha.va.selectedRanges,this.$);if(Cf.R(xc.Ranges[0]))return this.g7e(M,oa,Xa,Sb)}this.bbj(M.command,Sb);return this.Vei(M,oa,Xa)};I.prototype.g7e=function(M,oa,Xa,Sb){this.dhj(M.command,Sb);return this.Xei(M,oa,Xa)};I.prototype.hcf=function(M,oa,Xa,Sb,xc){function jd(){return new S(Sb,xc)}function vd(Ie,Zf,
Vg){Ie=lh.b(Ie,oa);Zf=lh.a(Zf,Xa);var Gh=ae.Na(1,null);Gh.selectedRanges=Sb;Gh.addToPrintArea=xc;return ha.i(ae,"SetPrintArea",Gh,Ie,Zf,Vg,null,0)}var ae=this.$.na.ta;return kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,vd,function(Ie){return new Kc.a(241,0,Ie,64,jd)},M):Lb.a(this.$.userOperationManager,vd,function(Ie){return new Cj.a(241,0,Ie,void 0,jd)},M)};I.prototype.Eei=function(M,oa,Xa){function Sb(){return new U(jd)}function xc(ae,Ie,Zf){ae=lh.b(ae,oa);Ie=lh.a(Ie,Xa);var Vg=vd.Na(1,
null);Vg.sheetName=jd;return ha.i(vd,"ClearPrintArea",Vg,ae,Ie,Zf,null,0)}var jd=this.$.xa.pa.name,vd=this.$.na.ta;return kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,xc,function(ae){return new Kc.a(243,0,ae,64,Sb)},M):Lb.a(this.$.userOperationManager,xc,function(ae){return new Cj.a(243,0,ae,void 0,Sb)},M)};I.prototype.Qei=function(M,oa,Xa){function Sb(){return new ba(ae)}function xc(Ie,Zf,Vg){var Gh=jd.$.na.ta;Ie=lh.b(Ie,oa);Zf=lh.a(Zf,Xa);var pi=Gh.Na(9,null);pi.sheetCell=ae;return ha.i(Gh,
"InsertPageBreak",pi,Ie,Zf,Vg,null,0)}var jd=this,vd=zg.g(this.$),ae=Cf.o(vd.ha.va.activeCell,this.$);return kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,xc,function(Ie){return new Kc.a(244,0,Ie,64,Sb)},M):Lb.a(this.$.userOperationManager,xc,function(Ie){return new Cj.a(244,0,Ie,void 0,Sb)},M)};I.prototype.Vei=function(M,oa,Xa){function Sb(){return new la(ae)}function xc(Ie,Zf,Vg){var Gh=jd.$.na.ta;Ie=lh.b(Ie,oa);Zf=lh.a(Zf,Xa);var pi=Gh.Na(9,null);pi.sheetCell=ae;return ha.i(Gh,"RemovePageBreak",
pi,Ie,Zf,Vg,null,0)}var jd=this,vd=zg.g(this.$),ae=Cf.o(vd.ha.va.activeCell,this.$);return kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,xc,function(Ie){return new Kc.a(245,0,Ie,64,Sb)},M):Lb.a(this.$.userOperationManager,xc,function(Ie){return new Cj.a(245,0,Ie,void 0,Sb)},M)};I.prototype.Xei=function(M,oa,Xa){function Sb(){return new Q(vd)}function xc(ae,Ie,Zf){var Vg=jd.$.na.ta;ae=lh.b(ae,oa);Ie=lh.a(Ie,Xa);var Gh=Vg.Na(9,null);Gh.sheetName=vd;return ha.i(Vg,"ResetAllPageBreaks",Gh,ae,Ie,
Zf,null,0)}var jd=this,vd=this.$.xa.pa.name;return kf.EwaSettings.tc()?Lb.a(this.$.userOperationManager,xc,function(ae){return new Kc.a(246,0,ae,64,Sb)},M):Lb.a(this.$.userOperationManager,xc,function(ae){return new Cj.a(246,0,ae,void 0,Sb)},M)};I.prototype.tWh=function(M,oa,Xa){if(!M||!oa||!Xa)return null;var Sb=new z;Sb.FirstRow=oa.FirstRow===M.LastRow+1?Xa.getRowIndex(M.LastRow+1)+1:oa.FirstRow<M.FirstRow?0:Xa.getRowIndex(oa.FirstRow+1);Sb.LastRow=oa.FirstRow===M.LastRow+1||oa.LastRow>M.LastRow?
Xa.getRowIndex(M.LastRow+1)+1:Xa.getRowIndex(oa.LastRow+1);return Sb};I.prototype.sWh=function(M,oa,Xa){if(!M||!oa||!Xa)return null;var Sb=new z;Sb.FirstColumn=oa.FirstColumn===M.LastColumn+1?Xa.getColumnIndex(M.LastColumn+1)+1:oa.FirstColumn<M.FirstColumn?0:Xa.getColumnIndex(oa.FirstColumn+1);Sb.LastColumn=oa.FirstColumn===M.LastColumn+1||oa.LastColumn>M.LastColumn?Xa.getColumnIndex(M.LastColumn+1)+1:Xa.getColumnIndex(oa.LastColumn+1);return Sb};I.prototype.B8g=function(M,oa,Xa){if(!oa||!Xa||!M)return null;
var Sb=M.getPrintArea();if(!Sb||!Sb.length)return null;var xc=M.getRowIndex(Xa.FirstRow+1),jd=M.getColumnIndex(Xa.FirstColumn+1),vd=null,ae=null;Sb=yl(Sb);for(var Ie=Sb.next();!Ie.done;Ie=Sb.next())if(Ie=Ie.value,xc>=Ie.FirstRow&&xc<=Ie.LastRow&&jd>=Ie.FirstColumn&&jd<=Ie.LastColumn){if(Xa.FirstRow===Ie.FirstRow&&Xa.FirstColumn===Ie.FirstColumn)return new V;xc>Ie.FirstRow&&(vd=Object.assign(new D,{Index:xc-1,Min:Ie.FirstColumn-1,Max:Math.min(Ie.LastColumn,M.getColumnIndex(oa.LastColumn+1))}));jd>
Ie.FirstColumn&&(ae=Object.assign(new D,{Index:jd-1,Min:Ie.FirstRow-1,Max:Math.min(Ie.LastRow,M.getRowIndex(oa.LastRow+1))}));break}return vd||ae?Object.assign(new V,{Row:vd?[vd]:null,Col:ae?[ae]:null}):null};I.prototype.M9g=function(M,oa,Xa){if(!oa||!Xa||!M)return null;var Sb=null;Xa.FirstRow>oa.FirstRow&&Xa.FirstRow<=oa.LastRow?Sb=Object.assign(new D,{Index:M.getRowIndex(Xa.FirstRow+1)-1,Min:-1,Max:-1}):Xa.FirstRow===oa.LastRow+1&&(Sb=Object.assign(new D,{Index:M.getRowIndex(oa.LastRow+1),Min:-1,
Max:-1}));return Sb};I.prototype.p5g=function(M,oa,Xa){if(!oa||!Xa||!M)return null;var Sb=null;Xa.FirstColumn>oa.FirstColumn&&Xa.FirstColumn<=oa.LastColumn?Sb=Object.assign(new D,{Index:M.getColumnIndex(Xa.FirstColumn+1)-1,Min:-1,Max:-1}):Xa.FirstColumn===oa.LastColumn+1&&(Sb=Object.assign(new D,{Index:M.getColumnIndex(oa.LastColumn+1),Min:-1,Max:-1}));return Sb};I.prototype.MEe=function(M,oa,Xa){if(!Xa||!M||!oa)return null;var Sb=this.M9g(M,oa,Xa);M=this.p5g(M,oa,Xa);return Sb||M?Object.assign(new V,
{Row:Sb?[Sb]:null,Col:M?[M]:null}):null};I.prototype.Tei=function(){var M=new Og.StandardDialog;M.kc=0;M.Gc(1,qe.a.instance.fa(4));M.Ik(qe.a.instance.fa(562),qe.a.instance.fa(563),1,null)};I.prototype.OFj=function(M){if(this.Fva.xb(M)&&(Dg.HelperMethods.$Z&&(this.zEb=this.$.Wb.Ic("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.FKa.xb(M)&&this.FKa.remove(M),this.FKa.add(M,qi.a.create().toString()),zg.g(this.$).Li)){var oa=Ra.b()?Ra.b().ti(M):"";zg.g(this.$).Li.z7(this.Fva.oa(M),this.FKa.oa(M),
oa)}};I.prototype.SWg=function(M){if(this.zEb&&M){var oa=this.zEb.Ec;this.zEb.stop();this.zEb=null;switch(M){case "SetPrintArea":this.Jpb(oa,1700,M);break;case "ClearPrintArea":this.Jpb(oa,1500,M);break;case "InsertPageBreak":this.Jpb(oa,1500,M);break;case "RemovePageBreak":this.Jpb(oa,1600,M);break;case "ResetAllPageBreaks":this.Jpb(oa,1700,M)}}};I.prototype.Jpb=function(M,oa,Xa){M>oa&&(oa=Object.assign(new tj.a,{extendedProperties:new Map}),oa.extendedProperties.set("OperationName",Xa),oa.extendedProperties.set("OperationExecutionTime",
M.toString()),jh.Health.instance.recordQosError(sj.a.BEj,[Wf.a.wEj],!1,!0,!0,!1,oa))};I.prototype.w5h=function(M,oa,Xa,Sb,xc,jd){var vd=this,ae=new Og.StandardDialog,Ie=new oj.a(qe.a.instance.fa(560),qe.a.instance.fa(561),qe.a.instance.fa(6),qe.a.instance.fa(5));ae.kc=1;ae.Gc(1,Ie.confirmButton);ae.Gc(0,Ie.cancelButton);ae.Ik(Ie.title,Ie.body,3,function(Zf){1===Zf&&(vd.k0f(M.command,xc,jd),vd.hcf(M,Xa,Sb,oa,jd))})};I.prototype.QMb=function(M,oa,Xa){Xa();this.FKa.xb(oa)&&M.Li.L0(this.FKa.oa(oa),xk.BasicTelemetryCalculator.cR)};
I.prototype.zWd=function(){this.Mpd&&this.$.ye(-1753588160,-1,0,null)};Object(pe.a)(I,"PrintAreaBreakManager",null,[463]);var uj=b(387);r.prototype.equals=function(M){return M?this.orientation===M.orientation&&this.yca===M.yca&&this.s0===M.s0&&this.margin===M.margin&&this.sheetPrintOptions===M.sheetPrintOptions&&this.x1a===M.x1a&&this.NoColor===M.NoColor:!1};r.PCe=function(M,oa){M&&oa&&(oa.xv=M.xv,oa.orientation=M.orientation,oa.yca=M.yca,oa.s0=M.s0,oa.margin=M.margin,oa.ignorePrintArea=M.ignorePrintArea,
oa.sheetPrintOptions=M.sheetPrintOptions,oa.x1a=M.x1a,oa.NoColor=M.NoColor)};Object(pe.a)(r,"PrintSettingsContainer",null,[]);var Rj=b(148),lk=b(339),Oj=b(946),Ak=b(908),Ik=b(686);Object(pe.a)(B,"PrintSettingMarginOption",null,[]);Object(pe.a)(u,"PrintSettingMarginValue",null,[]);Object(pe.a)(x,"PrintSettingOption",null,[]);A.prototype.dispose=function(){};A.prototype.yvb=function(M){if(!M)return null;var oa=new u;oa.left=M.Left;oa.right=M.Right;oa.top=M.Top;oa.bottom=M.Bottom;oa.header=M.Header;
oa.footer=M.Footer;return oa};A.prototype.h4c=function(M){ud.ULS.shipAssertTag(537154186,0,6===M.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var oa={};oa.Top=M[0];oa.Bottom=M[1];oa.Left=M[2];oa.Right=M[3];oa.Header=M[4];oa.Footer=M[5];return oa};A.prototype.$bi=function(){this.Pje=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Km.fa(1187)}),Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Km.fa(1180)}),
Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Km.fa(1179)})];this.Zce=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Km.fa(1190)}),Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Km.fa(1189)})];this.pde=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Km.fa(1192)}),Object.assign(new x,{printSettingOptionKey:5,printSettingOptionText:this.Km.fa(1193)}),Object.assign(new x,{printSettingOptionKey:6,
printSettingOptionText:this.Km.fa(1200)}),Object.assign(new x,{printSettingOptionKey:7,printSettingOptionText:this.Km.fa(1194)}),Object.assign(new x,{printSettingOptionKey:8,printSettingOptionText:this.Km.fa(1195)}),Object.assign(new x,{printSettingOptionKey:9,printSettingOptionText:this.Km.fa(1196)}),Object.assign(new x,{printSettingOptionKey:11,printSettingOptionText:this.Km.fa(1197)}),Object.assign(new x,{printSettingOptionKey:12,printSettingOptionText:this.Km.fa(1198)}),Object.assign(new x,{printSettingOptionKey:13,
printSettingOptionText:this.Km.fa(1199)}),Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Km.fa(1191)})];this.bge=[Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Km.fa(1208)}),Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Km.fa(1209)}),Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Km.fa(1210)}),Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Km.fa(1211)})];this.Vae=[Object.assign(new B,
{printSettingOption:Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Km.fa(1214)}),marginValue:this.yvb(this.normal)}),Object.assign(new B,{printSettingOption:Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Km.fa(1215)}),marginValue:this.yvb(this.wide)}),Object.assign(new B,{printSettingOption:Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Km.fa(1216)}),marginValue:this.yvb(this.narrow)}),Object.assign(new B,{printSettingOption:Object.assign(new x,
{printSettingOptionKey:3,printSettingOptionText:this.Km.fa(1217)}),marginValue:this.yvb(this.C6)})]};A.prototype.Sbi=function(){this.normal=this.h4c(this.rEi);this.narrow=this.h4c(this.gDi);this.wide=this.h4c(this.xYj)};Qk.Object.defineProperties(A.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Pje}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.Zce}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.pde}},
scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.bge}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.Vae}}});A.Tch=1;A.Fch=1;A.Drb=9;A.Kch=2;A.Dch=0;A.wch=!1;A.sch=!1;A.YHa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(pe.a)(A,"PrintSettingsManagerBase",null,[2]);var Ok=b(121);t.prototype.getSheetName=function(){return this.sheetName};Object(pe.a)(t,"MacroRecorderSheetPrintOptionsSavedPayload",null,[106]);vm(w,
A);w.prototype.Jei=function(M){var oa=this;this.Kei(function(Xa){M&&(Xa=oa.yWh(Xa),M(Xa))})};w.prototype.oMd=function(M,oa){if(M){var Xa=new H(M.xv,M.ignorePrintArea);this.elj(Xa);!oa||this.F5f?ud.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",oa?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(oa=this.AWh(M.s0),oa.IsLandscape=2===M.orientation,oa.PaperSize=M.yca,this.isUniversalPrintEnabled&&(oa.NoColor=
M.NoColor),this.Twa&&(oa.PageMargin=this.ogd(M.margin)),oa.SheetPrintOptions=A.YHa,oa.SheetPrintOptions.PrintGrid=M.sheetPrintOptions.PrintGrid,oa.SheetPrintOptions.HorizontalCenter=M.sheetPrintOptions.HorizontalCenter,oa.SheetPrintOptions.VerticalCenter=M.sheetPrintOptions.VerticalCenter,oa.SheetPrintOptions.PrintHeaders=M.sheetPrintOptions.PrintHeaders,this.dlj(oa))}else ud.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};
w.prototype.ogd=function(M){var oa={};0===M?oa=this.normal:1===M?oa=this.wide:2===M?oa=this.narrow:3===M&&(oa=this.C6);return oa};w.prototype.afi=function(M){var oa=this;if(M){ud.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Xa=function(){return new t(oa.$.xa.pa.name,M)},Sb=this.$.na.ta,xc=this.$.na.ta.$b(),jd=function(vd,ae,Ie){var Zf=oa.$.xa.pa.name;vd=lh.b(oa.gBd,vd);ae=lh.a(oa.pBd,ae);var Vg=Sb.Na(1,null);
Vg.sheetName=Zf;Vg.printOptions=M;return ha.i(Sb,"SetPrintOptions",Vg,vd,ae,Ie,xc,0)};Xa=kf.EwaSettings.tc()?new Kc.a(598,0,jd,64,Xa):new Cj.a(598,0,jd,void 0,Xa);this.$.userOperationManager.ic(Xa,null)}else ud.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};w.prototype.dispose=function(){this.Nd||(this.Nd=!0,this.$.userOperationManager.jv(this.EF),this.lY())};w.prototype.elj=function(M){this.$N.xv=M.xv;this.$N.ignorePrintArea=
M.ignorePrintArea};w.prototype.Kei=function(M){function oa(ae,Ie,Zf){return fa(xc.$.na.ta,xc.sheetName,xc.locale,lh.b(ae,Sb),lh.a(Ie,Xa),Zf,jd)}function Xa(ae){ae=Ug.a.og(ae.data);ud.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Qg.a.Uc(ae));M(null)}function Sb(ae){gj.a(ae)?ud.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Qg.a.Uc(ae.Errors)):
(ud.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),M(ae.Result))}var xc=this,jd=this.$.na.ta.$b();var vd=kf.EwaSettings.tc()?new Kc.a(247,0,oa,80):new Cj.a(247,0,oa,16);vd=this.$.userOperationManager.ic(vd,null);this.ev.add(vd)};w.prototype.dlj=function(M){var oa=this;ud.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Xa=this.$.na.ta.$b();
this.$.userOperationManager.ic(new Kc.a(226,0,function(Sb,xc,jd){return ca(oa.$.na.ta,oa.sheetName,M,lh.b(Sb,oa.qSi),lh.a(xc,oa.pSi),jd,Xa)},void 0,function(){return new K(oa.sheetName,M)}),null)};w.prototype.Oli=function(M){return this.vdf(M)||!this.qgf(M.PaperSize)};w.prototype.ibd=function(M){this.vdf(M)&&(ud.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),M.ScalingWidth=w.b6c,M.ScalingHeight=w.a6c,M.ScalingPercent=w.w5b,
M.FitToPage=w.V5c);this.qgf(M.PaperSize)||(ud.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",M.PaperSize.toString()),M.PaperSize=w.Drb);return M};w.prototype.wWh=function(M){if(M.FitToPage){if(1===M.ScalingWidth&&1===M.ScalingHeight)return 1;if(!M.ScalingWidth&&1===M.ScalingHeight)return 3}else return 0;return 2};w.prototype.vWh=function(M){return this.wpd(M,this.normal)?0:this.wpd(M,this.wide)?
1:this.wpd(M,this.narrow)?2:3};w.prototype.wpd=function(M,oa){return M.Left===oa.Left&&M.Right===oa.Right&&M.Top===oa.Top&&M.Bottom===oa.Bottom&&M.Header===oa.Header&&M.Footer===oa.Footer};w.prototype.AWh=function(M){var oa={};oa.ScalingPercent=w.w5b;oa.FitToPage=0!==M;2===M?(oa.ScalingWidth=1,oa.ScalingHeight=0):3===M?(oa.ScalingWidth=0,oa.ScalingHeight=1):1===M&&(oa.ScalingWidth=1,oa.ScalingHeight=1);return oa};w.prototype.qgf=function(M){return this.IXi.contains(M.toString())};w.prototype.vdf=
function(M){return 100!==M.ScalingPercent||M.FitToPage&&(1<M.ScalingWidth||1<M.ScalingHeight)};w.prototype.g3g=function(){for(var M=new Ik.a(Ca.a.Gk()),oa=0;oa<this.paperSizeOptions.length;oa++)M.add(this.paperSizeOptions[oa].printSettingOptionKey.toString());return M};w.prototype.yWh=function(M){var oa=null;if(M){var Xa=this.$N.xv,Sb=this.$N.ignorePrintArea;this.Oli(M)&&(this.F5f=!0,M=this.ibd(M));oa=new r;oa.xv=Xa;oa.ignorePrintArea=Sb;oa.orientation=M.IsLandscape?2:1;oa.yca=M.PaperSize;oa.s0=this.wWh(M);
oa.sheetPrintOptions=A.YHa;oa.sheetPrintOptions.PrintGrid=M.SheetPrintOptions.PrintGrid;oa.x1a=M.Draft;this.isUniversalPrintEnabled&&(oa.NoColor=M.NoColor);oa.sheetPrintOptions.HorizontalCenter=M.SheetPrintOptions.HorizontalCenter;oa.sheetPrintOptions.VerticalCenter=M.SheetPrintOptions.VerticalCenter;oa.sheetPrintOptions.PrintHeaders=M.SheetPrintOptions.PrintHeaders;this.Twa&&(oa.margin=this.vWh(M.PageMargin),kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ud.ULS.sendTraceTag(553965398,
0,50,"PageMargin received : {0}",oa.margin),3===oa.margin&&(this.C6={},this.C6.Left=M.PageMargin.Left,this.C6.Right=M.PageMargin.Right,this.C6.Top=M.PageMargin.Top,this.C6.Bottom=M.PageMargin.Bottom,this.C6.Header=M.PageMargin.Header,this.C6.Footer=M.PageMargin.Footer))}return oa};w.prototype.lY=function(){if(this.ev){for(var M=yl(this.ev),oa=M.next();!oa.done;oa=M.next())oa=oa.value,this.$&&this.$.userOperationManager&&(oa.operation&&ud.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
Ok.a(oa.operation.operationName)),this.$.userOperationManager.cIa(oa)),this.ev.remove(oa);this.ev=null}};w.b6c=1;w.a6c=0;w.w5b=100;w.Drb=9;w.V5c=!0;Object(pe.a)(w,"PrintSettingsManager",A,[]);Object(pe.a)(v,"PrintSettingsTaskPaneCallbacks",null,[]);Object(pe.a)(f,"SelectedPrintSettings",null,[]);Object(pe.a)(m,"PrintOperationCallbacks",null,[]);Object(pe.a)(n,"PrintPreviewPaneCallbacks",null,[]);var Sj=b(1183);Object(pe.a)(l,"UniversalPrintAppSettings",null,[]);var dl=b(376);d.prototype.KGg=function(M){this.Ma.addHandler("ppocek",
M)};d.prototype.Ldj=function(M){this.Ma.removeHandler("ppocek",M)};d.prototype.xCj=function(M,oa){this.Bhj();this.$.userOperationManager.kx(this.EF);this.Fm=M;this.Ma.raiseEvent("ppocek");this.Fm.SelectedRanges&&this.Fm.SelectedRanges.Ranges&&0<this.Fm.SelectedRanges.Ranges.length&&this.Fm.SelectedRanges.Ranges[0]&&(this.selectedRange=Cf.B(this.Fm.SelectedRanges.Ranges[0]).toString());ud.ULS.shipAssertTag(537154268,0,!this.fv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");
this.fv=new w(this,this.$,oa,this.$.xa.pa.name,qe.a.instance,this.isUniversalPrintEnabled);ud.ULS.shipAssertTag(537154267,0,!this.tg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.tg=new Ak.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.tg.xgh();this.tg.zCj();this.tg.aGg(this.ZAf)};d.prototype.LTh=function(){this.fv.C6&&4<=this.fv.marginDetailedOptions.length&&(this.fv.marginDetailedOptions[3].marginValue=this.fv.yvb(this.fv.C6));
return this.fv.marginDetailedOptions};d.prototype.Jwc=function(){return!!this.Fm&&!!this.Fm.ObjectId||!zg.g(this.$).ha.va.qh};d.prototype.BWh=function(){var M=Object.assign(new f,{selectedWhatToPrint:A.Tch,selectedOrientation:A.Fch,selectedPaperSize:A.Drb,selectedScaling:A.Kch,selectedMargin:A.Dch,selectedIgnorePrintArea:A.wch,selectedPrintGridlines:A.YHa.PrintGrid,selectedDraft:A.sch,selectedHorizontalCenter:A.YHa.HorizontalCenter,selectedVerticalCenter:A.YHa.VerticalCenter,selectedRowAndColumnHeadings:A.YHa.PrintHeaders});
this.BH?(M.selectedWhatToPrint=this.BH.xv,M.selectedOrientation=this.BH.orientation,M.selectedPaperSize=this.BH.yca,M.selectedScaling=this.BH.s0,this.Twa&&(M.selectedMargin=this.BH.margin),M.selectedIgnorePrintArea=this.BH.ignorePrintArea,M.selectedPrintGridlines=this.BH.sheetPrintOptions.PrintGrid,M.selectedDraft=this.BH.x1a,this.isUniversalPrintEnabled&&(M.selectedColor=this.BH.NoColor?0:1),M.selectedHorizontalCenter=this.BH.sheetPrintOptions.HorizontalCenter,M.selectedVerticalCenter=this.BH.sheetPrintOptions.VerticalCenter,
M.selectedRowAndColumnHeadings=this.BH.sheetPrintOptions.PrintHeaders):ud.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return M};d.prototype.l2e=function(){var M=this;return Object.assign(new n,{onBackToSheet:function(){M.Vla()}})};d.prototype.xWh=function(){var M=this;return Object.assign(new Sj.a,{backActionButtonText:qe.a.instance.fa(1167),printPreviewPaneCallbacks:this.l2e(),logger:new uj.a,disableTellMeControl:!0,printOperationCallbacks:Object.assign(new m,
{onClosePreviewer:function(){M.Vla()},getGraphServiceAuthorizationToken:this.L$b(),onLocalPrint:function(){M.QBf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object.assign(new l,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.hgi()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};d.prototype.zWh=function(){var M=this;return Object.assign(new v,{onSettingChange:function(oa){M.bRi(oa)},
onPrint:function(){M.QBf()}})};d.prototype.bRi=function(M){this.W_++;M?(this.tg&&this.tg.qDj(),this.sk.xv=M.selectedWhatToPrint,this.sk.s0=M.selectedScaling,this.sk.orientation=M.selectedOrientation,this.sk.yca=M.selectedPaperSize,this.isUniversalPrintEnabled&&(this.sk.NoColor=!M.selectedColor),this.Twa&&(this.sk.margin=M.selectedMargin),this.sk.ignorePrintArea=M.selectedIgnorePrintArea,this.etj(M.selectedPageStart,M.selectedPageEnd),this.fv&&this.G6h(this.sk,M)?(this.sk.sheetPrintOptions=A.YHa,this.sk.sheetPrintOptions.PrintGrid=
M.selectedPrintGridlines,this.sk.sheetPrintOptions.HorizontalCenter=M.selectedHorizontalCenter,this.sk.sheetPrintOptions.VerticalCenter=M.selectedVerticalCenter,this.sk.sheetPrintOptions.PrintHeaders=M.selectedRowAndColumnHeadings,this.fv.afi(this.sk.sheetPrintOptions)):this.Vxb()):ud.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};d.prototype.Vla=function(){this.V5a&&(this.NLb=!0);ud.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",
this.W_);this.PBf();this.Qye()};d.prototype.QBf=function(){ud.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.W_);this.Twa&&kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ud.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.sk.margin,this.BH.margin);if(this.useMSPdfViewer)this.QJf();else if(this.A6a)try{this.tg.printPdf(),
this.c1c()}catch(M){ud.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.QJf()}else this.uia.G4f(this.wHa(!0)),this.c1c()};d.prototype.QJf=function(){var M=this.wHa(!0);this.c1c();Dg.HelperMethods.vf(M,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};d.prototype.dispose=function(){hg.a.Fa(this.Ma)};d.prototype.Vxb=function(){var M=this;if(this.$.Awa)this.Gei();else{this.lY();this.zUf();var oa=null;this.sbi();ud.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Xa=function(Sb,xc,jd){Sb=new Lj.a(Sb,null,xc,jd,null,!0,!1,"GetFileCopyFileHandler","");Sb.correlationID=qi.a.create().toString();oa=Sb;M.Nba=M.f3.E9(M.wHa(M.A6a?!1:!0,M.agi?"Base64":"Pdf"),1,null,null,d.Aad,!1,2,M.cAd,M.bAd,oa,void 0,void 0,void 0,12E4);Sb.requestId=M.Nba;ud.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",M.Nba);return Wg.Task.Ta(!0)};
this.$Ma=kf.EwaSettings.tc()?this.$.userOperationManager.ic(new Kc.a(223,0,Xa,80),null):this.$.userOperationManager.ic(new Cj.a(223,0,Xa,16),null)}};d.prototype.c1c=function(){this.PBf();this.Qye()};d.prototype.gBd=function(M){Qg.a.dr(M.Errors)?this.tg.showErrorMessageForPrintOptions(qe.a.instance.fa(1218)):(ud.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Vxb(),this.tg&&this.tg.hideErrorMessageForPrintOptions())};
d.prototype.pBd=function(M){this.tg&&this.tg.showErrorMessageForPrintOptions(qe.a.instance.fa(1218));M=Ug.a.og(M.data);ud.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",Qg.a.Uc(M))};d.prototype.Gei=function(){function M(Sb,xc,jd){var vd={};vd.WhatToPrint=oa.sk.xv;vd.UseNamedAction=oa.uia.gxc();vd.SelectedSheetName=oa.$.xa.pa.name;vd.ActiveCell=oa.activeCell;vd.SelectedRanges=[oa.selectedRange];vd.IsPdfDocumentRequired=
!1;vd.Orientation=oa.sk.orientation;vd.PaperSize=oa.sk.yca;vd.Scaling=oa.sk.s0;vd.RichValuesEnabled=!0;vd.IgnorePrintArea=oa.sk.ignorePrintArea;vd.Preview=!0;oa.isUniversalPrintEnabled&&(vd.NoColor=oa.sk.NoColor);oa.h2f()&&(vd.PaginationStartPage=oa.Rya,vd.PaginationEndPage=oa.oma,vd.OutputTotalPdfPageCount=!0);if(oa.Twa){var ae=oa.fv.ogd(oa.sk.margin);ae&&(vd.PageMargin={},vd.PageMargin.Top=ae.Top,vd.PageMargin.Bottom=ae.Bottom,vd.PageMargin.Left=ae.Left,vd.PageMargin.Right=ae.Right,vd.PageMargin.Header=
ae.Header,vd.PageMargin.Footer=ae.Footer)}oa.C7a=W(oa.$.na.ta,vd,lh.b(oa.NJi,Sb),lh.a(oa.MJi,xc),jd,Xa);return oa.C7a}var oa=this;ud.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.lY();var Xa=this.$.na.ta.$b();kf.EwaSettings.tc()?this.$Ma=this.$.userOperationManager.ic(new Kc.a(133,0,M,80),null):this.$Ma=this.$.userOperationManager.ic(new Cj.a(133,0,M,16),null)};d.prototype.Qye=function(){this.$.userOperationManager.jv(this.EF);
this.lY();this.zUf();ud.ULS.shipAssertTag(537154261,0,!!this.tg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.tg&&(this.tg.mdj(this.ZAf),this.tg.Ggh(),this.tg=null);this.Fm=null;this.fv&&(this.fv.dispose(),this.fv=null);this.W2a=this.MEb=null;this.$Kc=!1;this.Ma&&this.Ma.raiseEvent("ppocek")};d.prototype.fyj=function(){return this.$.isEditMode&&!!this.BH&&!!this.sk&&2!==this.sk.xv&&this.tjd()};d.prototype.oMd=function(){ud.ULS.shipAssertTag(537154260,0,
!!this.fv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.fv&&this.fv.oMd(this.sk,this.fyj())};d.prototype.wHa=function(M,oa){oa=void 0===oa?"Pdf":oa;var Xa=new Sys.StringBuilder;Xa.append(Nk.a(this.$,oa,!0));Yg.a.Xf(Xa,Gg.a.NFd,""+this.sk.xv);M&&this.uia.gxc()&&Yg.a.Xf(Xa,Gg.a.lfg,"1");Yg.a.Xf(Xa,Gg.a.kLf,this.$.xa.pa.name);0===this.sk.xv&&(Yg.a.Xf(Xa,Gg.a.jLf,this.selectedRange),Yg.a.Xf(Xa,Gg.a.dLf,this.activeCell));Yg.a.Xf(Xa,Gg.a.eLf,""+this.sk.orientation);
Yg.a.Xf(Xa,Gg.a.fLf,""+this.sk.yca);Yg.a.Xf(Xa,Gg.a.iLf,""+this.sk.s0);Yg.a.Xf(Xa,Gg.a.hLf,"1");Yg.a.Xf(Xa,Gg.a.cLf,this.sk.ignorePrintArea?"1":"0");Yg.a.Xf(Xa,Gg.a.gLf,"1");this.oKg(Xa);this.isUniversalPrintEnabled&&Yg.a.Xf(Xa,Gg.a.V3i,this.sk.NoColor?"1":"0");this.Twa&&this.nKg(Xa);Jb.a.equals(oa,"Pdf",!0)&&(Xa.append("&#toolbar=0"),Xa.append("&zoom=100"));M=Xa.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");ud.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",
M);return M};d.prototype.etj=function(M,oa){M||oa?(this.kyb=!0,this.Rya=M,this.oma=oa):this.NTf()};d.prototype.oKg=function(M){this.h2f()&&(Yg.a.Xf(M,Gg.a.X3i,""+this.Rya),Yg.a.Xf(M,Gg.a.W3i,""+this.oma),Yg.a.Xf(M,Gg.a.Y3i,"1"),ud.ULS.sendTraceTag(537154258,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.Rya,this.oma))};d.prototype.h2f=function(){return null!=this.Rya&&0<this.Rya&&null!=this.oma&&0<this.oma};d.prototype.nKg=function(M){if(this.fv&&
this.sk){var oa=this.fv.ogd(this.sk.margin);oa&&Yg.a.Xf(M,Gg.a.U3i,""+oa.Top+" "+oa.Bottom+" "+oa.Left+" "+oa.Right+" "+oa.Header+" "+oa.Footer)}};d.prototype.bDb=function(M,oa,Xa,Sb){this.tg&&(ud.ULS.shipAssertTag(537154255,0,!!this.$.xa.pa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.pa&&(this.A6a?(Sb||(Sb=this.wHa(!1)),this.tg.Hti(Sb)):this.rCj()))};d.prototype.tjd=function(){return!this.BH.equals(this.sk)};d.prototype.PBf=function(){!this.NLb&&
0<this.W_&&(this.Npd?this.oMd():ud.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));ud.ULS.shipAssertTag(537154250,0,!!this.tg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.tg&&this.tg.Q7h();this.zWd()};d.prototype.ui=function(){ud.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.tg){var M=this.Xza(qe.a.instance.fa(1));this.Nna(M,
1)}else M=Qg.a.jd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),kf.EwaSettings.nz()?new lk.a(this.$,M):(new Rj.ErrorDialog(this.$,M)).mf()};d.prototype.yCj=function(M){M?(0===M.xv&&this.Jwc()&&(ud.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",this.Fm.ObjectId?"floatingObject":"discontinuousRange"),M.xv=1),r.PCe(M,this.BH),r.PCe(M,this.sk),ud.ULS.shipAssertTag(537154248,0,!!this.tg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.tg&&(this.Npd=!0,this.tg.ACj(),this.Vxb())):(ud.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.ui())};d.prototype.R_c=function(M,oa,Xa){M>oa&&(oa=Object.assign(new tj.a,{extendedProperties:new Map}),oa.extendedProperties.set("WtpSelectedValue",Xa),oa.extendedProperties.set("FullyRenderedPdfLoadTime",M.toString()),jh.Health.instance.recordQosError(sj.a.zEj,[Wf.a.O5f],!1,!0,!0,!1,oa))};d.prototype.lY=function(){this.$Ma&&
(0<this.Nba||this.C7a)&&(ud.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Nba),this.$.userOperationManager.cIa(this.$Ma),this.C7a?Ug.a.nu(this.C7a.Et):this.f3.nu(this.Nba),this.UKd())};d.prototype.UKd=function(){this.C7a=this.$Ma=null};d.prototype.sbi=function(){this.jKd&&this.sk&&(this.W2a=this.$.Wb.Ic("UserAction",(1===this.sk.xv?"ActiveSheet":0===this.sk.xv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};
d.prototype.NTf=function(){this.kyb=!1;this.Rya=1;this.oma=this.$Ed};d.prototype.Xza=function(M){if(M)return M.replace("&#39;","'");ud.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return M};d.prototype.rCj=function(){ud.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.ezb)if(this.Wgc)ud.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");
else{var M=this.Xza(qe.a.instance.fa(1172));this.Nna(M,2)}else M=this.Xza(qe.a.instance.fa(1173)),this.Nna(M,3)};d.prototype.Nna=function(M,oa,Xa){this.tg.Iz(M,oa,void 0===Xa?null:Xa)};d.prototype.Ebi=function(){this.Wgc=this.yye();this.ezb=this.oXg();this.A6a=this.pXg();ud.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",this.Wgc,this.ezb,
this.A6a)};d.prototype.Bhj=function(){this.z7a=null;this.UKd();this.NTf();this.MEb=this.$.Wb.Ic("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.pa.activeCell.toString();this.W_=0;this.Npd=this.V5a=this.NLb=!1;this.$Kc=!0};d.prototype.eAj=function(){var M=this.woi()||this.xif()&&kf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;ud.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",M);return M};d.prototype.yye=function(){return!Ff.a.bB};
d.prototype.YWg=function(){var M=15;Ff.a.KH&&Ff.a.rsb&&(M=parseFloat(Ff.a.rsb));return this.yye()&&14<M&&this.ezb};d.prototype.oXg=function(){return this.xif()&&!kf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};d.prototype.woi=function(){return Ff.a.LC||Pd.AFrameworkApplication.isUnifiedHostMode};d.prototype.pXg=function(){return this.Wgc&&this.ezb};d.prototype.xif=function(){return!this.$.jg.get(111)};d.prototype.zUf=function(){this.z7a&&(URL.revokeObjectURL(this.z7a),
this.z7a=null)};d.prototype.e5g=function(M){var oa=M.data.je;M=this.$.Wb.Ic("UserAction","PrintPreviewBlobFileCreation");var Xa=window.self.atob(oa);oa=new Uint8Array(oa.length);for(var Sb=0;Sb<Xa.length;Sb++)oa[Sb]=Xa.charCodeAt(Sb)&255;Xa=new Blob([oa],{type:"application/pdf"});this.z7a=URL.createObjectURL(Xa);ud.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",M.Ec,Xa.size);M.stop();return this.z7a+
"#toolbar=0&zoom=100"};d.prototype.c8i=function(M){if(this.jKd&&Qg.a.kh(M,d.UYi)){var oa=Object.assign(new tj.a,{extendedProperties:new Map});oa.extendedProperties.set("ErrorMessageIdName",M[0].MessageIdName);jh.Health.instance.recordQosError(sj.a.OJf,[Wf.a.PJf],!1,!0,!0,!1,oa)}};d.prototype.G6h=function(M,oa){return M.sheetPrintOptions.PrintGrid!==oa.selectedPrintGridlines||M.sheetPrintOptions.HorizontalCenter!==oa.selectedHorizontalCenter||M.sheetPrintOptions.VerticalCenter!==oa.selectedVerticalCenter||
M.sheetPrintOptions.PrintHeaders!==oa.selectedRowAndColumnHeadings};d.prototype.zWd=function(){this.Mpd&&this.$.ye(-1753588160,-1,0,null)};d.prototype.hgi=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};d.prototype.getToken=function(){return this.Eyd.yS("Print",this.graphServiceEndpoint).then(function(M){return M?(M.IsSuccess||ud.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",
M.ErrorCode,M.ErrorMessage),M):Object.assign(new Oj.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(M){var oa=new Oj.a;Object.getType(M)===Object.getType(oa)?oa=M:(oa.ErrorMessage=M.toString(),oa.ErrorCode="exception");return Promise.resolve(oa)})};d.prototype.L$b=function(){var M=this;return function(){var oa=Promise.resolve("");try{if(M.Eyd&&M.Eyd.LLa())return M.getToken().then(function(Xa){return Xa.IsSuccess?Promise.resolve(Xa.Token):oa},function(){return oa})}catch(Xa){ud.ULS.sendTraceTag(537154211,
0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Xa)}return oa}};d.prototype.onNotifyPrintJobStatus=function(M,oa){M=dl.a.Hy.notificationBar.J$(M,!1);"pending"==oa&&(M.displayTimeoutSeconds=3);M.image=0;dl.a.Hy.notificationBar.YD(M)};Qk.Object.defineProperties(d.prototype,{Nli:{configurable:!0,enumerable:!0,get:function(){return this.$Kc}}});d.UYi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,
-2077518688,1348242499,2030854436,-1831476778];d.Aad=["Content-Type","Total-Pdf-PageCount"];Object(pe.a)(d,"PrintPreviewManager",null,[451,2,452]);c.prototype.Zc=function(){return!1};c.prototype.executeCommand=function(M,oa,Xa,Sb){var xc=oa.command;return 1588554917===xc?(oa.syb=!0,Ck.a(this.$)&&this.$.da.Aa(423).xxc(!1),this.ohh(oa)?Wg.Task.Ta(!0):h.a(xc)):this.MJf.executeCommand(M,oa,Xa,Sb,this.IQi,this.HQi,this.pNj)};c.prototype.Kc=function(M,oa){return 1588554917===oa.command?(ud.ULS.shipAssertTag(537154305,
0,this.$.Bka,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.MJf.Kc(M,oa)};c.prototype.gd=function(){return!1};c.prototype.ohh=function(M){return this.$.ea.rc?this.phh(M):!1};c.prototype.phh=function(M){ud.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var oa=this.$.Wb.Ic("UserAction","DoPrintHtml"),Xa=this.$,Sb=this.ea.isNamedObjectViewMode?Xa.zb.pa.sheetName:Xa.xa.pa.name,xc=this.ea.isNamedObjectViewMode,jd=!xc;Xa=this.uWh(Xa,Sb,
jd);var vd=!0;!kf.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Awa&&(vd=!1);jd?vd?Ji.a(this.$)?ud.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.hD.xCj(Xa,this.$N),ud.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new T(this.$,qe.a.instance.fa(1181),3,Xa,M,this.uia,Sb,this.$N)).mf(),ud.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",
oa.Ec)):((new da(this.$,qe.a.instance.fa(1181),3,Xa,M)).mf(),ud.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",oa.Ec,xc));oa.stop();this.Sid();return!0};c.prototype.uWh=function(M,oa,Xa){var Sb={};Sb.SessionId=this.ea.sessionId;Sb.UsedRangeTooBig=!1;var xc=zg.g(M),jd=xc.ha,vd=jd.We;if(vi.e(M.pa))Sb.Type=0,Sb.ObjectId=M.pa.name,Sb.UseSelection=!1;else if(vi.g(M.pa))Sb.Type=1,Sb.ObjectId=M.pa.ika,Sb.UseSelection=
!0;else if(2===vd||4===vd||64===vd)xc=jd.Pa.mc.floatingObject,Sb.Type=1,Sb.SheetName=oa,Sb.ObjectId=xc.id,Sb.UseSelection=!0;else if(Xa&&vd&470)Sb.ObjectId=jd.Pa.mc.floatingObject.id,Sb.SheetName=oa;else if(vi.i(M.pa)){Sb.Type=2;Sb.SheetName=oa;if(jd.va.qh)if(Xa=jd.va.Td,Sb.SelectedRanges=Cf.q(Xa,M),20<Xa.kU)Sb.UseSelection=!0;else{oa=0;xc=xc.wl("PrintCommandHandler.DoPrintHtml",Xa);try{for(xc.$$rst();xc.$$mn()&&2>oa;)xc.$$cu().text&&oa++;Sb.UseSelection=2<=oa}finally{xc&&xc.dispose()}}else Sb.UseSelection=
!1,Sb.SelectedRanges=Cf.q(jd.va.activeRange,M);this.ea.isNamedObjectViewMode&&(Sb.UsedRange=Cf.v(M.pa.usedRange,M))}Sb.Title=M.workbookContext.WorkbookFileName;return Sb};c.prototype.Sid=function(){zg.g(this.$);if(!this.r2f){this.EQc=!0;var M=this.$.Wb.Ic("UserAction","HandlePageLayoutRendering");this.ENj();ud.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",M.Ec);M.stop()}};c.prototype.ENj=function(){for(var M=zg.g(this.$).Ca,oa=M.UE(),
Xa=!1,Sb=0,xc=0;xc<oa.length;xc++){var jd=oa[xc],vd=jd.Cf;vd&&vd.hasPageLayout()&&(Xa=!0,vd.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+jd.Yd,4),Sb++)}Xa&&(ud.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",oa.length,Sb),M.kyd())};Qk.Object.defineProperties(c.prototype,{r2f:{configurable:!0,enumerable:!0,get:function(){return this.EQc}}});Object(pe.a)(c,"PrintCommandHandler",
null,[239,436]);var jl=ch.a;vm(a,jl);a.prototype.Pd=function(){var M=this,oa=Pd.AFrameworkApplication.ga.appSettings,Xa=this.$.ya.DirectPrintSetting;oa.DirectPrintIsEnabled=Xa.DirectPrintIsEnabled.toString();oa.DirectPrintProbeIsEnabled=Xa.DirectPrintProbeIsEnabled.toString();oa.DirectPrintEnabledForInternetExplorer=Xa.DirectPrintEnabledForInternetExplorer.toString();oa.DirectPrintSupportedMimeTypes=Xa.DirectPrintSupportedMimeTypes;oa.DirectPrintSupportedPlugins=Xa.DirectPrintSupportedPlugins;oa.DirectPrintImmersivePreviewPlugins=
Xa.DirectPrintImmersivePreviewPlugins;oa.DirectPrintMinimalSupportedEdgeVersion=Xa.DirectPrintMinimalSupportedEdgeVersion;oa.DirectPrintEnabledForEdge=Xa.DirectPrintEnabledForEdge.toString();oa=new Pa(oa);var Sb=null;Xa=null;try{Xa=window.navigator.mimeTypes}catch(vd){ud.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var xc=null;try{xc=window.navigator.plugins}catch(vd){ud.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Sb=new qa(oa,Xa,xc,qa.Qdf,
qa.aif,new Ya(Pd.AFrameworkApplication.sa.oX),Pd.AFrameworkApplication.sa.vD,qa.bif,function(vd,ae){return new Ha(vd,!1,ae)},!1);if(kf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.jg.get(116)){var jd=vg.GetServiceTaskFactory.Wa(this.$.da,349,350,this.ub);oh.TaskExtensions.Ba(jd,function(){var vd=new c(M.$,Sb,jd.result);M.Gd([vd])},this.$.ma)}else this.Gd([new c(this.$,Sb,null)])};a.ka=function(M){ch.a.he(73,new a(M))};Object(pe.a)(a,"PrintCommandHandlerFactory",
ch.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Gd.a.Zi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");cf.main();Type.registerNamespace("Common.App.NewAndOpen.UX");jg.a.instance.rj(new nc);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Ld.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");qg.main();Type.registerNamespace("Common.App.SaveToSharePoint");Zb.main();Type.registerNamespace("Common.App.SaveToCloudStorage");xf.main();Type.registerNamespace("Common.App.SaveACopy");
tg.main();Type.registerNamespace("Common.App.SharedFilePicker");he.main();Type.registerNamespace("Common.App.WildFire");rg.main();rf.a.Ga(vf.ka);rf.a.Ga(jf.ka);rf.a.Ga(ce.ka);Gd.a.Zi(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
rf.a.Ga(Cc.ka);Gd.a.Zi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){rf.a.Ga(function(M){pc.ka(M)})})();(function(){rf.a.Ga(function(M){M.da.Ha(165,new Yc(M))})})();rf.a.Ga(Qd.ka);(function(){rf.a.Ga(function(M){M.da.Ha(57,new je(M));M.da.Ha(60,new yb(M));M.da.Ha(63,new oc(M))})})();rf.a.Ga(pd.ka);rf.a.Ga(td.ka);rf.a.Ga(rb.ka);Gd.a.Zi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){rf.a.Ga(function(M){Ad.ka(M);zc.ka(M)})})();Gd.a.Zi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
Gd.a.Zi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){rf.a.Ga(function(M){ld.ka(M);sa.ka(M)})})();rf.a.Ga(Ib.ka);rf.a.Ga(Mb.ka);(function(){rf.a.Ga(function(M){ib.ka(M);Ab.ka(M)})})();rf.a.Ga(ta.ka);rf.a.Ga(qb.ka);(function(){rf.a.Ga(function(M){Ga.ka(M);xa.ka(M)})})();rf.a.Ga(Db.ka);(function(){rf.a.Ga(function(M){ma.ka(M);eb.ka(M)})})();Type.registerNamespace("Common.App.DirectPrint");jg.a.instance.rj(new ea);rf.a.Ga(a.ka)},830:function(y,
F,b){function a(D,V){var U=z.call(this,document.createElement("div"))||this;U.sx=null;U.QS=null;U.k8=null;U.Pba=null;U.h2b=null;U.pke=null;U.Spe=null;U.rlf=null;U.Qwb=!1;U.hw=!1;U.K4=!1;U.PKa=!1;U.XIi=function(Q){U.yF(Q)};U.bJi=function(Q){13===Q.keyCode&&U.yF(Q)};U.Vyd=function(Q){U.jp(Q.yb);return!0};U.bzd=function(Q){U.i6(Q.yb);return!0};U.HAd=function(Q){U.dma(Q.yb);return!0};U.s1=D;U.dH=V;U.GXc=V.YZa.toString();U.title=V.title;U.message=V.message;U.set_visibilityMode(1);return U}b.d(F,"a",function(){return a});
y=b(0);var c=b(13),d=b(88),l=b(275),n=b(12),m=b(117),f=b(91);F=b(230);var v=b(1171),w=b(16),t=b(4),A=b(317),x=b(53),u=b(11),B=b(69),r=b(14),I=b(19),z=F.a;vm(a,z);a.prototype.dispose=function(){d.a.sc([this.h2b,this.QS,this.k8]);this.hw&&this.QS&&(l.a.instance.za(n.a.click,this.QS.domElement,this.Vyd),m.KeyInputManager.instance.vv(this.domElement,this.pke));this.K4&&this.k8&&(l.a.instance.za(n.a.click,this.k8.domElement,this.bzd),m.KeyInputManager.instance.vv(this.domElement,this.Spe));this.PKa&&this.Pba&&
(l.a.instance.za(n.a.click,this.Pba,this.HAd),m.KeyInputManager.instance.vv(this.domElement,this.rlf));this.Pba=this.sx=this.s1=this.k8=this.QS=null;z.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.zRj=function(){this.LEe(!0)};a.prototype.o3c=function(){this.LEe(!1)};a.prototype.LEe=function(D){var V="<div class='"+v.a.enh+"' id='{0}'><div class='"+v.a.cnh+"'><a class='"+v.a.knh+"' title='{1}'><span class='"+w.a.f2b+" "+v.a.gnh+"' id='{2}'>";this.Mj.length&&(V+="<img class='{3}' src='{4}'/>");
V+="</span></a><span class='"+v.a.jnh+"' id='{5}'>{6}</span><span class='"+v.a.inh+"' id='message'>{7}</span><a id='link' href='#' class='"+v.a.hnh+"'>{8}</a><span class='"+v.a.aNe+"'><button type='button' id='action' class='"+v.a.$Me+"'>{9}</button></span><span class='"+v.a.aNe+"'><button type='button' id='altAction' class='"+v.a.$Me+"'>{10}</button></span></div><a class='"+v.a.fnh+"' tabindex='0' role='button'><span id='close' class='"+w.a.fr+"'><img class='"+w.a.W9c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";
D||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var U=this.businessBar.$.Jb;D=U+"ewaBusinessBarEntryBody"+this.GXc;var Q=U+"ewaBusinessBarEntryTitle"+this.GXc;U=U+"ewaBusinessBarEntryIcon"+this.GXc;this.domElement.className=v.a.dnh;this.domElement.innerHTML=String.format(V,D,this.alt,U,this.Mj,x.a.Fe(0),Q,this.title,this.message,this.linkText,this.actionButton,this.YYa,x.a.Fe(13),r.a.instance.fa(776));u.DOMElementExtensions.rs(this.domElement,t.a.Yra,Q,D);
this.Pba=$get("link",this.domElement);u.DOMElementExtensions.setVisible(this.Pba,this.PKa);this.PKa&&(l.a.instance.qa(n.a.click,this.Pba,this.HAd),this.rlf=m.KeyInputManager.instance.ns(this.Pba,this.HAd,f.a.Zh,f.a.g1));this.QS=new A.a(u.DOMElementExtensions.getElementById(this.domElement,"action"));this.QS.isVisible=this.hw;this.k8=new A.a(u.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.k8.isVisible=this.K4;this.hw&&(l.a.instance.qa(n.a.click,this.QS.domElement,this.Vyd),
this.pke=m.KeyInputManager.instance.ns(this.QS.domElement,this.Vyd,f.a.Zh,f.a.g1),this.K4&&(l.a.instance.qa(n.a.click,this.k8.domElement,this.bzd),this.Spe=m.KeyInputManager.instance.ns(this.QS.domElement,this.bzd,f.a.Zh,f.a.g1)));this.sx=$get("close",this.domElement);this.h2b=this.Qd.Ed(this.sx);this.h2b.ka("click",this.XIi);this.h2b.ka("keydown",this.bJi);u.DOMElementExtensions.setVisible(this.sx,!this.Qwb)};a.prototype.jp=function(){c.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",
this.dH.hash,this.dH.K8c);I.g(this.businessBar.$).Qq(!0)};a.prototype.i6=function(){c.ULS.sendTraceTag(537170257,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.dH.hash);I.g(this.businessBar.$).Qq(!0)};a.prototype.dma=function(){c.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.dH.hash);I.g(this.businessBar.$).Qq(!0)};a.prototype.yF=function(D){c.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",
this.dH.hash,this.dH.K8c);this.set_visible(!1);this.businessBar.removeEntry(this.zSg);B.g(D)};Qk.Object.defineProperties(a.prototype,{zSg:{configurable:!0,enumerable:!0,get:function(){return this.dH.YZa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.s1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.dH?this.dH.actionButton:""}},YYa:{configurable:!0,enumerable:!0,get:function(){return this.dH?this.dH.YYa:""}},linkText:{configurable:!0,enumerable:!0,
get:function(){return this.dH?this.dH.link:""}},Mj:{configurable:!0,enumerable:!0,get:function(){return this.dH?this.dH.Mj:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.dH?this.dH.alt:""}}});Object(y.a)(a,"BusinessBarEntry",F.a,[])},908:function(y,F,b){function a(K,da,fa,W){var ca=T.call(this)||this;ca.MF=null;ca.iD=null;ca.tW=null;ca.zw=null;ca.IFb=null;ca.YK=null;ca.vjc=null;ca.YAb=null;ca.XAb=!1;ca.Gwa=!0;ca.npc=null;ca.ewaAccessibilityManager=null;ca.ZEd=null;ca.YEd=null;
ca.bFd=null;ca.Ind=!1;ca.Bzf=function(){w.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",ca.XAb);ca.XAb&&(ca.Y7h(),ca.YK.style.visibility="visible",ca.vjc?ca.vjc.stop():w.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),ca.raiseEvent(a.xCb,new v(1)),ca.tOd(),ca.XAb=!1)};ca.$=K;ca.hD=da;ca.Z8g();ca.useMSPdfViewer=fa;ca.isUniversalPrintEnabled=W;return ca}function c(){this.msPdfViewerFileUrl=
null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function d(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function l(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=
null}function n(K){this.tg=K}function m(K){this.tg=K}function f(K){this.tg=K}function v(K){var da=V.call(this)||this;da.X1i=K;return da}b.r(F);y=b(0);var w=b(13),t=b(5);b(23);var A=b(387),x=b(36),u=b(56),B=b(11),r=b(122),I=b(1),z=b(14),D=b(19),V=Sys.EventArgs;vm(v,V);Object(y.a)(v,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var U=b(255),Q=b(244);f.prototype.Qg=function(){U.a(this.tg.$).aN(this.$d)||U.a(this.tg.$).Qg(this)};f.prototype.V7=function(){U.a(this.tg.$).aN(this.$d)&&U.a(this.tg.$).Cz(this)};
f.prototype.Yf=function(K){return B.DOMElementExtensions.Pe(this.Kb,K)};f.prototype.fi=function(){this.tg.$.frame.Te.dk(this.tg.$.frame.Te.xE)};f.prototype.Ph=function(){};f.prototype.Oe=function(K,da){return da?!1:(this.tg.enterPrintPreviewHeaderFocusTrapZone(),!0)};Qk.Object.defineProperties(f.prototype,{$d:{configurable:!0,enumerable:!0,get:function(){return Q.a.RJf}},Kb:{configurable:!0,enumerable:!0,get:function(){var K=b(908).PrintPreviewPane;return document.getElementById(K.W1i)}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return!0}}});Object(y.a)(f,"PrintPreviewHeaderKeyboardAccessibleSection",null,[117]);m.prototype.Qg=function(){U.a(this.tg.$).aN(this.$d)||U.a(this.tg.$).Qg(this)};m.prototype.V7=function(){U.a(this.tg.$).aN(this.$d)&&U.a(this.tg.$).Cz(this)};m.prototype.Yf=function(K){return B.DOMElementExtensions.Pe(this.Kb,K)};m.prototype.fi=function(){this.tg.$.frame.Te.dk(this.tg.$.frame.Te.xE)};m.prototype.Ph=function(){};m.prototype.Oe=function(K,da){return da?!1:(this.tg.useMSPdfViewer?
(K=document.getElementById(b(908).PrintPreviewPane.XCd))&&B.DOMElementExtensions.setFocus(K,!0):B.DOMElementExtensions.setFocus(this.tg.YK),!0)};Qk.Object.defineProperties(m.prototype,{$d:{configurable:!0,enumerable:!0,get:function(){return Q.a.SJf}},Kb:{configurable:!0,enumerable:!0,get:function(){var K=b(908).PrintPreviewPane;return this.tg.useMSPdfViewer?document.getElementById(b(908).PrintPreviewPane.XCd):document.getElementById(K.mHf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});
Object(y.a)(m,"PrintPreviewKeyboardAccessibleSection",null,[117]);n.prototype.Qg=function(){U.a(this.tg.$).aN(this.$d)||U.a(this.tg.$).Qg(this)};n.prototype.V7=function(){U.a(this.tg.$).aN(this.$d)&&U.a(this.tg.$).Cz(this)};n.prototype.Yf=function(K){return B.DOMElementExtensions.Pe(this.Kb,K)};n.prototype.fi=function(){this.tg.$.frame.Te.dk(this.tg.$.frame.Te.xE)};n.prototype.Ph=function(){};n.prototype.Oe=function(K,da){return da?!1:(this.tg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Qk.Object.defineProperties(n.prototype,
{$d:{configurable:!0,enumerable:!0,get:function(){return Q.a.VJf}},Kb:{configurable:!0,enumerable:!0,get:function(){var K=b(908).PrintPreviewPane;return document.getElementById(K.aFd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(n,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[117]);Object(y.a)(l,"MSPdfViewerFileUrl",null,[]);Object(y.a)(d,"PrintSettingsTaskPaneProps",null,[]);Object(y.a)(c,"ViewerPaneProps",null,[]);var la=b(1183),ba=b(379),S=b(4),
H=b(1184);b.d(F,"PrintPreviewPane",function(){return a});var T=x.a;vm(a,T);a.prototype.aGg=function(K){this.addHandler(a.xCb,K)};a.prototype.mdj=function(K){this.removeHandler(a.xCb,K)};a.prototype.zCj=function(){this.U8g()};a.prototype.ACj=function(){var K=this.$.Wb.Ic("UserAction","createSettingsPaneStopwatch"),da=document.getElementById(a.aFd);this.$8g();var fa=this.a9g();this.iD.createPrintSettingsTaskPane(da,fa);K.stop();this.XAb=!1;if(this.isUniversalPrintEnabled&&this.zw){K="A4";switch(fa.selectedPrintSettingsValues.selectedPaperSize){case 8:K=
"A3";break;case 9:K="A4";break;case 11:K="A5";break;case 12:K="JIS B4";break;case 13:K="JIS B5";break;case 5:K="North America Legal";break;case 1:K="North America Letter";break;case 6:K="North America Invoice";break;case 7:K="North America Executive";break;case 3:K="North America Ledger"}this.MF.setDocumentSettings({mediaSize:K,orientation:2===fa.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===fa.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.NHd()};
a.prototype.setPageRangeSettings=function(K,da,fa,W,ca){this.iD&&(this.iD.setPageRangeSettings(K,da,fa,W,ca),this.Z_f(String.format(z.a.instance.Cb(195),W,ca,K)))};a.prototype.Q7h=function(){this.zw&&(this.zw.style.display="none")};a.prototype.Ggh=function(){this.dispose();this.sXd();this.yPj();this.MF&&this.MF.closePrintPreviewPane();this.tW=this.iD=this.MF=this.zw=null};a.prototype.Hti=function(K){w.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?
((this.YAb=this.$.Wb.Ic("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||w.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.tW.renderPdf(K)):this.YK&&((this.vjc=this.$.Wb.Ic("UserAction","loadPdfStopwatch"))||w.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.XAb=!0,this.YK.src&&this.YK.src===K?this.Bzf(null):this.YK.src=K);if(this.isUniversalPrintEnabled&&this.zw){var da=ba.b(this.$.workbookContext);
this.MF.setFileUrl(K,da)}};a.prototype.onPdfLoad=function(){this.YAb?(w.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.YAb.Ec,this.Gwa),this.YAb.stop()):w.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.xCb,new v(1));this.hideWaitCursor();this.tOd()};a.prototype.printPdf=function(){B.DOMElementExtensions.setFocus(this.YK);this.YK.contentWindow.print()};a.prototype.qDj=
function(){this.showSpinner();this.showWaitCursor();this.Z_f("")};a.prototype.Y7h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.Iz=function(K,da,fa){this.zw&&this.tW&&(this.Ind=!1,this.tW.showErrorDetails(da,K,void 0===fa?null:fa),this.hD.V5a=!0,this.YK&&(this.YK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.xli(da)&&(this.Ind=!0,this.LQi()))};a.prototype.hidePreviewError=function(){this.hD.V5a=!1;this.tW.hidePreviewError();this.enablePrintButton()};a.prototype.xgh=
function(){(this.IFb=document.getElementById(a.TJf))&&this.IFb.parentNode&&this.IFb.parentNode.removeChild(this.IFb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.iD&&this.iD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(K){this.iD&&this.iD.showErrorMessageForPrintOptions(K)};a.prototype.showSpinner=function(){this.hD.V5a||I.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Ind?this.hidePreviewError():
this.YK&&(this.YK.style.visibility="hidden");this.tW&&this.tW.showSpinner()};a.prototype.hideSpinner=function(){this.tW&&this.tW.hideSpinner()};a.prototype.enablePrintButton=function(){this.iD&&this.iD.enablePrintButton();this.isUniversalPrintEnabled&&this.zw&&this.MF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.iD&&this.iD.disablePrintButton();this.isUniversalPrintEnabled&&this.zw&&this.MF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=
function(){this.iD&&this.iD.showWaitCursor();this.isUniversalPrintEnabled&&this.zw&&this.MF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.iD&&this.iD.hideWaitCursor();this.isUniversalPrintEnabled&&this.zw&&this.MF.updatePrintButtonEnableDisableState(!0)};a.prototype.X8g=function(){if(this.zw)w.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.zw=document.createElement("div"),
this.zw.id=a.TJf,this.zw.classList.add(a.Y1i),this.$.ar.insertBefore(this.zw,this.$.ar.firstChild),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.ph){var K=document.getElementById(S.a.$Fa);K&&(this.zw.style.top=K.clientHeight+"px",this.zw.style.height="calc(100% - "+K.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.MF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.MF.enterPrintSettingsTaskPaneFocusTrapZone()};
a.prototype.K_i=function(){var K=this;this.$.da.Za(15,function(da){K.ewaAccessibilityManager=da;K.ewaAccessibilityManager.mode=3})};a.prototype.Z8g=function(){this.bFd=new n(this);this.ZEd=new m(this);this.YEd=new f(this)};a.prototype.NHd=function(){this.bFd.Qg();this.ZEd.Qg();this.YEd.Qg();this.K_i()};a.prototype.sXd=function(){this.bFd.V7();this.ZEd.V7();this.YEd.V7();D.g(this.$).C0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.iL=function(){this.npc=r.a.instance.Ed(this.YK);
this.npc.ka("load",this.Bzf)};a.prototype.yPj=function(){this.npc&&this.YK&&this.npc.detach("load")};a.prototype.tOd=function(){if(this.Gwa){var K=document.getElementById(a.aFd);K&&(K=B.DOMElementExtensions.getElementById(K,a.NJf))&&(this.Gwa=!1,K.focus())}};a.prototype.LQi=function(){this.hD.V5a=!1;this.enablePrintButton();this.tOd()};a.prototype.U8g=function(){var K=this;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var da=u.GetServiceTaskFactory.Wa(this.$.da,
283,284,0).result.Sn;da.loadScript("excel-print-preview-sprite").then(function(){da.loadScript("printPreviewer").then(function(){da.loadScript("excelPrintPreviewer").then(function(){K.TEe()})},function(){w.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){w.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else u.GetServiceTaskFactory.Wa(this.$.da,
283,284,0).result.Sn.loadScript("excelPrintPreviewer").then(function(){K.TEe()})};a.prototype.TEe=function(){var K=this,da=this.$.Wb.Ic("UserAction","createEmptyPreviewerStopwatch");this.X8g();this.Y8g();this.isUniversalPrintEnabled?this.MF.createEmptyPrintPreviewPaneAsync(this.zw,this.SEe()).then(function(){da.stop();K.FBe();K.MF.updatePrintButtonEnableDisableState(!1)}):(this.MF.createEmptyPrintPreviewPane(this.zw,this.SEe()),da.stop(),this.FBe())};a.prototype.FBe=function(){var K=this.$.Wb.Ic("UserAction",
"createPdfPreviewPaneStopwatch"),da=document.getElementById(a.XCd);this.useMSPdfViewer&&(da.tabIndex=0);this.H8g();this.G8g(da);K.stop();this.raiseEvent(a.xCb,new v(0))};a.prototype.Y8g=function(){this.MF||(this.MF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.MF||w.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.$8g=function(){this.iD||(this.iD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.iD||w.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.H8g=function(){this.tW||(this.tW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.tW||w.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.G8g=function(K){this.tW.createPrintPreviewPane(K,this.jah());this.useMSPdfViewer||
(this.YK=B.DOMElementExtensions.getElementById(this.zw,a.mHf),this.YK.title=z.a.instance.fa(1169),this.iL())};a.prototype.a9g=function(){var K="en-US";var da=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?K=this.$.ya.DataCultureTag:w.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object.assign(new d,{whatToPrintOptions:this.hD.fv.whatToPrintOptions,orientationOptions:this.hD.fv.orientationOptions,
paperSizeOptions:this.hD.fv.paperSizeOptions,scalingOptions:this.hD.fv.scalingOptions,marginDetailedOptions:this.hD.LTh(),selectedPrintSettingsValues:this.hD.BWh(),printSettingsTaskPaneCallbacks:this.hD.zWh(),logger:new A.a,shouldDisableCurrentSelection:this.hD.Jwc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:da,dataCultureTag:K,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.SEe=function(){return this.isUniversalPrintEnabled?this.hD.xWh():Object.assign(new la.a,
{backActionButtonText:z.a.instance.fa(1167),printPreviewPaneCallbacks:this.hD.l2e(),logger:new A.a,disableTellMeControl:!0})};a.prototype.jah=function(){var K=this;return this.useMSPdfViewer?Object.assign(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.W7g(),onPdfLoad:function(){K.onPdfLoad()}}):Object.assign(new c,{useMSPdfViewer:!1})};a.prototype.W7g=function(){return Object.assign(new l,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,
msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.Z_f=function(K){this.zw&&this.MF.setAdditionalHeaderText(K)};a.xli=function(K){return 3===K||2===K};a.TJf="PrintPreviewerContainer";a.aFd="printSettingsTaskPaneId";a.XCd="previewId";a.mHf="printpreviewiframe";a.W1i="printPreviewHeaderId";a.NJf="printButton";a.Y1i=H.a.zw;a.xCb="pppnosu";Object(y.a)(a,"PrintPreviewPane",x.a,[465])},974:function(y,F,b){function a(){}b.d(F,"a",function(){return a});y=b(0);var c=b(13),d=b(5),l=b(47),
n=b(23);a.EXe=function(m,f){switch(m){case 3:return a.A1h(f);case 2:return a.BVh(f);case 1:return a.OPh(f)}return""};a.A1h=function(m){switch(m){case 1:return d.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return d.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString()}return""};a.BVh=function(m){switch(m){case 1:return d.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return d.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString()}return""};
a.OPh=function(m){switch(m){case 1:return d.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return d.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(m,f,v){if(n.a.ah||n.a.Up)window.setTimeout(function(){a.WNf(v,a.gcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.Cqe(v),m,0,!1)};a.cZg=function(m,f,v,w){f&&w&&w();a.openInClient(m,f,v)};a.gcc=function(){return n.a.ah?1:n.a.Up?2:n.a.q7a?
3:n.a.isMac?4:0};a.w1h=function(m){switch(m){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.x1h=function(m){switch(m){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};a.WNf=function(m,f){1===f?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),m=a.EXe(m,f),8<n.a.g5a?l.a.vf(m,void 0,void 0,"RedirectToAppStore"):
l.a.bV(m)):document.hidden||(a.Bgc?(m=d.AFrameworkApplication.ga.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),l.a.bV(m)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.EXe(m,f),null,null)))};a.Cqe=function(m){switch(m){case 3:return 5;case 2:return 3;case 1:return 1;
default:return 0}};a.rdd=function(m){switch(m){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.Zod=function(m){return(m=a.HSh(m))&&""!==m?Boolean.parse(m):!1};a.jPd=function(m){a.qsj(m)};a.HSh=function(m){try{return localStorage.getItem(m)}catch(f){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+f.message),null}};a.qsj=function(m){try{localStorage.setItem(m,"true")}catch(f){c.ULS.sendTraceTag(18416669,
306,50,"WildFire LocalStorage SetItem Failed with exception : "+f.message)}};Qk.Object.defineProperties(a,{Bgc:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},exc:{configurable:!0,enumerable:!0,get:function(){return(n.a.q7a||n.a.isMac)&&n.a.cp}},Fzj:{configurable:!0,enumerable:!0,get:function(){return n.a.ah||n.a.Up}}});a.Fye="ChromeExtensionBarDismiss";Object(y.a)(a,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/99b3953d35926fa696a649f375609caa/EwaDS.kmhv.js.map