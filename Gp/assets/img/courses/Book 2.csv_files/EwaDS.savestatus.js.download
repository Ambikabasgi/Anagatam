(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1400:function(y,F,b){function a(S){var H=ba.call(this)||this;H.Pc=S;H.fc();return H}function c(S,H){var T=this;this.Wfe=this.pKc=!1;this.oEb=function(K,da){(null===da||void 0===da?0:da.eH)&&Q.a.rLg([da.eH])&&(T.kuc=!0)};this.Gq=function(){T.kuc=!1};this.dd=function(K,da){U.b(da)&&T.Aea(!0);T.kuc=!1};this.ud=function(){T.dR=T.$.dR;T.Aea()};this.RCf=function(){T.AS()};this.UBf=function(){T.dR=T.$.dR};this.qzd=function(){la.g(T.$).Ca.Jq(T.qzd);
T.dR=T.$.dR};this.kWf=H;this.$=S;this.$.userOperationManager.kx(this.UBf);this.$.Pk(this.ud);this.$.ea.ZGg(this.RCf);this.$.ea.Tj(this.dd);this.$.jVc(this.oEb);this.$.ea.MP(this.Gq);this.Aea()}function d(){this.aQc=this.dPc=this.llb=this.tb=null}function l(S,H,T,K){this.iga=this.bga=this.mga=this.lga=null;this.XDa=0;this.PD=this.$Pc=this.mCa=this.KEc=this.TEa=null;this.Wd=S;this.O8=H;this.E1=T;this.jj=K;this.h9d=!0;this.eM=!1;this.Uz=3;this.dra=!0}function n(S,H){this.fs=null;this.lga=CommonUIStrings.l_SavedStatus;
this.mga=CommonUIStrings.l_SavingStatus;this.bga=CommonUIStrings.l_ReadOnlyStatus;this.iga=CommonUIStrings.l_ReviewModeStatus;this.mSb=H;this.E1=S;this.Uz=3;this.dra=!0}function m(S){this.iga=this.bga=this.mga=this.lga=null;this.J$d=this.Vw=this.eM=!1;this.nPc=this.Y$d=null;this.Q$d=0;this.wb=this.W$d=null;this.E1=S;this.Uz=3;this.Sib=!0}b.r(F);y=b(0);var f=b(80),v=b(13),w=b(168),t=b(47);m.prototype.initialize=function(S,H,T){var K=this;this.lga=this.Fgd(S,H);this.mga=CommonUIStrings.l_SavingStatus;
this.bga=CommonUIStrings.l_ReadOnlyStatus;this.iga=CommonUIStrings.l_ReviewModeStatus;this.E1&&this.E1.execute(function(da){da.eVc(Object(f.a)(K,K.INb,"updateToSavingStatus"))});this.Vw=!0;this.wb=T;return!0};m.prototype.Aea=function(S,H){this.eM=S;this.Uz=H;this.AS(this.Sib)};m.prototype.AS=function(S){!this.Sib&&S&&(this.W$d=new Date);this.Sib=S;S=null;3===this.Uz&&(S=this.Sib?this.lga:this.mga);this.$fh(S)};m.prototype.Fgd=function(S,H){return S?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
H&&H.length?String.format(CommonUIStrings.l_SavedToStatus,H):CommonUIStrings.l_SavedStatus};m.prototype.INb=function(){this.AS(!1)};m.prototype.$Th=function(){switch(this.Uz){case 1:return this.bga;case 2:return this.iga;default:return null}};m.prototype.Lhi=function(S){return this.J$d===this.eM&&this.Q$d===this.Uz&&this.Y$d===S};m.prototype.MIe=function(S){var H=this;appChrome.getHeaderApi().then(function(T){T.updateDocumentTitleStatus(H.eM,S,H.$Th(),H.W$d,H.Sib);return null});this.nPc=null};m.prototype.$fh=
function(S){var H=this;this.Vw&&w.c()&&!this.Lhi(S)&&(t.a.kTf()?(this.nPc&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.nPc=window.requestIdleCallback(function(){H.MIe(S)})):window.requestAnimationFrame(function(){H.MIe(S)}),this.J$d=this.eM,this.Y$d=S,this.Q$d=this.Uz)};Object(y.a)(m,"ReactSaveStatusUIHandler",null,[286]);var A=b(170);n.prototype.hv=function(){var S=this;this.E1&&this.E1.execute(function(H){H.eVc(Object(f.a)(S,S.INb,
"updateToSavingStatus"))});this.mSb.execute(function(H){S.fs=H})};n.prototype.Aea=function(S,H){this.Uz=H;3===H?this.AS(this.dra):2===H?this.ZWd(this.iga):this.ZWd(this.bga)};n.prototype.INb=function(){this.AS(!1)};n.prototype.AS=function(S){this.dra=S;this.ZWd(this.dra?this.lga:this.mga)};n.prototype.ZWd=function(S){this.fs&&this.fs.Rj(A.a.pPj,this.U1g(S))};n.prototype.U1g=function(S){var H={};H.StatusText=S;return H};Object(y.a)(n,"SaveStatusPostMessageHandler",null,[286]);var x=b(833),u=b(165),
B=b(85);l.prototype.initialize=function(S,H){if(!this.Wd)return!1;this.lga=this.Fgd(S,H);this.mga=CommonUIStrings.l_SavingStatus;this.bga=CommonUIStrings.l_ReadOnlyStatus;this.iga=CommonUIStrings.l_ReviewModeStatus;this.hv();return!0};l.prototype.Fgd=function(S,H){return S?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):H&&H.length?String.format(CommonUIStrings.l_SavedToStatus,H):CommonUIStrings.l_SavedStatus};l.prototype.hv=function(){var S=this;this.O8&&this.O8.execute(function(H){H.yGg(Object(f.a)(S,
S.iFe,"createStatusAndModeElements"));H.pGg(Object(f.a)(S,S.BBj,"showHideSaveStatusElement"));H.BMj&&S.iFe(null,null)});this.E1&&this.E1.execute(function(H){H.eVc(Object(f.a)(S,S.INb,"updateToSavingStatus"))})};l.prototype.wv=function(){this.PD&&this.Wd&&this.Wd.mG(this.PD)};l.prototype.BBj=function(S,H){this.Aea("true"===H,this.Uz)};l.prototype.Aea=function(S,H){this.eM=S;this.Uz=H;this.KEc&&(this.KEc.style.display=this.eM||3===this.Uz||!this.TEa?"none":"");this.mCa&&(this.mCa.style.display=this.eM||
3===this.Uz?"none":"",this.mCa.innerText=1===this.Uz?this.bga:this.iga,this.mCa.title=1===this.Uz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.$Pc&&(this.$Pc.style.display=this.eM||1===this.Uz||!this.TEa&&!this.mCa?"none":"");this.PD&&(this.PD.style.display=this.eM||1===this.Uz?"none":"",this.AS(this.dra),this.PD.title=CommonUIStrings.l_SaveStatusTooltip)};l.prototype.iFe=function(S,H){S=document.getElementById(x.CuiHelper.M8e);H&&H.AYj||!S||""===this.lga||
""===this.mga||""===this.bga||""===this.iga||(this.TEa=document.getElementById(x.CuiHelper.l0b),this.KEc=x.CuiHelper.cta(S,"BreadcrumbAppModeDash","-",null,!1),this.mCa=x.CuiHelper.cta(S,"BreadcrumbAppModeStatus",1===this.Uz?this.bga:this.iga,null,!1),this.wdg(this.mCa),this.$Pc=x.CuiHelper.cta(S,"BreadcrumbSaveStatusDash","-",null,!1),this.PD=x.CuiHelper.cta(S,"BreadcrumbSaveStatus",this.lga,null,!1),this.wdg(this.PD),this.Aea(this.eM,this.Uz))};l.prototype.INb=function(){this.AS(!1)};l.prototype.AS=
function(S){this.dra=S;this.hUj(this.dra?this.lga:this.mga)};l.prototype.hUj=function(S){!this.PD||3!==this.Uz&&2!==this.Uz||(this.h9d&&!this.dra?(this.XDa=this.PD.offsetWidth<this.XDa?this.XDa:this.PD.offsetWidth,this.mRj(this.mga),this.h9d=!1):this.PD.innerText=S)};l.prototype.wdg=function(S){S.style.direction=this.jj?"rtl":"ltr";S.style.width="auto";S.style.textAlign=this.jj?"right":"left";S.style.display=this.eM?"none":"";S.setAttribute("Unselectable","on")};l.prototype.mRj=function(S){this.PD&&
(this.PD.style.width="",this.PD.innerText=S,this.XDa=this.PD.offsetWidth<this.XDa?this.XDa:this.PD.offsetWidth,S=u.a.VA(this.PD),this.PD.style.width=this.XDa-B.a.bD(S.paddingLeft)-B.a.bD(S.paddingRight)+1+"px")};Object(y.a)(l,"SaveStatusUIHandler",null,[286]);var r=b(5),I=b(97);d.prototype.ii=function(S){var H=this;this.tb=S;r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.tb.register(n,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Cc().Mc(function(){return new n(H.tb.pc("Common.App.HostNotification.EditNotificationEventSource"),
H.tb.pc("Postmessage.IHostPostmessenger"))}):r.AFrameworkApplication.sa.Qa.fif||(r.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled?this.tb.register(m,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Cc().Mc(function(){return new m(H.tb.pc("Common.App.HostNotification.EditNotificationEventSource"))}):this.tb.register(l,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Cc().Mc(function(){return new l(I.EventHandlerManager.instance,
H.tb.pc("Common.App.Header.HeaderEventSource"),H.tb.pc("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)}))};d.prototype.init=function(){r.AFrameworkApplication.ga.Tu(Object(f.a)(this,this.kB,"onFullAppSettingsReady"))};d.prototype.kB=function(){var S=r.AFrameworkApplication.ga,H=!!r.AFrameworkApplication.sa.Qa&&4===r.AFrameworkApplication.sa.Qa.Oj;if(S.ra("WordEditorAutoSaveImprovementIsEnabled")||S.ra("PptEditorSaveStatusInHeaderEnabled")||H&&S.ra("SimplifiedReactRibbonUxIsEnabled")||
S.ra("ExcelSaveStatusInHeaderEnabled")||S.ra("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?(this.aQc=this.tb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.aQc.hv():r.AFrameworkApplication.sa.Qa.fif||(r.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled?(this.dPc=this.tb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.dPc.initialize(S.ra("IsSkyDrive"),S.Ua("HostNameToIncludeInSavedStatus"),
r.AFrameworkApplication.ga):(this.llb=this.tb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.llb.initialize(S.ra("IsSkyDrive"),S.Ua("HostNameToIncludeInSavedStatus")))};d.prototype.dispose=function(){this.llb&&this.llb.wv()};Qk.Object.defineProperties(d.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});Object(y.a)(d,"PackageManager",null,[4,5]);F=b(273);var z=b(10),D=b(87),V=b(214),U=b(217),Q=b(27),la=b(19);c.prototype.dispose=function(){this.$&&
(this.$.ol(this.ud),this.$.qJd(this.oEb),this.$.userOperationManager&&this.$.userOperationManager.jv(this.UBf),this.$.ea&&(this.$.ea.$dj(this.RCf),this.$.ea.kk(this.dd),this.$.ea.LW(this.Gq)),la.g(this.$)&&la.g(this.$).Ca&&la.g(this.$).Ca.Jq(this.qzd))};c.prototype.Aea=function(S){S=!this.$.isEditMode||(void 0===S?!1:S);this.kWf.Aea(S,this.$.isEditMode?3:1);this.AS()};c.prototype.AS=function(){this.$.isEditMode&&this.kWf.AS(!this.dR&&!this.vri&&!this.kuc)};Qk.Object.defineProperties(c.prototype,{vri:{configurable:!0,
enumerable:!0,get:function(){return this.$.ea?this.$.ea.Bkf:!1}},dR:{configurable:!0,enumerable:!0,get:function(){return this.pKc},set:function(S){S?this.pKc=!0:la.g(this.$)&&la.g(this.$).Ca&&(la.g(this.$).Ca.GH()?this.pKc=!1:la.g(this.$).Ca.Ep(this.qzd));this.AS()}},kuc:{configurable:!0,enumerable:!0,get:function(){return this.Wfe},set:function(S){this.Wfe=S;this.AS()}}});Object(y.a)(c,"SaveStatusManager",null,[2]);var ba=V.a;vm(a,ba);a.prototype.create=function(){var S=this,H=D.a.instance;H.pc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(T){var K=
new c(S.Pc,T);H.register(c,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Cc().Mc(function(){return K});S.Gb(H.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};a.ka=function(S){S.da.Ha(299,new a(S))};Object(y.a)(a,"SaveStatusFactory",V.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.SaveStatus");F.a.instance.rj(new d);z.a.Ga(a.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.savestatus.js.map/8423f3041658298642ab554ca46687d1/EwaDS.savestatus.js.map